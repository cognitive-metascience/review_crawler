<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">45293</article-id><article-id pub-id-type="doi">10.7554/eLife.45293</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Advance</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Front-end Weber-Fechner gain control enhances the fidelity of combinatorial odor coding</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-129971"><name><surname>Kadakia</surname><given-names>Nirag</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9978-6450</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-8366"><name><surname>Emonet</surname><given-names>Thierry</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6746-6564</contrib-id><email>thierry.emonet@yale.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Molecular, Cellular and Developmental Biology</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physics</institution><institution>Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Rieke</surname><given-names>Fred</given-names></name><role>Reviewing Editor</role><aff><institution>University of Washington</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Dulac</surname><given-names>Catherine</given-names></name><role>Senior Editor</role><aff><institution>Harvard University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>28</day><month>06</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e45293</elocation-id><history><date date-type="received" iso-8601-date="2019-01-23"><day>23</day><month>01</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-06-26"><day>26</day><month>06</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Kadakia and Emonet</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Kadakia and Emonet</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-45293-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="article-reference" xlink:href="10.7554/eLife.27670"/><abstract><object-id pub-id-type="doi">10.7554/eLife.45293.001</object-id><p>We showed previously (Gorur-Shandilya et al., 2017) that <italic>Drosophila</italic> olfactory receptor neurons (ORNs) expressing the co-receptor Orco scale their gain inversely with mean odor intensity according to Weber-Fechner’s law. Here, we show that this front-end adaptation promotes the reconstruction of odor identity from dynamic odor signals, even in the presence of confounding background odors and rapid intensity fluctuations. These enhancements are further aided by known downstream transformations in the antennal lobe and mushroom body. Our results, which are applicable to various odor classification and reconstruction schemes, stem from the fact that this adaptation mechanism is not intrinsic to the identity of the receptor involved. Instead, a feedback mechanism adjusts receptor sensitivity based on the activity of the receptor-Orco complex, according to Weber-Fechner’s law. Thus, a common scaling of the gain across Orco-expressing ORNs may be a key feature of ORN adaptation that helps preserve combinatorial odor codes in naturalistic landscapes.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>insect olfaction</kwd><kwd>sensory systems</kwd><kwd>compressed sensing</kwd><kwd>olfactory receptor neurons</kwd><kwd>combinatorial coding</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution>Swartz Foundation</institution></institution-wrap></funding-source><award-id>Postdoctoral Fellowship</award-id><principal-award-recipient><name><surname>Kadakia</surname><given-names>Nirag</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 GM106189</award-id><principal-award-recipient><name><surname>Emonet</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>F32 MH118700</award-id><principal-award-recipient><name><surname>Kadakia</surname><given-names>Nirag</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>In multi-channel sensory systems, gain adaptation can help maintain not only coding capacity across changes in signal intensity, but also combinatorial representations of odor identity.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Animals identify and discriminate odors using olfactory receptors (Ors) expressed in olfactory receptor neurons (ORNs) (<xref ref-type="bibr" rid="bib31">Joseph and Carlson, 2015</xref>; <xref ref-type="bibr" rid="bib6">Buck and Axel, 1991</xref>; <xref ref-type="bibr" rid="bib15">Clyne et al., 1999</xref>; <xref ref-type="bibr" rid="bib60">Vosshall et al., 1999</xref>). Individual ORNs, which typically express a single Or, respond to many odorants, while individual odorants activate many distinct ORNs (<xref ref-type="bibr" rid="bib21">Friedrich and Korsching, 1997</xref>; <xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>; <xref ref-type="bibr" rid="bib63">Wang et al., 2010</xref>; <xref ref-type="bibr" rid="bib43">Nara et al., 2011</xref>). Odors are thus encoded by the combinatorial patterns of activity they elicit in the sensing periphery (<xref ref-type="bibr" rid="bib37">Malnic et al., 1999</xref>; <xref ref-type="bibr" rid="bib63">Wang et al., 2010</xref>; <xref ref-type="bibr" rid="bib30">Hildebrand and Shepherd, 1997</xref>; <xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>; <xref ref-type="bibr" rid="bib18">de Bruyne et al., 2001</xref>; <xref ref-type="bibr" rid="bib21">Friedrich and Korsching, 1997</xref>), and these patterns are decoded downstream into behavioral response (<xref ref-type="bibr" rid="bib67">Wilson, 2013</xref>; <xref ref-type="bibr" rid="bib17">Davies et al., 2015</xref>). Still, ethologically relevant odors are often mixed with background ones (<xref ref-type="bibr" rid="bib52">Saha et al., 2013</xref>; <xref ref-type="bibr" rid="bib51">Renou et al., 2015</xref>) and intensity can vary widely and rapidly as odors are carried by the wind (<xref ref-type="bibr" rid="bib41">Murlis et al., 1992</xref>; <xref ref-type="bibr" rid="bib66">Weissburg, 2000</xref>; <xref ref-type="bibr" rid="bib14">Celani et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Cardé and Willis, 2008</xref>). How are odors recognized reliably despite these confounds? In <italic>Drosophila melanogaster</italic>, ORN dose response curves exhibit similar Hill coefficients but distinct power-law distributed activation thresholds (<xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>; <xref ref-type="bibr" rid="bib54">Si et al., 2019</xref>), which together with inhibitory odorants enhance coding capacity (<xref ref-type="bibr" rid="bib54">Si et al., 2019</xref>; <xref ref-type="bibr" rid="bib11">Cao et al., 2017</xref>; <xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>; <xref ref-type="bibr" rid="bib56">Stevens, 2016</xref>). In antennal lobe (AL) glomeruli, mutual lateral inhibition normalizes population response, reducing the dependency of activity patterns on odor concentration (<xref ref-type="bibr" rid="bib1">Asahina et al., 2009</xref>; <xref ref-type="bibr" rid="bib45">Olsen et al., 2010</xref>). Further downstream, sparse connectivity to the mushroom body (MB) helps maintain neural representations of odors, and facilitates compressed sensing and associative learning schemes (<xref ref-type="bibr" rid="bib13">Caron et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Litwin-Kumar et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Krishnamurthy et al., 2017</xref>; <xref ref-type="bibr" rid="bib16">Dasgupta et al., 2017</xref>). Finally, temporal features of neural responses contribute to concentration-invariant representations of odor identity (<xref ref-type="bibr" rid="bib5">Brown et al., 2005</xref>; <xref ref-type="bibr" rid="bib49">Raman et al., 2010</xref>; <xref ref-type="bibr" rid="bib28">Gupta and Stopfer, 2014</xref>; <xref ref-type="bibr" rid="bib68">Wilson et al., 2017</xref>).</p><p>Here, we examine how short-time ORN adaptation at the very front-end of the insect olfactory circuit contributes to the fidelity of odor encoding. Our theoretical study is motivated by the recent discovery of invariances in the signal transduction and adaptation dynamics of ORNs expressing the co-receptor Orco. ORN response is initiated upon binding of odorant molecules to olfactory receptors (ORs), opening the ion channels they form with the co-receptor Orco (<xref ref-type="bibr" rid="bib35">Larsson et al., 2004</xref>; <xref ref-type="bibr" rid="bib7">Butterwick et al., 2018</xref>). Because of differences in odor-receptor affinities, the responses of ORNs to diverse odorants of the same concentration differ widely (<xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>; <xref ref-type="bibr" rid="bib40">Montague et al., 2011</xref>; <xref ref-type="bibr" rid="bib55">Stensmyr et al., 2012</xref>). In contrast, downstream from this input nonlinearity, signal transduction and adaptation dynamics exhibit a surprising degree of invariance with respect to odor-receptor identity: reverse-correlation analysis of ORN response to fluctuating stimuli produces highly stereotyped, concentration-invariant response filters (<xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>; <xref ref-type="bibr" rid="bib54">Si et al., 2019</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>).</p><p>These properties stem in part from an apparently invariant adaptive scaling law in ORNs: gain varies inversely with mean odor concentration according to the Weber-Fechner Law of psychophysics (<xref ref-type="bibr" rid="bib65">Weber, 1996</xref>; <xref ref-type="bibr" rid="bib20">Fechner, 1860</xref>), irrespective of the odor-receptor combination (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib8">Cafaro, 2016</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>). This invariance can be traced back to adaptative feedback mechanisms in odor transduction, upstream of ORN firing (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>; <xref ref-type="bibr" rid="bib8">Cafaro, 2016</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>), which depend on the activity of the signaling pathway rather than on the identity of its receptor (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>). The generality of the adaptive scaling suggests it could be mediated by the highly conserved Orco co-receptor (<xref ref-type="bibr" rid="bib7">Butterwick et al., 2018</xref>; <xref ref-type="bibr" rid="bib22">Getahun et al., 2013</xref>; <xref ref-type="bibr" rid="bib23">Getahun et al., 2016</xref>; <xref ref-type="bibr" rid="bib25">Guo et al., 2017</xref>), which has been already been implicated in other types of odor adaptation, taking place over longer timescales (<xref ref-type="bibr" rid="bib26">Guo and Smith, 2017</xref>; <xref ref-type="bibr" rid="bib25">Guo et al., 2017</xref>).</p><p>While in a simpler system such as <italic>E. coli</italic> chemotaxis (<xref ref-type="bibr" rid="bib62">Waite et al., 2018</xref>), adaptive feedback via the Weber-Fechner Law robustly maintains sensitivity over concentration changes, the implication for a multiple-channel system – which combines information from hundreds of cells with overlapping receptive fields – is less clear. Here, we combine a biophysical model of ORN adaptive response and neural firing with various sparse signal decoding frameworks to explore how ORN adaptation with Weber-Fechner scaling affects combinatorial coding and decoding of odor signals spanning varying degrees of intensity, molecular complexity, and temporal structure. We find that this front-end adaptive mechanism promotes the accurate discrimination of odor signals from backgrounds of varying molecular complexity, and aids other known mechanisms of neural processing in the olfactory circuit to maintain representations of odor identity across environmental changes.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Model of ORN sensing repertoire</title><p>To model ORN firing rates in response to time-dependent odor signals, we extended a minimal model (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>) that reproduces the Weber-Fechner gain adaptation and firing rate dynamics measured in individual <italic>Drosophila</italic> ORNs in response to Gaussian and naturalistic signals (code available on GitHub, <xref ref-type="bibr" rid="bib32">Kadakia, 2019</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/ORN-WL-gain-control">https://github.com/elifesciences-publications/ORN-WL-gain-control</ext-link>).</p><p>We consider a repertoire of <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> ORN types that each express one type of Or together with the co-receptor Orco (<xref ref-type="bibr" rid="bib35">Larsson et al., 2004</xref>). Within ORNs of type <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, Or-Orco complexes form non-selective cation channels (<xref ref-type="bibr" rid="bib7">Butterwick et al., 2018</xref>) (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) that switch between active and inactive conformations, while simultaneously binding to odorants <inline-formula><mml:math id="inf3"><mml:mi>i</mml:mi></mml:math></inline-formula> with affinity constants, <inline-formula><mml:math id="inf4"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf5"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, respectively (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>). For simplicity, we only consider agonists, that is <inline-formula><mml:math id="inf6"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and assume receptors can only bind one odorant at a time. The analysis can easily be extended to include inhibitory odorants, which increases coding capacity (<xref ref-type="bibr" rid="bib11">Cao et al., 2017</xref>). Dissociation (inverse affinity) constants are chosen from a power law distribution (<inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.35</mml:mn></mml:mrow></mml:math></inline-formula>) recently found across ORN-odor pairs in <italic>Drosophila</italic> larvae (<xref ref-type="bibr" rid="bib54">Si et al., 2019</xref>). For a handful of ORNs, we choose a very large value for one of the <inline-formula><mml:math id="inf8"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> to mimic high responders to private odorants relevant to innate responses (<xref ref-type="bibr" rid="bib55">Stensmyr et al., 2012</xref>). These private odors do not affect the general findings.</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.45293.002</object-id><label>Figure 1.</label><caption><title>Simple ORN model (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>).</title><p>(<bold>A</bold>) Or/Orco complexes of type <inline-formula><mml:math id="inf9"><mml:mi>a</mml:mi></mml:math></inline-formula> switch between active <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and inactive conformations <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Binding an exitatory odorant (S in the diagram) favors the active state. The active fraction is determined by the free energy difference between inactive and active conformations of the Or/Orco complex in its unbound state, <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (in units of <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>), and by odorant binding with affinity constants <inline-formula><mml:math id="inf14"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐊</mml:mi><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:msub><mml:mi mathvariant="bold">𝐊</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> for the active and inactive conformations, respectively (<xref ref-type="disp-formula" rid="equ1 equ7">Equations 1-2</xref>). Adaptation is mediated by a negative feedback (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>) from the activity of the channel onto the free energy difference <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with timescale <inline-formula><mml:math id="inf17"><mml:mi>τ</mml:mi></mml:math></inline-formula>. ORN firing rates <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are generated by passing <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> through a linear temporal filter <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a nonlinear thresholding function <inline-formula><mml:math id="inf21"><mml:mi>f</mml:mi></mml:math></inline-formula>. (<bold>B</bold>) Odors are represented by <inline-formula><mml:math id="inf22"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional vectors <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> , whose components <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the concentrations of the individual molecular constituents of <inline-formula><mml:math id="inf25"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula>. (<bold>C</bold>) Step-stimulus firing rate of 50 ORNs to the <inline-formula><mml:math id="inf26"><mml:mi>N</mml:mi></mml:math></inline-formula>=150 possible monomolecular odorants <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, given power-law distributed afffinity constants (<xref ref-type="bibr" rid="bib54">Si et al., 2019</xref>). (<bold>D</bold>) Temporal responses of a representative ORNs to a pulse stimulus, for a single odorant at several intensities (left), or to many odorants of the same intensity (right). (<bold>E</bold>) Representative ORN tuning curves (a single row of the response matrix in C, ordered by magnitude). Tuning curves are diverse, mimicking measured responses (<xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>). (<bold>F</bold>) Dose-response of an ORN before (black) and after adaptation to either a low (yellow) or high (magenta) odor concentration. (<bold>G</bold>) Same, but the ORN was allowed to first adapt to one of various backgrounds of differing identities, before the foreground (same as in F) was presented. Also shown is the specific case when the foreground and background have the same identity (dashed lines).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig1-v2.tif"/></fig><p>Assuming that odorant binding and conformation changes are faster than other reactions in the signaling pathway, the fraction of channels of type <inline-formula><mml:math id="inf28"><mml:mi>a</mml:mi></mml:math></inline-formula> that are active at steady state is:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> represent unbound channels in the inactive and active conformation. Here, <inline-formula><mml:math id="inf31"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐊</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the time-dependent concentration of the <inline-formula><mml:math id="inf33"><mml:mi>i</mml:mi></mml:math></inline-formula>-th monomolecular component of the odor signal <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf35"><mml:mi>t</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>150</mml:mn></mml:mrow></mml:math></inline-formula> is the size of the molecular odorant space (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> can be rearranged as (derivation in Materials and methods):<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The two terms in the exponential represent the change in the channel’s free energy due to the binding of odorant <inline-formula><mml:math id="inf37"><mml:mi>i</mml:mi></mml:math></inline-formula>, and the free energy difference <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> between the unbound states <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, in units of <inline-formula><mml:math id="inf41"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. Because <inline-formula><mml:math id="inf42"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, a sudden increase in the concentration of excitatory odor results in an increase in activity <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>Upon prolonged stimulation, ORNs adapt. At least one form of adaptation, which takes place over short time scale, <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>≃</mml:mo><mml:mn>250</mml:mn><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>), involves a negative feedback of the Or-Orco channel activity onto the channel sensitivity (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>). To model this adaptation process, we assume that inward currents elicited by activating Or-Orco channels eventually result in an increase of the free energy difference <inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, possibly via a feedback onto Orco (<xref ref-type="bibr" rid="bib7">Butterwick et al., 2018</xref>):<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. The lower bound <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> determines the spontaneous activity of the channel. The higher bound <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> determines the concentrations of odors at which adaptation is unable to keep up and saturation occurs (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>). Through these dynamics, <inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can compensate for changes in free energy due to ligand binding (see <xref ref-type="disp-formula" rid="equ7">Equation 2</xref>), returning the activity <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> towards an adapted level <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> above the spontaneous activity. Since <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> is bounded below, a minimum amount of signal intensity is needed for adaptation to kick in. Finally, the firing rate is modeled by passing the activity <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> through the derivative-taking bi-lobed filter <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a rectifying nonlinearity <inline-formula><mml:math id="inf55"><mml:mi>f</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>):<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊗</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf56"><mml:mo>⊗</mml:mo></mml:math></inline-formula> is convolution. When deconvolved from stimulus dynamics, the shapes of the temporal kernels of <italic>Drosophila</italic> ORNs that express Orco tend to be stereotyped for many odor-receptor combination (<xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib54">Si et al., 2019</xref>) (although there are known exceptions such as super-sustained responses <xref ref-type="bibr" rid="bib40">Montague et al., 2011</xref>). Moreover, adaptation is not intrinsic to the receptor (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>). Accordingly, for simplicity <inline-formula><mml:math id="inf57"><mml:mi>τ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf59"><mml:mi>f</mml:mi></mml:math></inline-formula> are assumed independent of receptor and odorant identities.</p><p>This minimal model reproduces the essential features of ORN response to odorant pulses (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>). In the absence of stimulus, ORNs fire spontaneously at rates (1–10 Hz) (<xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>) set by the lower free energy bound <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mtext>L</mml:mtext><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which we choose from a normal distribution (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). For sufficiently strong stimuli, adaptation causes <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> to increase, compensating for the drop in free energy difference due to ligand binding. This gradually reduces the firing rate to a steady state level <inline-formula><mml:math id="inf62"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> 30–40 Hz (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>) (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). The diversity of temporal firing responses and tuning curves measured experimentally (<xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>; <xref ref-type="bibr" rid="bib40">Montague et al., 2011</xref>; <xref ref-type="bibr" rid="bib5">Brown et al., 2005</xref>; <xref ref-type="bibr" rid="bib28">Gupta and Stopfer, 2014</xref>; <xref ref-type="bibr" rid="bib49">Raman et al., 2010</xref>) arise naturally in the model due to the distribution of chemical affinity constants and the nonlinearity of <xref ref-type="disp-formula" rid="equ7">Equation 2</xref> (<xref ref-type="fig" rid="fig1">Figure 1B</xref>-<xref ref-type="fig" rid="fig1">Figure 1E</xref>).</p><p>The model also reproduces Weber-Fechner scaling of the gain with the inverse of the mean odorant intensity <inline-formula><mml:math id="inf63"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>). For small fluctuations <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> around <inline-formula><mml:math id="inf65"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, we have from <xref ref-type="disp-formula" rid="equ7">Equation 2</xref> that <inline-formula><mml:math id="inf66"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, whereby Weber’s Law is satisfied provided <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is approximately constant (derivation in Materials and methods). In our model, since the rate of adaptation depends only on the activity of the ion channel (right hand-side of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>), then in the adapted state we have <inline-formula><mml:math id="inf68"><mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, ensuring that the gain scales like <inline-formula><mml:math id="inf69"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This process adjusts the sensitivity of the ORN by matching the dose responses to the mean signal concentration, while maintaining their log-slopes (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). However, for foreground odors mixed with background odors to which the system has adapted, the dose response curves now exhibit background-dependent shifts (<xref ref-type="fig" rid="fig1">Figure 1G</xref>).</p><p>While this phenomenological model could be extended to include further details – for example, we could relax the quasi-steady-state assumption in <xref ref-type="disp-formula" rid="equ7">Equation 2</xref>, use a more complex model for channel adaptation and neural firing (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>), or consider feedforward mechanisms in addition to negative integral feedback (<xref ref-type="bibr" rid="bib53">Schulze et al., 2015</xref>) – this minimally parameterized form captures the key dynamical properties of Orco-expressing ORNs relevant to our study: receptor-independent adaptation (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>) with Weber-Fechner scaling (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib8">Cafaro, 2016</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>) that maintains response time independent of mean stimulus intensity (<xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>), along with a diversity of temporal firing patterns in response to a panel of monomolecular odorants (<xref ref-type="bibr" rid="bib29">Hallem and Carlson, 2006</xref>; <xref ref-type="bibr" rid="bib40">Montague et al., 2011</xref>; <xref ref-type="bibr" rid="bib5">Brown et al., 2005</xref>; <xref ref-type="bibr" rid="bib28">Gupta and Stopfer, 2014</xref>; <xref ref-type="bibr" rid="bib49">Raman et al., 2010</xref>) (<xref ref-type="fig" rid="fig1">Figure 1D–1E</xref>).</p></sec><sec id="s2-2"><title>Front-end Weber-Fechner adaptation preserves odor coding among background and intensity confounds</title><p>The identity of an odor is encoded by the pattern of ORN firing responses. However, when a novel foreground odor is presented atop an existing background odor, this pattern may depend also on the background odor, rendering ORN responses less informative about foreground odor identity. To understand how front-end Weber-Fechner adaptation might help encode novel foreground odors in the presence of background odors, we considered environments containing various combinations of foreground odors <inline-formula><mml:math id="inf70"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> and background odors <inline-formula><mml:math id="inf71"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>, and asked how similar are the ORN responses <inline-formula><mml:math id="inf72"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> to a given <inline-formula><mml:math id="inf73"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> but different <inline-formula><mml:math id="inf74"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>.</p><p>Since it is not possible to visualize the 50-dimensional space of ORN responses, we projected ORN responses onto a two-dimensional space using t-distributed stochastic neighbor embedding (t-SNE) (<xref ref-type="bibr" rid="bib58">van der Maaten and Hinton, 2008</xref>). Like principle component analysis (PCA), t-SNE allows a visualization of high-dimensional objects in such a way that desirable features of the original dataset are preserved (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). PCA, for example, retains much of the data variance. t-SNE retains the proximity of an object to its nearest neighbors. Specifically, it constructs a probability distribution <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> based on pairwise distances between nearby objects, assigning higher probability to closer objects. It then determines where the objects would live in a lower dimensional space, such that the analogous distribution <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in this space is most similar to <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. t-SNE is widely used to cluster objects (in our case, ORN responses <inline-formula><mml:math id="inf78"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> to different foreground odors on top of diverse background odors) by similarity (here, foreground odor identity). However, because t-SNE uses local information from only nearest neighbors, global distances and scales are not preserved (<xref ref-type="bibr" rid="bib69">Zhou and Sharpee, 2018</xref>). Thus, we use t-SNE only for visualization. To more rigorously quantify how foreground identity is preserved in ORN activity, we calculate the mutual information (MI) between foreground odor <inline-formula><mml:math id="inf79"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> and ORN firing rates <inline-formula><mml:math id="inf80"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> in the 50-dimensional space (Materials and methods). The MI quantifies how much information a response contains about the stimulus. High MI means that responses exhibit larger variability for different stimuli than for repeated presentations of the same stimulus. In our case, this would be true if <inline-formula><mml:math id="inf81"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> were uniquely defined for different foregrounds <inline-formula><mml:math id="inf82"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula>, irrespective of the background <inline-formula><mml:math id="inf83"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>. Conversely, the MI would be low if responses varied more by background <inline-formula><mml:math id="inf84"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> than by foreground <inline-formula><mml:math id="inf85"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula>.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.45293.003</object-id><label>Figure 2.</label><caption><title>Front-end adaptation maintains representations of odor identity across background and intensity confounds.</title><p>(<bold>A</bold>) Example t-SNE projection of the 50-dimensional vector of ORN firing rates to two dimensions. Each point represents the firing response to a distinct odor. Nearby points exhibit similarities in corresponding firing rates. (<bold>B</bold>) t-SNE projection of ORN firing rates, where each point represents the response to foreground odor <inline-formula><mml:math id="inf86"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> (point color) on top of a background odor <inline-formula><mml:math id="inf87"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo mathvariant="normal" stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> (point size). In the adaptive system, <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> are set to their steady state values given the background odor <inline-formula><mml:math id="inf89"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo mathvariant="normal" stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> alone according to <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> with <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>β</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0</mml:mn></mml:mrow></mml:math></inline-formula>. We assumed <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn mathvariant="normal">0</mml:mn><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn mathvariant="normal">0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf92"><mml:mi>a</mml:mi></mml:math></inline-formula> (we obtain similar results when <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn mathvariant="normal">0</mml:mn><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are randomly distributed; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Clustering by color implies that responses cluster by foreground odor identity. Since global distances are not preserved by t-SNE, distances between plots cannot be meaningfully compared, and so we do not label the axes with units. Mutual information, in bits, is indicated below the plots. (<bold>C</bold>) Similar to (<bold>B</bold>), but now for odors whose concentrations span four decades (represented by point size). Here, the background odor identity is the same for all concentrations. (<bold>D</bold>) Performance of odor coding as a function of <inline-formula><mml:math id="inf94"><mml:mi>β</mml:mi></mml:math></inline-formula>, the magnitude of the deviation from Weber-Fechner’s law (<inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>β</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0</mml:mn></mml:mrow></mml:math></inline-formula>: Weber-Fechner’s scaling; <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>β</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula>: no adaptation; see <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>). Performance is quantified by the mutual information between foreground odor and ORN responses in bits (Materials and methods). Line: same scaling <inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> for all ORNs. Dashed: <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> is uniformly distributed between 0 and <inline-formula><mml:math id="inf99"><mml:mrow><mml:mrow><mml:mn mathvariant="normal">2</mml:mn><mml:mo mathvariant="normal">⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo mathvariant="normal">&lt;</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula> (i.e. has mean <inline-formula><mml:math id="inf100"><mml:mi>β</mml:mi></mml:math></inline-formula>). (E) Distribution of ORN responses and t-SNE projections for <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>β</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mrow><mml:mn mathvariant="normal">0</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mn mathvariant="normal">0.10</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mn mathvariant="normal">0.22</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mn mathvariant="normal">0.40</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> in (<bold>D</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.004</object-id><label>Figure 2—figure supplement 1.</label><caption><title>t-SNE projections when background adapted activity level <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> depends on ORN.</title><p>t-SNE projections for non-adaptive (<inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and adaptive (<inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) systems, when background firing rates depend on ORN identity. Background active fractions <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are chosen normally with mean 0.1 and deviation 0.03, corresponding to background firing rates around of <inline-formula><mml:math id="inf106"><mml:mo>≃</mml:mo></mml:math></inline-formula> 20–40 Hz. .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.005</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Front-end adaptive feedback preserves information capacity of the ORN sensing repertoire.</title><p>Front-end adaptive feedback preserves information capacity of the ORN sensing repertoire. (<bold>A</bold>) Mutual information between signal <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and response <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated at various points in time <inline-formula><mml:math id="inf109"><mml:mi>t</mml:mi></mml:math></inline-formula> for an odor environment consisting of two step odors, A and B. Odor A, with concentration <inline-formula><mml:math id="inf110"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, turns on at time <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>t</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula> and a odor B, with concentration <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, turns on at some later time <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>t</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula>. Both odors have similar intensities <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and similar molecular complexity (<inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>). (<bold>B</bold>) Mutual information as a function of <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> for the non-adaptive system, respectively, at different time points after <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>t</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math></inline-formula>, corresponding to the dots in (<bold>A</bold>). The mutual information carried by distinct ORNs is represented by the shaded region; their average is plotted by the heavy line. In the non-adaptive system, the mutual information peaks in the regime of high sensitivity after the arrival of odor A (purple, blue), and shifts leftward with the onset of odor B (teal, green). The leftward shifts occurs since stronger signals are more prone to response saturation (compromising information transfer) as odor B arrives. (<bold>C</bold>) Same as B, now for the adaptive system. The MI mimics the non-adaptive case at the onset of odor A, before adaptation has kicked in (purple). As the system adapts and responses decrease toward baseline, previously saturating signal intensities now cross the regime of maximal sensitivity, which therefore shifts rightward to higher <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> (dark blue). Much later, but before the arrival of odor B, the ORNs that responded now fire at a similar adapted firing rate ∼30 Hz, irrespective of odor identity, so the mutual information drops to zero. However, having now adjusted its sensitivity to the presence of odor A, the system can respond appropriately to odor B: the MI at <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>t</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> is nearly six bits across decades of concentration immediately following <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>t</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:math></inline-formula> (green).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig2-figsupp2-v2.tif"/></fig></fig-group><p>We first examined how an adaptive or non-adaptive ORN repertoire encodes odor identity in an odor environment that contains a foreground odor <inline-formula><mml:math id="inf121"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> atop a background odor <inline-formula><mml:math id="inf122"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Both odors are sparse mixtures, with <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> odorants of similar concentrations, odor ‘identity’ being the particular set of odorants in the mixture. In the adaptive case, we assume that the system has fully adapted to the background <inline-formula><mml:math id="inf124"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> before the foreground <inline-formula><mml:math id="inf125"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> is presented. This is enacted by calculating the firing response to the foreground odor <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> only after having set the <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ7">Equation 2</xref> to their steady state values in response to the background odor <inline-formula><mml:math id="inf128"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where we have introduced the new parameter <inline-formula><mml:math id="inf129"><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> to allow us to control the scaling of gain adaptation: for <inline-formula><mml:math id="inf130"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> the system exactly follows Weber-Fechner’s law, while for <inline-formula><mml:math id="inf131"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> there is no adaptation. For small but nonzero <inline-formula><mml:math id="inf132"><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>, the inverse gain scales sub-linearly (see Materials and methods), and the adapted activity <inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> increases weakly with background <inline-formula><mml:math id="inf134"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>. In experiments, small deviations from the strict Weber-Fechner scaling on the order of <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>β</mml:mi><mml:mo>≃</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> are observed (see extended figures in <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>).</p><p>With Weber-Fechner’s law in place for all ORNs (<inline-formula><mml:math id="inf136"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) responses cluster by the identity of foreground odor, showing that the repertoire of ORNs appropriately encodes the identity of novel odors irrespective of background signals – once these backgrounds have been ‘adapted away’ (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). This is the case regardless of whether <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is identical or different across neurons (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In contrast, when the system is non-adaptive, (<inline-formula><mml:math id="inf138"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), the responses exhibit weaker separations by odor identity (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Similarly, responses across different odor intensities are well separated by odor identity in the adaptive system, but less so in the non-adaptive system (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Calculating the mutual information between odor and ORN response in time shows that the adaptive system retains coding capacity as it confronts novel odors (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>), whereas the non-adaptive system maintains coding capacity in a far more limited range of odor concentration.</p><p>To what extent do the benefits of front-end adaptation for odor coding depend on the precise Weber-Fechner scaling? We repeated the analysis from <xref ref-type="fig" rid="fig2">Figure 2B</xref> for increasing values of <inline-formula><mml:math id="inf139"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> between zero (Weber’s law) (perfect adaptation) and one (no adaptation). To generalize <xref ref-type="fig" rid="fig2">Figure 2B</xref>, we now let the intensities range over two decades. As <inline-formula><mml:math id="inf140"><mml:mi>β</mml:mi></mml:math></inline-formula> increases, the capacity of the system to cluster responses by odor identity degrades (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Introducing diversity among ORNs by distributing <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>β</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>’s uniformly between 0 and <inline-formula><mml:math id="inf142"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> (so that the mean is <inline-formula><mml:math id="inf143"><mml:mi>β</mml:mi></mml:math></inline-formula>) slightly increases performance at high <inline-formula><mml:math id="inf144"><mml:mi>β</mml:mi></mml:math></inline-formula> but reduces it at low <inline-formula><mml:math id="inf145"><mml:mi>β</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Overall, performance of odor coding degrades with <inline-formula><mml:math id="inf146"><mml:mi>β</mml:mi></mml:math></inline-formula>, as poorly adapting ORNs begin to saturate (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p><p>Interestingly, besides this general trend, we find that for <inline-formula><mml:math id="inf147"><mml:mi>β</mml:mi></mml:math></inline-formula> very close to zero, a small deviation from Weber-Fechner’s law instead <italic>improves</italic> odor coding. This arises because of the nonlinearity in the onset of adaptation: adaptation kicks in only when the strength of stimulus is sufficient for the response <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> to exceed <inline-formula><mml:math id="inf149"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, so that the right hand-side of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> is positive. The minimum background intensity <inline-formula><mml:math id="inf150"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> required for this to happen is given by <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, which, according to equation <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>, increases with <inline-formula><mml:math id="inf152"><mml:mi>β</mml:mi></mml:math></inline-formula>. This initial effect increases odor coding performance, as the firing rates can distribute more broadly across the dynamical range of the ORNs, before adaptation is effected (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). Note that this effect is not specific to our model. A similar enhancement would be observed if Weber’s Law were maintained, but kicked in only above a minimum signal intensity. Thus, while Weber-Fechner scaling largely preserves the representation of foreground odor identity amid backgrounds, in some cases it may benefit from a slight relaxation so that the full dynamical range of the ORNs can be exploited.</p></sec><sec id="s2-3"><title>Front-end adaptation enhances odor decoding in complex environments</title><p>Given that front-end adaptation helps maintain combinatorial odor codes in the presence of backgrounds, we wondered how it affects the capability to decode odor signals from ORN response. One potentially complicating factor is the disparity between sensor dimension and stimulus dimension: while <italic>Drosophila</italic> only express ∼60 Or genes (<xref ref-type="bibr" rid="bib61">Vosshall et al., 2000</xref>), the space of odorants is far greater (<xref ref-type="bibr" rid="bib34">Krishnamurthy et al., 2017</xref>). An <inline-formula><mml:math id="inf153"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional odor signal would naively need <inline-formula><mml:math id="inf154"><mml:mi>N</mml:mi></mml:math></inline-formula> sensory neurons to decode it – one for each odorant. However, naturally occurring odors are sparse, typically comprised of only a few odorants. Enforcing sparsity of the signal during decoding greatly restricts the number of possible odors consistent with a given ORN response, suggesting that such high-dimensional signals might be inferred from less than <inline-formula><mml:math id="inf155"><mml:mi>N</mml:mi></mml:math></inline-formula> ORNs. Indeed, the decoding of sufficiently sparse signals from lower dimensional responses is rigorously guaranteed by the theory of compressed sensing (CS) (<xref ref-type="bibr" rid="bib19">Donoho, 2006</xref>; <xref ref-type="bibr" rid="bib9">Candès et al., 2006</xref>). It is unknown whether CS is implemented in the <italic>Drosophila</italic> olfactory circuit (<xref ref-type="bibr" rid="bib48">Pehlevan et al., 2017</xref>). Here, we use this framework mainly as a tool to quantify how front-end adaptation potentially affects odor decoding, later verifying our conclusions with other classification techniques that incorporate the known architecture of the olfactory system.</p><p>CS is performed as a constrained linear optimization. The constraints in the optimization are <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">𝐃𝐬</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf157"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> is the stimulus to be estimated, <inline-formula><mml:math id="inf158"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> is the response matrix, and <inline-formula><mml:math id="inf159"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> is the vector of ORN responses. The cost function to be minimized, <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, enforces sparsity by driving the estimate of each odorant component to zero; the constraints balance this tendency by simultaneously enforcing information from the ORN firing rates. The result is a reconstructed odor signal <inline-formula><mml:math id="inf161"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> that is as sparse as possible, consistent with the ORN responses. In practice, one uses a linear optimization routine to numerically minimize <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> over <inline-formula><mml:math id="inf163"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, subject to <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">𝐃𝐬</mml:mi></mml:mrow></mml:math></inline-formula>. The result is an estimate of the magnitude of each signal component <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. Thus, both the identity and the intensity of the odor signal are estimated.</p><p>To incorporate this linear framework of CS into our nonlinear odor encoding model, we treat the nonlinear odor encoding exactly, but approximate the decoding to first order around the background concentration (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Specifically, we use <xref ref-type="disp-formula" rid="equ7 equ3 equ4">Equations 2-4</xref> to generate ORN responses <inline-formula><mml:math id="inf166"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> for sparse odors <inline-formula><mml:math id="inf167"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> having <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> nonzero components <inline-formula><mml:math id="inf169"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where the mean concentration is <inline-formula><mml:math id="inf170"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. To estimate signals using CS, we minimize <inline-formula><mml:math id="inf171"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> while enforcing the constraints <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf173"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> is the linearization of <xref ref-type="disp-formula" rid="equ7">Equation 2</xref> around <inline-formula><mml:math id="inf174"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (details in Materials and methods). The perturbations are chosen as <inline-formula><mml:math id="inf175"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mn>9</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf176"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. This linearization simplifies the CS decoding – namely it enforces a single, global minimum – but it is not critical for our general results; see Materials and methods and <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>. We perform the minimization using the sequential least squares algorithm, producing an estimate of the concentration <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of each individual odorant. The matrix <inline-formula><mml:math id="inf178"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> depends on <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>, and as above, we assume precise adaptation by setting <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> to their steady state values in response to the background odor alone (via <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> with <inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). In the nonadaptive case, <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> are held at their minimum values <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.45293.006</object-id><label>Figure 3.</label><caption><title>Front-end adaptation promotes accurate odor decoding in static and naturalistic odor environments.</title><p>(<bold>A</bold>) Odor stimuli produce ORN responses via odor-binding and activation and firing machinery, as described by <xref ref-type="disp-formula" rid="equ7 equ3 equ4">Equations 2-4</xref>. Odors are then decoded using compressed sensing optimization. Odors are assumed sparse, with <inline-formula><mml:math id="inf184"><mml:mi>K</mml:mi></mml:math></inline-formula> nonzero components, <inline-formula><mml:math id="inf185"><mml:mrow><mml:mi>K</mml:mi><mml:mo mathvariant="normal">≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Decoding accuracy of foreground odors in the presence of background odors, for a system without Weber Law adaptation. (<bold>C</bold>) Same as (<bold>B</bold>), with Weber Law adaptation. (D) Recorded trace of naturalistic odor signal; whiffs (signal &gt; 4 a.u.) demarcated by purple bars. This signal is added to static backgrounds of different intensities and complexities. (E) Individual plots show the percent of accurately decoded odor whiffs as a function of background odor intensity, for the non-adaptive (blue) and adaptive (red) systems, for different <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>τ</mml:mi><mml:mtext mathvariant="normal">M</mml:mtext></mml:msub></mml:math></inline-formula> (line shades).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.007</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Decoding accuracy for system with ORN-dependent adaptive timescales <inline-formula><mml:math id="inf187"><mml:mi>τ</mml:mi></mml:math></inline-formula>.</title><p>Decoding accuracy for system with ORN-dependent adaptive timescales <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>A</bold>) Distribution of timescales for all ORNs <inline-formula><mml:math id="inf189"><mml:mi>a</mml:mi></mml:math></inline-formula> (purple dots). Here, <inline-formula><mml:math id="inf190"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mi>X</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>250</mml:mn><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as in the main text and <inline-formula><mml:math id="inf192"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) Individual plots show the percent of accurately decoded odor whiffs (same fluctuating odor signal used in the main text) as a function of background odor intensity, for the non-adaptive (blue) and adaptive (red) systems, for different <inline-formula><mml:math id="inf193"><mml:msub><mml:mi>τ</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math></inline-formula> (line shades). Plots are arrayed by the complexity of the naturalistic signal (column-wise) and the complexity of the background odor (row-wise). .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.008</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Decoding accuracy for system with ORN-dependent adapted firing rates.</title><p>Benefits conferred by Weber-Fechner adaptation remain for a broader distribution of baseline adapted activity levels <inline-formula><mml:math id="inf194"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, now assumed to be ORN-dependent and chosen from a normal distribution. (<bold>A</bold>) Distribution of <inline-formula><mml:math id="inf195"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. (<bold>B</bold>) Decoding accuracy of foreground odors in the presence of background odors. .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.009</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Decoding accuracy for receptors with multiple binding sites.</title><p>Benefits conferred by Weber-Fechner adaptation remain for two binding sites per receptor. This might conceivably occur in insect olfactory receptors, heterotetramers consisting of 4 Orco/Or subunits that gate a central ion channel pathway (<xref ref-type="bibr" rid="bib7">Butterwick et al., 2018</xref>). Plotted is the decoding accuracy of foreground odors in the presence of background odors. .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig3-figsupp3-v2.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.010</object-id><label>Figure 3—figure supplement 4.</label><caption><title>Preservation of restricted isometry property in CS shows how decoding accuracy is maintained by adaptation.</title><p>Eigenvalue distribution of <inline-formula><mml:math id="inf196"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi mathvariant="bold">𝐬</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf197"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi mathvariant="bold">𝐬</mml:mi></mml:msub></mml:math></inline-formula> is a <inline-formula><mml:math id="inf198"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> submatrix of the column-normalized linearized ORN response matrix <inline-formula><mml:math id="inf199"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula>, evaluated at the linearization point <inline-formula><mml:math id="inf200"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf201"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf202"><mml:mi>k</mml:mi></mml:math></inline-formula>-sparse, but its components do not necessarily align with the <inline-formula><mml:math id="inf203"><mml:mi>k</mml:mi></mml:math></inline-formula> columns chosen for the sub-matrix. Eigenvalues are calculated for the adaptive (orange) and non-adaptive (blue) systems, for 1000 randomly chosen linearization points <inline-formula><mml:math id="inf204"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> and submatrices. Plots are arranged for various odor sparsities (by row) and odor intensities (by column). The restricted isometry property is satisfied when the eigenvalues lie between 0 and 2 (black vertical line), and is more strongly satisfied the more centered the distribution is around unity. The increase in near-zero eigenvalues for the non-adaptive system at higher odor complexities and intensities (lower right plots) indicates the weaker fulfillment of the restricted isometry property for these signals, and leads to higher probability of failure in compressed sensing signal reconstruction. .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig3-figsupp4-v2.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.011</object-id><label>Figure 3—figure supplement 5.</label><caption><title>Odor decoding accuracy using the iterative hard thresholding algorithm for nonlinear compressed sensing.</title><p>Decoding of odor signals (no background odors) using the IHT algorithm (<xref ref-type="bibr" rid="bib4">Blumensath and Davies, 2009b</xref>; <xref ref-type="bibr" rid="bib2">Blumensath, 2013</xref>) qualitatively reproduces the results from the main text, which used traditional CS with background linearization. In the adaptive case, IHT actually exhibits superior accuracy to traditional CS, although IHT demands more compute time. The results here show odor decoding accuracy for sparse odor signals of given complexity and intensity, averaged over 10 distinct identities. The iterative algorithm was initialized at <inline-formula><mml:math id="inf205"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>𝟎</mml:mn></mml:mrow></mml:math></inline-formula> and run forward until <inline-formula><mml:math id="inf206"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> was stationary, or 10,000 iterations were reached. Step size <inline-formula><mml:math id="inf207"><mml:mi>μ</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ27">Equation 22</xref> was set to <inline-formula><mml:math id="inf208"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>. At each step, the linearized response used in determining <inline-formula><mml:math id="inf209"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf210"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ27">Equation 22</xref>) was evaluated at the result of <inline-formula><mml:math id="inf211"><mml:mi>i</mml:mi></mml:math></inline-formula>th iteration, <inline-formula><mml:math id="inf212"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. IHT also requires an assumption on the number of components in the mixture (which defines <inline-formula><mml:math id="inf213"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ27">Equation 22</xref>); here, that was set to twice the actual sparsity of true signal.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig3-figsupp5-v2.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.012</object-id><label>Figure 3—figure supplement 6.</label><caption><title>Whiff duration distribution in naturalistic stimulus.</title><p>Distribution of whiff durations in naturalistic stimulus, compared to the theoretical prediction (<xref ref-type="bibr" rid="bib14">Celani et al., 2014</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig3-figsupp6-v2.tif"/></fig></fig-group><p>We first examine how foreground odors are recognized when mixed with background odors of a distinct identity but similar intensities, quantifying decoding accuracy as the percentage of odors correctly decoded within some tolerance (see Materials and methods). Without adaptation, accuracy is maintained within the range of receptor sensitivity for monomolecular backgrounds but is virtually eliminated as background complexity rises (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). The range of sensitivity is broader in the adaptive system and is substantially more robust across odor concentration and complexity (<xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><p>In realistic odor environments, the concentration and duration of individual odor whiffs vary widely (<xref ref-type="bibr" rid="bib14">Celani et al., 2014</xref>). We wondered how well a front-end adaptation mechanism with a single timescale <inline-formula><mml:math id="inf214"><mml:mi>τ</mml:mi></mml:math></inline-formula> could promote odor identity detection in such environments. As inputs to our coding/decoding framework, we apply a naturalistic stimulus intensity recorded from a photo-ionization detector (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>) (<xref ref-type="fig" rid="fig3">Figure 3D</xref>), to which we randomly assign sparse identities from the <inline-formula><mml:math id="inf215"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional odorant space (odor concentration fluctuates in time, but identity is fixed). To mimic background confounds, we combine these signals with a static odor background of a different identity. We decode the odor at each point in time using CS optimization. To assess performance, we consider decoding accuracy only during odor whiffs, rather than blanks, where the concentration is too low to be perceived. We assess performance by the percentage of correctly decoded whiffs (signal must be fully decoded at some point during the whiff), and average our results over distinct choices of foreground and background identity. Finally, we assume the decoder has short-term memory: detected odor signals are only retained for <inline-formula><mml:math id="inf216"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>M</mml:mtext></mml:msub></mml:math></inline-formula> seconds in the immediate past, bounding the amount of past information utilized in signal reconstruction.</p><p>Without ORN adaptation, sufficiently strong backgrounds eliminate the ability to reconstruct the identity of individual odor whiffs, irrespective of the complexity of either the foreground or background odor (<xref ref-type="fig" rid="fig3">Figure 3E</xref>, blue lines). In the adaptive system, this is substantially mitigated (red lines in <xref ref-type="fig" rid="fig3">Figure 3E</xref>), provided the memory duration <inline-formula><mml:math id="inf217"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>M</mml:mtext></mml:msub></mml:math></inline-formula> is at least as long as the adaptation timescale <inline-formula><mml:math id="inf218"><mml:mi>τ</mml:mi></mml:math></inline-formula> (darker red lines). The memory <inline-formula><mml:math id="inf219"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>M</mml:mtext></mml:msub></mml:math></inline-formula> must be long enough so that information about the background concentration <inline-formula><mml:math id="inf220"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, which is needed for decoding, can be acquired over a window at least as long as the adaptation timescale. Because short-term adaptation depends on the activity of the Or-Orco channel rather than on the identity of the receptor (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>), the values of <inline-formula><mml:math id="inf221"><mml:mi>τ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf222"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were assumed the same for all ORNs; still, our results hold if these invariances are relaxed (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p></sec><sec id="s2-4"><title>Front-end adaptation enhances primacy coding</title><p>The primacy coding hypothesis has recently emerged as an intriguing framework for combinatorial odor coding. Here, odor identity is encoded by the set (but not temporal order) of the <inline-formula><mml:math id="inf223"><mml:mi>p</mml:mi></mml:math></inline-formula> earliest responding glomeruli/ORN types, known as primacy set of order <inline-formula><mml:math id="inf224"><mml:mi>p</mml:mi></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib68">Wilson et al., 2017</xref>). If the activation order of ORNs were invariant to the strength of an odor step or pulse, primacy sets would in principle form concentration-invariant representation of odor identity. Although our coding framework uses the full ORN ensemble in signal reconstruction, some of these responses may contain redundant information, and a smaller primacy subset may suffice. To examine this, we apply our model to a sigmoidal stimulus that rises to half-max in 50 ms, calculating decoding accuracy in time. Since ORNs activate sequentially, the primacy set is defined by the ORN subset active when the odor is decoded. For simple odors, a limited set of earliest responding neurons fully accounts for the odor identity (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), in agreement with primacy coding. As expected for more complex odor mixtures, the full repertoire is required for accurate decoding. Primacy coding also predicts that for stronger stimuli, responses occur earlier, since the primacy set is realized quicker, which our framework replicates (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.45293.013</object-id><label>Figure 4.</label><caption><title>Effect of front-end adaptation on primacy coding.</title><p>(<bold>A</bold>) Decoding accuracy as a function of the number of active ORNs, for different odor complexities. The primacy set consists of those ORNs required to be active for accurate decoding. (<bold>B</bold>) Frequency of particular ORNs in primacy sets of an odor placed atop different backgrounds. Individual plots show, for given primacy order <inline-formula><mml:math id="inf225"><mml:mi>p</mml:mi></mml:math></inline-formula>, the percentage of backgrounds for which the primacy set of odor A contains a given ORN (dots). Those with purple borders are the <inline-formula><mml:math id="inf226"><mml:mi>p</mml:mi></mml:math></inline-formula> most highly occurring – that is a nominal background-invariant primacy set for odor A. Points are jittered horizontally for visualization. (<bold>C</bold>) Consistency of primacy sets across backgrounds, as a function of <inline-formula><mml:math id="inf227"><mml:mi>p</mml:mi></mml:math></inline-formula>, for the adaptive (solid) and non-adaptive (dashed) system. Consistency is defined as the likelihood that an ORN in the nomimal primacy set appears in any of the individual background-dependent primacy sets, averaged over the nominal set (average of the y-values of the purple dots in <bold>B</bold>). 100% consistency means that for all backgrounds, the primacy set of odor (<bold>A</bold>) is always the same <inline-formula><mml:math id="inf228"><mml:mi>p</mml:mi></mml:math></inline-formula> ORNs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.014</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Additional results for primacy coding in the adaptive ORN model.</title><p>Additional results pertaining to the primacy coding hypothesis. (<bold>A</bold>) Percent of active ORNs required for 75% accuracy of a steep sigmoidal odor step, as a function of odor step intensity and odor complexity. For low complexities, a primacy set of fewer ORNs may be sufficient to decode the full odor signal; for higher complexities, the entire ORN repertoire is required. (<bold>B</bold>) In the primacy coding hypothesis, the primacy set is realized sooner for stronger odor signals, so odors are decoded earlier in time, resulting in a perceptual time shift with increasing odor concentration (<xref ref-type="bibr" rid="bib68">Wilson et al., 2017</xref>). We also find this shift in our compressed sensing decoding framework (right plot), which rises monotonically with step height for various odor complexities, in agreement with primacy coding. (<bold>C</bold>) The consistency of a primacy code across changes in background odor concentration, in a system with Weber Law adaptation. We calculate the primacy set for odor A (step odor; black) in the presence of either a weak, medium, or strong background (dotted lines; 1x, 10x, 100x a.u.), assuming the system has adapted its response to the background as described in the main text. Averaged across odor A identities, primacy sets for odor A when in the 1x background are nearly identical to those when odor A is in the 10x background (right plot; yellow). The same holds true when comparing the 1x and 100x backgrounds, for sufficiently large primacy order, above eight or so right plot; purple). This indicates that Weber Law adaptation preserves primacy codes across disparate environmental conditions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig4-figsupp1-v2.tif"/></fig></fig-group><p>Beyond mere consistency, however, front-end adaptation might also enhance primacy coding in different environments, such as background odors, which could scramble primacy sets. To investigate this, we considered again a sigmoidal odor step (odor A), now atop a static background (odor B) to which the system has adapted. We compared the primacy sets of odor A for 1000 different choices of odor B, finding that, with adaptation, primacy sets are highly consistent across background confounds for all but the smallest primacy orders (<xref ref-type="fig" rid="fig4">Figure 4B</xref>-Figure 4C). This also holds true for backgrounds of different concentrations (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), suggesting a central role for front-end adaptation in reinforcing primacy codes across differing environmental conditions.</p></sec><sec id="s2-5"><title>Contribution of front-end adaptation for odor recognition within the <italic>Drosophila</italic> olfactory circuit</title><p>Signal transformations in the sensing periphery are propagated through the remainder of the olfactory circuit. How does front-end adaptation interact with these subsequent neural transformations? ORNs expressing the same OR converge to a unique AL glomerulus, where they receive lateral inhibition from other glomeruli (<xref ref-type="bibr" rid="bib46">Olsen and Wilson, 2008</xref>; <xref ref-type="bibr" rid="bib1">Asahina et al., 2009</xref>). This inhibition implements a type of divisive gain control (<xref ref-type="bibr" rid="bib45">Olsen et al., 2010</xref>), normalizing the activity of output projections neurons, which then synapse onto a large number of Kenyon cells (KCs) in the mushroom body. To investigate how odor representations are affected by interactions between front-end ORN adaptation and this lateral inhibition and synaptic divergence, we extended our ORN encoding model by adding uniglomerular connections from ORNs to the antennal lobe, followed by sparse, divergent connections to 2500 KCs (<xref ref-type="bibr" rid="bib33">Keene and Waddell, 2007</xref>; <xref ref-type="bibr" rid="bib36">Litwin-Kumar et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Caron et al., 2013</xref>). Inhibition was modeled via divisive normalization, with parameters chosen according to experiment (<xref ref-type="bibr" rid="bib45">Olsen et al., 2010</xref>). We quantified decoding accuracy by training and testing a linear classifier on the KC activity output of sparse odors of distinct intensity and identity. We trained the classifier on <inline-formula><mml:math id="inf229"><mml:msub><mml:mi>N</mml:mi><mml:mtext>ID</mml:mtext></mml:msub></mml:math></inline-formula> sparse odor identities at intensities chosen randomly over 4 orders of magnitude, then tested the classifier accuracy on the same set of odor identities but of differing concentrations.</p><p>With both ORN adaptation and divisive normalization, the accuracy of the classification by odor identity remains above 85% for more than 1000 odor identities (<inline-formula><mml:math id="inf230"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>ID</mml:mtext></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>). Removing ORN adaption while maintaining divisive normalization substantially reduces accuracy (down to 65% for 1000 odor identities). Further removing divisive normalization gives similar results, apart for very large numbers of odors identities (<inline-formula><mml:math id="inf231"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mtext>ID</mml:mtext></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>), where divisive normalization provides benefits (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). These results strongly implicate front-end adaptation as a key player in maintaining odor identity representations, before signals are further processed downstream.</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.45293.015</object-id><label>Figure 5.</label><caption><title>Front-end adaptation enhances odor recognition by the <italic>Drosophila</italic> olfactory circuit.</title><p>(<bold>A</bold>) Accuracy of linear classification by odor identity, as a function of the number of distinct odor identities classified by the trained network (concentrations span 4 orders of magnitude), in systems with only ORN adaptation, only divisive normalization, both or neither. (<bold>B</bold>) Same as (<bold>A</bold>) but now classifying odors by valence. Odors were randomly assigned valence. For a given odor identity, the valence is the same for all concentrations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.45293.016</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Binary classification for odors whose concentrations span a narrow range of concentration.</title><p>Accuracy of binary classification by odor valence, for odors whose concentrations span a narrow range of concentrations (1 order of magnitude). Accuracy is plotted as a function of the number of distinct odor identities classified by the trained network, in systems with only ORN adaptation, only divisive normalization, both or neither. Decoding gains conferred by divisive normalization and/or ORN adaptation are much smaller than when odors span a much larger range of concentrations, as shown in the main text.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-45293-fig5-figsupp1-v2.tif"/></fig></fig-group><p>As a simpler task, we also considered binary classification, categorizing odors as appetitive or aversive. For simplicity, odor signals of the same identity but differing intensity were assigned the same valence. Classification accuracy degrades to chance level as <inline-formula><mml:math id="inf232"><mml:msub><mml:mi>N</mml:mi><mml:mtext>ID</mml:mtext></mml:msub></mml:math></inline-formula> becomes very large (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). When acting alone, either divisive normalization or ORN adaptation can help, although the effect of ORN adaptation is slightly stronger. When both are active, accuracy improves further, suggesting that these distinct adaptive transformations may act jointly at different stages of neural processing in preserving representations of odor identity. As expected, these gains mostly vanish for the same odors chosen from a narrower range of concentrations (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><p>Previous simulation results have shown that divisive normalization aids identity decoding from PN response to a stronger degree than we find here (<xref ref-type="bibr" rid="bib45">Olsen et al., 2010</xref>). There, 19 distinct odor identities at three concentrations were classified more accurately with divisive normalization (80%) than without (68%). In our case, we find about ∼75% accuracy, with and without divisive normalization. This discrepancy is not necessarily inconsistent. First, we decode mixtures, not single odorants, and the combinatorics may reduce the benefit of divisive normalization. Second, we classify the responses of 2500 KCs, rather than 50 PNs (or 24 PNs as in <xref ref-type="bibr" rid="bib45">Olsen et al., 2010</xref>). Kenyon cell responses follow a high degree of postsynaptic divergence from PNs, which could decorrelate neural responses (<xref ref-type="bibr" rid="bib13">Caron et al., 2013</xref>; <xref ref-type="bibr" rid="bib36">Litwin-Kumar et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Krishnamurthy et al., 2017</xref>) similarly to divisive normalization, reducing the gains from the latter. Finally, the divisive normalization model is a simple one in which glomeruli are all mutually inhibiting. A more complex model in which each glomerulus inhibits only a subset of other glomeruli through local neurons might produce a larger contribution.</p><p>In sum, these results indicate that ORN adaptation might contribute significantly to odor recognition by identity and valence, and that divisive normalization also contributes, although possibly more to classification by valence than by identity. An intriguing possibility is that these two forms of gain control play different roles in coding discrete odor categories versus odor identities.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Weber-Law adaptation at the very front-end of the insect olfactory circuit (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib8">Cafaro, 2016</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>) may contribute significantly to the preservation of neural representations of odor identity amid confounding odors and intensity fluctuations. Drawing on experimental evidence for a number of ORN-invariant response features (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>; <xref ref-type="bibr" rid="bib56">Stevens, 2016</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib54">Si et al., 2019</xref>), we have found that this mechanism of dynamic adaptation confers significant benefits in coding fidelity, without the need for ORN-specific parameterizations. Still, our results hold when these invariances such as adaptation timescale or baseline activity are relaxed (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). In the olfactory periphery, front-end Weber Law adaptation therefore appears fairly robust, a consequence of controlling gain via feedback from channel activity (<xref ref-type="bibr" rid="bib62">Waite et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>), rather than through intrinsic, receptor-dependent mechanisms.</p><p>Our results also suggest that a slight breaking of Weber scaling may aid combinatorial coding, by spreading firing rates more fully over the ORN dynamic range, while still preventing saturation. The degree of this breaking would manifest as a correction to the Weber scaling exponent, <inline-formula><mml:math id="inf233"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>→</mml:mo><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which could in principle be measured experimentally for individual ORNs. Such small deviations from the strict Weber-Fechner scaling have been observed (see extended figures in <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>).</p><p>While our framework incorporates many observed features of the <italic>Drosphila</italic> olfactory system – Weber-Law adaptation, power-law distributed receptor affinities, temporal filter invariance, connectivity topologies – it is minimal. We considered only one of the chemoreceptor families expressed in the fly antenna (<xref ref-type="bibr" rid="bib31">Joseph and Carlson, 2015</xref>) and ignored possible contributions of odor binding proteins (<xref ref-type="bibr" rid="bib59">Vogt and Riddiford, 1981</xref>; <xref ref-type="bibr" rid="bib39">Menuz et al., 2014</xref>), inhibitory odorants (<xref ref-type="bibr" rid="bib11">Cao et al., 2017</xref>), and odorant-odorant antagonism (<xref ref-type="bibr" rid="bib50">Reddy et al., 2018</xref>), which could further boost coding capacity and preserve representation sparsity. Useful extensions to our nonlinear-linear-nonlinear model might incorporate ephaptic coupling between ORNs housed in the same sensillum (<xref ref-type="bibr" rid="bib57">Su et al., 2012</xref>), global inhibition in the mushroom body (<xref ref-type="bibr" rid="bib47">Papadopoulou et al., 2011</xref>), and the effects of long-term adaptation (<xref ref-type="bibr" rid="bib25">Guo et al., 2017</xref>).</p><p>Previous studies have characterized various neural mechanisms that help preserve combinatorial codes. Lateral inhibition between glomeruli helps tame saturation and boost weak signals (<xref ref-type="bibr" rid="bib45">Olsen et al., 2010</xref>). The sparse degree of connectivity to either the olfactory bulb (vertebrates) or mushroom body (insects) may also be precisely tuned to optimize the capacity to learn associations (<xref ref-type="bibr" rid="bib36">Litwin-Kumar et al., 2017</xref>). In this work, we find that some of these downstream features act in concert with front-end dynamic adaptation in maintaining representations of odor identity.</p><p>Other studies have implicated the unique temporal patterns of neural response as signatures of odor identity (<xref ref-type="bibr" rid="bib49">Raman et al., 2010</xref>; <xref ref-type="bibr" rid="bib27">Gupta and Stopfer, 2011</xref>; <xref ref-type="bibr" rid="bib5">Brown et al., 2005</xref>; <xref ref-type="bibr" rid="bib28">Gupta and Stopfer, 2014</xref>). ORN and projection neuron time traces form distinct trajectories in low-dimensional projections, and cluster by odor identity, much as we have found here for static responses at different concentrations (<xref ref-type="fig" rid="fig2">Figure 2</xref>). In locusts PNs, the trajectories elicited by foreground odors when presented in distinct backgrounds exhibit some degree of overlap; although partial, these overlaps were nonetheless sufficient to maintain background-invariant decoding from Kenyon cell responses (<xref ref-type="bibr" rid="bib52">Saha et al., 2013</xref>). It was therefore suggested that background filtering likely occurs at the level of ORNs themselves (<xref ref-type="bibr" rid="bib52">Saha et al., 2013</xref>). Likewise, in our framework, temporal coding is implicit: because the input nonlinearity depends on the diversity of binding affinities, odor signals are naturally formatted into temporal patterns that are both odor- and ORN-specific (<xref ref-type="fig" rid="fig1">Figure 1D</xref>-<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Further, the short required memory timescales (<inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>τ</mml:mi><mml:mo>∼</mml:mo><mml:mn>250</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>) suggest that only brief time windows are needed for accurate odor identification, consistent with previous findings (<xref ref-type="bibr" rid="bib5">Brown et al., 2005</xref>; <xref ref-type="bibr" rid="bib52">Saha et al., 2013</xref>). Moreover, we find that front-end adaptation enhances the robustness of other combinatorial coding schemes, such as primacy coding (<xref ref-type="bibr" rid="bib68">Wilson et al., 2017</xref>), which relies on the temporal order of ORN activation but not absolute firing rate (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>In the well-characterized chemosensory system of bacterial chemotaxis, Weber Law adaptation is enacted through a feedback loop from the output activity of the receptor-kinase complexes onto the enzymes modifying receptor sensitivity (<xref ref-type="bibr" rid="bib62">Waite et al., 2018</xref>). It is interesting that some aspects of this logic are also present in ORNs: although the molecular players are different (and still largely unknown, although likely involving calcium channel signaling, <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>), it has been shown that transduction activity feeds back onto the sensitivity of Or-Orco ligand-gated cation channels, enabling the Weber-Fechner relation (<xref ref-type="bibr" rid="bib42">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>). That this adaptation mechanism appears to act similarly across ORNs (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>; <xref ref-type="bibr" rid="bib10">Cao et al., 2016</xref>) suggests the possible involvement of the universal co-receptor Orco, whose role in long-term adaptation has recently been reported (<xref ref-type="bibr" rid="bib22">Getahun et al., 2013</xref>; <xref ref-type="bibr" rid="bib23">Getahun et al., 2016</xref>; <xref ref-type="bibr" rid="bib25">Guo et al., 2017</xref>). Further, the identification of four subunits comprising the Orco-Or ion channel suggest that generic Or/Orco complexes may contain multiple odorant binding sites, which when included in our model supports our general findings (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>).</p><p>Weber Law ensures that sensory systems remain in the regime of maximum sensitivity, broadening dynamic range and maintaining information capacity (<xref ref-type="bibr" rid="bib64">Wark et al., 2007</xref>). For a single-channel system, this requires matching the midpoint of the dose-response curve to the mean ligand concentration (<xref ref-type="bibr" rid="bib44">Nemenman, 2012</xref>), a strategy which may fail in multi-channel systems with overlapping tuning curves: adaptation to one signal could inhibit identification of others, if the signals excite some but not all the same sensors, as in <xref ref-type="fig" rid="fig1">Figure 1G</xref>. Our results show that this strategy is still largely functional. In CS decoding, this can be traced to the observation that accuracy is guaranteed when sufficiently distinct odor identities produce sufficiently distinct ORN responses, a condition known as the restricted isometry property (<xref ref-type="bibr" rid="bib9">Candès et al., 2006</xref>). Indeed, the Weber-Fechner scaling increases the likelihood that this property is satisfied, beyond that in the non-adaptive system (SI text and <xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref> - <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>). Still, restricted isometry does not require that response repertoires are <italic>invariant</italic> to environmental changes. That is, even if the subset of active ORNs were concentration-dependent, odors could still in principle be fully reconstructible by CS. Nonetheless, our results in t-SNE clustering (<xref ref-type="fig" rid="fig2">Figure 2</xref>), primacy coding (<xref ref-type="fig" rid="fig4">Figure 4B–4C</xref>), and odor classification (<xref ref-type="fig" rid="fig5">Figure 5</xref>) suggest that some signature of response invariance emerges as a natural byproduct of front-end adaptation. Together, this implies that Weber Law adaptation, whether required by the olfactory circuit for precise signal reconstruction (as in CS) or for developing odor associations (as in classification), can play an integral part in maintaining combinatorial codes amid changing environmental conditions.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Adaptive ORN model</title><p>We model an odor as an <inline-formula><mml:math id="inf235"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional vector <inline-formula><mml:math id="inf236"><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf237"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> are the concentrations of individual volatile molecules (odorants) comprising the odor. The olfactory sensory system is modeled as a collection of <inline-formula><mml:math id="inf238"><mml:mi>M</mml:mi></mml:math></inline-formula> distinct Or/Orco complexes indexed by the sub index <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, each of which can be bound with any one of the odorant molecules, and can be either active (firing) or inactive (quiescent). At first, we assume there is one binding site per complex; this will be generalized to many sites. We consider the binding and activation processes to be in equilibrium, assigning each state a corresponding Boltzmann weight, where the zero of energy is set by the unbound, inactive state <inline-formula><mml:math id="inf240"><mml:msub><mml:mtext>C</mml:mtext><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>. These weights are:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">s</mml:mi><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">s</mml:mi><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf241"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> (assumed positive) is the free energy difference between the active and inactive conformation of the unbound receptor, and <inline-formula><mml:math id="inf242"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf243"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> are the free energy differences (assumed positive) between the unbound and bound state for the inactive and active receptor, respectively. <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the chemical potential for odorant species <inline-formula><mml:math id="inf245"><mml:mi>i</mml:mi></mml:math></inline-formula> in terms of a reference chemical potential <inline-formula><mml:math id="inf246"><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> at concentration <inline-formula><mml:math id="inf247"><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf248"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which can be traded for the thermodynamic-relevant disassociation constants <inline-formula><mml:math id="inf249"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mtext>D</mml:mtext><mml:mo>,</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Adding up contributions from all <inline-formula><mml:math id="inf250"><mml:mi>i</mml:mi></mml:math></inline-formula> odorants, the active fraction is:<disp-formula id="equ7"><label>(2)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">s</mml:mi><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">s</mml:mi><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">s</mml:mi><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">s</mml:mi><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="italic">s</mml:mi><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where we have expressed free energies in units of <inline-formula><mml:math id="inf251"><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for notational convenience.</p><p>This expression can be generalized for the case of multiple, independent binding sites through some simple combinatorial factors. Consider first an odorant <inline-formula><mml:math id="inf252"><mml:mi>i</mml:mi></mml:math></inline-formula> which can bind one of two locations on receptor <inline-formula><mml:math id="inf253"><mml:mi>a</mml:mi></mml:math></inline-formula>. There are then four possible inactive states: both sites unbound, site one bound, site two bound, both sites bound. Combined with the active states, there are therefore eight states for odorant <inline-formula><mml:math id="inf254"><mml:mi>i</mml:mi></mml:math></inline-formula> and receptor <inline-formula><mml:math id="inf255"><mml:mi>a</mml:mi></mml:math></inline-formula>, with energies:<disp-formula id="equ8"><label>(7)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the active fraction, <xref ref-type="disp-formula" rid="equ7">Equation 2</xref>, the Boltzmann factors combine through the binomial theorem, giving (for a single odorant environment <inline-formula><mml:math id="inf256"><mml:mi>i</mml:mi></mml:math></inline-formula>):<disp-formula id="equ9"><label>(8)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow><mml:mrow><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This expression generalizes for an arbitrary number of odorants and independent binding sites through the appropriate combinatorial factors, giving an active fraction of<disp-formula id="equ10"><label>(9)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To generate ORN time traces, <xref ref-type="disp-formula" rid="equ7 equ3">Equations 2-3</xref> are integrated numerically using the Euler method with a 2 ms time step. For ORN firing (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is bi-lobed (<xref ref-type="bibr" rid="bib38">Martelli et al., 2013</xref>): <inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf259"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>190</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>1.33</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf261"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf262"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf263"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.012</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf264"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.016</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the pdf of Gamma(<inline-formula><mml:math id="inf266"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf267"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula>). Nonlinearity <inline-formula><mml:math id="inf268"><mml:mi>f</mml:mi></mml:math></inline-formula> is modeled as a linear rectifier with 5 Hz threshold.</p></sec><sec id="s4-2"><title>Derivation of ORN gain</title><p>Weber’s Law states that the gain, or differential response, of the receptor activity <inline-formula><mml:math id="inf269"><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> scales with the mean odor concentration <inline-formula><mml:math id="inf270"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. To show how this is satisfied in our model, we consider the response, <xref ref-type="disp-formula" rid="equ7">Equation 2</xref>, to a signal <inline-formula><mml:math id="inf271"><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow></mml:math></inline-formula> consists of only a small fluctuation in the <inline-formula><mml:math id="inf273"><mml:mi>i</mml:mi></mml:math></inline-formula>th component <inline-formula><mml:math id="inf274"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> about the mean. We derive the change in response to fluctuation <inline-formula><mml:math id="inf275"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for general <inline-formula><mml:math id="inf276"><mml:mi>β</mml:mi></mml:math></inline-formula> from 0 (Weber’s law) to 1 (no adaptation).</p><p>First we write the activity in the form:<disp-formula id="equ11"><label>(10)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ12"><label>(11)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐊</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐊</mml:mi><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf277"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is given by <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>. Then, assuming <inline-formula><mml:math id="inf278"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mi mathvariant="bold">𝐊</mml:mi><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>≪</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐊</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the change in response from the adapted level <inline-formula><mml:math id="inf279"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is<disp-formula id="equ13"><label>(12)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We use <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> to evaluate <inline-formula><mml:math id="inf280"><mml:msup><mml:mi>e</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:msup></mml:math></inline-formula> at <inline-formula><mml:math id="inf281"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>, obtaining:<disp-formula id="equ14"><label>(13)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>whereby<disp-formula id="equ15"><label>(14)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For <inline-formula><mml:math id="inf282"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (the fully adaptive case) and a single odorant, this expression for the gain reduces to <inline-formula><mml:math id="inf283"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. For small <inline-formula><mml:math id="inf284"><mml:mi>β</mml:mi></mml:math></inline-formula>, and given <inline-formula><mml:math id="inf285"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> (corresponding to 30 Hz on a 300 Hz firing rate scale), the denominator is dominated by the <inline-formula><mml:math id="inf286"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> term, giving:<disp-formula id="equ16"><label>(15)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The implication of this is that the gain scaling of the inverse mean intensity, which is 1 for perfect adaptation (gain <inline-formula><mml:math id="inf287"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>), is now sublinear. Thus, when Weber’s Law is weakly broken, the gain still reduces with mean odor intensity, but not as quickly.</p></sec><sec id="s4-3"><title>t-SNE dimensionality reduction and mutual information</title><p>For t-SNE dimensionality reduction (<xref ref-type="bibr" rid="bib58">van der Maaten and Hinton, 2008</xref>), ORN responses were generated for odor signal combinations consisting of 1 (among 10) distinct sparse foreground odors A atop 1 (among 50) distinct sparse background odors B, for <xref ref-type="fig" rid="fig2">Figure 2B</xref>. <xref ref-type="fig" rid="fig2">Figure 2C</xref> plots responses for 10 odors at 40 concentrations spanning four decades, atop a random sparse background odor of similar magnitude. For adaptive systems, <inline-formula><mml:math id="inf288"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> were set to their fully adapted values to the background odor, given by <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>, with <inline-formula><mml:math id="inf289"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The mutual information (MI) between signal and response quantifies how many bits of information a response contains about the stimulus. As we are interested in how much information ORN responses <inline-formula><mml:math id="inf290"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> contain about novel foreground odors <inline-formula><mml:math id="inf291"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula>, we calculate the MI between <inline-formula><mml:math id="inf292"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf293"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula>. This calculation requires the conditional response distribution <inline-formula><mml:math id="inf294"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where the probability distribution is over different background odors <inline-formula><mml:math id="inf295"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>. To get this distribution, we hold <inline-formula><mml:math id="inf296"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> fixed and generate <inline-formula><mml:math id="inf297"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> in the presence of distinct backgrounds. To these responses <inline-formula><mml:math id="inf298"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula>, we also add a small amount of Gaussian noise (mean zero and variance 1 Hz), which allows a distribution to be defined when there is no background odor. We then bin the resulting <inline-formula><mml:math id="inf299"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> in units of <inline-formula><mml:math id="inf300"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula> = 1 Hz to get a histogram representing <inline-formula><mml:math id="inf301"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (The histogram is necessary, since a sum must be taken over <inline-formula><mml:math id="inf302"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula>). If responses were completely background invariant, the resulting histogram would be highly peaked.</p><p>Using <inline-formula><mml:math id="inf303"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the MI is defined as<disp-formula id="equ17"><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf304"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is:<disp-formula id="equ18"><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>and <inline-formula><mml:math id="inf305"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is<disp-formula id="equ19"><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:munder></mml:mstyle><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The noise entropy <inline-formula><mml:math id="inf306"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> quantifies how much variability comes from the background odors, but is not related to changes in foreground odor. The response entropy <inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> quantifies how much variability comes from both background and foreground. The mutual information, which is their difference, is a measure of how responses differ by foreground alone.</p></sec><sec id="s4-4"><title>Compressed sensing decoding of ORN responses</title><p>Compressed sensing (CS) addresses the problem of determining a sparse signal from a set of linear measurements, when the number of measurements is less than the signal dimension. Specifically, it is a solution to<disp-formula id="equ21"><label>(16)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">𝐃𝐱</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf308"><mml:mrow><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf309"><mml:mrow><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are vectors of signals and responses, respectively, and <inline-formula><mml:math id="inf310"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> is the measurement matrix. Since measurements are fewer than signal components, then <inline-formula><mml:math id="inf311"><mml:mrow><mml:mi>M</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, whereby <inline-formula><mml:math id="inf312"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> is wide rectangular and so <xref ref-type="disp-formula" rid="equ21">Equation 16</xref> cannot be simply inverted to produce <inline-formula><mml:math id="inf313"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula>. The idea of CS is to utilize the knowledge that <inline-formula><mml:math id="inf314"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula> is sparse, that is only <inline-formula><mml:math id="inf315"><mml:mi>K</mml:mi></mml:math></inline-formula> of its components, <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≪</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> are nonzero. Both the measurements and sparsity are thus combined into a single constrained optimization routine:<disp-formula id="equ22"><label>(17)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>argmin</mml:mtext><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf317"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the optimal estimates of the signal components and the sum, which is known as the <inline-formula><mml:math id="inf318"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> norm of <inline-formula><mml:math id="inf319"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula>, is a natural metric of sparsity (<xref ref-type="bibr" rid="bib19">Donoho, 2006</xref>).</p><p>The <inline-formula><mml:math id="inf320"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> norm is a convex operation and the constraints are linear, so the optimization has a unique global minimum. To incorporate the nonlinear response of our encoding model into this linear framework, we assume that the responses are generated through the full nonlinear steady state response, <xref ref-type="disp-formula" rid="equ4">Equations 2- 4</xref>, but that the measurement matrix <inline-formula><mml:math id="inf321"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> needed for decoding uses a linear approximation of this transformation. Expanding <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> around <inline-formula><mml:math id="inf322"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> gives<disp-formula id="equ23"><label>(18)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>τ</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ24"><label>(19)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">s</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>τ</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>and where <inline-formula><mml:math id="inf323"><mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo fence="true" maxsize="120%" minsize="120%">|</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:msub></mml:math></inline-formula> is given by the right-hand side of <xref ref-type="disp-formula" rid="equ15">Equation 14</xref> with <inline-formula><mml:math id="inf324"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ23 equ24">Equations 18 and 19</xref> hold only for integrands above 5 Hz (and are zero below), as per the linear rectifier <inline-formula><mml:math id="inf325"><mml:mi>f</mml:mi></mml:math></inline-formula>. We assume that the neural decoder has access to background <inline-formula><mml:math id="inf326"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>, presumed learned (this assumption can be relaxed; see below), and to the linearized response matrix, <xref ref-type="disp-formula" rid="equ15">Equation 14</xref>, but must infer the excess signals <inline-formula><mml:math id="inf327"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from excess ORN firing rates <inline-formula><mml:math id="inf328"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, this corresponds to the CS framework (<xref ref-type="disp-formula" rid="equ22">Equation 17</xref>) via <inline-formula><mml:math id="inf329"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="bold">𝐲</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf330"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐬</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="bold">𝐱</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf331"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo fence="true" maxsize="120%" minsize="120%">|</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:msub><mml:mo>→</mml:mo><mml:mi mathvariant="bold">𝐃</mml:mi></mml:mrow></mml:math></inline-formula>. We optimize the cost function in <xref ref-type="disp-formula" rid="equ22">Equation 17</xref> using sequential least squares programming, implemented in Python through using the scientific package SciPy.</p><p>For our simulations, we let sparse components <inline-formula><mml:math id="inf332"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> be chosen as <inline-formula><mml:math id="inf333"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf334"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf335"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mn>9</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The measurement matrix <inline-formula><mml:math id="inf336"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> depends on the free energy differences <inline-formula><mml:math id="inf337"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula>. For static stimuli, <inline-formula><mml:math id="inf338"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> equals the fixed point of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> in response to the background stimulus with <inline-formula><mml:math id="inf339"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. For fluctuating stimuli, <inline-formula><mml:math id="inf340"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> is updated in time by continuously integrating <inline-formula><mml:math id="inf341"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, via <xref ref-type="disp-formula" rid="equ3 equ4">Equation 3 and 4</xref>; thus, only knowledge of the response <inline-formula><mml:math id="inf342"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are needed by the decoder. To quantify decoding accuracy, we treat the zero and nonzero components of the sparse odor vector separately. We demand that the <inline-formula><mml:math id="inf343"><mml:mi>K</mml:mi></mml:math></inline-formula> nonzero components <inline-formula><mml:math id="inf344"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of the estimated sparse vector are within 25% of their true values <inline-formula><mml:math id="inf345"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and that the <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> zero components are estimated less than 10% of <inline-formula><mml:math id="inf347"><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. Together, this ensures that the odorants comprising the odor mixture are estimated sufficiently close to their concentrations, and that the remaining components are sufficiently small. Odor signals <inline-formula><mml:math id="inf348"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula> are considered correctly decoded if both of these conditions are satisfied for all components <inline-formula><mml:math id="inf349"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. The relatively lax accuracy demanded on the nonzero components is to prevent oversensitivity on the unavoidable errors introduced by linearization. Qualitatively, our findings are robust to these choices.</p><p>The naturalistic odor signal (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) was generated by randomly varying flow rates of ethyl acetate and measuring the concentration with a photo-ionization detector (<xref ref-type="bibr" rid="bib24">Gorur-Shandilya et al., 2017</xref>). Statistics mirroring a turbulent flow (<xref ref-type="bibr" rid="bib14">Celani et al., 2014</xref>) were verified (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>).</p></sec><sec id="s4-5"><title>Iterative hard thresholding (IHT) and the restricted isometry property in compressed sensing</title><p>The purpose of response linearization (<xref ref-type="disp-formula" rid="equ23">Equation 18</xref>) is simply to apply compressed sensing reconstruction directly using linear programming, without worrying about issues of local minima in <xref ref-type="disp-formula" rid="equ22">Equation 17</xref>. This allows us to isolate the impact of Weber Law adaptation from the particularities of the numerics. An alternate technique for compressed signal reconstruction, <italic>iterative hard thresholding</italic> (IHT), does not minimize the constrained <inline-formula><mml:math id="inf350"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> norm directly, rather applying a hard threshold to an iteratively updated signal estimate (<xref ref-type="bibr" rid="bib4">Blumensath and Davies, 2009b</xref>). IHT can be generalized straightforwardly to nonlinear constraints, and would actually dispense with the need for a learned background <inline-formula><mml:math id="inf351"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>, simply initializing the iterations from <inline-formula><mml:math id="inf352"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>𝟎</mml:mn></mml:mrow></mml:math></inline-formula>. Remarkably, this technique works quite well even for non-linear measurements (<xref ref-type="bibr" rid="bib2">Blumensath, 2013</xref>). We demonstrate the applicability of the IHT algorithm to our odor decoding system in <xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>, which reproduces qualitatively the findings in the main text. For these calculations, no background odor was assumed, each iterative decoding being initialized <inline-formula><mml:math id="inf353"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>𝟎</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>IHT provides an alternate computational technique of nonlinear CS, which could be used to both extend and verify our results. Further, it allows us to illustrate why Weber Law adaptation maintains signal reconstruction fidelity in our olfactory sensing model. Like CS using <inline-formula><mml:math id="inf354"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>-norm minimization, IHT exhibits amenable reconstruction and convergence properties under the guarantee of the so-called restricted isometry property (RIP) (<xref ref-type="bibr" rid="bib9">Candès et al., 2006</xref>). Loosely, RIP measures how closely a matrix operator resembles an orthogonal transformation when acting on sparse vectors. The degree to which RIP is satisfied can be understood in terms of the spectrum of a measurement matrix <inline-formula><mml:math id="inf355"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula>. In particular, if <inline-formula><mml:math id="inf356"><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the eigenvalues of <inline-formula><mml:math id="inf357"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf358"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is any <inline-formula><mml:math id="inf359"><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> submatrix of <inline-formula><mml:math id="inf360"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula>, and<disp-formula id="equ25"><label>(20)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>is satisfied for some <inline-formula><mml:math id="inf361"><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, then <inline-formula><mml:math id="inf362"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> satisfies the RIP with constant <inline-formula><mml:math id="inf363"><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. Plainly, the RIP states that the eigenvalues of <inline-formula><mml:math id="inf364"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, when acting on <inline-formula><mml:math id="inf365"><mml:mi>k</mml:mi></mml:math></inline-formula>-sparse vectors, are centered around 1. Thus, to intuit why signal reconstruction breaks down in the non-adaptive sensing system, we can investigate the eigendecomposition of various linearizations of the measurement matrix. We do this now, starting with a brief description of the IHT.</p><p>In the linear setting, IHT seeks sparse signals via the following iterative procedure (<xref ref-type="bibr" rid="bib4">Blumensath and Davies, 2009b</xref>):<disp-formula id="equ26"><label>(21)</label><mml:math id="m26"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐃</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐃𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf366"><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the <inline-formula><mml:math id="inf367"><mml:mi>i</mml:mi></mml:math></inline-formula>th estimate of the sparse signal <inline-formula><mml:math id="inf368"><mml:mi mathvariant="bold">𝐬</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf369"><mml:mi>μ</mml:mi></mml:math></inline-formula> is a step size for the iterations, and <inline-formula><mml:math id="inf370"><mml:mi mathvariant="bold">𝐲</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf371"><mml:mi mathvariant="bold">𝐃</mml:mi></mml:math></inline-formula> are as defined above. <inline-formula><mml:math id="inf372"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a thresholding function which sets all but the largest <inline-formula><mml:math id="inf373"><mml:mi>K</mml:mi></mml:math></inline-formula> values of its argument to zero. The nonlinear extension to IHT is (<xref ref-type="bibr" rid="bib2">Blumensath, 2013</xref>):<disp-formula id="equ27"><label>(22)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="bold">𝐃</mml:mi><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf374"><mml:mi>D</mml:mi></mml:math></inline-formula> is a nonlinear sensing function and <inline-formula><mml:math id="inf375"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is a linearization of <inline-formula><mml:math id="inf376"><mml:mi>D</mml:mi></mml:math></inline-formula> about the point <inline-formula><mml:math id="inf377"><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. Reconstructibility for <inline-formula><mml:math id="inf378"><mml:mi>k</mml:mi></mml:math></inline-formula>-sparse signals is guaranteed if <inline-formula><mml:math id="inf379"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> satisfies RIP for all <inline-formula><mml:math id="inf380"><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and all <inline-formula><mml:math id="inf381"><mml:mi>k</mml:mi></mml:math></inline-formula>-sparse vectors (<xref ref-type="bibr" rid="bib4">Blumensath and Davies, 2009b</xref>). To get a sense of how this is preserved in the adaptive system, we calculate the eigenvalues for 1000 choices of <inline-formula><mml:math id="inf382"><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, acting on random signals of given sparsity <inline-formula><mml:math id="inf383"><mml:mi>K</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). Since the RIP is sensitive to constant scalings of the measurement matrix (while the actual estimation problem is not), we scaled all columns of <inline-formula><mml:math id="inf384"><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> to norm unity (<xref ref-type="bibr" rid="bib3">Blumensath and Davies, 2009a</xref>). This normalizes the eigenvalues of <inline-formula><mml:math id="inf385"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">𝐃</mml:mi><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐃</mml:mi><mml:msub><mml:mi mathvariant="bold">𝐬</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math></inline-formula> to center near unity before calculating the eigendecomposition, allowing us to assess the degree to which the RIP is satisfied. This scaled matrix can be used directly in <xref ref-type="disp-formula" rid="equ27">Equation 22</xref> (<xref ref-type="bibr" rid="bib2">Blumensath, 2013</xref>; <xref ref-type="bibr" rid="bib3">Blumensath and Davies, 2009a</xref>). The spectra of these matrices indicates that the RIP becomes far more weakly satisifed in the non-adaptive system than in the adaptive one, for sufficient odor complexity and intensity.</p></sec><sec id="s4-6"><title>Network model and classification</title><p>For the network model, the AL-to-MB connectivity matrix <inline-formula><mml:math id="inf386"><mml:msub><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, is chosen such that each KC connects pre-synaptically to seven randomly chosen AL glomeruli (<xref ref-type="bibr" rid="bib36">Litwin-Kumar et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">Caron et al., 2013</xref>). The results shown in <xref ref-type="fig" rid="fig5">Figure 5</xref> are an average of 10 distinct instantiations of this random topology. The <inline-formula><mml:math id="inf387"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mn>2500</mml:mn></mml:mrow></mml:math></inline-formula> KCs are then connected by a matrix <inline-formula><mml:math id="inf388"><mml:msub><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> to a readout layer of dimension <inline-formula><mml:math id="inf389"><mml:mi>Q</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf390"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> for binary and <inline-formula><mml:math id="inf391"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mtext>ID</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for multi-class classification. Both AL-to-MB and MB-to-readout connections are perceptron-type with rectified-linear thresholds. The weights of <inline-formula><mml:math id="inf392"><mml:msub><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf393"><mml:msub><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are chosen randomly from <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mn>7</mml:mn></mml:msqrt></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf395"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mi>Z</mml:mi></mml:msqrt></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. Only the <inline-formula><mml:math id="inf396"><mml:msub><mml:mi mathvariant="bold">𝐉</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and the MB-to-output thresholds are updated during supervised network training, via logistic regression (for binary classification) or its higher-dimensional generalization, the softmax cross entropy (for multi-class classification).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>NK was supported by a postdoctoral fellowship through the Swartz Foundation and by an NRSA postdoctoral fellowship through the NIH BRAIN Initiative under award number 1F32MH118700. TE was supported by NIH R01 GM106189. We thank Damon Clark, John Carlson, Mahmut Demir, Srinivas Gorur-Shandilya, Henry Mattingly, and Ann Hermunstad for comments on the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Methodology, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.45293.017</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-45293-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files. All software codes are available via GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/emonetlab/ORN-WL-gain-control">https://github.com/emonetlab/ORN-WL-gain-control</ext-link>, copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/ORN-WL-gain-control">https://github.com/elifesciences-publications/ORN-WL-gain-control</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asahina</surname> <given-names>K</given-names></name><name><surname>Louis</surname> <given-names>M</given-names></name><name><surname>Piccinotti</surname> <given-names>S</given-names></name><name><surname>Vosshall</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A circuit supporting concentration-invariant odor perception in <italic>Drosophila</italic></article-title><source>Journal of Biology</source><volume>8</volume><elocation-id>9</elocation-id><pub-id pub-id-type="doi">10.1186/jbiol108</pub-id><pub-id pub-id-type="pmid">19171076</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blumensath</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Compressed sensing with nonlinear observations and related nonlinear optimization problems</article-title><source>IEEE Transactions on Information Theory</source><volume>59</volume><fpage>3466</fpage><lpage>3474</lpage><pub-id pub-id-type="doi">10.1109/TIT.2013.2245716</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Blumensath</surname> <given-names>T</given-names></name><name><surname>Davies</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2009">2009a</year><chapter-title>How to use the iterative hard thresholding algorithm</chapter-title><source>Proceedings of SPARS’09 - Signal Processing with Adaptive Sparse Structured Representations</source><publisher-loc>France</publisher-loc><publisher-name>Saint Malo</publisher-name></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blumensath</surname> <given-names>T</given-names></name><name><surname>Davies</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2009">2009b</year><article-title>Iterative hard thresholding for compressed sensing</article-title><source>Applied and Computational Harmonic Analysis</source><volume>27</volume><fpage>265</fpage><lpage>274</lpage><pub-id pub-id-type="doi">10.1016/j.acha.2009.04.002</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>SL</given-names></name><name><surname>Joseph</surname> <given-names>J</given-names></name><name><surname>Stopfer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Encoding a temporally structured stimulus with a temporally structured neural representation</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>1568</fpage><lpage>1576</lpage><pub-id pub-id-type="doi">10.1038/nn1559</pub-id><pub-id pub-id-type="pmid">16222230</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buck</surname> <given-names>L</given-names></name><name><surname>Axel</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>A novel multigene family may encode odorant receptors: a molecular basis for odor recognition</article-title><source>Cell</source><volume>65</volume><fpage>175</fpage><lpage>187</lpage><pub-id pub-id-type="doi">10.1016/0092-8674(91)90418-X</pub-id><pub-id pub-id-type="pmid">1840504</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butterwick</surname> <given-names>JA</given-names></name><name><surname>Del Mármol</surname> <given-names>J</given-names></name><name><surname>Kim</surname> <given-names>KH</given-names></name><name><surname>Kahlson</surname> <given-names>MA</given-names></name><name><surname>Rogow</surname> <given-names>JA</given-names></name><name><surname>Walz</surname> <given-names>T</given-names></name><name><surname>Ruta</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Cryo-EM structure of the insect olfactory receptor orco</article-title><source>Nature</source><volume>560</volume><fpage>447</fpage><lpage>452</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0420-8</pub-id><pub-id pub-id-type="pmid">30111839</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cafaro</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multiple sites of adaptation lead to contrast encoding in the <italic>Drosophila</italic> olfactory system</article-title><source>Physiological Reports</source><volume>4</volume><elocation-id>e12762</elocation-id><pub-id pub-id-type="doi">10.14814/phy2.12762</pub-id><pub-id pub-id-type="pmid">27053295</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Candès</surname> <given-names>EJ</given-names></name><name><surname>Romberg</surname> <given-names>JK</given-names></name><name><surname>Tao</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Stable signal recovery from incomplete and inaccurate measurements</article-title><source>Communications on Pure and Applied Mathematics</source><volume>59</volume><fpage>1207</fpage><lpage>1223</lpage><pub-id pub-id-type="doi">10.1002/cpa.20124</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname> <given-names>LH</given-names></name><name><surname>Jing</surname> <given-names>BY</given-names></name><name><surname>Yang</surname> <given-names>D</given-names></name><name><surname>Zeng</surname> <given-names>X</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name><name><surname>Luo</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Distinct signaling of <italic>Drosophila</italic> chemoreceptors in olfactory sensory neurons</article-title><source>PNAS</source><volume>113</volume><fpage>E902</fpage><lpage>E911</lpage><pub-id pub-id-type="doi">10.1073/pnas.1518329113</pub-id><pub-id pub-id-type="pmid">26831094</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname> <given-names>LH</given-names></name><name><surname>Yang</surname> <given-names>D</given-names></name><name><surname>Wu</surname> <given-names>W</given-names></name><name><surname>Zeng</surname> <given-names>X</given-names></name><name><surname>Jing</surname> <given-names>BY</given-names></name><name><surname>Li</surname> <given-names>MT</given-names></name><name><surname>Qin</surname> <given-names>S</given-names></name><name><surname>Tang</surname> <given-names>C</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name><name><surname>Luo</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Odor-evoked inhibition of olfactory sensory neurons drives olfactory perception in <italic>Drosophila</italic></article-title><source>Nature Communications</source><volume>8</volume><elocation-id>1357</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-01185-0</pub-id><pub-id pub-id-type="pmid">29116083</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardé</surname> <given-names>RT</given-names></name><name><surname>Willis</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Navigational strategies used by insects to find distant, wind-borne sources of odor</article-title><source>Journal of Chemical Ecology</source><volume>34</volume><fpage>854</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1007/s10886-008-9484-5</pub-id><pub-id pub-id-type="pmid">18581182</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caron</surname> <given-names>SJ</given-names></name><name><surname>Ruta</surname> <given-names>V</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Axel</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Random convergence of olfactory inputs in the <italic>Drosophila</italic> mushroom body</article-title><source>Nature</source><volume>497</volume><fpage>113</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1038/nature12063</pub-id><pub-id pub-id-type="pmid">23615618</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Celani</surname> <given-names>A</given-names></name><name><surname>Villermaux</surname> <given-names>E</given-names></name><name><surname>Vergassola</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Odor landscapes in turbulent environments</article-title><source>Physical Review X</source><volume>4</volume><elocation-id>041015</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevX.4.041015</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clyne</surname> <given-names>PJ</given-names></name><name><surname>Warr</surname> <given-names>CG</given-names></name><name><surname>Freeman</surname> <given-names>MR</given-names></name><name><surname>Lessing</surname> <given-names>D</given-names></name><name><surname>Kim</surname> <given-names>J</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>A novel family of divergent seven-transmembrane proteins: candidate odorant receptors in <italic>Drosophila</italic></article-title><source>Neuron</source><volume>22</volume><fpage>327</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)81093-4</pub-id><pub-id pub-id-type="pmid">10069338</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dasgupta</surname> <given-names>S</given-names></name><name><surname>Stevens</surname> <given-names>CF</given-names></name><name><surname>Navlakha</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A neural algorithm for a fundamental computing problem</article-title><source>Science</source><volume>358</volume><fpage>793</fpage><lpage>796</lpage><pub-id pub-id-type="doi">10.1126/science.aam9868</pub-id><pub-id pub-id-type="pmid">29123069</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davies</surname> <given-names>A</given-names></name><name><surname>Louis</surname> <given-names>M</given-names></name><name><surname>Webb</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A model of <italic>Drosophila</italic> larva chemotaxis</article-title><source>PLOS Computational Biology</source><volume>11</volume><fpage>e1004606</fpage><lpage>e1004624</lpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004606</pub-id><pub-id pub-id-type="pmid">26600460</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Bruyne</surname> <given-names>M</given-names></name><name><surname>Foster</surname> <given-names>K</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Odor coding in the <italic>Drosophila</italic> antenna</article-title><source>Neuron</source><volume>30</volume><fpage>537</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(01)00289-6</pub-id><pub-id pub-id-type="pmid">11395013</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donoho</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Compressed sensing</article-title><source>IEEE Transactions on Information Theory</source><volume>52</volume><fpage>1289</fpage><lpage>1306</lpage><pub-id pub-id-type="doi">10.1109/TIT.2006.871582</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fechner</surname> <given-names>GT</given-names></name></person-group><year iso-8601-date="1860">1860</year><source>Elemente Der Psychophysik</source><publisher-name>Breitkopf und Härtel</publisher-name></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedrich</surname> <given-names>RW</given-names></name><name><surname>Korsching</surname> <given-names>SI</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Combinatorial and chemotopic odorant coding in the zebrafish olfactory bulb visualized by optical imaging</article-title><source>Neuron</source><volume>18</volume><fpage>737</fpage><lpage>752</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)80314-1</pub-id><pub-id pub-id-type="pmid">9182799</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Getahun</surname> <given-names>MN</given-names></name><name><surname>Olsson</surname> <given-names>SB</given-names></name><name><surname>Lavista-Llanos</surname> <given-names>S</given-names></name><name><surname>Hansson</surname> <given-names>BS</given-names></name><name><surname>Wicher</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Insect odorant response sensitivity is tuned by metabotropically autoregulated olfactory receptors</article-title><source>PLOS ONE</source><volume>8</volume><elocation-id>e58889</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0058889</pub-id><pub-id pub-id-type="pmid">23554952</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Getahun</surname> <given-names>MN</given-names></name><name><surname>Thoma</surname> <given-names>M</given-names></name><name><surname>Lavista-Llanos</surname> <given-names>S</given-names></name><name><surname>Keesey</surname> <given-names>I</given-names></name><name><surname>Fandino</surname> <given-names>RA</given-names></name><name><surname>Knaden</surname> <given-names>M</given-names></name><name><surname>Wicher</surname> <given-names>D</given-names></name><name><surname>Olsson</surname> <given-names>SB</given-names></name><name><surname>Hansson</surname> <given-names>BS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Intracellular regulation of the insect chemoreceptor complex impacts odour localization in flying insects</article-title><source>The Journal of Experimental Biology</source><volume>219</volume><fpage>3428</fpage><lpage>3438</lpage><pub-id pub-id-type="doi">10.1242/jeb.143396</pub-id><pub-id pub-id-type="pmid">27591307</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorur-Shandilya</surname> <given-names>S</given-names></name><name><surname>Demir</surname> <given-names>M</given-names></name><name><surname>Long</surname> <given-names>J</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name><name><surname>Emonet</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Olfactory receptor neurons use gain control and complementary kinetics to encode intermittent odorant stimuli</article-title><source>eLife</source><volume>6</volume><elocation-id>e27670</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.27670</pub-id><pub-id pub-id-type="pmid">28653907</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>H</given-names></name><name><surname>Kunwar</surname> <given-names>K</given-names></name><name><surname>Smith</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Odorant receptor sensitivity modulation in <italic>Drosophila</italic></article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>9465</fpage><lpage>9473</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1573-17.2017</pub-id><pub-id pub-id-type="pmid">28871035</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname> <given-names>H</given-names></name><name><surname>Smith</surname> <given-names>DP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Odorant receptor desensitization in insects</article-title><source>Journal of Experimental Neuroscience</source><volume>11</volume><fpage>1</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1177/1179069517748600</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>N</given-names></name><name><surname>Stopfer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Insect olfactory coding and memory at multiple timescales</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>768</fpage><lpage>773</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.05.005</pub-id><pub-id pub-id-type="pmid">21632235</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>N</given-names></name><name><surname>Stopfer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A temporal channel for information in sparse sensory coding</article-title><source>Current biology : CB</source><volume>24</volume><fpage>2247</fpage><lpage>2256</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.08.021</pub-id><pub-id pub-id-type="pmid">25264257</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallem</surname> <given-names>EA</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Coding of odors by a receptor repertoire</article-title><source>Cell</source><volume>125</volume><fpage>143</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2006.01.050</pub-id><pub-id pub-id-type="pmid">16615896</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hildebrand</surname> <given-names>JG</given-names></name><name><surname>Shepherd</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Mechanisms of olfactory discrimination: converging evidence for common principles across phyla</article-title><source>Annual Review of Neuroscience</source><volume>20</volume><fpage>595</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.20.1.595</pub-id><pub-id pub-id-type="pmid">9056726</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joseph</surname> <given-names>RM</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title><italic>Drosophila</italic> chemoreceptors: a molecular interface between the chemical world and the brain</article-title><source>Trends in Genetics</source><volume>31</volume><fpage>683</fpage><lpage>695</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2015.09.005</pub-id><pub-id pub-id-type="pmid">26477743</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Kadakia</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>ORN-WL-gain-control</data-title><source>GitHub</source><version designator="926cfa7">926cfa7</version><ext-link ext-link-type="uri" xlink:href="https://github.com/emonetlab/ORN-WL-gain-control.git">https://github.com/emonetlab/ORN-WL-gain-control.git</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keene</surname> <given-names>AC</given-names></name><name><surname>Waddell</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title><italic>Drosophila</italic> olfactory memory: single genes to complex neural circuits</article-title><source>Nature Reviews Neuroscience</source><volume>8</volume><fpage>341</fpage><lpage>354</lpage><pub-id pub-id-type="doi">10.1038/nrn2098</pub-id><pub-id pub-id-type="pmid">17453015</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Krishnamurthy</surname> <given-names>K</given-names></name><name><surname>Hermundstad</surname> <given-names>AM</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Disorder and the neural representation of complex odors: smelling in the real world</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/160382</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larsson</surname> <given-names>MC</given-names></name><name><surname>Domingos</surname> <given-names>AI</given-names></name><name><surname>Jones</surname> <given-names>WD</given-names></name><name><surname>Chiappe</surname> <given-names>ME</given-names></name><name><surname>Amrein</surname> <given-names>H</given-names></name><name><surname>Vosshall</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Or83b encodes a broadly expressed odorant receptor essential for <italic>Drosophila</italic> olfaction</article-title><source>Neuron</source><volume>43</volume><fpage>703</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2004.08.019</pub-id><pub-id pub-id-type="pmid">15339651</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname> <given-names>A</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Axel</surname> <given-names>R</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Optimal degrees of synaptic connectivity</article-title><source>Neuron</source><volume>93</volume><fpage>1153</fpage><lpage>1164</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.01.030</pub-id><pub-id pub-id-type="pmid">28215558</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malnic</surname> <given-names>B</given-names></name><name><surname>Hirono</surname> <given-names>J</given-names></name><name><surname>Sato</surname> <given-names>T</given-names></name><name><surname>Buck</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Combinatorial receptor codes for odors</article-title><source>Cell</source><volume>96</volume><fpage>713</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)80581-4</pub-id><pub-id pub-id-type="pmid">10089886</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martelli</surname> <given-names>C</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name><name><surname>Emonet</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Intensity invariant dynamics and odor-specific latencies in olfactory receptor neuron response</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>6285</fpage><lpage>6297</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0426-12.2013</pub-id><pub-id pub-id-type="pmid">23575828</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menuz</surname> <given-names>K</given-names></name><name><surname>Larter</surname> <given-names>NK</given-names></name><name><surname>Park</surname> <given-names>J</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>An RNA-seq screen of the <italic>Drosophila</italic> antenna identifies a transporter necessary for ammonia detection</article-title><source>PLOS Genetics</source><volume>10</volume><elocation-id>e1004810</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1004810</pub-id><pub-id pub-id-type="pmid">25412082</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montague</surname> <given-names>SA</given-names></name><name><surname>Mathew</surname> <given-names>D</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Similar odorants elicit different behavioral and physiological responses, some supersustained</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>7891</fpage><lpage>7899</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6254-10.2011</pub-id><pub-id pub-id-type="pmid">21613503</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murlis</surname> <given-names>J</given-names></name><name><surname>Elkinton</surname> <given-names>JS</given-names></name><name><surname>Cardé</surname> <given-names>RT</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Odor plumes and how insects use them</article-title><source>Annual Review of Entomology</source><volume>37</volume><fpage>505</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1146/annurev.en.37.010192.002445</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagel</surname> <given-names>KI</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Biophysical mechanisms underlying olfactory receptor neuron dynamics</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>208</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1038/nn.2725</pub-id><pub-id pub-id-type="pmid">21217763</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nara</surname> <given-names>K</given-names></name><name><surname>Saraiva</surname> <given-names>LR</given-names></name><name><surname>Ye</surname> <given-names>X</given-names></name><name><surname>Buck</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A large-scale analysis of odor coding in the olfactory epithelium</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>9179</fpage><lpage>9191</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1282-11.2011</pub-id><pub-id pub-id-type="pmid">21697369</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nemenman</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>Information theory and adaptation</chapter-title><person-group person-group-type="editor"><name><surname>Wall</surname> <given-names>M. E</given-names></name></person-group><source>Quantitative Biology: From Molecular to Cellular Systems</source><volume>4</volume><publisher-loc>USA</publisher-loc><publisher-name>CRC Press</publisher-name><fpage>73</fpage><lpage>91</lpage></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olsen</surname> <given-names>SR</given-names></name><name><surname>Bhandawat</surname> <given-names>V</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Divisive normalization in olfactory population codes</article-title><source>Neuron</source><volume>66</volume><fpage>287</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.04.009</pub-id><pub-id pub-id-type="pmid">20435004</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olsen</surname> <given-names>SR</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Lateral presynaptic inhibition mediates gain control in an olfactory circuit</article-title><source>Nature</source><volume>452</volume><fpage>956</fpage><lpage>960</lpage><pub-id pub-id-type="doi">10.1038/nature06864</pub-id><pub-id pub-id-type="pmid">18344978</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papadopoulou</surname> <given-names>M</given-names></name><name><surname>Cassenaer</surname> <given-names>S</given-names></name><name><surname>Nowotny</surname> <given-names>T</given-names></name><name><surname>Laurent</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Normalization for sparse encoding of odors by a wide-field interneuron</article-title><source>Science</source><volume>332</volume><fpage>721</fpage><lpage>725</lpage><pub-id pub-id-type="doi">10.1126/science.1201835</pub-id><pub-id pub-id-type="pmid">21551062</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Pehlevan</surname> <given-names>C</given-names></name><name><surname>Genkin</surname> <given-names>A</given-names></name><name><surname>Chklovskii</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A clustering neural network model of insect olfaction</article-title><conf-name>In 2017 51st Asilomar Conference on Signals, Systems, and Computers</conf-name><fpage>593</fpage><lpage>600</lpage></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raman</surname> <given-names>B</given-names></name><name><surname>Joseph</surname> <given-names>J</given-names></name><name><surname>Tang</surname> <given-names>J</given-names></name><name><surname>Stopfer</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Temporally diverse firing patterns in olfactory receptor neurons underlie spatiotemporal neural codes for odors</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>1994</fpage><lpage>2006</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5639-09.2010</pub-id><pub-id pub-id-type="pmid">20147528</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reddy</surname> <given-names>G</given-names></name><name><surname>Zak</surname> <given-names>JD</given-names></name><name><surname>Vergassola</surname> <given-names>M</given-names></name><name><surname>Murthy</surname> <given-names>VN</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Antagonism in olfactory receptor neurons and its implications for the perception of odor mixtures</article-title><source>eLife</source><volume>7</volume><elocation-id>34958</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34958</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Renou</surname> <given-names>M</given-names></name><name><surname>Party</surname> <given-names>V</given-names></name><name><surname>Rouyar</surname> <given-names>A</given-names></name><name><surname>Anton</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Olfactory signal coding in an odor background</article-title><source>Biosystems</source><volume>136</volume><fpage>35</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1016/j.biosystems.2015.06.001</pub-id><pub-id pub-id-type="pmid">26116090</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saha</surname> <given-names>D</given-names></name><name><surname>Leong</surname> <given-names>K</given-names></name><name><surname>Li</surname> <given-names>C</given-names></name><name><surname>Peterson</surname> <given-names>S</given-names></name><name><surname>Siegel</surname> <given-names>G</given-names></name><name><surname>Raman</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A spatiotemporal coding mechanism for background-invariant odor recognition</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1830</fpage><lpage>1839</lpage><pub-id pub-id-type="doi">10.1038/nn.3570</pub-id><pub-id pub-id-type="pmid">24185426</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulze</surname> <given-names>A</given-names></name><name><surname>Gomez-Marin</surname> <given-names>A</given-names></name><name><surname>Rajendran</surname> <given-names>VG</given-names></name><name><surname>Lott</surname> <given-names>G</given-names></name><name><surname>Musy</surname> <given-names>M</given-names></name><name><surname>Ahammad</surname> <given-names>P</given-names></name><name><surname>Deogade</surname> <given-names>A</given-names></name><name><surname>Sharpe</surname> <given-names>J</given-names></name><name><surname>Riedl</surname> <given-names>J</given-names></name><name><surname>Jarriault</surname> <given-names>D</given-names></name><name><surname>Trautman</surname> <given-names>ET</given-names></name><name><surname>Werner</surname> <given-names>C</given-names></name><name><surname>Venkadesan</surname> <given-names>M</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name><name><surname>Louis</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dynamical feature extraction at the sensory periphery guides chemotaxis</article-title><source>eLife</source><volume>4</volume><elocation-id>e06694</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06694</pub-id><pub-id pub-id-type="pmid">26077825</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Si</surname> <given-names>G</given-names></name><name><surname>Kanwal</surname> <given-names>JK</given-names></name><name><surname>Hu</surname> <given-names>Y</given-names></name><name><surname>Tabone</surname> <given-names>CJ</given-names></name><name><surname>Baron</surname> <given-names>J</given-names></name><name><surname>Berck</surname> <given-names>M</given-names></name><name><surname>Vignoud</surname> <given-names>G</given-names></name><name><surname>Samuel</surname> <given-names>ADT</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Structured odorant response patterns across a complete olfactory receptor neuron population</article-title><source>Neuron</source><volume>101</volume><fpage>950</fpage><lpage>962</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.12.030</pub-id><pub-id pub-id-type="pmid">30683545</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensmyr</surname> <given-names>MC</given-names></name><name><surname>Dweck</surname> <given-names>HK</given-names></name><name><surname>Farhan</surname> <given-names>A</given-names></name><name><surname>Ibba</surname> <given-names>I</given-names></name><name><surname>Strutz</surname> <given-names>A</given-names></name><name><surname>Mukunda</surname> <given-names>L</given-names></name><name><surname>Linz</surname> <given-names>J</given-names></name><name><surname>Grabe</surname> <given-names>V</given-names></name><name><surname>Steck</surname> <given-names>K</given-names></name><name><surname>Lavista-Llanos</surname> <given-names>S</given-names></name><name><surname>Wicher</surname> <given-names>D</given-names></name><name><surname>Sachse</surname> <given-names>S</given-names></name><name><surname>Knaden</surname> <given-names>M</given-names></name><name><surname>Becher</surname> <given-names>PG</given-names></name><name><surname>Seki</surname> <given-names>Y</given-names></name><name><surname>Hansson</surname> <given-names>BS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A conserved dedicated olfactory circuit for detecting harmful microbes in <italic>Drosophila</italic></article-title><source>Cell</source><volume>151</volume><fpage>1345</fpage><lpage>1357</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.09.046</pub-id><pub-id pub-id-type="pmid">23217715</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevens</surname> <given-names>CF</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A statistical property of fly odor responses is conserved across odors</article-title><source>PNAS</source><volume>113</volume><fpage>6737</fpage><lpage>6742</lpage><pub-id pub-id-type="doi">10.1073/pnas.1606339113</pub-id><pub-id pub-id-type="pmid">27247407</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname> <given-names>CY</given-names></name><name><surname>Menuz</surname> <given-names>K</given-names></name><name><surname>Reisert</surname> <given-names>J</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Non-synaptic inhibition between grouped neurons in an olfactory circuit</article-title><source>Nature</source><volume>492</volume><fpage>66</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/nature11712</pub-id><pub-id pub-id-type="pmid">23172146</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Maaten</surname> <given-names>L</given-names></name><name><surname>Hinton</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Visualizing high-dimensional data using t-sne</article-title><source>Journal of Machine Learning Research</source><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogt</surname> <given-names>RG</given-names></name><name><surname>Riddiford</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Pheromone binding and inactivation by moth antennae</article-title><source>Nature</source><volume>293</volume><fpage>161</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.1038/293161a0</pub-id><pub-id pub-id-type="pmid">18074618</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vosshall</surname> <given-names>LB</given-names></name><name><surname>Amrein</surname> <given-names>H</given-names></name><name><surname>Morozov</surname> <given-names>PS</given-names></name><name><surname>Rzhetsky</surname> <given-names>A</given-names></name><name><surname>Axel</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>A spatial map of olfactory receptor expression in the <italic>Drosophila</italic> antenna</article-title><source>Cell</source><volume>96</volume><fpage>725</fpage><lpage>736</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)80582-6</pub-id><pub-id pub-id-type="pmid">10089887</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vosshall</surname> <given-names>LB</given-names></name><name><surname>Wong</surname> <given-names>AM</given-names></name><name><surname>Axel</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>An olfactory sensory map in the fly brain</article-title><source>Cell</source><volume>102</volume><fpage>147</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(00)00021-0</pub-id><pub-id pub-id-type="pmid">10943836</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waite</surname> <given-names>AJ</given-names></name><name><surname>Frankel</surname> <given-names>NW</given-names></name><name><surname>Emonet</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Behavioral variability and phenotypic diversity in bacterial chemotaxis</article-title><source>Annual Review of Biophysics</source><volume>47</volume><fpage>595</fpage><lpage>616</lpage><pub-id pub-id-type="doi">10.1146/annurev-biophys-062215-010954</pub-id><pub-id pub-id-type="pmid">29618219</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>G</given-names></name><name><surname>Carey</surname> <given-names>AF</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name><name><surname>Zwiebel</surname> <given-names>LJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Molecular basis of odor coding in the malaria vector mosquito anopheles gambiae</article-title><source>PNAS</source><volume>107</volume><fpage>4418</fpage><lpage>4423</lpage><pub-id pub-id-type="doi">10.1073/pnas.0913392107</pub-id><pub-id pub-id-type="pmid">20160092</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wark</surname> <given-names>B</given-names></name><name><surname>Lundstrom</surname> <given-names>BN</given-names></name><name><surname>Fairhall</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Sensory adaptation</article-title><source>Current Opinion in Neurobiology</source><volume>17</volume><fpage>423</fpage><lpage>429</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2007.07.001</pub-id><pub-id pub-id-type="pmid">17714934</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>EH</given-names></name></person-group><year iso-8601-date="1996">1996</year><source>EH Weber on the Tactile Senses</source><publisher-name>Psychology Press</publisher-name></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissburg</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The fluid dynamical context of chemosensory behavior</article-title><source>The Biological Bulletin</source><volume>198</volume><fpage>188</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.2307/1542523</pub-id><pub-id pub-id-type="pmid">10786940</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Early olfactory processing in <italic>Drosophila</italic>: mechanisms and principles</article-title><source>Annual Review of Neuroscience</source><volume>36</volume><fpage>217</fpage><lpage>241</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062111-150533</pub-id><pub-id pub-id-type="pmid">23841839</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>CD</given-names></name><name><surname>Serrano</surname> <given-names>GO</given-names></name><name><surname>Koulakov</surname> <given-names>AA</given-names></name><name><surname>Rinberg</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A primacy code for odor identity</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>1477</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-01432-4</pub-id><pub-id pub-id-type="pmid">29133907</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>Y</given-names></name><name><surname>Sharpee</surname> <given-names>TO</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Using global t-SNE to preserve inter-cluster data structure</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/331611</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.45293.020</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Rieke</surname><given-names>Fred</given-names></name><role>Reviewing Editor</role><aff><institution>University of Washington</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Nagel</surname><given-names>Katherine I.</given-names></name><role>Reviewer</role><aff><institution>NYU</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Front-end Weber-Fechner gain control enhances the fidelity of combinatorial odor coding&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Catherine Dulac as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Katherine I. Nagel (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>The reviewers agreed that the work was of potential interest. They also agreed, however, that the presentation needs to be improved considerably. To be considered further, the paper needs to be revised carefully considering <italic>eLife</italic>'s broad readership. This includes unpacking details about technical aspects of the work – such as embedding and compressed sensing – and explaining the key mathematical concepts of the model in words and (better) in schematic figures. The terseness with which the results were presented made evaluating the work difficult. The individual reviews below contain specific suggestions and comments that should help identify where such changes are needed, but we would also encourage the authors to ask for comments from several non-olfactory colleagues, particularly about accessibility.</p><p>Individual reviews follow:</p><p><italic>Reviewer #1:</italic> </p><p>This paper investigates the impact of Weber adaptation in olfactory receptor neurons on olfactory coding using a model based on past experimental work (described in the paper this one is linked too). The central question should be of general interest, and the approach taken in the paper seems appropriate. I struggled, however, with the way the work is presented and this left me unsure about the conclusions reached. I am not an expert in olfaction, but I suspect these struggles will be shared by many other potential readers.</p><p>Response dynamics: I was quite confused about the importance of differences in response dynamics of different ORNs. In places the text appears to state that differences in dynamics are small (e.g. Introduction), and in others that they are important (subsection “Model of ORN sensing repertoire”). Some of this may originate from responses of a single cell to multiple odors vs. responses of different cells. Nonetheless, the present version of the paper is confusing in this regard.</p><p>Figure 2 and embedding: The embedding process used in the analysis illustrated in Figure 2 is not explained in any detail – meaning that I could not interpret Figure 2. Later in the Discussion (third paragraph) this figure is referred to with respect to response dynamics – this was particularly unclear. This figure is critical to the paper, so must be explained in more detail.</p><p>Figure 3: The use of compressed sensing in the decoding analysis in this figure is unclear. Related to this point, it's not clear how an appropriate tolerance is chosen (subsection “Front-end adaptation enhances odor discrimination in complex environments”, second paragraph). The approach to decoding needs to be described in considerable more detail.</p><p>Discrimination in complex odor environments: it is not clear here why the background should be represented as static. I would have thought it would be subject to many of the same properties that make the signal dynamic. The role/importance of short term memory is also unclear.</p><p>It would be interesting to see how important ORN-specific adaptation is for the results presented, as compared to a mechanism that acted universally across all ORN responses.</p><p>Equation 1: The origin of this equation could get explained in more detail.</p><p>Equation 2: This form of feedback, and particularly its relation to Weber adaptation, should get explained more.</p><p><italic>Reviewer #2:</italic> </p><p>This manuscript asks how adaptation in olfactory receptor neurons (ORNs) impacts the ability of an olfactory system to encode odor identities reliably. There is a broad consensus in the field that odors are encoded by the combinatorial activity of an array of receptors, each composed of an odor-specific receptor and a common co-receptor. At least one form of adaptation, in which the sensitivity of olfactory receptor neurons is adjusted based on the activation level of the receptor complex, is present within ORNs, likely acting at the level of feedback onto the orco co-receptor. This study uses theoretical approaches to ask how this form of adaptation impacts decoding of odor identity, using three different models of odor decoding: compressed sensing, primacy coding, and a biologically-inspired Kenyon cell model. The manuscript builds on a previous paper from the same group that developed a formulation for ORN adaptation based on a 2-state receptor model. The broad finding of the study is that front-end adaptation improves odor identity decoding using a variety of models. Overall I think this study addresses an important question and does so in a thorough way, making use of very reasonable models for both odor encoding and decoding, and providing a nice overview of the state of the field. However, I think some elements of the exposition could be made more accessible for less mathematically-inclined readers, and that some additional simulations would help pinpoint the reason why front-end adaptation improves encoding.</p><p>1) The manuscript is written for a highly quantitative audience and assumes a background familiar with the various models (receptor model, compressed sensing, t-SNE) they employ. I think the paper could be made more accessible by unpacking some of the mathematical formulae in the main text.</p><p>For example, it would be helpful to show a plot of the activation function A<sub>a</sub> as a function of odor concentration (Equation 1) for some of their sample model neurons, in both the unadapted and adapted state.</p><p>In addition, the discussion of compressed sensing is highly compressed. If the authors could describe this in an intuitive or graphical way in the main Results it would help readers understand what this is and how it works.</p><p>Using a KC-inspired model to decode odor identity will probably be the most intuitive decoding scheme for many biologists. Here this decoding scheme is presented last but perhaps it might go earlier in the manuscript.</p><p>2) One possible interpretation of the results in Figures 2 and 3 is that in the non-adaptive system, high background odor concentrations cause the receptors to saturate, preventing them from encoding anything about the target odor, or at least massively compressing their dynamic range. This would mean that sensitivity adaptation is important (the activation curve needs to shift with increasing odor concentration), but not the precise form of the adaptation. Could the authors perform additional simulations to address this? For example: (1) What is the state of the receptors (distribution of activation levels) in the adapted versus un-adapted system in high background odor (prior to target odor presentation) vs. background+target? (2) How do the results in Figures 2 and 3 differ if the adaptation is not exact? That is, what if there is some factor 𝛽 in front of A<sub>a</sub>(t) in Equation 2? How precise does the adaptation have to be for this to work?</p><p><italic>Reviewer #3:</italic> </p><p>The authors describe a receptor type-independent adaptation mechanism at the level of the olfactory sensory neurons (OSNs) that maintains odor capacity in natural conditions. They proposed that adaptation or gain control follows the Weber-Fechner Law of psychophysics (previously shown by the same group) and suggest that in a biological context it may be driven by Orco co-receptor activity in a non-receptor specific manner. The model results show that this kind of adaptation can aid concentration-invariant coding, discrimination (even in the presence of background odors) as well as it agrees with the novel hypothesis of primacy coding. The topic discussed in the article is relevant and the results are convincing, it is worth publishing; I have no major concerns.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for submitting your article &quot;Front-end Weber-Fechner gain control enhances the fidelity of combinatorial odor coding&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by one peer reviewer, Fred Rieke, who is the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Catherine Dulac as the Senior Editor.</p><p><italic>Reviewer #1:</italic> </p><p>This is a revision of a paper describing a modeling approach to explore the role of front-end adaptation in olfactory coding. The paper is interesting, and contains a number of nice analyses that provide insight into the interaction between adaptation and coding. The revisions have made the paper easier to understand, but there are still several issues that are not as clear as they need to be. These, and some smaller points, are detailed below. In general (as detailed below), for each analysis I think it is essential that each of the steps involved in going from the modeled responses to a completed piece of analysis need to be clear to a non-expert reader.</p><p>1) t-SNE analysis.</p><p>The comparison of t-SNE to PCA (first paragraph of the subsection “Front-end Weber-Fechner adaptation preserves odor coding among background and intensity confounds”) is helpful. Can you build on the end of this paragraph to explain how t-SNE works, and, critically, to define the axes of Figures 2B, C? It is quite important that a reader is comfortable with what is being plotted here.</p><p>2) CS analysis.</p><p>The description of the sparseness constraint added to the paper is helpful. What is still not clear, however, is how the stimulus itself is estimated (I can guess, but it should be stated explicitly). Related to this point, the signal perturbation (Ds) is defined only in the Materials and methods but needed to interpret the main text (subsection “Front-end adaptation enhances odor decoding in complex environments”, third paragraph). It should also be clearer that you are decoding discrete odor identify, not concentration (assuming that is correct).</p><p>3) Decoding time-varying stimuli.</p><p>Several aspects of the analysis described in the fifth paragraph of the subsection “Front-end adaptation enhances odor decoding in complex environments” are not clear. Were odors randomly assigned to each whiff? And was the entire time course decoded, or was each whiff treated as a discrete event? In general, the description of this analysis needs to be considerably more detailed. Is there an intuitive argument as to why the longer time scales of adaptation are helpful that could be added to the last paragraph of the subsection “Front-end adaptation enhances odor decoding in complex environments”?</p><p>4) Tests of primacy coding.</p><p>The text suggests that the background odors may interfere with primacy coding in the absence of front-end adaptation. The analysis presented in Figure 4 then shows that primacy sets are maintained in the presence of front-end adaptation. But there is not a test, unless I missed it, of the initial suggestion that primacy sets are not maintained without front-end adaptation. This test is needed to interpret this section.</p><p>5) Interplay of front-end adaptation and divisive normalization.</p><p>Figure 5 suggests that these two forms of gain control may play quite different roles in coding discrete odor categories (aversive, appetitive) and odor identity. This is quite interesting. I would consider swapping the order of presentation so you start with a discussion of odor identify (that flows more naturally from the previous sections). The differences between the present results and those of Olsen et al. should also, at a minimum, get discussed in more detail.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.45293.021</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>This paper investigates the impact of Weber adaptation in olfactory receptor neurons on olfactory coding using a model based on past experimental work (described in the paper this one is linked too). The central question should be of general interest, and the approach taken in the paper seems appropriate. I struggled, however, with the way the work is presented and this left me unsure about the conclusions reached. I am not an expert in olfaction, but I suspect these struggles will be shared by many other potential readers.</p><p>Response dynamics: I was quite confused about the importance of differences in response dynamics of different ORNs. In places the text appears to state that differences in dynamics are small (e.g. Introduction), and in others that they are important (subsection “Model of ORN sensing repertoire”). Some of this may originate from responses of a single cell to multiple odors vs. responses of different cells. Nonetheless, the present version of the paper is confusing in this regard.</p></disp-quote><p>Our use of the wording “response dynamics” was confusing because it did not distinguish between two key contributions to ORN response: 1) odor-receptor binding and activation of the OR-Orco complex (Equation 2); 2) signal transduction and adaptation (Equations 3-4). Because odor binding and activation is nonlinear, variability in Step 1 introduces variability in the dynamic response of the ORN, even though the filter used for the firing rate is assumed the same for all ORNs. We edited the text to make clear that it is the signal transduction and adaptation dynamics that exhibit a surprising degree of invariance with respect to odor-receptor identity, not the odor binding and ion channel activation (subsection “Model of ORN sensing repertoire”, sixth paragraph).</p><disp-quote content-type="editor-comment"><p>Figure 2 and embedding: The embedding process used in the analysis illustrated in Figure 2 is not explained in any detail – meaning that I could not interpret Figure 2. Later in the Discussion (third paragraph) this figure is referred to with respect to response dynamics – this was particularly unclear. This figure is critical to the paper, so must be explained in more detail.</p></disp-quote><p>We rewrote portion of the text to better explain how the embedding is enacted, and why we use t-SNE (versus PCA) to quantify the capability of the ORN repertoire to encode diverse odorants (subsection “Front-end Weber-Fechner adaptation preserves odor coding among background and intensity confounds”, first paragraph). We added a new panel A to Figure 2 to better introduce our approach and to help the reader interpret the other panels in the figure.</p><p>The later discussion about response dynamics is intended to draw parallels between our clustering results in Figure 2 and previous published results in which time traces of spiking activity were projected to a 3-dimensional space. In both cases, responses cluster by odor identity. In these studies the authors used the entire time trace, while here we consider the response at a single time. We amended the text in the Discussion to clarify this (fifth paragraph).</p><disp-quote content-type="editor-comment"><p>Figure 3: The use of compressed sensing in the decoding analysis in this figure is unclear. Related to this point, it's not clear how an appropriate tolerance is chosen (subsection “Front-end adaptation enhances odor discrimination in complex environments”, second paragraph). The approach to decoding needs to be described in considerable more detail.</p></disp-quote><p>Indeed, our discussion of compressed sensing (CS) was too terse. We changed the first panel of Figure 3 to make it more intuitive, removing the unnecessary equations and replacing them with a simple graphic. We also added text to describe more fully the general compressed sensing framework (subsection “Front-end adaptation enhances odor decoding in complex environments”, first two paragraphs).</p><p>We have explained the details for the decoding tolerance precisely in the Materials and methods, explaining our choice for this tolerance, and noting that our results are robust to particular choices in the tolerance.</p><disp-quote content-type="editor-comment"><p>Discrimination in complex odor environments: it is not clear here why the background should be represented as static. I would have thought it would be subject to many of the same properties that make the signal dynamic. The role/importance of short term memory is also unclear.</p></disp-quote><p>We are concerned with the detection of novel odors amid odors already present, thereby assuming that backgrounds odors have persisted for some time beforehand. Given that the adaptation time for the adaptation mechanisms we discuss is on the order of 250ms, the background of odor needs not to be strictly static. If it evolved on a slower time scale it would be enough. We chose to simplify the presentation so that one of these odors is on a much slower timescale, effectively static. This may be conceivable if the foreground and background arise from spatially separated sources: e.g. a lawn may release a background “grass odor” everywhere, while a flower in that lawn releases a foreground “flower odor” localized in plumes streaming from the flower. Of course, there are other cases where one odor of interest fluctuates on the same timescale as another nuisance odor. Then the distinction between foreground and background is lost. In our framework these would be considered both foreground odors.</p><p>The role of short term memory is to limit the amount of information utilized from the past. We now mention this in the fifth paragraph of the subsection “Front-end adaptation enhances odor decoding in complex environments”.</p><disp-quote content-type="editor-comment"><p>It would be interesting to see how important ORN-specific adaptation is for the results presented, as compared to a mechanism that acted universally across all ORN responses.</p></disp-quote><p>Indeed. Thank you for the suggestion. Please see response to reviewer 2 comment #2.</p><disp-quote content-type="editor-comment"><p>Equation 1: The origin of this equation could get explained in more detail.</p><p>Equation 2: This form of feedback, and particularly its relation to Weber adaptation, should get explained more.</p></disp-quote><p>We have rewritten the text describing the model to provide more explanation and have added a step in the derivation of the former Equation (1) (now Equation 2) to make the derivation clearer. We have added paragraphs explaining the origin of Weber’s Law from the model, and two panels to Figure 1 to further illustrate the properties of the model and the Weber Law adaptation (subsection “Model of ORN sensing repertoire”;Figure 1F-1G).</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…] 1) The manuscript is written for a highly quantitative audience and assumes a background familiar with the various models (receptor model, compressed sensing, t-SNE) they employ. I think the paper could be made more accessible by unpacking some of the mathematical formulae in the main text.</p><p>For example, it would be helpful to show a plot of the activation function A<sub>a</sub> as a function of odor concentration (Equation 1) for some of their sample model neurons, in both the unadapted and adapted state.</p><p>In addition, the discussion of compressed sensing is highly compressed. If the authors could describe this in an intuitive or graphical way in the main Results it would help readers understand what this is and how it works.</p></disp-quote><p>We have rewritten large parts of the paper to make this clearer. Please see our second, third and last responses to reviewer 1’s questions.</p><disp-quote content-type="editor-comment"><p>Using a KC-inspired model to decode odor identity will probably be the most intuitive decoding scheme for many biologists. Here this decoding scheme is presented last but perhaps it might go earlier in the manuscript.</p></disp-quote><p>We were also somewhat on the fence in the ordering of the results. We opted for this presentation mainly because primacy coding and compressed sensing decoding are more easily interpretable and far more tractable computationally without the added machinery of the AL and MB connectivity. Further, primacy coding has been shown in projection neurons, one step away from ORNs, so we presented it before we discuss the AL-MB connectivity. We do note in the CS section that we will later investigate the implications of circuit mechanisms in later sections. For these reasons, we chose to keep the ordering as is.</p><p> <italic>2) One possible interpretation of the results in Figures 2 and 3 is that in the non-adaptive system, high background odor concentrations cause the receptors to saturate, preventing them from encoding anything about the target odor, or at least massively compressing their dynamic range. This would mean that sensitivity adaptation is important (the activation curve needs to shift with increasing odor concentration), but not the precise form of the adaptation. Could the authors perform additional simulations to address this? For example: (1) What is the state of the receptors (distribution of activation levels) in the adapted versus un-adapted system in high background odor (prior to target odor presentation) vs. background+target? (2) How do the results in figures 2 and 3 differ if the adaptation is not exact? That is, what if there is some factor</italic> 𝛽 <italic>in front of A<sub>a</sub>(t) in Equation 2? How precise does the adaptation have to be for this to work?</italic> </p><p>Thank you for this suggestion. This comment (and reviewer #1 last comment) suggests a need to investigate how much we can break Weber scaling and still maintain combinatorial codes. We have now extended the section on odor coding to address this issue (subsection “Front-end Weber-Fechner adaptation preserves odor coding among background and intensity confounds”). We have introduced in our model a new parameter 𝛽 that allows us to gradually break the WeberFechner’s scaling. When 𝛽=0 Weber’s law is strictly satisfied and when 𝛽=1 there is no adaptation. Increasing 𝛽 away from zero introduces a dependency of the adapted state on the background odor concentration. We added two panels in Figure 2 illustrating this.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>This is a revision of a paper describing a modeling approach to explore the role of front-end adaptation in olfactory coding. The paper is interesting, and contains a number of nice analyses that provide insight into the interaction between adaptation and coding. The revisions have made the paper easier to understand, but there are still several issues that are not as clear as they need to be. These, and some smaller points, are detailed below. In general (as detailed below), for each analysis I think it is essential that each of the steps involved in going from the modeled responses to a completed piece of analysis need to be clear to a non-expert reader.</p><p>1) t-SNE analysis.</p><p>The comparison of t-SNE to PCA (first paragraph of the subsection “Front-end Weber-Fechner adaptation preserves odor coding among background and intensity confounds”) is helpful. Can you build on the end of this paragraph to explain how t-SNE works, and, critically, to define the axes of Figures 2B, C? It is quite important that a reader is comfortable with what is being plotted here.</p></disp-quote><p>We have expanded our description of t-SNE as suggested. t-SNE only preserves local distances but not global distances. Thus, while it is a useful tool to cluster objects by similarity, the distances between clusters in the t-SNE projection are not necessarily meaningful because global distances are not preserved. We now mention this both in the main text and in the caption. We also explain in the main text that we use t-SNE primarily as a visualization method. To more rigorously quantify how well representations of odor identity are preserved, we calculate the mutual information (MI) between novel foreground odors and ORN responses in the 50-dimensional space. We also provide a short explanation of what MI is in the main text.</p><disp-quote content-type="editor-comment"><p>2) CS analysis.</p><p>The description of the sparseness constraint added to the paper is helpful. What is still not clear, however, is how the stimulus itself is estimated (I can guess, but it should be stated explicitly). Related to this point, the signal perturbation (Ds) is defined only in the Materials and methods but needed to interpret the main text (subsection “Front-end adaptation enhances odor decoding in complex environments”, third paragraph). It should also be clearer that you are decoding discrete odor identify, not concentration (assuming that is correct).</p></disp-quote><p>We added explicit description of how the stimulus is estimated in the main text together with details about the definition of the signal perturbation. We also state clearly in the main text that the result is an estimate of the magnitude of each signal component and therefore both the identity and the intensity of the signal are estimated.</p><disp-quote content-type="editor-comment"><p>3) Decoding time-varying stimuli.</p><p>Several aspects of the analysis described in the fifth paragraph of the subsection “Front-end adaptation enhances odor decoding in complex environments” are not clear. Were odors randomly assigned to each whiff? And was the entire time course decoded, or was each whiff treated as a discrete event? In general, the description of this analysis needs to be considerably more detailed. Is there an intuitive argument as to why the longer time scales of adaptation are helpful that could be added to the last paragraph of the subsection “Front-end adaptation enhances odor decoding in complex environments”?</p></disp-quote><p>We have revised the text at the location indicated in the review to address the reviewer’s concerns. Note that we hold the adaptation timescale at 250 ms, but vary the memory timescale (longer ones are more helpful). We also added a phrase in the following paragraph to provide intuition as to why longer time scales of memory are useful.</p><disp-quote content-type="editor-comment"><p>4) Tests of primacy coding.</p><p>The text suggests that the background odors may interfere with primacy coding in the absence of front-end adaptation. The analysis presented in Figure 4 then shows that primacy sets are maintained in the presence of front-end adaptation. But there is not a test, unless I missed it, of the initial suggestion that primacy sets are not maintained without front-end adaptation. This test is needed to interpret this section.</p></disp-quote><p>We have now added on Figure 4C, the results for the non-adaptive case, showing that in absence of front-end adaptation, primacy sets are not well maintained, particularly when the primacy order is small.</p><disp-quote content-type="editor-comment"><p>5) Interplay of front-end adaptation and divisive normalization.</p><p>Figure 5 suggests that these two forms of gain control may play quite different roles in coding discrete odor categories (aversive, appetitive) and odor identity. This is quite interesting. I would consider swapping the order of presentation so you start with a discussion of odor identify (that flows more naturally from the previous sections). The differences between the present results and those of Olsen et al. should also, at a minimum, get discussed in more detail.</p></disp-quote><p>This is an interesting observation. We have rewritten this part of the text as suggested and have mentioned in the main text the interesting observation made by the reviewer. We have also expanded the comparison of our results with those of Olsen et al.</p></body></sub-article></article>