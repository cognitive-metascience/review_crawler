<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">52998</article-id><article-id pub-id-type="doi">10.7554/eLife.52998</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group></article-categories><title-group><article-title>A quantitative modelling approach to zebrafish pigment pattern formation</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-162202"><name><surname>Owen</surname><given-names>Jennifer P</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8440-6822</contrib-id><email>jpo22@bath.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-2929"><name><surname>Kelsh</surname><given-names>Robert N</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-163387"><name><surname>Yates</surname><given-names>Christian A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0461-7297</contrib-id><email>c.yates@bath.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Biology and Biochemistry and Department of Mathematical Sciences, University of Bath, Claverton Down</institution><addr-line><named-content content-type="city">Bath</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Krishna</surname><given-names>Sandeep</given-names></name><role>Reviewing Editor</role><aff><institution>National Centre for Biological Sciences‐Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution>École Normale Supérieure</institution><country>France</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>27</day><month>07</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e52998</elocation-id><history><date date-type="received" iso-8601-date="2019-10-23"><day>23</day><month>10</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-06-21"><day>21</day><month>06</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Owen et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Owen et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-52998-v1.pdf"/><abstract><p>Pattern formation is a key aspect of development. Adult zebrafish exhibit a striking striped pattern generated through the self-organisation of three different chromatophores. Numerous investigations have revealed a multitude of individual cell-cell interactions important for this self-organisation, but it has remained unclear whether these known biological rules were sufficient to explain pattern formation. To test this, we present an individual-based mathematical model incorporating all the important cell-types and known interactions. The model qualitatively and quantitatively reproduces wild type and mutant pigment pattern development. We use it to resolve a number of outstanding biological uncertainties, including the roles of domain growth and the initial iridophore stripe, and to generate hypotheses about the functions of <italic>leopard</italic>. We conclude that our rule-set is sufficient to recapitulate wild-type and mutant patterns. Our work now leads the way for further in silico exploration of the developmental and evolutionary implications of this pigment patterning system.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>Zebrafish</kwd><kwd><italic>Danio rerio</italic></kwd><kwd>danio</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Zebrafish</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>SWBio DTP</award-id><principal-award-recipient><name><surname>Owen</surname><given-names>Jennifer P</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/ L00769X/1 (RNK)</award-id><principal-award-recipient><name><surname>Kelsh</surname><given-names>Robert N</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A mathematical modelling approach to understanding zebrafish stripe pattern formation exemplifies a biological rule-set sufficient to generate wild-type and a diverse range of mutant patterns.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Pattern formation - the process generating regular features from homogeneity - is a fascinating phenomenon that is as ubiquitous as it is diverse. It is a major aspect of developmental biology, with key exemplars including segmentation within the syncitial blastoderm of fruit flies (<xref ref-type="bibr" rid="bib8">Clark and Peel, 2018</xref>), digit formation in the vertebrate limb (<xref ref-type="bibr" rid="bib56">Tickle, 2006</xref>), and branching patterns in kidney and lung development (<xref ref-type="bibr" rid="bib9">Davies, 2002</xref>).</p><p>Another key example, pigment pattern formation, the process generating functional and often beautiful distributions of pigment cells, represents a classic problem in both developmental and mathematical biology. Pigment patterns allow animals to distinguish between individuals within a group and identify those of different species and are an important characteristic for the survival of most animals in wild populations. Pigment patterns are striking. They form rapidly and, in many cases, autonomously, that is, the process relies on self-organisation and not internal body structures. Additionally, they often vary dramatically between even closely related species, therefore recognising similarities and differences in the development of these related species can allow us insight into the evolutionary change. Finally, pigment pattern formation is made experimentally tractable by the self-labelling nature of pigment cells.</p><p>The horizontal blue and gold stripes of zebrafish are now one of the best-studied examples of pigment pattern formation, especially at the level of underlying cellular mechanisms (<xref ref-type="bibr" rid="bib53">Singh and Nüsslein-Volhard, 2015</xref>; <xref ref-type="bibr" rid="bib61">Watanabe and Kondo, 2015</xref>; <xref ref-type="bibr" rid="bib51">Patterson and Parichy, 2019</xref>). Zebrafish are amenable to observational studies, since all development takes place outside the mother and the skin is transparent. This, combined with the availability of multiple key mutants (affecting, for example, cell-type differentiation and patterning), and the development of innovative in vivo cell ablation and in vitro cell culture techniques, have provided a unique opportunity to investigate the cellular and molecular basis for pigment pattern formation experimentally (<xref ref-type="bibr" rid="bib13">Eom et al., 2015</xref>; <xref ref-type="bibr" rid="bib4">Budi et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Ceinos et al., 2015</xref>; <xref ref-type="bibr" rid="bib63">Yamanaka and Kondo, 2014</xref>; <xref ref-type="bibr" rid="bib14">Eom and Parichy, 2017</xref>; <xref ref-type="bibr" rid="bib19">Hamada et al., 2014</xref>; <xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>; <xref ref-type="bibr" rid="bib22">Inoue et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>; <xref ref-type="bibr" rid="bib60">Watanabe et al., 2006</xref>; <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>; <xref ref-type="bibr" rid="bib54">Svetic et al., 2007</xref>; <xref ref-type="bibr" rid="bib39">Mellgren and Johnson, 2006</xref>; <xref ref-type="bibr" rid="bib45">Parichy et al., 2000b</xref>; <xref ref-type="bibr" rid="bib24">Iwashita et al., 2006</xref>; <xref ref-type="bibr" rid="bib21">Hirata et al., 2005</xref>; <xref ref-type="bibr" rid="bib25">Kelsh et al., 1996</xref>; <xref ref-type="bibr" rid="bib32">Lister et al., 1999</xref>; <xref ref-type="bibr" rid="bib44">Parichy et al., 2000a</xref>; <xref ref-type="bibr" rid="bib34">Maderspacher and Nüsslein-Volhard, 2003</xref>; <xref ref-type="bibr" rid="bib59">Walderich et al., 2016</xref>; <xref ref-type="bibr" rid="bib49">Patterson et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">McMenamin et al., 2014</xref>; <xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>; <xref ref-type="bibr" rid="bib31">Krauss et al., 2014</xref>; <xref ref-type="bibr" rid="bib48">Parichy and Turner, 2003</xref>; <xref ref-type="bibr" rid="bib12">Eom et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Mahalwar et al., 2016</xref>; <xref ref-type="bibr" rid="bib35">Mahalwar et al., 2014</xref>; <xref ref-type="bibr" rid="bib1">Asai et al., 1999</xref>; <xref ref-type="bibr" rid="bib55">Takahashi and Kondo, 2008</xref>).</p><p>The cellular composition of the stripes and how these become assembled has been well-described. Zebrafish generate, over a period of a few weeks and beginning around 3 weeks of age (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>), a robust adult stripe pattern of alternating dark blue stripes and golden interstripes comprised of three different pigment-producing cell types: melanocytes, containing black melanin; xanthophores containing yellow and orange carotenoids and pteridines; and iridescent iridophores, containing guanine crystals within reflective platelets (<xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>; <xref ref-type="fig" rid="fig1">Figure 1A</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>WT stripe composition and development.</title><p>(<bold>A</bold>) An adult wild type (WT) fish. Stripes and interstripes are labelled according to their order of temporal appearance. X0 is the first interstripe to appear. 1D and 1V (D - Dorsal, V- Ventral) are the first two stripes to appear. X1D and X1V are the next two interstripes to appear and so on. Image reproduced from <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref> and licensed under CC-BY 4.0 (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0">https://creativecommons.org/licenses/by/4.0</ext-link>). (<bold>B</bold>) Summary of pigment cell distribution in adult zebrafish. The cells in the xanthophore, S-iridophore, melanophore and L-iridophore layers consist of xanthophores and xanthoblasts, melanophores, S-iridophores and L-iridophores, respectively. Adapted from <xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>. (<bold>C</bold>) Schematic of WT patterns on the body of zebrafish. Stages PB, PR, SP, J+ correspond to developmental stages described in 3. Patterns form sequentially outward from the central interstripe, labelled X0, with additional dorsal stripes and interstripes labelled 1D, X1D, 2D, X2D from the centre (horizontal myoseptum) dorsally outward (similarly, ventral stripes and interstripes are labelled 1V, X1V, 2V, etc).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig1-v1.tif"/></fig><p>Of the iridophores, there are two types distinguished by their platelet distribution (<xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>); type L-iridophores, and type S-iridophores. Only type S-iridophores play a role in stripe formation (type L-iridophores appear later and are likely involved in pattern maintenance [<xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>]), and they appear in two different forms. In the light interstripes, S-iridophores appear in a ‘dense’ arrangement (dense S-iridophores), forming a continuous sheet, whilst in the dark stripes the cells are in a ‘loose’ arrangement and appear more widely spaced (loose S-iridophores) (<xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>; <xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). Pigment cells are found in the hypodermis below the dermis, and organised as layers of cells consistently stacked in the same order (<xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>). Starting from the deepest layer of the hypodermis just above the muscle and moving to the dermis, adult dark stripes consist of consecutive layers of L-iridophores, melanocytes, loose S-iridophores and xanthophores. Similarly, adult light interstripes are made up of layers of dense S-iridophores and xanthophores (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; <xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>). The final striped pattern is generated by the self-organisation of xanthophores, melanocytes, loose and dense S-iridophores into the appropriate positions within the hypodermis.</p><p>Prior to the initiation of adult stripe formation zebrafish exhibit a larval pigment pattern, formed in the first 5 days of development. Embryonic pigment cells form a distinctive early larval pattern that is essentially complete by 5 days post-fertilisation (dpf) and remains unchanged until metamorphosis. This pattern consists of melanocytes in four stripes (dorsal to the central nervous system, within the horizontal myoseptum, dorsal to the gut and ventrally under the yolk; S-iridophores are found associated with three of these melanocyte stripes [<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>; <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>]). Xanthophores lie in a monolayer under the skin, filling the areas between the melanocytes above the CNS and extending ventrally to the level of the gut. Formation of the adult pattern involves replacement of melanocytes and S-iridophores with new cells derived from adult pigment stem cells. Early larval xanthophores dedifferentiate, forming unpigmented xanthoblasts that regain their proliferative ability and proceed to generate the adult xanthophores (<xref ref-type="bibr" rid="bib38">McMenamin et al., 2014</xref>; <xref ref-type="bibr" rid="bib35">Mahalwar et al., 2014</xref>; <xref ref-type="bibr" rid="bib45">Parichy et al., 2000b</xref>); an unknown proportion of the latter may derive from de novo production from adult pigment stem cells (<xref ref-type="bibr" rid="bib27">Kelsh et al., 2017</xref>). Xanthophore de-differentiation is complete by 21dpf, and early metamorphic melanocytes appear in a widely scattered distribution between 14 and 21dpf (<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>), thus forming the initial metamorphic pattern (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, stage PB). A key event in the initiation of adult pattern metamorphosis is the appearance of newly differentiated dense S-iridophores alongside the horizontal myoseptum. In response to the appearance of these S-iridophores, the first adult xanthophores are generated (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, stage PR) by differentiation from xanthoblasts in this region, thus initiating the first interstripe, X0. Furthermore, metamorphic melanocytes begin to accumulate either side of this central interstripe, marking the first two stripes denoted 1D and 1V (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, stage PR). Subsequently, S-iridophores proliferate rapidly and spread bidirectionally; at the edges of the interstripes they switch to a more scattered (less tightly-packed) form as they continue to spread dorsally and ventrally. Spreading loose S-iridophores transition back into dense S-iridophores at the locations of the future interstripes X1V and X1D (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, stages PR to SP) (<xref ref-type="bibr" rid="bib35">Mahalwar et al., 2014</xref>). Once S-iridophores aggregate at the next interstripe, the process starts again, that is, xanthophores differentiate in response to the dense S-iridophores and melanocytes accumulate either side of the new interstripe generating the subsequent stripe. This process of S-iridophore aggregation predetermining future interstripe locations and subsequent delamination in future stripe regions repeats until S-iridophores cover the domain and all stripes (between 4 and 5) and interstripes are fully formed (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, stage J+).</p><p>In addition to the description of pattern development (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>), many studies have identified individual patterning mechanisms that contribute to stripe formation, although it is unclear whether these are sufficient to explain pattern formation. Stripe generation is complex and requires many interactions. During pattern metamorphosis, these interactions may determine cell birth (<xref ref-type="bibr" rid="bib35">Mahalwar et al., 2014</xref>), cell death (<xref ref-type="bibr" rid="bib55">Takahashi and Kondo, 2008</xref>), cell migration (<xref ref-type="bibr" rid="bib63">Yamanaka and Kondo, 2014</xref>; <xref ref-type="bibr" rid="bib55">Takahashi and Kondo, 2008</xref>; <xref ref-type="bibr" rid="bib49">Patterson et al., 2014</xref>), long-distance communication, through stabilisation of elongated cellular projections (<xref ref-type="bibr" rid="bib14">Eom and Parichy, 2017</xref>; <xref ref-type="bibr" rid="bib13">Eom et al., 2015</xref>), as well as the shape transitions of S-iridophores (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). During this period, there is also simultaneous two-dimensional domain growth (<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>). The pattern is formed by cell–cell interactions of all three pigment producing cell types: melanocytes, xanthophores and S-iridophores. Without any one of these cell types, pattern formation is disrupted (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>).</p><p>Mathematical modelling has been a complementary tool in assessing possible patterning mechanisms. Until the last few years, these studies have focused on melanocytes and xanthophores, neglecting S-iridophores. The most commonly used mathematical paradigm for stripe formation takes the form of a Turing reaction-diffusion model. In these representations, melanocytes and xanthophores diffuse and interact via a few long- and short-range ‘reactions’. This class of model typically rely on a small number of parameters which, upon being altered, can generate a diverse range of patterns. Minimal models such as these have the benefit that they are sometimes analytically tractable, allowing a deep understanding of the model. However, a potential limitation is that parameters do not always have a clear biological interpretation which, can sometimes make it difficult to link parameters to measurable data. In the context of zebrafish stripe formation, these models have not yet incorporated S-iridophores (<xref ref-type="bibr" rid="bib61">Watanabe and Kondo, 2015</xref>; <xref ref-type="bibr" rid="bib28">Kondo, 2017</xref>; <xref ref-type="bibr" rid="bib43">Painter et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Bloomfield et al., 2011</xref>; <xref ref-type="bibr" rid="bib2">Binder and Simpson, 2013</xref>; <xref ref-type="bibr" rid="bib57">Volkening and Sandstede, 2015</xref>; <xref ref-type="bibr" rid="bib28">Kondo, 2017</xref>; <xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>; <xref ref-type="bibr" rid="bib41">Moreira and Deutsch, 2005</xref>; <xref ref-type="bibr" rid="bib5">Bullara and De Decker, 2015</xref>; <xref ref-type="bibr" rid="bib62">Yamaguchi et al., 2007</xref>; <xref ref-type="bibr" rid="bib1">Asai et al., 1999</xref>). They suggest that the role for iridophores is restricted to simply orienting stripes (<xref ref-type="bibr" rid="bib57">Volkening and Sandstede, 2015</xref>; <xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>; <xref ref-type="bibr" rid="bib2">Binder and Simpson, 2013</xref>). New biological observations demonstrate that S-iridophores play a fundamental role in body stripe formation (<xref ref-type="bibr" rid="bib53">Singh and Nüsslein-Volhard, 2015</xref>; <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>). In particular, it has been shown that without S-iridophores, spots of melanocyte aggregates form instead of stripes, which is contrary to what these Turing reaction-diffusion models predict. These findings have paved the way for more detailed modelling, such as that of <xref ref-type="bibr" rid="bib58">Volkening and Sandstede, 2018</xref>, who demonstrated (using an off-lattice individual-based model) the need for understanding S-iridophore behaviour when representing all three cell-types. For these reasons, we consider an inclusive modelling approach, incorporating the crucial cell-type S-iridophores and the full range of interactions depicted above.</p><p>Here, in a bottom-up approach, we hypothesise that the current biological understanding is sufficient to explain the major aspects of pigment pattern development and construct a model to test this. In particular, we construct an agent-based model incorporating all three pigment cell-types and their documented cellular interactions. We use observations of a set of three mutants that each lack an individual cell-type, plus the three double mutant combinations lacking pairs of cell-types, to deduce the key rules likely underpinning S-iridophore dynamics. Combining these assumptions with experimentally verified biological mechanisms in the literature, we generate a working model of adult pattern formation. We then run simulations for wild type (WT) and these mutant fish. We show that in each case our model correctly predicts the patterns observed in vivo, and that pattern development displays multiple quantitative matches to that in vivo using a parameter sampling methodology to demonstrate the robustness of these patterns to parameter variation. In an independent test of the model, we simulate mutants with pigment pattern defects caused by changes other than to the presence of pigment cell-types, and show that these too are successfully matched in silico by our model.</p><p>Our work demonstrates that current biological understanding, alongside simple assumptions about S-iridophore behaviour, is sufficient to explain adult pigment pattern formation in WT and multiple mutants. Our work reinforces the growing realisation in the field that the previously neglected S-iridophores are crucial for stripe formation, suggests a minimum set of their rules, and reveals unexpected subtleties to the phenotypic impact of the well-studied <italic>leo</italic> mutant.</p></sec><sec id="s2" sec-type="materials|methods"><title>Materials and methods</title><sec id="s2-1"><title>Modelling overview</title><p>We build our model with direct reference to the known biology. We model five cell types as individual agents: melanocytes (<inline-formula><mml:math id="inf1"><mml:mi>M</mml:mi></mml:math></inline-formula>), xanthophores (<inline-formula><mml:math id="inf2"><mml:mi>X</mml:mi></mml:math></inline-formula>), xanthoblasts (<inline-formula><mml:math id="inf3"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>), the unpigmented precursor cell to xanthophores) and S-iridophores in either dense or loose form (<inline-formula><mml:math id="inf4"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf5"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula>, respectively). These are the cells we deem from the literature to be crucial for successful pattern formation. We do not directly model L-iridophores, since these appear after the adult pattern is formed and are more likely involved in pattern maintenance (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). Unlike previous models of stripe formation (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>; <xref ref-type="bibr" rid="bib5">Bullara and De Decker, 2015</xref>; <xref ref-type="bibr" rid="bib57">Volkening and Sandstede, 2015</xref>; <xref ref-type="bibr" rid="bib43">Painter et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Bloomfield et al., 2011</xref>; <xref ref-type="bibr" rid="bib58">Volkening and Sandstede, 2018</xref>), we include xanthoblasts as an independent cell-type in our model. This is because the larval xanthoblasts appear principally by dedifferentiation of the embryonic xanthophores, and most metamorphic xanthophores arise from the larval xanthoblasts (<xref ref-type="bibr" rid="bib35">Mahalwar et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">McMenamin et al., 2014</xref>; <xref ref-type="bibr" rid="bib4">Budi et al., 2011</xref>; <xref ref-type="bibr" rid="bib52">Singh et al., 2014</xref>; <xref ref-type="bibr" rid="bib11">Dooley et al., 2013</xref>), whilst xanthoblasts that do not re-differentiate into xanthophores persist in the stripe regions where they play a role in consolidating melanocytes into stripes.</p><p>Zebrafish pattern formation generates distinct pigment cell layers in the hypodermis (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) a melanocyte, xanthophore and S-iridophore layer (<xref ref-type="bibr" rid="bib20">Hirata et al., 2003</xref>; <xref ref-type="bibr" rid="bib21">Hirata et al., 2005</xref>). For consistency, we model each of the three layers as independent, two-dimensional lattice domains throughout pattern formation (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Model setup and simulation.</title><p>(<bold>A</bold>) An example model setup. The domain is made up of three layers. Layer <inline-formula><mml:math id="inf6"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> which contains yellow <inline-formula><mml:math id="inf7"><mml:mi>X</mml:mi></mml:math></inline-formula> (yellow circles) and unpigmented <inline-formula><mml:math id="inf8"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> (clear circles with black outline). Layer <inline-formula><mml:math id="inf9"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> which contains silvery <inline-formula><mml:math id="inf10"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> (white circles) and blue <inline-formula><mml:math id="inf11"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> (blue circles). Layer <inline-formula><mml:math id="inf12"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula> which contains black <inline-formula><mml:math id="inf13"><mml:mi>M</mml:mi></mml:math></inline-formula> (black circles) only. Each lattice site on each of the respective layers contain at most one cell at any given time. The layers are stacked on top of each other as seen in real fish. We note that in our simulations the ordering of the layers does not play any role in determining pattern formation. (<bold>B</bold>) Schematics of model implementation. (1) The model is initialised as described in Appendix 1. (2) The model is checked for the requirements for a fixed event to occur (e.g. new cells differentiating at a given time). If there is a fixed event to be implemented, the algorithm moves to stage 3. Otherwise, the algorithm passes to stage 4. (3) The model is updated according to the fixed event and algorithm returns to stage 2. (4) The propensity functions - probabilities for all other events to occur <inline-formula><mml:math id="inf14"><mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>15</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are calculated. (5) Random numbers <inline-formula><mml:math id="inf15"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are generated. (6) Numbers <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are used to determine the time <inline-formula><mml:math id="inf17"><mml:mi>τ</mml:mi></mml:math></inline-formula> until the next event and which event will be implemented. (7) The model configuration is updated. (8) The algorithm checks if the end criterion is satisfied, that is in the case of WT, that <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>13.5</mml:mn><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. If so, the algorithm finishes. Otherwise the algorithm continues, returning to stage 2. (9) The simulation completes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig2-v1.tif"/></fig><p>Agents representing <inline-formula><mml:math id="inf19"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf20"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf21"><mml:mi>M</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf23"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> occupy lattice sites, within xanthophore, melanocyte and S-iridophore domains respectively (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). To account for the different packing densities of the cell types, lattice sites within the xanthophore and S-iridophore model layers are half the width and length of melanocyte sites size. This packing density does not have an impact on pattern formation, but, is included for biological realism. (For more details, see Appendix 1). Within each layer, volume exclusion properties hold: no two agents can occupy the same site at any one time (i.e. cells do not overlap).</p><p>The system is initialised to represent a typical WT fish shortly after the start of adult pigment pattern development (≈25 dpf). We set the domain height to be 1 mm, since this is the approximate height of the fish at 25 dpf (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref> for details), we set the domain length to be 2 mm, representing approximately one-third of the full length, from the tip of the snout to the start of the tail, at 25 dpf, and thus equivalent to the trunk (<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>). We populate the domain itself at <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> as an approximation of the observed larval pattern at 25 dpf (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). At this time, there is a central stripe of dense S-iridophores along the horizontal myoseptum, scattered melanocytes and de-differentiated xanthophores (xanthoblasts) scattered across the domain. We model this by populating the central three rows of the S-iridophore layer with dense S-iridophores, and by distributing melanocytes uniformly at random into sites within the melanocyte domain at density 0.04 and xanthoblasts uniformly at random into sites in the xanthophore domain at density 0.4.</p><p>The model is then updated according to the Gillespie algorithm (<xref ref-type="bibr" rid="bib18">Gillespie, 1977</xref>). An overview of how the model is updated is given in <xref ref-type="fig" rid="fig2">Figure 2B</xref> and can be described as follows. At any given time <inline-formula><mml:math id="inf25"><mml:mi>t</mml:mi></mml:math></inline-formula>, the model is first assessed for meeting the criteria of a fixed event. Fixed events are all biologically determined events that occur once at a fixed time. For example at the start of pattern formation, the appearance of dense S-iridophores along the horizontal myoseptum is a fixed event. If the model meets the criteria, the fixed event occurs, is subsequently marked as complete and the simulation continues. If no fixed time event is to be implemented then one of 15 possible continuous time events is attempted. To do this, we treat all the potential actions, (for example cell birth or domain growth [as described in Section &quot;Modelling assumptions&quot;]), as individual ‘events’, each with an exponentially distributed waiting time which corresponds to their rate of occurrence (as specified in the literature <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>). To update the model at any given time <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, an exponentially distributed waiting time; <inline-formula><mml:math id="inf27"><mml:mi>τ</mml:mi></mml:math></inline-formula> is generated until the next possible ‘event’ occurs (based on the rates of all of the possible events). Next, a random number <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> determines which event occurs based on the relative probability of each event occurring. Once an event is chosen, the domain is updated accordingly: if conditions required for that event to occur are met, the event is implemented, whereas if they are not then there is no change. Time is also now updated to <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. This process repeats until we reach the end of pattern metamorphosis, defined by the simulated field standard length reaching approximately 13.5 mm (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). The stochastic nature of our algorithm means that in any given simulation, the final pattern and its individual development will be inherently different to any other simulation, just as in real fish. Events incorporated into our model include all processes involved in the self-organisation of pigment cells during pattern metamorphosis as well as uniform domain growth with rate 0.13 mm per day in horizontal axis and 0.033 mm per day in the vertical axis (<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>). These events are described in more detail in Section &quot;Modelling assumptions&quot;.</p><p>Cells interact in the fish skin at both short (neighbouring cells) and long (up to half a stripe width ≈0.25 mm) range, with interactions thought to use direct contact through cellular extensions (filopodia, dendrites, or longer airenemes). In our model, uniform disks, with radii on the order of the distance between 2 cells (≈0.04 mm) account for short-range interactions (<xref ref-type="fig" rid="fig3">Figure 3A–D</xref>), and an annulus with an outer radius of 0.24 mm (12 cells) and inner radius of 0.22 mm, (11 cells) represent long-range dynamics (<xref ref-type="fig" rid="fig3">Figure 3E–H</xref>). We allow cell interactions across different layers (as in real pattern formation). Cells that are chosen for movement can move into one of eight sites local to them. The probability of movement in one of the eight direction is biased according to how attracted or repelled the focal cell is to its local neighbours (<xref ref-type="fig" rid="fig3">Figure 3I–J</xref>). For more detail about how short- and long-range interactions are implemented see Appendix 1. See <xref ref-type="supplementary-material" rid="supp4">Supplementary files 4</xref>, <xref ref-type="supplementary-material" rid="supp5">5</xref> and <xref ref-type="supplementary-material" rid="supp6">6</xref> for a detailed justification of the rates, interaction types and parameter values, respectively.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Simulating short- and long-range interactions.</title><p>(<bold>A</bold>–<bold>F</bold>) Comparing the number of cells in the short (<bold>A</bold>–<bold>D</bold>) and long (<bold>E</bold>–<bold>F</bold>) range distance (0.04 mm) from a central site, on different domain types. <inline-formula><mml:math id="inf30"><mml:mi>M</mml:mi></mml:math></inline-formula> are represented as black circles. <inline-formula><mml:math id="inf31"><mml:mi>X</mml:mi></mml:math></inline-formula> are represented as yellow circles. (<bold>A</bold>–<bold>B</bold>) A visualisation of sites (marked in red) local to central melanocyte on the (<bold>A</bold>) melanocyte domain and (<bold>B</bold>) xanthophore domain.(<bold>C</bold>–<bold>D</bold>) A visualisation of sites (marked in red) local to central xanthophore on the (<bold>C</bold>) xanthophore domain and (<bold>D</bold>) melanocyte domain. (<bold>E</bold>–<bold>F</bold>) A visualisation of sites (marked in red) long-distance to central melanocyte on the (<bold>E</bold>) melanocyte domain and (<bold>F</bold>) xanthophore domain.(<bold>G</bold>–<bold>H</bold>) A visualisation of sites (marked in red) long-distance to central xanthophore on the (<bold>G</bold>) xanthophore domain and (<bold>H</bold>) melanocyte domain. (<bold>I</bold>) Melanophore movement with respect to local neighbours. If a melanophore located in a central position (marked in dark grey) attempts to move, the melanophore will consider neighbours in all sites marked in red on the melanophore domain (left), xanthophore and S-iridophore domain (right). (<bold>J</bold>) Movement on xanthophore/iridophore domain with respect to local neighbours. If a xanthophore/iridophore located in a central position (marked in dark grey) attempts to move, the xanthophore/iridophore will consider neighbours in all sites marked in red on the xanthophore and S-iridophore domain (left), melanophore domain (right).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig3-v1.tif"/></fig></sec><sec id="s2-2"><title>Modelling assumptions</title><p>In this section, we describe our modelling assumptions with regard to cell–cell interactions. These assumptions include all the known interactions between melanocytes, dense S-iridophores, loose S-iridophores, xanthophores and xanthoblasts, as well as some predictions about S-iridophore behaviour which have not been experimentally investigated in the literature. Apart from those involving S-iridophores, all the interactions and wherever possible their quantitative properties (strength, frequency etc) come directly from the literature, and are summarised in <xref ref-type="fig" rid="fig4">Figure 4G</xref>, 1-14, and described in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>. These include interactions influencing the movement, proliferation, differentiation and death of all cell types. These are represented explicitly in the model in as biologically realistic a manner as possible, at their determined rates.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>‘Missing cell’ mutants and cell-cell interactions implemented.</title><p>(<bold>A</bold>–<bold>F</bold>) Adult phenotype of the set of fish used to deduce S-iridophore interactions. (<bold>A</bold>) WT fish, (<bold>B</bold>) <italic>shady</italic> (<italic>shd</italic>), (<bold>C</bold>) <italic>nacre</italic>(<italic>nac</italic>), (<bold>D</bold>) <italic>pfeffer</italic> (<italic>pfe</italic>), (<bold>E</bold>) <italic>nac;pfe</italic>, (<bold>F</bold>) <italic>shd;pfe</italic>. (<bold>G</bold>) A representation of all the interactions implemented in the model. See <xref ref-type="supplementary-material" rid="supp4">Supplementary files 4</xref> and <xref ref-type="supplementary-material" rid="supp5">5</xref> for a detailed justification of the rates and interaction types, respectively. See <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref> for a detailed justification of all parameters. The direction of the arrow/inhibition sign indicates which cell is acting on which. For example in assumption 13, the blue arrow from melanophore to xanthophore indicates that melanophores attract (green background) xanthophores. The purple inhibition arrow indicates that the xanthophores repel melanophores. OR statements in assumptions 15–18 are logical OR statements. For example, conditons 15 and 16 indicate that a dense S-iridophore may become loose if there are melanophores in the short range OR, there are no xanthophores in the short range AND many xanthophores in the long range. (<bold>H</bold>) A visualisation of measurements HAA and SL. (<bold>I</bold>) Plots of SL versus days post-fertilisation (dpf) for 40 model realisations. Each coloured line is a single realisation. Black squares are SL versus days post-fertilisation extracted from <xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref> in real fish given in <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>. Red diamonds are the mean SL versus days post-fertilisation from 40 simulations. (<bold>J</bold>) Plots of SL (mm) versus HAA (mm) for 40 model realisations. Each coloured line is a single realisation. Black squares are SL versus HAA extracted from <xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref> given in <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>. Red diamonds are the mean HAA versus SL from 40 simulations. Error bars are one standard deviation. The model agrees well with the data in both cases. Images (<bold>A</bold>–<bold>F</bold>) reproduced from <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref> and licensed under CC-BY 4.0 (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0">https://creativecommons.org/licenses/by/4.0</ext-link>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig4-v1.tif"/></fig><p>The interactions involving S-iridophores have not been well-characterised experimentally, so we have developed our own predictions based on the literature describing S-iridophore behaviour during pattern metamorphosis. It has been shown using clonal cell analysis that during pattern metamorphosis S-iridophores spread across the skin of the zebrafish bidirectionally by proliferation of existing cells (between once and twice per day) combined with quick migration (<xref ref-type="bibr" rid="bib35">Mahalwar et al., 2014</xref>). We further predict that dense S-iridophores show a directional bias towards xanthophores in the short range. We propose that dense S-iridophores are attracted in the short range to xanthophores since they are highly associated with each other in each of the mutants and in WT (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>), and this mutual attraction may be important for interstripe consolidation. Furthermore, loose S-iridophores show a directional bias away from other loose S-iridophores in the short range. We propose that loose S-iridophores are repelled by other loose S-iridophores as this would facilitate the prompt spreading of loose S-iridophores across the stripe regions.</p><p>Interestingly, as the S-iridophores spread they switch between a loose and dense form, predetermining the positioning of stripes and interstripes consecutively. In the loose form S-iridophores are spread and stellate in appearance. In contrast, in the dense form, S-iridophores are compact. The transition between the two types appears to be interchangeable. When dense S-iridophores initially spread beyond the boundary of the first X0 interstripe, they can later change to loose type (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). Similarly when loose S-iridophores reach an interstripe region, they can aggregate and form dense S-iridophores. It is not clear exactly what causes these shape transitions physically, and this is not a question we address here. It has, however, been shown that loss of Tjp1a function in <italic>sbr</italic> mutants compromises the transition of S-iridophores from dense to loose state, suggesting that Tjp1a contributes to regulation of the molecular switch that regulates S-iridophore shape changes during their dispersal (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). We envisage iridoblasts as initially differentiating in a dense form along the horizontal myoseptum, proliferate, migrate and spread, later de-differentiating and then re-differentiating into the opposite form dependent on their location with respective to other cell types (melanocytes and xanthophores).</p><p>Here, we hypothesise how the cell types affect S-iridophore type (loose or dense). The cause of these transitions is largely unknown, however, it has been suggested to be dependent on signals from melanocytes and xanthophores transmitted by gap junctions (<xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>; <xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). In order to investigate this, we consider a primary set of six mutants known to prevent the formation of one or more individual pigment cell-type. We use these to define the contribution and nature of S-iridophore interactions in pattern formation, by considering the outcomes in fish lacking each of the three cell types. Specifically we consider:</p><list list-type="bullet"><list-item><p>Mutants lacking S-iridophores: The gene <italic>shady</italic> (<italic>shd</italic>) encodes zebrafish leukocyte tyrosine kinase (Ltk) which plays a role in S-iridophore specification (<xref ref-type="bibr" rid="bib33">Lopes et al., 2008</xref>). As a result, strong <italic>shd</italic> mutants lack all S-iridophore types. The resultant adult pattern consists of a widened X0 region of xanthophores, which are flanked dorsally and ventrally by melanocytes organised as spot-like clusters in a sea of xanthophores, forming broken stripes (<xref ref-type="fig" rid="fig4">Figure 4B</xref>).</p></list-item><list-item><p>Mutants lacking melanocytes: The gene <italic>nacre</italic> (<italic>nac</italic>) encodes the transcription factor Mitfa (<xref ref-type="bibr" rid="bib32">Lister et al., 1999</xref>). <italic>nac</italic> mutants lack melanocytes throughout embryonic and larval development (<xref ref-type="bibr" rid="bib32">Lister et al., 1999</xref>). As a result, stripes do not form properly and the adult phenotype consists of a prominent X0 interstripe of dense S-iridophores and xanthophores with irregular borders, accompanied by spots of dense S-iridophores and xanthophores ventrally. The rest of the flank is filled with loose form S-iridophores (<xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p></list-item><list-item><p>Mutants lacking the xanthophore lineage: Gene <italic>pfeffer</italic> (<italic>pfe</italic>) (alternatively known as <italic>salz</italic> (<italic>sal</italic>)) encodes colony stimulating factor one receptor (csf1ra) that is expressed and required specifically in xanthophores (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>; <xref ref-type="bibr" rid="bib45">Parichy et al., 2000b</xref>). In the adult fish of strong alleles, xanthophores are almost absent in embryos, and absent in adults. The resultant adult pattern consists of a spotted melanocyte stripe pigmentation of normal alignment which fades out into a ‘salt and pepper’-like pattern more posteriorly (i.e., in the tail) (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Melanocyte spots are associated with loose S-iridophores. In the regions lacking melanocyte aggregation (the ‘salt-and-pepper’ region), S-iridophores take a dense form, with melanocytes scattered at very low density, an arrangement never seen in WT patterns.</p></list-item><list-item><p>Double mutants of the aforementioned mutant types: <italic>nac;pfe</italic>, <italic>nac;shd</italic> and <italic>shd;pfe</italic> (<xref ref-type="fig" rid="fig4">Figure 4E,F</xref> depict the adult phenotypes of <italic>nac;pfe</italic> and <italic>shd;pfe</italic> respectively, there is no image available for <italic>shd;pfe</italic>). These mutants lack two of the aforementioned cell types. The resultant adult pattern is a uniform distribution of the remaining cell type (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). These mutant phenotypes demonstrate that zebrafish stripe formation is not determined by an underlying pre-pattern, but instead is generated by cell-cell interaction.</p></list-item></list><p>Upon evaluating these mutants, we make the following deductions about S-iridophore shape transitions during pattern formation:</p><list list-type="bullet"><list-item><p>S-iridophores are initially dense and cannot change shape autonomously. This is based on observations of mutants <italic>nac;pfe</italic> which only contain S-iridophores and in which the adult phenotype consists of dense S-iridophores in a coherent sheet across the domain (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). In contrast, <italic>pfe</italic> and <italic>nac</italic> both exhibit loose and dense S-iridophores (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>), suggesting that both melanocytes and xanthophores are capable of facilitating S-iridophore shape transitions.</p></list-item><list-item><p>Melanocytes in the short range promote the transition of dense to loose, conversely, a lack of melanocytes in the short range promotes the transition of S-iridophores from loose to dense. We propose these interactions for the following reasons. Firstly, in <italic>pfe</italic> and WT, dense S-iridophores are associated with lack of melanocytes, for example within the interstripes, whilst loose S-iridophores are associated with melanocytes, for example in the stripe region. Since we predict that melanocytes are required for dense S-iridophores transition the simplest assumption is that melanocytes promotes dense to loose transitions in the short range. Since loose S-iridophores can re-aggregate to dense form in <italic>pfe</italic> we assume that this signal is bidirectional and therefore a lack of melanocytes promotes the loose to dense transition.</p></list-item><list-item><p>Xanthophores in the long range and lack of xanthophores in the short range promotes the transition from dense to loose; conversely, a lack of xanthophores in the long range as well as many xanthophores in the short range, promotes the transition from loose to dense. We propose these interactions for the following reasons. In <italic>nac</italic> and WT, dense S-iridophores are associated with xanthophores, whilst loose S-iridophores are associated with a lack of xanthophores (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). Since S-iridophores initially appear in dense form and become loose for example in <italic>nac</italic>, when there are xanthophores in a low density local to S-iridophores and high density in the far range, we predict it is this combination that promotes the transition of dense to loose in the long range. Since in <italic>nac</italic>, S-iridophores can transition back from loose to dense when the local xanthophore density is high and far xanthophore density is low, we assume the opposing interaction is also true (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>).</p></list-item></list><p>These descriptions are summarised in <xref ref-type="fig" rid="fig4">Figure 4G</xref>, 15-18. We note that in each of these cases variations of these interactions were already hypothesised by <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>. However, since their predictions did not distinguish loose and dense S-iridophores and did not indicate transition mechanisms, their predictions though similar, are extended here to incorporate these differences. The predictions we describe are the simplest possible for generating the patterns observed in the aforementioned set of fish, upon removing any one of these interactions, the model fails to generate the robust patterns we will describe (Figure 11 and Section &quot;Necessity of S-iridophore assumptions&quot;).</p><sec id="s2-2-1"><title>Comparing simulated fish with real data</title><p>In order to validate our model, we compare different aspects of our simulation (size, spatial distributions of cells, numbers of melanocytes, stripe and interstripe width) with real fish at different developmental stages. In real fish, developmental stages are categorised according to the standard length (SL) of the fish (<xref ref-type="fig" rid="fig4">Figure 4H</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>; <xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>). For consistency, we calculate the ‘stage’ of our simulations using the length of our domain and a simple calculation to generate a simulated SL (see Appendix 1). This allows us to make a direct comparison between the range of sizes obtained in model simulations and the natural range in zebrafish HAA and SL. As a test of validity of this measure, <xref ref-type="fig" rid="fig4">Figure 4I</xref> and <xref ref-type="fig" rid="fig4">Figure 4J</xref> demonstrate 40 plots of simulated SL versus days post-fertilisation (dpf) and simulated HAA versus SL, respectively, compared with the averaged data (<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>). These figures demonstrate that whilst growth rates are variable within simulations (as seen in real fish), the mean of our simulated rates approximately matches that in real fish.</p></sec></sec></sec><sec id="s3" sec-type="results"><title>Results</title><sec id="s3-1"><title>Modelling simulations</title><p>Having deduced this minimal rule-set from the literature and our further predictions from the phenotypes of the selected primary set of mutants, indicated in Section &quot;Modelling overview&quot; we use these as the basis for our model. We use our model to generate stochastic simulations of pigment pattern formation corresponding to the the period of adult metamorphic pigment pattern formation, during which the SL extends from 7.6 mm to 13.5 mm. We note that adult pattern metamorphosis and the appearance of metamorphic S-iridophores starts earlier, around 6–7 mm SL (<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>). We initialise later at 7.6 mm as by this time the skin lying over the horizontal myoseptum is populated with an initial stripe of dense S-iridophores. We intialise our model accordingly to match this. Subsequently, we first assess the ability of the model to reproduce natural growth at a quantitative level, and then to generate the WT pigment pattern, both qualitatively and quantitatively. We then go on to simulate conditions corresponding to our primary set of mutants, considering the qualitative fit to the published patterns. To test robustness of the patterns, we provide a rigorous robustness analysis by carrying out one hundred repeats of the WT simulation and ‘missing cell’ mutants with perturbed parameter values chosen uniformly at random from the range 0.75–1.25 of their described value and show that in each case, the appropriate pattern is preserved. Finally, in a more rigorous test of the predictive power of our model, we explore three further mutant phenotypes that had not been considered in deriving the model’s rule-set.</p><sec id="s3-1-1"><title>Simulation of WT pattern</title><p>In this section, we compare qualitatively our simulations of WT fish. For WT simulations, the model rules are given in Section &quot;Modelling overview&quot;. <xref ref-type="fig" rid="fig5">Figure 5A–D</xref> depicts WT development, while <xref ref-type="fig" rid="fig5">Figure 5A’–D’</xref> (<xref ref-type="video" rid="video1">Video 1</xref>) shows a representative simulation using the model described by the rules in Section &quot;Modelling overview&quot;. The simulations reproduce qualitatively most aspects of the biological pattern. The model is initialised at stage PB. At stage PR, we begin to see an accumulation of melanocytes either side of the initial interstripe and differentiation of new xanthophores. Furthermore, we see the development of 1D and 1V stripe regions and delamination of S-iridophores from dense to loose form at the edges of interstripe X0. At stage SP, we observe the spreading of loose S-iridophores across the two developing stripe regions. Finally at stage J+, we see three interstripes alternating with five dark stripes. The final pattern matches the stripes seen in the real WT fish and the cellular component of dark stripes (<inline-formula><mml:math id="inf32"><mml:mi>X</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf33"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf34"><mml:mi>M</mml:mi></mml:math></inline-formula>) and light interstripes (<inline-formula><mml:math id="inf35"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf36"><mml:mi>X</mml:mi></mml:math></inline-formula>) matches the composition of pigment cells in real fish (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). We emphasise that the simulations presented here (as well as in future sections) are a representative example of the model output.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Representative simulation of WT, <italic>shd</italic>, <italic>nac</italic> and <italic>pfe</italic>.</title><p>(<bold>A</bold>–<bold>D</bold>), (<bold>E</bold>–<bold>H</bold>), (<bold>I</bold>–<bold>L</bold>), (<bold>M</bold>–<bold>P</bold>) WT, <italic>shd</italic>, <italic>nac</italic>, <italic>pfe</italic> development respectively and (<bold>A’</bold>–<bold>D’</bold>), (<bold>E’</bold>–<bold>H’</bold>), (<bold>I’</bold>–<bold>L’</bold>), (<bold>M’</bold>–<bold>P’</bold>) corresponding model simulation. Red arrows: melanocytes in the skin layer, modelled in (<bold>A</bold>). White arrows indicate the embryonic pattern of melanocytes in four stripes, that are deeper than the skin level and are consequently not included in the model. See <xref ref-type="video" rid="video1">Videos 1</xref>–<xref ref-type="video" rid="video4">4</xref> for representative examples of these simulations in movie format. Scale bar is 0.25 mm for all images. Experimental images (<bold>A</bold>–<bold>D</bold>), (<bold>E</bold>–<bold>H</bold>), (<bold>I</bold>–<bold>L</bold>), (<bold>M</bold>–<bold>P</bold>) reproduced from <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref> and licensed under CC-BY 4.0 (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0">https://creativecommons.org/licenses/by/4.0</ext-link>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig5-v1.tif"/></fig><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-52998-video1.mp4"><label>Video 1.</label><caption><title>Simulated development of WT.</title></caption></media></sec><sec id="s3-1-2"><title>Robustness of the model</title><p>Due to the abundance of parameters and cell-cell interactions necessary to capture what is known biologically about zebrafish pigment pattern formation, it is not feasible to perform an exhaustive parameter sweep to demonstrate the robustness of the model. Instead, as a test of robustness, we perform a rigorous robustness analysis by carrying out one hundred repeats of the WT simulation with perturbed parameter values chosen uniformly at random from the range 0.75–1.25 of their described value. The precise value of each parameter is sampled uniformly from this region, independentally for each parameter and each repeat. Twenty of these randomly sampled repeats are given in <xref ref-type="fig" rid="fig6">Figure 6</xref>. We observe that for all one hundred repeats that small perturbations to the rates still generate consistent striping, demonstrating the robustness of the model.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Example WT simulations at stage J+ when the parameters governing the rate of proliferation, movement, differentiation and death are perturbed slightly.</title><p>Each square is an example WT simulation at stage J+ where each rate parameter is perturbed to 1+<inline-formula><mml:math id="inf37"><mml:mi>x</mml:mi></mml:math></inline-formula> times its normal value. The value <inline-formula><mml:math id="inf38"><mml:mi>x</mml:mi></mml:math></inline-formula> is chosen uniformly at random from the set <inline-formula><mml:math id="inf39"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.25</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>0.25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig6-v1.tif"/></fig></sec><sec id="s3-1-3"><title>Simulation of ‘missing’ cell mutants</title><p>In the next four sections (3.1.2–3.1.2), we compare qualitatively our simulations of mutants lacking one or more cell types. For the case of generating these mutants, we simulate the same WT model except we remove the appropriate cell type from the initial conditions and turn off cell birth of that cell type to match the mutation. For example, in <italic>shd</italic> we remove S-iridophores from the initial conditions and switch off S-iridophore birth. No other changes are made. For more information about mutant implementation see Appendix 2. These mutants often display similar features to WT fish; however, some aspects of the stripe formation are incomplete. In order to describe these differences, with reference to <italic>pfe</italic>, <italic>shd</italic> and later in <italic>sbr</italic>, we define pseudo-stripes as the spots of melanophore aggregates that appear in a stripe-like orientation reminiscent of that in WT fish. We describe the pseudo-stripes in the order they appear as in WT fish. For example, we define pseudo-1D and pseudo-1V to be the first pseudo-stripes.</p><p>We demonstrate here the capability of our model simulations to reproduce qualitatively the pattern development of these mutants. For each mutant, we describe the initialisation of the model domain to match the fish at stage PB as well as all of the similarities observed between our model outputs and real fish at the following three developmental stages, PR, SP and J+. Finally, we describe the variation between many repeats of the model and how this correlates with real same-type siblings.</p></sec><sec id="s3-1-4"><title>The <italic>shady</italic> mutant</title><p>At stage PB (<xref ref-type="fig" rid="fig5">Figure 5E,E’</xref>), we populate the domain with some randomly dispersed melanocytes at a lower density than that in WT (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>) and some randomly dispersed xanthoblasts at the same density as WT (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). At stage PR (<xref ref-type="fig" rid="fig5">Figure 5F,F’</xref>), we observe some melanocytes beginning to differentiate in the usual 1D and 1V stripe regions. At stage SP (<xref ref-type="fig" rid="fig5">Figure 5G,G’</xref>), we observe the accumulation of melanocytes around the 1D and 1V stripe regions with a central stripe of xanthophores. Finally, at stage J+ (<xref ref-type="fig" rid="fig5">Figure 5H,H’</xref>), we observe two horizontal pseudo-stripes of melanocyte spots surrounded by xanthophores. We found that in 100 simulations, 100% of <italic>shd</italic> stage J+ mutants observed two pseudo-stripes (1D and 1V) just as in <xref ref-type="fig" rid="fig5">Figure 5H</xref>. See <xref ref-type="video" rid="video2">Video 2</xref> for a movie of the simulation.</p><media id="video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-52998-video2.mp4"><label>Video 2.</label><caption><title>Simulated development of <italic>shd</italic>.</title></caption></media><p>Moreover, pseudo-stripes varied in how stripe-like they were as observed in real fish (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). As a measure of this, we calculated the longest stretch of melanophores in a row without any significant breaks over 100 simulations. This gives an indication of the widest ‘spot’ or ‘pseudo-stripe’ of melanophores in a simulation. We found that on the average, the mean of widest spot width over one hundred simulations was 0.18 of the simulated length. The widest spot width in 100 simulations was 0.43 of the simulated length, demonstrating the variance in pseudo-stripe length without break.</p><sec id="s3-1-4-1"><title>The <italic>nacre</italic> mutant</title><p>At stage PB (<xref ref-type="fig" rid="fig5">Figure 5I,I’</xref>) we populate the domain such that there is an initial stripe of dense S-iridophores and randomly dispersed xanthoblasts at the same density as in WT. At stage PR (see <xref ref-type="fig" rid="fig5">Figure 5J,J’</xref>) we see the appearance of newly differentiated xanthophores associated with the dense S-iridophores in the initial X0 interstripe. At stage SP (<xref ref-type="fig" rid="fig5">Figure 5K,K’</xref>) we observe the switch of dense S-iridophores to loose form and the subsequent spreading of loose S-iridophores. Finally at stage J+ (<xref ref-type="fig" rid="fig5">Figure 5L,L’</xref>) we observe the jagged edges of the usually straight X0 and the formation of a second pseudo interstripe some distance below X0 just as in real <italic>nac</italic> fish (<xref ref-type="fig" rid="fig5">Figure 5L</xref>). See <xref ref-type="video" rid="video3">Video 3</xref> for a movie of the simulation.</p><media id="video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-52998-video3.mp4"><label>Video 3.</label><caption><title>Simulated development of <italic>nac</italic>.</title></caption></media></sec><sec id="s3-1-4-2"><title>The <italic>pfeffer</italic> mutant</title><p>At stage PB (<xref ref-type="fig" rid="fig5">Figure 5M,M’</xref>), we populate the domain with a central stripe of dense S-iridophores and randomly dispersed melanocytes at the same density as observed in WT (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). At stage PR (<xref ref-type="fig" rid="fig5">Figure 5N,N’</xref>), we observe the arrival of melanocytes into the prospective 1D, 1V stripe regions that is less pronounced compared with WT simulations. At stage SP (<xref ref-type="fig" rid="fig5">Figure 5O,O’</xref>), we observe the accumulation of newly differentiated melanocytes into aggregates in prospective stripe regions 1D and 1V. Finally, at stage J+, (<xref ref-type="fig" rid="fig5">Figure 5P,P’</xref>) we observe the aggregation of melanocytes (associated with loose S-iridophores) into spots, surrounded by a sea of dense S-iridophores peppered with black melanocytes. In one hundred simulations, the median number of pseudo-stripes at stage J+ in these repeats was four, as WT. This is consistent with observations of <italic>pfe</italic> mutants, which typically show the same number of pseudo-stripes and -interstripes as WT fish (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). We observe higher conservation of striping than in simulated <italic>shd</italic> mutants as observed in real fish. For example, in one hundred simulations, the average longest stretch of melanophores in any given simulation was 0.6 of the full length. See <xref ref-type="video" rid="video4">Video 4</xref> for a movie of the simulation.</p><media id="video4" mime-subtype="mp4" mimetype="video" xlink:href="elife-52998-video4.mp4"><label>Video 4.</label><caption><title>Simulated development of <italic>pfe</italic>.</title></caption></media><p>As a test of robustness, we perform a rigorous robustness analysis by carrying out one hundred repeats of the mutant simulations with perturbed parameter values chosen uniformly at random from the range 0.75–1.25 of their described value as in Section &quot;Simulation of WT pattern&quot;. Ten of these randomly sampled repeats are given in <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref>. We observe for all one hundred repeats and in all three mutants, that small perturbations to the rate parameters still generate consistent patterning, demonstrating the robustness of the model.</p></sec><sec id="s3-1-4-3"><title>Double mutants; <italic>shd;pfe</italic>, <italic>shd;nac</italic>, <italic>nac;pfe</italic></title><p>Lastly, we consider the double mutants. <xref ref-type="fig" rid="fig7">Figure 7A</xref> and <xref ref-type="fig" rid="fig7">Figure 7B</xref> depict adult patterns in <italic>shd;pfe</italic> and <italic>nac;pfe</italic> respectively. There is no image available for <italic>shd;nac</italic> adult or for the development of the aforementioned mutant phenotypes but it has been described in the literature that in all of the double mutants, the remaining cell type, by adulthood, fills the domain uniformly (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). <xref ref-type="fig" rid="fig7">Figure 7A’–C’</xref> show a representative simulation for the mutants <italic>shd;pfe</italic>, <italic>nac;pfe</italic>, <italic>shd;nac</italic> respectively. In all cases of our model simulations, we observe that by stage J+ the remaining cell type begins to fill the domain. For example, in <italic>nac;pfe</italic> S-iridophores in dense form cover most of the flank by stage J+ (<xref ref-type="fig" rid="fig7">Figure 7B’</xref>).</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Other mutant fish simulations.</title><p>(<bold>A</bold>–<bold>C</bold>) Real stage J+ <italic>shd;pfe</italic>, <italic>nac;pfe</italic>, <italic>shd;nac</italic> mutants, respectively. (<bold>A’</bold>–<bold>C’</bold>) Model simulations at stage J+ for <italic>shd;pfe</italic>, <italic>nac;pfe</italic>, <italic>shd;nac</italic> mutants, respectively. (<bold>D</bold>–<bold>F</bold>) Adult phenotype of selected (<bold>D</bold>) <italic>rse</italic>, (<bold>E</bold>) <italic>sbr</italic>, (<bold>F</bold>) <italic>cho</italic> mutant. (<bold>G</bold>–<bold>J</bold>), (<bold>K</bold>–<bold>N</bold>), (<bold>O</bold>–<bold>Q</bold>) <italic>rse</italic>, <italic>sbr</italic> and <italic>cho</italic> development, respectively. (<bold>G’</bold>–<bold>J’</bold>), (<bold>K’</bold>–<bold>N’</bold>), (<bold>O’</bold>–<bold>Q’</bold>) <italic>rse</italic>, <italic>sbr</italic> and <italic>cho</italic> model simulations, respectively. (<bold>R</bold>) <italic>seurat</italic> at stage J. (<bold>R’</bold>) seurat model simulation at stage J. Scale bar is 0.25 mm for all images. See <xref ref-type="video" rid="video5">Videos 5</xref>–<xref ref-type="video" rid="video7">7</xref> for representative examples of these simulation in movie format. Experimental images (<bold>A</bold>–<bold>C</bold>), (<bold>D</bold>), (<bold>F</bold>) (<bold>G</bold>–<bold>J</bold>) and (<bold>O</bold>–<bold>Q</bold>) are reproduced from <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>, (<bold>E</bold>), (<bold>K</bold>–<bold>N</bold>) from <xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>, (<bold>R</bold>) from <xref ref-type="bibr" rid="bib12">Eom et al., 2012</xref> and are all licensed under CC-BY 4.0 (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0">https://creativecommons.org/licenses/by/4.0</ext-link>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig7-v1.tif"/></fig></sec></sec><sec id="s3-1-5"><title>Simulation of other mutants</title><p>In Section &quot;Simulation of WT pattern&quot;, we demonstrated that our proposed model reproduces the WT, single and double mutant patterns and thus is sufficient to explain pattern formation in the skin. In this section, we perform a more stringent test of the model’s completeness, by asking whether it can successfully simulate the outcomes of a set of pigment pattern mutants which were not used to deduce the rules underpinning our model. Since we were particularly interested to test our predictions of the rules relating to S-iridophore interactions, our secondary set comprises mutants with S-iridophore-related phenotypes: <italic>rose</italic> (<italic>rse</italic>) homozygotes, which show a reduction of S-iridophore numbers; <italic>schachbrett</italic> (<italic>sbr</italic>) homozygotes, which show a delay in S-iridophore shape transitions from dense to loose and <italic>choker</italic> (<italic>cho</italic>) homozygotes, in which the absence of the horizontal myoseptum prevents the formation of the initial dense X0 band of dense S-iridophores (<xref ref-type="fig" rid="fig7">Figure 7D–F</xref>). In the next few sections (3.1.3–3.1.3), we demonstrate the capability of our model to reproduce quantitatively the patterns of these mutants. In each section, we first describe the nature of the mutation and the way in which we adapt our WT model to simulate the mutants. We describe the similarities of our model simulation with real fish at the different developmental stages considered.</p><sec id="s3-1-5-1"><title>The <italic>rse</italic> mutant</title><p><italic>Rose</italic> (<italic>rse</italic>), encodes the Endothelin receptor B1a (<xref ref-type="bibr" rid="bib31">Krauss et al., 2014</xref>) and has been shown to acts cell-autonomously in S-iridophores; homozygous mutants result in a reduction of S-iridophores to approximately 20% of that seen in WT (observed in stage PB and adult fish [<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>]). Consequently, adult fish show two broken dark stripes (reduction from four) bordering a widened X0 interstripe region. (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). To simulate the <italic>rse</italic> mutant, we changed the number of initial dense S-iridophores at stage PB to one fifth of its usual number as observed in real fish at stage PB (<xref ref-type="fig" rid="fig7">Figure 7G,G’</xref>; <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). At stage PR (<xref ref-type="fig" rid="fig7">Figure 7H,H’</xref>), there is a strong reduction in melanocyte number compared to WT (<xref ref-type="fig" rid="fig7">Figure 7I,I’</xref>) and we observe that dense S-iridophores spread less far from the horizontal myoseptum. At stage SP, (<xref ref-type="fig" rid="fig7">Figure 7J,J’</xref>) the stripe boundaries at X0 are poorly defined, and dense S-iridophores are still largely associated with the X0 region, with only a few loose S-iridophores appearing at the dorsal and ventral margins. At stage J+ (<xref ref-type="fig" rid="fig7">Figure 7K,K’</xref>), the stripe boundaries at X0 are more distinct, but the dark stripes are thinner and partly fragmented. See <xref ref-type="video" rid="video5">Video 5</xref> for a movie of the simulation.</p><media id="video5" mime-subtype="mp4" mimetype="video" xlink:href="elife-52998-video5.mp4"><label>Video 5.</label><caption><title>Simulated development of <italic>rse</italic>.</title></caption></media></sec><sec id="s3-1-5-2"><title>The <italic>sbr</italic> mutant</title><p>The <italic>sbr</italic> gene encodes Tight Junction Protein 1a (Tjp-1a), which is expressed cell autonomously in dense S-iridophores (but not in loose S-iridophores) and truncated in <italic>sbr</italic> mutants; in adult <italic>sbr</italic> mutants S-iridophore shape transition from dense to loose is delayed (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). As a result, adult fish exhibit interrupted dark stripes, generating a pattern reminiscent of a checkerboard (<xref ref-type="fig" rid="fig7">Figure 7E</xref>). <xref ref-type="fig" rid="fig7">Figure 7K–N</xref> depicts <italic>sbr</italic> early pattern development. During adult pigment pattern formation, differences from normal WT development are not seen until ≈10 mm SL (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>), (SP stage) at which point instead of dense S-iridophores transitioning to loose S-iridophores at the edge of the interstripe, in <italic>sbr</italic>, dense S-iridophores remain dense and spread over melanocytes dorsally and ventrally bidirectionally . At later stages, some dense S-iridophores do switch to loose S-iridophores. See <xref ref-type="video" rid="video6">Video 6</xref> for a movie of the simulation.</p><media id="video6" mime-subtype="mp4" mimetype="video" xlink:href="elife-52998-video6.mp4"><label>Video 6.</label><caption><title>Simulated development of <italic>sbr</italic>.</title></caption></media><p>We interpret the <italic>sbr</italic> mutation as causing a delay in signaling driving the transition of S-iridophores from dense to loose S-iridophore. We model this by reducing the attempted rate of transitioning from dense to loose to a rate 40 × less than the rate of attempting loose to dense S-iridophore transition. Due to available data, we initialise the model for <italic>sbr</italic> at 7.5 mm SL to match that published regarding the real fish (<xref ref-type="fig" rid="fig7">Figure 7K,K’</xref>). At 9 mm (<xref ref-type="fig" rid="fig7">Figure 7L,L’</xref>) melanocytes begin to accumulate either side of the widened initial X0 interstripe. At 10.6 mm SL, we observe melanocytes that are associated with dense S-iridophores (white cells) and not just with loose S-iridophores (blue cells) as usually seen in WT at 10.6 mm ≈ stage SA (between stages SP and J+, <xref ref-type="fig" rid="fig5">Figure 5C–D</xref>). At 11.5 mm (<xref ref-type="fig" rid="fig7">Figure 7M,M’</xref>), melanocytes are organised into aggregates, approximately one stripe width in size, and only partially connected, thus forming a broken pseudo-stripe pattern.</p></sec><sec id="s3-1-5-3"><title>The <italic>cho</italic> mutant</title><p>Homozygous <italic>cho</italic> mutant larvae lack the horizontal myoseptum (<xref ref-type="bibr" rid="bib54">Svetic et al., 2007</xref>). As a result, dense S-iridophores are prevented from traveling via the horizontal myoseptum to generate the initial stripe of dense S-iridophores seen in WT at stage PB. Instead loose S-iridophores appear only later, at stage PR, uniformly across the domain. <italic>cho</italic> fish then proceed to develop a labyrinthine pigment pattern. Stripes and interstripes of normal width form in a parallel arrangement, but with orientation disrupted, with regions running vertically and horizontally and often strongly curved, sometimes branched and often interrupted (<xref ref-type="fig" rid="fig7">Figure 7F</xref>).</p><p>To model <italic>cho,</italic> we omitted the initial stripe of dense S-iridophores at the PB stage (<xref ref-type="fig" rid="fig7">Figure 7O,O’</xref>) and instead place 200 loose S-iridophores at random across the S-iridophore domain at stage PR (<xref ref-type="fig" rid="fig7">Figure 7P,P’</xref>). No other interactions were altered. At stage J+ (<xref ref-type="fig" rid="fig7">Figure 7Q,Q’</xref>), we see a pattern of normal width stripes and interstripes except with varying orientation, as seen in real <italic>cho</italic> fish. See <xref ref-type="video" rid="video7">Video 7</xref> for a movie of the simulation.</p><media id="video7" mime-subtype="mp4" mimetype="video" xlink:href="elife-52998-video7.mp4"><label>Video 7.</label><caption><title>Simulated development of <italic>cho</italic>.</title></caption></media></sec><sec id="s3-1-5-4"><title>The <italic>seurat</italic> mutant</title><p>Homozygous <italic>seurat</italic> mutants develop fewer adult melanophores, thus forming irregular spots rather than stripes. This phenotype arises from lesions in the gene encoding Immunoglobulin superfamily member 11 (Igsf11) (<xref ref-type="bibr" rid="bib12">Eom et al., 2012</xref>) which encodes a cell surface receptor (containing two immunoglobulin-like domains) that is expressed autonomously by the melanophore lineage. Igsfl1 promotes the migration and survival of these cells during adult stripe development as well as mediating adhesive interactions in vitro.</p><p>To model <italic>seurat</italic>, we reduced the rate at which melanocytes could differentiate to a twentieth of the usual rate. This was to reflect the inhibition of the migration of melanoblasts (precursors of melanophores) across the domain and increased the rate of attempted melanocyte death to one hundred times per day (usually once per day). No other interactions were altered. At stage J (<xref ref-type="fig" rid="fig7">Figure 7R,R’</xref>), we see a pattern of normal width stripes broken into spots with a reduced number of melanocytes. Melanocytes are associated with loose S-iridophores and xanthophores with dense S-iridophores, as seen in real <italic>seurat</italic> fish.</p><p>By modelling <italic>seurat</italic> and <italic>sbr</italic>, we can also make predictions about the phenotype of a double mutant <italic>seurat;sbr</italic>, shown in <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1</xref>. We predict that by stage J+, this mutant would be covered in dense S-iridophore and associated xanthophores, with a few melanocytes at the very dorsal and ventral region of the fish. We are not aware of a published description of the phenotype of this double mutant, so our prediction remains to be tested.</p></sec><sec id="s3-1-5-5"><title>Regeneration experiments</title><p>In order to further validate our model, we test to see whether we observe similar behaviour when the cells are ablated and the pattern is left to regenerate. In 2007, <xref ref-type="bibr" rid="bib62">Yamaguchi et al., 2007</xref> ablated a rectangular window of pigment cells of adult zebrafish stripes and recorded the regeneration of pigment producing cells (<xref ref-type="fig" rid="fig8">Figure 8A–C</xref>). They found that after ablation, cells regenerated in a labyrinthine pattern. To model this ablation, we simulated WT development from stage PB to our latest simulation stage, J+ as seen in <xref ref-type="fig" rid="fig5">Figure 5D’</xref>. At stage J+, we simulate ablation by removing a square region of cells in the centre (horizontally) of three stripes and interstripes. We then observe the pattern regeneration 7, 14 and 21 days later in <xref ref-type="fig" rid="fig8">Figure 8C–E</xref>. At 14 days, we observe the production of irregular shaped spots of melanophores in the centre of the ablated region as seen in the ablated fish at day 7. At day 21, we observe a regeneration of the pattern where stripes are no longer oriented horizontally. In some regions, spots of melanophores are surrounded by xanthophores.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Stripe regeneration simulations.</title><p>(<bold>A</bold>–<bold>C</bold>) Regeneration of new pigment producing cells 7, 14 and 21 days respectively after a small rectangular window of cells in the adult WT stripes are completely ablated (<xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>). (<bold>D</bold>–<bold>F</bold>) A representative simulation of the regeneration of an adult zebrafish 7, 14 and 21 days after a simulated ablation has occurred. Scale bar is 0.25 mm in all images. Experimental images (<bold>A</bold>–<bold>C</bold>) are reproduced from <xref ref-type="bibr" rid="bib62">Yamaguchi et al., 2007</xref>. Copyright (2007) National Academy of Sciences U.S.A.; these images not covered by the CC-BY 4.0 licence and further reproduction of this panel would need permission from the copyright holder.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig8-v1.tif"/><permissions><copyright-statement>© 2007 National Academy of Sciences USA</copyright-statement><copyright-year>2007</copyright-year><copyright-holder>National Academy of Sciences USA</copyright-holder><license><license-p>Experimental images (A–C) are reproduced from <xref ref-type="bibr" rid="bib62">Yamaguchi et al., 2007</xref>, with permission of PNAS. These images not covered by the CC-BY 4.0 licence and further reproduction of this panel would need permission from the copyright holder.</license-p></license></permissions></fig><p>In 2013, <xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref> ablated a section of dense S-iridophores along the horizontal myoseptum using a S-iridophore-specific marker <italic>pnp4a</italic>:NTR+Mtz at the beginning of pattern metamorphosis (<xref ref-type="fig" rid="fig9">Figure 9A</xref>, stage PB). They then observed the subsequent pattern formation (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). We simulate this by removing a section of dense S-iridophores from the horizontal myoseptum at stage PB (<xref ref-type="fig" rid="fig9">Figure 9C</xref>) and then simulating as normal. We observe the pattern at 10 days post ablation. Xanthophores are associated with the undamaged portion of the S-iridophore stripe and melanophores surround the damaged interstripe (<xref ref-type="fig" rid="fig9">Figure 9D</xref>). In both cases, our simulations closely approximate the published observations.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Stripe regeneration post S-iridophore ablation.</title><p>(<bold>A</bold>) S-iridophores are ablated using <italic>pnp4a</italic>:NTR+Mtz at stage PB (<bold>B</bold>) Stripe development in wild-type fish following S-iridophore ablation. Xanthophores are associated with S-iridophore interstripe. Melanophores aggregate around the new interstripe. (<bold>C</bold>–<bold>D</bold>) A representative simulation of S-iridophore ablation and subsequent development. For clarity, dense S-iridophores are displayed in green in (<bold>C</bold>). Scale bar is 0.25 mm in all images. Experimental images (<bold>A</bold>–<bold>B</bold>) are reproduced from <xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref> and licensed under CC-BY 4.0 (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig9-v1.tif"/></fig></sec></sec></sec><sec id="s3-2"><title>Quantitative analysis of simulations</title><p>In the next few sections (3.2.1)-(3.2.4), we test the consistency of our WT and mutant simulations, averaged over 100 simulations, with real published quantitative measures. We test four criteria using experimental data: (1) the number of melanophores in mutants at different stages with respect to WT at the same stage, (2) the average width of X0 interstripe for WT, <italic>rse</italic>, <italic>pfe</italic>, <italic>shd</italic> and <italic>nac</italic> at stage J+, (3) WT stripe straightness, (4) WT pigment cell density in stripes and interstripes.</p><sec id="s3-2-1"><title>Melanophore density across WT and mutant fish</title><p><xref ref-type="fig" rid="fig10">Figure 10A</xref> is a comparison between the average number of melanocytes per ventral hemisegment for each mutant with the number of melanocytes at WT at stages PB, PR, SP, J and J+ using the data from <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>. First, since we do not have simulated data for a whole hemi-segment we normalise our melanocyte numbers against WT numbers at each stage. We do this by, for each respective stage and each respective mutant, multiplying the number of simulated melanocytes at the given stage for the given mutant by the number of melanocytes at each stage in real WT fish and dividing by the number of melanocytes observed in our WT simulations at this stage. These comparisons are given in <xref ref-type="fig" rid="fig10">Figure 10A</xref>. We observe the same trends seen in real fish. Moreover, in all stages, except for stage SP, the simulated data falls within the error bars of the measured data in real fish. In particular, we observe that the number of melanocytes remains similar to WT in <italic>pfe</italic> until stage J+, similar to that in WT, whilst the number of melanocytes is significantly lower in <italic>shd</italic> and <italic>rse</italic> in comparison to WT just as in real fish.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Quantitative analyses.</title><p>(<bold>A</bold>) Number of melanocytes per ventral hemisegment. Quantification of melanocytes. A comparison of melanocyte numbers between mutants and WT seen in our simulations and data recreated from <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>. For each stage, our simulated number of melanocytes was normalised by the WT number in data by <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>. (The number of animals used for counting was at least five for each measurement point.) The number of simulations was 100. Error bars indicate the standard deviation. There is no error bar for WT, since WT data was used to normalise the data. (<bold>B</bold>) X0 interstripe width. A comparison of X0 stripe width in 100 simulations with X0 stripe width in real mutants (taken from representative images; <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). The darker bars depict experimental data, lighter bars depict our simulated data. Error bars indicate the standard deviation. Since there is only one image for each of the respective mutants, there is no error bar for actual (real experimental data). (<bold>C</bold>–<bold>F</bold>) PCF for different cell types averaged over 100 simulations using the square uniform PCF (<xref ref-type="bibr" rid="bib17">Gavagnin et al., 2018</xref>). The spatial pair correlation as a function of distance for (<bold>C</bold>) dense S-iridophores only (<bold>D</bold>) melanocytes only, (<bold>E</bold>) melanocytes and dense S-iridophores, (<bold>F</bold>) melanocytes and xanthophores. Experimental data in (<bold>A</bold>) is reproduced from <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig10-v1.tif"/></fig></sec><sec id="s3-2-2"><title>WT stripe straightness</title><p>In real life, zebrafish stripes are quite straight, but are not necessarily perfectly so (see X0 in <xref ref-type="fig" rid="fig1">Figure 1A</xref> for example). To measure stripe straightness, we first generated a line representation (<inline-formula><mml:math id="inf40"><mml:mi>x</mml:mi></mml:math></inline-formula>) of the central interstripe (see Appendix 3). From this line <inline-formula><mml:math id="inf41"><mml:mi>x</mml:mi></mml:math></inline-formula>, we calculated the stripe straightness SS(<inline-formula><mml:math id="inf42"><mml:mi>x</mml:mi></mml:math></inline-formula>), measured by the ratio of the length of our line (<inline-formula><mml:math id="inf43"><mml:mi>L</mml:mi></mml:math></inline-formula>) to the straight line distance between the ends of it (<inline-formula><mml:math id="inf44"><mml:mi>C</mml:mi></mml:math></inline-formula>), <italic>i.e.</italic><disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:mtext>SS</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The value of SS(<inline-formula><mml:math id="inf45"><mml:mi>x</mml:mi></mml:math></inline-formula>) lies between 0 and 1, since <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>C</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. For more information about how <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is generated see Appendix 3. In 10 real WT stage J+ fish, the mean <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> value was 0.98. In 100 simulations we observe a high albeit slightly lower mean <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> value of 0.92 at stage J+, demonstrating good stripe straightness, that is close to that observed in real fish.</p></sec><sec id="s3-2-3"><title>X0 interstripe width across WT and mutant fish</title><p>Finally, we compare the interstripe X0 width in our simulations with real data. We choose this interstripe as it is the only interstripe that the mutants we consider and WT have in common. We compare the width of this interstripe at J+ in our simulations (see Appendix 3 for detailed methods) with the observations of the corresponding J+ mutant in <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>. We demonstrate in <xref ref-type="fig" rid="fig5">Figure 5B</xref> that, in all cases, the real J+ mutant X0 interstripe widths fall in the range of ±1 standard deviations of the simulated J+ X0 stripe width averaged over 100 simulations. This demonstrates consistency between our model and real data. Thus, our model demonstrates an excellent ability to quantitatively simulate the patterns of real fish.</p></sec><sec id="s3-2-4"><title>Pigment cell density in WT</title><p>There are no published estimates of WT pigment cell density in each of the stripes at the J+ stage when our simulations end. However, our data are comparable to those of adult WT fish measured by <xref ref-type="bibr" rid="bib36">Mahalwar et al., 2016</xref>, who observed that in the stripe regions there were approximately four times more xanthophores in the interstripe region than melanocytes in the stripe region. Furthermore, whilst the light interstripe were completely devoid of melanocytes, there was a low density of xanthophores in the stripe region. In our model simulations, we observe a mean of 4.01 times as many xanthophores in the interstripes than melanocytes in the stripes demonstrating good agreement. We also observe a low density of xanthophores in the stripe regions and negligible numbers of melanocytes in the interstripe regions.</p></sec></sec><sec id="s3-3"><title>Simulation reproducibility of pattern formation</title><p>To further test the accuracy of our model’s outputs, we compare the spatial correlation of different cell types at different distances. We use this measure as an objective test of whether the spatial distributions between cells we observe in our representative simulations, (i.e. the patterns generated), are consistent among different simulated outputs.</p><p>To measure spatial correlation, we use a pair correlation function (PCF). A PCF determines whether, given a spatial distribution of agents on a domain, the number of pairs of agents at a certain distance from each other are greater than or fewer than the number expected if the agents were distributed uniformly at random. For example, if the PCF value is unity for a certain distance, this indicates that there is no spatial correlation. If the PCF value is greater or less than unity for a certain distance then this indicates that there is spatial correlation or anticorrelation respectively at that distance. The PCF we employ is specific to on-lattice domains and is called the Square Uniform PCF (<xref ref-type="bibr" rid="bib17">Gavagnin et al., 2018</xref>) adapted for multiple cell-types (see Appendix 3 and <xref ref-type="bibr" rid="bib10">Dini et al., 2018</xref>). We describe the PCF as homotypic when we are measuring the spatial correlation of one cell-type and heterotypic when we consider the spatial correlation between two different cell-types. We choose this PCF as it uses a measure of distance that is complementary to the distance measurement in our simulations.</p><p><xref ref-type="fig" rid="fig10">Figure 10C–F</xref> shows the square uniform PCF against distance for different mutants and cell types averaged over one hundred simulations. For each plot of a given PCF type (homotypic melanocytes, for example), we repeatedly simulate the relevant mutant to its final stage, compute the PCF of the resultant pattern and then average the PCFs over the number of repeats to give us an averaged PCF.</p><p>To interpret the data, consider the representative simulation for a WT fish at stage J+. In this example, we observe stripes (<xref ref-type="fig" rid="fig5">Figure 5D’</xref>). This is a consistent feature for all of the repeat simulations of WT at stage J+. To quantify average interstripe width (the distance vertically in mm from the top of any interstripe to the bottom) in our simulations we can consider the averaged homotypic dense S-iridophores PCF for WT in <xref ref-type="fig" rid="fig10">Figure 10C</xref>. We observe that this shows periodicity (sequential peaks and troughs) at different distances. These are a consequence of the striped pattern at J+ (<xref ref-type="fig" rid="fig5">Figure 5D’</xref>). Since dense S-iridophores occupy the interstripe regions in WT and not the stripe regions at J+, dense S-iridophores are spatially correlated at short distances, indicated by a positive value of the PCF at short distances. Conversely, they are anti-correlated at distances approximately one half, one and a half or two and a half stripe widths away, as these distances correspond to the relative positions of the dark stripes, which normally lack dense S-iridophores. We see troughs at these distances. The period of the PCF in this case thus quantifies an estimate for average interstripe width.</p><p>In the next few paragraphs, we test the reproducibility of different features that are observed in our representative simulations by considering a PCF of appropriate cell types averaged over one hundred repeats.</p><p>Real <italic>cho</italic> mutants and WT fish share similar interstripe width (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>)(also seen in our model; compare <xref ref-type="fig" rid="fig7">Figure 7Q’</xref> and <xref ref-type="fig" rid="fig5">Figure 5D’</xref>). To test reproducibility we consider the homotypic PCF of dense S-iridophores for WT and <italic>cho</italic> in <xref ref-type="fig" rid="fig10">Figure 10C</xref>. For both <italic>cho</italic> and WT simulations, the averaged homotypic PCF for dense S-iridophores observes periodic behaviour with the same frequency, indicating maintenance of interstripe width between WT and <italic>cho</italic> in our model, consistent with observations in vivo.</p><p>In real <italic>shd</italic> at stage J+, there are two pseudo-stripes of melanocytes broken into spots, of a diameter that is approximately equal to the normal stripe width (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>) (also seen in our model; compare <xref ref-type="fig" rid="fig5">Figure 5H’</xref> and <xref ref-type="fig" rid="fig5">Figure 5D’</xref>). To test whether this is consistent we consider the homotypic PCF of melanocytes for WT and <italic>shd</italic> in <xref ref-type="fig" rid="fig10">Figure 10D</xref>. The average stripe width of WT and the average aggregate size of <italic>shd</italic> can be approximated from the PCF as the distance related to the first trough, as this is the shortest distance at which melanocytes are most anticorrelated with other melanocytes. For both <italic>shd</italic> mutants and WT simulations, these are both approximately 0.3 mm.</p><p>In real <italic>pfe</italic> at stage J+, stripes and interstripes remain aligned and have the same width as in WT, except that stripes are broken into spots and some melanocytes lie ectopically in the usual interstripe region (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>) (also seen in our model; compare <xref ref-type="fig" rid="fig5">Figure 5D’</xref> and <xref ref-type="fig" rid="fig5">Figure 5P’</xref>). To test reproducibility, we consider the heterotypic PCF of melanocytes and dense S-iridophores for WT and <italic>pfe</italic> in <xref ref-type="fig" rid="fig10">Figure 10E</xref>. For both the WT and <italic>pfe</italic> simulations, the averaged heterotypic PCF of melanocytes and dense S-iridophores displays periodic behaviour with the same period. However, in <italic>pfe</italic> the peaks and troughs are damped. We interpret this as follows. Firstly, this indicates that, in our model, stripe width is preserved between <italic>pfe</italic> and WT as the period of the PCF is the same. Moreover, as the peaks and troughs are damped in <italic>pfe</italic>, this indicates that, as seen in our representative simulation, some melanocytes tend to remain in the interstripe regions.</p><p>In real <italic>sbr</italic> at 11.5 mm SL, stripes are sometimes broken into spots of usual (vertical) width, but the overarching stripe pattern remains (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>) (also seen in our model, compare <xref ref-type="fig" rid="fig7">Figure 7D’</xref> and <xref ref-type="fig" rid="fig5">Figure 5N’</xref>). To test reproducibility, we consider the heterotypic PCF of melanocytes and xanthophores for WT and <italic>sbr</italic> in <xref ref-type="fig" rid="fig10">Figure 10F</xref>. The first peak of this PCF corresponds to the shortest distance at which melanocytes and xanthophores are most correlated, which is approximately the stripe width. For both <italic>sbr</italic> mutants and WT simulations these are both approximately 0.3 mm.</p><p>In these examples, using appropriate PCFs we have demonstrated the consistency of our simulations in generating patterns that match the qualitative differences we expect when we compare mutant fish with WT. We note that we have only provided the averaged PCF for the scenarios aforementioned for simplicity. For information about how the PCF is calculated, please see Appendix 3.</p></sec><sec id="s3-4"><title>Iridophore assumptions and biological redundancy</title><sec id="s3-4-1"><title>Necessity of S-iridophore assumptions</title><p>For the less well-studied S-iridophore transitions, we analysed key mutant phenotypes to infer biologically realistic rules for these interactions, aiming to generate assumptions that were the simplest for pattern formation changes seen, but no simpler. These deductions are discussed in Section &quot;Modelling overview&quot;. In <xref ref-type="fig" rid="fig11">Figure 11</xref> B1–J3, we demonstrate the necessity of all of the assumptions for dense-to-loose, loose-to-dense S-iridophore transitions first outlined in <xref ref-type="fig" rid="fig4">Figure 4G</xref>, 15-18 for stripe formation by showing representative images (the model was run 50 times each) of simulations at stage J+ for fish lacking one or more S-iridophore transition mechanisms display patterns which diverge from those seen in real fish.</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Representative simulations of the model with some of the S-iridophore interactions removed.</title><p>The first column displays a diagram of the S-iridophore interactions which remain (all other cell-cell interactions are unchanged). Columns 2–4 are representative simulations of WT, <italic>pfe</italic> and <italic>nac</italic> under these conditions. *This interaction is equivalent to removal of long range xanthophore inhibition in criterion 17. It is also equivalent to removal of short range xanthophore promotion in criterion 18.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig11-v1.tif"/></fig><p>First, we analyse simulations lacking one of the transition types loose-to-dense or dense-to-loose (<xref ref-type="fig" rid="fig11">Figure 11</xref> B1–C3). Without a loose-to-dense transition (<xref ref-type="fig" rid="fig11">Figure 11</xref> B1–B3), note how in all cases (WT, <italic>pfe</italic>, <italic>nac</italic>) only one pseudo-interstripe is preserved: the initial X0 interstripe. The X0 interstripe is surrounded by a sea of loose S-iridophores which have transitioned to loose either by promotion by xanthophores in the long range (<italic>nac</italic> <xref ref-type="fig" rid="fig11">Figure 11</xref> B3), promotion by melanophores in the short range (<italic>pfe</italic> <xref ref-type="fig" rid="fig11">Figure 11</xref> B2) or a combination of both (WT <xref ref-type="fig" rid="fig11">Figure 11</xref> B1). This suggests that loose-to-dense interactions are important for generating subsequent interstripes. Interestingly, without loose-to-dense transitions WT fish demonstrate a striped pattern similar to <italic>Danio albolineatus</italic> (<xref ref-type="bibr" rid="bib46">Parichy, 2006</xref>) suggesting a possible route of evolution between these fishes (also noted by <xref ref-type="bibr" rid="bib58">Volkening and Sandstede, 2018</xref>). Without a dense-to-loose transition (<xref ref-type="fig" rid="fig11">Figure 11</xref> C1–C3), the S-iridophores form a dense sheet over the entire domain with xanthophores and melanophores scattered across the domain. This demonstrates the necessity for S-iridophores to be able to transition between dense and loose form.</p><p>Next, we consider removing each of the criteria required for an S-iridophore transition one at a time (<xref ref-type="fig" rid="fig11">Figure 11</xref> D1–J3). We first note that, in some cases, removal of an interaction in either <italic>nac</italic> or <italic>pfe</italic> results in loss of a transition type. These are not shown in <xref ref-type="fig" rid="fig11">Figure 11</xref> for simplicity. In other scenarios, however, removal of an interaction leads to the uninhibited possibility of a transition in one of the single cell mutants. For example, consider <xref ref-type="fig" rid="fig11">Figure 11</xref> E2. Removal of long-range xanthophore promotion in criterion 16, leads to the possibility of a transition from loose to dense provided that there are either melanophores in the short range <italic>or</italic> no xanthophores in the short range. Since in <italic>pfe</italic> there are are always no xanthophores in the short range, or indeed anywhere on the domain, S-iridophores are consistently promoted to dense type, with a non-zero rate, thus <xref ref-type="fig" rid="fig11">Figure 11</xref> E2 is not distinguishable from <xref ref-type="fig" rid="fig11">Figure 11</xref> C2 since in effect, in <italic>pfe</italic> the same interactions have been knocked out. We note that this is the case for one of either <italic>nac</italic> or <italic>pfe</italic> in <xref ref-type="fig" rid="fig11">Figure 11C,E–G,J</xref>.</p><p>In <xref ref-type="fig" rid="fig11">Figure 11</xref> D1–D3, short-range xanthophore inhibition is removed from criteria 16. As this is exclusively a xanthophore-iridophore interaction this only effects WT and <italic>nac</italic>. Without the promotion of xanthophores in the short range, S-iridophores change from dense to loose in the interstripes, making the interstripes appear faded. In <xref ref-type="fig" rid="fig11">Figure 11</xref> G1–G3, short-range melanophore inhibition is removed from criteria 18. Therefore S-iridophore can change from loose to dense when there are xanthophores in the short range. As a result interstripes become wider as they are unrestricted by local melanophore stripes. Finally, in <xref ref-type="fig" rid="fig11">Figure 11</xref> I1–I3 criteria 18 is removed, so S-iridophores only change from loose to dense when there are no melanophores in the short range and simultaneously no xanthophores in the long range. In this case stripe integrity is lost in WT.</p><p>To summarise, all interactions are necessary for pattern formation in WT and single cell mutants, <italic>nac</italic> and <italic>pfe</italic>.</p></sec><sec id="s3-4-2"><title>Biological redundancy</title><p>As part of this in-depth study, we have incorporated all of the interactions that we have identified from the literature. Consequently, there may be some in-built redundancy. However, we keep all interactions for the purposes of biological realism. In this section we explore the idea of biological redundancy by removing some interactions and observing the resultant simulated development.</p><p>First we consider movement. In real (and simulated) fish, melanocytes and xanthophores move 0.11 mm per day (<xref ref-type="bibr" rid="bib55">Takahashi and Kondo, 2008</xref>) and 0.033 mm per day, respectively. Furthermore, in the short range their direction of movement is influenced by each other (<xref ref-type="bibr" rid="bib63">Yamanaka and Kondo, 2014</xref>). Xanthophores chase melanocytes, which in turn, are repelled by xanthophores. In <xref ref-type="fig" rid="fig12">Figure 12C–D</xref>, we turn off the movement of xanthophores and melanocytes in WT and <italic>shd</italic> mutants and simulate to stage J+. We observe that in both cases, the pattern is conserved. This is not surprising since the cells do not move very quickly. However, there is a slight difference in <italic>shd</italic> wherein the interstripe width is slightly smaller than in <italic>shd</italic> without changes (<xref ref-type="fig" rid="fig12">Figure 12B</xref>). We suggest that this is due to the loss of chase-run dynamics observed between melanocytes and xanthophores. Next we consider the differentiation rate of melanocytes. We model this as being dependent on the number of dense S-iridophores and the number of xanthophores currently on the domain. This is because we assume that dense S-iridophores and xanthophores positively influence the rate of melanocyte birth in the long range. In <xref ref-type="fig" rid="fig12">Figure 12E</xref>, we change the differentiation rate so it is only dependent on the number of xanthophores currently on the domain and not the number of S-iridophores, effectively reducing the rate of differentiation of melanocytes in wild-type fish. The resultant pattern is still striped; however, it is less organised. In <xref ref-type="fig" rid="fig12">Figure 12F–G</xref>, we remove the mechanism allowing long-range communication between xanthoblasts and melanocytes. In <italic>shd</italic> our model predicts that without the consolidation of spots by xanthoblasts, melanocyte spots become more widely spaced. In <xref ref-type="fig" rid="fig12">Figure 12H</xref>, we remove xanthophore and xanthoblast proliferation. This limits the number of xanthophores to the number allocated at the start. Remarkably, our model predicts that stripe formation is largely preserved, however, interstripes are fainter due to the lack of xanthophores. Next we consider melanocyte death. In <xref ref-type="fig" rid="fig12">Figure 12I–J</xref>, we remove melanocyte death from WT and <italic>shd</italic> simulations. Whilst stripe formation is maintained in WT (<xref ref-type="fig" rid="fig12">Figure 12I</xref>), interstripes are littered with melanocytes. In <italic>shd</italic> (<xref ref-type="fig" rid="fig12">Figure 12J</xref>), melanocyte spots are more difficult to discern as melanocytes can be observed in the xanthophore regions. We predict that dense S-iridophores and xanthophores in the long-range and/or loose S-iridophores and the lack of xanthophores in the short range promote melanocyte differentiation. In <xref ref-type="fig" rid="fig12">Figure 12K</xref> we change the criteria for melanocyte differentiation, so that it does not depend on S-iridophores (only xanthophores). As a result the stripe pattern looses integrity. A similar phenotypic change happens when we change the criteria for melanocyte differentiation, so that it does not depend on xanthophores (only S-iridophores, <xref ref-type="fig" rid="fig12">Figure 12N</xref>). In <xref ref-type="fig" rid="fig12">Figure 12L,M</xref>, we change melanocyte and xanthophore movement so that they are no longer influenced by each other (no chase-run dynamics). As a result in WT (<xref ref-type="fig" rid="fig12">Figure 12L</xref>), stripe integrity is lost. For <italic>shd</italic> (<xref ref-type="fig" rid="fig12">Figure 12M</xref>) simulations, however, qualitatively there is not much difference (similarly to the case when movement is completely removed (<xref ref-type="fig" rid="fig12">Figure 12D</xref>) suggesting that movement does not play a significant role in generating spots. Rather, it is the death of melanocytes in xanthophore rich areas and xanthoblast pulling which are important (<xref ref-type="fig" rid="fig12">Figure 12G,J</xref>).</p><fig id="fig12" position="float"><label>Figure 12.</label><caption><title>Representative simulation of the model with certain rules omitted.</title><p>(<bold>A</bold>–<bold>B</bold>) WT and <italic>shd</italic> respectively with all rules included. (<bold>C</bold>–<bold>D</bold>) No movement of melanocytes or xanthophores for WT and <italic>shd,</italic> respectively. (<bold>E</bold>) Differentiation of melanocytes only promoted by dense S-iridophores for WT fish that is the rate of melanocytes does not depend on the number of S-iridophores. (<bold>F</bold>–<bold>G</bold>) No pull of melanocytes by xanthoblasts for WT and <italic>shd</italic> fish, respectively. (<bold>H</bold>) No proliferation of xanthophores for WT. (<bold>I</bold>–<bold>J</bold>) No melanocyte death for WT and <italic>shd</italic> fish. (<bold>K</bold>) Differentiation of melanocytes is not dependent on S-iridophores, (<bold>L</bold>–<bold>M</bold>) No death of melanocytes for WT and <italic>shd</italic> (<bold>N</bold>) Differentiation of melanocytes is dependent on dense S-iridophores being present in the long distance only.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig12-v1.tif"/></fig><p>In summary, whilst removal of these interactions largely do not change the type of pattern generated (e.g. <italic>shd</italic> still generates spots, wild-type fish still generate stripes), and thus could be considered as biologically redundant for pattern generation, they appear to have large impacts on the integrity of the patterns formed. We thus, suggest that the retention of these interactions in vivo act as a buffer to protect the integrity of stripe formation in spite of stochastic variations in stripe patterning.</p></sec></sec><sec id="s3-5"><title>Model predictions</title><p>A major benefit of developing a fine-grained, cell-level model is the ability to perform in silico experiments that can be directly related to real-life equivalents. This not only allows us to explore parts of the system that may otherwise not be testable experimentally, giving us valuable insight into the biological system. It also gives us the ability to analyse dynamics of different hypothetical mechanisms before devoting expensive resources to experimental tests that could confirm theoretical findings.</p><p>In the next few sections, we focus on the ability of the model to make biologically testable predictions, demonstrating firstly, in Section &quot;An in silico investigation into important mechanisms for controlling pattern formation&quot;, how we can use our model to explore important facets of successful pattern formation such as growth, domain size and initial conditions. Then in Section &quot;An in silico investigation into the function of the <italic>leo</italic> gene&quot;, we give an example of how we can use our model to generate testable hypotheses about the <italic>leopard</italic> mutant.</p><sec id="s3-5-1"><title>An in silico investigation into important mechanisms for controlling pattern formation</title><sec id="s3-5-1-1"><title>Initial S-iridophore interstripe orientation alone does not determine the orientation of stripes and interstripes</title><p>Previously it has been hypothesised that the horizontal orientation of the initial S-iridophore interstripe (emerging from the horizontal myoseptum) that drives the organisation of subsequent stripes and interstripes horizontally. One way to test this hypothesis is to initialise the interstripe so it is oriented vertically instead of horizontally. If the initial S-iridophore interstripe does orient stripes and interstripes then we would expect to see the same pattern development we observe in WT fish, but rotated 90 degrees. That is, we would expect to see vertical bars across the domain at the time corresponding to stage J+. The position of the dense S-iridophores (a horizontal interstripe along the horizontal myoseptum in WT fish) at the start of pattern metamorphosis, is dictated by the fish’s anatomy and cannot be altered experimentally. However, we can simulate an altered iridophore initial distribution in silico by initialising the initial interstripe as a band of width three along the vertical axis instead of as a band of dense iridophores vertically (dorso-ventrally) down the centre of the domain of width three instead of as a band of width three, dense S-iridophores along the horizontal axis. We observe the subsequent pattern development at stages PR, SP and J+ in <xref ref-type="fig" rid="fig13">Figure 13A</xref>. Interestingly, instead of observing vertical bars, at stage J+ we observe a labyrinthine pattern. This demonstrates that, whilst the initial S-iridophore interstripe plays a role in orientating the pattern, it is not the only part of the initial condition that is important. Further observation of the model output reveals that, for a while, the pattern is oriented in a vertical pattern similar to the initial iridophore interstripe, but as growth continues, this pattern becomes reoriented into a horizontal form. This clearly reveals the impact of growth on pattern formation.</p><fig id="fig13" position="float"><label>Figure 13.</label><caption><title>In silico investigation into important mechanisms for controlling pattern formation.</title><p>The simulated domains at stages PR, SP and J+ wherein the following are changed (<bold>A</bold>) the orientation of the initial S-iridophore interstripe, (<bold>B</bold>) the initial position of the S-iridophore interstripe, (<bold>C</bold>) the initial domain size (<bold>D</bold>) the initial domain so that it is populated with adult-width stripes and interstripes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig13-v1.tif"/></fig></sec><sec id="s3-5-1-2"><title>The position of the initial S-iridophore interstripe is important for successful pattern formation</title><p>Another way to better understand the role of the initial S-iridophore interstripe is to alter its position in the dorso-ventral axis so that it appears more ventrally on the initial domain. We might naively predict, given that it has been hypothesised that dense S-iridophores only orientate the stripes and interstripes, that in this case the final pattern would be the same as in WT fish. We simulate this in silico by initialising the initial interstripe to be one quarter of the way up the domain instead of half way. A typical pattern evolution for this initial condition is displayed in <xref ref-type="fig" rid="fig13">Figure 13B</xref>. We observe that subsequent stripes and interstripes still appear sequentially, either side of the initial interstripe, suggesting that the S-iridophores do play a role in the positioning of new stripes and interstripes. However, we do not observe usual WT patterning. In particular, stripes and interstripes exhibit more breaks compared to WT simulations. Moreover, developing stripes and interstripes become sequentially thinner as a result of the impact of domain growth. Once again, growth is the key factor: growth is centred at the middle of the domain and so when the initial stripe is not similarly centred, growth disrupts pattern formation in our model.</p></sec><sec id="s3-5-1-3"><title>Initial domain size contributes to the number of stripes and interstripes</title><p>In order to test the role of domain size in pattern development, we initialise the domain so that it is three times as tall as in WT simulations. That is, we initialise the domain to be 2 mm × 3 mm instead of 2 mm × 1 mm. All other parameters remain unchanged, including the rate of growth in the horizontal and vertical axis. We present a typical example of subsequent pattern development in <xref ref-type="fig" rid="fig13">Figure 13C</xref>. At stage PR, pattern development is similar to the pattern seen in WT fish at the same stage. However, at stage SP, we observe more stripes than are observed even by stage J+ in WT fish. By stage J+, instead of three interstripes and four stripes as seen in WT, we observe six stripes and seven interstripes. This suggests that the initial domain height influences the number of stripes and interstripes that develop, provided that growth is uniform and centred.</p></sec><sec id="s3-5-1-4"><title>Stripe insertion can occur on an initially striped domain</title><p>Kondo and Asai observed that, as the size of the marine angelfish <italic>Pomocanthus</italic> doubled, new stripes along the skin would develop between the old ones (<xref ref-type="bibr" rid="bib29">Kondo and Asal, 1995</xref>). This phenomenon has not been observed in zebrafish, where new stripes and interstripes appear consecutively at the dorsal and ventral periphery. We hypothesise that this is likely related to either pattern maintenance mechanisms or the spatial localisation of growth. Here, we experiment with the model to see whether stripe insertion can occur when the domain is populated at stage PB with adult-width stripes and interstripes. The results of an example realisation with these initial conditions are given in <xref ref-type="fig" rid="fig13">Figure 13(D)</xref>. We observe that, in this case, new interstripes do appear between pre-established stripes. This is because growth (which is centred in the middle of the domain) creates space within the middle of the already developed stripes and interstripes.</p></sec><sec id="s3-5-1-5"><title>S-iridophores are more important to the generation of melanocytes than xanthophores</title><p>We also used the model to make some more subtle predictions. For example, in the case of melanocyte differentiation, which we model as being promoted in the long range by both xanthophores (from observation of ablation experiments; <xref ref-type="bibr" rid="bib29">Kondo and Asal, 1995</xref>) and S-iridophores (from observations of <italic>pfe</italic>), there were no known parameter values for their relative strengths. We found using our model that by making the strength of S-iridophore promotion of melanocyte differentiation to be much greater than that of xanthophores, qualitatively and quantitatively the model simulated for WT, <italic>pfe</italic> and <italic>shd</italic> was greatly improved (see <xref ref-type="fig" rid="fig14">Figure 14A–B</xref>).</p><fig id="fig14" position="float"><label>Figure 14.</label><caption><title>Substantial alterations in starting conditions generate major alterations in pattern formation.</title><p>The effects of different signalling strengths in <italic>pfe</italic> and <italic>shd</italic>. Representative images of J+ simulations of (<bold>A</bold>) <italic>shd</italic> and (<bold>B</bold>) <italic>pfe</italic> where the signalling strength of melanocyte differentiation in the long range is increased (from left to right). Increasing the signalling strength of the respective cell types decreases the width of the interstripe X0 and increases the number of pseudo-stripes from 2 to 4. For our simulations, we choose the weakest shown signalling strength for xanthophores, corresponding to the furthest left of (<bold>A</bold>) and the strongest shown signalling strength for S-iridophores, corresponding to the furthest right of (<bold>B</bold>). (<bold>C</bold>) Stripe straightness of our simulations correlates with the simulated HAA/SL ratio. Each circle is one simulation, green circles indicate simulations up to stage J, black circles indicate simulations of up to stage J+. There are one hundred simulations in total for each stage. The red line is the line of best fit.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig14-v1.tif"/></fig></sec><sec id="s3-5-1-6"><title>Horizontal growth bias during development generates more tortuous stripes in WT fish</title><p>Interestingly, we also observed in our simulations that increased height-to-length ratio is correlated with stripes becoming more tortuous (R = −0.617, p&lt;0.01, <xref ref-type="fig" rid="fig14">Figure 14C</xref>). This phenomenon is not something we can see as being consistent with real fish and thus suggests that some interactions may be missing regarding the maintenance of stripe and interstripe formation.</p></sec></sec><sec id="s3-5-2"><title>An in silico investigation into the function of the <italic>leo</italic> gene</title><sec id="s3-5-2-1"><title>The model provides testable hypotheses for cryptic functions of the <italic>leo</italic> gene</title><p>The gene <italic>leo</italic> encodes Connexin39.4 (Cx39.4) (<xref ref-type="bibr" rid="bib60">Watanabe et al., 2006</xref>; <xref ref-type="bibr" rid="bib34">Maderspacher and Nüsslein-Volhard, 2003</xref>; <xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>). As a result, <italic>leo</italic> mutants display a leopard-like spotted pattern across the flank of the fish (<xref ref-type="fig" rid="fig15">Figure 15A–A’</xref>), instead of the usual striped pattern (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). In this section, we aim to hypothesise key aspects of the <italic>leo</italic> mutations using our model alongside observations of relevant mutants.</p><fig id="fig15" position="float"><label>Figure 15.</label><caption><title>Using the model to generate predictions regarding the underlying effects of the <italic>leo</italic> mutant.</title><p>(<bold>A</bold>–<bold>D</bold>) Adult <italic>leo</italic>, <italic>nac</italic>, <italic>pfe</italic> and <italic>shd</italic> respectively. (<bold>A’</bold>–<bold>D’</bold>) The flanks of <italic>leo</italic>, <italic>nac</italic>, <italic>pfe</italic> and <italic>shd</italic> respectively. (<bold>B’’</bold>–<bold>D’’</bold>) The flanks of <italic>leo;nac</italic>, <italic>leo;pfe</italic> and <italic>leo;shd</italic> respectively. (<bold>E</bold>) Example simulations where combinations of hypotheses 1–3 in the text are implemented. (<bold>F</bold>) Example simulations where combinations of hypotheses 1–5 in the text are implemented. Note that simulations of 1–5 are similar to simulations for 2–5, indicating that hypotheses one is not necessary to predict the <italic>leo</italic> phenotype. (<bold>G</bold>) Adult <italic>leo;sbr</italic> (<bold>G’</bold>) Flank of <italic>leo;sbr</italic>. (<bold>H</bold>–<bold>L</bold>) Adult mutants contrasting with (<bold>H’</bold>–<bold>L’</bold>) simulations using hypotheses 1–5 from the main text. (<bold>H</bold>–<bold>L</bold>) Flank of <italic>leo</italic>, <italic>leo;nac</italic>, <italic>leo;pfe</italic>, <italic>leo;shd</italic> and <italic>leo;sbr</italic> respectively. (<bold>H’</bold>–<bold>L’</bold>) Simulated images of <italic>leo</italic>, <italic>leo;pfe</italic>, <italic>leo;nac</italic>, <italic>leo;shd</italic> and <italic>leo;sbr</italic> respectively at stage J+. (<bold>A</bold>), (<bold>A’</bold>), (<bold>G</bold>), (<bold>G’</bold>), (<bold>H</bold>) and (<bold>L</bold>) from <xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>, (<bold>B</bold>–<bold>D’’</bold>), (<bold>I</bold>–<bold>K</bold>) from <xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref> and are all licensed under CC-BY 4.0 (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-fig15-v1.tif"/></fig><p>Pattern formation is also altered in the double mutants <italic>leo;shd</italic>, <italic>leo;nac</italic> and <italic>leo;pfe</italic> when compared with <italic>shd</italic>, <italic>nac</italic> and <italic>pfe</italic> (<xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>). For example, the flank of double mutant <italic>leo;nac</italic> is covered by xanthophores and dense S-iridophores (<xref ref-type="fig" rid="fig15">Figure 15B’’</xref>). This is in contrast to <italic>nac</italic> which also contains large patches of loose S-iridophores (<xref ref-type="fig" rid="fig15">Figure 15B–B’</xref>). Adult <italic>leo;pfe</italic> fish exhibit randomly distributed melanocytes instead of spots (<xref ref-type="fig" rid="fig15">Figure 15C–C’’</xref>). Finally, adult <italic>leo;shd</italic> exhibit an absence of melanocytes on the flank of the fish, instead, the flank of the fish is entirely covered with xanthophores. This is contrast to the melanocyte spots normally observed on <italic>shd</italic> (<xref ref-type="fig" rid="fig15">Figure 15D–D’’</xref>).</p><p>Connexins are involved in cell–cell communication and signalling. Since, Cx39.4 is required for normal function in melanocytes and xanthophores but not in S-iridophores (<xref ref-type="bibr" rid="bib60">Watanabe et al., 2006</xref>; <xref ref-type="bibr" rid="bib34">Maderspacher and Nüsslein-Volhard, 2003</xref>; <xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>), this suggests that in <italic>leo</italic>, cell–cell communication between melanocyte and xanthophores may be disrupted. Moreover, from observation of the double mutants, it seems that <italic>leo</italic> presumably generate heteromeric gap junctions among and between melanophores and xanthophores, controlling S-iridophore shape transitions (<xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>).</p><p>In order to investigate the influence of the <italic>leo</italic> gene, we first consider the individual cell–cell interactions that can be deduced from the literature and ask if these cell–cell interactions are sufficient for generating the pattern. So far, there has been one experimental study observing the individual behaviour of <italic>leo</italic> cells. <xref ref-type="bibr" rid="bib30">Kondo and Watanabe, 2015</xref> studied the movement in-vitro of <italic>leo</italic> melanocyte and xanthophore cells. They demonstrated that the <italic>leo</italic> melanocyte repulsive response to xanthophores was hardly observed in comparison to the marked repulsion in WT fish. This suggests that melanocyte repulsion from xanthophores is inhibited in <italic>leo</italic> (<xref ref-type="bibr" rid="bib30">Kondo and Watanabe, 2015</xref>). We will refer to this as hypothesis one for the effects of the mutant <italic>leo</italic>.</p><list list-type="bullet"><list-item><p>Hypothesis 1:Melanocytes are not repelled by xanthophores.</p></list-item></list><p>We can simulate pattern development in this case by turning off melanocyte repulsion by xanthophores in our model. This is shown in <xref ref-type="fig" rid="fig15">Figure 15E</xref> in the column numbered 1. We observe that at J+ the pattern consists of thicker interstripes than in WT fish, but not spots. Simulating the <italic>shd</italic> phenotype (lack of S-iridophores) with hypothesis 1, also does not generate the pattern expected in <italic>leo;shd</italic>. Hypothesis one is also insufficient to explain the phenotype of <italic>leo;nac</italic> or <italic>leo;pfe</italic>. This is because there are either no xanthophores or no melanocytes respectively in these mutants and therefore no melanocyte-xanthophore interactions. From these observations, we conclude that hypothesis one alone is insufficient for <italic>leo</italic> pattern formation.</p><p>To deduce the other cell-cell interactions that a mutation in <italic>leo</italic> could affect, we look at the patterns of adult <italic>leo;nac</italic> (<xref ref-type="fig" rid="fig15">Figure 15B’’</xref>) and <italic>leo;shd</italic> (<xref ref-type="fig" rid="fig15">Figure 15D’’</xref>). Of the three double mutants, these are the easiest from which to deduce single cell-cell interaction changes that could generate the double mutant patterns.</p><p>The <italic>leo;nac</italic> mutant displays an absence of loose S-iridophores compared to <italic>nac</italic>, suggesting that signalling of xanthophores which promote S-iridophore transition from dense to loose is inhibited in <italic>leo</italic>. The <italic>leo;shd</italic> mutant displays an absence of melanocytes in the adult pattern compared to <italic>shd</italic>, suggesting that long-range survival signal sent by xanthophores to melanocytes is inhibited in <italic>leo</italic>. We propose two further potential hypotheses for the effects of the mutant <italic>leo</italic>.</p><list list-type="bullet"><list-item><p>Hypothesis 2: Xanthophores do not promote the survival of melanocytes in the long range.</p></list-item><list-item><p>Hypothesis 3: Xanthophores do not promote the change of S-iridophores from dense to loose in the long range.</p></list-item></list><p>In <xref ref-type="fig" rid="fig15">Figure 15E</xref>, we provide a table of results for all combinations of hypotheses 1–3. We comment that hypotheses 1–3 cannot be all-encompassing, as so far, none of our hypotheses effect melanocyte-iridophore interactions and thus cannot generate the phenotype <italic>leo;pfe</italic>. Meanwhile, we focus on being able to generate <italic>leo;nac</italic> and <italic>leo;shd</italic>.</p><p>In <xref ref-type="fig" rid="fig15">Figure 15E</xref>, we demonstrate, that none of the hypotheses alone can generate the <italic>leo</italic> pattern, nor can they generate more than one of the double mutant types. When hypotheses 1 and 2 are combined, striping is disrupted, there are more breaks than in WT and interstripes are wider than WT. When 1 and 3 are combined, stripes are the same as in WT, presumably due to compensation of other cell-cell interactions, however, the simulated <italic>shd</italic> pattern has less aggregation of melanocytes than typically observed in <italic>shd</italic>. When hypotheses 2 and 3 are combined we observe the expansion of the initial interstripe to the very edges of the domain dorso-laterally, where there are some melanocytes, unlike <italic>leo</italic>. However, in this case, our simulations of <italic>leo;nac</italic> and <italic>leo;shd</italic> match the real phenotype. We demonstrate that when all hypotheses are implemented we generate a unstable pattern of spots which, eventually disappear over time, leaving a domain consisting of dense S-iridophores and xanthophores. Also, we can replicate <italic>leo;nac</italic> and <italic>leo;shd</italic>.</p><p>Finally, we attempt to elucidate the melanocyte-iridophore cell-cell interactions that are affected in the <italic>leo</italic> mutant by considering the phenotype of adult <italic>leo;pfe</italic> (<xref ref-type="fig" rid="fig15">Figure 15C’–C’’</xref>). The <italic>leo;pfe</italic> mutant displays a random distribution of melanocytes below a field of S-iridophores, suggesting that <italic>leo</italic> affects directed differentiation of melanocytes by dense S-iridophores. This leads us to two extra hypotheses for the effects of the <italic>leo</italic> gene:</p><list list-type="bullet"><list-item><p>Hypothesis 4: Melanocytes lose death signals from local dense S-iridophores and, as a result, can differentiate in dense S-iridophore zones.</p></list-item><list-item><p>Hypothesis 5: Melanocytes lose directed signalling from S-iridophores and hence, in the absence of xanthophores differentiate randomly.</p></list-item></list><p>In <xref ref-type="fig" rid="fig15">Figure 15F</xref>, we provide a table of representative simulated patterns for all combinations of hypotheses 1–3 with hypotheses 4 and 5. Any of the combinations considered can generate the <italic>leo;shd</italic> and <italic>leo;nac</italic> mutant phenotypes. Hypotheses 1–4 and 1–3,5 cannot generate the <italic>leo</italic> spots. However, if we combine all five hypotheses then we can replicate the phenotypes of all considered mutants; <italic>leo</italic>, <italic>leo;pfe</italic>, <italic>leo;nac</italic> and <italic>leo;shd</italic>. These results suggest that hypotheses 1–5 are sufficient for explaining <italic>leo</italic>.</p></sec><sec id="s3-5-2-2"><title>Necessity of the pre-existing hypothesis about <italic>leo</italic></title><p>Next, we evaluate the necessity of hypothesis (1) Hypothesis 1 is the only assumption that comes directly from the literature (<xref ref-type="bibr" rid="bib63">Yamanaka and Kondo, 2014</xref>). We show, using our model, in <xref ref-type="fig" rid="fig15">Figure 15F</xref> that there is no notable difference between the patterns generated with and without hypothesis 1 (i.e. hypotheses 1–5 versus hypotheses 2–5) other than that the spots may be slightly more irregular in when hypothesis 1 is included. This suggests that the cell–cell interaction mediating repulsion of melanocytes by xanthophores in <italic>leo</italic>, may not be necessary to generate the characteristic spots.</p></sec><sec id="s3-5-2-3"><title>Hypotheses 1–5 can replicate the patterns of <italic>leo</italic>, <italic>leo;nac</italic>, <italic>leo;pfe</italic> and <italic>leo;shd</italic></title><p><xref ref-type="fig" rid="fig15">Figure 15H—K</xref> display the flanks of <italic>leo</italic>, <italic>leo;pfe</italic>, <italic>leo;nac</italic> and <italic>leo;shd</italic> respectively. <xref ref-type="fig" rid="fig15">Figure 15H’–K’</xref> display the simulated patterns at stage J+ for in silico mutants <italic>leo</italic>, <italic>leo;pfe</italic>, <italic>leo;nac</italic> and <italic>leo;shd</italic> respectively where our assumptions for the function of <italic>leo</italic> are based on hypotheses 1–5 and, in the case of double mutants <italic>leo;pfe</italic>, <italic>leo;nac</italic> and <italic>leo;shd</italic>, our assumptions for <italic>pfe</italic>, <italic>nac</italic> and <italic>shd</italic> are as previously described in Section &quot;Simulation of ‘missing’ cell mutants&quot;.</p><p>We observe, for our simulations of <italic>leo</italic> (<xref ref-type="fig" rid="fig15">Figure 15H’</xref>), that melanocyte spots are associated with loose S-iridophores in a sea of dense S-iridophores and xanthophores just as in real <italic>leo</italic> fish (<xref ref-type="fig" rid="fig15">Figure 15H</xref>). For our simulations of <italic>leo;nac</italic> (<xref ref-type="fig" rid="fig15">Figure 15I’</xref>) we observe a domain that is fully populated with xanthophores and dense S-iridophores as expected (<xref ref-type="fig" rid="fig15">Figure 15I</xref>). Our simulations of <italic>leo;pfe</italic> (<xref ref-type="fig" rid="fig15">Figure 15J’</xref>) is fully populated with S-iridophores and randomly distributed melanocytes as expected (<xref ref-type="fig" rid="fig15">Figure 15J</xref>). Finally, our in silico representation of <italic>leo;shd</italic> (<xref ref-type="fig" rid="fig15">Figure 15K’</xref>) is fully populated with xanthophores only, as seen in <xref ref-type="fig" rid="fig15">Figure 15K</xref>.</p></sec><sec id="s3-5-2-4"><title>The <italic>leo;sbr</italic> cross mutant phenotype is an emergent property of the model</title><p>Previously in Section &quot;Simulation of other mutants&quot; we considered the <italic>sbr</italic> mutant. The <italic>sbr</italic> gene encodes Tight Junction Protein 1a (Tjp-1a), which is expressed cell autonomously in dense S-iridophores and causes the shape transition from dense to loose to be delayed (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). We showed in <xref ref-type="fig" rid="fig7">Figure 7K’–N’</xref> that our model could replicate the <italic>sbr</italic> pattern development by altering the rate at which S-iridophores attempt to change from loose to dense to be slower than in WT.</p><p><xref ref-type="fig" rid="fig15">Figure 15G—G’</xref> shows a typical example of the <italic>leo;sbr</italic> phenotype. The adult <italic>leo;sbr</italic> displays spots which, compared to <italic>leo</italic> (<xref ref-type="fig" rid="fig15">Figure 15A–A’</xref>), are more elongated. <xref ref-type="fig" rid="fig15">Figure 15L</xref> displays the flank of an adult <italic>leo;sbr</italic>. In <xref ref-type="fig" rid="fig15">Figure 15L’</xref>, we simulate a mutant that satisfies hypotheses 1–5 as well as our assumptions about <italic>sbr</italic> to generate an in silico leo;sbr. Consistent with real <italic>leo;sbr</italic> mutants, our simulation of <italic>leo;sbr</italic> has melanocyte spots associated with loose S-iridophores that are surrounded by xanthophores and dense S-iridophores. Comparison with our simulation of <italic>leo</italic> (<xref ref-type="fig" rid="fig15">Figure 15H’</xref>) demonstrates that our simulation of <italic>leo;sbr</italic> also displays more elongated spots than those of our <italic>leo</italic> simulations.</p></sec><sec id="s3-5-2-5"><title>Robustness of the <italic>leo</italic> assumptions in generating spots</title><p>As a test of robustness, we perform a rigorous robustness analysis by carrying out one hundred repeats of the mutant simulations with perturbed parameter values chosen uniformly at random from the range 0.75–1.25 of their described value as in Section &quot;Simulation of WT pattern&quot;. Ten of these randomly sampled repeats are given in Figure <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref> for <italic>leo</italic>. We observe that for all one hundred repeats that small perturbations to the rates still generate consistent spots, demonstrating the robustness of the model.</p><p>These results of this section demonstrate the remarkable ability of our model to generate the <italic>leo</italic> single and double mutant phenotypes under a set of specific proposed changes to the model rules; these proposals can be used to guide experimental exploration of the effects of the <italic>leo</italic> gene.</p></sec></sec></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>As a result primarily of beautiful experimental work, zebrafish pigment pattern formation has become the best characterised pigment patterning mechanism (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Kelsh et al., 2009</xref>; <xref ref-type="bibr" rid="bib53">Singh and Nüsslein-Volhard, 2015</xref>; <xref ref-type="bibr" rid="bib61">Watanabe and Kondo, 2015</xref>; <xref ref-type="bibr" rid="bib51">Patterson and Parichy, 2019</xref>). Zebrafish pigment pattern formation requires three pigment producing cell types: melanocytes, xanthophores and S-iridophores to generate the WT stripes (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). In an attempt to decipher the mechanisms underlying pattern formation, most previous mathematical models have largely focussed on xanthophores and melanocytes and neglected S-iridophores (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>; <xref ref-type="bibr" rid="bib5">Bullara and De Decker, 2015</xref>; <xref ref-type="bibr" rid="bib57">Volkening and Sandstede, 2015</xref>; <xref ref-type="bibr" rid="bib43">Painter et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Bloomfield et al., 2011</xref>). However, recent studies have shown that S-iridophores are a crucial component, with S-iridophore transitions between dense and loose driving pattern formation. First, the early provision of dense S-iridophores through the horizontal myoseptum orients stripes (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Kelsh et al., 2009</xref>; <xref ref-type="bibr" rid="bib53">Singh and Nüsslein-Volhard, 2015</xref>; <xref ref-type="bibr" rid="bib61">Watanabe and Kondo, 2015</xref>; <xref ref-type="bibr" rid="bib51">Patterson and Parichy, 2019</xref>). Moreover, S-iridophores sequentially pre-determine stripes and interstripes via respective shape changes in these regions (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Krauss et al., 2014</xref>).</p><p>Here, we have taken a bottom up approach to modelling zebrafish pattern formation with the aim of testing whether the experimentally defined set of biological rules for zebrafish pigment pattern formation might be sufficient to explain both the WT and the diversity of mutant pigment patterns. We used an individual based modelling approach incorporating all five cell-types deemed important for pattern formation in zebrafish. We formalised all respective cell-cell interactions mathematically, with interaction strengths, parametrised, where possible, by the biological literature (see <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>). For the less well-studied S-iridophore transitions, we analysed key mutant phenotypes to infer biologically realistic rules for these interactions, aiming to generate assumptions that were the simplest for pattern formation changes seen, but no simpler. We proved our models ability to simulate the distinctive pattern features during developmental stages PB through J+ of each of WT and six mutant patterns that had been used to determine the biological rules. We showed that in each case, our model simulations matched qualitatively the pattern development in real fish at the various developmental stages considered. This is consistent with the proposal that our modelling assumptions were sufficient for pattern development in these cases. As a more rigorous test of the model, we then investigated its ability to successfully simulate the distinctive patterns of three further mutants with defective S-iridophore properties, including two mutants that had not been modelled mathematically before. We showed that in each case, our model also correctly replicated patterns that were qualitatively similar to the corresponding mutant fish at various developmental milestones.</p><p>We assessed multiple quantitative features of our simulations against measured data from published studies, focusing on spatial distributions of cell-types, stripe width and melanocyte numbers. We found that in each case our simulations were highly reproducible, and quantitatively matched the biological observations. We conclude that our mathematical modelling approach, built upon the biological literature, provides substantial validation of the sufficiency of that set of biological rules in explaining pattern formation in zebrafish development for WT and many other mutant fish. Furthermore our modelling provides support for the plausibility of the deduced rules for S-iridophore packing transitions during pattern development.</p><p>Finally, we demonstrated the capability of our model to give valuable insight into the patterning mechanism and to make testable predictions about the biology.</p><p>This paper represents the first demonstration, to the best of our knowledge, of a model being used explicitly to test the impact of the <italic>sbr</italic> mutation. The <italic>sbr</italic> gene encodes Tjp1a, a key tight junction protein, and is expressed at much higher levels in S-iridophores in a dense configuration than those of the loose form (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). Furthermore, double mutant and chimaeric studies show that <italic>sbr</italic> acts cell-autonomously within the S-iridophores to control adult pigment pattern formation (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). These authors also show that in <italic>sbr</italic> mutants the transition from dense to loose S-iridophores is delayed, suggesting that this transition somehow depends upon Tjp1a in dense S-iridophores (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). Here, we test the patterning impact of this interpretation, by incorporating delayed S-iridophore state transition into our model, and show that this does indeed result in pattern changes consistent with the <italic>sbr</italic> phenotype. This provides theoretical support for Fadeev and colleagues deductions and deepens the interest in understanding the mechanistic basis for this role for Tjp1a.</p><p>Our modelling results demonstrate the applicability of complex models to test hypotheses that are difficult to test experimentally. Previously, it has been hypothesised that S-iridophores contribute to pattern formation by orienting the stripe. In Section &quot;An <italic>in silico</italic> investigation into important mechanisms for controlling pattern formation&quot;, we demonstrate that this is true. We show that simply reorientating the interstripe to a vertical position is not enough to produce vertical bars as our simulations exhibit a labyrinthine pattern instead of vertical bars. Careful observations of our simulations indicate that in addition to the initial condition, growth is important for determining the final pattern. We show that moving the initial position of the interstripe away from the centre of the flank, where growth is centred, also disrupts the patterning. We are also able to show that by enlarging the initial domain so that it is the same width but taller in height we show that we can generate more stripes and interstripes than that are usually observed at stage J+. Finally, by initialising a domain that is already populated with cells in a stripe position that we can replicate a different stripe formation mechanism seen in fish <italic>Pomocanthus</italic>. Whilst in zebrafish stripe formation is sequential, starting from an initial interstripe and developing bidirectionally from the middle, <italic>Pomocanthus</italic> develops stripes in-between other stripes. We show that if a striped pattern is fully formed when the fish is still growing (and growth is centred) that this forces new stripes to occur between the old ones, instead of at the periphery.</p><p>Our model is the first, to the best of our knowledge, to suggest that S-iridophores play a more important role in melanocyte differentiation than xanthophores. We found that by implementing a stronger signaling capacity of S-iridophores than xanthophores for long range melanocyte differentiation then we obtained a better qualitative and quantitative match for <italic>shd</italic> and <italic>pfe</italic> mutant patterns. In particular, a stronger signalling success rate for melanocyte differentiation from S-iridophores in the long range appeared to align subsequent stripes in <italic>pfe</italic> and WT, resulting in consistency of pseudo-stripe and stripe width respectively. The comparatively reduced signalling success rate for melanocyte differentiation from xanthophores in the long range reduced the number of pseudo-stripes in <italic>shd</italic> from four, to two at stage J+ which is more consistent with real data. Real <italic>shd</italic> fish typically exhibit fewer stripes (approx two at stage J+) than the four of WT (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="fig" rid="fig4">Figure 4A–B</xref>). We also found that this factor was important to produce melanocyte numbers that quantitatively matched data by Frohnhöfer et al when comparing between mutant and WT (<xref ref-type="fig" rid="fig10">Figure 10A</xref>) as well as a better stripe width match (<xref ref-type="fig" rid="fig10">Figure 10B</xref>). Thus, our study further reinforces findings that S-iridophores play an important role in determining stripe and interstripe width (without S-iridophores, X0 interstripe width in <italic>shd</italic> is increased) and not just the widely reported role of stripe alignment.</p><p>We have further built upon previous mathematical modelling work, by using our model to make predictions about the functions of the <italic>leo</italic> gene. The gene <italic>leo</italic> encodes Connexin 39.4, which is required in melanocytes and xanthophores but not S-iridophores (<xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>). Connexins play an important role in cell–cell signalling and communication so it has been postulated that the <italic>leo</italic> gene is involved in the signalling between melanocytes and xanthophores as well as signalling cues to S-iridophores regarding shape-transitions (<xref ref-type="bibr" rid="bib23">Irion et al., 2014</xref>). Previous to our investigation, there had been one study of the individual cell-cell interactions in <italic>leo</italic>. This study by demonstrated that unlike WT melanocytes, <italic>leo</italic> melanocytes are not repelled by xanthophores in the short range (<xref ref-type="bibr" rid="bib63">Yamanaka and Kondo, 2014</xref>). Using our model, we first demonstrated that this cell-cell interaction alone was not enough to reproduce the <italic>leo</italic> mutant pattern. Then, in a systematic approach we deduced four hypotheses about cell–cell interactions that might be affected by <italic>leo</italic>, which, upon implementing in our model, successfully replicated the patterns observed in <italic>leo, leo;pfe, leo;nac, leo;shd</italic> and <italic>leo;sbr</italic>. This work provides testable hypotheses about the effect of <italic>leo</italic> which can now guide future experimental work.</p><p>In contrast to most previous mathematical studies of pattern formation, the rules we propose for zebrafish pigment patterns are complex and extensive. For example, successful S-iridophore shape transitions in our model require information from both melanocytes and xanthophores. Many other studies have condensed zebrafish pattern formation to a few simple rules that can often be described by a series of partial differential equations (<xref ref-type="bibr" rid="bib28">Kondo, 2017</xref>; <xref ref-type="bibr" rid="bib43">Painter et al., 2015</xref>; <xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>), in particular Turing reaction-diffusion-type models posit that combinations of short and long range dynamics between melanocytes and xanthophores generate stripe patterns. Indeed, a lot of the excitement around such models is the ease with which small parameter value changes can sometimes result in diverse patterns, many readily recognisable from nature (<xref ref-type="bibr" rid="bib61">Watanabe and Kondo, 2015</xref>; <xref ref-type="bibr" rid="bib40">Metz et al., 2011</xref>; <xref ref-type="bibr" rid="bib37">Maini et al., 2012</xref>). A major difference between our model and Turing reaction-diffusion models is that small parameter changes in our model do not typically generate qualitatively different patterns, whereas Turing reaction-diffusion models can show substantial pattern changes in response to small alterations to parameters near to bifurcation points (<xref ref-type="bibr" rid="bib61">Watanabe and Kondo, 2015</xref>; <xref ref-type="bibr" rid="bib37">Maini et al., 2012</xref>). We suggest that the added complexity of the real system has evolved to make the patterning process robust, with partially redundant mechanisms insulating against the impact of stochastic variation during pattern formation.</p><p>Our modelling approach is analogous to that adopted in another recent study of zebrafish pattern formation, one which independently attempts to understand S-iridophore contributions to the process (<xref ref-type="bibr" rid="bib58">Volkening and Sandstede, 2018</xref>). In a similar fashion, Volkening et al generated an off-lattice model incorporating S-iridophores for which the rules were based upon the experimental literature. Upon implementing these rules they attempted to test the sufficiency of the known biology in describing the patterning process. Importantly, Volkening et al’s modelling approach differs from that adopted here in several ways. First, we use an on-lattice model, whilst Volkening et al use an off-lattice model. Using an on-lattice model allowed us to incorporate volume exclusion by other cells directly. Secondly, we used a continuous-time model, whereas Volkening et al update their model at simulated 24 hr intervals, with all rules implemented simultaneously. By using a continuous-time method, we are able to capture the stochasticity involved in rates of reactions and the ordering of events over time. Finally, we incorporate a hypothesis that S-iridophores contribute more strongly to promoting melanocyte differentiation than xanthophore differentiation, leading us to a better qualitative approximation of <italic>shd</italic> mutants and a better quantitative estimate of melanocyte numbers in <italic>shd</italic>, <italic>pfe</italic> and <italic>rse</italic> than shown before.</p><p>Importantly, the model of Volkening et al. also proves highly capable in generating simulations that accurately mimic WT and various mutant pigment patterns. This observation further strengthens support for the validity of the proposed S-iridophore rules we each postulate. More broadly, we consider that our independent mathematical approaches are mutually reinforcing in reaching the conclusion that the deduced biological rules may be largely sufficient to explain pigment pattern formation in zebrafish.</p><p>Further testing of our model should focus on investigating later stages of pigment pattern development and maintenance. To date, our focus has been on the crucial dynamic development between PB and J+ stages when the pattern is evolving; we have not considered pattern maintenance between J+ and adulthood. Work by <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref> has demonstrated that in <italic>pfe</italic> mutants, which up to stage J+ have similar numbers of melanocytes to WTs (approximately 90% of WT numbers), this drops to approximately 50% of WT by adulthood. Whilst our model correctly predicts melanocyte numbers in <italic>pfe</italic> compared to WT prior to J+, preliminary simulations up to adulthood suggest this sharp decrease in melanocyte numbers shown in real fish are currently not predicted by our model. This clearly indicates that new biological mechanisms concerning maintenance, likely involving the late differentiating L-iridophores, need to be analysed and incorporated into a model that extends to these later developmental stages.</p><p>From an analytical perspective, an advantage of our on-lattice model is its amenability to the derivation of a continuum model, although we note that continuum approximations to off-lattice individual-based models can also be derived. Our model therefore opens up the opportunity for future exploratory work using a continuum model for mutants <italic>pfe</italic> and <italic>nac</italic> in order to explore whether pattern formation in these cases individually can be described as Turing patterns and to determine parameter ranges for successful pattern formation.</p><p>It will also be interesting to investigate the role of growth in pattern formation and maintenance. We observed in our simulations a lower average stripe straightness (0.92) than to that of real WT fish (0.98). We further observed in our simulations that increased height-to-length ratio is correlated with stripes becoming more tortuous (<xref ref-type="fig" rid="fig14">Figure 14C</xref>). Stripes in real fish seem, qualitatively, to not show this effect, and we suspect that our model can be further refined here. A search for mechanisms that might increase stripe straightness will be valuable here, and we note that exploration of our model should allow candidate mechanisms to be identified in silico. Further investigation of this feature in our model once extended to adult pattern maintenance may also be important. For example, casual observation suggests that fish that show a particular height to length bias do not show notably tortuous stripes. Therefore, future work will be to understand what preserves the pattern in these cases. We predict that this may be related to the position of growth. Thus, future work will be to fully evaluate the effects of growth on the final pattern formation.</p><p>Another significant aspect which deserves attention concerns dorso-ventral pattern differences. In fish this is characterised by having more pigmented cells at the dorsal region than the ventral region. This is certainly true in adult <italic>nac</italic> (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), which has disproportionately more pigmented xanthophores in the dorsal than the ventral region). We have recently noted the subtle impact of dorso-ventral countershading on the WT zebrafish pigment pattern, including in the stripes themselves, and have identified Agouti as a key regulator of this process (<xref ref-type="bibr" rid="bib6">Cal et al., 2019</xref>). Furthermore, there are clear dorso-ventral asymmetries in some of the adult mutant patterns: e.g<italic>, nac</italic> mutants exhibit a strong X0 interstripe and a weak ventral interstripe X1D, and completely lack dorsal interstripes. Our model will allow us to explore possible drivers of this asymmetry, which we hypothesise will include Agouti signalling and also differential domain growth.</p><p>In conclusion, our on-lattice model, implementing the current biological understanding of adult zebrafish pigment pattern formation, strongly supports the validity of these experimental interpretations, motivating the detailed investigation of their molecular bases. Our model also highlights areas where knowledge is currently incomplete and, importantly, has allowed in silico investigations to identify plausible mechanisms that require experimental testing.</p></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Investigation, Methodology</p></fn><fn fn-type="con" id="con2"><p>Resources, Supervision, Investigation, Methodology</p></fn><fn fn-type="con" id="con3"><p>Supervision, Investigation, Methodology, Project administration</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Summary of all notation used in Appendix 1.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-52998-supp1-v1.pdf"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Summary of all notation used in Appendix 1 regarding short and long range interactions.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-52998-supp2-v1.pdf"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>SL measurements and HAA measurements and WT pattern description by stage are given as by <xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>.</title><p>Corresponding dpf for the stages are approximated from the images of <xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>.</p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-52998-supp3-v1.pdf"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>All continuous time events and their corresponding propensities for event attempts at time <inline-formula><mml:math id="inf50"><mml:mi>t</mml:mi></mml:math></inline-formula>, denoted <inline-formula><mml:math id="inf51"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for event <inline-formula><mml:math id="inf52"><mml:mi>i</mml:mi></mml:math></inline-formula> in minutes.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-52998-supp4-v1.pdf"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Full description of all the cell–cell interaction given in main text.</title><p>Melanocytes, xanthophores, loose iridophores, dense iridophores and xanthoblasts are denoted <inline-formula><mml:math id="inf53"><mml:mi>M</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf54"><mml:mi>X</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf55"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf56"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf57"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> respectively. C1, C2 stands for cell 1, cell 2, where <inline-formula><mml:math id="inf58"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf59"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> is the target cell and cell two is the signalling cell with corresponding signal range (R) that is either short (S), up to 0.04 mm, or long (L), 0.12 mm. This signal generates action (A) of cell type C1 of: movement (M), differentiation (D), proliferation (P) or survival (S) of type (T). For action (D) or (S), type (T) is denoted ‘+’ if the resultant action is promotion of action A and ‘-’ if the resultant action is inhibition of action (A). For action (M), type (T) is denoted ‘+’ if the resultant action is attraction towards cell type C1 and ‘-’ if the resultant action is repulsion away from cell type C1. *Melanocytes can also differentiate randomly, independent of any other cell type.</p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-52998-supp5-v1.pdf"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>Parameters implemented in the model.</title></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-52998-supp6-v1.pdf"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-52998-transrepform-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All mathematical modelling assumptions/ methods have been provided in the supplementary material. Code relating to this paper have been made available on github, at <ext-link ext-link-type="uri" xlink:href="https://github.com/JenniferOwen/Zebrafish-stripe-model">https://github.com/JenniferOwen/Zebrafish-stripe-model</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Zebrafish-stripe-model">https://github.com/elifesciences-publications/Zebrafish-stripe-model</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asai</surname> <given-names>R</given-names></name><name><surname>Taguchi</surname> <given-names>E</given-names></name><name><surname>Kume</surname> <given-names>Y</given-names></name><name><surname>Saito</surname> <given-names>M</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Zebrafish leopard gene as a component of the putative reaction-diffusion system</article-title><source>Mechanisms of Development</source><volume>89</volume><fpage>87</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1016/S0925-4773(99)00211-7</pub-id><pub-id pub-id-type="pmid">10559483</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Binder</surname> <given-names>BJ</given-names></name><name><surname>Simpson</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantifying spatial structure in experimental observations and agent-based simulations using pair-correlation functions</article-title><source>Physical Review E</source><volume>88</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.88.022705</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloomfield</surname> <given-names>JM</given-names></name><name><surname>Painter</surname> <given-names>KJ</given-names></name><name><surname>Sherratt</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>How does cellular contact affect differentiation mediated pattern formation?</article-title><source>Bulletin of Mathematical Biology</source><volume>73</volume><fpage>1529</fpage><lpage>1558</lpage><pub-id pub-id-type="doi">10.1007/s11538-010-9578-4</pub-id><pub-id pub-id-type="pmid">20798994</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Budi</surname> <given-names>EH</given-names></name><name><surname>Patterson</surname> <given-names>LB</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Post-embryonic nerve-associated precursors to adult pigment cells: genetic requirements and dynamics of morphogenesis and differentiation</article-title><source>PLOS Genetics</source><volume>7</volume><elocation-id>e1002044</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002044</pub-id><pub-id pub-id-type="pmid">21625562</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullara</surname> <given-names>D</given-names></name><name><surname>De Decker</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Pigment cell movement is not required for generation of turing patterns in zebrafish skin</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>6971</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms7971</pub-id><pub-id pub-id-type="pmid">25959141</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cal</surname> <given-names>L</given-names></name><name><surname>Suarez-Bregua</surname> <given-names>P</given-names></name><name><surname>Comesaña</surname> <given-names>P</given-names></name><name><surname>Owen</surname> <given-names>J</given-names></name><name><surname>Braasch</surname> <given-names>I</given-names></name><name><surname>Kelsh</surname> <given-names>R</given-names></name><name><surname>Cerdá-Reverter</surname> <given-names>JM</given-names></name><name><surname>Rotllant</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Countershading in zebrafish results from an Asip1 controlled dorsoventral gradient of pigment cell differentiation</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>3449</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-40251-z</pub-id><pub-id pub-id-type="pmid">30837630</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ceinos</surname> <given-names>RM</given-names></name><name><surname>Guillot</surname> <given-names>R</given-names></name><name><surname>Kelsh</surname> <given-names>RN</given-names></name><name><surname>Cerdá-Reverter</surname> <given-names>JM</given-names></name><name><surname>Rotllant</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Pigment patterns in adult fish result from superimposition of two largely independent pigmentation mechanisms</article-title><source>Pigment Cell &amp; Melanoma Research</source><volume>28</volume><fpage>196</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1111/pcmr.12335</pub-id><pub-id pub-id-type="pmid">25469713</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname> <given-names>E</given-names></name><name><surname>Peel</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evidence for the temporal regulation of insect segmentation by a conserved sequence of transcription factors</article-title><source>Development</source><volume>145</volume><elocation-id>dev.155580</elocation-id><pub-id pub-id-type="doi">10.1242/dev.155580</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davies</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Do different branching epithelia use a conserved developmental mechanism?</article-title><source>BioEssays</source><volume>24</volume><fpage>937</fpage><lpage>948</lpage><pub-id pub-id-type="doi">10.1002/bies.10161</pub-id><pub-id pub-id-type="pmid">12325126</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dini</surname> <given-names>S</given-names></name><name><surname>Binder</surname> <given-names>BJ</given-names></name><name><surname>Green</surname> <given-names>JEF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Understanding interactions between populations: individual based modelling and quantification using pair correlation functions</article-title><source>Journal of Theoretical Biology</source><volume>439</volume><fpage>50</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2017.11.014</pub-id><pub-id pub-id-type="pmid">29197512</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dooley</surname> <given-names>CM</given-names></name><name><surname>Mongera</surname> <given-names>A</given-names></name><name><surname>Walderich</surname> <given-names>B</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>On the embryonic origin of adult melanophores: the role of ErbB and kit signalling in establishing melanophore stem cells in zebrafish</article-title><source>Development</source><volume>140</volume><fpage>1003</fpage><lpage>1013</lpage><pub-id pub-id-type="doi">10.1242/dev.087007</pub-id><pub-id pub-id-type="pmid">23364329</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eom</surname> <given-names>DS</given-names></name><name><surname>Inoue</surname> <given-names>S</given-names></name><name><surname>Patterson</surname> <given-names>LB</given-names></name><name><surname>Gordon</surname> <given-names>TN</given-names></name><name><surname>Slingwine</surname> <given-names>R</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name><name><surname>Watanabe</surname> <given-names>M</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Melanophore migration and survival during zebrafish adult pigment stripe development require the immunoglobulin superfamily adhesion molecule Igsf11</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1002899</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002899</pub-id><pub-id pub-id-type="pmid">22916035</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eom</surname> <given-names>DS</given-names></name><name><surname>Bain</surname> <given-names>EJ</given-names></name><name><surname>Patterson</surname> <given-names>LB</given-names></name><name><surname>Grout</surname> <given-names>ME</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Long-distance communication by specialized cellular projections during pigment pattern development and evolution</article-title><source>eLife</source><volume>4</volume><elocation-id>e12401</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.12401</pub-id><pub-id pub-id-type="pmid">26701906</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eom</surname> <given-names>DS</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A macrophage relay for long-distance signaling during postembryonic tissue remodeling</article-title><source>Science</source><volume>355</volume><fpage>1317</fpage><lpage>1320</lpage><pub-id pub-id-type="doi">10.1126/science.aal2745</pub-id><pub-id pub-id-type="pmid">28209639</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fadeev</surname> <given-names>A</given-names></name><name><surname>Krauss</surname> <given-names>J</given-names></name><name><surname>Frohnhöfer</surname> <given-names>HG</given-names></name><name><surname>Irion</surname> <given-names>U</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Tight junction protein 1a regulates pigment cell organisation during zebrafish colour patterning</article-title><source>eLife</source><volume>4</volume><elocation-id>e06545</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06545</pub-id><pub-id pub-id-type="pmid">25915619</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frohnhöfer</surname> <given-names>HG</given-names></name><name><surname>Krauss</surname> <given-names>J</given-names></name><name><surname>Maischein</surname> <given-names>HM</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Iridophores and their interactions with other chromatophores are required for stripe formation in zebrafish</article-title><source>Development</source><volume>140</volume><fpage>2997</fpage><lpage>3007</lpage><pub-id pub-id-type="doi">10.1242/dev.096719</pub-id><pub-id pub-id-type="pmid">23821036</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gavagnin</surname> <given-names>E</given-names></name><name><surname>Owen</surname> <given-names>JP</given-names></name><name><surname>Yates</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Pair correlation functions for identifying spatial correlation in discrete domains</article-title><source>Physical Review E</source><volume>97</volume><elocation-id>062104</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.97.062104</pub-id><pub-id pub-id-type="pmid">30011502</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname> <given-names>DT</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Exact stochastic simulation of coupled chemical reactions</article-title><source>The Journal of Physical Chemistry</source><volume>81</volume><fpage>2340</fpage><lpage>2361</lpage><pub-id pub-id-type="doi">10.1021/j100540a008</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamada</surname> <given-names>H</given-names></name><name><surname>Watanabe</surname> <given-names>M</given-names></name><name><surname>Lau</surname> <given-names>HE</given-names></name><name><surname>Nishida</surname> <given-names>T</given-names></name><name><surname>Hasegawa</surname> <given-names>T</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Involvement of Delta/Notch signaling in zebrafish adult pigment stripe patterning</article-title><source>Development</source><volume>141</volume><fpage>318</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1242/dev.099804</pub-id><pub-id pub-id-type="pmid">24306107</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirata</surname> <given-names>M</given-names></name><name><surname>Nakamura</surname> <given-names>K</given-names></name><name><surname>Kanemaru</surname> <given-names>T</given-names></name><name><surname>Shibata</surname> <given-names>Y</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Pigment cell organization in the hypodermis of zebrafish</article-title><source>Developmental Dynamics</source><volume>227</volume><fpage>497</fpage><lpage>503</lpage><pub-id pub-id-type="doi">10.1002/dvdy.10334</pub-id><pub-id pub-id-type="pmid">12889058</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hirata</surname> <given-names>M</given-names></name><name><surname>Nakamura</surname> <given-names>K</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Pigment cell distributions in different tissues of the zebrafish, with special reference to the striped pigment pattern</article-title><source>Developmental Dynamics</source><volume>234</volume><fpage>293</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1002/dvdy.20513</pub-id><pub-id pub-id-type="pmid">16110504</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inoue</surname> <given-names>S</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name><name><surname>Watanabe</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Tetraspanin 3c requirement for pigment cell interactions and boundary formation in zebrafish adult pigment stripes</article-title><source>Pigment Cell &amp; Melanoma Research</source><volume>27</volume><fpage>190</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1111/pcmr.12192</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Irion</surname> <given-names>U</given-names></name><name><surname>Frohnhöfer</surname> <given-names>HG</given-names></name><name><surname>Krauss</surname> <given-names>J</given-names></name><name><surname>Çolak Champollion</surname> <given-names>T</given-names></name><name><surname>Maischein</surname> <given-names>HM</given-names></name><name><surname>Geiger-Rudolph</surname> <given-names>S</given-names></name><name><surname>Weiler</surname> <given-names>C</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Gap junctions composed of connexins 41.8 and 39.4 are essential for colour pattern formation in zebrafish</article-title><source>eLife</source><volume>3</volume><elocation-id>e05125</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.05125</pub-id><pub-id pub-id-type="pmid">25535837</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iwashita</surname> <given-names>M</given-names></name><name><surname>Watanabe</surname> <given-names>M</given-names></name><name><surname>Ishii</surname> <given-names>M</given-names></name><name><surname>Chen</surname> <given-names>T</given-names></name><name><surname>Johnson</surname> <given-names>SL</given-names></name><name><surname>Kurachi</surname> <given-names>Y</given-names></name><name><surname>Okada</surname> <given-names>N</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Pigment pattern in Jaguar/obelix zebrafish is caused by a Kir7.1 mutation: implications for the regulation of melanosome movement</article-title><source>PLOS Genetics</source><volume>2</volume><elocation-id>e197</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.0020197</pub-id><pub-id pub-id-type="pmid">17121467</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelsh</surname> <given-names>RN</given-names></name><name><surname>Brand</surname> <given-names>M</given-names></name><name><surname>Jiang</surname> <given-names>YJ</given-names></name><name><surname>Heisenberg</surname> <given-names>CP</given-names></name><name><surname>Lin</surname> <given-names>S</given-names></name><name><surname>Haffter</surname> <given-names>P</given-names></name><name><surname>Odenthal</surname> <given-names>J</given-names></name><name><surname>Mullins</surname> <given-names>MC</given-names></name><name><surname>van Eeden</surname> <given-names>FJ</given-names></name><name><surname>Furutani-Seiki</surname> <given-names>M</given-names></name><name><surname>Granato</surname> <given-names>M</given-names></name><name><surname>Hammerschmidt</surname> <given-names>M</given-names></name><name><surname>Kane</surname> <given-names>DA</given-names></name><name><surname>Warga</surname> <given-names>RM</given-names></name><name><surname>Beuchle</surname> <given-names>D</given-names></name><name><surname>Vogelsang</surname> <given-names>L</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>P. zebrafish pigmentation mutations and the processes of neural crest development</article-title><source>Development</source><volume>123</volume><fpage>369</fpage><lpage>389</lpage><pub-id pub-id-type="pmid">9007256</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelsh</surname> <given-names>RN</given-names></name><name><surname>Harris</surname> <given-names>ML</given-names></name><name><surname>Colanesi</surname> <given-names>S</given-names></name><name><surname>Erickson</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Stripes and belly-spots -- a review of pigment cell morphogenesis in vertebrates</article-title><source>Seminars in Cell &amp; Developmental Biology</source><volume>20</volume><fpage>90</fpage><lpage>104</lpage><pub-id pub-id-type="doi">10.1016/j.semcdb.2008.10.001</pub-id><pub-id pub-id-type="pmid">18977309</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelsh</surname> <given-names>RN</given-names></name><name><surname>Sosa</surname> <given-names>KC</given-names></name><name><surname>Owen</surname> <given-names>JP</given-names></name><name><surname>Yates</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Zebrafish adult pigment stem cells are multipotent and form pigment cells by a progressive fate restriction process: clonal analysis identifies shared origin of all pigment cell types</article-title><source>BioEssays : News and Reviews in Molecular, Cellular and Developmental Biology</source><volume>39</volume><elocation-id>201600234</elocation-id><pub-id pub-id-type="doi">10.1002/bies.201600234</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An updated kernel-based turing model for studying the mechanisms of biological pattern formation</article-title><source>Journal of Theoretical Biology</source><volume>414</volume><fpage>120</fpage><lpage>127</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2016.11.003</pub-id><pub-id pub-id-type="pmid">27838459</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondo</surname> <given-names>S</given-names></name><name><surname>Asal</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A reaction-diffusion wave on the skin of the marine angelfish Pomacanthus</article-title><source>Nature</source><volume>376</volume><fpage>765</fpage><lpage>768</lpage><pub-id pub-id-type="doi">10.1038/376765a0</pub-id><pub-id pub-id-type="pmid">24547605</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondo</surname> <given-names>S</given-names></name><name><surname>Watanabe</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Black, yellow, or silver: which one leads skin pattern formation?</article-title><source>Pigment Cell &amp; Melanoma Research</source><volume>28</volume><fpage>2</fpage><lpage>4</lpage><pub-id pub-id-type="doi">10.1111/pcmr.12328</pub-id><pub-id pub-id-type="pmid">25367546</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krauss</surname> <given-names>J</given-names></name><name><surname>Frohnhöfer</surname> <given-names>HG</given-names></name><name><surname>Walderich</surname> <given-names>B</given-names></name><name><surname>Maischein</surname> <given-names>HM</given-names></name><name><surname>Weiler</surname> <given-names>C</given-names></name><name><surname>Irion</surname> <given-names>U</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Endothelin signalling in Iridophore development and stripe pattern formation of zebrafish</article-title><source>Biology Open</source><volume>3</volume><fpage>503</fpage><lpage>509</lpage><pub-id pub-id-type="doi">10.1242/bio.20148441</pub-id><pub-id pub-id-type="pmid">24857848</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lister</surname> <given-names>JA</given-names></name><name><surname>Robertson</surname> <given-names>CP</given-names></name><name><surname>Lepage</surname> <given-names>T</given-names></name><name><surname>Johnson</surname> <given-names>SL</given-names></name><name><surname>Raible</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Nacre encodes a zebrafish Microphthalmia-Related protein that regulates Neural-Crest-Derived pigment cell fate</article-title><source>Development</source><volume>126</volume><fpage>3757</fpage><lpage>3767</lpage><pub-id pub-id-type="pmid">10433906</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopes</surname> <given-names>SS</given-names></name><name><surname>Yang</surname> <given-names>X</given-names></name><name><surname>Müller</surname> <given-names>J</given-names></name><name><surname>Carney</surname> <given-names>TJ</given-names></name><name><surname>McAdow</surname> <given-names>AR</given-names></name><name><surname>Rauch</surname> <given-names>GJ</given-names></name><name><surname>Jacoby</surname> <given-names>AS</given-names></name><name><surname>Hurst</surname> <given-names>LD</given-names></name><name><surname>Delfino-Machín</surname> <given-names>M</given-names></name><name><surname>Haffter</surname> <given-names>P</given-names></name><name><surname>Geisler</surname> <given-names>R</given-names></name><name><surname>Johnson</surname> <given-names>SL</given-names></name><name><surname>Ward</surname> <given-names>A</given-names></name><name><surname>Kelsh</surname> <given-names>RN</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Leukocyte tyrosine kinase functions in pigment cell development</article-title><source>PLOS Genetics</source><volume>4</volume><elocation-id>e1000026</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000026</pub-id><pub-id pub-id-type="pmid">18369445</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maderspacher</surname> <given-names>F</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Formation of the adult pigment pattern in zebrafish requires leopard and Obelix dependent cell interactions</article-title><source>Development</source><volume>130</volume><fpage>3447</fpage><lpage>3457</lpage><pub-id pub-id-type="doi">10.1242/dev.00519</pub-id><pub-id pub-id-type="pmid">12810592</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahalwar</surname> <given-names>P</given-names></name><name><surname>Walderich</surname> <given-names>B</given-names></name><name><surname>Singh</surname> <given-names>AP</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Local reorganization of xanthophores fine-tunes and colors the striped pattern of zebrafish</article-title><source>Science</source><volume>345</volume><fpage>1362</fpage><lpage>1364</lpage><pub-id pub-id-type="doi">10.1126/science.1254837</pub-id><pub-id pub-id-type="pmid">25214630</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahalwar</surname> <given-names>P</given-names></name><name><surname>Singh</surname> <given-names>AP</given-names></name><name><surname>Fadeev</surname> <given-names>A</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name><name><surname>Irion</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Heterotypic interactions regulate cell shape and density during color pattern formation in zebrafish</article-title><source>Biology Open</source><volume>5</volume><fpage>1680</fpage><lpage>1690</lpage><pub-id pub-id-type="doi">10.1242/bio.022251</pub-id><pub-id pub-id-type="pmid">27742608</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maini</surname> <given-names>PK</given-names></name><name><surname>Woolley</surname> <given-names>TE</given-names></name><name><surname>Baker</surname> <given-names>RE</given-names></name><name><surname>Gaffney</surname> <given-names>EA</given-names></name><name><surname>Lee</surname> <given-names>SS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Turing’s model for biological pattern formation and the robustness problem</article-title><source>Interface Focus</source><volume>2</volume><fpage>487</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1098/rsfs.2011.0113</pub-id><pub-id pub-id-type="pmid">23919129</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMenamin</surname> <given-names>SK</given-names></name><name><surname>Bain</surname> <given-names>EJ</given-names></name><name><surname>McCann</surname> <given-names>AE</given-names></name><name><surname>Patterson</surname> <given-names>LB</given-names></name><name><surname>Eom</surname> <given-names>DS</given-names></name><name><surname>Waller</surname> <given-names>ZP</given-names></name><name><surname>Hamill</surname> <given-names>JC</given-names></name><name><surname>Kuhlman</surname> <given-names>JA</given-names></name><name><surname>Eisen</surname> <given-names>JS</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Thyroid hormone-dependent adult pigment cell lineage and pattern in zebrafish</article-title><source>Science</source><volume>345</volume><fpage>1358</fpage><lpage>1361</lpage><pub-id pub-id-type="doi">10.1126/science.1256251</pub-id><pub-id pub-id-type="pmid">25170046</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mellgren</surname> <given-names>EM</given-names></name><name><surname>Johnson</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Pyewacket, a new zebrafish fin pigment pattern mutant</article-title><source>Pigment Cell Research</source><volume>19</volume><fpage>232</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1111/j.1600-0749.2006.00311.x</pub-id><pub-id pub-id-type="pmid">16704457</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metz</surname> <given-names>HC</given-names></name><name><surname>Manceau</surname> <given-names>M</given-names></name><name><surname>Hoekstra</surname> <given-names>HE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Turing patterns: how the fish got its spots</article-title><source>Pigment Cell &amp; Melanoma Research</source><volume>24</volume><fpage>12</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1111/j.1755-148X.2010.00814.x</pub-id><pub-id pub-id-type="pmid">21118391</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moreira</surname> <given-names>J</given-names></name><name><surname>Deutsch</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Pigment pattern formation in zebrafish during late larval stages: a model based on local interactions</article-title><source>Developmental Dynamics</source><volume>232</volume><fpage>33</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1002/dvdy.20199</pub-id><pub-id pub-id-type="pmid">15543601</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nakamasu</surname> <given-names>A</given-names></name><name><surname>Takahashi</surname> <given-names>G</given-names></name><name><surname>Kanbe</surname> <given-names>A</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Interactions between zebrafish pigment cells responsible for the generation of turing patterns</article-title><source>PNAS</source><volume>106</volume><fpage>8429</fpage><lpage>8434</lpage><pub-id pub-id-type="doi">10.1073/pnas.0808622106</pub-id><pub-id pub-id-type="pmid">19433782</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Painter</surname> <given-names>KJ</given-names></name><name><surname>Bloomfield</surname> <given-names>JM</given-names></name><name><surname>Sherratt</surname> <given-names>JA</given-names></name><name><surname>Gerisch</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A nonlocal model for contact attraction and repulsion in heterogeneous cell populations</article-title><source>Bulletin of Mathematical Biology</source><volume>77</volume><fpage>1132</fpage><lpage>1165</lpage><pub-id pub-id-type="doi">10.1007/s11538-015-0080-x</pub-id><pub-id pub-id-type="pmid">25963245</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parichy</surname> <given-names>DM</given-names></name><name><surname>Mellgren</surname> <given-names>EM</given-names></name><name><surname>Rawls</surname> <given-names>JF</given-names></name><name><surname>Lopes</surname> <given-names>SS</given-names></name><name><surname>Kelsh</surname> <given-names>RN</given-names></name><name><surname>Johnson</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2000">2000a</year><article-title>Mutational analysis of endothelin receptor b1 (rose) during neural crest and pigment pattern development in the zebrafish <italic>Danio rerio</italic></article-title><source>Developmental Biology</source><volume>227</volume><fpage>294</fpage><lpage>306</lpage><pub-id pub-id-type="doi">10.1006/dbio.2000.9899</pub-id><pub-id pub-id-type="pmid">11071756</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parichy</surname> <given-names>DM</given-names></name><name><surname>Ransom</surname> <given-names>DG</given-names></name><name><surname>Paw</surname> <given-names>B</given-names></name><name><surname>Zon</surname> <given-names>LI</given-names></name><name><surname>Johnson</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2000">2000b</year><article-title>An orthologue of the kit-related gene fms is required for development of neural crest-derived xanthophores and a subpopulation of adult melanocytes in the zebrafish, <italic>Danio rerio</italic></article-title><source>Development</source><volume>127</volume><fpage>3031</fpage><lpage>3044</lpage><pub-id pub-id-type="pmid">10862741</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Evolution of Danio pigment pattern development</article-title><source>Heredity</source><volume>97</volume><fpage>200</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1038/sj.hdy.6800867</pub-id><pub-id pub-id-type="pmid">16835593</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parichy</surname> <given-names>DM</given-names></name><name><surname>Elizondo</surname> <given-names>MR</given-names></name><name><surname>Mills</surname> <given-names>MG</given-names></name><name><surname>Gordon</surname> <given-names>TN</given-names></name><name><surname>Engeszer</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Normal table of postembryonic zebrafish development: staging by externally visible anatomy of the living fish</article-title><source>Developmental Dynamics</source><volume>238</volume><fpage>2975</fpage><lpage>3015</lpage><pub-id pub-id-type="doi">10.1002/dvdy.22113</pub-id><pub-id pub-id-type="pmid">19891001</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parichy</surname> <given-names>DM</given-names></name><name><surname>Turner</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Zebrafish Puma mutant decouples pigment pattern and somatic metamorphosis</article-title><source>Developmental Biology</source><volume>256</volume><fpage>242</fpage><lpage>257</lpage><pub-id pub-id-type="doi">10.1016/S0012-1606(03)00015-0</pub-id><pub-id pub-id-type="pmid">12679100</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname> <given-names>LB</given-names></name><name><surname>Bain</surname> <given-names>EJ</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pigment cell interactions and differential xanthophore recruitment underlying zebrafish stripe reiteration and Danio pattern evolution</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>5299</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms6299</pub-id><pub-id pub-id-type="pmid">25374113</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname> <given-names>LB</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Interactions with iridophores and the tissue environment required for patterning melanophores and xanthophores during zebrafish adult pigment stripe formation</article-title><source>PLOS Genetics</source><volume>9</volume><elocation-id>e1003561</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1003561</pub-id><pub-id pub-id-type="pmid">23737760</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname> <given-names>LB</given-names></name><name><surname>Parichy</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Zebrafish pigment pattern formation: insights into the development and evolution of adult form</article-title><source>Annual Review of Genetics</source><volume>53</volume><fpage>505</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1146/annurev-genet-112618-043741</pub-id><pub-id pub-id-type="pmid">31509458</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname> <given-names>AP</given-names></name><name><surname>Schach</surname> <given-names>U</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Proliferation, dispersal and patterned aggregation of iridophores in the skin prefigure striped colouration of zebrafish</article-title><source>Nature Cell Biology</source><volume>16</volume><fpage>604</fpage><lpage>611</lpage><pub-id pub-id-type="doi">10.1038/ncb2955</pub-id><pub-id pub-id-type="pmid">24776884</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname> <given-names>AP</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Zebrafish stripes as a model for vertebrate colour pattern formation</article-title><source>Current Biology</source><volume>25</volume><fpage>R81</fpage><lpage>R92</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.11.013</pub-id><pub-id pub-id-type="pmid">25602311</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svetic</surname> <given-names>V</given-names></name><name><surname>Hollway</surname> <given-names>GE</given-names></name><name><surname>Elworthy</surname> <given-names>S</given-names></name><name><surname>Chipperfield</surname> <given-names>TR</given-names></name><name><surname>Davison</surname> <given-names>C</given-names></name><name><surname>Adams</surname> <given-names>RJ</given-names></name><name><surname>Eisen</surname> <given-names>JS</given-names></name><name><surname>Ingham</surname> <given-names>PW</given-names></name><name><surname>Currie</surname> <given-names>PD</given-names></name><name><surname>Kelsh</surname> <given-names>RN</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Sdf1a patterns zebrafish melanophores and links the somite and melanophore pattern defects in choker mutants</article-title><source>Development</source><volume>134</volume><fpage>1011</fpage><lpage>1022</lpage><pub-id pub-id-type="doi">10.1242/dev.02789</pub-id><pub-id pub-id-type="pmid">17267445</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname> <given-names>G</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Melanophores in the stripes of adult zebrafish do not have the nature to gather, but disperse when they have the space to move</article-title><source>Pigment Cell &amp; Melanoma Research</source><volume>21</volume><fpage>677</fpage><lpage>686</lpage><pub-id pub-id-type="doi">10.1111/j.1755-148X.2008.00504.x</pub-id><pub-id pub-id-type="pmid">19067972</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tickle</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Making digit patterns in the vertebrate limb</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>7</volume><fpage>45</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1038/nrm1830</pub-id><pub-id pub-id-type="pmid">16493412</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volkening</surname> <given-names>A</given-names></name><name><surname>Sandstede</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Modelling stripe formation in zebrafish: an agent-based approach</article-title><source>Journal of the Royal Society Interface</source><volume>12</volume><elocation-id>20150812</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2015.0812</pub-id><pub-id pub-id-type="pmid">26538560</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volkening</surname> <given-names>A</given-names></name><name><surname>Sandstede</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Iridophores as a source of robustness in zebrafish stripes and variability in Danio patterns</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>3231</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-05629-z</pub-id><pub-id pub-id-type="pmid">30104716</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walderich</surname> <given-names>B</given-names></name><name><surname>Singh</surname> <given-names>AP</given-names></name><name><surname>Mahalwar</surname> <given-names>P</given-names></name><name><surname>Nüsslein-Volhard</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Homotypic cell competition regulates proliferation and tiling of zebrafish pigment cells during colour pattern formation</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>11462</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms11462</pub-id><pub-id pub-id-type="pmid">27118125</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watanabe</surname> <given-names>M</given-names></name><name><surname>Iwashita</surname> <given-names>M</given-names></name><name><surname>Ishii</surname> <given-names>M</given-names></name><name><surname>Kurachi</surname> <given-names>Y</given-names></name><name><surname>Kawakami</surname> <given-names>A</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name><name><surname>Okada</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Spot pattern of <italic>leopard Danio</italic> is caused by mutation in the zebrafish <italic>connexin41.8</italic> gene</article-title><source>EMBO Reports</source><volume>7</volume><fpage>893</fpage><lpage>897</lpage><pub-id pub-id-type="doi">10.1038/sj.embor.7400757</pub-id><pub-id pub-id-type="pmid">16845369</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watanabe</surname> <given-names>M</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Is pigment patterning in fish skin determined by the turing mechanism?</article-title><source>Trends in Genetics</source><volume>31</volume><fpage>88</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2014.11.005</pub-id><pub-id pub-id-type="pmid">25544713</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamaguchi</surname> <given-names>M</given-names></name><name><surname>Yoshimoto</surname> <given-names>E</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Pattern regulation in the stripe of zebrafish suggests an underlying dynamic and autonomous mechanism</article-title><source>PNAS</source><volume>104</volume><fpage>4790</fpage><lpage>4793</lpage><pub-id pub-id-type="doi">10.1073/pnas.0607790104</pub-id><pub-id pub-id-type="pmid">17360399</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamanaka</surname> <given-names>H</given-names></name><name><surname>Kondo</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>In vitro analysis suggests that difference in cell movement during direct interaction can generate various pigment patterns in vivo</article-title><source>PNAS</source><volume>111</volume><fpage>1867</fpage><lpage>1872</lpage><pub-id pub-id-type="doi">10.1073/pnas.1315416111</pub-id><pub-id pub-id-type="pmid">24449859</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Implementing the model</title><p>This text provides a full description of how a simulation of a WT fish is implemented. All notation used in appendix 1 is summarised in <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref> and <xref ref-type="supplementary-material" rid="supp2">2</xref>.</p></sec><sec id="s9" sec-type="appendix"><title>Model overview</title><p>We model five different cell types; yellow xanthophores (<inline-formula><mml:math id="inf60"><mml:mi>X</mml:mi></mml:math></inline-formula>), unpigmented xanthoblasts (<inline-formula><mml:math id="inf61"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>), black melanocytes (<inline-formula><mml:math id="inf62"><mml:mi>M</mml:mi></mml:math></inline-formula>), silver dense S-iridophores (<inline-formula><mml:math id="inf63"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>) and blue loose (<inline-formula><mml:math id="inf64"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula>) S-iridophores. We account for the three separate hypodermis layers upon which the cells lie as three separate lattice domains, a xanthophore layer represented by matrix <inline-formula><mml:math id="inf65"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula>, a melanocyte layer represented by matrix <inline-formula><mml:math id="inf66"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula>, and an S-iridophore layer represented by a matrix <inline-formula><mml:math id="inf67"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula>. We denote the length and height of domain <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf69"><mml:mi>t</mml:mi></mml:math></inline-formula> in terms of the numbers of lattice sites as <inline-formula><mml:math id="inf70"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf71"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> respectively. At any time, <inline-formula><mml:math id="inf72"><mml:mi>t</mml:mi></mml:math></inline-formula>, a lattice site at row <inline-formula><mml:math id="inf73"><mml:mi>i</mml:mi></mml:math></inline-formula> and column <inline-formula><mml:math id="inf74"><mml:mi>j</mml:mi></mml:math></inline-formula> in <inline-formula><mml:math id="inf75"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula> denoted <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can either be occupied by <inline-formula><mml:math id="inf77"><mml:mi>M</mml:mi></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> or be unoccupied, <inline-formula><mml:math id="inf79"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Similarly <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can either be occupied by <inline-formula><mml:math id="inf81"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="inf82"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, be occupied by <inline-formula><mml:math id="inf83"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="inf84"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, or be unoccupied, <inline-formula><mml:math id="inf85"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Finally, <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can either be occupied by <inline-formula><mml:math id="inf87"><mml:mi>X</mml:mi></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="inf88"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf89"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>, i.e. <inline-formula><mml:math id="inf90"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> or be unoccupied, <inline-formula><mml:math id="inf91"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. This captures volume exclusion rules on each lattice layer which require that at any given time, any lattice site on the domain can be occupied by at most one cell. If at any time during the simulation an action is chosen which would break this rule, this action is aborted. To account for the different packing densities of the cell types, lattice sites on <inline-formula><mml:math id="inf92"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf93"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> are of size 0.02 mm × 0.02 mm, whilst lattice sites in <inline-formula><mml:math id="inf94"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula> are of size 0.04 mm × 0.04 mm (<xref ref-type="bibr" rid="bib44">Parichy et al., 2000a</xref>). We denote these as <inline-formula><mml:math id="inf95"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math></inline-formula> mm and <inline-formula><mml:math id="inf96"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math></inline-formula> mm. Hence the simulated height and length at any given time <inline-formula><mml:math id="inf97"><mml:mi>t</mml:mi></mml:math></inline-formula> is given as <inline-formula><mml:math id="inf98"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf99"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. An illustration of the three layers and their corresponding cell types are given in <xref ref-type="fig" rid="fig2">Figure 2A</xref> in the main text. The lattices correspond to matrices;<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mpadded></mml:mrow></mml:math></disp-formula><disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mi>M</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>M</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi>M</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>M</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>M</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>M</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf100"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf102"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf103"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s10" sec-type="appendix"><title>Relating size to stage</title><p>Zebrafish development is described in the literature with respect to the standard length (SL) of the fish (<xref ref-type="bibr" rid="bib47">Parichy et al., 2009</xref>). We associate our domain at time <inline-formula><mml:math id="inf104"><mml:mi>t</mml:mi></mml:math></inline-formula> to different zebrafish developmental stages by calculating a simulated SL (<inline-formula><mml:math id="inf105"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) from the size of the domain at time <inline-formula><mml:math id="inf106"><mml:mi>t</mml:mi></mml:math></inline-formula> and relating this to the development stage using <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>. Since growth is linear with respect to time (in real life and modelled as so) and we initialise the domain 5.7 mm shorter than the real width (SL), the corresponding simulated SL for any simulation at time <inline-formula><mml:math id="inf107"><mml:mi>t</mml:mi></mml:math></inline-formula> can be calculated by:<disp-formula id="equ5"><label>(2)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>5.7</mml:mn><mml:mo>⁢</mml:mo><mml:mtext>mm</mml:mtext></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf109"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of sites in the <inline-formula><mml:math id="inf110"><mml:mi>y</mml:mi></mml:math></inline-formula> direction of domain type <inline-formula><mml:math id="inf111"><mml:mi>D</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf112"><mml:mi>t</mml:mi></mml:math></inline-formula>. The simulated height <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> directly corresponds to the height at the anterior margin of the anal fin (abbreviated as HAA) of the fish at all times.</p></sec><sec id="s11" sec-type="appendix"><title>Initial conditions (WT only)</title><p>The simulation is initialised to represent the zebrafish half way through stage PB at approximately 25dpf. At this stage the fish is approximately 1 mm in height (i.e., HAA is 1 mm) and 7.7 mm in length (i.e. SL is 7.7 mm). We model the full height and a subsection of the full length for convenience. We set <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Therefore, <inline-formula><mml:math id="inf116"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>=25, <inline-formula><mml:math id="inf117"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>=50, <inline-formula><mml:math id="inf118"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>X</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>I</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf119"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The initial occupancies for a WT simulation comprise three rows of <inline-formula><mml:math id="inf120"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> along the middle of the fish, that is, sites on rows 24 to 26 on <inline-formula><mml:math id="inf121"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> are fully occupied with <inline-formula><mml:math id="inf122"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> cells at time <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. This represents the S-iridophores which differentiate along the horizontal myoseptum between 21 and 25 dpf. We also place <inline-formula><mml:math id="inf124"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:math></inline-formula> uniformly at random on <inline-formula><mml:math id="inf125"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula> so that the initial occupancy density of melanocytes is<disp-formula id="equ6"><label>(3)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>M</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf126"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for any cell type <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the total number of cells of that type on the domain at time <inline-formula><mml:math id="inf128"><mml:mi>t</mml:mi></mml:math></inline-formula>. These scattered melanocytes represent the initial larval pattern at low density dispersed across the domain at the beginning of pattern metamorphosis. Similarly, we occupy the domain so that the initial density of xanthoblasts is 0.4. This density is chosen from evidence that larval xanthophores, which de-differentiate around 5 dpf, proliferate and cover much of the entire domain at the start of metamorphosis (<xref ref-type="bibr" rid="bib35">Mahalwar et al., 2014</xref>). We do this by placing <inline-formula><mml:math id="inf129"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> uniformly at random on <inline-formula><mml:math id="inf130"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> so<disp-formula id="equ7"><label>(4)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This is to represent the de-differentiated larval xanthophores which initially appear around 5 dpf, subsequently lose pigment (becoming xanthoblasts) and proliferate between 5 and 25 dpf. For all other cell types i.e. <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf132"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> = 0.</p></sec><sec id="s12" sec-type="appendix"><title>Model iteration</title><p>The model is updated in continuous time according to the Gillespie algorithm (<xref ref-type="bibr" rid="bib18">Gillespie, 1977</xref>) (see <xref ref-type="fig" rid="fig2">Figure 2B</xref> in the main text for an illustration). In our simulation we allow two different event types: continuous and fixed. A continuous event is an event that can happen at any point throughout the simulated time. For example; melanocyte birth or death. A fixed event is an event that occurs once during the simulation, and happens upon meeting predetermined conditions. In WT fish, we define only one fixed event. We assume there is appearance of metamorphic xanthophores <inline-formula><mml:math id="inf133"><mml:mi>X</mml:mi></mml:math></inline-formula> along the horizontal myoseptum at stage SP. This is justified by observations of <italic>shd</italic> in which delayed appearance of metamorphic <inline-formula><mml:math id="inf134"><mml:mi>X</mml:mi></mml:math></inline-formula> in interstripe X0 were noted. We found this delayed appearance was important for generating pseudo-stripe patterns in <italic>rse</italic> and <italic>shd</italic> which have reduced or entirely absent S-iridophores. We model this by occupying all the sites, regardless of prior occupancy, along the middle three rows of <inline-formula><mml:math id="inf135"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> with xanthophores (<inline-formula><mml:math id="inf136"><mml:mi>X</mml:mi></mml:math></inline-formula>) at stage SP that is sites <inline-formula><mml:math id="inf137"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf138"><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>X</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mo>:</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>X</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the time that the given simulation reaches the start of stage SP.</p><p>There are 15 continuous event types. These events are summarised in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>. They comprise cell birth, death, movement and shape transitions as well as growth of the domain.</p><p>An overview of how the model is updated is given in <xref ref-type="fig" rid="fig2">Figure 2B</xref> in the main text and can be described as follows. At any given time <inline-formula><mml:math id="inf140"><mml:mi>t</mml:mi></mml:math></inline-formula>, the model is first assessed for meeting the criteria of a fixed event. If the model meets the criteria, the fixed event occurs, is subsequently marked as complete and the simulation continues. If no fixed time event is to be implemented then one of the fifteen possible continuous time events is attempted. First an exponentially distributed waiting time<disp-formula id="equ8"><label>(5)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>is generated until the next continuous ‘event’ occurs where <inline-formula><mml:math id="inf141"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>15</mml:mn></mml:msubsup><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the sum of all of the event propensities given in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref> and <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is a uniformly distributed random number in <inline-formula><mml:math id="inf143"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (i.e. <inline-formula><mml:math id="inf144"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). Next, we generate <inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to determine which event occurs at time <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula>. The event <inline-formula><mml:math id="inf147"><mml:mi>i</mml:mi></mml:math></inline-formula> that satisfies<disp-formula id="equ9"><label>(6)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>i</mml:mi></mml:munderover></mml:mstyle><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow></mml:math></disp-formula>is chosen to occur and the domain is updated accordingly (provided conditions required for that event to occur are met). Time is also updated. <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. We continue this process iteratively, checking for fixed events, then subsequently generating a time for the next continuous event to occur. The process repeats until we reach the end of pattern metamorphosis, marked by length condition <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>13.5</mml:mn><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The algorithm is stochastic in the sense that, within any given simulation, there is variance with regard to the exact rate and order of event occurrence, just as in real fish.</p></sec><sec id="s13" sec-type="appendix"><title>Modeling cell–cell interactions</title><p>Continuous events 1–15 given in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref> are mediated by different cell-cell interactions. Cells interact on the fish skin at both short (neighbouring cells) and long (half a stripe width) range, possibly regulated by direct contact, dendrites, or longer extensions (filopodia or airinemes). In our model, uniform disks, with radii on the order of the distance 0.04 mm account for short-range interactions, and an annulus with an outer radius of approximately half an adult stripe width 0.24mm represent long-range dynamics.</p><p>We denote <inline-formula><mml:math id="inf150"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf152"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the set of site positions <inline-formula><mml:math id="inf153"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is in the short (0.04 mm) or long (0.24 mm) distance respectively from a focal site at position <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf156"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are both different for different domain types due to the different lattice site sizes. <inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are visualised for <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figure 3A–H</xref> in the main text. Formulae for these sets are given in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>.</p><p>To illustrate this see <xref ref-type="fig" rid="fig3">Figure 3A–H</xref> in the main text which compares the number of cells in the short (<xref ref-type="fig" rid="fig3">Figure 3A–D</xref>) and long (<xref ref-type="fig" rid="fig3">Figure 3E–H</xref>) range distance from a central site, <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, on different domain types. In this figure, <inline-formula><mml:math id="inf162"><mml:mi>M</mml:mi></mml:math></inline-formula> are represented as black circles. <inline-formula><mml:math id="inf163"><mml:mi>X</mml:mi></mml:math></inline-formula> are represented as yellow circles. <xref ref-type="fig" rid="fig2">Figure 2A</xref> is a visualisation of sites (marked in red) in <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf165"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the central site marked in grey. <inline-formula><mml:math id="inf166"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the sites marked in red in which a melanocyte resides. The number of melanocytes in the short range distance from <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf168"><mml:mi>t</mml:mi></mml:math></inline-formula> is given by <inline-formula><mml:math id="inf169"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig2">Figure 2B</xref> is a visualisation of the sites considered when calculating <inline-formula><mml:math id="inf170"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup></mml:math></inline-formula> (formula given in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). In this example, <inline-formula><mml:math id="inf171"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula>. To compare the number of <inline-formula><mml:math id="inf172"><mml:mi>M</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf173"><mml:mi>X</mml:mi></mml:math></inline-formula> in the short range distance of <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we consider <inline-formula><mml:math id="inf175"><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula> which corresponds to the weighted value of melanocytes in the short range distance with <inline-formula><mml:math id="inf176"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> the number of xanthophores in the short range. <xref ref-type="fig" rid="fig3">Figure 3C</xref> is a visualisation of sites (marked in red) in <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf178"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the central site marked in grey. <inline-formula><mml:math id="inf179"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>X</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the sites marked in red within which a xanthophore resides. The number of xanthophores in the short range distance from <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf181"><mml:mi>t</mml:mi></mml:math></inline-formula> is given by <inline-formula><mml:math id="inf182"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>X</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig2">Figure 2D</xref> is a visualisation of the sites considered when calculating <inline-formula><mml:math id="inf183"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (formula given in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). In this example, <inline-formula><mml:math id="inf184"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math></inline-formula>. To compare the number of <inline-formula><mml:math id="inf185"><mml:mi>M</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf186"><mml:mi>X</mml:mi></mml:math></inline-formula> in the short range distance of <inline-formula><mml:math id="inf187"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, at time <inline-formula><mml:math id="inf188"><mml:mi>t</mml:mi></mml:math></inline-formula>, we would compare <inline-formula><mml:math id="inf189"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>=14 with <inline-formula><mml:math id="inf190"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig3">Figure 3E</xref> is a visualisation of sites (marked in red) in <inline-formula><mml:math id="inf191"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf192"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the central site marked in grey. <inline-formula><mml:math id="inf193"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the sites marked in red in which a melanocyte resides. The number of melanocytes in the long range distance from <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is given by <inline-formula><mml:math id="inf195"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>M</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig2">Figure 2F</xref> is a visualisation of the sites considered when calculating <inline-formula><mml:math id="inf196"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (formula given in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). In this example, <inline-formula><mml:math id="inf197"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula>. To compare the number of <inline-formula><mml:math id="inf198"><mml:mi>M</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf199"><mml:mi>X</mml:mi></mml:math></inline-formula> in the long range distance of <inline-formula><mml:math id="inf200"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we consider <inline-formula><mml:math id="inf201"><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:mrow></mml:math></inline-formula> which corresponds to the weighted value of melanocytes in the long range distance with <inline-formula><mml:math id="inf202"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula>, the number of xanthophores in the long range. <xref ref-type="fig" rid="fig2">Figure 2G</xref> is a visualisation of sites (marked in red) in <inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf204"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the central site marked in grey. <inline-formula><mml:math id="inf205"><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>X</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the sites marked in red in which a xanthophore resides. The number of xanthophores in the long range distance from <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is given by <inline-formula><mml:math id="inf207"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>X</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig3">Figure 3H</xref> is a visualisation of the sites considered when calculating <inline-formula><mml:math id="inf208"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (formula given in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). In this example <inline-formula><mml:math id="inf209"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>. To compare the number of <inline-formula><mml:math id="inf210"><mml:mi>M</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf211"><mml:mi>X</mml:mi></mml:math></inline-formula> in the long range distance of <inline-formula><mml:math id="inf212"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we consider <inline-formula><mml:math id="inf213"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf214"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We denote <inline-formula><mml:math id="inf215"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mi>C</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊂</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf216"><mml:mi>C</mml:mi></mml:math></inline-formula> lies in layer <inline-formula><mml:math id="inf217"><mml:mi>D</mml:mi></mml:math></inline-formula> to be the sites in <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> occupied by cell type <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf220"><mml:mi>t</mml:mi></mml:math></inline-formula>. We denote <inline-formula><mml:math id="inf221"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, (<inline-formula><mml:math id="inf222"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) as the number of cells of type <inline-formula><mml:math id="inf223"><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> in the short (long) range distance 0.04 mm, (0.24 mm) from cell type <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> at <inline-formula><mml:math id="inf225"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Hence the number of cells of type <inline-formula><mml:math id="inf226"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> in the short distance from another cell of the same type at <inline-formula><mml:math id="inf227"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf228"><mml:mi>t</mml:mi></mml:math></inline-formula> is given by <inline-formula><mml:math id="inf229"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The formulae for <inline-formula><mml:math id="inf230"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf231"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf232"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> does not equal <inline-formula><mml:math id="inf233"><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are more complicated and are given in <xref ref-type="disp-formula" rid="equ10 equ11">Equations 7, 8</xref> (and <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> for reference).<disp-formula id="equ10"><label>(7)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"> <mml:mtext>if </mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mtext>or</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo> <mml:mtext>and </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo> <mml:mtext>if </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>≠</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"> <mml:mtext>if </mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ11"><label>(8)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"> <mml:mtext>if </mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mtext>or</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo> <mml:mtext>and </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo> <mml:mtext>if </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>≠</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:munder><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"> <mml:mtext>if </mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Simply, where domain types <inline-formula><mml:math id="inf234"><mml:mi>D</mml:mi></mml:math></inline-formula> do not have the same lattice site size <inline-formula><mml:math id="inf235"><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula>, the focal site coordinates <inline-formula><mml:math id="inf236"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the local neighbourhood undergo a transformation for the sites on a domain with a different size. For example, each site <inline-formula><mml:math id="inf237"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, corresponds to a quarter of site <inline-formula><mml:math id="inf238"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, this explains case two in <xref ref-type="disp-formula" rid="equ10">Equation 7</xref>. Similarly each site <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponds to four sites on <inline-formula><mml:math id="inf240"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula>, specifically <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf244"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This explains case three in <xref ref-type="disp-formula" rid="equ10 equ11">Equations 7 and 8</xref>. Note that since <inline-formula><mml:math id="inf245"><mml:mi>M</mml:mi></mml:math></inline-formula> is four times larger than all other cells in our simulation, we provide a weighting system when comparing <inline-formula><mml:math id="inf246"><mml:mi>M</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf247"><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">\</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> in some cases.</p></sec><sec id="s14" sec-type="appendix"><title>Boundary conditions</title><p>Boundary conditions are periodic along the horizontal boundaries and reflecting across the vertical boundaries. We implement periodic boundary conditions along the horizontal axis based on the assumption that the rate at which cells leave along this axis is approximately equal to the rate at which cells enter the domain at the opposite side.</p></sec><sec id="s15" sec-type="appendix"><title>Continuous time events</title><p>In this text, we will describe how each of the fifteen events are simulated upon being selected to occur by the Gillespie algorithm. An overview of all continuous time events and their corresponding rates is given in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>.</p><sec id="s15-1"><title>Movement (continuous time events 1–5)</title><p>We implement cell movement so that cells are biased towards cell types they are attracted to and away from cell types they are repelled by. The direction of the cell’s movement is determined using an on-lattice attraction-repulsion mechanism based on a model described by <xref ref-type="bibr" rid="bib10">Dini et al., 2018</xref> and is detailed as follows. If a cell is chosen to move, it is able to move in one of eight different possible orientations denoted by <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>O</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">𝑶</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. (See <xref ref-type="fig" rid="fig3">Figure 3(D)</xref> in the main text for an illustration of these directions).</p><p>The directional neighbours of each cell is given in <xref ref-type="fig" rid="fig2">Figure 2E,F</xref>. <xref ref-type="fig" rid="fig2">Figure 2E</xref> demonstrates the directional neighbourhoods of a focal cell <inline-formula><mml:math id="inf249"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> located in position <inline-formula><mml:math id="inf250"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (marked in grey) where <inline-formula><mml:math id="inf251"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. For the cell moving one space on <inline-formula><mml:math id="inf252"><mml:mi>D</mml:mi></mml:math></inline-formula>, the cell considers the occupancy of sites in <inline-formula><mml:math id="inf253"><mml:mrow><mml:mmultiscripts><mml:mi>S</mml:mi><mml:mi>k</mml:mi><mml:none/><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mi>D</mml:mi></mml:mmultiscripts><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> marked in red for <inline-formula><mml:math id="inf254"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow></mml:math></inline-formula> (top) and <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (bottom). (Q–X) <xref ref-type="fig" rid="fig2">Figure 2F</xref> demonstrates the directional neighbourhoods of a focal cell <inline-formula><mml:math id="inf256"><mml:mi>M</mml:mi></mml:math></inline-formula> located in position <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (marked in grey). For the cell <inline-formula><mml:math id="inf258"><mml:mi>M</mml:mi></mml:math></inline-formula> moving one space on <inline-formula><mml:math id="inf259"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula>, the cell considers the occupancy of sites in <inline-formula><mml:math id="inf260"><mml:mrow><mml:mmultiscripts><mml:mi>S</mml:mi><mml:mi>k</mml:mi><mml:none/><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mi>D</mml:mi></mml:mmultiscripts><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> marked in red for <inline-formula><mml:math id="inf261"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (top) and <inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow></mml:math></inline-formula> (bottom).</p><p>We define the probability that a cell attempts to move in a given direction with orientation <inline-formula><mml:math id="inf263"><mml:mi>O</mml:mi></mml:math></inline-formula> as <inline-formula><mml:math id="inf264"><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:math></inline-formula> (where <inline-formula><mml:math id="inf265"><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">𝑶</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). We calculate <inline-formula><mml:math id="inf266"><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:math></inline-formula>, using bias vector,<disp-formula id="equ12"><label>(9)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:munder accentunder="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑨</mml:mi><mml:mo>⁢</mml:mo><mml:munder accentunder="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">𝑹</mml:mi><mml:mo>⁢</mml:mo><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf267"><mml:mi mathvariant="bold-italic">𝑨</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf268"><mml:mi mathvariant="bold-italic">𝑹</mml:mi></mml:math></inline-formula>) is a matrix whose entries are the number of neighbouring cells within different segments of the attraction (repulsion) range and <inline-formula><mml:math id="inf269"><mml:munder accentunder="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula> (<inline-formula><mml:math id="inf270"><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula>) is a weight of attraction (repulsion) vector.</p><p>Matrices <inline-formula><mml:math id="inf271"><mml:mi mathvariant="bold-italic">𝑨</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf272"><mml:mi mathvariant="bold-italic">𝑹</mml:mi></mml:math></inline-formula> are defined as follows.<disp-formula id="equ13"><label>(10)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑨</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><label>(11)</label><mml:math id="m14"><mml:mrow><mml:mi mathvariant="bold-italic">𝑹</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where for example, <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the number of cells of type <inline-formula><mml:math id="inf274"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> within range 0.04 mm, that are orientation <inline-formula><mml:math id="inf275"><mml:mi>O</mml:mi></mml:math></inline-formula> from the focal cell <inline-formula><mml:math id="inf276"><mml:mi>C</mml:mi></mml:math></inline-formula> located in position <inline-formula><mml:math id="inf277"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf278"><mml:mi>t</mml:mi></mml:math></inline-formula>. This number is calculated differently depending on whether the focal site lies on lattice domain <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To compute <inline-formula><mml:math id="inf280"><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> we calculate the following. For any <inline-formula><mml:math id="inf281"><mml:mi>O</mml:mi></mml:math></inline-formula> we define subsets <inline-formula><mml:math id="inf282"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf283"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (where cell type <inline-formula><mml:math id="inf284"><mml:mi>C</mml:mi></mml:math></inline-formula> lies on domain type <inline-formula><mml:math id="inf285"><mml:mi>D</mml:mi></mml:math></inline-formula>) for each direction <inline-formula><mml:math id="inf286"><mml:mi>O</mml:mi></mml:math></inline-formula>;<disp-formula id="equ15"><label>(12)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>k</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ16"><label>(13)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ17"><label>(14)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="center left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>or </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ18"><label>(15)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="center left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>or </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These are the sets of sites in the short range distance, north, south, east and west of focal site <inline-formula><mml:math id="inf287"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Examples for <inline-formula><mml:math id="inf288"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf289"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> are sites marked in red on the left of <xref ref-type="fig" rid="fig2">Figure 2E–F</xref> respectively. By extension we define<disp-formula id="equ19"><label>(16)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mi>k</mml:mi><mml:mtext> and </mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ20"><label>(17)</label><mml:math id="m20"><mml:mrow><mml:mtext>or </mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo> <mml:mtext>and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ21"><label>(18)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>≥</mml:mo><mml:mi>k</mml:mi><mml:mtext> and </mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ22"><label>(19)</label><mml:math id="m22"><mml:mrow><mml:mtext>or </mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo> <mml:mtext>and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mi>r</mml:mi><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ23"><label>(20)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mtext> and </mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ24"><label>(21)</label><mml:math id="m24"><mml:mrow><mml:mtext>or </mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo> <mml:mtext>and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ25"><label>(22)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mtext> and </mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em">(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ26"><label>(23)</label><mml:math id="m26"><mml:mrow><mml:mtext>or </mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo> <mml:mtext>and </mml:mtext><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mi>r</mml:mi><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>These are the sets of sites in the short range distance, north-east, north-west, south-east and south-west of focal site <inline-formula><mml:math id="inf290"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We denote <inline-formula><mml:math id="inf291"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>O</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊆</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to be all the sites in short-range distance in orientation <inline-formula><mml:math id="inf292"><mml:mrow><mml:mi>O</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> occupied by cell type <inline-formula><mml:math id="inf293"><mml:mi>C</mml:mi></mml:math></inline-formula>. Hence we define<disp-formula id="equ27"><label>(24)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>O</mml:mi></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mi>O</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Therefore to compute the number of cells in each of the eight directions, we compute where <inline-formula><mml:math id="inf294"><mml:mi>C</mml:mi></mml:math></inline-formula> lies on <inline-formula><mml:math id="inf295"><mml:mi>D</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf296"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> lies on <inline-formula><mml:math id="inf297"><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> by;<disp-formula id="equ28"><label>(25)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>O</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> where </mml:mtext><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mtext>or</mml:mtext><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⌉</mml:mo><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo fence="false" stretchy="false">⌉</mml:mo><mml:mo fence="false" stretchy="false">⌋</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mtext> where </mml:mtext><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow><mml:mrow><mml:mi>O</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mtext> where </mml:mtext><mml:mspace width="thinmathspace"/><mml:mi>D</mml:mi><mml:mo>≠</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Next we define the weight of the attraction-repulsion vector by:<disp-formula id="equ29"><label>(26)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:munder accentunder="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf298"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf299"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) are the weights of attraction (repulsion) of cells of type <inline-formula><mml:math id="inf300"><mml:mi>C</mml:mi></mml:math></inline-formula> to cells of the type <inline-formula><mml:math id="inf301"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf302"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf303"><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, respectively defined in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>. Vectors <inline-formula><mml:math id="inf304"><mml:munder accentunder="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula> and <inline-formula><mml:math id="inf305"><mml:munder accentunder="true"><mml:mi>b</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula> are the vectors used to calculate <inline-formula><mml:math id="inf306"><mml:munder accentunder="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ12">Equation 9</xref>. To account for the difference in distance between adjacent neighbours and diagonal neighbours we normalise accordingly so that movement diagonally is proportionately less frequent than moving to adjacent squares.<disp-formula id="equ30"><label>(27)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>W</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ31"><label>(28)</label><mml:math id="m31"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ32"><label>(29)</label><mml:math id="m32"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ33"><label>(30)</label><mml:math id="m33"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ34"><label>(31)</label><mml:math id="m34"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ35"><label>(32)</label><mml:math id="m35"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ36"><label>(33)</label><mml:math id="m36"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ37"><label>(34)</label><mml:math id="m37"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:msubsup><mml:msub><mml:mi>v</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Finally we normalise <inline-formula><mml:math id="inf307"><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:math></inline-formula> s.t.;<disp-formula id="equ38"><label>(35)</label><mml:math id="m38"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">𝑶</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>O</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To summarise, we simulate movement as follows. Given the event is chosen such that a cell of type <inline-formula><mml:math id="inf308"><mml:mi>C</mml:mi></mml:math></inline-formula> is allocated to move. We choose a random cell of type <inline-formula><mml:math id="inf309"><mml:mi>C</mml:mi></mml:math></inline-formula>. We call its position <inline-formula><mml:math id="inf310"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Next values <inline-formula><mml:math id="inf311"><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:math></inline-formula> are calculated using <xref ref-type="disp-formula" rid="equ30 equ31 equ32 equ33 equ34 equ35 equ36">Equation 27–33</xref> and <xref ref-type="disp-formula" rid="equ38">Equation 35</xref>. A random number <inline-formula><mml:math id="inf312"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is generated. The cell attempts movement to <inline-formula><mml:math id="inf313"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (West) if <inline-formula><mml:math id="inf314"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf315"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (East) if <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>W</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><italic>etc.</italic> up to <inline-formula><mml:math id="inf317"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">𝑶</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">𝑶</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The cell movement is successful and the cell moves from site <inline-formula><mml:math id="inf318"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to the nearest neighbouring site in direction <inline-formula><mml:math id="inf319"><mml:mi>O</mml:mi></mml:math></inline-formula>, provided this site is empty. Otherwise the movement is aborted. Movement bias is specified by weights of attraction and repulsion (<inline-formula><mml:math id="inf320"><mml:munder accentunder="true"><mml:mi>a</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula> and <inline-formula><mml:math id="inf321"><mml:munder accentunder="true"><mml:mi>r</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula>). Relevant parameters for <inline-formula><mml:math id="inf322"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf323"><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> for different <inline-formula><mml:math id="inf324"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf325"><mml:msub><mml:mi>C</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are given in <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref> . If no such interaction bias is specified then there is no known attraction or repulsion dynamics between those cell types in the literature and so we assume that movement is not biased by this cell type. Note that for cell <inline-formula><mml:math id="inf326"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> there are no known short range interactions between <inline-formula><mml:math id="inf327"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> and other cell types so we model <inline-formula><mml:math id="inf328"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> movement as random, i.e, <inline-formula><mml:math id="inf329"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>, for <inline-formula><mml:math id="inf330"><mml:mrow><mml:mi>O</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">𝑶</mml:mi></mml:mrow></mml:math></inline-formula> at all times.</p><p>S-iridophore, xanthophore and xanthoblast proliferation (continuous time events 6–7)</p><p>Given the event is chosen such that a cell of type <inline-formula><mml:math id="inf331"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is determined to proliferate we choose a random cell of type <inline-formula><mml:math id="inf332"><mml:mi>C</mml:mi></mml:math></inline-formula> whose position is given by <inline-formula><mml:math id="inf333"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Next a random number <inline-formula><mml:math id="inf335"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is generated. This number is used to determine a neighbouring site into which a mother cell can place a daughter cell. This site is <inline-formula><mml:math id="inf336"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf337"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf338"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf339"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf340"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf341"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf342"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>For cell types <inline-formula><mml:math id="inf344"><mml:mrow><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, a proliferation event is successful if the site chosen is empty, and a new cell of the same type is placed into the chosen site, otherwise the event is aborted. In the case <inline-formula><mml:math id="inf345"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, a proliferation event is successful if the site chosen for the daughter cell is unoccupied and<disp-formula id="equ39"><label>(36)</label><mml:math id="m39"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ39">Equation 36</xref> is based on the following assumptions: (1) Dense S-iridophores promote xanthoblasts differentiation into xanthophores in the short range (<xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>). Dense S-iridophores express xanthogenic Colony Stimulating Factor-1 (Csf1) (<xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>) which is essential for xanthophore differentiation, proliferation and survival, allowing unpigmented xanthoblasts near to the dense S-iridophores to mature into xanthophores (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib59">Walderich et al., 2016</xref>); (2) melanocytes inhibit xanthophore specification in the short range (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>).</p></sec><sec id="s15-2"><title>Melanocyte differentiation (continuous time event 8)</title><p>If a melanocyte differentiation event is specified then a site <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is chosen at random. A differentiation event is successful and a new <inline-formula><mml:math id="inf347"><mml:mi>M</mml:mi></mml:math></inline-formula> appears in this site if the site <inline-formula><mml:math id="inf348"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is empty and the following is true:<disp-formula id="equ40"><label>(37)</label><mml:math id="m40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>w</mml:mi><mml:mi>α</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ41"><label>(38)</label><mml:math id="m41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>γ</mml:mi><mml:mi>w</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ42"><label>(39)</label><mml:math id="m42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>κ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf349"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf350"><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ40">Equation 37</xref> is based on the findings that dense S-iridophores and xanthophores promote the differentiation of melanocytes in the long range. This conclusion is drawn from observations in ablation experiments (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>) and in the <italic>pfe</italic> mutant, which retains a high number of <inline-formula><mml:math id="inf351"><mml:mi>M</mml:mi></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). <xref ref-type="disp-formula" rid="equ41">Equation 38</xref> is based on observations that melanocytes and xanthophores compete in the short range (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>). <xref ref-type="disp-formula" rid="equ42">Equation 39</xref> is based on observations that in WT fish, melanocyte centers rarely overlap with dense S-iridophores; however, melanocytes frequently settle adjacent to dense S-iridophores, suggesting short range inhibition (<xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>).</p><p>We assume there is some melanocyte differentiation into empty space that is independent of cues from other cells. This is from observations of double mutant fish <italic>nac;pfe</italic> that do not produce S-iridophores or xanthophores but phenotypically display uniformly distributed melanocytes at adulthood (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). Therefore, alternatively we also allow successful <inline-formula><mml:math id="inf352"><mml:mi>M</mml:mi></mml:math></inline-formula> differentiation if we generate a random number <inline-formula><mml:math id="inf353"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and we find that <inline-formula><mml:math id="inf354"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> in combination with the condition<disp-formula id="equ43"><label>(40)</label><mml:math id="m43"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Within each attempt, criterion (<xref ref-type="disp-formula" rid="equ40 equ41 equ42">Equation 37–39</xref>) is tried first. If this is not successful, criteria (<xref ref-type="disp-formula" rid="equ43">Equation 40</xref>) is tested instead.</p></sec><sec id="s15-3"><title>Xanthoblast differentiation (continuous time event 9)</title><p>If a xanthoblast differentiation event is chosen then an <inline-formula><mml:math id="inf355"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> is chosen at random from <inline-formula><mml:math id="inf356"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula>. Suppose the chosen <inline-formula><mml:math id="inf357"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> lies in site <inline-formula><mml:math id="inf358"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The differentiation event is successful and a <inline-formula><mml:math id="inf359"><mml:mi>X</mml:mi></mml:math></inline-formula> replaces the <inline-formula><mml:math id="inf360"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> in this site if the site <inline-formula><mml:math id="inf361"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is not occupied by a cell <inline-formula><mml:math id="inf362"><mml:mi>M</mml:mi></mml:math></inline-formula> (as melanocytes and xanthophores are known to compete in the short range [<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>]) and if the following is true.<disp-formula id="equ44"><label>(41)</label><mml:math id="m44"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ44">Equation 41</xref> is based on the following assumptions; (1) Dense S-iridophores promote xanthoblasts differentiation into xanthophores in the short range (<xref ref-type="bibr" rid="bib50">Patterson and Parichy, 2013</xref>). Dense S-iridophores express Csf1, allowing unpigmented xanthoblasts near to the dense S-iridophores to mature into xanthophores (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>; <xref ref-type="bibr" rid="bib59">Walderich et al., 2016</xref>). (2) melanocytes inhibit xanthophore specification in the short range (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>).</p><p>Alternatively the differentiation event is successful if:<disp-formula id="equ45"><label>(42)</label><mml:math id="m45"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>holds and a randomly generated number <inline-formula><mml:math id="inf363"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is such that <inline-formula><mml:math id="inf364"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, or <xref ref-type="disp-formula" rid="equ45">Equation(42)</xref> holds and either<disp-formula id="equ46"><label>(43)</label><mml:math id="m46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>31</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ47"><label>(44)</label><mml:math id="m47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>51</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>is true i.e, the total cell density with all cells combined is less than either 0.2 or 0.4 for different time milestones. We enforce a lower probability (<inline-formula><mml:math id="inf365"><mml:mi>u</mml:mi></mml:math></inline-formula> &lt; 0.01) for the alternative event (<xref ref-type="disp-formula" rid="equ45">Equation 42</xref>) since this differentiation event is not influenced by cues from other cells and thus is less likely. <xref ref-type="disp-formula" rid="equ46">Equation 43</xref> and <xref ref-type="disp-formula" rid="equ47">Equation 44</xref> are based on assumptions that if the domain is empty after some key time points, this promotes delayed differentiation of xanthoblasts as is observed in <italic>nac</italic> (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). Since melanocytes compete in the short range with xanthophores (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>) we only allow this to occur when constraints described by <xref ref-type="disp-formula" rid="equ45">Equation(42)</xref> are simultaneously held, for consistency.</p></sec><sec id="s15-4"><title>Iridophore transitions (continuous time event 10–11)</title><p>If an <inline-formula><mml:math id="inf366"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> to <inline-formula><mml:math id="inf367"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> shape transition is chosen, then an <inline-formula><mml:math id="inf368"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> is chosen uniformly at random from domain <inline-formula><mml:math id="inf369"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> and evaluated for meeting transition criteria. The transition is successful and the chosen <inline-formula><mml:math id="inf370"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> in position <inline-formula><mml:math id="inf371"><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is replaced with <inline-formula><mml:math id="inf372"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> in this site if either both<disp-formula id="equ48"><label>(45)</label><mml:math id="m48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>or alternatively<disp-formula id="equ49"><label>(46)</label><mml:math id="m49"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≥</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf373"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>=12, 9, one respectively. Alternatively if an <inline-formula><mml:math id="inf374"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> to <inline-formula><mml:math id="inf375"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> shape transition is chosen, then an <inline-formula><mml:math id="inf376"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> is chosen at random from domain <inline-formula><mml:math id="inf377"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> and evaluated for meeting transition criteria. This transition is successful and the chosen <inline-formula><mml:math id="inf378"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> in position <inline-formula><mml:math id="inf379"><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is replaced with <inline-formula><mml:math id="inf380"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> in this site if either<disp-formula id="equ50"><label>(47)</label><mml:math id="m50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>or alternatively<disp-formula id="equ51"><label>(48)</label><mml:math id="m51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf381"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf382"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf383"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. These conditions are based on observations of the induction set (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>) (for more details see Section &quot;Modelling assumptions&quot; in the main text). The parameters <inline-formula><mml:math id="inf384"><mml:msub><mml:mi>L</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf385"><mml:msub><mml:mi>S</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf386"><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf387"><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf388"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf389"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> were chosen to give straight stripes with few breaks at stage J+ in WT simulations. However, with some small variations to these parameters,the patterns generated are qualitatively similar.</p></sec><sec id="s15-5"><title>Melanocyte death (continuous time event 12)</title><p>If a melanocyte death event is chosen, then a cell of type <inline-formula><mml:math id="inf390"><mml:mi>M</mml:mi></mml:math></inline-formula> is chosen at random from <inline-formula><mml:math id="inf391"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula>. Suppose the chosen <inline-formula><mml:math id="inf392"><mml:mi>M</mml:mi></mml:math></inline-formula> lies in site <inline-formula><mml:math id="inf393"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The death event is successful and the melanocyte is removed from site <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> i.e. <inline-formula><mml:math id="inf395"><mml:mrow><mml:mi mathvariant="bold">𝐌</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>k</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is set to 0, if<disp-formula id="equ52"><label>(49)</label><mml:math id="m52"><mml:mrow><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ52">Equation 49</xref> is based on findings that xanthophores and melanocytes compete in the short range (<xref ref-type="bibr" rid="bib42">Nakamasu et al., 2009</xref>). Alternatively, the melanocyte death is successful if a randomly generated number <inline-formula><mml:math id="inf396"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, is such that <inline-formula><mml:math id="inf397"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula> and both of the following two cases hold:<disp-formula id="equ53"><label>(50)</label><mml:math id="m53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>σ</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>≤</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ54"><label>(51)</label><mml:math id="m54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mi>ω</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf398"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. <xref ref-type="disp-formula" rid="equ53">Equation 50</xref> is based on findings that <inline-formula><mml:math id="inf399"><mml:mi>M</mml:mi></mml:math></inline-formula> appear to inhibit the survival of <inline-formula><mml:math id="inf400"><mml:mi>M</mml:mi></mml:math></inline-formula> in the long range and that <inline-formula><mml:math id="inf401"><mml:mi>X</mml:mi></mml:math></inline-formula> promote the survival of <inline-formula><mml:math id="inf402"><mml:mi>M</mml:mi></mml:math></inline-formula> in the long range (<xref ref-type="bibr" rid="bib55">Takahashi and Kondo, 2008</xref>). In <xref ref-type="disp-formula" rid="equ54">Equation 51</xref>, <inline-formula><mml:math id="inf403"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> are a proxy for L-iridophores, which promote the survival of <inline-formula><mml:math id="inf404"><mml:mi>M</mml:mi></mml:math></inline-formula> in the short range (<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>). We found this equation was important for maintaining melanocytes in mutant <italic>pfe</italic> in our simulations. Moreover, the two equations <xref ref-type="disp-formula" rid="equ53">Equation 50</xref> and <xref ref-type="disp-formula" rid="equ54">Equation 51</xref> combined were important for maintaining melanocytes in the interstripes in <italic>pfe</italic> (as seen in real fish) in our simulations. We found it was important that this alternative event had a low probability of success (0.001) but not zero. In <italic>pfe</italic> there are no xanthophores so <xref ref-type="disp-formula" rid="equ53">Equation 50</xref> enforces melanocyte death where the number of melanocytes in the long range was greater than zero. Therefore, when there was too high a probability of success, in <italic>pfe</italic> simulations the stripe, interstripe structure that is usually maintained between WT and <italic>pfe</italic> was broken into randomly dispersed spots of melanocytes distance 0.24 mm apart. On the other hand, when it was too low, we did not observe melanocytes in the interstripe in our <italic>pfe</italic> simulations, unlike in real <italic>pfe</italic>.</p></sec><sec id="s15-6"><title>Xanthoblast pulling event (continuous time event 13)</title><p>Suppose a ‘xanthoblast pull melanocyte’ event is chosen at time <inline-formula><mml:math id="inf405"><mml:mi>t</mml:mi></mml:math></inline-formula>, then we choose an <inline-formula><mml:math id="inf406"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> uniformly at random from all <inline-formula><mml:math id="inf407"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> occupying <inline-formula><mml:math id="inf408"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> that meets the following criterion: suppose the chosen <inline-formula><mml:math id="inf409"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> resides in site <inline-formula><mml:math id="inf410"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, then the corresponding site on <inline-formula><mml:math id="inf411"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf412"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> must be empty. We simulate this by randomly choosing <inline-formula><mml:math id="inf413"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> on <inline-formula><mml:math id="inf414"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula>, and checking whether <inline-formula><mml:math id="inf415"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is empty. If so, we continue to the next stage. Otherwise we repeat through all <inline-formula><mml:math id="inf416"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> on <inline-formula><mml:math id="inf417"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> until we either find a suitable <inline-formula><mml:math id="inf418"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>. If no <inline-formula><mml:math id="inf419"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> satisfy this criteria at time <inline-formula><mml:math id="inf420"><mml:mi>t</mml:mi></mml:math></inline-formula> then we abort the cell-cell pulling event. Given we find a suitable <inline-formula><mml:math id="inf421"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>, the chosen <inline-formula><mml:math id="inf422"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> will attempt to attach and pull a melanocyte within range (airinemes extend to a length of up to 5–6 cell diameters away or 0.1–0.12 mm [<xref ref-type="bibr" rid="bib13">Eom et al., 2015</xref>]) to position <inline-formula><mml:math id="inf423"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We simulate this as follows. First, we generate a random position <inline-formula><mml:math id="inf424"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> uniformly at random from the 28 possible lattice positions euclidean distance 0.1 mm from the site <inline-formula><mml:math id="inf425"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> given by <inline-formula><mml:math id="inf426"><mml:mi>P</mml:mi></mml:math></inline-formula>. These sites are shown in <xref ref-type="fig" rid="fig1">Figure 1A–B</xref> and their coordinates are given by;<disp-formula id="equ55"><mml:math id="m55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(52)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(53)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(54)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(55)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(56)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(57)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(58)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Next we translate position <inline-formula><mml:math id="inf427"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> on <inline-formula><mml:math id="inf428"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> to its corresponding position on <inline-formula><mml:math id="inf429"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula>. If <inline-formula><mml:math id="inf430"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, then the melanocyte is pulled from its site <inline-formula><mml:math id="inf431"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> into <inline-formula><mml:math id="inf432"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula><italic>i.e.</italic><inline-formula><mml:math id="inf433"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf434"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>. The action is deemed complete. Otherwise, if <inline-formula><mml:math id="inf435"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, i.e, the site is empty, then the process repeats for the same <inline-formula><mml:math id="inf436"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>. From here, <inline-formula><mml:math id="inf437"><mml:mi>P</mml:mi></mml:math></inline-formula> becomes <inline-formula><mml:math id="inf438"><mml:mrow><mml:mi>P</mml:mi><mml:mo>\</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a new <inline-formula><mml:math id="inf439"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> pair are generated uniformly at random from <inline-formula><mml:math id="inf440"><mml:mi>P</mml:mi></mml:math></inline-formula> until either an <inline-formula><mml:math id="inf441"><mml:mi>M</mml:mi></mml:math></inline-formula> is found within the range specified or until <inline-formula><mml:math id="inf442"><mml:mi>P</mml:mi></mml:math></inline-formula> is empty (i.e. after 28 tries). At this point, we will have determined that there were no melanocytes close enough to the xanthoblast for the xanthoblast to successfully pull.</p></sec><sec id="s15-7"><title>Growth (continuous time events 14–15)</title><p>Given a growth event is chosen in the horizontal (vertical) direction, from each column (row), a site location is chosen uniformly at random at which insertion of new empty site above or below (randomly chosen) will occur. See <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1C-D</xref> for an example of a growth event in the vertical direction.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Implementation of xanthoblast-melanocyte communication and domain growth.</title><p>(<bold>A</bold>–<bold>B</bold>) Range for xanthoblast cytonemes in our model. Figure:range_pull The range of xanthoblast cytonemes on <inline-formula><mml:math id="inf443"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula>. The centre lattice site (marked in purple) represents site <inline-formula><mml:math id="inf444"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The lattice sites labelled in red are those sites <inline-formula><mml:math id="inf445"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that lie in the range of the cytonemes of an <inline-formula><mml:math id="inf446"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> occupying site <inline-formula><mml:math id="inf447"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (the sites given by set <inline-formula><mml:math id="inf448"><mml:mi>P</mml:mi></mml:math></inline-formula>). Figure:range_pull_mel The range of xanthoblast cytonemes on <inline-formula><mml:math id="inf449"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula>. The sites indicated with in orange or yellow are those sites that can be reached by the range of <inline-formula><mml:math id="inf450"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> in <inline-formula><mml:math id="inf451"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The colour of any given site <inline-formula><mml:math id="inf452"><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> reflects the number of corresponding sites on <inline-formula><mml:math id="inf453"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf454"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf455"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf456"><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that are within range of the cytonemes (marked in red in (<bold>A</bold>)) and thus the probability of the site being chosen in relation to other coloured sites. Specifically, sites labelled in orange are twice as likely to be chosen than those sites marked in yellow. (<bold>C</bold>–<bold>D</bold>) An example growth event in the vertical direction. Squares represent sites in a given domain. Yellow circles represent cells occupying these sites. (<bold>C</bold>) First a site is chosen at random from each column (marked in red). (<bold>D</bold>) Next a new site is inserted either above or below the first site with probability <inline-formula><mml:math id="inf457"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula>. Each of the chosen sites are marked in dark grey.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-app1-fig1-v1.tif"/></fig><p>To account for the different lattice sizes, each time a growth event in the horizontal (vertical) direction occurs, <inline-formula><mml:math id="inf458"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf459"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) increases by one and <inline-formula><mml:math id="inf460"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf461"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf462"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>X</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf463"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>I</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) increases by two. This means that when a growth event is chosen, the rules described above occur once in the <inline-formula><mml:math id="inf464"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula> layer, and twice consecutively in <inline-formula><mml:math id="inf465"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf466"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula>. This is to ensure that the domain size remains consistent between the three layers. That is,<disp-formula id="equ56"><label>(59)</label><mml:math id="m56"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>X</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi>I</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ57"><label>(60)</label><mml:math id="m57"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>for all time <inline-formula><mml:math id="inf467"><mml:mi>t</mml:mi></mml:math></inline-formula>.</p></sec></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s16" sec-type="appendix"><title>Mutant implementation</title><p>In this text, we describe how the WT fish simulation is altered in our model to replicate changes known to be present in a variety of mutant fish.</p></sec><sec id="s17" sec-type="appendix"><title>Simulating the <italic>shd</italic> mutant</title><p>The gene <italic>shady</italic> (<italic>shd</italic>) encodes zebrafish leukocyte tyrosine kinase (Ltk) which plays a role in S-iridophore specification (<xref ref-type="bibr" rid="bib33">Lopes et al., 2008</xref>). As a result, strong <italic>shd</italic> mutants lack S-iridophores. To simulate this defect, we remove all S-iridophores from the initial domain, i.e, we set <inline-formula><mml:math id="inf468"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Since new S-iridophores are only generated by the proliferation of existing S-iridophores, this means that <inline-formula><mml:math id="inf469"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all time <inline-formula><mml:math id="inf470"><mml:mi>t</mml:mi></mml:math></inline-formula>. (Note: As a result the propensities of events 4, 5, 7, 10 and 11, that is, the movement of <inline-formula><mml:math id="inf471"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula>, movement of <inline-formula><mml:math id="inf472"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>, proliferation <inline-formula><mml:math id="inf473"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf474"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>, transition of <inline-formula><mml:math id="inf475"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> to <inline-formula><mml:math id="inf476"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> and transitions of <inline-formula><mml:math id="inf477"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> to <inline-formula><mml:math id="inf478"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> are always zero during this simulation.)</p></sec><sec id="s18" sec-type="appendix"><title>Simulating the <italic>pfe</italic> mutant</title><p>Gene <italic>pfeffer</italic> (<italic>pfe</italic>) (alternatively known as <italic>salz</italic> (<italic>sal</italic>)) encodes for colony stimulating factor one receptor (csf1ra) which plays a role in xanthophore specification and migration. In strong alleles, adult fish exhibit no detectable xanthophores in the body of embryos. To simulate this defect we remove all xanthophores and xanthoblasts from the initial domain, <italic>i.e.</italic> we set <inline-formula><mml:math id="inf479"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We also remove the fixed event at stage SP where newly differentiated <inline-formula><mml:math id="inf480"><mml:mi>X</mml:mi></mml:math></inline-formula> cells appear along the horizontal myoseptum. Since new xanthophores are only generated by the proliferation of existing xanthophores, and the differentiation of xanthoblasts this means that <inline-formula><mml:math id="inf481"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all time <inline-formula><mml:math id="inf482"><mml:mi>t</mml:mi></mml:math></inline-formula>. (Note: As a result the propensities of events 2, 3, 6, 9, 15, that is, the movement of <inline-formula><mml:math id="inf483"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>, movement of <inline-formula><mml:math id="inf484"><mml:mi>X</mml:mi></mml:math></inline-formula>, proliferation <inline-formula><mml:math id="inf485"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf486"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>, differentiation of <inline-formula><mml:math id="inf487"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> to <inline-formula><mml:math id="inf488"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf489"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> pulling of <inline-formula><mml:math id="inf490"><mml:mi>M</mml:mi></mml:math></inline-formula> are always zero during this simulation.)</p></sec><sec id="s19" sec-type="appendix"><title>Simulating the <italic>nac</italic> mutant</title><p>The gene <italic>nacre</italic> (<italic>nac</italic>) encodes transcription factor Mitfa (<xref ref-type="bibr" rid="bib32">Lister et al., 1999</xref>). <italic>nac</italic> mutants lack melanocytes throughout embryonic and larval development (<xref ref-type="bibr" rid="bib32">Lister et al., 1999</xref>). To simulate this defect, we remove all melanocytes from the initial conditions, i.e, we set <inline-formula><mml:math id="inf491"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We also set the propensity of event 8, the differentiation of new <inline-formula><mml:math id="inf492"><mml:mi>M</mml:mi></mml:math></inline-formula>, to be 0 for all time <inline-formula><mml:math id="inf493"><mml:mi>t</mml:mi></mml:math></inline-formula>. Since this is the only way new <inline-formula><mml:math id="inf494"><mml:mi>M</mml:mi></mml:math></inline-formula> can be produced, <inline-formula><mml:math id="inf495"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all time <inline-formula><mml:math id="inf496"><mml:mi>t</mml:mi></mml:math></inline-formula>. (Note: As a result the propensities of events 1 and 14, that is, the movement of <inline-formula><mml:math id="inf497"><mml:mi>M</mml:mi></mml:math></inline-formula>, and death of <inline-formula><mml:math id="inf498"><mml:mi>M</mml:mi></mml:math></inline-formula> will also always be zero during this simulation.)</p></sec><sec id="s20" sec-type="appendix"><title>Simulating the double mutants: nac;pfe, shd;pfe, shd;nac</title><p>To simulate the double mutants we combine the effects of two of the three aforementioned mutation types. For example, to simulate <italic>nac;pfe</italic> we combine the effects of <italic>nac</italic> and <italic>pfe</italic> listed above.</p></sec><sec id="s21" sec-type="appendix"><title>Simulating the <italic>rse</italic> mutant</title><p><italic>Rose</italic> (<italic>rse</italic>), encodes the Endothelin receptor B1a (<xref ref-type="bibr" rid="bib31">Krauss et al., 2014</xref>) and has been shown to acts cell-autonomously in S-iridophores; homozygous mutants result in a reduction of S-iridophores to approximately 20% of that seen in WT (observed in stage PB and adult fish [<xref ref-type="bibr" rid="bib16">Frohnhöfer et al., 2013</xref>]). To simulate <italic>rse</italic> we change the initial conditions so that <inline-formula><mml:math id="inf499"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is one fifth of the usual number. In our WT simulations, <inline-formula><mml:math id="inf500"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="inf501"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="inf502"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> occupy the three central rows. In <italic>rse</italic> we set <inline-formula><mml:math id="inf503"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>=60, and we place these <inline-formula><mml:math id="inf504"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> uniformly at random within the space of the central three rows, since some S-iridophores still appear along the horizontal myoseptum in <italic>rse</italic>. We do this by generating a random number <inline-formula><mml:math id="inf505"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℤ</mml:mi></mml:mrow></mml:math></inline-formula> that is uniformly distributed between 24 and 26 (the centre of the horizontal axis is at 25), and a random number <inline-formula><mml:math id="inf506"><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> that is uniformly distributed between 0 and <inline-formula><mml:math id="inf507"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf508"><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is empty we place a <inline-formula><mml:math id="inf509"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> cell in this site, otherwise we generate a new position until there are 60 cells of type <inline-formula><mml:math id="inf510"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> on <inline-formula><mml:math id="inf511"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula>. Furthermore since new S-iridophores are only produced by proliferation of pre-existing S-iridophores, we also reduce the rate of proliferation of <inline-formula><mml:math id="inf512"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf513"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> to one fifth of the usual number. Therefore, we set the propensity of event 7, <inline-formula><mml:math id="inf514"><mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.24</mml:mn><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>60</mml:mn><mml:mo>×</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula> for all time <inline-formula><mml:math id="inf515"><mml:mi>t</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s22" sec-type="appendix"><title>Simulating the <italic>sbr</italic> mutant</title><p>Adult <italic>sbr</italic> mutants exhibit delayed S-iridophore shape transition changes of dense to loose caused by truncations in Tight Junction Protein 1a (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). To simulate <italic>sbr</italic>, we reduce the rate at which <inline-formula><mml:math id="inf516"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> attempts transition to <inline-formula><mml:math id="inf517"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> to a fortieth of its usual value. Hence the propensity of event 10 becomes <inline-formula><mml:math id="inf518"><mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>60</mml:mn><mml:mo>×</mml:mo><mml:mn>24</mml:mn><mml:mo>×</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. This reduction acts as a proxy for the delay between receiving a signal and changing shape to loose form.</p></sec><sec id="s23" sec-type="appendix"><title>Simulating the <italic>cho</italic> mutant</title><p>Mutant larvae with mutation <italic>cho</italic> lack the horizontal myoseptum (<xref ref-type="bibr" rid="bib54">Svetic et al., 2007</xref>). As a result, dense S-iridophores cannot travel through their usual pathway to generate the initial strip of dense S-iridophores at stage PB seen in WT. Instead loose S-iridophores appear later at stage PR, uniformly across the domain. To simulate the effects of <italic>cho</italic>, we remove the initial three rows of <inline-formula><mml:math id="inf519"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> so <inline-formula><mml:math id="inf520"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, as S-iridophores cannot appear along the horizontal myoseptum. Furthermore, we remove the fixed event of metamorphic xanthophores appearing along the horizontal myoseptum at stage SP. To simulate the appearance of loose S-iridophores at stage PR, we provide a new fixed event when the simulation reaches stage PR. At this point, we place 300 (the same number that usually initially occupies the domain in WT) loose S-iridophores in sites uniformly at random across <inline-formula><mml:math id="inf521"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> at stage PR. We do this by generating a random number <inline-formula><mml:math id="inf522"><mml:mi>r</mml:mi></mml:math></inline-formula> between 0 and <inline-formula><mml:math id="inf523"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and a random number <inline-formula><mml:math id="inf524"><mml:mi>k</mml:mi></mml:math></inline-formula> between 0 and <inline-formula><mml:math id="inf525"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf526"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the time when the simulation first enters stage PR. If <inline-formula><mml:math id="inf527"><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is empty we place a <inline-formula><mml:math id="inf528"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> cell in this site, otherwise we generate a new <inline-formula><mml:math id="inf529"><mml:mi>r</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf530"><mml:mi>k</mml:mi></mml:math></inline-formula> and continue until there are 200 cells of type <inline-formula><mml:math id="inf531"><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup></mml:math></inline-formula> on <inline-formula><mml:math id="inf532"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s24" sec-type="appendix"><title>Simulating the <italic>seurat</italic> mutant</title><p>Homozygous <italic>seurat</italic> mutants develop fewer adult melanocytes, thus forming irregular spots rather than stripes. This phenotype arises from lesions in the gene encoding Immunoglobulin superfamily member 11 (Igsf11) (<xref ref-type="bibr" rid="bib12">Eom et al., 2012</xref>) which encodes a cell surface receptor containing two immunoglobulin-like domains which is expressed autonomously by the melanocyte lineage. Igsfl1 promotes the migration and survival of these cells during adult stripe development as well as mediating adhesive interactions in vitro.</p><p>To model <italic>seurat</italic> we reduced the rate at which melanocytes could differentiate to a twentieth of the usual rate. Hence the propensity of event eight becomes <inline-formula><mml:math id="inf533"><mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>60</mml:mn><mml:mo>×</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>. This was to reflect the inhibition of migration of melanoblasts across the domain and increased the rate of attempted melanocyte death to one hundred times per day (usually once per day). Hence the propensity of event 12 becomes <inline-formula><mml:math id="inf534"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>60</mml:mn><mml:mo>×</mml:mo><mml:mn>24</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. No other interactions were altered.</p></sec><sec id="s25" sec-type="appendix"><title>Simulating the <italic>leo</italic> mutant</title><p>The gene <italic>leo</italic> encodes Connexin39.4 (Cx39.4). The <italic>leo</italic> mutant displays a spotted pattern across the flank of the fish. In Section &quot;An <italic>in silico</italic> investigation into the function of the <italic>leo</italic> gene&quot; of the main text we describe how we derive the following hypotheses about the impacts of a mutation in the <italic>leo</italic> gene;</p><list list-type="bullet"><list-item><p>Hypothesis 1: Melanocytes are not repelled by xanthophores</p></list-item><list-item><p>Hypothesis 2: Xanthophores do not promote the survival of melanocytes in the long range.</p></list-item><list-item><p>Hypothesis 3: Xanthophores do not promote the change of S-iridophores from dense to loose in the long range.</p></list-item><list-item><p>Hypothesis 4: Melanocytes lose death signals from local dense S-iridophores and as a result, can differentiate in dense S-iridophore zones.</p></list-item><list-item><p>Hypothesis 5: Melanocytes lose directed signalling from S-iridophores and hence in the absense of xanthophores differentiate randomly.</p></list-item></list><p>To model hypothesis 1, we change the parameter <inline-formula><mml:math id="inf535"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the parameter governing repulsion of melanocytes from xanthophores to 0. To incorporate hypothesis two we remove the criteria for successful melanocyte death given in <xref ref-type="disp-formula" rid="equ53">Equation 50</xref> in Appendix 1. To model hypothesis 3, we reduce the rate of successful signalling of xanthophores to iridophores to change to loose form. To do this, if a S-iridophore transition is chosen to occur then a number distributed uniformly at random is generated. If this number is less than 0.5, then normal transition signalling occurs (as described in Appendix 1). If the number is greater than 0.5 then the xanthophores send a signal for S-iridophores to transition to dense, that is, the number <inline-formula><mml:math id="inf536"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is changed to five and the number <inline-formula><mml:math id="inf537"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is changed to 2. To model hypotheses 4 and 5, we change the melanocyte differentiation success as follows. A melanocyte successfully differentiates into a position on the lattice, if there are no xanthophores on the domain, or if there are xanthophores on the domain and there are three times as many xanthophores in the long range than the number of melanocytes in the long-range.</p></sec></boxed-text></app><app id="appendix-3"><title>Appendix 3</title><boxed-text><sec id="s26" sec-type="appendix"><title>Quantitative measures</title><p>In this text, we describe in more detail how we take quantitative measurements of our simulations.</p></sec><sec id="s27" sec-type="appendix"><title>Tortuosity</title><p>To determine the tortuosity of the X0 stripe, for a specific time point in our simulations the following steps are taken.</p><list list-type="bullet"><list-item><p>An occupancy matrix <inline-formula><mml:math id="inf538"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> of zeros and ones is generated such that a matrix entry <inline-formula><mml:math id="inf539"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf540"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> and 0 otherwise. Sites <inline-formula><mml:math id="inf541"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="inf542"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are yellow and are white otherwise.</p></list-item><list-item><p>Representative matrix <inline-formula><mml:math id="inf543"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is ‘cleaned’ using matlab functions bwmorph(<inline-formula><mml:math id="inf544"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>,‘clean’) and bwmorph(<inline-formula><mml:math id="inf545"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>,‘bridge’) consecutively. ‘Clean’ removes any anomalous xanthophores that are not connected (adjacent to) other xanthophores. ‘Bridge’ adds extra xanthophores where there are holes in the population pattern.</p></list-item><list-item><p>An algorithm is applied to <inline-formula><mml:math id="inf546"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> to create the outline of the X0 stripe. The algorithm to create the top line (<inline-formula><mml:math id="inf547"><mml:msub><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>) is given below in Algorithm 1. A similar algorithm is used to generate the bottom line (<inline-formula><mml:math id="inf548"><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula>).</p></list-item><list-item><p>A line <inline-formula><mml:math id="inf549"><mml:mi>L</mml:mi></mml:math></inline-formula> that represents the middle of the stripe is given by <inline-formula><mml:math id="inf550"><mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf551"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>We smooth <inline-formula><mml:math id="inf552"><mml:mi>L</mml:mi></mml:math></inline-formula> for analysis by applying matlab function smooth. ‘Smooth’ smooths the data in the column vector <inline-formula><mml:math id="inf553"><mml:mi>y</mml:mi></mml:math></inline-formula> using a moving average filter.</p></list-item><list-item><p>Finally, we calculate the tortuosity of the line by computing the total length of <inline-formula><mml:math id="inf554"><mml:mi>L</mml:mi></mml:math></inline-formula> divided by the distance (algorithm given below in Algorithm 2).</p></list-item></list><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Algorithm 1. Algorithm to generate a representative line for the top of stripe X0 (<inline-formula><mml:math id="inf555"><mml:msub><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>)</th></tr></thead><tbody><tr valign="top"><td rowspan="19"><break/><inline-formula><mml:math id="inf556"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mfrac><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>  <inline-formula><mml:math id="inf557"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>    <italic>Strike</italic> = 0 <break/>      if <inline-formula><mml:math id="inf558"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or (<inline-formula><mml:math id="inf559"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf560"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) then <break/>       <bold>while</bold> <inline-formula><mml:math id="inf561"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf562"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> do <break/>       <inline-formula><mml:math id="inf563"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> <break/>        <bold>if</bold> <inline-formula><mml:math id="inf564"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> then <break/>       <inline-formula><mml:math id="inf565"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mo>▷</mml:mo></mml:math></inline-formula> <break/>        <bold>else</bold> <break/>       <inline-formula><mml:math id="inf566"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> <break/>       <bold>end if</bold> <break/>       <bold>end while</bold> <break/>      <inline-formula><mml:math id="inf567"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>▷</mml:mo></mml:math></inline-formula> <break/>     <bold>else</bold> <break/>    <bold>while</bold><inline-formula><mml:math id="inf568"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf569"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> do <break/>   <inline-formula><mml:math id="inf570"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> <break/>  <bold>end while</bold> <break/>  <bold>end if </bold> <break/>  <inline-formula><mml:math id="inf571"><mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> <break/> <bold>end</bold></td><td align="right" rowspan="19"><break/>▷<italic>Initialise X0 interstripe search in the center.</italic> <break/><break/>▷<italic>Initialise the number of consecutive empty sites in a column to be zero.</italic> <break/><break/>▷<italic>If we are near to other X, keep moving up to determine the upper bound of the interstripe.</italic> <break/><break/>▷<italic>Increment the number of consecutive empty sites in a column by one.</italic> <break/><italic><break/><break/><break/>Remove the two consecutively empty sites from the total count.</italic> <break/><break/>▷<italic>If we have overshot the interstripe keep moving downwards until we reach the top of the interstripe.</italic></td></tr></tbody></table></table-wrap><table-wrap id="inlinetable2" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Algorithm 2. Algorithm to calculate the tortuosity (<inline-formula><mml:math id="inf572"><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>) of line <inline-formula><mml:math id="inf573"><mml:mi>L</mml:mi></mml:math></inline-formula> generated from a simulated X0</th></tr></thead><tbody><tr valign="top"><td rowspan="5"><italic>total</italic> = 0 <break/><inline-formula><mml:math id="inf574"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>    <inline-formula><mml:math id="inf575"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/><bold>end</bold> <break/><inline-formula><mml:math id="inf576"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td align="right" rowspan="5"><break/><break/><break/>▷<italic>Compute the length of</italic> <inline-formula><mml:math id="inf577"><mml:mi>L</mml:mi></mml:math></inline-formula><italic>using the euclidean distance between consecutive points.</italic></td></tr></tbody></table></table-wrap><p>To measure the tortuosity of the stripes of real fish, a photograph was taken of the fish at stage J+. Next, matlab function ‘getpts’ was used to mark the outline of the X0 stripe by a set of points <inline-formula><mml:math id="inf578"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:munder accentunder="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mo>,</mml:mo><mml:munder accentunder="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:munder><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> where vector <inline-formula><mml:math id="inf579"><mml:munder accentunder="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:munder></mml:math></inline-formula> is length <inline-formula><mml:math id="inf580"><mml:mi>k</mml:mi></mml:math></inline-formula>. The tortuosity of this line was then computed using Algorithm 3.</p><table-wrap id="inlinetable3" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th colspan="2">Algorithm 3. Algorithm to calculate the tortuosity (<inline-formula><mml:math id="inf581"><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>) of line <inline-formula><mml:math id="inf582"><mml:mi>L</mml:mi></mml:math></inline-formula> generated from a real fish</th></tr></thead><tbody><tr valign="top"><td rowspan="5"><italic>total</italic> = 0 <break/><inline-formula><mml:math id="inf583"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mtext> </mml:mtext><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>    <inline-formula><mml:math id="inf584"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/><bold>end</bold> <break/><inline-formula><mml:math id="inf585"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula><break/></td><td align="right" rowspan="5"><break/><break/><break/>▷<italic>Compute the length of</italic> <inline-formula><mml:math id="inf586"><mml:mi>L</mml:mi></mml:math></inline-formula><italic>using the euclidean distance between consecutive points.</italic></td></tr></tbody></table></table-wrap></sec><sec id="s28" sec-type="appendix"><title>X0 interstripe width</title><p>To determine the width of the X0 interstripe, used in Section &quot;Quantitative analysis of simulations&quot; of the main text, first, occupancy matrices of <inline-formula><mml:math id="inf587"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf588"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> of zeros and ones is generated such that a matrix entry <inline-formula><mml:math id="inf589"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf590"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> and 0 otherwise. Similarly <inline-formula><mml:math id="inf591"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf592"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and 0 otherwise. We then generate <inline-formula><mml:math id="inf593"><mml:msup><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf594"><mml:msup><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula> using either <inline-formula><mml:math id="inf595"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> or <inline-formula><mml:math id="inf596"><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> as described in Section &quot;Necessity of S-iridophore assumptions&quot;. From these values, we generate <inline-formula><mml:math id="inf597"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> (X0 interstripe width) by computing;<disp-formula id="equ58"><label>(61)</label><mml:math id="m58"><mml:mrow><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:munderover></mml:mstyle><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mfrac></mml:mstyle></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Note that the X0 interstripe width is computed using whichever is more appropriate of <inline-formula><mml:math id="inf598"><mml:mi>X</mml:mi></mml:math></inline-formula> on <inline-formula><mml:math id="inf599"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf600"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> on <inline-formula><mml:math id="inf601"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> given the mutation. For example, <italic>pfe</italic> does not have xanthophores, so we would use the distribution of <inline-formula><mml:math id="inf602"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula> on <inline-formula><mml:math id="inf603"><mml:mi mathvariant="bold-italic">𝑰</mml:mi></mml:math></inline-formula> to determine the width of X0 in this case.</p></sec><sec id="s29" sec-type="appendix"><title>Adapting the pair correlation function (PCF)</title><p>PCFs characterise spatial patterns by calculating a numerical value for the deviation from the situation in which the same number of agents are distributed uniformly at random. In this paper, we use the square uniform PCF (<xref ref-type="bibr" rid="bib17">Gavagnin et al., 2018</xref>) developed for on-lattice systems of agents where distance is measured using the uniform norm. This PCF was originally developed for determining pair correlation between single agents types on a lattice, however, in a technique similar to <xref ref-type="bibr" rid="bib10">Dini et al., 2018</xref> we adapt it here so that it can also be used for identifying correlation between two different types of agents (cell types). First we define the PCF. For each distance <inline-formula><mml:math id="inf604"><mml:mi>m</mml:mi></mml:math></inline-formula> the PCF at distance <inline-formula><mml:math id="inf605"><mml:mi>m</mml:mi></mml:math></inline-formula> is given by:<disp-formula id="equ59"><label>(62)</label><mml:math id="m59"><mml:mrow><mml:mrow><mml:mtext>PCF</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>𝔼</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf606"><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined as the number of cells of type <inline-formula><mml:math id="inf607"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> we would expect to find at distance <inline-formula><mml:math id="inf608"><mml:mi>m</mml:mi></mml:math></inline-formula> from cells of type <inline-formula><mml:math id="inf609"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> using the uniform metric under zero flux boundary conditions. <inline-formula><mml:math id="inf610"><mml:mrow><mml:mi>𝔼</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if the cells were positioned uniformly at random on the domain. This can be calculated by counting the number of agents of this distance manually from the lattice. To compare cell type <inline-formula><mml:math id="inf611"><mml:mi>M</mml:mi></mml:math></inline-formula> with cells that lie on domains other than <inline-formula><mml:math id="inf612"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula> we must transform <inline-formula><mml:math id="inf613"><mml:mi mathvariant="bold-italic">𝑴</mml:mi></mml:math></inline-formula> into a matrix <inline-formula><mml:math id="inf614"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> of size <inline-formula><mml:math id="inf615"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf616"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf617"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> and 0 otherwise. Hence the set of site positions distance <inline-formula><mml:math id="inf618"><mml:mi>m</mml:mi></mml:math></inline-formula> from each other on any domain <inline-formula><mml:math id="inf619"><mml:mrow><mml:mi>D</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> under zero flux boundary conditions can be given by<disp-formula id="equ60"><label>(63)</label><mml:math id="m60"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Therefore<disp-formula id="equ61"><label>(64)</label><mml:math id="m61"><mml:mrow><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow> <mml:mtext>where </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo> <mml:mtext>and </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mn>𝟙</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo> <mml:mtext>and </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo> <mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf620"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> lies on <inline-formula><mml:math id="inf621"><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf622"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> lies on <inline-formula><mml:math id="inf623"><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf624"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑴</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">𝑰</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf625"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> is the number of site pairs distance <inline-formula><mml:math id="inf626"><mml:mi>m</mml:mi></mml:math></inline-formula> from one another. <inline-formula><mml:math id="inf627"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> is computed in <xref ref-type="bibr" rid="bib17">Gavagnin et al., 2018</xref> and is given by<disp-formula id="equ62"><label>(65)</label><mml:math id="m62"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>To determine <inline-formula><mml:math id="inf628"><mml:mrow><mml:mi>𝔼</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> there are three cases.</p><p>Case 1: <inline-formula><mml:math id="inf629"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">1</mml:mn></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:mi>C</mml:mi><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">{</mml:mo><mml:mi>M</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>X</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo mathvariant="normal" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> lies on domain <inline-formula><mml:math id="inf630"><mml:mrow><mml:mi>D</mml:mi><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">{</mml:mo><mml:mi>M</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>X</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>I</mml:mi><mml:mo mathvariant="normal" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (with volume exclusion on <inline-formula><mml:math id="inf631"><mml:mi>D</mml:mi></mml:math></inline-formula>). For example spatial correlation of <inline-formula><mml:math id="inf632"><mml:mi>M</mml:mi></mml:math></inline-formula> with respect to other <inline-formula><mml:math id="inf633"><mml:mi>M</mml:mi></mml:math></inline-formula>. This is the case discussed in <xref ref-type="bibr" rid="bib17">Gavagnin et al., 2018</xref>. In this case<disp-formula id="equ63"><label>(66)</label><mml:math id="m63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>c</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ64"><label>(67)</label><mml:math id="m64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This is because there are <inline-formula><mml:math id="inf634"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> ways to choose a cell of type <inline-formula><mml:math id="inf635"><mml:mi>C</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf636"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> ways to choose a cell of type <inline-formula><mml:math id="inf637"><mml:mi>C</mml:mi></mml:math></inline-formula> given one has been chosen already. There are <inline-formula><mml:math id="inf638"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> possible positions for the first cell and then <inline-formula><mml:math id="inf639"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> possible positions for the second cell due to volume exclusion on domain <inline-formula><mml:math id="inf640"><mml:mi>D</mml:mi></mml:math></inline-formula>.</p><p>Case 2: <inline-formula><mml:math id="inf641"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">1</mml:mn></mml:msub><mml:mo mathvariant="normal">≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf642"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">1</mml:mn></mml:msub><mml:mo mathvariant="normal">,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msub></mml:mrow><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo mathvariant="normal" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> both lie on domain <inline-formula><mml:math id="inf643"><mml:mrow><mml:mi>D</mml:mi><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">{</mml:mo><mml:mi>X</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>I</mml:mi><mml:mo mathvariant="normal" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (with volume exclusion on <inline-formula><mml:math id="inf644"><mml:mi>D</mml:mi></mml:math></inline-formula>). For example spatial correlation of <inline-formula><mml:math id="inf645"><mml:mi>X</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf646"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>. In this case<disp-formula id="equ65"><label>(68)</label><mml:math id="m65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>c</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Notice, <inline-formula><mml:math id="inf647"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> is multiplied by two here because for each pair <inline-formula><mml:math id="inf648"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> there are two positions <inline-formula><mml:math id="inf649"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf650"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> can take and be distance <inline-formula><mml:math id="inf651"><mml:mi>m</mml:mi></mml:math></inline-formula> away from each other. Specifically these are the cases <inline-formula><mml:math id="inf652"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf653"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf654"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf655"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. We can compute<disp-formula id="equ66"><label>(69)</label><mml:math id="m66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">N</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This is because there are <inline-formula><mml:math id="inf656"><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> ways to choose a cell of type <inline-formula><mml:math id="inf657"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf658"><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> ways to choose a cell of type <inline-formula><mml:math id="inf659"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>. There are <inline-formula><mml:math id="inf660"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> possible positions for the first cell and then <inline-formula><mml:math id="inf661"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> possible positions for the second cell due to volume exclusion on domain <inline-formula><mml:math id="inf662"><mml:mi>D</mml:mi></mml:math></inline-formula>.</p><p>Case 3: <inline-formula><mml:math id="inf663"><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf664"><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msub></mml:math></inline-formula> where <inline-formula><mml:math id="inf665"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">1</mml:mn></mml:msub><mml:mo mathvariant="normal">,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msub></mml:mrow><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">{</mml:mo><mml:mi>M</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>X</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>l</mml:mi></mml:msup><mml:mo mathvariant="normal">,</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo mathvariant="normal" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> lie on domains <inline-formula><mml:math id="inf666"><mml:msub><mml:mi>D</mml:mi><mml:mn mathvariant="normal">1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf667"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msub><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">{</mml:mo><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo mathvariant="normal" stretchy="false">^</mml:mo></mml:mover><mml:mo mathvariant="normal">,</mml:mo><mml:mi>X</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>I</mml:mi><mml:mo mathvariant="normal" stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf668"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn mathvariant="normal">1</mml:mn></mml:msub><mml:mo mathvariant="normal">≠</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, for example the spatial correlation of <inline-formula><mml:math id="inf669"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf670"><mml:msup><mml:mi>I</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></inline-formula>. In this case<disp-formula id="equ67"><label>(70)</label><mml:math id="m67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>c</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ68"><label>(71)</label><mml:math id="m68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This is because there are <inline-formula><mml:math id="inf671"><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> ways to choose a cell of type <inline-formula><mml:math id="inf672"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf673"><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup></mml:math></inline-formula> ways to choose a cell of type <inline-formula><mml:math id="inf674"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>. There are <inline-formula><mml:math id="inf675"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> possible positions for the first cell of type <inline-formula><mml:math id="inf676"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf677"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> possible positions for the second cell of type <inline-formula><mml:math id="inf678"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> since they lie on different domains (no volume exclusion). A summary of all these cases can be given as follows;</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf679"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> lies on domain <inline-formula><mml:math id="inf680"><mml:mi>D</mml:mi></mml:math></inline-formula> (with volume exclusion on <inline-formula><mml:math id="inf681"><mml:mi>D</mml:mi></mml:math></inline-formula>). For example, spatial correlation of <inline-formula><mml:math id="inf682"><mml:mi>M</mml:mi></mml:math></inline-formula> with respect to other <inline-formula><mml:math id="inf683"><mml:mi>M</mml:mi></mml:math></inline-formula>.</p></list-item></list><p><disp-formula id="equ69"><label>(72)</label><mml:math id="m69"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf684"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf685"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> lie on domain <inline-formula><mml:math id="inf686"><mml:mi>D</mml:mi></mml:math></inline-formula> (with volume exclusion on <inline-formula><mml:math id="inf687"><mml:mi>D</mml:mi></mml:math></inline-formula>). For example spatial correlation of <inline-formula><mml:math id="inf688"><mml:mi>X</mml:mi></mml:math></inline-formula> with respect to <inline-formula><mml:math id="inf689"><mml:msup><mml:mi>X</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:math></inline-formula>.</p></list-item></list><p><disp-formula id="equ70"><label>(73)</label><mml:math id="m70"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf690"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf691"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> lie on domains <inline-formula><mml:math id="inf692"><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf693"><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> where <inline-formula><mml:math id="inf694"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> for example spatial correlation of <inline-formula><mml:math id="inf695"><mml:mi>X</mml:mi></mml:math></inline-formula> with respect to <inline-formula><mml:math id="inf696"><mml:mi>M</mml:mi></mml:math></inline-formula>.</p></list-item></list><p><disp-formula id="equ71"><label>(74)</label><mml:math id="m71"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>H</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Π</mml:mi><mml:mi mathvariant="bold-italic">𝑿</mml:mi><mml:mi>L</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p></sec></boxed-text></app><app id="appendix-4"><title>Appendix 4</title><boxed-text><sec id="s30" sec-type="appendix"><title>Testing robustness</title><p>Due to the abundance of parameters and cell–cell interactions necessary to capture what is known biologically about zebrafish pigment pattern formation, it is not feasible to perform an exhaustive parameter sweep to demonstrate the robustness of the model. Instead, as a test of robustness, we perform a rigorous robustness analysis by carrying out one hundred repeats of all WT and mutant simulations with perturbed parameter values chosen uniformly at random from the range 0.75–1.25 of their described value. The value of each parameter is sampled uniformly from this region, independentally for each parameter and each repeat. Ten of these randomly sampled repeats for <italic>shd, nac, pfe</italic> and <italic>leo</italic> are given in <xref ref-type="fig" rid="app4fig1">Appendix 4—figure 1</xref>. We observe, for all one hundred repeats, that small perturbations to the rates still generate consistent patterning, demonstrating the robustness of the model.</p><fig id="app4fig1" position="float"><label>Appendix 4—figure 1.</label><caption><title>Example <italic>shd, nac, pfe</italic> and <italic>leo</italic> simulations at stage J+ when the parameters governing the rate of proliferation, movement, differentiation and death are perturbed.</title><p>Each rectangle is an example simulation at stage J+ for which each rate parameter is perturbed to 1+<inline-formula><mml:math id="inf697"><mml:mi>x</mml:mi></mml:math></inline-formula> times its normal value. The value <inline-formula><mml:math id="inf698"><mml:mi>x</mml:mi></mml:math></inline-formula> is chosen uniformly at random from the interval <inline-formula><mml:math id="inf699"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.25</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>0.25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-app4-fig1-v1.tif"/></fig></sec></boxed-text></app><app id="appendix-5"><title>Appendix 5</title><boxed-text><sec id="s31" sec-type="appendix"><title>Predicting pattern formation for an <italic>seurat</italic>/<italic>sbr</italic>cross</title><p>In this section, we give an example of how the model can be manipulated to investigate aspects of pattern development and to predict the outcome of mutant pigment patterns.</p><p>To the best of our knowledge, the adult pattern of crossed <italic>seurat</italic> and <italic>sbr</italic> mutants have not have been published previously. By changing the parameters so that we match both <italic>sbr</italic> and <italic>seurat</italic> we can predict pattern formation for a double mutant <italic>seurat/sbr</italic>. As previously stated (in more detail) in Appendix 2, the mutation in <italic>seurat</italic> affects melanocyte differentiation (<xref ref-type="bibr" rid="bib12">Eom et al., 2012</xref>) and the mutation in <italic>sbr</italic> affects the dense-to-loose S-iridophore transition (<xref ref-type="bibr" rid="bib15">Fadeev et al., 2015</xref>). To simulate the cross, we simply incorporate the effects of both mutations simultaneously. The results at stage J+ is given in <xref ref-type="fig" rid="app5fig1">Appendix 5—figure 1</xref>. Our model predicts that when both of these mutations occur, dense S-iridophores and associated xanthophores would cover most of the flank of the fish. A few melanocytes associated with loose S-iridophores survive at the very dorsal and ventral regions of the fish.</p><fig id="app5fig1" position="float"><label>Appendix 5—figure 1.</label><caption><title>Prediction for the pattern of a <italic>seurat/sbr</italic> cross at stage J+.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52998-app5-fig1-v1.tif"/></fig></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.52998.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Krishna</surname><given-names>Sandeep</given-names></name><role>Reviewing Editor</role><aff><institution>National Centre for Biological Sciences‐Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Nair</surname><given-names>Sreelaja</given-names> </name><role>Reviewer</role><aff><institution>Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Ladher</surname><given-names>Raj K</given-names></name><role>Reviewer</role><aff><institution>NCBS</institution><country>India</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This paper constructs and analyses a detailed computational model of zebrafish pigment stripe formation. It highlights the role of iridophores in organizing the melanophores and xanthophores, a facet that has largely been unaccounted for in computational modeling of zebrafish stripe patterns. Of particular interest is the analysis of the <italic>schachbrett</italic> mutant, which points to the role of tight junctions in the transition of S-iridophore packing.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;A quantitative model for zebrafish pattern formation&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Sreelaja Nair (Reviewer #1); Raj K Ladher (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>The manuscript describes a computational model that attempts to capture the complexities of xanthophore and iridophore interactions to explain zebrafish pigment stripe pattern formation. While the reviewers appreciate that the model is sufficient to reproduce known stripe patterns, it has not been demonstrated that the interactions included are necessary, and all reviewers were of the opinion that the model has not been used to make sufficiently interesting predictions. In order for a revision to be publishable, it must distinguish the work sufficiently from the work of Volkening and Sandstede by including several more predictions (see points 1,2,3 of reviewer 1, and point 3 of reviewer 3). In addition, as pointed out by reviewer 2, it is essential that the existing and added predictions be shown to be robust to changing parameter values within biologically reasonable ranges – tuning parameters one by one, keeping all others fixed, only between low and high values, is not a sufficient exploration of the parameter space to prove such robustness. A more comprehensive exploration of parameter space is also essential to satisfy reviewer 2 that the interactions included in the model are indeed necessary as claimed in the manuscript, and that despite the very large number of parameters the behaviour of the model is constrained enough to make robust predictions. The manuscript should also tone down claims of the novelty of the methods and the superiority of this approach compared to reaction-diffusion approaches – in particular, as reviewer 2 points out, stochasticity is easily included in reaction-diffusion approaches so that cannot count as a reason to favour a lattice-based model.</p><p><italic>Reviewer #1:</italic></p><p>In the manuscript entitled &quot;A quantitative modeling approach to zebrafish pigment pattern formation&quot;, Owen et al. describe in silico modeling strategies to explain zebrafish pigment stripe formation. The authors use on-lattice modeling, in which five pigment cell types that are necessary to form the adult zebrafish pigment stripe pattern are treated as fixed to a mutually exclusive space within the domain in which the pattern will emerge. Onto this basic framework, the authors model known behaviors of the pigment cell types and intercellular interactions to simulate emergence of stripe pattern. Their modeling approach incorporates the role of iridophores in organizing the melanophores and xanthophores, a facet that has largely been unaccounted for in computational modeling of zebrafish pigment stripe pattern formation. The authors validate their model by recapitulating the wild type stripe pattern and test the model by simulating stripe pattern formation in the absence of one or more of the cell types/interactions. These additional simulations very nicely recreate stripe patterns observed in known zebrafish mutants. Overall the study is well carried out and the authors comprehensively validate their modeling strategy, making a strong case for on-lattice agent based modeling rather than a Reaction Diffusion modeling for pigment stripe pattern in zebrafish.</p><p>It is not surprising that the model recapitulates known pigment patterns, since the model was built based on biological evidences. On the basis of this the authors state that the current experimental evidences together with their model’s assumptions of S-iridophore behavior is sufficient to explain pigment pattern formation. For a set of biological interactions to be termed as sufficient for formation of a pattern, the model could perhaps be challenged by stating predictions that are currently not easy to test experimentally.</p><p>1) For example: As the authors point out, zebrafish do not incorporate additional pigment stripes as they grow. The biological basis for this is not known. In their wild type simulation starting at stage PB, how would a pattern evolve if initially the melanophores were in 3 or 5 stripes instead of the normal 4 stripes?</p><p>2) At the start of the simulations at stage PB, the dense iridophores appear along the horizontal myoseptum. Is this spatial location of iridophores relevant to formation of the pattern? Would the pattern that emerges be different if the original metamorphic pattern of dense iridophores at the horizontal myoseptum was displaced dorsally or ventrally?</p><p>3) The authors very nicely factor in the layered arrangement of the different cell types along the z-axis, to mirror the biological scenario. It is experimentally tough to switch the order of the layers, but should be possible to do in the simulations? This would be interesting because developmentally the three pigment cell types take distinct dorsal or ventral migratory routes along the horizontal myoseptum to reach their eventual z-layer. The route of migration has been thought to be critical in determining the fate of the pigment cell type (or of the stem cells that resides in the adult) and in establishing the stripe pattern. Could this assumption be partially tested to determine the relevance of the spatial order of the layers in eventual stripe formation?</p><p>Overall, I enjoyed the manuscript and the insights mathematical modeling can provide to understand complex phenomena such as pattern formation. My comments stem from limitations that mutants etc pose for understanding what information is sufficient to generate a pattern. The model is based on a finite set of proven interactions, several untested permutations and combinations of these and additional novel interactions are always possible. A major advantage of mathematical modeling is in the predictive zone, some of which experimentalists may find hard/impossible to venture into. The current study falls short of taking that leap, which would have been an interesting and informative exercise.</p><p><italic>Reviewer #2:</italic></p><p>This manuscript reports the study of pigment patterns in zebrafish embryos claiming a novel bottom-up stochastic model. My understanding is that this is an extensively employed standard approach using the chemical master equation for interacting (and diffusing) species to simulate emergent stochastic patterns. The authors incorporate many detailed and complex interactions between five different cell types and claim that all the interactions are essential to explain the observed patterns. My feeling is that such a study with a large number of control parameters is overkill and does not enhance our understanding of stripe patterns. As such, I do not recommend publishing this study in <italic>eLife</italic>.</p><p>1) In this manuscript, the authors present a quantitative model for simulating the stripe patterns seen in wt and mutant embryos of zebrafish. They develop a stochastic description based on the purported interactions between xanthophores, xanthoblasts, melanocytes and (two kinds of) iridophores while also incorporating motility that is biased by short- and long-ranged interactions between the cell types. These are augmented by cell division, death, differentiation and tissue growth. The resulting detailed numerical simulations are shown to qualitatively reproduce pigment patterns in wt and mutant conditions. Further, the authors quantitatively compare cell density, straightness of stripes and interstripe widths with experimental results. Several other results, such as the pair-correlation-function of cell densities, provide further justifications to the model developed.</p><p>2) The main point of this study seems to be the development of a bottom-up stochastic model incorporating as many complex and varied interactions between the cells to simulate pigment patterns. The authors contrast their approach with reaction-diffusion modelling approaches (such as Turing patterns) by saying that such approaches lack the stochasticity observed inherently in pigment patterns.</p><p>I would disagree with this viewpoint. The point of reaction-diffusion approaches is minimalistic coarse-grained descriptions of the complex effective interactions between cells (or any other constituents of the patterns) that can capture the essence of the emergent patterns. It is easy to incorporate stochasticity even in approaches that use partial-differential equations.</p><p>A complementary approach is to simulate the underlying master equation that governs the chemical interactions, supplemented by a compartment-based approach to diffusion. There are several such studies done in the past using the standard Gillespie algorithm for simulating the chemical master equation. Such studies incorporate the essential chemistry (e.g., activator-inhibitor dynamics) and coupled with diffusion can lead to emergent stripe patterns with inherent stochasticity built-in.</p><p>3) The authors, instead, develop a detailed lattice-based model with sufficiently complex interactions between 5 species of cells along with short-ranged local interactions and long-ranged non-local interactions. These interactions bias the hopping rates of the cells along the lattice. The authors speculate on the possible physical origins of these interactions. However, it is not clear if there aren't other possible interactions that could also lead to the same emergent dynamics. And hence the questions arises as to what are the essential features required at this level of modeling and what details are incidental. It should be noted that even though the authors claim that their approach is bottom-up, they are not modelling interactions between molecules. Rather, the interactions incorporated in their modeling are also effective cell-level interactions. In essence, this study has considered a master-equation like approach to simulate zebrafish stripe patterns.</p><p>4) The authors claim that all the interactions included in their model are essential for stripe patterns. This is demonstrated by turning off each interaction in-turn and showing that some feature of the pattern is lost. This is an 'all or none' switch. For the set of other parameters chosen, this might indeed lead to the conclusion that all interactions are absolutely needed. One could vary the interaction strengths in a continuous manner and then it is not clear if all the said interactions are absolutely needed for all parameter values.</p><p>5) Looking at the appendix and the supplementary material, I feel that the model is sufficiently complicated, and has so many turning parameters, that any range of behaviors is possible. It is not unreasonable to see that the large-scale emergent dynamics of such a complex model is essentially that of Turing systems which could have been simulated with much less complexity.</p><p>For the above reasons, I cannot recommend publishing in <italic>eLife</italic>.</p><p><italic>Reviewer #3:</italic></p><p>Owen et al. describe the formulation of a model to understand the formation of stripes in zebrafish. They revisit the Turing model that previous studies have described and refine the interaction parameters that were simplified in those models. The model presented recapitulates many of the patterns found in WT and in mutants, and models the formation of these stripes.</p><p>The study does capture the complexities of xanthophore and iridophore interactions well. Furthermore, the ability to place weights on the strength of interactions also gives the model flexibility.</p><p>The paper is well-written. However, I would like to make some suggestions, listed below.</p><p>1) The assumptions and the way the model works could be made more explicit. For this I would suggest that the authors consider incorporating Figure 1, 2 and 3 from Appendix 1 into the main manuscript.</p><p>2) I would suggest that the authors emphasise the differences of their model from the Volkening paper published in Aug 2018. I do take issue with the authors characterisation of this paper as very recent, and would suggest that they make greater reference to it in the Introduction.</p><p>3) One very interesting piece of data from this study, and the one that does differentiates this study from that of Volkening and Sandstede, is the analysis of the <italic>schachbrett</italic> mutant. This mutant points to the role of tight junctions in the transition of S-iridophore packing. It would be worth extending this analysis to the compunctiond <italic>sbr</italic>/<italic>leo</italic> and <italic>sbr</italic>/luc mutants described in Fadeev et al. Additionally, there is a suggestion of an interaction between <italic>sbr</italic> and <italic>seurat</italic> – I wonder if the model were able to predict what a double <italic>sbr/seurat</italic> would look like?</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for re-submitting your article &quot;A quantitative model for zebrafish pattern formation&quot; for consideration by <italic>eLife</italic>. Your article has been re-reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Sreelaja Nair (Reviewer #1); Raj K Ladher (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>1) In the revised manuscript, you write:</p><p>&quot;The most commonly used mathematical paradigm for stripe formation takes the form of a Turing reaction diffusion model. In these representations, melanocytes and xanthophores diffuse and interact via a few long and short range 'reactions'. This class of model typically rely on a small number of parameters which, upon being altered, can generate a diverse range of patterns. Simplified models such as these have the benefit that they are often analytically tractable, allowing a deep understanding of the model. However, their main limitation is that, due to the simplicity of the approach, there is often no consistent way to link the parameters with measurable data, making it difficult to relate the model results back to the biology.&quot;</p><p>This gives the impression that (i) Turing pattern models are always simplified, and analytically tractable, and (ii) Turing models face a difficulty in relating their parameters to measurable data. Both are untenable statements and should be removed – there are several examples of both highly nonlinear Turing-type or reaction-diffusion models for pattern formation that are neither simple nor analytically tractable, and in several cases now people have shown how to relate their parameters to measurable data.</p><p>2) The authors write:</p><p>&quot;Turing reaction-diffusion type models posit that combinations of short and long range dynamics between melanocytes and xanthophores generate stripe patterns. Indeed, much of the excitement around such models is the ease with which small parameter value changes result in diverse patterns, many readily recognisable from nature. […] A major difference between our model and Turing reaction diffusion models is that small parameter changes in our model do not typically generate qualitatively different patterns, whereas Turing reaction diffusion models can show substantial pattern changes in response to small changes (Budi, Patterson and Parichy, 2011; Yamaguchi, Yoshimoto and Kondo, 2007).&quot;</p><p>This gives the impression that large changes in behaviour due to small changes in parameters is a generic feature of Turing models, as opposed to the model in this manuscript. This is not true, and the statements implying this should be removed – it is quite possible for Turing and reaction-diffusion models to produce small changes upon small changes in parameters, and equally it is possible for stochastic lattice models to exhibit large changes in behaviour upon small changes in parameters – it depends on the interactions and nonlinearities included in the model.</p><p>3) Finally:</p><p>&quot;From an analytical perspective, a significant advantage of our on-lattice model in contrast to off-lattice models is their amenability to the derivation of a continuum model. Our model therefore opens up the opportunity for future exploratory work using a continuum model for mutants <italic>pfe</italic> and <italic>nac</italic> in order to explore whether pattern formation in these cases individually can be described as Turing patterns and to determine parameter ranges for successful pattern formation.&quot;</p><p>Here you argue, and we agree, that the model in the manuscript is in fact simply a discretized version of a reaction-diffusion model (albeit a quite complex one with many dynamical variables and many interactions). Thus, there is no great difference in approach between the discretized stochastic model you analyze and reaction-diffusion models, so please remove all statements that imply a large difference in your approach vs. reaction-diffusion or Turing type models. Further, a continuum limit can easily be constructed for off-lattice models as well, so this is not an advantage of your approach over that of Volkening et al. Please remove this statement, and present the opportunity for building continuum models as one that applies to both your model as well Volkening et al.'s model.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.52998.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>The manuscript describes a computational model that attempts to capture the complexities of xanthophore and iridophore interactions to explain zebrafish pigment stripe pattern formation. While the reviewers appreciate that the model is sufficient to reproduce known stripe patterns, it has not been demonstrated that the interactions included are necessary, and all reviewers were of the opinion that the model has not been used to make sufficiently interesting predictions. In order for a revision to be publishable, it must distinguish the work sufficiently from the work of Volkening and Sandstede by including several more predictions (see points 1,2,3 of reviewer 1, and point 3 of reviewer 3).</p></disp-quote><p>We have extended our work substantially to include a number of new predictions as suggested by the reviewers, including:</p><p>1) Predicting the potential effects of changing the initial conditions for stripe formation</p><p>a) by changing the initial iridophore horizontal striping to be vertical (see subsection “Initial S-iridophore interstripe orientation alone does not determine the orientation of stripes and interstripes and Figure 13A);</p><p>b) by displacing the initial horizontal interstripe vertically, so that it appears lower down the initial domain (see subsection “The position of the initial S-iridophore interstripe is important for successful pattern formation” and Figure 13B);</p><p>c) by changing the initial domain size while maintaining the usual growth rates (see subsection “Initial domain size contributes to the number of stripes and interstripes” and Figure 13C);</p><p>d) by populating the initial domain with pre-formed stripes and observing stripe insertion (see subsection “Initial domain size contributes to the number of stripes and interstripes” and Figure 13D).</p><p>2) Formulating and then testing hypotheses about the functions of the <italic>leo</italic> gene by replicating the range of mutant and cross mutant patterns (see subsection “An in silico investigation into the function of the <italic>leo</italic> gene” and Figure 14)</p><p>3) Predicting the patterning of <italic>seurat</italic> mutants and double mutants based on the known biology. These extensions are included in the subsection “Model predictions” of the main text along with our original predictions and (for <italic>seurat</italic> mutants) in the Discussion and Appendix 5.</p><disp-quote content-type="editor-comment"><p>In addition, as pointed out by reviewer 2, it is essential that the existing and added predictions be shown to be robust to changing parameter values within biologically reasonable ranges – tuning parameters one by one, keeping all others fixed, only between low and high values, is not a sufficient exploration of the parameter space to prove such robustness.</p></disp-quote><p>We performed a rigorous robustness analysis by carrying out one hundred repeats for simulations of each of the WT and four of the main mutant types – <italic>nac</italic>, <italic>pfe</italic>, <italic>shd</italic> and <italic>leo –</italic> with perturbed parameter values chosen uniformly at random from the range between 0.75-1.25 of their described value. The process is described in detail in subsection “Necessity of S-iridophore assumptions”. Twenty (randomly selected) of the repeats for WT are displayed in the new Figure 9 of the manuscript and ten (randomly selected) of the repeats for each of <italic>nac</italic>, <italic>pfe</italic>, <italic>shd</italic> and <italic>leo</italic> are given in Appendix 4—figure 1. For all one hundred repeats these significant perturbations to the rates still generate consistent patterning, in both WT and all mutant cases, demonstrating the robustness of the model.</p><disp-quote content-type="editor-comment"><p>A more comprehensive exploration of parameter space is also essential to satisfy reviewer 2 that the interactions included in the model are indeed necessary as claimed in the manuscript, and that despite the very large number of parameters the behaviour of the model is constrained enough to make robust predictions.</p></disp-quote><p>Most of the features we have included in the model have been demonstrated through biological experimentation and therefore are incorporated for completeness. A small number of the interactions included in the model are predictions focussed on the role of iridophores. We tested the necessity of these predictions by removing the corresponding model feature and demonstrating that the reduced model fails to replicate either the WT and/or mutant pattern predictions (Figure 11 of the revised manuscript). We further tested our predictions by applying our model to other mutants such as <italic>choker</italic> and <italic>sbr</italic> in order to demonstrate that these mutants are also successfully replicated by the model without the need for further assumptions (Figure 7O-Q’ of the revised manuscript). We have also carried out a more comprehensive test of the biologically suggested features demonstrating that the removal of each model feature independently leads to incorrect pattern formation in the model (Figure 12). This acts as a clear demonstration of the necessity of all the interactions included in the model.</p><disp-quote content-type="editor-comment"><p>The manuscript should also tone down claims of the novelty of the methods and the superiority of this approach compared to reaction-diffusion approaches – in particular, as reviewer 2 points out, stochasticity is easily included in reaction-diffusion approaches so that cannot count as a reason to favour a lattice-based model.</p></disp-quote><p>We have removed the suggestion that Turing models cannot incorporate stochasticity and toned-down claims of the superiority of the approaches in comparison to reaction-diffusion methods in the Introduction. Instead we have focussed on the important differences between the Turing reaction-diffusion modelling approach and our more biologically interpretable modelling approach.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>[…] It is not surprising that the model recapitulates known pigment patterns, since the model was built based on biological evidences. On the basis of this the authors state that the current experimental evidences together with their model`s assumptions of S-iridophore behavior is sufficient to explain pigment pattern formation. For a set of biological interactions to be termed as sufficient for formation of a pattern, the model could perhaps be challenged by stating predictions that are currently not easy to test experimentally.</p><p>1) For example: As the authors point out, zebrafish do not incorporate additional pigment stripes as they grow. The biological basis for this is not known. In their wild type simulation starting at stage PB, how would a pattern evolve if initially the melanophores were in 3 or 5 stripes instead of the normal 4 stripes?</p></disp-quote><p>It appears that the reviewer may have slightly misinterpreted our initial conditions. Initially, within our simulations, the melanophores are not in a striped arrangement, instead they appear dynamically across the domain, in a randomly dispersed pattern (Figure 4A’), as reported in real zebrafish (see Figure 4A). Whilst in real WT zebrafish shown in Figure 4A there are some melanocytes in a stripe-orientation that can be observed under the skin, these are much deeper below the skin layer and do not contribute to pattern development. We commented on this in the caption of Figure 4: “White arrows indicate the embryonic pattern of melanocytes in four stripes that are deeper than the skin level and are consequently <italic>not</italic> included in the model.”</p><p>Furthermore, we note that zebrafish do incorporate additional pigment stripes as they grow. However, it is important to note that these new stripes are added at the leading edges of a spreading pattern rather than between pre-formed stripes as has been documented, for instance, in the angelfish genus <italic>Pomocanthus</italic>.</p><p>Nevertheless, in order to investigate the potential for stripe insertion in zebrafish, we simulated a domain which is initially striped (two stripes and one interstripe) at stage PB. The resulting patterns demonstrate, as the reviewer suggested, that in this case new interstripes appear in-between already developed stripes, consistent with the <italic>Pomocanthus</italic> study we now reference. We have illustrated our results in Figure 13D and provided an associated commentary in the subsection “Stripe insertion can occur on an initially striped domain”.</p><disp-quote content-type="editor-comment"><p>2) At the start of the simulations at stage PB, the dense iridophores appear along the horizontal myoseptum. Is this spatial location of iridophores relevant to formation of the pattern? Would the pattern that emerges be different if the original metamorphic pattern of dense iridophores at the horizontal myoseptum was displaced dorsally or ventrally?</p></disp-quote><p>We have addressed the reviewer’s interesting suggestion by exploring what happens if, hypothetically, the initial iridophore stripe was in a different place. Given how we envisage the role of that initial iridophore stripe in the organisation of the melanophores, we predicted that, if we were to move the position of the initial interstripe, but maintain its horizontal orientation, that the stripes would still form sequentially around this initial interstripe, but in a pattern displaced along the dorso-ventral axis. We tested this hypothesis in the model and confirmed that this is exactly what happens. We have included simulations of pattern development from just such an initial condition in Figure 13B, discussing the similarities and differences to biologically plausible wild-type patterning in subsection “The position of the initial S-iridophore interstripe is important for successful pattern formation”. The stripes are more disrupted than with the wild-type initial condition. This effect is likely due to the altered impact of domain growth on the pattern: In the model, growth is centred at the middle of the domain and so when the initial stripe is not similarly centred, growth disrupts pattern formation.</p><p>Another interesting test case inspired by the reviewer’s comments, concerns the implication for pattern formation of altering the orientation of the initial iridophore stripe, so that it is oriented vertically (rather than horizontally as in wild-type fish). Based on the assumed role of the iridophore stripe in orienting the stripe pattern, we predicted that this change would result in vertical barring. In the simulation in Figure 13A and commentary in subsection “Initial S-iridophore interstripe orientation alone does not determine the orientation of stripes and interstripes”, it can be seen that, whilst initially the vertical iridophores drive a vertically oriented banding pattern, this gradually reorganises, so that at the end of the simulation, the pattern is a meshwork of vertical and horizontal striping. This result clearly supports the idea that the initial iridophore pattern is important in establishing stripe/interstripe orientation, but importantly reveals the previously unsuspected importance of domain growth in orienting striping in zebrafish.</p><disp-quote content-type="editor-comment"><p>3) The authors very nicely factor in the layered arrangement of the different cell types along the z-axis, to mirror the biological scenario. It is experimentally tough to switch the order of the layers, but should be possible to do in the simulations? This would be interesting because developmentally the three pigment cell types take distinct dorsal or ventral migratory routes along the horizontal myoseptum to reach their eventual z-layer. The route of migration has been thought to be critical in determining the fate of the pigment cell type (or of the stem cells that resides in the adult) and in establishing the stripe pattern. Could this assumption be partially tested to determine the relevance of the spatial order of the layers in eventual stripe formation?</p></disp-quote><p>The reviewer raises an interesting question: What determines the fate of pigment cells generated from the adult stem cells? To our knowledge there has been little study of the way in which the layered arrangements are built up over juvenile stages. For this reason, our model does not capture the migration pathway to the epidermis, but only the patterning process once the cells have arrived. Cells are modelled as interacting without explicit reference to layering. Thus, the order of the layers does not influence the output of our model. The distinct layers are incorporated in order to aptly represent the role of excluded volume between cells of the same type. That is, melanophores should occupy space available to other melanophores, but not to xanthophores for example, since they occupy a separate <italic>z</italic>-layer. We have added the sentence ‘We note that in our simulations, the ordering of the layers does not play any role in determining pattern formation.’ to the manuscript in the caption of Figure 2 in order to make this clear.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>This manuscript reports the study of pigment patterns in zebrafish embryos claiming a novel bottom-up stochastic model. My understanding is that this is an extensively employed standard approach using the chemical master equation for interacting (and diffusing) species to simulate emergent stochastic patterns. The authors incorporate many detailed and complex interactions between five different cell types and claim that all the interactions are essential to explain the observed patterns. My feeling is that such a study with a large number of control parameters is overkill and does not enhance our understanding of stripe patterns. As such, I do not recommend publishing this study in eLife.</p></disp-quote><p>We feel that the reviewer has perhaps misunderstood the motivation for our paper. As they have stated there are many demonstrations in the literature, including those we cite, which show that diverse patterns resembling those in wild-type and mutant zebrafish <italic>can be</italic> reproduced by a reaction-diffusion master equation (RDME) approach. Our aim, rather than asking if reaction-diffusion mechanisms could generate a pattern, was to ask whether the cell-cell interactions that have already been characterised biologically in the literature are necessary and sufficient to generate the observed biological patterning. Moreover, we investigate whether the resulting model can account for the diverse array of patterns seen in a variety of mutants, if the known biology corresponding to these mutants is incorporated. Though we agree that the number of parameters in this model is large, we argue that this reflects the demonstrated complexity of the underlying biology. Moreover, the iridophore interactions that are incorporated are based on hypotheses derived from biological studies; they have <italic>not</italic> been chosen for modelling convenience or to replicate particular patterns. Our model then provides a tool to determine whether these hypotheses are consistent with wild-type and mutant pattern formation.</p><disp-quote content-type="editor-comment"><p>1) In this manuscript, the authors present a quantitative model for simulating the stripe patterns seen in wt and mutant embryos of zebrafish. They develop a stochastic description based on the purported interactions between xanthophores, xanthoblasts, melanocytes and (two kinds of) iridophores while also incorporating motility that is biased by short- and long-ranged interactions between the cell types. These are augmented by cell division, death, differentiation and tissue growth. The resulting detailed numerical simulations are shown to qualitatively reproduce pigment patterns in wt and mutant conditions. Further, the authors quantitatively compare cell density, straightness of stripes and interstripe widths with experimental results. Several other results, such as the pair-correlation-function of cell densities, provide further justifications to the model developed.</p><p>2) The main point of this study seems to be the development of a bottom-up stochastic model incorporating as many complex and varied interactions between the cells to simulate pigment patterns. The authors contrast their approach with reaction-diffusion modelling approaches (such as Turing patterns) by saying that such approaches lack the stochasticity observed inherently in pigment patterns.</p><p>I would disagree with this viewpoint. The point of reaction-diffusion approaches is minimalistic coarse-grained descriptions of the complex effective interactions between cells (or any other constituents of the patterns) that can capture the essence of the emergent patterns. It is easy to incorporate stochasticity even in approaches that use partial-differential equations.</p></disp-quote><p>Whilst we acknowledge that Turing patterns are an excellent tool for inspiring scientists to investigate the mechanisms behind pattern formation in a variety of biological systems, we believe they are not the most appropriate tools for understanding the detailed mechanisms underlying zebrafish pigmentation patterning at the microscale.</p><p>A lack of stochasticity in classical partial differential equation models of Turing reaction-diffusion mechanisms is just one reason why we view such models as less appropriate for this inherently stochastic pattern formation process but is of relatively minor concern in comparison to the other drawbacks we perceive these models have. That being said, we acknowledge that reaction-diffusion models can incorporate stochasticity and we have now removed this comment from the manuscript.</p><p>More troubling, in our point of view, is the lack of cellular level resolution that such continuum models provide. In an age in which computational power is not an issue and cell-level biological data is available, individual-based models are an appropriate tool for investigating biological hypotheses made at a cellular level.</p><p>Even more concerning to us is the lack of detailed insight provided by coarse-grained Turing models. It is precisely the coarse-grained ‘effective’ descriptions of the complex interactions that the reviewer describes, which rob Turing models of zebrafish pigment pattern formation of their predictive power. It is often impossible, in such models, to link parameters specifically to the microscopic individual-level data, especially because many different types of reaction kinetics are capable of generating the same course-grained patterns. Consequently, Turing models are often unable to provide mechanistic insight into the underlying biological processes, something which our detailed, individual-based model is manifestly capable of doing.</p><p>Perhaps the starkest illustration of this limitation is that Turing models of zebrafish pigmentation patterns are capable of producing stripes with just two cell species – melanophores and xanthophores – whereas the real biology requires iridophores as well. Early two-species reaction-diffusion models of zebrafish pigmentation pattern formation gave no hint of the importance of the missing cell type or the necessity of the corresponding interactions, whereas detailed individual-based models such as ours, incorporating all the known biology, surely would have. That a model can produce a pattern which looks qualitatively similar to a biological pattern is not sufficient to suggest it can provide biological insight.</p><p>In summary, whilst we do not dispute that Turing reaction-diffusion models are useful for suggesting potential pattern formation mechanisms in a variety of biological contexts, and indeed were what first drew one of us, and many others, to become interested in understanding patterning processes many years ago, we do not believe them the most appropriate tool to test the complex individual-cell-based hypotheses that we investigate in this paper.</p><p>To address these comments, we have refined our comments about Turing mechanisms to the following:</p><p>“They [Turing mechanisms] typically rely on a small number of parameters which, upon being altered, can generate a diverse range of patterns. Simplified models such as these have the benefit that they are often analytically tractable, allowing a deep understanding of the pattern formation mechanism. However, their main limitation is that, due to the simplicity of the approach, there is often no consistent way to link the parameters with measurable data, making it difficult to relate the model results back to the biology.”</p><disp-quote content-type="editor-comment"><p>A complimentary approach is to simulate the underlying master equation that governs the chemical interactions, supplemented by a compartment-based approach to diffusion. There are several such studies done in the past using the standard Gillespie algorithm for simulating the chemical master equation. Such studies incorporate the essential chemistry (e.g., activator-inhibitor dynamics) and coupled with diffusion can lead to emergent stripe patterns with inherent stochasticity built-in.</p></disp-quote><p>Compartment-based reaction-diffusion simulations (often known as a reaction-diffusion master equation (RDME) formalism) are, as the reviewer points out, an alternative way to simulate reaction-diffusion processes which naturally incorporate stochasticity. Indeed, these models are capable of giving stripe formation consistent with the continuum models from which they are derived, but not, crucially, consistent with the biology underlying zebrafish pigmentation pattern formation for the following reasons:</p><p>1) In order to produce striped patterns, these RDME models must have multiple cells per compartment (as opposed to the single cell per compartment suggested by the volume-excluding property exhibited by the real cells). Such models typically also rely on reaction kinetics which bear little or no correspondence to the underlying biological interactions between different types of cells.</p><p>2) Once antiphase patterns of peaks and troughs have been produced by such models, an appropriately tuned threshold must be chosen in order to decide which regions constitute “stripe” and which “interstripe”. Consequently, the width of the stripes that result from such models is not an inherent property of the model, but an arbitrary choice on behalf of the modeller. The arbitrary threshold beyond which one region is considered stripe and another interstripe also belies the fact that these models result in non-trivial densities of xanthophores in the stripes and non-trivial densities of melanophores in the interstripes. This fact often goes unmentioned in such models but represents a significant departure from the real biology of the system.</p><p>Our approach shares some similarity to the RDME approach but incorporates more biological realism. Indeed, we use the Gillespie algorithm to simulate the stochastic events in our individual-based model, but rather than incorporating “the essential chemistry (e.g., activator-inhibitor dynamics)” which corresponds to a phenomenological Turing reaction-diffusion model that the reviewer suggests (NB ‘essential chemistry’ here is a reference to a required feature for the model-type, rather than an ‘essential known feature of the biological mechanism’), our detailed individual-based model begins with the biology. Consequently, we do not incur the limitations associated with Turing models that we have highlighted above.</p><disp-quote content-type="editor-comment"><p>3) The authors, instead, develop a detailed lattice-based model with sufficiently complex interactions between 5 species of cells along with short-ranged local interactions and long-ranged non-local interactions. These interactions bias the hopping rates of the cells along the lattice. The authors speculate on the possible physical origins of these interactions. However, it is not clear if there aren't other possible interactions that could also lead to the same emergent dynamics. And hence the questions arises as to what are the essential features required at this level of modeling and what details are incidental. It should be noted that even though the authors claim that their approach is bottom-up, they are not modelling interactions between molecules. Rather, the interactions incorporated in their modeling are also effective cell-level interactions. In essence, this study has considered a master-equation like approach to simulate zebrafish stripe patterns.</p></disp-quote><p>A bottom-up modelling approach does not require that modelling begins at the level of molecules (or, to go into even more detail, atoms), rather it should be at the lowest level at which pertinent details are available. Given the current state of biological knowledge, the level of cell-cell interactions is the lowest level at which we have sufficient information to build a model capable of recapitulating zebrafish pigmentation patterns. As a result, our model is capable of investigating biological hypotheses about interactions at this level, which higher-level, top-down models, focussed solely on pattern replication irrespective of the details of the underlying biology, would not be. Our model incorporates what is known of the biology and consequently provides a tool to investigate hypotheses about that which is unknown.</p><p>For the reasons we highlighted in the response to the reviewer’s previous point, our study is distinct from an RDME approach and avoids the biological unrealism associated with it. We consider fine-grained, biologically informed cell-level interactions as opposed to the coarse-grained interactions employed by the RDME approach.</p><p>Whilst it is possible that other cell-cell interaction dynamics might lead to similar emergent dynamics, the cell-cell interactions we have chosen are either biologically evidenced or (in the case of missing iridophore dynamics) previously hypothesised. The origins of the known cell-cell interactions are given in text [1-4]. Including alternative interactions with no basis in biological observation seems illogical.</p><disp-quote content-type="editor-comment"><p>4) The authors claim that all the interactions included in their model are essential for stripe patterns. This is demonstrated by turning off each interaction in-turn and showing that some feature of the pattern is lost. This is an 'all or none' switch. For the set of other parameters chosen, this might indeed lead to the conclusion that all interactions are absolutely needed. One could vary the interaction strengths in a continuous manner and then it is not clear if all the said interactions are absolutely needed for all parameter values.</p></disp-quote><p>An exhaustive continuous parameter sweep over all model parameters is not feasible. Such a parameter sweep would also be inappropriate since the majority of parameters are determined biologically. However, investigating the broad range of patterns that the model can produce is certainly a question of biological interest which we intend to follow up in a subsequent project.</p><disp-quote content-type="editor-comment"><p>5) Looking at the appendix and the supplementary material, I feel that the model is sufficiently complicated, and has so many turning parameters, that any range of behaviors is possible. It is not unreasonable to see that the large-scale emergent dynamics of such a complex model is essentially that of Turing systems which could have been simulated with much less complexity.</p></disp-quote><p>As we have previously stressed, the majority of the model’s parameters are biologically determined leaving the range of behaviours relatively restricted, although still capable of replicating the relevant biological patterns.</p><p>Without doubt, the basic striped patterns of wild-type zebrafish could be (and indeed has been) simulated with (simplified two-variable) Turing models. However, the point of our study is not simply to replicate patterns, but to provide mechanistic insight into the biology by which they are generated – something that Turing models are poorly equipped to do.</p><p>In order to demonstrate the robustness of our model to changes in the parameters we carried out a rigorous robustness analysis in which we varied the parameter values independently of each other. For 100 repeat simulations each parameter value was assigned at random from the range between 0.75-1.25 of their described value, effectively sampling the high-dimensional parameter space randomly. The process is described in detail in subsection “Necessity of S-iridophore assumptions” and twenty (randomly selected from the total of 100) repeats are displayed in Figure 9. It is clear to see, by looking at the figure, that the wild-type striped pattern is not significantly perturbed by any of the random parameters choice, demonstrating the robustness of the model to parameter changes. Note that we then repeated this robustness analysis for each of four of the key mutants, with similar confirmation of the robustness of the model’s outputs to reasonable parameter value changes. Twenty (randomly selected) of the repeats for WT are displayed in the new Figure 9 of the manuscript and ten (randomly selected) of the repeats for each of <italic>nac</italic>, <italic>pfe</italic>, <italic>shd</italic> and <italic>leo</italic> are given in Appendix 4—figure 1.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>[…] The paper is well-written. However, I would like to make some suggestions, listed below.</p><p>1) The assumptions and the way the model works could be made more explicit. For this I would suggest that the authors consider incorporating Figure 1, 2 and 3 from Appendix 1 into the main manuscript.</p></disp-quote><p>As suggested, we have added Appendix 1—figures 1, 2 and 3 to the main manuscript, reconstituting them as Figure 2 and Figure 3 to ease understanding. We thank the reviewer for this suggestion which has, we think, strengthened the manuscript by making it easier to understand.</p><disp-quote content-type="editor-comment"><p>2) I would suggest that the authors emphasise the differences of their model from the Volkening paper published in Aug 2018. I do take issue with the authors characterisation of this paper as very recent, and would suggest that the make greater reference to it in the Introduction.</p></disp-quote><p>We have changed ‘very recent’ to simply ‘recent’ where this appears. In the conclusion we had provided a paragraph addressing the similarities and differences between our work and Volkening’s, which we retain. To address the reviewers comment we have also added a sentence about the work of Volkening in the Introduction:</p><p>“These findings have paved the way for more detailed modelling, such as that of Volkening et al., 2018, who demonstrated (using an off-lattice individual-based model) the need for understanding S-iridophore behaviour when representing all three cell-types.”</p><disp-quote content-type="editor-comment"><p>3) One very interesting piece of data from this study, and the one that does differentiates this study from that of Volkening and Sandstede, is the analysis of the schachbrett mutant. This mutant points to the role of tight junctions in the transition of S-iridophore packing. It would be worth extending this analysis to the compunctiond sbr/leo and sbr/luc mutants described in Fadeev et al.</p></disp-quote><p>Upon the reviewer’s suggestion we incorporated the known features of <italic>leo</italic>, <italic>leo;sbr</italic>, <italic>leo;pfe</italic>, <italic>leo;nac</italic> and <italic>leo;shd</italic> mutants into our model. We found that, upon the incorporation of suitable assumptions we could, in fact, generate all the known patterns of these single and double mutants. We have stated the assumptions that we required in order to generate this range of distinctive patterns as a series of testable hypotheses about the function of the <italic>leo</italic> gene and have demonstrated the patterns that result when different combinations of these hypotheses are not satisfied in the model. We have included this now in the manuscript (see subsection “The position of the initial S-iridophore interstripe is important for successful pattern formation” and Figure 15). Additionally, we have tested the robustness of this pattern formation in Appendix 4—figure 1.</p><disp-quote content-type="editor-comment"><p>Additionally, there is a suggestion of an interaction between sbr and seurat – I wonder if the model were able to predict what a double sbr/seurat would look like?</p></disp-quote><p>The mutation in <italic>seurat</italic> affects melanocyte differentiation [3] and the mutation in <italic>sbr</italic> effects iridophore transition from dense to loose [5]. By changing the parameters to match this known biology we can effectively replicate the patterns associated with both <italic>sbr</italic> and <italic>seurat</italic> independently. Consequently, we can model and hence predict pattern formation for a double <italic>seurat/sbr</italic> mutant by changing the parameters so that the effects of both mutations occur simultaneously. We have added an example of a typical simulation result for a <italic>seurat/sbr</italic> at stage J+ in Appendix 5—figure 1. Our model predicts, when both of these mutations occur, that by stage J+, dense iridophores and xanthophores would cover most of the flank of the fish. A few melanophores associated with loose iridophores survive at the very dorsal and ventral regions of the fish. We have included a discussion of this double mutant along with the figure in in Appendix 5.</p><p>References:</p><p>1] Patterson, L. B., and Parichy, D. M. (2013). Interactions with Iridophores and the Tissue Environment Required for Patterning Melanophores and Xanthophores during Zebrafish Adult Pigment Stripe Formation. PLoS Genet., 9(5), 1-14.</p><p>2] Takahashi, G., and Kondo, S. (2008). Melanophores in the stripes of adult zebrafish do not have the nature to gather, but disperse when they have the space to move. Pigment Cell Melanoma Res., 21(6), 677–686.</p><p>3] Eom, D. S., Inoue, S., Patterson, L. B., Gordon, T. N., Slingwine, R., Kondo, S., Watanabe, M., and Parichy, D. M. (2012). Melanophore Migration and Survival during Zebrafish Adult Pigment Stripe Development Require the Immunoglobulin Superfamily Adhesion Molecule Igsf11. PLoS Genetics, 8(8), 1-16.</p><p>4] Singh, A. P., Schach, U., and Nüsslein-Volhard, C. (2014). Proliferation, dispersal and patterned aggregation of iridophores in the skin prefigure striped colouration of zebrafish. Nat. Cell Biol., 16(6), 607–614.</p><p>5] Fadeev, A., Krauss, J., Frohnhöfer, H. G., Irion, U., and Nüsslein-Volhard, C. (2015). Tightjunction protein 1a regulates pigment cell organisation during zebrafish colour patterning. <italic>eLife</italic>, 2015(4), 1–25.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>1) In the revised manuscript, you write:</p><p>&quot;The most commonly used mathematical paradigm for stripe formation takes the form of a Turing reaction diffusion model. In these representations, melanocytes and xanthophores diffuse and interact via a few long and short range 'reactions'. This class of model typically rely on a small number of parameters which, upon being altered, can generate a diverse range of patterns. Simplified models such as these have the benefit that they are often analytically tractable, allowing a deep understanding of the model. However, their main limitation is that, due to the simplicity of the approach, there is often no consistent way to link the parameters with measurable data, making it difficult to relate the model results back to the biology.&quot;</p><p>This gives the impression that (i) Turing pattern models are always simplified, and analytically tractable, and (ii) Turing models face a difficulty in relating their parameters to measurable data. Both are untenable statements and should be removed – there are several examples of both highly nonlinear Turing-type or reaction-diffusion models for pattern formation that are neither simple nor analytically tractable, and in several cases now people have shown how to relate their parameters to measurable data.</p></disp-quote><p>We appreciate the reviewer’s considered points and consequently have rectified the potential ambiguity of our statements to reflect the reviewer’s concerns. We have changed the text as follows:</p><p>“The most commonly used mathematical paradigm for stripe formation takes the form of a Turing reaction diffusion model. […] However, a potential limitation is that parameters do not always have a clear biological interpretation which, can sometimes make it difficult to link parameters to measurable data.”</p><disp-quote content-type="editor-comment"><p>2) The authors write:</p><p>&quot;Turing reaction-diffusion type models posit that combinations of short and long range dynamics between melanocytes and xanthophores generate stripe patterns. Indeed, much of the excitement around such models is the ease with which small parameter value changes result in diverse patterns, many readily recognisable from nature. […] A major difference between our model and Turing reaction diffusion models is that small parameter changes in our model do not typically generate qualitatively different patterns, whereas Turing reaction diffusion models can show substantial pattern changes in response to small changes (Budi, Patterson and Parichy, 2011; Yamaguchi, Yoshimoto and Kondo, 2007).&quot;</p><p>This gives the impression that large changes in behaviour due to small changes in parameters is a generic feature of Turing models, as opposed to the model in this manuscript. This is not true, and the statements implying this should be removed – it is quite possible for Turing and reaction-diffusion models to produce small changes upon small changes in parameters, and equally it is possible for stochastic lattice models to exhibit large changes in behaviour upon small changes in parameters – it depends on the interactions and nonlinearities included in the model.</p></disp-quote><p>Whilst in some cases small parameter value changes specifically near bifurcation points can result in diverse patterns for Turing patterns (see Lee et al., 2012; Metz et al., 2011; Watanabe and Kondo, 2015)), we acknowledge that it is not a generic feature of all Turing models. We appreciate that these sentences gave a misleading impression and for this reason we have added ‘can sometimes’ to the first paragraph as follows:</p><p>&quot;Turing reaction-diffusion-type models posit that combinations of short and long range dynamics between melanocytes and xanthophores generate stripe patterns.” Indeed, a lot of the excitement around such models is the ease with which small parameter value changes can sometimes result in diverse patterns, many readily recognisable from nature.</p><p>Furthermore we have modified the following sentence to be more specific:</p><p>“A major difference between our model and Turing reaction-diffusion models is that small parameter changes in our model do not typically generate qualitatively different patterns, whereas Turing reaction-diffusion models can show substantial pattern changes in response to small alterations to parameters near to bifurcation points (Budi, Patterson and Parichy, 2011; Yamaguchi, Yoshimoto and Kondo, 2007).&quot;</p><disp-quote content-type="editor-comment"><p>3) Finally:</p><p>&quot;From an analytical perspective, a significant advantage of our on-lattice model in contrast to off-lattice models is their amenability to the derivation of a continuum model. Our model therefore opens up the opportunity for future exploratory work using a continuum model for mutants pfe and nac in order to explore whether pattern formation in these cases individually can be described as Turing patterns and to</p><p>determine parameter ranges for successful pattern formation.&quot;</p><p>Here you argue, and we agree, that the model in the manuscript is in fact simply a discretized version of a reaction-diffusion model (albeit a quite complex one with many dynamical variables and many interactions). Thus, there is no great difference in approach between the discretized stochastic model you analyze and reaction-diffusion models, so please remove all statements that imply a large difference in your approach vs. reaction-diffusion or Turing type models.</p></disp-quote><p>We agree with the reviewer that we can likely derive a continuum reaction-diffusion model from our on-lattice individual model, but we note that this will not necessarily be a <italic>Turing</italic> reaction-diffusion model. It is for this reason that we express interest in deriving the continuum model, i.e. to assess this. Furthermore, being able to derive a continuum model from an individual-based model does not mean that the individual-based model is simply a discretisation of the resulting continuum model. Undoubtedly, in complex individual-based models which employ non-linear interactions, approximations including (but not limited to) moment closure assumptions will have to be made in order to reach the continuum limit, meaning that the continuum model will exhibit different behaviour to the individual-based model in certain parameter regimes. The advantage of deriving a continuum reaction-diffusion model from an individual-based model, rather than the other way around, is that we know exactly what assumptions have been made in passing from the individual-based model to the continuum model.</p><disp-quote content-type="editor-comment"><p>Further, a continuum limit can easily be constructed for off-lattice models as well, so this is not an advantage of your approach over that of Volkening et al. Please remove this statement, and present the opportunity for building continuum models as one that applies to both your model as well Volkening et al.'s model.</p></disp-quote><p>We acknowledge and address this concern as follows:</p><p>&quot;From an analytical perspective, an advantage of our on-lattice model is its amenability to the derivation of a continuum model, although we note that continuum approximations to off-lattice individual-based models can also be derived. Our model therefore opens up the opportunity for future exploratory work using a continuum model for mutants <italic>pfe</italic> and <italic>nac</italic> in order to explore whether pattern formation in these cases individually can be described as Turing patterns and to determine parameter ranges for successful pattern formation.&quot;</p><p>That it is also possible to derive continuum limits from off-lattice models does not diminish the utility of the approach for our on-lattice models. That said, we have moved this statement, so that it fits within our summary of future work instead of our comparison with Volkening et al. as we believe its previous positioning gave a misleading impression of the purpose of the statement. Having checked through the manuscript carefully, we do not see anywhere else where we claim that our model has this advantage over the Volkening model.</p></body></sub-article></article>