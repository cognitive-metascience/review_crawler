<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">33050</article-id><article-id pub-id-type="doi">10.7554/eLife.33050</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Immunology and Inflammation</subject></subj-group></article-categories><title-group><article-title>Method for identification of condition-associated public antigen receptor sequences</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-62204"><name><surname>Pogorelyy</surname><given-names>Mikhail V</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0773-1204</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-100050"><name><surname>Minervina</surname><given-names>Anastasia A</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-51078"><name><surname>Chudakov</surname><given-names>Dmitriy M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0430-790X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-100051"><name><surname>Mamedov</surname><given-names>Ilgar Z</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-62212"><name><surname>Lebedev</surname><given-names>Yuri B</given-names></name><email>lebedev_yb@mx.ibch.ru</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-16865"><name><surname>Mora</surname><given-names>Thierry</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5456-9361</contrib-id><email>tmora@lps.ens.fr</email><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-50904"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2686-5702</contrib-id><email>awalczak@lpt.ens.fr</email><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Genomics of Adaptive Immunity</institution><institution>Shemyakin-Ovchinnikov Institute of Bioorganic Chemistry of the Russian Academy of Sciences</institution><addr-line><named-content content-type="city">Moscow</named-content></addr-line><country>Russia</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Center for Data-Intensive Biomedicine and Biotechnology</institution><institution>Skolkovo Institute of Science and Technology</institution><addr-line><named-content content-type="city">Moscow</named-content></addr-line><country>Russia</country></aff><aff id="aff3"><label>3</label><institution>Central European Institute of Technology</institution><addr-line><named-content content-type="city">Brno</named-content></addr-line><country>Czech republic</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Biological Faculty</institution><institution>Moscow State University</institution><addr-line><named-content content-type="city">Moscow</named-content></addr-line><country>Russia</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Laboratoire de Physique Statistique</institution><institution>CNRS, Sorbonne University, Paris-Diderot University, École Normale Supérieure</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Laboratoire de Physique Theorique</institution><institution>CNRS, Sorbonne University, École Normale Supérieure</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-9459"><name><surname>Chakraborty</surname><given-names>Arup K</given-names></name><role>Reviewing Editor</role><aff id="aff7"><institution>Massachusetts Institute of Technology</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>13</day><month>03</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e33050</elocation-id><history><date date-type="received" iso-8601-date="2017-10-24"><day>24</day><month>10</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2018-03-12"><day>12</day><month>03</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Pogorelyy et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Pogorelyy et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-33050-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.33050.001</object-id><p>Diverse repertoires of hypervariable immunoglobulin receptors (TCR and BCR) recognize antigens in the adaptive immune system. The development of immunoglobulin receptor repertoire sequencing methods makes it possible to perform repertoire-wide disease association studies of antigen receptor sequences. We developed a statistical framework for associating receptors to disease from only a small cohort of patients, with no need for a control cohort. Our method successfully identifies previously validated Cytomegalovirus and type one diabetes responsive TCR<inline-formula><mml:math id="inf1"><mml:mi>β</mml:mi></mml:math></inline-formula> sequences .</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>repertoire sequencing</kwd><kwd>statistical analysis</kwd><kwd>condition associated receptors</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006769</institution-id><institution>Russian Science Foundation</institution></institution-wrap></funding-source><award-id>15-15-00178</award-id><principal-award-recipient><name><surname>Chudakov</surname><given-names>Dmitriy M</given-names></name><name><surname>Mamedov</surname><given-names>Ilgar Z</given-names></name><name><surname>Lebedev</surname><given-names>Yuri B</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>724208</award-id><principal-award-recipient><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Without using control cohorts, a statistical method identifies candidates for immune receptors associated with diseases from repertoire sequencing datasets.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>T-cell receptors (TCR) and B-cell receptors (BCR) are hypervariable immunoglobulins that play a key role in recognizing antigens in the vertebrate immune system. TCR and BCR are formed in the stochastic process of V(D)J recombination, creating a diverse sequence repertoire. These receptors consist of two hypervariable chains, the <inline-formula><mml:math id="inf2"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf3"><mml:mi>β</mml:mi></mml:math></inline-formula> chains in the case of TCR. Progress in high throughput sequencing now allows for deep profiling of TCR<inline-formula><mml:math id="inf4"><mml:mi>α</mml:mi></mml:math></inline-formula> and TCR<inline-formula><mml:math id="inf5"><mml:mi>β</mml:mi></mml:math></inline-formula> chain repertoires, by establishing a near-complete list of unique receptor chain sequences, or ‘clonotypes’, present in a sample. Most sequencing data available correspond to TCR<inline-formula><mml:math id="inf6"><mml:mi>β</mml:mi></mml:math></inline-formula> only, but the same principles discussed below apply to TCR<inline-formula><mml:math id="inf7"><mml:mi>α</mml:mi></mml:math></inline-formula> repertoires, or to paired <inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> repertoires.</p><p>Comparison of sequenced repertoires has revealed that in any pair of individuals, large numbers of TCR<inline-formula><mml:math id="inf9"><mml:mi>β</mml:mi></mml:math></inline-formula> sequences have the same amino acid sequence (<xref ref-type="bibr" rid="bib23">Venturi et al., 2011</xref>). Several mechanisms leading to the repertoire overlap have been identified so far. The first mechanism is <italic>convergent recombination</italic>. Due to biases in V(D)J recombination process, the probability of generation of some TCR<inline-formula><mml:math id="inf10"><mml:mi>β</mml:mi></mml:math></inline-formula> sequences is very high, making them appear in almost every individual multiple times and repeatedly sampled in repertoire profiling experiments (<xref ref-type="bibr" rid="bib3">Britanova et al., 2014</xref>). This sharing does not result from a common specificity or function of T-cells corresponding to the shared TCR<inline-formula><mml:math id="inf11"><mml:mi>β</mml:mi></mml:math></inline-formula> clonotypes, and may in fact correspond to cells from the naive compartment in both donors (<xref ref-type="bibr" rid="bib18">Quigley et al., 2010</xref>), or from functionally distinct subsets such as CD4 and CD8 T-cells. The second possible reason for TCR sequence sharing is specific to identical twins, who may share T cell clones as a consequence of cord blood exchange <italic>in utero</italic> via a shared placenta (<xref ref-type="bibr" rid="bib17">Pogorelyy et al., 2017</xref>). Note that in that scenario both the <inline-formula><mml:math id="inf12"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf13"><mml:mi>α</mml:mi></mml:math></inline-formula> chains are shared together. The third and most interesting mechanism for sharing the sequence of either the <inline-formula><mml:math id="inf14"><mml:mi>β</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf15"><mml:mi>α</mml:mi></mml:math></inline-formula> or both chains is <italic>convergent selection</italic> in response to a common antigen. From functional studies, such as sequencing of MHC-multimer specific T-cells, it is known that the antigen-specific repertoire is often biased, and the same antigen-specific TCR <inline-formula><mml:math id="inf16"><mml:mi>β</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf17"><mml:mi>α</mml:mi></mml:math></inline-formula> chain sequences can be found in different individuals (<xref ref-type="bibr" rid="bib14">Miles et al., 2011</xref>; <xref ref-type="bibr" rid="bib5">Dash et al., 2017</xref>; <xref ref-type="bibr" rid="bib11">Glanville et al., 2017</xref>).</p><p>Reproducibility of a portion of the antigen-specific T-cell repertoire in different patients creates an opportunity for disease association studies using TCR<inline-formula><mml:math id="inf18"><mml:mi>β</mml:mi></mml:math></inline-formula> repertoire datasets (<xref ref-type="bibr" rid="bib8">Faham et al., 2017</xref>; <xref ref-type="bibr" rid="bib7">Emerson et al., 2017</xref>). These studies analyse the TCR<inline-formula><mml:math id="inf19"><mml:mi>β</mml:mi></mml:math></inline-formula> sequence overlap in large cohorts of healthy controls and patients to identify shared sequences overrepresented in the patient cohort. Here we propose a novel computational method to identify clonotypes which are likely to be shared because of selection for their response to a common antigen, instead of convergent recombination. Our approach is based on a mechanistic model of TCR recombination and is applicable to small cohorts of patients, without the need for a healthy control cohort.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>As a proof of concept, we applied our method to two large publicly available TCR<inline-formula><mml:math id="inf20"><mml:mi>β</mml:mi></mml:math></inline-formula> datasets from Cytomegalovirus (CMV)-positive (<xref ref-type="bibr" rid="bib7">Emerson et al., 2017</xref>) and type one diabetes (T1D) (<xref ref-type="bibr" rid="bib19">Seay et al., 2016</xref>) patients. In both studies the authors found shared public TCR<inline-formula><mml:math id="inf21"><mml:mi>β</mml:mi></mml:math></inline-formula> clonotypes that are specific to CMV-peptides or self-peptides, respectively. Specificity of these clonotypes was defined using MHC-multimers. We show that TCR<inline-formula><mml:math id="inf22"><mml:mi>β</mml:mi></mml:math></inline-formula> chain sequences functionally associated with CMV and T1D in these studies are identified as outliers by our method.</p><p>The main ingredient of our approach is to estimate the probability of generation of shared clonotypes, and to use this probability to determine the source of sharing (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). Due to the limited sampling depth of any TCR sequencing experiment, chances to sample the same TCR<inline-formula><mml:math id="inf23"><mml:mi>β</mml:mi></mml:math></inline-formula> clonotype twice are low, unless this clonotype is easy to generate convergently, with many independent generation events with the same TCR<inline-formula><mml:math id="inf24"><mml:mi>β</mml:mi></mml:math></inline-formula> amino acid sequence in each individual (convergent recombination), or if corresponding T-cell clone underwent clonal expansion, making its concentration in blood high (convergent selection). Thus, we reasoned that convergently selected clonotypes should have a <italic>lower</italic> generative probability than typical convergently recombined clonotypes. To test this, we estimated the generative probability of the TCR<inline-formula><mml:math id="inf25"><mml:mi>β</mml:mi></mml:math></inline-formula>’s Complementarity Determining Region 3 (CDR3) amino-acid sequences that were shared between several patients. Since no algorithm exists that can compute this generative probability directly, our method relies on the random generation and translation of massive numbers of TCR nucleotide sequences using a mechanistic statistical model of V(D)J recombination (<xref ref-type="bibr" rid="bib16">Murugan et al., 2012</xref>), as can be easily performed for example using the IGoR software (<xref ref-type="bibr" rid="bib13">Marcou et al., 2017</xref>).</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.33050.002</object-id><label>Figure 1.</label><caption><title>Method principle and pipeline.</title><p>(Top left) Sequence overlap between two TCR or BCR repertoires. (Bottom left) There are two major mechanisms for sequence sharing between two repertoires: convergent recombination and convergent selection. Because convergent recombination favors sequences with high generation probabilities, these two classes of sequences have different distributions of the generative probability, <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. (Right) We estimate the theoretical <inline-formula><mml:math id="inf27"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each sequence <inline-formula><mml:math id="inf28"><mml:mi>σ</mml:mi></mml:math></inline-formula> and compare it to <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is empirically derived from the sharing pattern of that sequence in the cohort. Comparison of these two values allows us to calculate the analog of a p-value, namely the posterior probability that the sharing pattern is explained by the convergent recombination alone, with no selection for a common antigen.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33050-fig1-v2"/></fig><p>In <xref ref-type="fig" rid="fig2">Figure 2A</xref> we plot for each clonotype the number of donors sharing that clonotype against its generation probability. Disease-specific TCR<inline-formula><mml:math id="inf30"><mml:mi>β</mml:mi></mml:math></inline-formula> variants validated by functional tests in source studies are circled in red. Note that validated disease-specific TCR<inline-formula><mml:math id="inf31"><mml:mi>β</mml:mi></mml:math></inline-formula> sequences have a much lower generation probability than the typical sequences shared by the same number of donors. We developed a method of axis transformation (see Materials and methods) to compare the model prediction with data values on the same scale (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), so that outliers can be easily identified by their distance to identity line. Our method can be used to narrow down the potential candidates for further experimental validation of responsive receptors. Additional information, like the expansion of the identified TCR<inline-formula><mml:math id="inf32"><mml:mi>β</mml:mi></mml:math></inline-formula> clonotype in the inflammation site, the presence of the same clonotype in the repertoire of activated or memory T-cells, or absence in a cohort of healthy controls, could provide additional evidence for functional association of identified candidates with a given condition.</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.33050.003</object-id><label>Figure 2.</label><caption><title>Identification of condition-associated clonotypes using generative probability</title><p>(<bold>A</bold>) CDR3aa of antigen specific clonotypes (red circles) have less generative probability than other clonotypes shared among the same number of donors. The number of in silico rearrangements obtained for each TCR<inline-formula><mml:math id="inf33"><mml:mi>β</mml:mi></mml:math></inline-formula> sequence in our simulation (which is proportional to generation probability for each clonotype in a given VJ combination <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), plotted against the number of patients with that TCR<inline-formula><mml:math id="inf35"><mml:mi>β</mml:mi></mml:math></inline-formula> clonotype. (<bold>B</bold>) Model prediction of generative probabilities agrees well with data. To directly compare <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to data, we estimate the empirical probability of occurrence of sequences, <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, from its sharing pattern across donors (see Materials and methods). In A. and B. red dots indicate significant results (adjusted <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>, Holm’s multiple testing correction), while red circles point to the responsive clonotypes identified in the source studies.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33050-fig2-v2"/></fig><p>Our method also identifies other significant outliers than reported in the source studies (shown in red, and obtained after multiple-test correction – see Materials and methods), which may have three possible origins. First, they may be associated with the condition, but were missed by the source studies. Second, they may be due to other factors shared by the patients, such as features involved in thymic or peripheral selection, or reactivity to other common conditions than CMV (e.g. influenza infection). Third, they can be the result of intersample contamination. Our approach is able to diagnose the last explanation by estimating the likelihood of sharing at the level of nucleotide sequences (i.e. synonymously), as detailed in the Materials and methods section.</p></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Antigen receptor sequencing currently has little clinical applications. One of the most important ones is diagnostics and tracking of malignant T-cell and B-cell clones in lymphomas, where it allows for directly measuring the abundances of certain clones at different timepoints. Our method allows for a sequence-based theoretical prediction of T-cell abundances at the population level, and for the identification of T-cell clones associated with infectious and autoimmune conditions. Extensive databases of condition-associated clones can provide a means of disease diagnostics and extend the clinical utility of antigen receptor repertoire sequencing technologies.</p><p>This method may also be useful in the analysis of known antigen-specific TCR clonotypes. The typical source of such TCR sequences are MHC-multimer positive cells isolated from one or a few donors (<xref ref-type="bibr" rid="bib20">Shugay et al., 2018</xref>; <xref ref-type="bibr" rid="bib22">Tickotsky et al., 2017</xref>). Some of these antigen-specific clonotypes are private, and are hard to find in other patients, providing limited diagnostic value. Our method is able to distinguish these clones from publicly responding clonotypes that are likely to be shared by many patients using only their CDR3 amino acid sequences.</p><p>The cohort size necessary for the identification of antigen-specific clonotypes with our method varies (see ‘Designing the experiment’ subsection in Materials and methods). It depends on the strength and diversity of the response to the given antigen. CMV and other <italic>Herpesviridae</italic> (EBV, HSV), are able to cause a persistent infection, and a large fraction of the TCR repertoire of CMV-positive donors are believed to be specific to them—on average, up to 10% of CD8 +cells are specific to a single CMV epitope in elderly individuals (<xref ref-type="bibr" rid="bib12">Khan et al., 2004</xref>). However, it was shown that in a human acute infection model of yellow fever vaccination, virus-specific T-cell clones are one of the most abundant in the TCR repertoire and occupy up to 12% of the CD8 +T cell repertoire. This response is short-lived and contracts significantly a month after immunization (<xref ref-type="bibr" rid="bib15">Miller et al., 2008</xref>). So the peak of an immune response is the best timepoint to search for antigen-specific TCRs in acute infections using this method. T-cell response to herpesviruses is also not unique in terms of public clonotype involvement—in ankylosing spondylitis (<xref ref-type="bibr" rid="bib8">Faham et al., 2017</xref>), 30–40% of patients share a certain TCR<inline-formula><mml:math id="inf39"><mml:mi>β</mml:mi></mml:math></inline-formula> aminoacid sequence, which is more than the fraction of patients sharing CMV-specific clonotypes that we analysed in this study.</p><p>Our approach can be used on other hypervariable receptor chains (TCR<inline-formula><mml:math id="inf40"><mml:mi>α</mml:mi></mml:math></inline-formula>, BCR heavy and light chains), as well as other species (mice, fish, etc.). Both <inline-formula><mml:math id="inf41"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:mi>β</mml:mi></mml:math></inline-formula> chains contribute to T-cell receptor specificity. Single-cell or paired sequencing technologies (<xref ref-type="bibr" rid="bib24">Zemmour et al., 2018</xref>) could identify partner receptor chains for condition-associated TCR <inline-formula><mml:math id="inf43"><mml:mi>α</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf44"><mml:mi>β</mml:mi></mml:math></inline-formula> chain sequences identified with our approach. Antigenic peptides recognized by complete T-cell receptors could then be recovered in vitro using yeast-display libraries of peptide-MHC (<xref ref-type="bibr" rid="bib10">Gee et al., 2018</xref>). As paired sequencing becomes more widespread, our method can be extended to the analysis of full paired TCR by applying the exact same analysis using the joint recombination probability of <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> clonotypes.</p><p>Recent advances in computational methods allow us to extract TCR repertoires from existing RNA-Seq data (<xref ref-type="bibr" rid="bib1">Bolotin et al., 2017</xref>; <xref ref-type="bibr" rid="bib4">Brown et al., 2015</xref>). Huge numbers of available RNA-Seq datasets from patients with various conditions can be used for analysis and identification of novel virus, cancer, and self reactive TCR variants using our method. The more immunoglobulin receptors with known specificity are found using this type of association mapping, the more clinically relevant information can be extracted from immunoglobulin repertoire data.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Statistical analysis</title><sec id="s4-1-1"><title>Problem formulation</title><p>Our framework is applicable to analyze the outcome of a next generation sequencing experiment probing the immune receptor repertoires of <inline-formula><mml:math id="inf46"><mml:mi>n</mml:mi></mml:math></inline-formula> individuals with a given condition, for example CMV or Type one diabetes. We denote by <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> the number of unique amino acid TCR sequences in patient <inline-formula><mml:math id="inf48"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. For a given TCR amino acid sequence <inline-formula><mml:math id="inf50"><mml:mi>σ</mml:mi></mml:math></inline-formula>, we set <inline-formula><mml:math id="inf51"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to indicate that <inline-formula><mml:math id="inf52"><mml:mi>σ</mml:mi></mml:math></inline-formula> is present in patient <inline-formula><mml:math id="inf53"><mml:mi>i</mml:mi></mml:math></inline-formula>’s repertoire, and <inline-formula><mml:math id="inf54"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> otherwise. For a given shared sequence <inline-formula><mml:math id="inf55"><mml:mi>σ</mml:mi></mml:math></inline-formula>, we want to know how likely its sharing pattern is under the null hypothesis of convergent recombination, correcting for the donors’ different sampling depths. In other words, is <inline-formula><mml:math id="inf56"><mml:mi>σ</mml:mi></mml:math></inline-formula> overrepresented in the population of interest? If <inline-formula><mml:math id="inf57"><mml:mi>σ</mml:mi></mml:math></inline-formula> is significantly overrepresented, we also want to quantify the size of this effect.</p></sec><sec id="s4-1-2"><title>Overview</title><p>Under the null hypothesis, the presence of <inline-formula><mml:math id="inf58"><mml:mi>σ</mml:mi></mml:math></inline-formula> in a certain number of donors is explained by independent convergent V(D)J recombination events in each donor. Given the total number of recombination events that led to the sequenced sample of donor <inline-formula><mml:math id="inf59"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, the presence of given amino acid sequence <inline-formula><mml:math id="inf61"><mml:mi>σ</mml:mi></mml:math></inline-formula> in donor is Bernoulli distributed with probability<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the model probability that a recombined product found in a blood sample has sequence <inline-formula><mml:math id="inf63"><mml:mi>σ</mml:mi></mml:math></inline-formula> under the null hypothesis. It is formed by the product of <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the probability to generate the sequence <inline-formula><mml:math id="inf65"><mml:mi>σ</mml:mi></mml:math></inline-formula>, estimated using a V(D)J recombination model (see the following <italic>subsection</italic>), and <inline-formula><mml:math id="inf66"><mml:mi>Q</mml:mi></mml:math></inline-formula>, a constant correction factor accounting for thymic selection (see <italic>Estimation of the correction factor <inline-formula><mml:math id="inf67"><mml:mi>Q</mml:mi></mml:math></inline-formula> subsection</italic>). The number of independent recombination events <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> leading to the observed unique sequences in a sample <inline-formula><mml:math id="inf69"><mml:mi>i</mml:mi></mml:math></inline-formula> is unknown, because of convergent recombination events within the sample, but it can be estimated from the number of unique sequences <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, using the model distribution <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub></mml:math></inline-formula> (see <italic>Estimation of <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> subsection</italic>).</p><p>We also calculate the posterior distribution of <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, corresponding to the empirical counterpart of <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the cohort, inferred from the sharing pattern of <inline-formula><mml:math id="inf75"><mml:mi>σ</mml:mi></mml:math></inline-formula> across donors. We use information about the presence of <inline-formula><mml:math id="inf76"><mml:mi>σ</mml:mi></mml:math></inline-formula> in our donors, <inline-formula><mml:math id="inf77"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the sequencing depth for each donor, <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (see <italic>Estimation of <inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> subsubsection</italic>), yielding the posterior density: <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Finally, we estimate the probability, given the observations, that the true value of <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> is smaller than the theoretical value <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub></mml:math></inline-formula> predicted using V(D)J recombination model, analogous to a p-value and used to identify significant effects:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To estimate the effect size <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> we compare <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub></mml:math></inline-formula>,<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-1-3"><title>Estimation of <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:math></inline-formula>, the probability of generation of a TCR CDR3 amino acid sequence</title><p>To procedure outlined above requires to calculate <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the probability to generate a given CDR3 amino acid sequence. Methods exist to calculate the probability of TCR and BCR nucleotide sequences from a given recombination model (<xref ref-type="bibr" rid="bib16">Murugan et al., 2012</xref>; <xref ref-type="bibr" rid="bib13">Marcou et al., 2017</xref>), but are impractical to calculate the probability of amino acid sequences, because of the large number of codon combinations that can lead to the same amino acid sequence, <inline-formula><mml:math id="inf88"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>codons</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf89"><mml:mi>L</mml:mi></mml:math></inline-formula> is the sequence length, and <inline-formula><mml:math id="inf90"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>codons</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the number of codons coding for amino acid <inline-formula><mml:math id="inf91"><mml:mi>τ</mml:mi></mml:math></inline-formula>. The number is about <inline-formula><mml:math id="inf92"><mml:mrow><mml:mn>1.4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> for a typical CDR3 length of 15 amino acid.</p><p>Instead, we estimated <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using a simple Monte-Carlo approach. We randomly generated a massive number (<inline-formula><mml:math id="inf94"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>sim</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>9</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>) of recombination scenarios according to the validated recombination model (<xref ref-type="bibr" rid="bib16">Murugan et al., 2012</xref>):<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mi>V</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mi>D</mml:mi><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The resulting sequences were translated, truncated to only keep the CDR3, and counted. <inline-formula><mml:math id="inf95"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was approximated by the fraction of events thus generated that led to sequence <inline-formula><mml:math id="inf96"><mml:mi>σ</mml:mi></mml:math></inline-formula>. This approximation becomes more accurate as <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>N</mml:mi><mml:mi>sim</mml:mi></mml:msub></mml:math></inline-formula> increases, with an error on <inline-formula><mml:math id="inf98"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> scaling as <inline-formula><mml:math id="inf99"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>sim</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>.</p></sec><sec id="s4-1-4"><title>Estimation of the correction factor <inline-formula><mml:math id="inf100"><mml:mi>Q</mml:mi></mml:math></inline-formula></title><p>Not all generated sequences pass selection in the thymus. <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:math></inline-formula> systematically underestimates the frequency of recombination event that eventually make it into the observed repertoire. To correct for this effect, we estimate a correction factor <inline-formula><mml:math id="inf102"><mml:mi>Q</mml:mi></mml:math></inline-formula>, as was suggested in (<xref ref-type="bibr" rid="bib6">Elhanati et al., 2014</xref>):<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Contrary to (<xref ref-type="bibr" rid="bib6">Elhanati et al., 2014</xref>), which learned a sequence-specific factor for each individual, here we assume that all observed sequences passed thymic selection. <inline-formula><mml:math id="inf103"><mml:mi>Q</mml:mi></mml:math></inline-formula> is a normalization factor accounting for the fact that just a fraction <inline-formula><mml:math id="inf104"><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> of sequences pass thymic selection. This factor is determined for each VJ-combination as an offset when plotting <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> against <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>data</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> (see the following <italic>subsection</italic> for definition of <inline-formula><mml:math id="inf107"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>data</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula>), using least squares fitting.</p></sec><sec id="s4-1-5"><title>Estimation of <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the probability of sequence occurrence in data</title><p>The variable <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> indicates the presence or absence of a given TCR amino acid sequence <inline-formula><mml:math id="inf110"><mml:mi>σ</mml:mi></mml:math></inline-formula> in the <inline-formula><mml:math id="inf111"><mml:mi>i</mml:mi></mml:math></inline-formula>th dataset with <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> recombination events per donor. We want to estimate <inline-formula><mml:math id="inf113"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is a fraction of recombination events leading to <inline-formula><mml:math id="inf114"><mml:mi>σ</mml:mi></mml:math></inline-formula> in the population of interest. According to Bayes’ theorem, for a given <inline-formula><mml:math id="inf115"><mml:mi>σ</mml:mi></mml:math></inline-formula>, the probability density function of <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> reads:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The likelihood is given by a product of Bernouilli probabilities:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and a flat prior <inline-formula><mml:math id="inf117"><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>prior</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>const</mml:mi></mml:mrow></mml:math></inline-formula> is used.</p><p>We estimate <inline-formula><mml:math id="inf118"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>data</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> (shown in <xref ref-type="fig" rid="fig2">Figure 2B</xref>) as the maximum of the posterior distribution:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mspace width="-.8pc"/><mml:mstyle displaystyle="false" scriptlevel="1"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:munder></mml:mrow><mml:mtext> </mml:mtext><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-1-6"><title>Estimation of <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, the number of recombination events</title><p>The total number <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of recombination events in <inline-formula><mml:math id="inf121"><mml:mi>i</mml:mi></mml:math></inline-formula>th dataset is unknown, but we can count the number of unique CD3 acid sequences <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> observed in the sequencing experiment. For a typical TRB experiment, convergent recombination is relatively rare and one could use <inline-formula><mml:math id="inf123"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as an approximation. However, for less diverse loci (e.g TRA), or for much higher sequencing depths, one should correct for convergent recombination, as the the observed number of unique aminoacid sequences could be much lower than the actual number of corresponding recombination events.</p><p>The average number of unique sequences resulting from <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> recombination events is, in theory:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf125"><mml:mi>T</mml:mi></mml:math></inline-formula> is the set of sequences that can pass thymic selection. To estimate that number, we generate a very large number <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>N</mml:mi><mml:mi>sim</mml:mi></mml:msub></mml:math></inline-formula> of recombinations, leading to <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>N</mml:mi><mml:mi>uni</mml:mi></mml:msub></mml:math></inline-formula> unique CDR3 amino acid sequences for which <inline-formula><mml:math id="inf128"><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:math></inline-formula> is estimated as explained above. We take <inline-formula><mml:math id="inf129"><mml:mi>T</mml:mi></mml:math></inline-formula> to be a random subset of unique sequences, <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>T</mml:mi><mml:mo>⊂</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>uni</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, of size <inline-formula><mml:math id="inf131"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>uni</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and we apply <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>.</p><p>Using this equation we plot the calibration curve for the TRBV5-1 TRBJ2-6 VJ datasets in <xref ref-type="fig" rid="fig3">Figure 3</xref>. For comparison the case of no thymic selection (<inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) is shown in red. The inversion of this curve yields <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.33050.004</object-id><label>Figure 3.</label><caption><title>Calibration curve for TRBV5-1 TRBJ2-6 combination.</title><p>Here we plot the fraction of unique amino acid sequences to recombination events against the logarithm of the number of recombination events. The blue line corresponds to the theoretical solution with selection, the red line corresponds to the theoretical solution without selection.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33050-fig3-v2"/></fig></sec></sec><sec id="s4-2"><title>Pipeline description</title><p>In this section we describe how to apply our algorithm to real data. All the code and data necessary to reproduce our analysis is available online on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/pogorely/vdjRec/">https://github.com/pogorely/vdjRec/</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/vdjRec/">https://github.com/elifesciences-publications/vdjRec/</ext-link>).</p><p>We start with annotated TCR datasets (CDR3 amino acid sequence, V-segment, J-segment), one per donor. Such datasets are produced by MiXCR (<xref ref-type="bibr" rid="bib2">Bolotin et al., 2015</xref>), immunoseq (<ext-link ext-link-type="uri" xlink:href="http://www.adaptivebiotech.com/immunoseq">http://www.adaptivebiotech.com/immunoseq</ext-link>) and most other software for NGS repertoire data preprocessing. Data we used was in immunoseq format, publicly available from <ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com/immuneaccess">https://clients.adaptivebiotech.com/immuneaccess</ext-link> database.</p><p>We proceed as follows:</p><list list-type="order"><list-item><p>Split datasets by VJ combinations. The resulting datasets correspond to lists of unique CDR3 amino acid sequences for each donor and VJ combination. All following steps should be done independently for each VJ combination.</p></list-item><list-item><p>(Optional). Filter out sequences present in only one donor to speed up the downstream analysis.</p></list-item><list-item><p>Generate a large amount of simulated nucleotide TCR sequences for a given VJ combination. Extract and translate their CDR3, and count how many times each sequence appears in the simulated set (restricting to sequences actually observed in donors for better efficiency). The resulting number divided by the total number of simulated sequences is an estimate of <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:math></inline-formula>.</p></list-item><list-item><p>Estimate <inline-formula><mml:math id="inf136"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>data</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> for each sequence in the dataset, see <italic>Estimation of <inline-formula><mml:math id="inf137"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> subsection</italic>.</p></list-item><list-item><p>Using <inline-formula><mml:math id="inf138"><mml:msubsup><mml:mi>P</mml:mi><mml:mi>data</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:math></inline-formula>, estimate for each VJ combination the normalization <inline-formula><mml:math id="inf140"><mml:mi>Q</mml:mi></mml:math></inline-formula> by minimizing <inline-formula><mml:math id="inf141"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mi>data</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, see <italic>Estimation of the correction factor <inline-formula><mml:math id="inf142"><mml:mi>Q</mml:mi></mml:math></inline-formula> subsection</italic>, where <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>σ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> are the shared sequences.</p></list-item><list-item><p>Calculate <inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Calculate the p-value (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) and effect size (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>).</p></list-item></list></sec><sec id="s4-3"><title>Usage example</title><sec id="s4-3-1"><title>Data sources</title><p>Data from (<xref ref-type="bibr" rid="bib7">Emerson et al., 2017</xref>) and (<xref ref-type="bibr" rid="bib19">Seay et al., 2016</xref>) is publicly available from the immuneaccess database: <ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com/immuneaccess">https://clients.adaptivebiotech.com/immuneaccess</ext-link>. For our analysis, we only considered VJ combinations for which the authors identified condition-associated clonotypes with MHC-multimer proved specificity. CDR3 aminoacid sequences and V and J segment of these TCR clonotypes are given in <xref ref-type="table" rid="table1">Table 1</xref>.</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.33050.005</object-id><label>Table 1.</label><caption><title>Published antigen-specific clonotypes used to test the algorithm.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>CDR3aa</th><th>V-segment</th><th>J-segment</th><th>Antigen source</th><th>Ref.</th></tr></thead><tbody><tr><td>CASSLAPGATNEKLFF</td><td>TRBV07-06</td><td>TRBJ1-4</td><td>CMV</td><td>(<xref ref-type="bibr" rid="bib7">Emerson et al., 2017</xref>)</td></tr><tr><td>CASSPGQEAGANVLTF</td><td>TRBV05-01</td><td>TRBJ2-6</td><td>CMV</td><td>(<xref ref-type="bibr" rid="bib7">Emerson et al., 2017</xref>)</td></tr><tr><td>CASASANYGYTF</td><td>TRBV12-3,−4</td><td>TRBJ1-2</td><td>CMV</td><td>(<xref ref-type="bibr" rid="bib7">Emerson et al., 2017</xref>)</td></tr><tr><td>CASSLVGGPSSEAFF</td><td>TRBV05-01</td><td>TRBJ1-1</td><td>self</td><td>(<xref ref-type="bibr" rid="bib19">Seay et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Gebe et al., 2009</xref>)</td></tr></tbody></table></table-wrap></sec><sec id="s4-3-2"><title>Analysis results</title><p>We applied our pipeline to identify CMV-specific and self-specific TCR sequences listed in <xref ref-type="table" rid="table1">Table 1</xref>. For our analysis we used only case cohorts, without controls. For each dataset we followed our pipeline described in <italic>Pipeline description subsection</italic>. We found that sequences reported in the source studies as being both significantly enriched in the patient cohort, and antigen-specific according to MHC-multimers, were the most significant in 3 out of 4 datasets (See <xref ref-type="table" rid="table2">Table 2</xref>). In the remaining TRBV12 dataset, the sequence of interest was the top <inline-formula><mml:math id="inf146"><mml:mn>40</mml:mn></mml:math></inline-formula> most significant out of <inline-formula><mml:math id="inf147"><mml:mrow><mml:mn>27</mml:mn><mml:mo>,</mml:mo><mml:mn>699</mml:mn></mml:mrow></mml:math></inline-formula> sequences present in at least two CMV-positive donors.</p><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.33050.006</object-id><label>Table 2.</label><caption><title>Output of the algorithm for sequences from <xref ref-type="table" rid="table1">Table 1</xref>.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>CDR3aa</th><th>V</th><th>J</th><th>Ag.source .</th><th>p-value rank</th><th>p-value</th><th>Effect size</th></tr></thead><tbody><tr><td>CASSLAPGATNEKLFF</td><td>07–06</td><td>1–4</td><td>CMV</td><td>1/1637</td><td><inline-formula><mml:math id="inf148"><mml:mrow><mml:mn>1.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>17</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>8.8</td></tr><tr><td>CASSPGQEAGANVLTF</td><td>5–01</td><td>2–6</td><td>CMV</td><td>1/5549</td><td><inline-formula><mml:math id="inf149"><mml:mrow><mml:mn>1.8</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>17</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>42.3</td></tr><tr><td>CASASANYGYTF</td><td>12–3,−4</td><td>1–2</td><td>CMV</td><td>40/27669</td><td><inline-formula><mml:math id="inf150"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>28.8</td></tr><tr><td>CASSLVGGPSSEAFF</td><td>5–01</td><td>1–1</td><td>self</td><td>1/2646</td><td><inline-formula><mml:math id="inf151"><mml:mrow><mml:mn>9.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>19</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></td><td>524</td></tr></tbody></table></table-wrap></sec></sec><sec id="s4-4"><title>Identifying contaminations</title><p>Intersample contamination may complicate high-throughput sequencing data analysis in many ways. It could occur both during library preparation or the sequencing process itself (<xref ref-type="bibr" rid="bib21">Sinha et al., 2017</xref>). Contaminations have the same nucleotide and amino acid sequence in all datasets, and so our method identifies them as outliers, because their sharing cannot be explained by a high recombination probability.</p><p>Our method provides a tool to diagnose contamination. Given an amino-acid sequence present in many donors, we measure its theoretical nucleotide diversity using the same simulation approach we used to calculate the generative probability <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:math></inline-formula> of the amino acid sequence (see <italic>Estimation of <inline-formula><mml:math id="inf153"><mml:msub><mml:mi>P</mml:mi><mml:mi>gen</mml:mi></mml:msub></mml:math></inline-formula> subsection</italic>). If the diversity of the simulated nucleotide sequences is much larger than observed in the data, it is a sign of contamination.</p><p>We applied this approach to the CDR3 sequence CASSLVGGPSSEAFF associated to Type one diabetes, and found 19 recombination events consistent with that amino acid sequence out of our simulated dataset. We found 18 different nucleotide variants out of the 19 total possible. In contrast, in the data this clononotype had the same nucleotide variant in all of the eight donors in which it was present. That variant was absent from the simulated set. A one-sided Fisher exact test gives a <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> probability of this happening by chance, indicating contamination as a likely source of sharing.</p></sec><sec id="s4-5"><title>Designing the experiment</title><p>Our approach also allows us to obtain important estimates for experiment design. A number of variables affect detection of an antigen-specific clone using our approach: the abundance of the clone in the general population (represented by <inline-formula><mml:math id="inf155"><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> in our approach), the cohort size, the sequencing depth <inline-formula><mml:math id="inf156"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> in each donor in the cohort, and also the effect size. Fixing any two of these variables results in a constraint between the other two and the affects the probability to detect an antigen-specific clonotype, which translates into the statistical power of the method. As an example of such an analysis, we fix the cohort size at 10, 30 or 100 donors (see <xref ref-type="fig" rid="fig4">Figure 4A–C</xref> respectively) and the sequencing depth at <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> unique clones sequenced per repertoire for a given VJ-combination in each donor in the cohort. We ask how frequently a disease specific clone with <inline-formula><mml:math id="inf158"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> abundance in the population and effect size <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is detected with our method. To address this question for each value <inline-formula><mml:math id="inf160"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> we perform a simulation: we simulate <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> Bernoulli variables, each with a <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> success probability. For a given value of <inline-formula><mml:math id="inf163"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf164"><mml:mi>q</mml:mi></mml:math></inline-formula> there is a single value of <inline-formula><mml:math id="inf165"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>post</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Then we calculate</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.33050.007</object-id><label>Figure 4.</label><caption><title>Simulation of the method performance with different cohort sizes, sequencing depths, effect sizes and target clone abundances in population.</title><p>In panels (<bold>A. B. C</bold>) we plot the number of simulations (out of 100) where a clone with a given effect size <inline-formula><mml:math id="inf166"><mml:mi>q</mml:mi></mml:math></inline-formula> (line color, see legend) and <inline-formula><mml:math id="inf167"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> (x-axis) is found to be significant using our approach, for cohort sizes of 10, 30 and 100 donors respectively. Larger cohort sizes and effect sizes make it possible to resolve clonotypes with lower abundance in the population. In panel (<bold>D</bold>) we show the effect of sequencing depth for fixed <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>: larger numbers of clonotypes sequenced per donor allow us to resolve less frequent clones, since a clone of a given <inline-formula><mml:math id="inf169"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> is detected in a larger fraction of donors (panel <bold>E</bold>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33050-fig4-v2"/></fig><p><disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the posterior density, and check if <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is below a significance threshold of 0.0001. Such a low significant threshold in this example is chosen to take into account the multiple testing correction: we assume that about 1000 shared clones would be tested in a such analysis and p¡0.01 after multiple testing is chosen as the significance threshold in this study, which gives p¡0.0001 before the Bonferroni multiple testing correction. Then we plot the number of simulations in which a significant result was obtained for given effect size <inline-formula><mml:math id="inf172"><mml:mi>q</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf173"><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> for the clone of interest and the fraction of donors with this sequence in the simulated cohort (see <xref ref-type="fig" rid="fig4">Figure 4E</xref>, blue curve). Unsurprisingly, the effect size plays a role in the probability to detect an antigen specific clone, and the detection is not possible at all if the clone is not shared between several donors in the cohort (in our example this happens for <inline-formula><mml:math id="inf174"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>data</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) irrespective to the effect size. Larger cohort sizes can help to resolve clones with lower abundances, but sequencing depth also has a strong effect on the power of the approach. In <xref ref-type="fig" rid="fig4">Figure 4D and E</xref> we show simulation results for a fixed <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> and different sequencing depths <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of 100, 1000 or 10000 clones per donor in a given VJ combination. Interestingly, a large sequencing depth (black curve) can lead to a situation when an abundant and frequently generated clone will not be detected by the algorithm, because it will be found in all donors in the cohort. An additional test that checks the predictions by lowering the sequencing depth in silico by downsampling can solve this problem.</p><p>Another complicated question is how <inline-formula><mml:math id="inf177"><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> is related to the number of clones and the fraction of the repertoire involved in the response to the infection in a given donor. If the same antigen-specific clone is present in every donor, <inline-formula><mml:math id="inf178"><mml:msub><mml:mi>P</mml:mi><mml:mi>data</mml:mi></mml:msub></mml:math></inline-formula> is close to the average abundance of this clone in the repertoire. However one can imagine an opposite situation where the response is so diverse and private that different clones respond to a given antigen in each donor. It was previously shown that the diversity and publicness of responding T-cell clonotypes varies a lot across antigens (<xref ref-type="bibr" rid="bib5">Dash et al., 2017</xref>). Our approach is restricted to the identification of <italic>public</italic> antigen-specific clonotypes, which may not exist for all antigens.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by Russian Science Foundation grant 15-15-00178, and partially supported by European Research Council Consolidator Grant 724208.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Software, Investigation</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.33050.008</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-33050-transrepform-v2.pdf"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following previously published datasets were used:</p><p><related-object content-type="generated-dataset" id="dataset1" source-id="http://dx.doi.org/10.21417/B7001Z" source-id-type="uri"><collab collab-type="author">Emerson RO</collab><collab collab-type="author">DeWitt WS</collab><collab collab-type="author">Vignali M</collab><collab collab-type="author">Gravley J</collab><collab collab-type="author">Hu JK</collab><collab collab-type="author">Osborne EJ</collab><collab collab-type="author">Desmarais C</collab><collab collab-type="author">Klinger M</collab><collab collab-type="author">Carlson CS</collab><collab collab-type="author">Hansen JA</collab><collab collab-type="author">Rieder M</collab><collab collab-type="author">Robins HS</collab><year>2017</year><source>Immunosequencing identifies signatures of cytomegalovirus exposure history and HLA-mediated effects on the T cell repertoire</source><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.21417/B7001Z">http://dx.doi.org/10.21417/B7001Z</ext-link><comment>Publicly available at ImmuneAccess.</comment></related-object></p><p><related-object content-type="generated-dataset" id="dataset2" source-id="http://doi.org/10.21417/B73S3K" source-id-type="uri"><collab collab-type="author">Seay HR</collab><collab collab-type="author">Yusko E</collab><collab collab-type="author">Rothweiler SJ</collab><collab collab-type="author">Zhang L</collab><collab collab-type="author">Posgai AL</collab><collab collab-type="author">Campbell-Thompson M</collab><collab collab-type="author">Vignali M</collab><collab collab-type="author">Emerson RO</collab><collab collab-type="author">Kaddis JS</collab><collab collab-type="author">Ko D</collab><collab collab-type="author">Nakayama M</collab><collab collab-type="author">Smith MJ</collab><collab collab-type="author">Cambier JC</collab><collab collab-type="author">Pugliese A</collab><collab collab-type="author">Atkinson MA</collab><collab collab-type="author">Robins HS</collab><collab collab-type="author">Brusko TM</collab><year>2016</year><source>Tissue distribution and clonal diversity of the T and B cell repertoire in type 1 diabetes</source><ext-link ext-link-type="uri" xlink:href="http://doi.org/10.21417/B73S3K">http://doi.org/10.21417/B73S3K</ext-link><comment>Publicly available at ImmuneAccess</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolotin</surname> <given-names>DA</given-names></name><name><surname>Poslavsky</surname> <given-names>S</given-names></name><name><surname>Davydov</surname> <given-names>AN</given-names></name><name><surname>Frenkel</surname> <given-names>FE</given-names></name><name><surname>Fanchi</surname> <given-names>L</given-names></name><name><surname>Zolotareva</surname> <given-names>OI</given-names></name><name><surname>Hemmers</surname> <given-names>S</given-names></name><name><surname>Putintseva</surname> <given-names>EV</given-names></name><name><surname>Obraztsova</surname> <given-names>AS</given-names></name><name><surname>Shugay</surname> <given-names>M</given-names></name><name><surname>Ataullakhanov</surname> <given-names>RI</given-names></name><name><surname>Rudensky</surname> <given-names>AY</given-names></name><name><surname>Schumacher</surname> <given-names>TN</given-names></name><name><surname>Chudakov</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Antigen receptor repertoire profiling from RNA-seq data</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>908</fpage><lpage>911</lpage><pub-id pub-id-type="doi">10.1038/nbt.3979</pub-id><pub-id pub-id-type="pmid">29020005</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolotin</surname> <given-names>DA</given-names></name><name><surname>Poslavsky</surname> <given-names>S</given-names></name><name><surname>Mitrophanov</surname> <given-names>I</given-names></name><name><surname>Shugay</surname> <given-names>M</given-names></name><name><surname>Mamedov</surname> <given-names>IZ</given-names></name><name><surname>Putintseva</surname> <given-names>EV</given-names></name><name><surname>Chudakov</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>MiXCR: software for comprehensive adaptive immunity profiling</article-title><source>Nature Methods</source><volume>12</volume><fpage>380</fpage><lpage>381</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3364</pub-id><pub-id pub-id-type="pmid">25924071</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Britanova</surname> <given-names>OV</given-names></name><name><surname>Putintseva</surname> <given-names>EV</given-names></name><name><surname>Shugay</surname> <given-names>M</given-names></name><name><surname>Merzlyak</surname> <given-names>EM</given-names></name><name><surname>Turchaninova</surname> <given-names>MA</given-names></name><name><surname>Staroverov</surname> <given-names>DB</given-names></name><name><surname>Bolotin</surname> <given-names>DA</given-names></name><name><surname>Lukyanov</surname> <given-names>S</given-names></name><name><surname>Bogdanova</surname> <given-names>EA</given-names></name><name><surname>Mamedov</surname> <given-names>IZ</given-names></name><name><surname>Lebedev</surname> <given-names>YB</given-names></name><name><surname>Chudakov</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Age-related decrease in TCR repertoire diversity measured with deep and normalized sequence profiling</article-title><source>The Journal of Immunology</source><volume>192</volume><fpage>2689</fpage><lpage>2698</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1302064</pub-id><pub-id pub-id-type="pmid">24510963</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>SD</given-names></name><name><surname>Raeburn</surname> <given-names>LA</given-names></name><name><surname>Holt</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Profiling tissue-resident T cell repertoires by RNA sequencing</article-title><source>Genome Medicine</source><volume>7</volume><elocation-id>125</elocation-id><pub-id pub-id-type="doi">10.1186/s13073-015-0248-x</pub-id><pub-id pub-id-type="pmid">26620832</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dash</surname> <given-names>P</given-names></name><name><surname>Fiore-Gartland</surname> <given-names>AJ</given-names></name><name><surname>Hertz</surname> <given-names>T</given-names></name><name><surname>Wang</surname> <given-names>GC</given-names></name><name><surname>Sharma</surname> <given-names>S</given-names></name><name><surname>Souquette</surname> <given-names>A</given-names></name><name><surname>Crawford</surname> <given-names>JC</given-names></name><name><surname>Clemens</surname> <given-names>EB</given-names></name><name><surname>Nguyen</surname> <given-names>THO</given-names></name><name><surname>Kedzierska</surname> <given-names>K</given-names></name><name><surname>La Gruta</surname> <given-names>NL</given-names></name><name><surname>Bradley</surname> <given-names>P</given-names></name><name><surname>Thomas</surname> <given-names>PG</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Quantifiable predictive features define epitope-specific T cell receptor repertoires</article-title><source>Nature</source><volume>547</volume><fpage>89</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1038/nature22383</pub-id><pub-id pub-id-type="pmid">28636592</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elhanati</surname> <given-names>Y</given-names></name><name><surname>Murugan</surname> <given-names>A</given-names></name><name><surname>Callan</surname> <given-names>CG</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Quantifying selection in immune receptor repertoires</article-title><source>PNAS</source><volume>111</volume><fpage>9875</fpage><lpage>9880</lpage><pub-id pub-id-type="doi">10.1073/pnas.1409572111</pub-id><pub-id pub-id-type="pmid">24941953</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emerson</surname> <given-names>RO</given-names></name><name><surname>DeWitt</surname> <given-names>WS</given-names></name><name><surname>Vignali</surname> <given-names>M</given-names></name><name><surname>Gravley</surname> <given-names>J</given-names></name><name><surname>Hu</surname> <given-names>JK</given-names></name><name><surname>Osborne</surname> <given-names>EJ</given-names></name><name><surname>Desmarais</surname> <given-names>C</given-names></name><name><surname>Klinger</surname> <given-names>M</given-names></name><name><surname>Carlson</surname> <given-names>CS</given-names></name><name><surname>Hansen</surname> <given-names>JA</given-names></name><name><surname>Rieder</surname> <given-names>M</given-names></name><name><surname>Robins</surname> <given-names>HS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Immunosequencing identifies signatures of cytomegalovirus exposure history and HLA-mediated effects on the T cell repertoire</article-title><source>Nature Genetics</source><volume>49</volume><fpage>659</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1038/ng.3822</pub-id><pub-id pub-id-type="pmid">28369038</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faham</surname> <given-names>M</given-names></name><name><surname>Carlton</surname> <given-names>V</given-names></name><name><surname>Moorhead</surname> <given-names>M</given-names></name><name><surname>Zheng</surname> <given-names>J</given-names></name><name><surname>Klinger</surname> <given-names>M</given-names></name><name><surname>Pepin</surname> <given-names>F</given-names></name><name><surname>Asbury</surname> <given-names>T</given-names></name><name><surname>Vignali</surname> <given-names>M</given-names></name><name><surname>Emerson</surname> <given-names>RO</given-names></name><name><surname>Robins</surname> <given-names>HS</given-names></name><name><surname>Ireland</surname> <given-names>J</given-names></name><name><surname>Baechler-Gillespie</surname> <given-names>E</given-names></name><name><surname>Inman</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Discovery of T cell receptor β motifs specific to HLA-B27-positive ankylosing spondylitis by deep repertoire sequence analysis</article-title><source>Arthritis &amp; Rheumatology</source><volume>69</volume><fpage>774</fpage><lpage>784</lpage><pub-id pub-id-type="doi">10.1002/art.40028</pub-id><pub-id pub-id-type="pmid">28002888</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gebe</surname> <given-names>JA</given-names></name><name><surname>Yue</surname> <given-names>BB</given-names></name><name><surname>Unrath</surname> <given-names>KA</given-names></name><name><surname>Falk</surname> <given-names>BA</given-names></name><name><surname>Nepom</surname> <given-names>GT</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Restricted autoantigen recognition associated with deletional and adaptive regulatory mechanisms</article-title><source>The Journal of Immunology</source><volume>183</volume><fpage>59</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.0804046</pub-id><pub-id pub-id-type="pmid">19535636</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gee</surname> <given-names>MH</given-names></name><name><surname>Han</surname> <given-names>A</given-names></name><name><surname>Lofgren</surname> <given-names>SM</given-names></name><name><surname>Beausang</surname> <given-names>JF</given-names></name><name><surname>Mendoza</surname> <given-names>JL</given-names></name><name><surname>Birnbaum</surname> <given-names>ME</given-names></name><name><surname>Bethune</surname> <given-names>MT</given-names></name><name><surname>Fischer</surname> <given-names>S</given-names></name><name><surname>Yang</surname> <given-names>X</given-names></name><name><surname>Gomez-Eerland</surname> <given-names>R</given-names></name><name><surname>Bingham</surname> <given-names>DB</given-names></name><name><surname>Sibener</surname> <given-names>LV</given-names></name><name><surname>Fernandes</surname> <given-names>RA</given-names></name><name><surname>Velasco</surname> <given-names>A</given-names></name><name><surname>Baltimore</surname> <given-names>D</given-names></name><name><surname>Schumacher</surname> <given-names>TN</given-names></name><name><surname>Khatri</surname> <given-names>P</given-names></name><name><surname>Quake</surname> <given-names>SR</given-names></name><name><surname>Davis</surname> <given-names>MM</given-names></name><name><surname>Garcia</surname> <given-names>KC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Antigen identification for orphan T cell receptors expressed on tumor-infiltrating lymphocytes</article-title><source>Cell</source><volume>172</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.11.043</pub-id><pub-id pub-id-type="pmid">29275860</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glanville</surname> <given-names>J</given-names></name><name><surname>Huang</surname> <given-names>H</given-names></name><name><surname>Nau</surname> <given-names>A</given-names></name><name><surname>Hatton</surname> <given-names>O</given-names></name><name><surname>Wagar</surname> <given-names>LE</given-names></name><name><surname>Rubelt</surname> <given-names>F</given-names></name><name><surname>Ji</surname> <given-names>X</given-names></name><name><surname>Han</surname> <given-names>A</given-names></name><name><surname>Krams</surname> <given-names>SM</given-names></name><name><surname>Pettus</surname> <given-names>C</given-names></name><name><surname>Haas</surname> <given-names>N</given-names></name><name><surname>Arlehamn</surname> <given-names>CSL</given-names></name><name><surname>Sette</surname> <given-names>A</given-names></name><name><surname>Boyd</surname> <given-names>SD</given-names></name><name><surname>Scriba</surname> <given-names>TJ</given-names></name><name><surname>Martinez</surname> <given-names>OM</given-names></name><name><surname>Davis</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Identifying specificity groups in the T cell receptor repertoire</article-title><source>Nature</source><volume>547</volume><fpage>94</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1038/nature22976</pub-id><pub-id pub-id-type="pmid">28636589</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname> <given-names>N</given-names></name><name><surname>Hislop</surname> <given-names>A</given-names></name><name><surname>Gudgeon</surname> <given-names>N</given-names></name><name><surname>Cobbold</surname> <given-names>M</given-names></name><name><surname>Khanna</surname> <given-names>R</given-names></name><name><surname>Nayak</surname> <given-names>L</given-names></name><name><surname>Rickinson</surname> <given-names>AB</given-names></name><name><surname>Moss</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Herpesvirus-specific CD8 T cell immunity in old age: cytomegalovirus impairs the response to a coresident EBV infection</article-title><source>The Journal of Immunology</source><volume>173</volume><fpage>7481</fpage><lpage>7489</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.173.12.7481</pub-id><pub-id pub-id-type="pmid">15585874</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Marcou</surname> <given-names>Q</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>IGoR: a tool for high-throughput immune repertoire analysis</article-title><source>bioRxiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1705.08246">https://arxiv.org/abs/1705.08246</ext-link></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miles</surname> <given-names>JJ</given-names></name><name><surname>Douek</surname> <given-names>DC</given-names></name><name><surname>Price</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Bias in the αβ T-cell repertoire: implications for disease pathogenesis and vaccination</article-title><source>Immunology and Cell Biology</source><volume>89</volume><fpage>375</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1038/icb.2010.139</pub-id><pub-id pub-id-type="pmid">21301479</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname> <given-names>JD</given-names></name><name><surname>van der Most</surname> <given-names>RG</given-names></name><name><surname>Akondy</surname> <given-names>RS</given-names></name><name><surname>Glidewell</surname> <given-names>JT</given-names></name><name><surname>Albott</surname> <given-names>S</given-names></name><name><surname>Masopust</surname> <given-names>D</given-names></name><name><surname>Murali-Krishna</surname> <given-names>K</given-names></name><name><surname>Mahar</surname> <given-names>PL</given-names></name><name><surname>Edupuganti</surname> <given-names>S</given-names></name><name><surname>Lalor</surname> <given-names>S</given-names></name><name><surname>Germon</surname> <given-names>S</given-names></name><name><surname>Del Rio</surname> <given-names>C</given-names></name><name><surname>Mulligan</surname> <given-names>MJ</given-names></name><name><surname>Staprans</surname> <given-names>SI</given-names></name><name><surname>Altman</surname> <given-names>JD</given-names></name><name><surname>Feinberg</surname> <given-names>MB</given-names></name><name><surname>Ahmed</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Human effector and memory CD8+ T cell responses to smallpox and yellow fever vaccines</article-title><source>Immunity</source><volume>28</volume><fpage>710</fpage><lpage>722</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2008.02.020</pub-id><pub-id pub-id-type="pmid">18468462</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murugan</surname> <given-names>A</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name><name><surname>Callan</surname> <given-names>CG</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Statistical inference of the generation probability of T-cell receptors from sequence repertoires</article-title><source>PNAS</source><volume>109</volume><fpage>16161</fpage><lpage>16166</lpage><pub-id pub-id-type="doi">10.1073/pnas.1212755109</pub-id><pub-id pub-id-type="pmid">22988065</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pogorelyy</surname> <given-names>MV</given-names></name><name><surname>Elhanati</surname> <given-names>Y</given-names></name><name><surname>Marcou</surname> <given-names>Q</given-names></name><name><surname>Sycheva</surname> <given-names>AL</given-names></name><name><surname>Komech</surname> <given-names>EA</given-names></name><name><surname>Nazarov</surname> <given-names>VI</given-names></name><name><surname>Britanova</surname> <given-names>OV</given-names></name><name><surname>Chudakov</surname> <given-names>DM</given-names></name><name><surname>Mamedov</surname> <given-names>IZ</given-names></name><name><surname>Lebedev</surname> <given-names>YB</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Persisting fetal clonotypes influence the structure and overlap of adult human T cell receptor repertoires</article-title><source>PLoS Computational Biology</source><volume>13</volume><elocation-id>e1005572</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005572</pub-id><pub-id pub-id-type="pmid">28683116</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quigley</surname> <given-names>MF</given-names></name><name><surname>Greenaway</surname> <given-names>HY</given-names></name><name><surname>Venturi</surname> <given-names>V</given-names></name><name><surname>Lindsay</surname> <given-names>R</given-names></name><name><surname>Quinn</surname> <given-names>KM</given-names></name><name><surname>Seder</surname> <given-names>RA</given-names></name><name><surname>Douek</surname> <given-names>DC</given-names></name><name><surname>Davenport</surname> <given-names>MP</given-names></name><name><surname>Price</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Convergent recombination shapes the clonotypic landscape of the naive T-cell repertoire</article-title><source>PNAS</source><volume>107</volume><fpage>19414</fpage><lpage>19419</lpage><pub-id pub-id-type="doi">10.1073/pnas.1010586107</pub-id><pub-id pub-id-type="pmid">20974936</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seay</surname> <given-names>HR</given-names></name><name><surname>Yusko</surname> <given-names>E</given-names></name><name><surname>Rothweiler</surname> <given-names>SJ</given-names></name><name><surname>Zhang</surname> <given-names>L</given-names></name><name><surname>Posgai</surname> <given-names>AL</given-names></name><name><surname>Campbell-Thompson</surname> <given-names>M</given-names></name><name><surname>Vignali</surname> <given-names>M</given-names></name><name><surname>Emerson</surname> <given-names>RO</given-names></name><name><surname>Kaddis</surname> <given-names>JS</given-names></name><name><surname>Ko</surname> <given-names>D</given-names></name><name><surname>Nakayama</surname> <given-names>M</given-names></name><name><surname>Smith</surname> <given-names>MJ</given-names></name><name><surname>Cambier</surname> <given-names>JC</given-names></name><name><surname>Pugliese</surname> <given-names>A</given-names></name><name><surname>Atkinson</surname> <given-names>MA</given-names></name><name><surname>Robins</surname> <given-names>HS</given-names></name><name><surname>Brusko</surname> <given-names>TM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Tissue distribution and clonal diversity of the T and B cell repertoire in type 1 diabetes</article-title><source>JCI Insight</source><volume>1</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1172/jci.insight.88242</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shugay</surname> <given-names>M</given-names></name><name><surname>Bagaev</surname> <given-names>DV</given-names></name><name><surname>Zvyagin</surname> <given-names>IV</given-names></name><name><surname>Vroomans</surname> <given-names>RM</given-names></name><name><surname>Crawford</surname> <given-names>JC</given-names></name><name><surname>Dolton</surname> <given-names>G</given-names></name><name><surname>Komech</surname> <given-names>EA</given-names></name><name><surname>Sycheva</surname> <given-names>AL</given-names></name><name><surname>Koneva</surname> <given-names>AE</given-names></name><name><surname>Egorov</surname> <given-names>ES</given-names></name><name><surname>Eliseev</surname> <given-names>AV</given-names></name><name><surname>Van Dyk</surname> <given-names>E</given-names></name><name><surname>Dash</surname> <given-names>P</given-names></name><name><surname>Attaf</surname> <given-names>M</given-names></name><name><surname>Rius</surname> <given-names>C</given-names></name><name><surname>Ladell</surname> <given-names>K</given-names></name><name><surname>McLaren</surname> <given-names>JE</given-names></name><name><surname>Matthews</surname> <given-names>KK</given-names></name><name><surname>Clemens</surname> <given-names>EB</given-names></name><name><surname>Douek</surname> <given-names>DC</given-names></name><name><surname>Luciani</surname> <given-names>F</given-names></name><name><surname>van Baarle</surname> <given-names>D</given-names></name><name><surname>Kedzierska</surname> <given-names>K</given-names></name><name><surname>Kesmir</surname> <given-names>C</given-names></name><name><surname>Thomas</surname> <given-names>PG</given-names></name><name><surname>Price</surname> <given-names>DA</given-names></name><name><surname>Sewell</surname> <given-names>AK</given-names></name><name><surname>Chudakov</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>VDJdb: a curated database of T-cell receptor sequences with known antigen specificity</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>D419</fpage><lpage>D427</lpage><pub-id pub-id-type="doi">10.1093/nar/gkx760</pub-id><pub-id pub-id-type="pmid">28977646</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sinha</surname> <given-names>R</given-names></name><name><surname>Stanley</surname> <given-names>G</given-names></name><name><surname>Gulati</surname> <given-names>GS</given-names></name><name><surname>Ezran</surname> <given-names>C</given-names></name><name><surname>Travaglini</surname> <given-names>KJ</given-names></name><name><surname>Wei</surname> <given-names>E</given-names></name><name><surname>Chan</surname> <given-names>CKF</given-names></name><name><surname>Nabhan</surname> <given-names>AN</given-names></name><name><surname>Su</surname> <given-names>T</given-names></name><name><surname>Morganti</surname> <given-names>RM</given-names></name><name><surname>Conley</surname> <given-names>SD</given-names></name><name><surname>Chaib</surname> <given-names>H</given-names></name><name><surname>Red-Horse</surname> <given-names>K</given-names></name><name><surname>Longaker</surname> <given-names>MT</given-names></name><name><surname>Snyder</surname> <given-names>MP</given-names></name><name><surname>Krasnow</surname> <given-names>MA</given-names></name><name><surname>Weissman</surname> <given-names>IL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Index switching causes “spreading-of-signal” among multiplexed samples in illumina hiseq 4000 dna sequencing</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/125724</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tickotsky</surname> <given-names>N</given-names></name><name><surname>Sagiv</surname> <given-names>T</given-names></name><name><surname>Prilusky</surname> <given-names>J</given-names></name><name><surname>Shifrut</surname> <given-names>E</given-names></name><name><surname>Friedman</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>McPAS-TCR: a manually curated catalogue of pathology-associated T cell receptor sequences</article-title><source>Bioinformatics</source><volume>33</volume><fpage>2924</fpage><lpage>2929</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx286</pub-id><pub-id pub-id-type="pmid">28481982</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venturi</surname> <given-names>V</given-names></name><name><surname>Quigley</surname> <given-names>MF</given-names></name><name><surname>Greenaway</surname> <given-names>HY</given-names></name><name><surname>Ng</surname> <given-names>PC</given-names></name><name><surname>Ende</surname> <given-names>ZS</given-names></name><name><surname>McIntosh</surname> <given-names>T</given-names></name><name><surname>Asher</surname> <given-names>TE</given-names></name><name><surname>Almeida</surname> <given-names>JR</given-names></name><name><surname>Levy</surname> <given-names>S</given-names></name><name><surname>Price</surname> <given-names>DA</given-names></name><name><surname>Davenport</surname> <given-names>MP</given-names></name><name><surname>Douek</surname> <given-names>DC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A mechanism for TCR sharing between T cell subsets and individuals revealed by pyrosequencing</article-title><source>The Journal of Immunology</source><volume>186</volume><fpage>4285</fpage><lpage>4294</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1003898</pub-id><pub-id pub-id-type="pmid">21383244</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zemmour</surname> <given-names>D</given-names></name><name><surname>Zilionis</surname> <given-names>R</given-names></name><name><surname>Kiner</surname> <given-names>E</given-names></name><name><surname>Klein</surname> <given-names>AM</given-names></name><name><surname>Mathis</surname> <given-names>D</given-names></name><name><surname>Benoist</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Single-cell gene expression reveals a landscape of regulatory T cell phenotypes shaped by the TCR</article-title><source>Nature Immunology</source><volume>19</volume><fpage>291</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1038/s41590-018-0051-0</pub-id><pub-id pub-id-type="pmid">29434354</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.33050.014</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Chakraborty</surname><given-names>Arup K</given-names></name><role>Reviewing Editor</role><aff id="aff8"><institution>Massachusetts Institute of Technology</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Method for identification of condition-associated public antigen receptor sequences&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Arup Chakraborty as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor/Senior Editor has drafted this decision to help you prepare a revised submission.</p><p>Your manuscript describes a computational pipeline that identifies particular TCR sequences that are over represented in groups of individuals. In effect, it identifies the outlier TCR sequences populations from a computationally determined normal distribution. You go on to show that, based on TCR deep sequencing datasets, this method can retrospectively identify TCRβ chains that are over represented following CMV infections, and TCRβ sequences that have reactivity to defined autoantigens in type 1 diabetes. The manuscript is theoretically interesting, useful, timely, and clearly written. However, we have some significant concerns about the general applicability of this tool and its value for prospective, rather than retrospective, studies. These concerns are listed below and need to be addressed in a revision.</p><p>1) Methods to identify outlier populations are understood and statistical approaches to achieve this goal are available. Indeed, a related approach to this question is the basis for lymphoid tumor diagnostic methodologies being pursued by several companies. In what ways is your tool different/better compared to the available methods?</p><p>2) Your work is based on small cohorts of patients. HCMV can be responsible for a disproportionate number of TCR clonotypes and can have a stable profile over many years, even by the standards of other chronic infections. So, we wonder whether an attractive feature of this tool, which is its ability to glean information from data on small cohorts will carry over beyond the HCMV setting. Would one need a larger cohort for most disease applications? Is there a theoretical way to estimate what part of the repertoire (in terms of unique clones and their frequencies) has to be devoted to an infectious disease in order for it to be resolved in a given cohort size (maybe a scaling rule)?</p><p>3) A general concern is whether this tool will have broad impact. You used TCR sequence data sets of HLA-matched patients, which had already been shown to have T cell expansion to a defined peptide/HLA combination. The approach works if one has HLA-matched subjects, because one would assume in general that different HLA alleles will present a different spectrum of peptides, and that TCR Vgene – HLA interactions impact ligand specificity. Further, a significant element to the approach only works retrospectively; without prior knowledge of the TCR specificity one does not know whether the identified outlier populations are disease-relevant. For example, in <xref ref-type="fig" rid="fig2">Figure 2</xref>, there are many outlier sequences (red), which may be noise, may be disease relevant or may be consequences of HLA-biased selection that was not accounted for by the authors computationally-defined normal TCRb distribution. Can the method be useful for prospective studies, or learn new biology in retrospective studies? Perhaps one way to address this question is the following:</p><p>Is there any other viral infection for which comparable data is available? For instance, it would be nice if data on viruses like HSV or EBV were available along with data related to acute infection or vaccination (where a method such as this, if applicable, would be incredibly valuable).</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Method for identification of condition-associated public antigen receptor sequences&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Arup Chakraborty (Senior editor), a Reviewing editor, and 1 reviewer.</p><p>You present an important statistical tool for analyzing TCR sequence diversity. We will soon get to a point where entire human TCR repertoires will be sequenced and then the question is how do we understand this data to assess immune health – your method is an advance that allows us to take steps toward this goal, and is therefore a valuable resource/tool. However, you often confuse TCR with clonotype in the writing of your paper. A TCR β chain sequence is not a TCR clonotype. Throughout the manuscript, you describe what you are analyzing as TCR clonotypes when you are actually referring to independent TCR β sequences. An independent TCR α chain or a TCR β chain sequence is NOT a receptor. Once this point is consistently clarified in the manuscript, your paper will be accepted.</p><p>Reviewer #1:</p><p>Re-review:</p><p>The major concern I have with the method, writing and the inability of this platform to provide a framework for prospective studies is the author's miss-statements (I assume they know better) that a TCR β chain sequence is not a TCR clonotype. Throughout the manuscript, they authors describe what they are analyzing as TCR clonotypes when they are actually referring to independent TCR β sequences. An independent TCRa chain or a TCRb chain sequence is NOT a receptor. The CDR3beta sequence does not equal or even mark a particular T cell clone.</p><p>Problem statement that this creates:</p><p>Example in the Introduction: the authors argue that there are &quot;Several mechanisms leading to the repertoire overlap. The first mechanism is convergent recombination[…]&quot; This first statement or option is a product of sequencing just the TCRb chain, i.e., there are common rearrangements that occur do to V-J or V-D-J rearrangements that have no or few N-region additions. The second and third &quot;options&quot; are indeed TCRa + TCRb clonotypes, comparing the first possibility to 2 and 3 is comparing apples to oranges.</p><p>Due to biases in V(D)J recombination process, the probability of generation of some receptors is very high, making them appear in almost every individual multiple times and repeatedly sampled in repertoire profiling experiments Britanova et al., (2014). This sharing does not result from a common specificity or function of the shared clonotypes and may in fact correspond to cells from the naive compartment in both donors Quigley et al., (2010), or from functionally distinct subsets such as CD4 and CD8 T-cells.</p><p>The second possible reason for TCR sequence sharing is specific to identical twins, who may share T cell clones as a consequence of cord blood exchange in utero via a shared placenta Pogorelyy et al., (2017). The third and most interesting mechanism for sharing receptor sequences is convergent selection, in response to a common antigen.</p><p>- The terminology makes these types of statements nonsensical. Identical TCR clonotypes will absolutely have the identical antigen-specificity.</p><p>Issues that miss-representing TCRb sequences for TCR clonotypes in the general approach being promoted:</p><p>The incorrect use of TCR clonotype leads to some particularly difficult to imagine scenarios. For examples, in the reviewer response and within the manuscript, &quot;our method can be used to narrow down the potential candidates for further experimental validation of responsive receptors.&quot; (i.e., identify the antigen being recognized). Their idea regarding this approach is to use: &quot;Functional tests (like cultivation with peptides, or cytokine secretion assays) are the ultimate way to confirm specificity of these predicted clonotypes.&quot;</p><p>Within the cover letter: &quot;We also are careful to note that this method should be used to identify antigen-specific candidates that need to be further verified by other methods. Nevertheless, we believe that identifying candidates for these experiments is extremely useful.&quot;</p><p>- However, the sequencing and analyses method of the manuscript does not identify the V α chain, with only half of the receptor there is nothing to study further. Thus, there is no method provided that one could identify interesting receptors for prospective studies.</p><p>In summary, this is a method to identify outlier populations, for which retrospective data can be superimposed to create a snapshot of an immune response that has already been described using for example pMHC tetramers or other methods.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.33050.015</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Your manuscript describes a computational pipeline that identifies particular TCR sequences that are over represented in groups of individuals. In effect, it identifies the outlier TCR sequences populations from a computationally determined normal distribution. You go on to show that, based on TCR deep sequencing datasets, this method can retrospectively identify TCRβ chains that are over represented following CMV infections, and TCRβ sequences that have reactivity to defined autoantigens in type 1 diabetes. The manuscript is theoretically interesting, useful, timely, and clearly written. However, we have some significant concerns about the general applicability of this tool and its value for prospective, rather than retrospective, studies. These concerns are listed below and need to be addressed in a revision.</p><p>1) Methods to identify outlier populations are understood and statistical approaches to achieve this goal are available. Indeed, a related approach to this question is the basis for lymphoid tumor diagnostic methodologies being pursued by several companies. In what ways is your tool different/better compared to the available methods?</p></disp-quote><p>Current approaches for lymphoid tumor and minimal residual disease (MRD) diagnostics rely on longitudinal tracking of certain malignant rearrangements before and after treatment. These technologies use the abundance of the malignant clones in the organism before and after the treatment, which is measured directly with NGS, qPCR or flow cytometry. The sequences of the malignant clones are not linked to a known function. In our method we use a sequence-based theoretical estimate of a TCR clone’s abundance in the population to identify candidates for functional receptors that are convergently selected in different patients in response to a specific disease, which is a different task than the direct longitudinal tracking of clonotypes. However, there is a possible lesson to be learned from the overlap between the two methods: tracking malignant clones that have a high recombination probability may not be reliable because one could find an independently recombined healthy clone with the same sequence and interpret it as malignant. Conversely, the TCR recombination probability may be used to identify malignant TCR clones not suitable for longitudinal tracking due to their high probability to be recombined multiple times (Nazarov et al., 2016). If such clonotypes are found after chemotherapy in lymphoma patients, they could be surviving malignant clonotypes as usually assumed, but alternatively they could be different healthy clones with exactly the same independently recombined TCR sequence. In this case it is better to use different MRD markers and the antigen receptor generation probability could help to identify this situation.</p><p>We added the following text to clarify the features of our method (Discussion section):</p><p>“Antigen receptor sequencing currently has little clinical applications. One of the most important ones is diagnostics and tracking of malignant T-cell and B-cell clones in lymphomas, where it allows for directly measuring the abundances of certain clones at different timepoints. Our method allows for a sequence-based theoretical prediction of T-cell abundances at the population level, and for the identification of T-cell clones associated with infectious and autoimmune conditions. Extensive databases of condition-associated clones can provide a means of disease diagnostics and extend the clinical utility of antigen receptor repertoire sequencing technologies.”</p><disp-quote content-type="editor-comment"><p>2) Your work is based on small cohorts of patients. HCMV can be responsible for a disproportionate number of TCR clonotypes and can have a stable profile over many years, even by the standards of other chronic infections. So, we wonder whether an attractive feature of this tool, which is its ability to glean information from data on small cohorts will carry over beyond the HCMV setting. Would one need a larger cohort for most disease applications?</p></disp-quote><p>Data from published studies suggests that CMV is not a unique condition both in terms of the response magnitude and the number of donors sharing disease specific clones. Faham et al., have shown that 30–40 percent of donors with ankylosing spondylitis share a certain aminoacid TCR sequence, which is absent in healthy controls. This sharing number is larger than the fraction of donors sharing a CMV-specific clone in our current study. We would have liked to analyze different datasets, but we could not access other datasets with suitable cohort sizes and sequencing depth (see below for a discussion of this point).</p><p>One can also extend this method to acute infections. It is known that CMV-related clonotypes can occupy a large fraction of the repertoire for a long time [Khan et al., 2004]. However, in an acute viral infection model of yellow fever immunization it was shown that YF-reactive clones that are undetected in the repertoire before immunization can occupy up to 10 percent of the repertoire at the peak of the response (Miller et al., 2008, DeWitt et al., 2015). The response to acute infections is much less stable and strongly decreases on short timescales, but one may overcome this limitation by collecting samples at the peak of the immune response to an infection.</p><p>We added the following sentences into the text to clarify this point (Discussion section):</p><p>“The cohort size necessary for the identification of antigen-specific clonotypes with our method varies (see “Designing the experiment” subsection in Methods). It depends on the strength and diversity of the response to the given antigen. […] T-cell response to herpesviruses is also not unique in terms of public clonotype involvement – in ankylosing spondylitis (Faham et al., 2017), 30–40 percent of patients share a certain TCR aminoacid sequence, which is more than the fraction of patients sharing CMV-specific clonotypes that we analysed in this study.”</p><disp-quote content-type="editor-comment"><p>Is there a theoretical way to estimate what part of the repertoire (in terms of unique clones and their frequencies) has to be devoted to an infectious disease in order for it to be resolved in a given cohort size (maybe a scaling rule)?</p></disp-quote><p>This is a very interesting question, which we now address with a new section and discussion. In short, the answer depends on both the cohort size and the sequencing depth. To simplify the experiment design, we added an additional pipeline into the software, which is able to tell if a clone of given abundance in the population of patients would be resolved in a given cohort size.</p><p>We added an additional subsection in the Materials and methods section (“Designing the experiment”) and a new figure (see <xref ref-type="fig" rid="fig4">Figure 4</xref>), demonstrating examples of such analysis.</p><disp-quote content-type="editor-comment"><p>3) A general concern is whether this tool will have broad impact. You used TCR sequence data sets of HLA-matched patients, which had already been shown to have T cell expansion to a defined peptide/HLA combination. The approach works if one has HLA-matched subjects, because one would assume in general that different HLA alleles will present a different spectrum of peptides, and that TCR Vgene – HLA interactions impact ligand specificity. Further, a significant element to the approach only works retrospectively; without prior knowledge of the TCR specificity one does not know whether the identified outlier populations are disease-relevant. For example, in <xref ref-type="fig" rid="fig2">Figure 2</xref>, there are many outlier sequences (red), which may be noise, may be disease relevant or may be consequences of HLA-biased selection that was not accounted for by the authors computationally-defined normal TCRb distribution. Can the method be useful for prospective studies, or learn new biology in retrospective studies?</p></disp-quote><p>Our study may seem retrospective, because we chose examples where the right answer (public clonotypes with proved specificity) is known. This was necessary to validate the output of the algorithm. In 3 experiments out of 4 the correct (meaning validated in the source study) clonotype was the most significant signal in our analysis. We also are careful to note that this method should be used to identify antigen-specific candidates that need to be further verified by other methods. Nevertheless, we believe that identifying candidates for these experiments is extremely useful.</p><p>Functional tests (like cultivation with peptides, or cytokine secretion assays) are the ultimate way to confirm specificity of these predicted clonotypes. Clonal expansion of identified clonotypes at the inflammation site, presence in the repertoire of activated/memory T-cells, or absence in the control cohort repertoire, may provide additional evidence for condition-association of a given candidate clone.</p><p>We added the following sentence into the main text (Results section):</p><p>“Additional information, like the expansion of the identified clone in the inflammation site, the presence of the same clonotype in the repertoire of activated or memory T-cells, or absence in a cohort of healthy controls, could provide additional evidence for functional association of identified candidates with a given condition.”</p><p>Additionally, there is an interest in purely retrospective studies. In retrospective studies (where the specificity of TCR clones is already defined using, for example, MHC-multimers) it may be useful to predict the abundance of the known antigen-specific clones in the general population. For instance, if a researcher isolated and sequenced antigen-specific T-cells from a patient, some of these T-cell clones could be private and may not be found in other people, while some of them may be public, and easily found in many more yet unstudied patients. Such public clones are much more valuable for diagnostics, and they can be identified using only their TCR aminoacid sequence in such retrospective studies.</p><p>We added the following sentences to the main text to clarify this point (Discussion section):</p><p>“This method may also be useful in the analysis of known antigen-specific TCR clonotypes. The typical source of such TCR sequences are MHC-multimer positive cells isolated from one or a few donors (Shugay et al., 2017., Tickotsky et al., 2017). Some of these antigen-specific clonotypes are private, and are hard to find in other patients, providing limited diagnostic value. Our method is able to distinguish these clones from publicly responding clonotypes that are likely to be shared by many patients using only their CDR3 amino acid sequence.”</p><disp-quote content-type="editor-comment"><p>Perhaps one way to address this question is the following:</p><p>Is there any other viral infection for which comparable data is available? For instance, it would be nice if data on viruses like HSV or EBV were available along with data related to acute infection or vaccination (where a method such as this, if applicable, would be incredibly valuable).</p></disp-quote><p>To our knowledge, only one study on response to acute infection is available: DeWitt et al., 2015. We have tried to analyze this dataset but unfortunately, only 9 donors are available in this study, which is not enough to get significant results with our method. The authors also do not report sequences of significantly expanded clonotypes, so it is not possible to validate the output of the algorithm.</p><p>As a rule of thumb, assuming currently used typical sequencing depth, our method is applicable for identification of shared TCR sequences in vaccination and acute infection data, but cohorts of at least 20–30 donors are required for such analysis.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>You present an important statistical tool for analyzing TCR sequence diversity. We will soon get to a point where entire human TCR repertoires will be sequenced and then the question is how do we understand this data to assess immune health – your method is an advance that allows us to take steps toward this goal, and is therefore a valuable resource/tool. However, you often confuse TCR with clonotype in the writing of your paper. A TCR β chain sequence is not a TCR clonotype. Throughout the manuscript, you describe what you are analyzing as TCR clonotypes when you are actually referring to independent TCR β sequences. An independent TCR α chain or a TCR β chain sequence is NOT a receptor. Once this point is consistently clarified in the manuscript, your paper will be accepted.</p></disp-quote><p>We agree that our terminology was not specific enough and may confuse the readers. We have updated the manuscript to be more specific about single α or β chains and complete α/β TCR clonotypes. See our point-by-point response and implemented change below</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>Re-review:</p><p>The major concern I have with the method, writing and the inability of this platform to provide a framework for prospective studies is the author's miss-statements (I assume they know better) that a TCR β chain sequence is not a TCR clonotype. Throughout the manuscript, they authors describe what they are analyzing as TCR clonotypes when they are actually referring to independent TCR β sequences. An independent TCRa chain or a TCRb chain sequence is NOT a receptor. The CDR3beta sequence does not equal or even mark a particular T cell clone.</p></disp-quote><p>We completely agree with the reviewer and have updated the manuscript to clarify this point.</p><p>We have edited the first paragraph of the Introduction:</p><p>“These receptors consist of two hypervariable chains, the α and β chains in the case of TCR. Progress in high throughput sequencing now allows for deep profiling of TCRalpha and TCRbeta chain repertoires, by establishing a near-complete list of unique receptor chain sequences, or ‘’clonotypes’’, present in a sample. Most sequencing data available corresponds to TCRbeta, but the same principles discussed below apply to TCRalpha repertoires or to paired α β repertoires.”</p><p>We also specified when we talk about single T-cell receptor chains specifically throughout the text.</p><disp-quote content-type="editor-comment"><p>Problem statement that this creates:</p><p>Example in the Introduction: the authors argue that there are &quot;Several mechanisms leading to the repertoire overlap. The first mechanism is convergent recombination…&quot; This first statement or option is a product of sequencing just the TCRb chain, i.e., there are common rearrangements that occur do to V-J or V-D-J rearrangements that have no or few N-region additions. The second and third &quot;options&quot; are indeed TCRa + TCRb clonotypes, comparing the first possibility to 2 and 3 is comparing apples to oranges.</p><p>Due to biases in V(D)J recombination process, the probability of generation of some receptors is very high, making them appear in almost every individual multiple times and repeatedly sampled in repertoire profiling experiments Britanova et al., (2014). This sharing does not result from a common specificity or function of the shared clonotypes and may in fact correspond to cells from the naive compartment in both donors Quigley et al., (2010), or from functionally distinct subsets such as CD4 and CD8 T-cells.</p><p>The second possible reason for TCR sequence sharing is specific to identical twins, who may share T cell clones as a consequence of cord blood exchange in utero via a shared placenta Pogorelyy et al., (2017). The third and most interesting mechanism for sharing receptor sequences is convergent selection, in response to a common antigen.</p><p>- The terminology makes these types of statements nonsensical. Identical TCR clonotypes will absolutely have the identical antigen-specificity.</p></disp-quote><p>We agree with the reviewer that case 2 (physical sharing of cells) implies the sharing of complete α/β TCR sequence. In case 3 (selection by affinity to the same antigen), the situation varies for different epitopes and in some cases tetramer-sorted T-cells of the same specificity have been reported to have the same TCRbeta but very different TCRalpha, and vice versa (see examples of paired sequences from (Dash et al., 2017), deposited to vdjdb.cdr3.net)). Therefore, the sharing of single receptor chain sequences due to selection by affinity to the same antigen is generally more likely than sharing of complete α/β TCR.</p><p>We have edited the second paragraph of the introduction to clarify these points in the following way:</p><p>“Comparison of sequenced repertoires has revealed that in any pair of individuals, large numbers of TCRbeta sequences have the same amino acid sequence Venturi et al., (2011). […] From functional studies, such as sequencing of MHC-multimer specific T-cells, it is known that the antigen-specific repertoire is often biased, and the same antigen-specific TCR β or α chain sequences can be found in different individuals Miles et al., (2011); Dash et al., (2017); Glanville et al., (2017).”</p><disp-quote content-type="editor-comment"><p>Issues that miss-representing TCRb sequences for TCR clonotypes in the general approach being promoted:</p><p>The incorrect use of TCR clonotype leads to some particularly difficult to imagine scenarios. For examples, in the reviewer response and within the manuscript, &quot;our method can be used to narrow down the potential candidates for further experimental validation of responsive receptors.&quot; (i.e., identify the antigen being recognized). Their idea regarding this approach is to use: &quot;Functional tests (like cultivation with peptides, or cytokine secretion assays) are the ultimate way to confirm specificity of these predicted clonotypes.&quot;</p><p>Within the cover letter: &quot;We also are careful to note that this method should be used to identify antigen-specific candidates that need to be further verified by other methods. Nevertheless, we believe that identifying candidates for these experiments is extremely useful.&quot;</p></disp-quote><p>We agree with reviewer that the mere TCR β chain or the mere TCR α chain does not determine complete receptor specificity. The TCRbeta sequence is definitely not enough to determine receptor specificity in vitro. However, if a β-chain or an α-chain shared in patient cohort is identified as significant by our approach it is likely to be a part of T-cell receptor with the same specificity in each patient. T-cells from patients with the largest expansion of identified TCRbeta or TCRalpha clonotypes could then be used for single cell RNA sequencing to identify partner receptor chains or for various functional assays with candidate antigens.</p><p>We added sentences to the Discussion section on the contribution of both receptor chains to TCR specificity and possible assays to identify second receptor chain and possible antigen, see below.</p><disp-quote content-type="editor-comment"><p>- However, the sequencing and analyses method of the manuscript does not identify the V α chain, with only half of the receptor there is nothing to study further. Thus, there is no method provided that one could identify interesting receptors for prospective studies.</p></disp-quote><p>We agree that complete antigen-specific α/β T-cell receptor sequences would be much more informative and practically useful for prospective studies. Unfortunately, technologies for paired sequencing of α and β TCR chains (i.e. single-cell RNAseq) are still relatively low-throughput and expensive, comparing to the conventional RepSeq study targeting only single receptor chains. TCRalpha and TCRbeta pairing information is also impossible to retrieve from the bulk RNA-seq data. There are no published large datasets of complete paired α/β TCR sequences for cohorts of patients with the same condition. However, if such datasets were to become available in the future, our approach could be used directly to identify candidate complete receptor sequences there. The idea would be the same: the presence of shared TCR α chains, or β chains, or paired α β clonotypes with low recombination probability in many patients is the consequence of clonal expansion after recognition of the same antigenic peptide, and paired TCRbeta-TCRalpha datasets would allow us to retrieve the partner α chain (for TCRbeta condition-associated clonotypes, and vice versa for TCRalpha analysis) from each donor, yielding several complete α/β candidate receptors.</p><p>We also believe that even single condition-associated TCRbeta or TCRalpha chain sequences could be useful for diagnostic purposes, as was demonstrated by (Emerson et al., 2017) for CMV-associated TCRbeta clonotypes.</p><p>We have added the following text to the Discussion section to emphasize that single receptor chain does not fully determine TCR specificity. We also reference recently emerged methods to identify the second receptor chain, and to determine specificity of the complete α/β TCR, which might be useful in combination with our approach:</p><p>“Our approach can be used on other hypervariable receptor chains (TCR α, BCR heavy and light chains), as well as other species (mice, fish, etc.). […] As paired sequencing becomes more widespread, our method can be extended to the analysis of full paired TCR by applying the exact same analysis using the joint recombination probability of α β clonotypes.”</p><disp-quote content-type="editor-comment"><p>In summary, this is a method to identify outlier populations, for which retrospective data can be superimposed to create a snapshot of an immune response that has already been described using for example pMHC tetramers or other methods.</p></disp-quote></body></sub-article></article>