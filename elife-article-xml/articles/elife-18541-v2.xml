<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">18541</article-id><article-id pub-id-type="doi">10.7554/eLife.18541</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Selecting the most appropriate time points to profile in high-throughput studies</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-59518"><name><surname>Kleyman</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-61253"><name><surname>Sefer</surname><given-names>Emre</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-61254"><name><surname>Nicola</surname><given-names>Teodora</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-61255"><name><surname>Espinoza</surname><given-names>Celia</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-61256"><name><surname>Chhabra</surname><given-names>Divya</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-61257"><name><surname>Hagood</surname><given-names>James S</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-61258"><name><surname>Kaminski</surname><given-names>Naftali</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-61259"><name><surname>Ambalavanan</surname><given-names>Namasivayam</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-4674"><name><surname>Bar-Joseph</surname><given-names>Ziv</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3430-6051</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Machine Learning and Computational Biology</institution>, <institution>School of Computer Science, Carnegie Mellon University</institution>, <addr-line><named-content content-type="city">Pittsburgh</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Division of Neonatology, Department of Pediatrics</institution>, <institution>University of Alabama at Birmingham</institution>, <addr-line><named-content content-type="city">Birmingham</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Division of Respiratory Medicine, Department of Pediatrics</institution>, <institution>University of California</institution>, <addr-line><named-content content-type="city">San Diego</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution>CARady Children’s Hospital San Diego</institution>, <addr-line><named-content content-type="city">San Diego</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Section of Pulmonary, Critical Care and Sleep Medicine</institution>, <institution>School of Medicine, Yale University</institution>, <addr-line><named-content content-type="city">New Haven</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Kundaje</surname><given-names>Anshul</given-names></name><aff id="aff6"><institution>Stanford University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>zivbj@cs.cmu.edu</email></corresp><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>26</day><month>01</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e18541</elocation-id><history><date date-type="received"><day>06</day><month>06</month><year>2016</year></date><date date-type="accepted"><day>23</day><month>01</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Kleyman et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Kleyman et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-18541-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.18541.001</object-id><p>Biological systems are increasingly being studied by high throughput profiling of molecular data over time. Determining the set of time points to sample in studies that profile several different types of molecular data is still challenging. Here we present the Time Point Selection (<italic>TPS</italic>) method that solves this combinatorial problem in a principled and practical way. <italic>TPS</italic> utilizes expression data from a small set of genes sampled at a high rate. As we show by applying <italic>TPS</italic> to study mouse lung development, the points selected by <italic>TPS</italic> can be used to reconstruct an accurate representation for the expression values of the non selected points. Further, even though the selection is only based on gene expression, these points are also appropriate for representing a much larger set of protein, miRNA and DNA methylation changes over time. TPS can thus serve as a key design strategy for high throughput time series experiments. Supporting Website: <ext-link ext-link-type="uri" xlink:href="http://www.sb.cs.cmu.edu/TPS">www.sb.cs.cmu.edu/TPS</ext-link></p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.001">http://dx.doi.org/10.7554/eLife.18541.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>experimental design</kwd><kwd>time point selection</kwd><kwd>lung developement</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>U01 HL122626</award-id><principal-award-recipient><name><surname>Bar-Joseph</surname><given-names>Ziv</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The Time Point Selection (or TPS) method is a general protocol for determining sampling rates for high throughout time series biological studies, that is efficient, cheap, scalable and works well for several different types of molecular data.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Time series experiments are very commonly used to study a wide range of biological processes. Examples include various developmental processes (<xref ref-type="bibr" rid="bib40">Roy et al., 2010</xref>), stem cell differentiation (<xref ref-type="bibr" rid="bib50">Sperger et al., 2003</xref>), immune responses (<xref ref-type="bibr" rid="bib62">Yosef and Regev, 2011</xref>), stress responses (<xref ref-type="bibr" rid="bib20">Gitter et al., 2013</xref>) and several others. Indeed, analysis of the largest repository of gene expression experiments, the Gene Expression Omnibus (GEO), determined that roughly a third of these datasets come from experiments profiling dynamic processes over time (<xref ref-type="bibr" rid="bib64">Zinman et al., 2013</xref>).</p><p>While mRNA gene expression data have been the primary source of high-throughput time series data, more recently several other genomic regulatory features are profiled over time. These include miRNA expression data (<xref ref-type="bibr" rid="bib42">Schulz et al., 2013</xref>), ChIP-Seq studied to determine TF targets (<xref ref-type="bibr" rid="bib13">Chang et al., 2013</xref>) and several types of epigenetic markers including DNA methylation (<xref ref-type="bibr" rid="bib47">Singer et al., 2014</xref>), histone modifications (<xref ref-type="bibr" rid="bib35">Paige et al., 2012</xref>) and more. In fact, with the rise in our ability to perform such high-throughput time series analysis, many researchers are now combining a few or several of these time series profiling experiments in a single experiment (<xref ref-type="bibr" rid="bib13">Chang et al., 2013</xref>; <xref ref-type="bibr" rid="bib11">Buenrostro et al., 2015</xref>) and then integrate these datasets to obtain a better understanding of cellular activity.</p><p>While integrated analysis of high-throughput genomic datasets can greatly improve our ability to model biological processes and systems, it comes at a cost. From the monetary point of view, these costs include the increased number of Seq experiments required to profile all types of genomic features. While such costs are common to all types of studies utilizing high-throughput data, they can be prohibitively high for time series based studies since they are multiplied by the number of time points required, the number of repeats performed for each time point and the number of different types of data being profiled. Importantly, even if the budget is not an issue, the ability to obtain enough samples for profiling all genomic features at all time points may be challenging, if not completely prohibitive.</p><p>One of the key determinants of the experimental and sample acquisition costs associated with time series studies is the number of time points that are being profiled. In most studies, the first and last time point can usually be determined by the researcher (for example, the time from birth to full lung structural development and maturation in mice). However, the number of samples required between these two points and the sampling frequency (given a fixed budget) are often hard to determine based on phenotypic observations since the molecular events of interest may precede such phenotypic events. To date, sampling rates have largely been determined using one of two ad-hoc protocols. The first utilized uniform sampling across the duration of the study (<xref ref-type="bibr" rid="bib29">Li et al., 2013</xref>) with the number of samples constrained by the available budget and samples. The second relied on some (conceived or real) knowledge of the process, often based on phenotypic observations. These studies, especially for responses though also for development, have often used nonuniform sampling (<xref ref-type="bibr" rid="bib42">Schulz et al., 2013</xref>; <xref ref-type="bibr" rid="bib3">Bar-Joseph et al., 2003a</xref>) though it is hard to determine if such sampling misses important molecular events between the sampled points.</p><p>Relatively, little work has focused so far on the selection of time points to sample in high throughput time series studies. Singh et al (<xref ref-type="bibr" rid="bib48">Singh et al., 2005</xref>) and Rosa et al (<xref ref-type="bibr" rid="bib39">Rosa et al., 2012</xref>) presented an iterative process which starts with profiling a small number of time points and then selects the next time point either based on an Active Learning method (<xref ref-type="bibr" rid="bib48">Singh et al., 2005</xref>) or based on using prior related experiments (<xref ref-type="bibr" rid="bib39">Rosa et al., 2012</xref>). Next the selected point is profiled and the process is repeated until a stopping criteria has been reached. Both of these methods require several iterations until the final time series is profiled, which can drastically lengthen the experiment time and can introduce additional biases making them less useful in practice. In addition, these methods employ a stopping criteria that does not take into account the full profile and also require that related time series expression experiments be used to select the point, which may be problematic when studying new processes or treatments.</p><p>Here, we propose the first non iterative method to address the issue of sampling rates across all different genomic data types. Our method starts by selecting a small set of genes that are known to be associated with the process being studied (while the full set is often unknown, for most processes a small set is usually known in advance). Next, we use a cheap array-based technology to sample these genes at a high, uniform rate across the duration of the study. Note that unlike standard curve fitting algorithms, a method for selecting time points for these experiments is required to accommodate over a hundred curves (for all genes) simultaneously, and we discuss various ways to formulate this as an optimization problem. To solve this optimization problems, we developed the Time Points Selection method (<italic>TPS</italic>), an algorithm that uses spline based analysis and combinatorial search to select a subset of the points that, when combined, provide enough information for reconstructing the values for all genes across all time points. The number of points selected can either be set in advance by the user (for example, based on budget constraints) or can be defined as a function of the reconstruction error. The selected time points are then used for the larger, genome-wide experiments across the different types of data being profiled.</p><p>To test and evaluate the method we applied it to study lung development in mice. Normal development of lung alveoli through the process of alveolar septation is a dynamic, coordinated process that requires the accurate spatial and temporal integration of signals. We currently lack a comprehensive understanding of the dynamic networks that govern normal alveolar septation. Thus, lung development can serve as an ideal test case for TPS since a variety of different time series genomic datasets are needed to enable accurate reconstruction of networks regulating this process. As we show, <italic>TPS</italic> was able to successfully identify time points for reconstructing the mRNA profiles of selected genes and these points improved upon uniform based sampling for such points. Further, we show that the set of points selected based on the analysis of this limited set of highly sampled mRNAs is also appropriate for sampling a much larger, unbiased, set of miRNA profiles as well as to determine the temporal protein levels of over 1000 proteins. Finally, we show that the mRNA samples can also be used to determine the optimal sampling points for a DNA methylation study of the same developmental process.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The time points selection (<italic>TPS</italic> ) method</title><p>We developed <italic>TPS</italic> to select a subset of <inline-formula><mml:math id="inf1"><mml:mi>k</mml:mi></mml:math></inline-formula> time points from an initial larger set of <inline-formula><mml:math id="inf2"><mml:mi>n</mml:mi></mml:math></inline-formula> points such that the selected subset provides an accurate, yet compact, representation of the temporal trajectory. <xref ref-type="fig" rid="fig1">Figure 1</xref> presents an overview of the method. <italic>TPS</italic> utilizes splines to represent temporal profiles and implements a cross-validation strategy to evaluate potential sets of points. Following initialization which is based on the expression values, we employ a greedy search procedure that adds and removes points until a local minima is reached (Materials and methods). The resulting set is then used for the larger genomic and epigenetic experiments.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.002</object-id><label>Figure 1.</label><caption><title>The TPS method.</title><p>Clockwise from top left. Given a dense sampling of a selected subset of genes (<bold>a</bold>) we select an initial set of points (<bold>b</bold>) using the initialization method described in the text. Next, we fit a spline to the selected points for each gene (<bold>c</bold>) and evaluate the error on all other points. We perform a greedy search process (<bold>d</bold>) which iteratively removes and adds points to improve the test data fit resulting in the final set of points (<bold>e</bold>). The reconstructed curves are fitted to all genes (<bold>f</bold>) and an overall error is computed and compared to the theoretical limit (noise) to determine the ability of the selected number of points to fit the data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.002">http://dx.doi.org/10.7554/eLife.18541.002</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Comparison of performance between TPSand a previous method Singh et al.</title><p>(<xref ref-type="bibr" rid="bib48">Singh et al., 2005</xref>) which used an active learning method based on dynamic programming.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.003">http://dx.doi.org/10.7554/eLife.18541.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig1-figsupp1-v2"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Comparison of initialization methods to each other by their final error.</title><p>The points labeled metricA, metricB, and metricC all use the dynamic initialization approaches, while the max distance points use static initialization.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.004">http://dx.doi.org/10.7554/eLife.18541.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig1-figsupp2-v2"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.005</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Comparison of initialization method by their final error compared to selecting random points.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.005">http://dx.doi.org/10.7554/eLife.18541.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig1-figsupp3-v2"/></fig></fig-group></p><p>To test the usefulness of <italic>TPS</italic> , we used it to determine time points for a lung development study in mice. We first profiled the expression of 126 genes known or suspected to be involved in lung development using NanoString (See Appendix Methods for a list of the selected genes and the reason each was selected). We then used <italic>TPS</italic> analysis of these experiments to select a subset of time points for profiling the expression of a larger, unbiased, set of miRNAs. Finally, we have used <italic>TPS</italic> to design time series experiments to study DNA methylation patterns for a subset of the genes.</p></sec><sec id="s2-2"><title><italic>TPS</italic> identifies subset of important time points across multiple genes</title><p>We have tested the performance of <italic>TPS</italic> by using it to select subsets of points ranging from 3 to 25 and evaluating how well these can be used to determine the values of non-sampled points. To determine the accuracy of the reconstructed profiles using the selected points, we computed the average mean squared error for points that were not used by the method (Materials and methods). The results are presented in <xref ref-type="fig" rid="fig2">Figure 2</xref>. The figure includes a comparison of our method with two baseline methods: a random selection of the same number of points and uniform sampling of points within the range being studied, a method that is commonly used for time series expression profiling as discussed above. We have also compared the performance of the different strategies for initializing the set of points as discussed in Appendix Method (sorting by absolute differences or by equal partition) and between different methods for searching for the optimal subset (simulated annealing, weighting genes by cluster size, and adding/removing multiple time points per iteration, Appendix Methods). Finally, <xref ref-type="fig" rid="fig2">Figure 2</xref> also presents the repeat noise values which is the theoretical limit for the performance of any profile reconstruction method.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.006</object-id><label>Figure 2.</label><caption><title>Performance of TPS using different sizes for the selected points.</title><p>Error comparisons of TPS variants to uniform selection of points and noise. Absolute difference - Greedy iterative addition with absolute difference initialization (Algorithm 1, Appendix Methods). Simulated annealing - Iterating using simulated annealing with absolute difference initialization. Weighted error - Selection based on cluster rather than individual gene errors. See Appendix Methods for details.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.006">http://dx.doi.org/10.7554/eLife.18541.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.007</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Average noise in each mRNA expression time point.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.007">http://dx.doi.org/10.7554/eLife.18541.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig2-figsupp1-v2"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.008</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Comparison of error for the TPS algorithm on full data, 75% random data, and random points chosen on the full data.</title><p>The 75% random data was created by replacing 75% of the gene time series with random value time series selected from a Gaussian distribution with mean 0 and standard deviation equal to the noise of the original data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.008">http://dx.doi.org/10.7554/eLife.18541.008</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig2-figsupp2-v2"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.009</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Comparison of TPS and piecewise linear fitting over genes (<bold>a</bold>) <italic>Pdgfra</italic>, (<bold>b</bold>)<italic>Eln</italic>, (<bold>c</bold>) <italic>Lrat</italic>.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.009">http://dx.doi.org/10.7554/eLife.18541.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig2-figsupp3-v2"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.010</object-id><label>Figure 2—figure supplement 4.</label><caption><title>Comparison of the reconstruction error when using the points selected by TPS and when using the same number of random points from the overall set of sampled points.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.010">http://dx.doi.org/10.7554/eLife.18541.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig2-figsupp4-v2"/></fig></fig-group></p><p>As expected, we find significant performance improvement when using <italic>TPS</italic> when compared to randomly selected points. Importantly, we also see a significant and consistent improvement (for all sizes of selected time points) over uniform sampling highlighting the advantage of condition-specific sampling decisions. Sorting initial points by absolute values further improves the performance highlighting the importance of initialization when searching large combinatorial spaces. Simulated annealing, weighting, and multiple point selection improve performance as well. As the number of points used by <italic>TPS</italic> increases, it leads to results that are very close to the error represented by noise in the data (0.108) ( <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p><xref ref-type="fig" rid="fig3">Figure 3</xref> presents the reconstructed and measured expression values when using <italic>TPS</italic> to select <inline-formula><mml:math id="inf3"><mml:mn>13</mml:mn></mml:math></inline-formula> time points (less than a third of the points that were profiled). Note that even though each of these genes has distinct trajectory and inflection points, the selected set of time points enable <italic>TPS</italic> to fit all quite accurately without overfitting (See <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> for figures of several other genes and for figures reconstructed by using the best 8 time points as determined by <italic>TPS</italic> , respectively).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.011</object-id><label>Figure 3.</label><caption><title>Reconstructed expression profiles for selected genes.</title><p>(<bold>a</bold>). Pdgfra. , (<bold>b</bold>). Eln. , (<bold>c</bold>). Inmt.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.011">http://dx.doi.org/10.7554/eLife.18541.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.012</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Expression profiles over several genes (<bold>a</bold>) <italic>Esr2</italic>, (<bold>b</bold>) <italic>Nme3</italic>, (<bold>c</bold>) <italic>Polr2a</italic>.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.012">http://dx.doi.org/10.7554/eLife.18541.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig3-figsupp1-v2"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.013</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Reconstructed expression proles by eight points over genes (<bold>a</bold>) <italic>Pdgfra</italic>, (<bold>b</bold>) <italic>Eln</italic>, (<bold>c</bold>) <italic>Inmt</italic>.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.013">http://dx.doi.org/10.7554/eLife.18541.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig3-figsupp2-v2"/></fig></fig-group></p></sec><sec id="s2-3"><title>Identified time points using mRNA data are appropriate for miRNA profiling</title><p>To test the usefulness of our method for predicting the correct sampling rates for other genomic datasets, we next profiled mouse miRNAs for the same developmental process. miRNAs have been known to regulate lung development (<xref ref-type="bibr" rid="bib44">Sessa and Hata, 2013</xref>) and several miRNAs are differentially expressed during this developmental process (<xref ref-type="bibr" rid="bib60">Williams et al., 2007</xref>). Several of these are also coordinately activated with various TFs to control specific transitions during development (<xref ref-type="bibr" rid="bib42">Schulz et al., 2013</xref>). Thus, any large scale effort to model lung development would require the profiling of miRNAs as well. Unlike the mRNA dataset, which utilized prior knowledge to profile less than 1% of all genes, the miRNA dataset contained a much larger number of miRNAs (<inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mn>6</mml:mn><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). Thus, the miRNA data represent an unbiased sample providing information on whether using one type of genomic data can be helpful for determining rates for other types. In our analysis, we normalized miRNA values by variance mean normalization (<xref ref-type="bibr" rid="bib8">Bolstad et al., 2003</xref>).</p><p>To test <italic>TPS</italic> on this dataset, we used the <italic>mRNA</italic> expression data to select time points and then used the miRNA expression values for the selected time points to reconstruct the complete trajectories for each miRNA. The results are presented in <xref ref-type="fig" rid="fig4">Figure 4</xref>. As can be seen, when using the points selected based on the mRNA data we achieve a much lower error when compared to the error resulting from using the same number of uniform or random points (<inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> for random based on randomization analysis) highlighting the relationship between the two datasets and the ability to use one to determine points for the other. More generally, even though the noise in the miRNA data is higher than for the mRNA dataset, relative ordering of the performance of each of the methods is similar to the mRNA results in <xref ref-type="fig" rid="fig2">Figure 2</xref>. This serves as a strong indication that mRNAs can serve as a general proxy for selecting time points for other genomic datasets. <xref ref-type="fig" rid="fig4">Figure 4b</xref> presents the error achieved when using the miRNA data itself to select the set of points (evaluated on the miRNA data). As expected, the performance when using the miRNA data itself is better than when using the mRNA data. However, when taking into account the inherent noise in the data the differences are not large. For example, when using the 13 selected mRNA points, the average mean squared error is 0.4312 whereas when using the optimal points based on the miRNA data itself the error is 0.4042.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.014</object-id><label>Figure 4.</label><caption><title>Performance of TPS by on the miRNA data.</title><p>(<bold>a</bold>) TPS reconstruction error when using the mRNA data to select time points for the miRNA experiments. Results of random and uniform selection as well as repeat noise error are also presented for comparison. TPS variants shown are the same two presented in <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>b</bold>) Error of splines with points selected by training TPS on the actual miRNA data itself, using the maximum absolute difference initialization.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.014">http://dx.doi.org/10.7554/eLife.18541.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.015</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Observed and reconstructed expression proles for miRNAs (<bold>a</bold>) <italic>mmu-miR-100</italic>, (<bold>b</bold>) <italic>mmu-miR-136</italic>,c) <italic>mmu-miR-15</italic>2, (<bold>d</bold>) <italic>mmu-miR-219</italic>.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.015">http://dx.doi.org/10.7554/eLife.18541.015</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig4-figsupp1-v2"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.016</object-id><label>Figure 4—figure supplement 2.</label><caption><title>8 stable miRNA clusters.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.016">http://dx.doi.org/10.7554/eLife.18541.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig4-figsupp2-v2"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.017</object-id><label>Figure 4—figure supplement 3.</label><caption><title>TPS performance for the proteomics data using different number of time points.</title><p>(<bold>a</bold>) Comparison of the reconstruction error when using the points selected by TPS, uniform selection of points, and when using the same number of random points from the overall set of sampled points. (<bold>b</bold>) Error comparisons of TPSto noise, and various search and initialization options discussed in Methods.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.017">http://dx.doi.org/10.7554/eLife.18541.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig4-figsupp3-v2"/></fig></fig-group></p><p><xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> presents the reconstructed and measured expression values for a few miRNAs based on time points identified using the mRNA dataset. As with the mRNA data, the ability to accurately reconstruct different miRNA profiles highlights the importance of selecting a global set of points that can fit all genes and miRNAs in our study.</p><p>We have also analyzed the performance of <italic>TPS</italic> when using the mRNA data to select sampling time points for profiling the levels of more than 1000 proteins. We observed results that are very similar to the results obtained for the miRNA time point selection. Specifically, the points selected by TPS lead to reconstruction errors that are lower than those observed for uniform sampling or for a random set of the same number of points further demonstrating the general applicability of our method. See Appendix Results for details.</p></sec><sec id="s2-4"><title>Using <italic>TPS</italic> to select time points for DNA methylation analysis</title><p>In addition to mRNA and miRNA expression data, epigenetic data have been increasingly studied in time series experiments (<xref ref-type="bibr" rid="bib54">Talens et al., 2010</xref>; <xref ref-type="bibr" rid="bib41">Schneider et al., 2010</xref>). To test the ability of the mRNA data to determine the appropriate points for DNA methylation analysis, we used targeted bisulfite sequencing to profile three CpG-enriched regions for <inline-formula><mml:math id="inf6"><mml:mn>13</mml:mn></mml:math></inline-formula> genes at <inline-formula><mml:math id="inf7"><mml:mn>8</mml:mn></mml:math></inline-formula> of the <inline-formula><mml:math id="inf8"><mml:mn>42</mml:mn></mml:math></inline-formula> time points used for the mRNA and miRNA studies (Materials and methods). We next applied TPS to the mRNA data of these <inline-formula><mml:math id="inf9"><mml:mn>8</mml:mn></mml:math></inline-formula> points to select the best subest of <inline-formula><mml:math id="inf10"><mml:mn>4</mml:mn></mml:math></inline-formula> points and compared the selected points to those that would have been selected using the methylation data itself. The <inline-formula><mml:math id="inf11"><mml:mn>4</mml:mn></mml:math></inline-formula> points identified using the mRNA data (<inline-formula><mml:math id="inf12"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf13"><mml:mn>5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf14"><mml:mn>15</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf15"><mml:mn>26</mml:mn></mml:math></inline-formula>) were exactly the same as the ones selected using the methylation data indicating again that mRNA data is a good proxy for the dynamics of the epigenetic data as well. <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> presents the reconstructed splines over the identified points for several genomic methylation loci. <xref ref-type="fig" rid="fig5">Figure 5</xref> presents the methylation and expression curves for <inline-formula><mml:math id="inf16"><mml:mn>3</mml:mn></mml:math></inline-formula> genes: <italic>Akt,1 Cdh11</italic>, and <italic>Tnc</italic>. These were the genes with the strongest negative correlation between their methylation and expression. As can be seen, in several cases we observed strong negative or positive correlations between the two datasets in the time points we used serving as another indication for the ability to use one dataset to select the sampling points for the other. See <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref> for correlation of all genes.<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.018</object-id><label>Figure 5.</label><caption><title>Comparison of gene expression and methylation data for selected genes.</title><p>(<bold>a</bold>). Akt1. , (<bold>b</bold>). Cdh11. , (<bold>c</bold>). Tnc.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.018">http://dx.doi.org/10.7554/eLife.18541.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.019</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Reconstructed methylation proles over several loci (chromosome, position) with corresponding genes.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.019">http://dx.doi.org/10.7554/eLife.18541.019</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig5-figsupp1-v2"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.020</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Bootstrap analysis of Pearson correlation r between expression and methylation datasets over eight time points for each gene.</title><p>The red circles are the Pearson correlation over all eight points and the blue triangles are the Pearson correlation for all subsets of 7 points.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.020">http://dx.doi.org/10.7554/eLife.18541.020</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig5-figsupp2-v2"/></fig></fig-group></p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Time series gene expression experiments are widely used in several studies. More recently, advances in sequencing and proteomics are enabling the profiling of several other types of genomic data over time. Here we focused on lung development in mice with the goal of identifying an optimal set of time points for profiling various genomic and proteomic data types for this process.</p><p>An important question is: Whether a better selection of time points really leads to observations that are missed when using an inferior set of points (even if the number of points is the same)? To answer this question we looked at several prior studies that profiled mouse lung development over time using various high throughput assays. <xref ref-type="table" rid="tbl1">Table 1</xref> presents <inline-formula><mml:math id="inf17"><mml:mn>9</mml:mn></mml:math></inline-formula> representative studies and lists the biological data that was profiled and the time points that were used. As can be seen, while certain time points seem to be widely used across studies (for example, 7d) others were profiled in only one or two of the studies (2d, 10d, three weeks). This raises several issues. First, it is very hard to compare or combine these datasets (for example, protein levels were not profiled on day <inline-formula><mml:math id="inf18"><mml:mn>7</mml:mn></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib15">Cox et al., 2007</xref>) whereas all mRNA levels were). It also makes it hard to determine if differences between DE genes or miRNAs between these studies are the result of differences in the underlying conditions studied (for example, when testing for mutants or treatments) or simply the result of different sampling. Finally, each of these studies may have missed key genes, proteins or miRNAs because of the sampling used restricting the ability of downstream analysis to use the data to model causal and regulatory events in lung development.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.021</object-id><label>Table 1.</label><caption><p>Summary of prior high throughput lung development studies.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.021">http://dx.doi.org/10.7554/eLife.18541.021</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Reference</th><th>Data types</th><th>Selected time points (Days)</th></tr></thead><tbody><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib9">Bonner et al., 2003</xref>]</p> </td><td valign="top"><p>mRNA expression</p> </td><td valign="top"><p>E9, E4, E17, 0, 7, 14, 28</p> </td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib33">Melén et al., 2011</xref>]</p> </td><td valign="top"><p>mRNA expression</p> </td><td valign="top"><p>E16, E18, 0, 7, 14, 28</p> </td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib6">Bhaskaran et al., 2009</xref>]</p> </td><td valign="top"><p>microRNA expression</p> </td><td valign="top"><p>E16, E19, E21, 0, 6, 14, 60</p> </td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib18">Dong et al., 2011</xref>]</p> </td><td valign="top"><p> mRNA and microRNA expression</p> </td><td valign="top"><p>E12, E14, E16, 0, 2, 10</p> </td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib15">Cox et al., 2007</xref>]</p></td><td valign="top"><p>Protein expression levels</p></td><td valign="top"><p>E12, E14, E18, 2, 14, 56</p></td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib42">Schulz et al., 2013</xref>]</p> </td><td valign="top"><p> mRNA and miRNA expression</p> </td><td valign="top"><p>0, 4, 7, 14, 42</p> </td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib14">Cormack et al., 2010</xref>]</p> </td><td valign="top"><p> mRNA expression</p> </td><td valign="top"><p>0, 7, 14, adult</p> </td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib30">Mager et al., 2007</xref>]</p> </td><td valign="top"><p> mRNA expression</p> </td><td valign="top"><p> E15, E17, E19, E21, 1, 14, 84</p> </td></tr><tr><td valign="top"><p>[<xref ref-type="bibr" rid="bib31">Mariani et al., 2002</xref>]</p> </td><td valign="top"><p> mRNA expression</p> </td><td valign="top"><p>E18, 1, 4, 7, 10, 14, 21, adult</p> </td></tr></tbody></table></table-wrap></p><p>To illustrate these problems we compared the resulting curves using three of the sampling rates from <xref ref-type="table" rid="tbl1">Table 1</xref> to the reconstructed curves obtained by using TPS to select the optimal <inline-formula><mml:math id="inf19"><mml:mn>5</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf20"><mml:mn>8</mml:mn></mml:math></inline-formula> time points. For example, the points selected by <xref ref-type="bibr" rid="bib42">Schulz et al. (2013)</xref> are 0, <inline-formula><mml:math id="inf21"><mml:mn>4</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mn>7</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf23"><mml:mn>14</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf24"><mml:mn>28</mml:mn></mml:math></inline-formula> (since <inline-formula><mml:math id="inf25"><mml:mn>28</mml:mn></mml:math></inline-formula> is last day in our analysis we used it instead of <inline-formula><mml:math id="inf26"><mml:mn>42</mml:mn></mml:math></inline-formula>). In contrast, TPS selects <inline-formula><mml:math id="inf27"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf28"><mml:mn>6</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf29"><mml:mn>9.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf30"><mml:mn>19</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:mn>28</mml:mn></mml:math></inline-formula>. As can be seen in <xref ref-type="fig" rid="fig6">Figure 6</xref>, important expression changes in key genes are missed by using the arbitrary points while the TPS points are able to correctly reconstruct these profiles even though the total number of points is the same (<inline-formula><mml:math id="inf32"><mml:mn>5</mml:mn></mml:math></inline-formula>). More globally, the error for the arbitrary set of selected points is much higher on average (<xref ref-type="table" rid="A2-tbl4">Appendix 2—Table 4</xref>). Similar results are obtained for the other sampling rates used in the past (<xref ref-type="fig" rid="fig6">Figure 6</xref>, <xref ref-type="table" rid="A2-tbl4">Appendix 2—Table 4</xref>) and when comparing TPS to iterative methods previously suggested for selecting the set of points to profile (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). This indicates that accurate selection of time points can have a large impact on the ability of the study to identify key genes and events. See also Appendix Results for a discussion about the importance of the differences between the TPS and prior work results for selected genes.<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.022</object-id><label>Figure 6.</label><caption><title>Comparison of TPS with sampling rates used in previous studies.</title><p>Dark green curves are the reconstructed profiles based on the points profiled by prior studies. Light green and red curves are based on the points selected by TPS . As can be seen, even when comparing results from using the same number of points, TPS can identify key events for some of the genes that are missed when using the phenotype based sampling rates. Subfigures a,b, and c are a piecewise linear ﬁt over points 0.5, 7.0, 14.0, 28.0 . Subfigures d,e, and f are a piecewise linear fit over points 0.5, 2.0, 14.0, 28.0. Subfigures g,h, and i are a piecewise linear fit over points 0.5, 4.0, 7.0, 14.0, 28.0.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.022">http://dx.doi.org/10.7554/eLife.18541.022</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig6-v2"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.18541.023</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Comparison of gene expression and protein abundance for selected gene protein pairs.</title><p>(<bold>a</bold>) <italic>Eln/P54320</italic>, (<bold>b</bold>) <italic>F13a1/Q8BH61</italic>, (<bold>c</bold>) <italic>Chil1/Q61362</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.023">http://dx.doi.org/10.7554/eLife.18541.023</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-18541-fig6-figsupp1-v2"/></fig></fig-group></p><p>Our method relies on a very small subset of genes that are known to be involved in the process studied for the initial (highly sampled) set of experiments. While such set is known for several processes, there may be cases where very little is known about the biological process and so it may be hard to obtain such set. TPS can still be applied to determine sampling rates for such processes using a small <italic>random</italic> set of genes. To illustrate this we repeated the analysis presented in Results using only the measured values of 25% of genes in our original set and replacing the values for the other genes with random profiles. As we show in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, even when using such set, the time points selected by TPS greatly improve upon an arbitrary set of the same number of time points. Since in most time series experiments at least 25% of the genes are differentially expressed (and in several cases a much larger fraction, (<xref ref-type="bibr" rid="bib63">Zhou et al., 2009</xref>; <xref ref-type="bibr" rid="bib46">Shi et al., 2015</xref>) a random selection of genes is likely to exhibit similar results even for poorly understood processes.</p><p>Beyond the analysis of a specific type of data, several studies have now been profiling multiple types of genomic data over time. Such studies need to agree on a set of time points which would be common to all experiments so that these diverse types can be integrated to form a unified model (<xref ref-type="bibr" rid="bib13">Chang et al., 2013</xref>; <xref ref-type="bibr" rid="bib40">Roy et al., 2010</xref>). To date, the selection of such points relied on ad-hoc methods. The processes being studied were either sampled uniformly or based on prior knowledge. However, known properties of such systems were often been based on phenotypic observations which may not necessarily agree with the timing of molecular events. In addition, in many case studies of the same, or similar processes differed with respect to the time points that have been profiled. For example, early work on the analysis of cell cycle data in yeast utilized both uniform and nonuniform sampling (<xref ref-type="bibr" rid="bib49">Spellman et al., 1998</xref>) and recent studies of circadian rhythms have followed a similar pattern (<xref ref-type="bibr" rid="bib51">Storch et al., 2002</xref>; <xref ref-type="bibr" rid="bib57">Ueda et al., 2002</xref>). Similarly, more recent analysis of responses to flu diverged widely in the (nonuniform) sampling rates that were used (<xref ref-type="bibr" rid="bib45">Shapira et al., 2009</xref>; <xref ref-type="bibr" rid="bib28">Li et al., 2011</xref>).</p><p><italic>TPS</italic> addresses these problems by using a principled method for determining sampling rates. An important goal in the development of <italic>TPS</italic> was to enable it to be successfully applied to different types of biological datasets. As we show, a relatively inexpensive, gene centric, method provides a very good solution for RNA expression profiling as well as other types of data including miRNAs and DNA methylation. Thus, a combined experiment can be fully designed using our method.</p><p>While we evaluated TPS on several types of high throughput data, we have only tested it so far on data for a specific biological process (lung development in mice). While we believe that such data is both challenging and representative and thus provides a good test case for the method, analysis of additional datasets may identify new challenges that we have not addressed and we leave it to future work to address these.</p><p>TPS, including all initialization methods discussed, is implemented in Python and is available on the supporting website. We hope that as sequencing technology continues to advance, more and more studies would integrate diverse types of time series data and will utilize <italic>TPS</italic> in the design pipeline of their studies.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>mRNA and miRNA used in the study</title><p>To select the list of 126 genes used in the NanoString profiling we searched the literature for genes that have been linked to the following processes: (a) Cell type specification genes (e.g. alveolar type I epithelial, alveolar type II epithelial, any epithelial, basal, endothelial, mesenchymal, pericyte, fibroblast, monocyte), (b) genes known to be up or down regulated during septation, (c) genes known to be altered in DNA methylation during development, (d) genes known to be involved in septation, (e) genes known to be regulated by miRNA involved in septation, and (f) genes known to be regulated by DNA methylation during fibrosis. <xref ref-type="table" rid="A2-tbl1">Appendix 2—Table 1</xref> contains a list of the selected genes and the process for which they were selected.</p><p>For the miRNA set we used a commercially available, unbiased, array (the nCounter Mouse miRNA Expression Assay Kit, NanoString).</p></sec><sec id="s4-2"><title>mRNA and miRNA profiling and analysis</title><p>A total of 240 samples were isolated by Laser Capture Microscopy (LCM) from murine lung at multiple time points (E16.5, P.05 to P14 every 12 hr, and P15 to P28 every 24 hr). The samples were used to prepare total RNA. RNA extraction was performed by miRNeasy MicroKit (Qiagen) following the manufacturer’s protocol. RNA concentration and integrity were measured by using NanoDrop ND-2000 and 2200 Tape Station. A custom NanoString probe set (Reporter Code set and Capture Probe set) for 126 genes was designed and the nCounter Gene Expression Assay was performed using 50 ng total RNA. The data files produced by the nCounter Digital Analyzer were exported as a Reporter Code Count (RCC) file and data normalization was performed using the nSolver, the analysis software provided by Nanostring.</p></sec><sec id="s4-3"><title>DNA methylation analysis</title><p>Mouse alveolar lung tissues attached to LCM caps were stored at −80°C until processing. DNA was extracted using the ZR Genomic DNA-Tissue MicroPrep kit (Zymo Research). Incubation with Digestion buffer and proteinase K was done overnight at 55°C in inverted tubes. 13 genes were chosen for targeted NextGen bisulfite sequencing (NGBS): <italic>Igfbp3, Wif1, Cdh11, Eln, Sox9, Tnc, Dnmt3a, Akt, Vegfa, Lox, Foxf2, Zfp536</italic> and <italic>Src</italic>, based on published data (<xref ref-type="bibr" rid="bib16">Cuna et al., 2015</xref>). Targeted NGBS was done on samples collected at: E16.5, E18.5, P0.5, P1.5, P2.5, P5, P10, P15, P19 and P26. Multiplex PCR was performed using 0.5 units of TaKaRa EpiTaq HS (Takara Bio, Kusatsu, Japan) in 2x master mix. FASTQ files were aligned using open source Bismark Bisulfite Read Mapper using Bowtie2. Methylation levels were calculated in Bismark. Sites where the difference in methylation was less than 5% over the entire time period, those where there was a difference of &gt;20% at a single time point and those with less than <inline-formula><mml:math id="inf33"><mml:mn>3</mml:mn></mml:math></inline-formula> non zero values were removed from the analyses.</p></sec><sec id="s4-4"><title>Problem statement</title><p>Our goal is to identify a (small) subset of time points that can be used to accurately reconstruct the expression trajectory for <italic>all</italic> genes or other molecules being profiled. We assume that we can efficiently and cheaply obtain a dense sample for the expression of a very small subset of representative genes (here we use nanostring to profile less than 0.5% of all genes) and attempt to use this subset to determine optimal sampling points for the entire set of genes.</p><p>Formally, let <inline-formula><mml:math id="inf34"><mml:mi>G</mml:mi></mml:math></inline-formula> be the set of genes we have profiled in our dense sample, <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM5"><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM6"><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi id="XM3" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM7"><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> be the set of all sampled time points. We assume that for each time point we have <inline-formula><mml:math id="inf36"><mml:mi>R</mml:mi></mml:math></inline-formula> repeats for all genes. We denote by <inline-formula><mml:math id="inf37"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msubsup></mml:math></inline-formula> be the expression value for gene <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> in the <inline-formula><mml:math id="inf40"><mml:mi>r</mml:mi></mml:math></inline-formula>’th repeat for that time point. We define <inline-formula><mml:math id="inf41"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mpadded width="+1.7pt"><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msubsup></mml:mpadded><mml:mo rspace="4.2pt">,</mml:mo><mml:mi id="XM9">t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> as the complete data for gene <inline-formula><mml:math id="inf42"><mml:mi>g</mml:mi></mml:math></inline-formula> over all replicates and time points <inline-formula><mml:math id="inf43"><mml:mi>T</mml:mi></mml:math></inline-formula>.</p><p>To constrain the set of points we select, we assume that we have a predefined budget <inline-formula><mml:math id="inf44"><mml:mi>k</mml:mi></mml:math></inline-formula> for the maximum number of time points we can sample in the complete experiment (i.e. for profiling all genes, miRNAs, epigenetic marks etc. using high-throughput seq experiments). We are interested in selecting <inline-formula><mml:math id="inf45"><mml:mi>k</mml:mi></mml:math></inline-formula> time points from <inline-formula><mml:math id="inf46"><mml:mi>T</mml:mi></mml:math></inline-formula> which, when using only the data collected at these <inline-formula><mml:math id="inf47"><mml:mi>k</mml:mi></mml:math></inline-formula> points, minimizes the prediction error for the expression values of the unused points. To evaluate such a selection, we use the selected values to obtain a smoothing spline (<xref ref-type="bibr" rid="bib17">De Boor, 1978</xref>; <xref ref-type="bibr" rid="bib3">Bar-Joseph et al., 2003a</xref>; <xref ref-type="bibr" rid="bib58">Wahba, 1990</xref>) function for each gene and compare the predicted values based on the spline to the measured value for the non-selected points to determine the error. In our problem, <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> define the first and end points, so they are always selected. The rest of the points are selected to maximize the following objective 1:</p><p>Problem statement: <italic>Given <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>D</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> for genes <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula>, the number of desired time points <inline-formula><mml:math id="inf52"><mml:mi>k</mml:mi></mml:math></inline-formula>, identify a subset of <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> time points in <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∖</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM12"><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM13"><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which minimizes the prediction error for the expression values of all genes in the remaining time points.</italic></p></sec><sec id="s4-5"><title>Spline assignments</title><p>Before discussing the actual procedure we use to select the set of time points, we discuss the method we use to assign splines based on a selected subset of points for each gene. There are two issues that need to be resolved when assigning such smoothing splines: (1) The number of knots (control points) and (2) their spacing. Past approaches for using splines to model time series gene expression data have usually used the same number of control points for all genes regardless of their trajectories (<xref ref-type="bibr" rid="bib52">Subhani et al., 2010</xref>; <xref ref-type="bibr" rid="bib4">Bar-Joseph et al., 2003b</xref>), and mostly employed uniform knot placements. However, since our method needs to be able to adapt to any size of <inline-formula><mml:math id="inf55"><mml:mi>k</mml:mi></mml:math></inline-formula> as defined above, we also attempt to select the number of knots and their spacing. We do this by using a regularization parameter for the fitted cubic smoothing spline where number of knots is increased until the smoothing condition is satisfied (<xref ref-type="bibr" rid="bib58">Wahba, 1990</xref>). The regularization parameter is estimated by leave-one-out cross-validation (LOOCV).</p></sec><sec id="s4-6"><title><italic>TPS</italic> : Iterative process to select points</title><p>Because of the highly combinatorial nature of the time points, we rely on a greedy iterative process to select the optimal points as summarized in <xref ref-type="fig" rid="fig1">Figure 1</xref> (See Appendix Methods for pseudocode).</p><p>There are three key steps in this algorithm which we discuss in detail below.</p><list list-type="bullet"><list-item><p><italic>Selecting the initial set of points:</italic> When using an iterative algorithm to solve non-convex problems with several local minima, a key issue is the appropriate selection of the initial solution set (<xref ref-type="bibr" rid="bib23">Hartigan, 1975</xref>; <xref ref-type="bibr" rid="bib32">McLachlan and Peel, 2004</xref>)]. We have tested a number of methods for performing such initializations and results for some of these are presented in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>. Since the goal of the method is to optimize a specific function (error on the left out set of expression values measured at time points not used), all initialization methods can be tested for each dataset and the solution minimizing the left out error can be used. See Appendix Methods for details.</p></list-item><list-item><p><italic>Iterative improvement step:</italic> After selecting the initial set, we begin the iterative process of refining the subset of selected points. In this step we repeat the following analysis in each iteration. We exhaustively remove all points from the existing solution (one at a time) and replace it with all points that were not in the selected set (again, one at a time). For each pair of such point, we compute the error resulting from the change (using the splines computed based on the current set of points evaluated on the left out time points), and determine if the new point reduces the error or not. Formally, let <inline-formula><mml:math id="inf56"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>∖</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM16"><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM17"><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> be set of points for iteration <inline-formula><mml:math id="inf58"><mml:mi>n</mml:mi></mml:math></inline-formula>. We are interested in finding a point pair <inline-formula><mml:math id="inf59"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow id="XM18"><mml:msub><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM19"><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>∖</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> which minimizes the following error ratio for the next iteration <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>∖</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM21"><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo>∪</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM22"><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mtext> </mml:mtext><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mspace width="thinmathspace"/><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo>∖</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo>∖</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf61"><mml:msubsup><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:msubsup></mml:math></inline-formula> is our spline based estimate of the expression of gene <inline-formula><mml:math id="inf62"><mml:mi>g</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf63"><mml:mi>t</mml:mi></mml:math></inline-formula> by fitting smoothing spline over points <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>. If there are pairs which lead to an error ratio of less than <inline-formula><mml:math id="inf65"><mml:mn>1</mml:mn></mml:math></inline-formula> in the above function, we select the best (lowest error), assign it to <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and continue the iterative process. Otherwise we terminate the process and output <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> as the optimal solution. While the process is guaranteed to converge, given the large combinatorial search space convergence can be slow. This makes adequate initialization an important issue which we have focused on. In practice we find that the search usually converges very fast (within 10 – 15 iterations).</p></list-item><list-item><p><italic>Fitting smoothing spline:</italic> The third key step of our approach is fitting a smoothing spline to every gene independently for the selected subset of time points. As discussed above, this is done by using a regularized version of approximating splines which allow us to determine a unique number of control points and spacing for each of the genes. See Appendix Methods for more details.</p></list-item></list></sec><sec id="s4-7"><title>Individual vs. cluster-based evaluation</title><p>So far, we assumed that error of each gene has the same contribution to the overall error. However, this assumption ignores the fact that the expression profiles of genes are correlated with the expression of other genes. To take the correlation between gene profiles into account, we also performed cluster based evaluation of genes where we analyzed the error by weighting each gene in terms of inverse of the numbers of genes in the cluster it belongs. This scheme ensures that each cluster contributes equally to the resulting error rather than each gene. We find clusters by k-means algorithm over time series-data by treating each gene as a point in <inline-formula><mml:math id="inf68"><mml:msup><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> space as well as over a vector of randomly sampled <inline-formula><mml:math id="inf69"><mml:mi>T</mml:mi></mml:math></inline-formula> time points on fitted spline (<xref ref-type="bibr" rid="bib7">Bishop, 2006</xref>). We use Bayesian Information Criterion (BIC) to determine the optimal number of clusters (<xref ref-type="bibr" rid="bib43">Schwarz, 1978</xref>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgement</title><p>We thank the LungMAP consortium for useful comments regarding the methods and analysis presented in this paper. Work supported in part by NIH grant U01 HL122626.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>MK, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>ES, Conceptualization, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft</p></fn><fn fn-type="con" id="con3"><p>TN, Resources, Data curation, Investigation</p></fn><fn fn-type="con" id="con4"><p>CE, Resources, Data curation, Investigation</p></fn><fn fn-type="con" id="con5"><p>DC, Resources, Data curation, Investigation</p></fn><fn fn-type="con" id="con6"><p>JSH, Resources, Data curation, Investigation</p></fn><fn fn-type="con" id="con7"><p>NK, Resources, Data curation, Investigation</p></fn><fn fn-type="con" id="con8"><p>NA, Resources, Data curation, Investigation</p></fn><fn fn-type="con" id="con9"><p>ZB-J, Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: This study was performed in strict accordance with the recommendations in the Guide for the Care and Use of Laboratory Animals of the National Institutes of Health. All of the animals were handled according to approved institutional animal care and use committee (IACUC) protocols (APN 10042) of the University of Alabama at Birmingham. All lungs were isolated immediately following euthanasia using approved protocols.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.18541.024</object-id><label>Supplementary file 1.</label><caption><title>Raw mRNA expression values for the 126 genes studied using nanostring</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.024">http://dx.doi.org/10.7554/eLife.18541.024</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-18541-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.18541.025</object-id><label>Supplementary file 2.</label><caption><title>Raw miRNA expression values from the nanostring analysis.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.025">http://dx.doi.org/10.7554/eLife.18541.025</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-18541-supp2-v2.xlsx"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following dataset was generated:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://sb.cs.cmu.edu/TPS/data.html" source-id-type="uri"><collab>Kleyman M</collab><x>,</x> <collab>Sefer E</collab><x>,</x> <collab>Nicola T</collab><x>,</x> <collab>Espinoza C</collab><x>,</x> <collab>Chhabra D</collab><x>,</x> <collab>Hagood JS</collab><x>,</x> <collab>Kaminski N</collab><x>,</x> <collab>Ambalavanan N</collab><x>,</x> <collab>Joseph ZB</collab><x>,</x> <year>2016</year><x>,</x><source>miRNA Data of Mouse Lung Developement</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://sb.cs.cmu.edu/TPS/data.html">http://sb.cs.cmu.edu/TPS/data.html</ext-link><x>,</x> <comment>Publicly available at the Systems Biology Group, School of Computer Science, Carnegie Mellon University website</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agarwal</surname><given-names>V</given-names></name><name><surname>Bell</surname><given-names>GW</given-names></name><name><surname>Nam</surname><given-names>J-W</given-names></name><name><surname>Bartel</surname><given-names>DP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Predicting effective microRNA target sites in mammalian mRNAs</article-title><source>eLife</source><volume>4</volume><elocation-id>e05005</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.05005</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Ball</surname><given-names>CA</given-names></name><name><surname>Blake</surname><given-names>JA</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Butler</surname><given-names>H</given-names></name><name><surname>Cherry</surname><given-names>JM</given-names></name><name><surname>Davis</surname><given-names>AP</given-names></name><name><surname>Dolinski</surname><given-names>K</given-names></name><name><surname>Dwight</surname><given-names>SS</given-names></name><name><surname>Eppig</surname><given-names>JT</given-names></name><name><surname>Harris</surname><given-names>MA</given-names></name><name><surname>Hill</surname><given-names>DP</given-names></name><name><surname>Issel-Tarver</surname><given-names>L</given-names></name><name><surname>Kasarskis</surname><given-names>A</given-names></name><name><surname>Lewis</surname><given-names>S</given-names></name><name><surname>Matese</surname><given-names>JC</given-names></name><name><surname>Richardson</surname><given-names>JE</given-names></name><name><surname>Ringwald</surname><given-names>M</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Gene ontology: tool for the unification of biology</article-title><source>Nature Genetics</source><volume>25</volume><fpage>25</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1038/75556</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name><name><surname>Gerber</surname><given-names>GK</given-names></name><name><surname>Gifford</surname><given-names>DK</given-names></name><name><surname>Jaakkola</surname><given-names>TS</given-names></name><name><surname>Simon</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2003">2003a</year><article-title>Continuous representations of time-series gene expression data</article-title><source>Journal of Computational Biology</source><volume>10</volume><fpage>341</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1089/10665270360688057</pub-id><pub-id pub-id-type="pmid">12935332</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name><name><surname>Gerber</surname><given-names>G</given-names></name><name><surname>Simon</surname><given-names>I</given-names></name><name><surname>Gifford</surname><given-names>DK</given-names></name><name><surname>Jaakkola</surname><given-names>TS</given-names></name></person-group><year iso-8601-date="2003">2003b</year><article-title>Comparing the continuous representation of time-series expression profiles to identify differentially expressed genes</article-title><source>PNAS</source><volume>100</volume><fpage>10146</fpage><lpage>10151</lpage><pub-id pub-id-type="doi">10.1073/pnas.1732547100</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berriz</surname><given-names>GF</given-names></name><name><surname>King</surname><given-names>OD</given-names></name><name><surname>Bryant</surname><given-names>B</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><name><surname>Roth</surname><given-names>FP</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Characterizing gene sets with FuncAssociate</article-title><source>Bioinformatics</source><volume>19</volume><fpage>2502</fpage><lpage>2504</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btg363</pub-id><pub-id pub-id-type="pmid">14668247</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhaskaran</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>H</given-names></name><name><surname>Weng</surname><given-names>T</given-names></name><name><surname>Baviskar</surname><given-names>P</given-names></name><name><surname>Guo</surname><given-names>Y</given-names></name><name><surname>Gou</surname><given-names>D</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>MicroRNA-127 modulates fetal lung development</article-title><source>Physiological Genomics</source><volume>37</volume><fpage>268</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1152/physiolgenomics.90268.2008</pub-id><pub-id pub-id-type="pmid">19439715</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname><given-names>CM</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Pattern recognition and machine learning</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolstad</surname><given-names>BM</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name><name><surname>Astrand</surname><given-names>M</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</article-title><source>Bioinformatics</source><volume>19</volume><fpage>185</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/19.2.185</pub-id><pub-id pub-id-type="pmid">12538238</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonner</surname><given-names>AE</given-names></name><name><surname>Lemon</surname><given-names>WJ</given-names></name><name><surname>You</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Gene expression signatures identify novel regulatory pathways during murine lung development: implications for lung tumorigenesis</article-title><source>Journal of Medical Genetics</source><volume>40</volume><fpage>408</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1136/jmg.40.6.408</pub-id><pub-id pub-id-type="pmid">12807961</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brissett</surname><given-names>M</given-names></name><name><surname>Veraldi</surname><given-names>KL</given-names></name><name><surname>Pilewski</surname><given-names>JM</given-names></name><name><surname>Medsger</surname><given-names>TA</given-names></name><name><surname>Feghali-Bostwick</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Localized expression of tenascin in systemic sclerosis-associated pulmonary fibrosis and its regulation by insulin-like growth factor binding protein 3</article-title><source>Arthritis &amp; Rheumatism</source><volume>64</volume><fpage>272</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1002/art.30647</pub-id><pub-id pub-id-type="pmid">21898349</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buenrostro</surname><given-names>JD</given-names></name><name><surname>Wu</surname><given-names>B</given-names></name><name><surname>Litzenburger</surname><given-names>UM</given-names></name><name><surname>Ruff</surname><given-names>D</given-names></name><name><surname>Gonzales</surname><given-names>ML</given-names></name><name><surname>Snyder</surname><given-names>MP</given-names></name><name><surname>Chang</surname><given-names>HY</given-names></name><name><surname>Greenleaf</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-cell chromatin accessibility reveals principles of regulatory variation</article-title><source>Nature</source><volume>523</volume><fpage>486</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nature14590</pub-id><pub-id pub-id-type="pmid">26083756</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carvalho</surname><given-names>O</given-names></name><name><surname>Gonçalves</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Expression of oestrogen receptors in foetal lung tissue of mice</article-title><source>Anatomia, Histologia, Embryologia</source><volume>41</volume><fpage>1</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1111/j.1439-0264.2011.01096.x</pub-id><pub-id pub-id-type="pmid">21714811</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>KN</given-names></name><name><surname>Zhong</surname><given-names>S</given-names></name><name><surname>Weirauch</surname><given-names>MT</given-names></name><name><surname>Hon</surname><given-names>G</given-names></name><name><surname>Pelizzola</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Huang</surname><given-names>SS</given-names></name><name><surname>Schmitz</surname><given-names>RJ</given-names></name><name><surname>Urich</surname><given-names>MA</given-names></name><name><surname>Kuo</surname><given-names>D</given-names></name><name><surname>Nery</surname><given-names>JR</given-names></name><name><surname>Qiao</surname><given-names>H</given-names></name><name><surname>Yang</surname><given-names>A</given-names></name><name><surname>Jamali</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Ideker</surname><given-names>T</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name><name><surname>Ecker</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Temporal transcriptional response to ethylene gas drives growth hormone cross-regulation in arabidopsis</article-title><source>eLife</source><volume>2</volume><elocation-id>e00675</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00675</pub-id><pub-id pub-id-type="pmid">23795294</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cormack</surname><given-names>M</given-names></name><name><surname>Lin</surname><given-names>M</given-names></name><name><surname>Fedulov</surname><given-names>A</given-names></name><name><surname>Mentzer</surname><given-names>SJ</given-names></name><name><surname>Tsuda</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Age-dependent changes in gene expression profiles of postnatally developing rat lungs exposed to nano-size and micro-size cuo particles</article-title><source>The FASEB Journal</source><volume>24</volume><fpage>612</fpage><lpage>618</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>B</given-names></name><name><surname>Kislinger</surname><given-names>T</given-names></name><name><surname>Wigle</surname><given-names>DA</given-names></name><name><surname>Kannan</surname><given-names>A</given-names></name><name><surname>Brown</surname><given-names>K</given-names></name><name><surname>Okubo</surname><given-names>T</given-names></name><name><surname>Hogan</surname><given-names>B</given-names></name><name><surname>Jurisica</surname><given-names>I</given-names></name><name><surname>Frey</surname><given-names>B</given-names></name><name><surname>Rossant</surname><given-names>J</given-names></name><name><surname>Emili</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Integrated proteomic and transcriptomic profiling of mouse lung development and nmyc target genes</article-title><source>Molecular Systems Biology</source><volume>3</volume><elocation-id>109</elocation-id><pub-id pub-id-type="doi">10.1038/msb4100151</pub-id><pub-id pub-id-type="pmid">17486137</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cuna</surname><given-names>A</given-names></name><name><surname>Halloran</surname><given-names>B</given-names></name><name><surname>Faye-Petersen</surname><given-names>O</given-names></name><name><surname>Kelly</surname><given-names>D</given-names></name><name><surname>Crossman</surname><given-names>DK</given-names></name><name><surname>Cui</surname><given-names>X</given-names></name><name><surname>Pandit</surname><given-names>K</given-names></name><name><surname>Kaminski</surname><given-names>N</given-names></name><name><surname>Bhattacharya</surname><given-names>S</given-names></name><name><surname>Ahmad</surname><given-names>A</given-names></name><name><surname>Mariani</surname><given-names>TJ</given-names></name><name><surname>Ambalavanan</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Alterations in gene expression and DNA methylation during murine and human lung alveolar septation</article-title><source>American Journal of Respiratory Cell and Molecular Biology</source><volume>53</volume><fpage>60</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1165/rcmb.2014-0160OC</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>De Boor</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1978">1978</year><chapter-title>A practical guide to splines</chapter-title><source>Mathematics of Computation</source><publisher-loc>New York</publisher-loc><publisher-name>Springer, NY</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>J</given-names></name><name><surname>Sutor</surname><given-names>S</given-names></name><name><surname>Jiang</surname><given-names>G</given-names></name><name><surname>Cao</surname><given-names>Y</given-names></name><name><surname>Asmann</surname><given-names>YW</given-names></name><name><surname>Wigle</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>c-Myc regulates self-renewal in bronchoalveolar stem cells</article-title><source>PLoS One</source><volume>6</volume><elocation-id>e23707</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0023707</pub-id><pub-id pub-id-type="pmid">21858211</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujiwara</surname><given-names>N</given-names></name><name><surname>Doi</surname><given-names>T</given-names></name><name><surname>Gosemann</surname><given-names>JH</given-names></name><name><surname>Kutasy</surname><given-names>B</given-names></name><name><surname>Friedmacher</surname><given-names>F</given-names></name><name><surname>Puri</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Smad1 and WIF1 genes are downregulated during saccular stage of lung development in the nitrofen rat model</article-title><source>Pediatric Surgery International</source><volume>28</volume><fpage>189</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.1007/s00383-011-2987-0</pub-id><pub-id pub-id-type="pmid">21986617</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gitter</surname><given-names>A</given-names></name><name><surname>Carmi</surname><given-names>M</given-names></name><name><surname>Barkai</surname><given-names>N</given-names></name><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Linking the signaling cascades and dynamic regulatory networks controlling stress responses</article-title><source>Genome Research</source><volume>23</volume><fpage>365</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1101/gr.138628.112</pub-id><pub-id pub-id-type="pmid">23064748</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gortner</surname><given-names>L</given-names></name><name><surname>Shen</surname><given-names>J</given-names></name><name><surname>Tutdibi</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Sexual dimorphism of neonatal lung development</article-title><source>Klinische Pädiatrie</source><volume>225</volume><fpage>64</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1055/s-0033-1333758</pub-id><pub-id pub-id-type="pmid">23526610</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guilliams</surname><given-names>M</given-names></name><name><surname>De Kleer</surname><suffix>I</suffix></name><name><surname>Henri</surname><given-names>S</given-names></name><name><surname>Post</surname><given-names>S</given-names></name><name><surname>Vanhoutte</surname><given-names>L</given-names></name><name><surname>De Prijck</surname><given-names>S</given-names></name><name><surname>Deswarte</surname><given-names>K</given-names></name><name><surname>Malissen</surname><given-names>B</given-names></name><name><surname>Hammad</surname><given-names>H</given-names></name><name><surname>Lambrecht</surname><given-names>BN</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Alveolar macrophages develop from fetal monocytes that differentiate into long-lived cells in the first week of life via GM-CSF</article-title><source>The Journal of Experimental Medicine</source><volume>210</volume><fpage>1977</fpage><lpage>1992</lpage><pub-id pub-id-type="doi">10.1084/jem.20131199</pub-id><pub-id pub-id-type="pmid">24043763</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hartigan</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="1975">1975</year><source>Clustering Algorithms</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons, Inc</publisher-name></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>MC</given-names></name><name><surname>Wang</surname><given-names>YP</given-names></name><name><surname>Qiu</surname><given-names>WR</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Human fibroblast growth factor-18 stimulates fibroblast cell proliferation and is mapped to chromosome 14p11</article-title><source>Oncogene</source><volume>18</volume><fpage>2635</fpage><lpage>2642</lpage><pub-id pub-id-type="doi">10.1038/sj.onc.1202616</pub-id><pub-id pub-id-type="pmid">10353607</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname><given-names>AL</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>SC</given-names></name><name><surname>Si</surname><given-names>X</given-names></name><name><surname>Wong</surname><given-names>B</given-names></name><name><surname>Ekhterae</surname><given-names>D</given-names></name><name><surname>Luo</surname><given-names>H</given-names></name><name><surname>Granville</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Apoptosis repressor with caspase recruitment domain (ARC) inhibits myogenic differentiation</article-title><source>FEBS Letters</source><volume>581</volume><fpage>879</fpage><lpage>884</lpage><pub-id pub-id-type="doi">10.1016/j.febslet.2007.01.050</pub-id><pub-id pub-id-type="pmid">17292893</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>S</given-names></name><name><surname>Gelatt</surname><given-names>CD</given-names></name><name><surname>Vecchi</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Optimization by simulated annealing</article-title><source>Science</source><volume>220</volume><fpage>671</fpage><lpage>680</lpage><pub-id pub-id-type="doi">10.1126/science.220.4598.671</pub-id><pub-id pub-id-type="pmid">17813860</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kopantzev</surname><given-names>EP</given-names></name><name><surname>Monastyrskaya</surname><given-names>GS</given-names></name><name><surname>Vinogradova</surname><given-names>TV</given-names></name><name><surname>Zinovyeva</surname><given-names>MV</given-names></name><name><surname>Kostina</surname><given-names>MB</given-names></name><name><surname>Filyukova</surname><given-names>OB</given-names></name><name><surname>Tonevitsky</surname><given-names>AG</given-names></name><name><surname>Sukhikh</surname><given-names>GT</given-names></name><name><surname>Sverdlov</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Differences in gene expression levels between early and later stages of human lung development are opposite to those between normal lung tissue and non-small lung cell carcinoma</article-title><source>Lung Cancer</source><volume>62</volume><fpage>23</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1016/j.lungcan.2008.02.011</pub-id><pub-id pub-id-type="pmid">18394749</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Bankhead</surname><given-names>A</given-names></name><name><surname>Eisfeld</surname><given-names>AJ</given-names></name><name><surname>Hatta</surname><given-names>Y</given-names></name><name><surname>Jeng</surname><given-names>S</given-names></name><name><surname>Chang</surname><given-names>JH</given-names></name><name><surname>Aicher</surname><given-names>LD</given-names></name><name><surname>Proll</surname><given-names>S</given-names></name><name><surname>Ellis</surname><given-names>AL</given-names></name><name><surname>Law</surname><given-names>GL</given-names></name><name><surname>Waters</surname><given-names>KM</given-names></name><name><surname>Neumann</surname><given-names>G</given-names></name><name><surname>Katze</surname><given-names>MG</given-names></name><name><surname>McWeeney</surname><given-names>S</given-names></name><name><surname>Kawaoka</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Host regulatory network response to infection with highly pathogenic H5N1 avian influenza virus</article-title><source>Journal of Virology</source><volume>85</volume><fpage>10955</fpage><lpage>10967</lpage><pub-id pub-id-type="doi">10.1128/JVI.05792-11</pub-id><pub-id pub-id-type="pmid">21865398</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>JZ</given-names></name><name><surname>Bunney</surname><given-names>BG</given-names></name><name><surname>Meng</surname><given-names>F</given-names></name><name><surname>Hagenauer</surname><given-names>MH</given-names></name><name><surname>Walsh</surname><given-names>DM</given-names></name><name><surname>Vawter</surname><given-names>MP</given-names></name><name><surname>Evans</surname><given-names>SJ</given-names></name><name><surname>Choudary</surname><given-names>PV</given-names></name><name><surname>Cartagena</surname><given-names>P</given-names></name><name><surname>Barchas</surname><given-names>JD</given-names></name><name><surname>Schatzberg</surname><given-names>AF</given-names></name><name><surname>Jones</surname><given-names>EG</given-names></name><name><surname>Myers</surname><given-names>RM</given-names></name><name><surname>Watson</surname><given-names>SJ</given-names></name><name><surname>Akil</surname><given-names>H</given-names></name><name><surname>Bunney</surname><given-names>WE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Circadian patterns of gene expression in the human brain and disruption in major depressive disorder</article-title><source>PNAS</source><volume>110</volume><fpage>9950</fpage><lpage>9955</lpage><pub-id pub-id-type="doi">10.1073/pnas.1305814110</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mager</surname><given-names>EM</given-names></name><name><surname>Renzetti</surname><given-names>G</given-names></name><name><surname>Auais</surname><given-names>A</given-names></name><name><surname>Piedimonte</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Growth factors gene expression in the developing lung</article-title><source>Acta Paediatrica</source><volume>96</volume><fpage>1015</fpage><lpage>1020</lpage><pub-id pub-id-type="doi">10.1111/j.1651-2227.2007.00332.x</pub-id><pub-id pub-id-type="pmid">17524022</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mariani</surname><given-names>TJ</given-names></name><name><surname>Reed</surname><given-names>JJ</given-names></name><name><surname>Shapiro</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Expression profiling of the developing mouse lung: insights into the establishment of the extracellular matrix</article-title><source>American journal of respiratory cell and molecular biology</source><volume>26</volume><fpage>541</fpage><lpage>548</lpage><pub-id pub-id-type="doi">10.1165/ajrcmb.26.5.2001-00080c</pub-id><pub-id pub-id-type="pmid">11970905</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McLachlan</surname><given-names>G</given-names></name><name><surname>Peel</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Finite Mixture Models</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons</publisher-name></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melén</surname><given-names>E</given-names></name><name><surname>Kho</surname><given-names>AT</given-names></name><name><surname>Sharma</surname><given-names>S</given-names></name><name><surname>Gaedigk</surname><given-names>R</given-names></name><name><surname>Leeder</surname><given-names>JS</given-names></name><name><surname>Mariani</surname><given-names>TJ</given-names></name><name><surname>Carey</surname><given-names>VJ</given-names></name><name><surname>Weiss</surname><given-names>ST</given-names></name><name><surname>Tantisira</surname><given-names>KG</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Expression analysis of asthma candidate genes during human and murine lung development</article-title><source>Respiratory Research</source><volume>12</volume><elocation-id>86</elocation-id><pub-id pub-id-type="doi">10.1186/1465-9921-12-86</pub-id><pub-id pub-id-type="pmid">21699702</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ohbayashi</surname><given-names>N</given-names></name><name><surname>Hoshikawa</surname><given-names>M</given-names></name><name><surname>Kimura</surname><given-names>S</given-names></name><name><surname>Yamasaki</surname><given-names>M</given-names></name><name><surname>Fukui</surname><given-names>S</given-names></name><name><surname>Itoh</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Structure and expression of the mRNA encoding a novel fibroblast growth factor, FGF-18</article-title><source>Journal of Biological Chemistry</source><volume>273</volume><fpage>18161</fpage><lpage>18164</lpage><pub-id pub-id-type="doi">10.1074/jbc.273.29.18161</pub-id><pub-id pub-id-type="pmid">9660775</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paige</surname><given-names>SL</given-names></name><name><surname>Thomas</surname><given-names>S</given-names></name><name><surname>Stoick-Cooper</surname><given-names>CL</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Maves</surname><given-names>L</given-names></name><name><surname>Sandstrom</surname><given-names>R</given-names></name><name><surname>Pabon</surname><given-names>L</given-names></name><name><surname>Reinecke</surname><given-names>H</given-names></name><name><surname>Pratt</surname><given-names>G</given-names></name><name><surname>Keller</surname><given-names>G</given-names></name><name><surname>Moon</surname><given-names>RT</given-names></name><name><surname>Stamatoyannopoulos</surname><given-names>J</given-names></name><name><surname>Murry</surname><given-names>CE</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A temporal chromatin signature in human embryonic stem cells identifies regulators of cardiac development</article-title><source>Cell</source><volume>151</volume><fpage>221</fpage><lpage>232</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.08.027</pub-id><pub-id pub-id-type="pmid">22981225</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popova</surname><given-names>AP</given-names></name><name><surname>Bentley</surname><given-names>JK</given-names></name><name><surname>Cui</surname><given-names>TX</given-names></name><name><surname>Richardson</surname><given-names>MN</given-names></name><name><surname>Linn</surname><given-names>MJ</given-names></name><name><surname>Lei</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>Q</given-names></name><name><surname>Goldsmith</surname><given-names>AM</given-names></name><name><surname>Pryhuber</surname><given-names>GS</given-names></name><name><surname>Hershenson</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reduced platelet-derived growth factor receptor expression is a primary feature of human bronchopulmonary dysplasia</article-title><source>AJP: Lung Cellular and Molecular Physiology</source><volume>307</volume><fpage>L231</fpage><lpage>L239</lpage><pub-id pub-id-type="doi">10.1152/ajplung.00342.2013</pub-id><pub-id pub-id-type="pmid">24907056</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinsch</surname><given-names>CH</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Smoothing by spline functions</article-title><source>Numerische Mathematik</source><volume>10</volume><fpage>177</fpage><lpage>183</lpage><pub-id pub-id-type="doi">10.1007/BF02162161</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rice</surname><given-names>P</given-names></name><name><surname>Longden</surname><given-names>I</given-names></name><name><surname>Bleasby</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>EMBOSS: the european molecular biology open software suite</article-title><source>Trends in Genetics</source><volume>16</volume><fpage>276</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1016/S0168-9525(00)02024-2</pub-id><pub-id pub-id-type="pmid">10827456</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosa</surname><given-names>BA</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Major</surname><given-names>IT</given-names></name><name><surname>Qin</surname><given-names>W</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimal timepoint sampling in high-throughput gene expression experiments</article-title><source>Bioinformatics</source><volume>28</volume><fpage>2773</fpage><lpage>2781</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts511</pub-id><pub-id pub-id-type="pmid">22923305</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>S</given-names></name><name><surname>Ernst</surname><given-names>J</given-names></name><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Kheradpour</surname><given-names>P</given-names></name><name><surname>Negre</surname><given-names>N</given-names></name><name><surname>Eaton</surname><given-names>ML</given-names></name><name><surname>Landolin</surname><given-names>JM</given-names></name><name><surname>Bristow</surname><given-names>CA</given-names></name><name><surname>Ma</surname><given-names>L</given-names></name><name><surname>Lin</surname><given-names>MF</given-names></name><name><surname>Washietl</surname><given-names>S</given-names></name><name><surname>Arshinoff</surname><given-names>BI</given-names></name><name><surname>Ay</surname><given-names>F</given-names></name><name><surname>Meyer</surname><given-names>PE</given-names></name><name><surname>Robine</surname><given-names>N</given-names></name><name><surname>Washington</surname><given-names>NL</given-names></name><name><surname>Di Stefano</surname><given-names>L</given-names></name><name><surname>Berezikov</surname><given-names>E</given-names></name><name><surname>Brown</surname><given-names>CD</given-names></name><name><surname>Candeias</surname><given-names>R</given-names></name><name><surname>Carlson</surname><given-names>JW</given-names></name><name><surname>Carr</surname><given-names>A</given-names></name><name><surname>Jungreis</surname><given-names>I</given-names></name><name><surname>Marbach</surname><given-names>D</given-names></name><name><surname>Sealfon</surname><given-names>R</given-names></name><name><surname>Tolstorukov</surname><given-names>MY</given-names></name><name><surname>Will</surname><given-names>S</given-names></name><name><surname>Alekseyenko</surname><given-names>AA</given-names></name><name><surname>Artieri</surname><given-names>C</given-names></name><name><surname>Booth</surname><given-names>BW</given-names></name><name><surname>Brooks</surname><given-names>AN</given-names></name><name><surname>Dai</surname><given-names>Q</given-names></name><name><surname>Davis</surname><given-names>CA</given-names></name><name><surname>Duff</surname><given-names>MO</given-names></name><name><surname>Feng</surname><given-names>X</given-names></name><name><surname>Gorchakov</surname><given-names>AA</given-names></name><name><surname>Gu</surname><given-names>T</given-names></name><name><surname>Henikoff</surname><given-names>JG</given-names></name><name><surname>Kapranov</surname><given-names>P</given-names></name><name><surname>Li</surname><given-names>R</given-names></name><name><surname>MacAlpine</surname><given-names>HK</given-names></name><name><surname>Malone</surname><given-names>J</given-names></name><name><surname>Minoda</surname><given-names>A</given-names></name><name><surname>Nordman</surname><given-names>J</given-names></name><name><surname>Okamura</surname><given-names>K</given-names></name><name><surname>Perry</surname><given-names>M</given-names></name><name><surname>Powell</surname><given-names>SK</given-names></name><name><surname>Riddle</surname><given-names>NC</given-names></name><name><surname>Sakai</surname><given-names>A</given-names></name><name><surname>Samsonova</surname><given-names>A</given-names></name><name><surname>Sandler</surname><given-names>JE</given-names></name><name><surname>Schwartz</surname><given-names>YB</given-names></name><name><surname>Sher</surname><given-names>N</given-names></name><name><surname>Spokony</surname><given-names>R</given-names></name><name><surname>Sturgill</surname><given-names>D</given-names></name><name><surname>van Baren</surname><given-names>M</given-names></name><name><surname>Wan</surname><given-names>KH</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Yu</surname><given-names>C</given-names></name><name><surname>Feingold</surname><given-names>E</given-names></name><name><surname>Good</surname><given-names>P</given-names></name><name><surname>Guyer</surname><given-names>M</given-names></name><name><surname>Lowdon</surname><given-names>R</given-names></name><name><surname>Ahmad</surname><given-names>K</given-names></name><name><surname>Andrews</surname><given-names>J</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Brenner</surname><given-names>SE</given-names></name><name><surname>Brent</surname><given-names>MR</given-names></name><name><surname>Cherbas</surname><given-names>L</given-names></name><name><surname>Elgin</surname><given-names>SC</given-names></name><name><surname>Gingeras</surname><given-names>TR</given-names></name><name><surname>Grossman</surname><given-names>R</given-names></name><name><surname>Hoskins</surname><given-names>RA</given-names></name><name><surname>Kaufman</surname><given-names>TC</given-names></name><name><surname>Kent</surname><given-names>W</given-names></name><name><surname>Kuroda</surname><given-names>MI</given-names></name><name><surname>Orr-Weaver</surname><given-names>T</given-names></name><name><surname>Perrimon</surname><given-names>N</given-names></name><name><surname>Pirrotta</surname><given-names>V</given-names></name><name><surname>Posakony</surname><given-names>JW</given-names></name><name><surname>Ren</surname><given-names>B</given-names></name><name><surname>Russell</surname><given-names>S</given-names></name><name><surname>Cherbas</surname><given-names>P</given-names></name><name><surname>Graveley</surname><given-names>BR</given-names></name><name><surname>Lewis</surname><given-names>S</given-names></name><name><surname>Micklem</surname><given-names>G</given-names></name><name><surname>Oliver</surname><given-names>B</given-names></name><name><surname>Park</surname><given-names>PJ</given-names></name><name><surname>Celniker</surname><given-names>SE</given-names></name><name><surname>Henikoff</surname><given-names>S</given-names></name><name><surname>Karpen</surname><given-names>GH</given-names></name><name><surname>Lai</surname><given-names>EC</given-names></name><name><surname>MacAlpine</surname><given-names>DM</given-names></name><name><surname>Stein</surname><given-names>LD</given-names></name><name><surname>White</surname><given-names>KP</given-names></name><name><surname>Kellis</surname><given-names>M</given-names></name><collab>modENCODE Consortium</collab></person-group><year iso-8601-date="2010">2010</year><article-title>Identification of functional elements and regulatory circuits by drosophila modENCODE</article-title><source>Science</source><volume>330</volume><fpage>1787</fpage><lpage>1797</lpage><pub-id pub-id-type="doi">10.1126/science.1198374</pub-id><pub-id pub-id-type="pmid">21177974</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>E</given-names></name><name><surname>Pliushch</surname><given-names>G</given-names></name><name><surname>El Hajj</surname><given-names>N</given-names></name><name><surname>Galetzka</surname><given-names>D</given-names></name><name><surname>Puhl</surname><given-names>A</given-names></name><name><surname>Schorsch</surname><given-names>M</given-names></name><name><surname>Frauenknecht</surname><given-names>K</given-names></name><name><surname>Riepert</surname><given-names>T</given-names></name><name><surname>Tresch</surname><given-names>A</given-names></name><name><surname>Müller</surname><given-names>AM</given-names></name><name><surname>Coerdt</surname><given-names>W</given-names></name><name><surname>Zechner</surname><given-names>U</given-names></name><name><surname>Haaf</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Spatial, temporal and interindividual epigenetic variation of functionally important DNA methylation patterns</article-title><source>Nucleic Acids Research</source><volume>38</volume><fpage>3880</fpage><lpage>3890</lpage><pub-id pub-id-type="doi">10.1093/nar/gkq126</pub-id><pub-id pub-id-type="pmid">20194112</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>MH</given-names></name><name><surname>Pandit</surname><given-names>KV</given-names></name><name><surname>Lino Cardenas</surname><given-names>CL</given-names></name><name><surname>Ambalavanan</surname><given-names>N</given-names></name><name><surname>Kaminski</surname><given-names>N</given-names></name><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Reconstructing dynamic microRNA-regulated interaction networks</article-title><source>PNAS</source><volume>110</volume><fpage>15686</fpage><lpage>15691</lpage><pub-id pub-id-type="doi">10.1073/pnas.1303236110</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Estimating the dimension of a model</article-title><source>The Annals of Statistics</source><volume>6</volume><fpage>461</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sessa</surname><given-names>R</given-names></name><name><surname>Hata</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Role of microRNAs in lung development and pulmonary diseases</article-title><source>Pulmonary Circulation</source><volume>3</volume><elocation-id>315</elocation-id><lpage>328</lpage><pub-id pub-id-type="doi">10.4103/2045-8932.114758</pub-id><pub-id pub-id-type="pmid">24015331</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapira</surname><given-names>SD</given-names></name><name><surname>Gat-Viks</surname><given-names>I</given-names></name><name><surname>Shum</surname><given-names>BO</given-names></name><name><surname>Dricot</surname><given-names>A</given-names></name><name><surname>de Grace</surname><given-names>MM</given-names></name><name><surname>Wu</surname><given-names>L</given-names></name><name><surname>Gupta</surname><given-names>PB</given-names></name><name><surname>Hao</surname><given-names>T</given-names></name><name><surname>Silver</surname><given-names>SJ</given-names></name><name><surname>Root</surname><given-names>DE</given-names></name><name><surname>Hill</surname><given-names>DE</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Hacohen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A physical and regulatory map of host-influenza interactions reveals pathways in H1N1 infection</article-title><source>Cell</source><volume>139</volume><fpage>1255</fpage><lpage>1267</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.12.018</pub-id><pub-id pub-id-type="pmid">20064372</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Liao</surname><given-names>Y</given-names></name><name><surname>Willis</surname><given-names>SN</given-names></name><name><surname>Taubenheim</surname><given-names>N</given-names></name><name><surname>Inouye</surname><given-names>M</given-names></name><name><surname>Tarlinton</surname><given-names>DM</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Hodgkin</surname><given-names>PD</given-names></name><name><surname>Nutt</surname><given-names>SL</given-names></name><name><surname>Corcoran</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Transcriptional profiling of mouse B cell terminal differentiation defines a signature for antibody-secreting plasma cells</article-title><source>Nature Immunology</source><volume>16</volume><fpage>663</fpage><lpage>673</lpage><pub-id pub-id-type="doi">10.1038/ni.3154</pub-id><pub-id pub-id-type="pmid">25894659</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singer</surname><given-names>ZS</given-names></name><name><surname>Yong</surname><given-names>J</given-names></name><name><surname>Tischler</surname><given-names>J</given-names></name><name><surname>Hackett</surname><given-names>JA</given-names></name><name><surname>Altinok</surname><given-names>A</given-names></name><name><surname>Surani</surname><given-names>MA</given-names></name><name><surname>Cai</surname><given-names>L</given-names></name><name><surname>Elowitz</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dynamic heterogeneity and DNA methylation in embryonic stem cells</article-title><source>Molecular Cell</source><volume>55</volume><fpage>319</fpage><lpage>331</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2014.06.029</pub-id><pub-id pub-id-type="pmid">25038413</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>R</given-names></name><name><surname>Palmer</surname><given-names>N</given-names></name><name><surname>Gifford</surname><given-names>D</given-names></name><name><surname>Berger</surname><given-names>B</given-names></name><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Active learning for sampling in time-series experiments with application to gene expression analysis</article-title><conf-name><italic>Proceedings of the 22nd International Conference on Machine Learning (ICML-05)</italic></conf-name><fpage>832</fpage><lpage>839</lpage></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>MQ</given-names></name><name><surname>Iyer</surname><given-names>VR</given-names></name><name><surname>Anders</surname><given-names>K</given-names></name><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Futcher</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Comprehensive identification of cell cycle-regulated genes of the yeast saccharomyces cerevisiae by microarray hybridization</article-title><source>Molecular Biology of the Cell</source><volume>9</volume><fpage>3273</fpage><lpage>3297</lpage><pub-id pub-id-type="doi">10.1091/mbc.9.12.3273</pub-id><pub-id pub-id-type="pmid">9843569</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sperger</surname><given-names>JM</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Draper</surname><given-names>JS</given-names></name><name><surname>Antosiewicz</surname><given-names>JE</given-names></name><name><surname>Chon</surname><given-names>CH</given-names></name><name><surname>Jones</surname><given-names>SB</given-names></name><name><surname>Brooks</surname><given-names>JD</given-names></name><name><surname>Andrews</surname><given-names>PW</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Thomson</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Gene expression patterns in human embryonic stem cells and human pluripotent germ cell tumors</article-title><source>PNAS</source><volume>100</volume><fpage>13350</fpage><lpage>13355</lpage><pub-id pub-id-type="doi">10.1073/pnas.2235735100</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storch</surname><given-names>KF</given-names></name><name><surname>Lipan</surname><given-names>O</given-names></name><name><surname>Leykin</surname><given-names>I</given-names></name><name><surname>Viswanathan</surname><given-names>N</given-names></name><name><surname>Davis</surname><given-names>FC</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name><name><surname>Weitz</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Extensive and divergent circadian gene expression in liver and heart</article-title><source>Nature</source><volume>417</volume><fpage>78</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1038/nature744</pub-id><pub-id pub-id-type="pmid">11967526</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subhani</surname><given-names>N</given-names></name><name><surname>Rueda</surname><given-names>L</given-names></name><name><surname>Ngom</surname><given-names>A</given-names></name><name><surname>Burden</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Multiple gene expression profile alignment for microarray time-series data clustering</article-title><source>Bioinformatics</source><volume>26</volume><fpage>2281</fpage><lpage>2288</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq422</pub-id><pub-id pub-id-type="pmid">20639411</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takai</surname><given-names>D</given-names></name><name><surname>Jones</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Comprehensive analysis of CpG islands in human chromosomes 21 and 22</article-title><source>PNAS</source><volume>99</volume><fpage>3740</fpage><lpage>3745</lpage><pub-id pub-id-type="doi">10.1073/pnas.052410099</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Talens</surname><given-names>RP</given-names></name><name><surname>Boomsma</surname><given-names>DI</given-names></name><name><surname>Tobi</surname><given-names>EW</given-names></name><name><surname>Kremer</surname><given-names>D</given-names></name><name><surname>Jukema</surname><given-names>JW</given-names></name><name><surname>Willemsen</surname><given-names>G</given-names></name><name><surname>Putter</surname><given-names>H</given-names></name><name><surname>Slagboom</surname><given-names>PE</given-names></name><name><surname>Heijmans</surname><given-names>BT</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Variation, patterns, and temporal stability of DNA methylation: considerations for epigenetic epidemiology</article-title><source>The FASEB Journal</source><volume>24</volume><fpage>3135</fpage><lpage>3144</lpage><pub-id pub-id-type="doi">10.1096/fj.09-150490</pub-id><pub-id pub-id-type="pmid">20385621</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname><given-names>MA</given-names></name><name><surname>Weinshilboum</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Rabbit lung indolethylamine N-methyltransferase. cDNA and gene cloning and characterization</article-title><source>Journal of Biological Chemistry</source><volume>273</volume><fpage>34502</fpage><lpage>34510</lpage><pub-id pub-id-type="doi">10.1074/jbc.273.51.34502</pub-id><pub-id pub-id-type="pmid">9852119</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turi</surname><given-names>ZG</given-names></name><name><surname>Rezkella</surname><given-names>S</given-names></name><name><surname>Campbell</surname><given-names>CA</given-names></name><name><surname>Kloner</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Left main percutaneous transluminal coronary angioplasty with the autoperfusion catheter in an animal model</article-title><source>Catheterization and Cardiovascular Diagnosis</source><volume>21</volume><fpage>45</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1002/ccd.1810210112</pub-id><pub-id pub-id-type="pmid">2208267</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ueda</surname><given-names>HR</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Adachi</surname><given-names>A</given-names></name><name><surname>Wakamatsu</surname><given-names>H</given-names></name><name><surname>Hayashi</surname><given-names>S</given-names></name><name><surname>Takasugi</surname><given-names>T</given-names></name><name><surname>Nagano</surname><given-names>M</given-names></name><name><surname>Nakahama</surname><given-names>K</given-names></name><name><surname>Suzuki</surname><given-names>Y</given-names></name><name><surname>Sugano</surname><given-names>S</given-names></name><name><surname>Iino</surname><given-names>M</given-names></name><name><surname>Shigeyoshi</surname><given-names>Y</given-names></name><name><surname>Hashimoto</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A transcription factor response element for gene expression during circadian night</article-title><source>Nature</source><volume>418</volume><fpage>534</fpage><lpage>539</lpage><pub-id pub-id-type="doi">10.1038/nature00906</pub-id><pub-id pub-id-type="pmid">12152080</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wahba</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1990">1990</year><source>Spline Models for Observational Data, Vol. 59</source><publisher-loc>Philadelphia, PA</publisher-loc><publisher-name>SIAM: Society for Industrial and Applied Mathematics</publisher-name></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinstein</surname><given-names>M</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Ohyama</surname><given-names>K</given-names></name><name><surname>Deng</surname><given-names>CX</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>FGFR-3 and FGFR-4 function cooperatively to direct alveogenesis in the murine lung</article-title><source>Development</source><volume>125</volume><fpage>3615</fpage><lpage>3623</lpage><pub-id pub-id-type="pmid">9716527</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname><given-names>AE</given-names></name><name><surname>Moschos</surname><given-names>SA</given-names></name><name><surname>Perry</surname><given-names>MM</given-names></name><name><surname>Barnes</surname><given-names>PJ</given-names></name><name><surname>Lindsay</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Maternally imprinted microRNAs are differentially expressed during mouse and human lung development</article-title><source>Developmental Dynamics</source><volume>236</volume><fpage>572</fpage><lpage>580</lpage><pub-id pub-id-type="doi">10.1002/dvdy.21047</pub-id><pub-id pub-id-type="pmid">17191223</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>B</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Zheng</surname><given-names>SG</given-names></name><name><surname>Bringas</surname><given-names>P</given-names></name><name><surname>Xu</surname><given-names>M</given-names></name><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Chen</surname><given-names>D</given-names></name><name><surname>Umans</surname><given-names>L</given-names></name><name><surname>Zwijsen</surname><given-names>A</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Smad1 and its target gene Wif1 coordinate BMP and wnt signaling activities to regulate fetal lung development</article-title><source>Development</source><volume>138</volume><fpage>925</fpage><lpage>935</lpage><pub-id pub-id-type="doi">10.1242/dev.062687</pub-id><pub-id pub-id-type="pmid">21270055</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yosef</surname><given-names>N</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Impulse control: temporal dynamics in gene transcription</article-title><source>Cell</source><volume>144</volume><fpage>886</fpage><lpage>896</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.02.015</pub-id><pub-id pub-id-type="pmid">21414481</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Mideros</surname><given-names>SX</given-names></name><name><surname>Bao</surname><given-names>L</given-names></name><name><surname>Hanlon</surname><given-names>R</given-names></name><name><surname>Arredondo</surname><given-names>FD</given-names></name><name><surname>Tripathy</surname><given-names>S</given-names></name><name><surname>Krampis</surname><given-names>K</given-names></name><name><surname>Jerauld</surname><given-names>A</given-names></name><name><surname>Evans</surname><given-names>C</given-names></name><name><surname>St Martin</surname><given-names>SK</given-names></name><name><surname>Maroof</surname><given-names>MAS</given-names></name><name><surname>Hoeschele</surname><given-names>I</given-names></name><name><surname>Dorrance</surname><given-names>AE</given-names></name><name><surname>Tyler</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Infection and genotype remodel the entire soybean transcriptome</article-title><source>BMC Genomics</source><volume>10</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2164-10-49</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zinman</surname><given-names>GE</given-names></name><name><surname>Naiman</surname><given-names>S</given-names></name><name><surname>Kanfi</surname><given-names>Y</given-names></name><name><surname>Cohen</surname><given-names>H</given-names></name><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>ExpressionBlast: mining large, unstructured expression databases</article-title><source>Nature Methods</source><volume>10</volume><fpage>925</fpage><lpage>926</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2630</pub-id><pub-id pub-id-type="pmid">24076985</pub-id></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix 1 Methods</title><boxed-text><sec id="s19" sec-type="appendix"><title>Selecting the set of 126 genes</title><p><xref ref-type="table" rid="tbl1">Table 1</xref> provides the list of genes used for the nanostring analysis and the rational for their inclusion.</p></sec><sec id="s20" sec-type="appendix"><title>DNA Methylation analysis</title><p>Mouse alveolar lung tissues attached to LCM caps were stored at −80°C until processing. DNA was extracted using the ZR Genomic DNA-Tissue MicroPrep kit (Zymo Research). Incubation with Digestion buffer and proteinase K was done overnight at 55°C in inverted tubes. 13 genes were chosen for targeted NextGen bisulfite sequencing (NGBS): <italic>Igfbp3, Wif1, Cdh11, Eln, Sox9, Tnc, Dnmt3a, Akt, VEGF, Lox, FoxF2, ZFP536</italic> and <italic>Src</italic>, based on published data (<xref ref-type="bibr" rid="bib16">Cuna et al., 2015</xref>). The presence of CpG islands in 5-UTR, gene body and 3-UTR was interrogated using NCBI Epigenomics database, as well as CpG island searcher (<xref ref-type="bibr" rid="bib53">Takai and Jones, 2002</xref>), and EMBOSS Cpgplot (<xref ref-type="bibr" rid="bib38">Rice et al., 2000</xref>). Targeted NGBS was done by Epigendx Inc. Gene sequences from selected regions were acquired from the Ensembl database. Gene IDs, transcript IDs, simplex PCR IDs, and target regions for each gene are listed in <xref ref-type="table" rid="A2-tbl3">Appendix 2—Table 3</xref>. A total of <inline-formula><mml:math id="inf70"><mml:mn>42</mml:mn></mml:math></inline-formula> target PCRs were designed by PyroMark Assay Design Software (Qiagen).</p><p>Targeted NGBS was done on samples collected at the following time points: E16.5, E18.5, P0.5, P1.5, P2.5, P5, P10, P15, P19 and P26. Mouse genomic DNA (200–500 ng) was bisulfite treated using the EZ DNA Methylation Kit (Zymo Research). Multiplex PCR was performed using 0.5 units of TaKaRa EpiTaq HS (Takara Bio) in 2x master mix.</p><p>FASTQ files were aligned using open source Bismark Bisulfite Read Mapper using Bowtie2. Methylation levels were calculated in Bismark by dividing the number of methylated reads by the number of total reads, considering all CpG sites covered by a minimum of <inline-formula><mml:math id="inf71"><mml:mn>30</mml:mn></mml:math></inline-formula> total reads. Sites where the difference in methylation was less than <inline-formula><mml:math id="inf72"><mml:mrow><mml:mn>5</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> over the entire time period, those where there was a difference of <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at a single time point and those with less than <inline-formula><mml:math id="inf74"><mml:mn>3</mml:mn></mml:math></inline-formula> non zero values were removed from the analyses.</p></sec><sec id="s21" sec-type="appendix"><title>TPS Algorithm</title><p>A pseudocode for the TPS algorithm is presented in Algorithm 1.3.</p><p><table-wrap id="tblu1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th><p>Algorithm 1. <italic>TPS</italic> : Iterative <inline-formula><mml:math id="inf75"><mml:mi>k</mml:mi></mml:math></inline-formula>-point selection</p></th></tr></thead><tbody><tr><td><p>1: <bold>Procedure</bold> I<sc>terative</sc>–T<sc>emporal</sc>–S<sc>election</sc></p> <p>2:   <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> select initial <inline-formula><mml:math id="inf77"><mml:mi>k</mml:mi></mml:math></inline-formula> time points by absolute difference sorting</p><p>3:   <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> error of remaining points by fitting splines to <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></p><p>4:   <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>5:   <bold>do</bold></p> <p>6:    <bold>for</bold> each pair <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM27"><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM28"><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM29"><mml:msup><mml:mi>T</mml:mi><mml:mo>-</mml:mo></mml:msup><mml:mo>∖</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM30"><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow><mml:mo>∖</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM31"><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> do</p><p>7:      <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mtext>\ </mml:mtext></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>8:      <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> estimate error by fitting smoothing spline to <inline-formula><mml:math id="inf84"><mml:msup><mml:mi>C</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> where regularization parameter is          estimated by LOOCV</p><p>9:      <bold>if</bold> <inline-formula><mml:math id="inf85"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> <bold>then</bold></p> <p>10:       <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>C</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>11:       <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>12:      <bold>end if</bold></p> <p>13:      <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>14:    <bold>end for</bold></p> <p>15:   <bold>While</bold> <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>16:   Output <inline-formula><mml:math id="inf90"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula></p><p>17: <bold>end procedure</bold></p> </td></tr></tbody></table></table-wrap></p></sec><sec id="s22" sec-type="appendix"><title>Selecting the initial set of points</title><p>When using an iterative algorithm to solve non-convex problems with several local minima, a key issue is the appropriate selection of the initial solution set. We have tested a number of methods for performing such initializations. The simplest method we tried is to uniformly select a subset of the points (so if <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> we use each 4’th point). Another method we tested is to partition the set of all time points <inline-formula><mml:math id="inf93"><mml:mi>T</mml:mi></mml:math></inline-formula> into <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> intervals of almost equal size. This method determines these boundaries by estimating the cumulative number of points until each time point and selecting time points with cumulative values <inline-formula><mml:math id="inf95"><mml:mrow><mml:mfrac id="XM33"><mml:mi>T</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mrow id="XM34"><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mi id="XM35" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM36"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM32"><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula> respectively. Then, it uses <inline-formula><mml:math id="inf96"><mml:mi>k</mml:mi></mml:math></inline-formula> interval boundaries including <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> as initial solution. We also tested a method that relies on the changes between consecutive time points to select the most important ones for our initial set. Specifically, we sort all points except <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></inline-formula> by average absolute difference with respect to its predecessor and successor time points by computing:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow id="XM39"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM37"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM38"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow id="XM42"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM40"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM41"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi id="XM43">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM44"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the median expression for gene <inline-formula><mml:math id="inf102"><mml:mi>g</mml:mi></mml:math></inline-formula> at time <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. We then select the <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> points with maximum <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>m</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> as the initial solution.</p><p>Finally, we developed an alternative initialization method, based on dyanmic recalculation of a metric on each time point. Metric A is same equal to the equation shown above. Metric B of a time point is the difference absolute difference with respect to its predecessor and successor time points. Metric C of a time point is absolute difference with respect to only its predecessor. The alternative initialization algorithm calculates the given metric on each time point other than the first and last and then places those points in a min heap based on the metric. The top(minimum) point in the heap is removed. The metric is recalculated for the point’s predeccesor and succesor based on thier neighboring points, using only the points remaining in the heap. This process is repated until only k-2 time points remain in the heap. Then the first time point, last time point and the points remaind in the heap are chosen.<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi id="XM45">e</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM46"><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow id="XM53"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM49"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM47"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM48"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM52"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM50"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM51"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi id="XM54">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi id="XM55">e</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM56"><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow id="XM63"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM59"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM57"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM58"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM62"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM60"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM61"><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi id="XM64">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi id="XM65">e</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM66"><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>M</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi id="XM79">G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p><table-wrap id="tblu2" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th><p>Algorithm 2: Init TPS: Iterative initial <inline-formula><mml:math id="inf106"><mml:mi>k</mml:mi></mml:math></inline-formula> point selection</p></th></tr></thead><tbody><tr><td><p>1: <bold>Procedure</bold> I<sc>terative</sc>–I<sc>nitial Point</sc>–S<sc>election</sc></p> <p>2:  <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> Empty min heap</p><p>3:  <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> matrix where rows are genes and columns are time points, values are expression measurements</p><p>4:  <bold>for</bold> each time point <inline-formula><mml:math id="inf109"><mml:mi>t</mml:mi></mml:math></inline-formula> (other than the first and last) <bold>do</bold></p> <p>5:    <inline-formula><mml:math id="inf110"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi id="XM80">e</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM81">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>6:    <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>7:    <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>8:    Add <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf114"><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>z</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM82">H</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>9:  <bold>end for</bold></p> <p>10:  <bold>While</bold> <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>do</bold></p> <p>11:   Remove minimum <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> time point <inline-formula><mml:math id="inf117"><mml:mi>m</mml:mi></mml:math></inline-formula> from <inline-formula><mml:math id="inf118"><mml:mi>H</mml:mi><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>12:   <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>13:   <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>14:   Remove <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="inf122"><mml:mi>H</mml:mi></mml:math></inline-formula></p><p>15:   Remove <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="inf124"><mml:mi>H</mml:mi></mml:math></inline-formula></p><p>16:   Remove <inline-formula><mml:math id="inf125"><mml:mi>m</mml:mi></mml:math></inline-formula> from <inline-formula><mml:math id="inf126"><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi id="XM83">e</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM84"><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi id="XM85">e</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM86"><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></p><p>17:   <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>18:   <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p><p>19:   Add <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula></p><p>20:   Add <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></inline-formula></p><p>21:  <bold>end while</bold> </p> <p>22:   Ouput all <inline-formula><mml:math id="inf131"><mml:mi>t</mml:mi></mml:math></inline-formula> left as <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="inf133"><mml:mi>H</mml:mi></mml:math></inline-formula> + first time point + last time point</p><p>23: <bold>end procedure</bold></p> </td></tr></tbody></table></table-wrap></p><p>We found that for our particular dataset, the dynamic initialization with <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi id="XM87">e</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM88"><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> performed best for selections of time points smaller than one third of the the initial dense time series, while the non dynamic <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>m</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> method works best for selections of time points between one third and and one half of the initial time series. The dyanmic metric and non dynamic metrics can be compared in their performance on our data in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>. However, all of the metrics performed much better than a selection of random points as shown in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>.</p></sec><sec id="s23" sec-type="appendix"><title>Further improvements to the iterative points selection procedures</title><p>We tested the following possible search strategies to improve the iterative points removal and addition in TPS.</p><list list-type="bullet"><list-item><p>We add and remove <inline-formula><mml:math id="inf136"><mml:mi>b</mml:mi></mml:math></inline-formula> time points in each iteration instead of a single point. This increases the complexity of each iteration from <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM89"><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM90"><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf139"><mml:mi>Q</mml:mi></mml:math></inline-formula> is the complexity of fitting a smoothing spline.</p></list-item><list-item><p>We use simulated annealing to escape from local minima (<xref ref-type="bibr" rid="bib26">Kirkpatrick et al., 1983</xref>). In this case, we do not always move to a pair of points with the minimum error in each iteration, but instead move to a solution with random pair of points with probability <inline-formula><mml:math id="inf140"><mml:mn>1</mml:mn></mml:math></inline-formula> if its error <inline-formula><mml:math id="inf141"><mml:msup><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:msup></mml:math></inline-formula> is lower than error of current solution <inline-formula><mml:math id="inf142"><mml:msup><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:math></inline-formula> whereas we move to a solution with probability <inline-formula><mml:math id="inf143"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM91"><mml:msup><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> if <inline-formula><mml:math id="inf144"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:msup><mml:mo>≥</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. Here, <inline-formula><mml:math id="inf145"><mml:mi>C</mml:mi></mml:math></inline-formula> is the temperature that increases by increasing number of iterations and the probability of moving to a solution with larger error decreases over time.</p></list-item></list><p>In practice, even though both approaches should in theory be better able to escape local minima than the greedy approach described above, for the data we analyzed they do not perform significantly better as <xref ref-type="fig" rid="fig2">Figure 2</xref> in the main text demonstrates.</p></sec><sec id="s24" sec-type="appendix"><title>Fitting smoothing spline</title><p><italic>TPS</italic> uses splines for fitting expression curves. Regularized smoothing spline satisfies the piecewise cubic polynomial <inline-formula><mml:math id="inf146"><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM92">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM93"><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM94"><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM95"><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf147"><mml:mrow><mml:mrow id="XM101"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub id="XM96"><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM97"><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow id="XM102"><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mn id="XM98">1</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM99" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM100"><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> as shown in <xref ref-type="bibr" rid="bib58">Wahba (1990)</xref>. Then, according to (<xref ref-type="bibr" rid="bib37">Reinsch, 1967</xref>; <xref ref-type="bibr" rid="bib17">De Boor, 1978</xref>), regularized smoothing spline objective can also be expressed as in:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mpadded id="XM103" width="+1.7pt"><mml:mi id="XM103a">min</mml:mi></mml:mpadded><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mi>R</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM105"><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM106"><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi id="XM107" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM108"><mml:mi>a</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM109"><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM110"><mml:mi>c</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi id="XM111" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM112"><mml:mi>c</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf150"><mml:mi>R</mml:mi></mml:math></inline-formula> is a <inline-formula><mml:math id="inf151"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM113"><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> tridiagonal symmetric matrix with entries <inline-formula><mml:math id="inf152"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi id="XM114">i</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM115">i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM116"><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi id="XM117">i</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM118"><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf154"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The continuity restrictions imply that:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf155"><mml:mi>Q</mml:mi></mml:math></inline-formula> is an <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM119"><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> tridiagonal matrix with entries <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi id="XM120">i</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM121"><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mrow id="XM122"><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi id="XM123">i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi id="XM124">i</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM125">i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM126"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, we may write <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> as:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mpadded id="XM127" width="+1.7pt"><mml:mi id="XM127a">min</mml:mi></mml:mpadded><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>a</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mi>Q</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>Q</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mi>a</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf160"><mml:mi>a</mml:mi></mml:math></inline-formula> can be derived as in:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM129"><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Q</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:msup><mml:mi/><mml:mo>′</mml:mo></mml:msup></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Once <inline-formula><mml:math id="inf161"><mml:mi>a</mml:mi></mml:math></inline-formula> is estimated, <inline-formula><mml:math id="inf162"><mml:mi>b</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf163"><mml:mi>c</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf164"><mml:mi>d</mml:mi></mml:math></inline-formula> are estimated by corresponding Equations in <xref ref-type="bibr" rid="bib37">Reinsch (1967)</xref>.</p><p>For our specific setting, we also introduce a regularization parameter to enable us to determine the number of control points. Let <inline-formula><mml:math id="inf165"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM131">t</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mi id="XM134">t</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf166"><mml:mi>μ</mml:mi></mml:math></inline-formula> be the spline we are interested in fitting, smoothing spline can be found by the following optimization problem which minimizes penalized least-squares error:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM143">t</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM144"><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:munder></mml:mpadded><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM146"><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM145">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:msup><mml:mi/><mml:mi>′′</mml:mi></mml:msup></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM147">x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf167"><mml:mi>λ</mml:mi></mml:math></inline-formula> is the regularization parameter which prevents overfitting by affecting the number of knots selected. We estimated <inline-formula><mml:math id="inf168"><mml:mi>λ</mml:mi></mml:math></inline-formula> by leave-one-out cross-validation (LOOCV) in our experiments (See Appendix Methods for details of smoothing spline fitting).</p></sec><sec id="s25" sec-type="appendix"><title>Proteomics analysis</title><p>Proteins were extracted using tissue protein extraction reagent (T-PER, Thermo) as per manufacturer’s instructions, carried out directly on the micro-dissection cap. Protein concentrations was determined with the EZQ protein assay (Life Sciences). The proteins were digested overnight at 37C, followed by acidification to pH <inline-formula><mml:math id="inf169"><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf170"><mml:mrow><mml:mn>10</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula>formic acid (FA), and extracted as per manufacturer’s instructions, then concentrated to near completion using a Savant SpeedVac Concentrator (Thermo) and diluted with <inline-formula><mml:math id="inf171"><mml:mrow><mml:mn>0.1</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> FA to a final concentration of <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> ng \uL for analysis by LCMS. The LCMS data were converted to a universal MzXML file format prior to being searched using SEQEST (Thermo) against a Mouse subset of the UniRef100 database. These data were then uploaded to Scaffold (Proteome Software) in order to filter and group each peptide ID to specific proteins with peptide probability scores set at <inline-formula><mml:math id="inf173"><mml:mrow><mml:mn>80</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula>, and protein probability scores set at <inline-formula><mml:math id="inf174"><mml:mrow><mml:mn>99</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula>. Using only proteins presenting with <inline-formula><mml:math id="inf175"><mml:mn>2</mml:mn></mml:math></inline-formula> or more peptides per protein, the confidence interval was set to <inline-formula><mml:math id="inf176"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>99.9</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with and FDR <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi/><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>. Quantification was carried out using Scaffold Q + using normalized spectral counts.</p></sec></boxed-text></app><app id="app2"><title>Appendix 2 Results</title><boxed-text><sec id="s26" sec-type="appendix"><title>Example of a <italic>TPS</italic> run</title><p>Here we discuss a specific setting for <italic>TPS</italic> that allows us to discuss the set of points selected and their relevance. Specifically, to test <italic>TPS</italic> , we fixed three set points in advance (first (<inline-formula><mml:math id="inf178"><mml:mn>0.5</mml:mn></mml:math></inline-formula>’th day) and last (<inline-formula><mml:math id="inf179"><mml:mn>28</mml:mn></mml:math></inline-formula>’th day), which are required for any setting and day <inline-formula><mml:math id="inf180"><mml:mn>7</mml:mn></mml:math></inline-formula> which was previously determined to be of importance to lung development. Next, we have asked TPS to further select <inline-formula><mml:math id="inf181"><mml:mn>10</mml:mn></mml:math></inline-formula> more points (for a total of <inline-formula><mml:math id="inf182"><mml:mn>13</mml:mn></mml:math></inline-formula>). For this setting, the method selected the following points: <inline-formula><mml:math id="inf183"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf184"><mml:mn>1.0</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:mn>1.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf186"><mml:mn>2.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf187"><mml:mn>4</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf188"><mml:mn>5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf189"><mml:mn>7</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf190"><mml:mn>10</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf191"><mml:mn>13.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf192"><mml:mn>15</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf193"><mml:mn>19</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf194"><mml:mn>23</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf195"><mml:mn>28</mml:mn></mml:math></inline-formula>. While we do not know the ground truth, the larger focus on the earlier time points determined by the method (with <inline-formula><mml:math id="inf196"><mml:mn>7</mml:mn></mml:math></inline-formula> of the <inline-formula><mml:math id="inf197"><mml:mn>13</mml:mn></mml:math></inline-formula> points for the first <inline-formula><mml:math id="inf198"><mml:mn>7</mml:mn></mml:math></inline-formula> days) makes sense in this context as several aspects of lung differentiation are determined in the first week (<xref ref-type="bibr" rid="bib22">Guilliams et al., 2013</xref>). The other <inline-formula><mml:math id="inf199"><mml:mn>3</mml:mn></mml:math></inline-formula> weeks were more or less uniformly sampled by our <italic>TPS</italic> . This highlights the usefulness of an unbiased approach to sampling time points rather than just uniformly sampling through the time window.</p></sec><sec id="s27" sec-type="appendix"><title><italic>TPS</italic> identifies subset of important time points across multiple genes</title><p>To understand whether gene-expression profiles over time has a simple trend, we also compare the reconstruction performance of <italic>TPS</italic> with fitting piecewise linear curves between initial and middle time points and between middle and last time points. The reconstruction error by <italic>TPS</italic> is significantly better than the piecewise linear reconstruction for <inline-formula><mml:math id="inf200"><mml:mn>102</mml:mn></mml:math></inline-formula> genes out of <inline-formula><mml:math id="inf201"><mml:mn>126</mml:mn></mml:math></inline-formula> genes. We have plotted the comparison of reconstruction for several of these genes as in <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>. The distribution of error difference between these methods looks significantly different than normal distribution (<inline-formula><mml:math id="inf202"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math></inline-formula> by Shapiro-Wilk test).</p></sec><sec id="s28" sec-type="appendix"><title>miRNA clusters are enriched for several biological processes</title><p>While the mRNA datasets includes only a handful of genes (less than 0.5% of all genes) the miRNA data includes more profiles and so further analysis of this data can be perfromed. We have performed clustering of the miRNA data using k-means (<xref ref-type="bibr" rid="bib23">Hartigan, 1975</xref>) where the number of clusters is selected by Bayesian Information Criteria (<xref ref-type="bibr" rid="bib43">Schwarz, 1978</xref>) leading to <inline-formula><mml:math id="inf203"><mml:mn>8</mml:mn></mml:math></inline-formula> stable miRNA clusters <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>. Next, we mapped miRNA’s to predicted targets using TargetScan (<xref ref-type="bibr" rid="bib1">Agarwal et al., 2015</xref>), and performed gene-enrichment analysis by FuncAssociate (<xref ref-type="bibr" rid="bib5">Berriz et al., 2003</xref>). We find clusters to be enriched for several Gene Ontology biological processes (<xref ref-type="bibr" rid="bib2">Ashburner et al., 2000</xref>). For instance, cluster <inline-formula><mml:math id="inf204"><mml:mn>4</mml:mn></mml:math></inline-formula> is enriched for single-organism cellular process, positive regulation of biological process, regulation of metabolic process, etc. See Supporting Website for complete results.</p></sec><sec id="s29" sec-type="appendix"><title>miRNA reconstruction</title><p><xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> presents the reconstructed and measured expression values for a few miRNAs based on time points identified using the mRNA dataset. Several of these miRNAs are known to be involved in regulation of lung development. For example, <italic>mmu-miR-100</italic> is known to regulate <italic>Fgfr3</italic> and <italic>Igf1r</italic>, <italic>mmu-miR-136</italic> targets <italic>Tgfb2</italic>, <italic>mmu-miR-152</italic> targets <italic>Meox2, Robo1, Fbn1, Nfya</italic> (<xref ref-type="bibr" rid="bib36">Popova et al., 2014</xref>). Additional figures for all miRNAs and mRNAs are avialable on the supporting website.</p></sec><sec id="s30" sec-type="appendix"><title>TPS application to select time points for proteomics analysis</title><p>We used mass spectrometry to profile the levels of <inline-formula><mml:math id="inf205"><mml:mn>1020</mml:mn></mml:math></inline-formula> proteins over the optimal <inline-formula><mml:math id="inf206"><mml:mn>13</mml:mn></mml:math></inline-formula> time points determined by <italic>TPS</italic> (using the mRNA expression data): <inline-formula><mml:math id="inf207"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn id="XM148">0.5</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM149">1.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM150">1.5</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM151">2.5</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM152">4.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM153">5.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM154">7.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM155">10.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM156">13.5</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM157">15.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM158">19.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM159">23.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM160">28.0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>). To test the ability of <italic>TPS</italic> to determine the optimal time points for the proeomics data (based only on the mRNA data) we performed a similar analysis to the analysis performed for the miRNA data. Specifically, we used <italic>TPS</italic> to select subset of <inline-formula><mml:math id="inf208"><mml:mn>4</mml:mn></mml:math></inline-formula> to <inline-formula><mml:math id="inf209"><mml:mn>12</mml:mn></mml:math></inline-formula> of these points <italic>based on the mRNA data</italic> and compared the error using these points to random and uniform selection of the same number of points. The results are presented in . In addition to comparing <italic>TPS</italic> to random and uniform we have also compared different strategies for initializing the set of points as discussed in Method. Finally, the figure also presents the repeat noise values which is the theoretical limit for the performance of any profile reconstruction method.</p><p>As for the miRNA data, we see a significant and consistent improvement (for all number of selected time points) over uniform sampling highlighting the advantage of condition specific sampling decisions. Again, as the number of points used by <italic>TPS</italic> increases, it leads to results that are very close to the error represented by noise in the data (<inline-formula><mml:math id="inf210"><mml:mn>17.47</mml:mn></mml:math></inline-formula>).</p></sec><sec id="s31" sec-type="appendix"><title>Analysis of methylation data</title><p>Methylation data included <inline-formula><mml:math id="inf211"><mml:mn>3</mml:mn></mml:math></inline-formula> repeats for time points <inline-formula><mml:math id="inf212"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf213"><mml:mn>1.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf214"><mml:mn>2.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf215"><mml:mn>5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf216"><mml:mn>10</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf217"><mml:mn>15</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf218"><mml:mn>19</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf219"><mml:mn>26</mml:mn></mml:math></inline-formula> for <inline-formula><mml:math id="inf220"><mml:mn>266</mml:mn></mml:math></inline-formula> loci belonging to <inline-formula><mml:math id="inf221"><mml:mn>13</mml:mn></mml:math></inline-formula> genes. Among these genes all except <italic>Zfp536</italic> were also profiled in our nanostring mRNA analysis. <xref ref-type="table" rid="A2-tbl2">Appendix 2—Table 2</xref> summarizes the number of loci for each gene in the methylation dataset. We used shifted percentage of methylation at each time point in our analysis which is obtained by subtracting the median percentage of methylation at initial time point (baseline) from all data points for each gene. <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref> presents the best positive or negative correaltion observed between the methylation data and the gene expression data for these genes (note that we do not expect all up stream regions to show a correlated profile since it is likely that only a subset, or even a single, region is responsible for the changes in expression observed which is why we look for the most correlated or anti-correlated region).</p></sec><sec id="s32" sec-type="appendix"><title>Importance of correct determination of expression profiles</title><p>As shown in <xref ref-type="fig" rid="fig6">Figure 6</xref> in the main text, TPS results differ from prior methods when reconstructing expression profiles for several genes. Below we discuss the significance of these differences and their impact on the ability to correctly assign function to that gene:</p><list list-type="bullet"><list-item><p><italic>Nol3</italic>: Nucleolar protein 3 (apotosis repressor with CAR domain) gene (also called <italic>ARC</italic>) encodes a protein that inhibits apoptosis, by decreasing activities of Caspases 2 and 8 and tumor protein p53. Evaluation of the TPS profile suggests that the increase in Nol3 correlates with postnatal lung development, with a rapid increase from birth until 2 weeks of age, followed by stabilization, while the prior sampling rates show only an initial peak and then decrease. While the exact role of <italic>Nol3</italic> in lung development has not been established, it is known that <italic>Nol3</italic> protects pulmonary arterial smooth muscle cells from hypoxia-induced death and facilitates growth factor-induced proliferation and hypertrophy, and is probably involved in human pulmonary hypertension (<xref ref-type="bibr" rid="bib56">Turi et al., 1990</xref>). <italic>Nol3</italic> is a regulator of myogenic differentiation (<xref ref-type="bibr" rid="bib25">Hunter et al., 2007</xref>) and its pattern of expression suggests that it may be important in regulating pulmonary airway and vascular smooth muscle development and differentiation.</p></list-item><list-item><p><italic>Esr2</italic>: The gene estrogen receptor beta encodes a receptor for estrogen, and is important in regulating lung development and modulating differences in lung development between males and females (<xref ref-type="bibr" rid="bib21">Gortner et al., 2013</xref>). Evaluation of the TPS profile suggests that the <italic>Esr2</italic> decreases briefly after birth, followed by an increase from around day 5 until day 20 whereas non-optimized profile suggests a relatively flat profile. While fetal mouse lungs express both <italic>Esr2</italic> alpha and beta, adult mouse lungs express only <italic>Esr2</italic> beta consistent with the TPSresults (<xref ref-type="bibr" rid="bib12">Carvalho and Goncalves, 2012</xref>).</p></list-item><list-item><p><italic>Igfbp3</italic>: Insulin-like growth factor binding protein 3 ( <italic>Igfbp3</italic>) belongs to the Igfbp family and has a Igfbp domain and a thyroglobulin type-I domain (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/gene/3486">http://www.ncbi.nlm.nih.gov/gene/3486</ext-link>). The TPS profile for <italic>Igfbp3</italic> is very different from the non-optimized profile, suggesting that important biological information is lost when not using the TPS profile. <italic>Igfbp3</italic> regulates the induction of TNC by TGF-beta (<xref ref-type="bibr" rid="bib10">Brissett et al., 2012</xref>) and both these molecules are critical in lung alveolar septation.</p></list-item><list-item><p><italic>Wif1</italic>: <italic>Wnt</italic> inhibitory factor 1 ( <italic>WIF1</italic>) inhibits Wnt proteins, that are well known to be critical in many stages of lung development. The TPS profile is very different from the non-optimized profile, as the TPS profile indicates a much earlier and higher peak of <italic>WIF1</italic> during postnatal lung development that may be critical in alveolar septation. <italic>WIF1</italic> is a target gene for Smad1, one of the <italic>BMP</italic> receptor proteins important in lung development and maturation. A regulatory loop of <italic>Bmp4-Smad1-Wif1-Wnt/beta-catenin</italic> may coordinate <italic>BMP</italic> and <italic>Wnt</italic> pathways to control lung development (<xref ref-type="bibr" rid="bib61">Xu et al., 2011</xref>), and dysregulation of the <italic>Smad1/Wif1</italic> axis is associated with lung hypoplasia (<xref ref-type="bibr" rid="bib19">Fujiwara et al., 2012</xref>).</p></list-item><list-item><p><italic>Inmt</italic>: Indolethylamine N-methyl transferase (<italic>Inmt</italic>) gene encodes an enzyme that N-methylates indoles such as tryptamine (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/gene/11185">http://www.ncbi.nlm.nih.gov/gene/11185</ext-link>). The TPS profile for <italic>Inmt</italic> is very different from the non-optimized profile, as the TPS profile indicates a much lower and prolonged reduction of <italic>Inmt</italic> during postnatal lung development. Methyl conjugation is an important pathway in the metabolism of many drugs, neurotransmitters, and xenobiotic compounds (<xref ref-type="bibr" rid="bib55">Thompson and Weinshilboum, 1998</xref>). While it is known that <italic>Inmt</italic> expression varies over the course of human lung development (<xref ref-type="bibr" rid="bib27">Kopantzev et al., 2008</xref>), its exact role in lung development is not known.</p></list-item><list-item><p><italic>Fgf18</italic>: Fibroblast growth factor 18 (<italic>Fgf18</italic>) is a member of the fibroblast growth factor family, and the Fgfs are well known to be critical in multiple stages of lung development. The non-optimized profile indicates a smaller and later peak, and is not similar to the TPS profile which suggests a much more improtant role.<italic>Fgf18</italic> is a pleiotropic growth factor that stimulates proliferation in a number of tissues (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/gene/8817">http://www.ncbi.nlm.nih.gov/gene/8817</ext-link>). <italic>Fgf18</italic> is highly expressed in the developing lung as the TPS profile indicates (<xref ref-type="bibr" rid="bib34">Ohbayashi et al., 1998</xref>), and Fgfr3 is important in postnatal alveolar development (<xref ref-type="bibr" rid="bib59">Weinstein et al., 1998</xref>). The role of <italic>Fgf18</italic> in regulating fibroblast proliferation (<xref ref-type="bibr" rid="bib24">Hu et al., 1999</xref>) may be important in alveolar septation, as <italic>Fgf18</italic> increases after birth with a peak around P10, with reduction after completion of alveolar septation.</p></list-item></list><table-wrap id="A2-tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.026</object-id><label>Appendix 2—table 1.</label><caption><p>List of genes used for the Nanostring analysis and the rational for their inclusion.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.026">http://dx.doi.org/10.7554/eLife.18541.026</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Ensembl gene ID</th><th>Accession number</th><th><italic>Gene name</italic></th><th>Rationale</th></tr></thead><tbody><tr><td>ENSMUSG00000024130</td><td>NM_001039581.2</td><td><italic>Abca3</italic></td><td>Alveolar Type II cell marker</td></tr><tr><td>ENSMUSG00000031378</td><td>NM_007435.1</td><td><italic>Abcd1</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000029802</td><td>NM_011920.3</td><td><italic>Abcg2</italic></td><td>Mesenchymal cell marker</td></tr><tr><td>ENSMUSG00000035783</td><td>NM_007392.3</td><td><italic>Acta2</italic></td><td>Fibroblast cell marker</td></tr><tr><td>ENSMUSG00000029580</td><td>NM_007393.1</td><td><italic>Actb</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000036040</td><td>NM_029981.1</td><td><italic>Adamtsl2</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000015452</td><td>NM_007425.2</td><td><italic>Ager</italic></td><td>Alveolar Type I cell marker</td></tr><tr><td>ENSMUSG00000001729</td><td>NM_001165894.1</td><td><italic>Akt1</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000053279</td><td>NM_013467.3</td><td><italic>Aldh1a1</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000013584</td><td>NM_009022.3</td><td><italic>Aldh1a2</italic></td><td>Potentially important for septation</td></tr><tr><td>ENSMUSG00000022244</td><td>NM_008537.4</td><td><italic>Amacr</italic></td><td>important in other processes (IPF , COPD etc)</td></tr><tr><td>ENSMUSG00000044217</td><td>NM_009701.4</td><td><italic>Aqp5</italic></td><td>Alveolar Type I cell marker</td></tr><tr><td>ENSMUSG00000026576</td><td>NM_009721.5</td><td><italic>Atp1b1</italic></td><td>Lung fluid clearance</td></tr><tr><td>ENSMUSG00000060802</td><td>NM_009735.3</td><td><italic>B2m</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000102037</td><td>NM_009742.3</td><td><italic>Bcl2a1a</italic></td><td>Apoptosis regulator</td></tr><tr><td>ENSMUSG00000056216</td><td>NM_009884.3</td><td><italic>Cebpg</italic></td><td>Important for lung development</td></tr><tr><td>ENSMUSG00000029084</td><td>NM_007646.4</td><td><italic>Cd38</italic></td><td>Airway smooth muscle cell functional responses</td></tr><tr><td>ENSMUSG00000018774</td><td>NM_009853.1</td><td><italic>Cd68</italic></td><td>Monocyte cell marker</td></tr><tr><td>ENSMUSG00000031673</td><td>NM_009866.4</td><td><italic>Cdh1</italic></td><td>Epithelial cell marker</td></tr><tr><td>ENSMUSG00000064246</td><td>NM_007695.2</td><td><italic>Chil1</italic></td><td>Monocyte cell marker</td></tr><tr><td>ENSMUSG00000040809</td><td>NM_009892.1</td><td><italic>Chil3</italic></td><td>Increased during septation</td></tr><tr><td>ENSMUSG00000022512</td><td>NM_016674.3</td><td><italic>Cldn1</italic></td><td>Tight junction protein</td></tr><tr><td>ENSMUSG00000070473</td><td>NM_009902.4</td><td><italic>Cldn3</italic></td><td>Tight junction protein (mostly epithelial)</td></tr><tr><td>ENSMUSG00000041378</td><td>NM_013805.4</td><td><italic>Cldn5</italic></td><td>Tight junction protein</td></tr><tr><td>ENSMUSG00000018569</td><td>NM_016887.6</td><td><italic>Cldn7</italic></td><td>Tight junction protein (mostly epithelial)</td></tr><tr><td>ENSMUSG00000001506</td><td>NM_007742.3</td><td><italic>Col1a1</italic></td><td>Fibroblast cell marker</td></tr><tr><td>ENSMUSG00000063063</td><td>NM_009819.2</td><td><italic>Ctnna2</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000031360</td><td>NM_001168571.1</td><td><italic>Ctps2</italic></td><td>important in other processes (IPF , COPD etc)</td></tr><tr><td>ENSMUSG00000040856</td><td>NM_010052.4</td><td><italic>Dlk1</italic></td><td>Decreased during septation</td></tr><tr><td>ENSMUSG00000020661</td><td>NM_007872.4</td><td><italic>Dnmt3a</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000046179</td><td>NM_001013368.5</td><td><italic>E2f8</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000000303</td><td>NM_009864.2</td><td><italic>Cdh1</italic></td><td>Epithelial cell marker</td></tr><tr><td>ENSMUSG00000020122</td><td>NM_207655.2</td><td><italic>Egfr</italic></td><td>Important for lung development</td></tr><tr><td>ENSMUSG00000029675</td><td>NM_007925.3</td><td><italic>Eln</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000045394</td><td>NM_008532.2</td><td><italic>Epcam</italic></td><td>Epithelial cell marker</td></tr><tr><td>ENSMUSG00000052504</td><td>NM_010140.3</td><td><italic>Epha3</italic></td><td>Involved in lung development</td></tr><tr><td>ENSMUSG00000028289</td><td>NM_001122889.1</td><td><italic>Epha7</italic></td><td>Involved in lung cancer, potential role in development</td></tr><tr><td>ENSMUSG00000021055</td><td>NM_010157.3</td><td><italic>Esr2</italic></td><td>Important regulator of multiple processes</td></tr><tr><td>ENSMUSG00000061731</td><td>NM_010162.2</td><td><italic>Ext1</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000039109</td><td>NM_001166391.1</td><td><italic>F13a1</italic></td><td>Involved in lung injury , cancer</td></tr><tr><td>ENSMUSG00000057967</td><td>NM_008005.1</td><td><italic>Fgf18</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000030849</td><td>NM_010207.2</td><td><italic>Fgfr2</italic></td><td>Important regulator of multiple processes</td></tr><tr><td>ENSMUSG00000078302</td><td>NM_008242.2</td><td><italic>Foxd1</italic></td><td>Pericyte cell marker</td></tr><tr><td>ENSMUSG00000042812</td><td>NM_010426.1</td><td><italic>Foxf1</italic></td><td>Involved in lung development</td></tr><tr><td>ENSMUSG00000038402</td><td>NM_010225.1</td><td><italic>Foxf2</italic></td><td>Altered DNA methylation during fibrosis</td></tr><tr><td>ENSMUSG00000001020</td><td>NM_011311.1</td><td><italic>S100a4</italic></td><td>Fibroblast cell marker</td></tr><tr><td>ENSMUSG00000057666</td><td>NM_001001303.1</td><td><italic>Gapdh</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000005836</td><td>NM_010258.3</td><td><italic>Gata6</italic></td><td>Important regulator of multiple processes</td></tr><tr><td>ENSMUSG00000029992</td><td>NM_013528.3</td><td><italic>Gfpt1</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000041624</td><td>NM_001033322.2</td><td><italic>Gucy1a2</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000025534</td><td>NM_010368.1</td><td><italic>Gusb</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000021109</td><td>NM_010431.2</td><td><italic>Hif1a</italic></td><td>Hypoxia signaling</td></tr><tr><td>ENSMUSG00000058773</td><td>NM_020034.1</td><td><italic>Hist1h1b</italic></td><td>Decreased during septation</td></tr><tr><td>ENSMUSG00000061615</td><td>NM_175660.3</td><td><italic>Hist1h2ab</italic></td><td>Decreased during septation</td></tr><tr><td>ENSMUSG00000032126</td><td>NM_013551.2</td><td><italic>Hmbs</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000029919</td><td>NM_019455.4</td><td><italic>Hpgds</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000025630</td><td>NM_013556.2</td><td><italic>Hprt</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000020053</td><td>NM_001111274.1</td><td><italic>Igf1</italic></td><td>Regulating miRNA altered during septation</td></tr><tr><td>ENSMUSG00000020427</td><td>NM_008343.2</td><td><italic>Igfbp3</italic></td><td>Altered DNA methylation during septation, fibrosis</td></tr><tr><td>ENSMUSG00000003477</td><td>NM_009349.3</td><td><italic>Inmt</italic></td><td>Increased during septation</td></tr><tr><td>ENSMUSG00000026768</td><td>NM_001001309.2</td><td><italic>Itga8</italic></td><td>Involved in lung development</td></tr><tr><td>ENSMUSG00000040029</td><td>NM_001081113.1</td><td><italic>Ipo8</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000030786</td><td>NM_001082960.1</td><td><italic>Itgam</italic></td><td>Monocyte cell marker</td></tr><tr><td>ENSMUSG00000030789</td><td>NM_021334.2</td><td><italic>Itgax</italic></td><td>Monocyte cell marker</td></tr><tr><td>ENSMUSG00000090122</td><td>NM_021487.1</td><td><italic>Kcne1l</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000063142.10</td><td>XM_006518608.1</td><td><italic>Kcnma1</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000079852</td><td>NM_010649.3</td><td><italic>Klra4</italic></td><td>Increased during septation</td></tr><tr><td>ENSMUSG00000023043</td><td>NM_010664.2</td><td><italic>Krt18</italic></td><td>Epithelial cell marker</td></tr><tr><td>ENSMUSG00000061527</td><td>NM_027011.2</td><td><italic>Krt5</italic></td><td>Basal cell marker</td></tr><tr><td>ENSMUSG00000029570</td><td>NM_008494.3</td><td><italic>Lfng</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000024529</td><td>NM_010728.2</td><td><italic>Lox</italic></td><td>Altered DNA methylation during fibrosis</td></tr><tr><td>ENSMUSG00000028003</td><td>NM_023624.4</td><td><italic>Lrat</italic></td><td>Increased during septation</td></tr><tr><td>ENSMUSG00000027070</td><td>NM_001081088.1</td><td><italic>Lrp2</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000061068</td><td>NM_010779.2</td><td><italic>Mcpt4</italic></td><td>Decreased during septation</td></tr><tr><td>ENSMUSG00000026110</td><td>NM_173870.2</td><td><italic>Mgat4a</italic></td><td>Involved in acute lung injury</td></tr><tr><td>ENSMUSG00000043613</td><td>NM_010809.1</td><td><italic>Mmp3</italic></td><td>Increased during septation</td></tr><tr><td>ENSMUSG00000018623</td><td>NM_010810.4</td><td><italic>Mmp7</italic></td><td>Important in lung fibrosis</td></tr><tr><td>ENSMUSG00000066108</td><td>XM_006508653.1</td><td><italic>Muc5b</italic></td><td>Important in lung fibrosis</td></tr><tr><td>ENSMUSG00000037974</td><td>NM_010844.1</td><td><italic>Muc5ac</italic></td><td>Epithelial cell marker</td></tr><tr><td>ENSMUSG00000024304</td><td>NM_007664.4</td><td><italic>Cdh2</italic></td><td>Tight Junction/Adhesion</td></tr><tr><td>ENSMUSG00000054008</td><td>NM_008306.4</td><td><italic>Ndst1</italic></td><td>Involved in pathologic airway remodeling</td></tr><tr><td>ENSMUSG00000031902</td><td>NM_010901.2</td><td><italic>Nfatc3</italic></td><td>Important for lung development</td></tr><tr><td>ENSMUSG00000073435</td><td>NM_019730.2</td><td><italic>Nme3</italic></td><td>Apoptosis-related gene</td></tr><tr><td>ENSMUSG00000026575</td><td>NM_138314.3</td><td><italic>Nme7</italic></td><td>Important for stem cell renewal</td></tr><tr><td>ENSMUSG00000014776</td><td>NM_030152.4</td><td><italic>Nol3</italic></td><td>Regulating miRNA altered during septation</td></tr><tr><td>ENSMUSG00000051048</td><td>NM_177161.4</td><td><italic>P4ha3</italic></td><td>Important in lung fibrosis</td></tr><tr><td>ENSMUSG00000068039</td><td>NM_013686.3</td><td><italic>Tcp1</italic></td><td>Basal cell marker</td></tr><tr><td>ENSMUSG00000029998</td><td>NM_025823.4</td><td><italic>Pcyox1</italic></td><td>important in other processes (IPF , COPD etc)</td></tr><tr><td>ENSMUSG00000029231</td><td>NM_011058.2</td><td><italic>Pdgfra</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000024620</td><td>NM_008809.1</td><td><italic>Pdgfrb</italic></td><td>Pericyte cell marker</td></tr><tr><td>ENSMUSG00000028583</td><td>NM_010329.2</td><td><italic>Pdpn</italic></td><td>Alveolar Type I cell marker</td></tr><tr><td>ENSMUSG00000062070</td><td>NM_008828.2</td><td><italic>Pgk1</italic></td><td>important in other processes (IPF , COPD etc)</td></tr><tr><td>ENSMUSG00000053398</td><td>NM_016966.3</td><td><italic>Phgdh</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000005198</td><td>NM_009089.2</td><td><italic>Polr2a</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000071866</td><td>NM_008907.1</td><td><italic>Ppia</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000024997</td><td>NM_007452.2</td><td><italic>Prdx3</italic></td><td>Mitochondrial oxidative stress regulator</td></tr><tr><td>ENSMUSG00000026134</td><td>NM_008922.2</td><td><italic>Prim2</italic></td><td>Expressed in placenta and crucial for mammalian growth.</td></tr><tr><td>ENSMUSG00000033491</td><td>NM_178738.3</td><td><italic>Prss35</italic></td><td>Decreased during septation</td></tr><tr><td>ENSMUSG00000032487</td><td>NM_011198.3</td><td><italic>Ptgs2</italic></td><td>Regulating miRNA altered during septation</td></tr><tr><td>ENSMUSG00000056458</td><td>NM_011973.2</td><td><italic>Mok</italic></td><td>Alveolar Type I cell marker</td></tr><tr><td>ENSMUSG00000037992</td><td>NM_001177302.1</td><td><italic>Rara</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000022883</td><td>NM_019413.2</td><td><italic>Robo1</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000025508</td><td>NM_026020.6</td><td><italic>Rplp2</italic></td><td/></tr><tr><td>ENSMUSG00000066361</td><td>NM_008458.2</td><td><italic>Serpina3c</italic></td><td>Increased during septation</td></tr><tr><td>ENSMUSG00000022097</td><td>NM_011359.1</td><td><italic>Sftpc</italic></td><td>Alveolar Type II cell marker</td></tr><tr><td>ENSMUSG00000021795</td><td>NM_009160.2</td><td><italic>Sftpd</italic></td><td>Alveolar Type II cell marker</td></tr><tr><td>ENSMUSG00000050010</td><td>NM_001033415.3</td><td><italic>Shisa3</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000032402</td><td>NM_016769.3</td><td><italic>Smad3</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000042821</td><td>NM_011427.2</td><td><italic>Snai1</italic></td><td>Important for lung development and injury</td></tr><tr><td>ENSMUSG00000000567</td><td>NM_011448.4</td><td><italic>Sox9</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000027646</td><td>NM_001025395.2</td><td><italic>Src</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000014767</td><td>NM_013684.3</td><td><italic>Tbp</italic></td><td>Common house-keeping gene , involved in multiple processes</td></tr><tr><td>ENSMUSG00000000094</td><td>NM_172798.1</td><td><italic>Tbx4</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000032228</td><td>NM_011544.3</td><td><italic>Tcf12</italic></td><td>Involved in multiple developmental processes</td></tr><tr><td>ENSMUSG00000022797</td><td>NM_011638.3</td><td><italic>Tfrc</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000002603</td><td>NM_011577.1</td><td><italic>Tgfb1</italic></td><td>Important for septation</td></tr><tr><td>ENSMUSG00000045691</td><td>NM_153083.5</td><td><italic>Thtpa</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000032011</td><td>NM_009382.3</td><td><italic>Thy1</italic></td><td>Fibroblast cell marker</td></tr><tr><td>ENSMUSG00000028364</td><td>NM_011607.1</td><td><italic>Tnc</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000044986</td><td>NM_009437.4</td><td><italic>Tst</italic></td><td>important in other processes (IPF, COPD etc)</td></tr><tr><td>ENSMUSG00000026803</td><td>NM_009442.2</td><td><italic>Ttf1</italic></td><td>Important for lung development</td></tr><tr><td>ENSMUSG00000008348</td><td>NM_019639.4</td><td><italic>Ubc</italic></td><td>Common house-keeping gene</td></tr><tr><td>ENSMUSG00000023951</td><td>NM_001025250.3</td><td><italic>Vegfa</italic></td><td>Angiogenesis; Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000026728</td><td>NM_011701.4</td><td><italic>Vim</italic></td><td>Mesenchymal cell marker</td></tr><tr><td>ENSMUSG00000020218</td><td>NM_011915.1</td><td><italic>Wif1</italic></td><td>Altered DNA methylation during septation</td></tr><tr><td>ENSMUSG00000022285</td><td>NM_011740.2</td><td><italic>Ywhaz</italic></td><td>Common house-keeping gene</td></tr></tbody></table></table-wrap><table-wrap id="A2-tbl2" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.027</object-id><label>Appendix 2—table 2.</label><caption><p>Summary of methylation dataset</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.027">http://dx.doi.org/10.7554/eLife.18541.027</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Gene</th><th>Number of loci</th><th/><th>Gene</th><th>Number of loci</th></tr></thead><tbody><tr><td><italic>Cdh11</italic></td><td>14</td><td/><td><italic>Zfp536</italic></td><td>16</td></tr><tr><td><italic>Src</italic></td><td>11</td><td/><td><italic>Igfbp3</italic></td><td>34</td></tr><tr><td><italic>Sox9</italic></td><td>16</td><td/><td><italic>Wif1</italic></td><td>21</td></tr><tr><td><italic>Dnmt3a</italic></td><td>41</td><td/><td><italic>Vegfa</italic></td><td>20</td></tr><tr><td><italic>Eln</italic></td><td>20</td><td/><td><italic>Tnc</italic></td><td>4</td></tr><tr><td><italic>Foxf2</italic></td><td>41</td><td/><td><italic>Lox</italic></td><td>17</td></tr><tr><td><italic>Akt1</italic></td><td>11</td><td/><td/><td/></tr></tbody></table></table-wrap><table-wrap id="A2-tbl3" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.028</object-id><label>Appendix 2—table 3.</label><caption><p>Target regions for each gene for methylation analysis</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.028">http://dx.doi.org/10.7554/eLife.18541.028</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th><italic>Gene</italic></th><th>Ensembl gene ID</th><th>Ensembl transcript ID</th><th>Assay ID</th><th>Target location</th><th>Fwd Tm</th><th>Rev Tm</th><th>% GC</th><th>Coordinates (GRCm38/mm10)</th></tr></thead><tbody><tr><td><italic>Akt1</italic></td><td>ENSMUSG00000001729</td><td>ENSMUST00000001780</td><td>ADS3333</td><td>3’ UTR</td><td>68</td><td>65.5</td><td>31.5</td><td>chr12:112654548–112654709</td></tr><tr><td><italic>Akt1</italic></td><td>ENSMUSG00000001729</td><td>ENSMUST00000001780</td><td>ADS3332</td><td>Intron 9/Exon 10</td><td>68.3</td><td>69.8</td><td>38.3</td><td>chr12:112657120–112657273</td></tr><tr><td><italic>Cdh11</italic></td><td>ENSMUSG00000031673</td><td>ENSMUST00000075190</td><td>ADS3308</td><td>Intron 3</td><td>66.8</td><td>68.3</td><td>36.9</td><td>chr8:102677609–102677766</td></tr><tr><td><italic>Cdh11</italic></td><td>ENSMUSG00000031673</td><td>ENSMUST00000075190</td><td>ADS3318</td><td>Intron 1</td><td>64.1</td><td>69.7</td><td>37</td><td>chr8:102784569–102784722</td></tr><tr><td><italic>Cdh11</italic></td><td>ENSMUSG00000031673</td><td>ENSMUST00000075190</td><td>ADS3307</td><td>Promoter</td><td>69.1</td><td>71.3</td><td>29.9</td><td>chr8:102785456–102785649</td></tr><tr><td><italic>Dnmt3a</italic></td><td>ENSMUSG00000020661</td><td>ENSMUST00000020991</td><td>ADS3326</td><td>Promoter</td><td>68.6</td><td>67.7</td><td>47.1</td><td>chr12:3806505–3806659</td></tr><tr><td><italic>Dnmt3a</italic></td><td>ENSMUSG00000020661</td><td>ENSMUST00000020991</td><td>ADS632</td><td>Intron 1</td><td>64</td><td>64.7</td><td>32.2</td><td>chr12:3834382–3834592</td></tr><tr><td><italic>Dnmt3a</italic></td><td>ENSMUSG00000020661</td><td>ENSMUST00000020991</td><td>ADS3328</td><td>Exon 6/Intron 6</td><td>64.7</td><td>64</td><td>31.8</td><td>chr12:3901545–3901764</td></tr><tr><td><italic>Dnmt3a</italic></td><td>ENSMUSG00000020661</td><td>ENSMUST00000020991</td><td>ADS3329</td><td>Intron 6</td><td>66.8</td><td>66.1</td><td>25.4</td><td>chr12:3907514–3907765</td></tr><tr><td><italic>Eln</italic></td><td>ENSMUSG00000029675</td><td>ENSMUST00000015138</td><td>ADS3319</td><td>Intron 16</td><td>67.1</td><td>67.9</td><td>47.8</td><td>chr5:134721191–134721447</td></tr><tr><td><italic>Eln</italic></td><td>ENSMUSG00000029675</td><td>ENSMUST00000015138</td><td>ADS3309</td><td>Intron 7/Exon 8/Intron 8</td><td>64.1</td><td>67.4</td><td>37.8</td><td>chr5:134729221–134729526</td></tr><tr><td><italic>Eln</italic></td><td>ENSMUSG00000029675</td><td>ENSMUST00000015138</td><td>ADS024</td><td>Promoter</td><td>65</td><td>67.4</td><td>42.6</td><td>chr5:134747412–134747606</td></tr><tr><td><italic>Foxf2</italic></td><td>ENSMUSG00000038402</td><td>ENSMUST00000042054</td><td>ADS4505</td><td>Promoter</td><td>63.1</td><td>65</td><td>42.5</td><td>chr13: 31625470–31625556</td></tr><tr><td><italic>Foxf2</italic></td><td>ENSMUSG00000038402</td><td>ENSMUST00000042054</td><td>ADS4506</td><td>5-UTR</td><td>65.1</td><td>64.8</td><td>37.9</td><td>chr13:31625904–31626093</td></tr><tr><td><italic>Foxf2</italic></td><td>ENSMUSG00000038402</td><td>ENSMUST00000042054</td><td>ADS4507</td><td>3-Downstream</td><td>68</td><td>68.9</td><td>28.1</td><td>chr13:31632481–31632716</td></tr><tr><td><italic>Igfbp3</italic></td><td>ENSMUSG00000020427</td><td>ENSMUST00000020702</td><td>ADS5134</td><td>3-Downstream</td><td>69.3</td><td>69.6</td><td>32.1</td><td>chr11:7203969–7204208</td></tr><tr><td><italic>Igfbp3</italic></td><td>ENSMUSG00000020427</td><td>ENSMUST00000020702</td><td>ADS3301</td><td>Exon 4/Intron 4</td><td>70.5</td><td>70</td><td>33</td><td>chr11:7208306–7208481</td></tr><tr><td><italic>Igfbp3</italic></td><td>ENSMUSG00000020427</td><td>ENSMUST00000020702</td><td>ADS5133</td><td>Intron 1</td><td>68.3</td><td>68.5</td><td>26.1</td><td>chr11:7212803–7213043</td></tr><tr><td><italic>Igfbp3</italic></td><td>ENSMUSG00000020427</td><td>ENSMUST00000020702</td><td>ADS5132</td><td>Promoter</td><td>67.8</td><td>69.2</td><td>28.7</td><td>chr11:7214210–7214499</td></tr><tr><td><italic>Lox</italic></td><td>ENSMUSG00000024529</td><td>ENSMUST00000171470</td><td>ADS4512</td><td>Exon 2</td><td>69</td><td>70.9</td><td>31.3</td><td>chr18: 52529184–52529315</td></tr><tr><td><italic>Lox</italic></td><td>ENSMUSG00000024529</td><td>ENSMUST00000171470</td><td>ADS4513</td><td>Exon 4</td><td>65.7</td><td>64.8</td><td>28.5</td><td>chr18:52526887–52527023</td></tr><tr><td><italic>Lox</italic></td><td>ENSMUSG00000024529</td><td>ENSMUST00000171470</td><td>ADS4511</td><td>Promoter</td><td>64.7</td><td>66.4</td><td>21.2</td><td>chr18:52530080–52530216</td></tr><tr><td><italic>Sox9</italic></td><td>ENSMUSG00000000567</td><td>ENSMUST00000000579</td><td>ADS796</td><td>Promoter</td><td>61</td><td>66.1</td><td>31.4</td><td>chr11:112781641–112781811</td></tr><tr><td><italic>Sox9</italic></td><td>ENSMUSG00000000567</td><td>ENSMUST00000000579</td><td>ADS3311</td><td>Intron 1</td><td>69.7</td><td>68.5</td><td>34.7</td><td>chr11:112783358–112783605</td></tr><tr><td><italic>Sox9</italic></td><td>ENSMUSG00000000567</td><td>ENSMUST00000000579</td><td>ADS3310</td><td>Exon 3</td><td>66.4</td><td>63.1</td><td>26.2</td><td>chr11:112784760–112784885</td></tr><tr><td><italic>Src</italic></td><td>ENSMUSG00000027646</td><td>ENSMUST00000109533</td><td>ADS4514</td><td>Intron 1</td><td>64.8</td><td>65.9</td><td>35.9</td><td>chr2:157423925–157424027</td></tr><tr><td><italic>Src</italic></td><td>ENSMUSG00000027646</td><td>ENSMUST00000109533</td><td>ADS4515</td><td>Intron 4</td><td>66.5</td><td>68.8</td><td>37.6</td><td>chr2:157457351–157457520</td></tr><tr><td><italic>Src</italic></td><td>ENSMUSG00000027646</td><td>ENSMUST00000109533</td><td>ADS4516</td><td>Exon 14</td><td>65.5</td><td>65.6</td><td>33.7</td><td>chr2:157469741–157469912</td></tr><tr><td><italic>Tnc</italic></td><td>ENSMUSG00000028364</td><td>ENSMUST00000107377</td><td>ADS3324</td><td>Intron 14</td><td>63.3</td><td>62.2</td><td>23</td><td>chr4:63982645–63982818</td></tr><tr><td><italic>Tnc</italic></td><td>ENSMUSG00000028364</td><td>ENSMUST00000107377</td><td>ADS3325</td><td>Intron 14</td><td>62.5</td><td>61.6</td><td>20.2</td><td>chr4:63982799–63982986</td></tr><tr><td><italic>Tnc</italic></td><td>ENSMUSG00000028364</td><td>ENSMUST00000107377</td><td>ADS3323</td><td>Exon 3</td><td>65</td><td>67.5</td><td>35.2</td><td>chr4:64017478–64017721</td></tr><tr><td><italic>Tnc</italic></td><td>ENSMUSG00000028364</td><td>ENSMUST00000107377</td><td>ADS3322</td><td>Promoter</td><td>62.7</td><td>63.9</td><td>26.7</td><td>chr4:64047034–64047149</td></tr><tr><td><italic>Vegfa</italic></td><td>ENSMUSG00000023951</td><td>ENSMUST00000071648</td><td>ADS3336</td><td>3-UTR</td><td>67.2</td><td>66.9</td><td>32.6</td><td>chr17:46018598–46018735</td></tr><tr><td><italic>Vegfa</italic></td><td>ENSMUSG00000023951</td><td>ENSMUST00000071648</td><td>ADS3335</td><td>Intron 2/Exon 3</td><td>64.6</td><td>63.8</td><td>29.5</td><td>chr17:46025336–46025620</td></tr><tr><td><italic>Wif1</italic></td><td>ENSMUSG00000020218</td><td>ENSMUST00000020439</td><td>ADS3302</td><td>Promoter</td><td>69.4</td><td>68.7</td><td>31.3</td><td>chr10:121033395–121033691</td></tr><tr><td><italic>Wif1</italic></td><td>ENSMUSG00000020218</td><td>ENSMUST00000020439</td><td>ADS3303</td><td>Intron 4/Exon 5/Intron 5</td><td>60.9</td><td>60.1</td><td>31.8</td><td>chr10:121083800–121083997</td></tr><tr><td><italic>Wif1</italic></td><td>ENSMUSG00000020218</td><td>ENSMUST00000020439</td><td>ADS3304</td><td>Exon 10/3-UTR</td><td>66.6</td><td>67.5</td><td>24.8</td><td>chr10:121099752–121099973</td></tr><tr><td><italic>Zfp536</italic></td><td>ENSMUSG00000043456</td><td>ENSMUST00000056338</td><td>ADS4510</td><td>3-Downstream</td><td>65.4</td><td>67.4</td><td>35.9</td><td>chr7:37473451–37473606</td></tr><tr><td><italic>Zfp536</italic></td><td>ENSMUSG00000043456</td><td>ENSMUST00000056338</td><td>ADS4509</td><td>Exon 4</td><td>68.4</td><td>69.9</td><td>35.4</td><td>chr7:37567973–37568130</td></tr></tbody></table></table-wrap><table-wrap id="A2-tbl4" position="float"><object-id pub-id-type="doi">10.7554/eLife.18541.029</object-id><label>Appendix 2—table 4.</label><caption><p>Mean and standard deviation of mean squared error over all <inline-formula><mml:math id="inf222"><mml:mn>126</mml:mn></mml:math></inline-formula> genes by TPS selecting <inline-formula><mml:math id="inf223"><mml:mn>5</mml:mn></mml:math></inline-formula> points and piecewise linear fits over <inline-formula><mml:math id="inf224"><mml:mn>3</mml:mn></mml:math></inline-formula> sets of points identified heuristically in the literature.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.18541.029">http://dx.doi.org/10.7554/eLife.18541.029</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>Mean</th><th>Std dev</th></tr></thead><tbody><tr><td>TPS (<inline-formula><mml:math id="inf225"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf226"><mml:mn>6</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf227"><mml:mn>9.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf228"><mml:mn>19</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf229"><mml:mn>28</mml:mn></mml:math></inline-formula>)</td><td>0.40306335962</td><td>0.2206665163</td></tr><tr><td>Piecewise linear over <inline-formula><mml:math id="inf230"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf231"><mml:mn>7</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf232"><mml:mn>14</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf233"><mml:mn>28</mml:mn></mml:math></inline-formula></td><td>0.594072719494</td><td>0.399642079492</td></tr><tr><td>Piecewise linear over <inline-formula><mml:math id="inf234"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf235"><mml:mn>2</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf236"><mml:mn>14</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf237"><mml:mn>28</mml:mn></mml:math></inline-formula></td><td>0.710967061349</td><td>0.721681860787</td></tr><tr><td>Piecewise linear over <inline-formula><mml:math id="inf238"><mml:mn>0.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf239"><mml:mn>4</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf240"><mml:mn>7</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf241"><mml:mn>14</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf242"><mml:mn>28</mml:mn></mml:math></inline-formula></td><td>0.560990230501</td><td>0.364739525724</td></tr></tbody></table></table-wrap></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.18541.032</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Kundaje</surname><given-names>Anshul</given-names></name><aff id="aff7"><institution>Stanford University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Determining sampling rates for high-throughput time series studies&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aviv Regev as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted these comments in an effort to crystallize our concerns about the novelty of this work. Before we render a binding decision, the Board asks that you respond soon to the essential concerns below in order to help us assess the technical advance you have achieved.</p><p>Summary:</p><p>Time course studies are critical for understanding biological processes. Facilitated by advances in sequencing technologies, high-throughput time series analyses are becoming more and more prevalent, and often more than one type of data is collected for each time point in order to probe/understand various aspects of cellular activity. Selecting the precise time points to use in such studies is challenging and often ad-hoc. In this manuscript, Kleyman et al. describe Time Point Selection (TPS), a method designed to address the problem of determining sampling rates in time series studies. The idea behind TPS is as follows:</p><p>1) start with a small set of genes known to be important for the process to be studied;</p><p>2) use cheap array-based experiments (e.g. NanoString) to measure expression of these genes at a high, uniform, sampling rate;</p><p>3) use the data to infer a subset of points that can be used to optimally &quot;reconstruct&quot; the entire data set from step 2 (importantly, the authors implement a rigorous, spline-based procedure for identifying optimal time points);</p><p>4) use the time points selected in step 3 for the genome-wide experiments.</p><p>The authors applied TPS to lung development in mice, and showed that the time points identified by TPS are better than uniform sampling and even phenotype-based sampling (in terms of reconstructing the mRNA profiles of the selected genes), and can be used not only for time series expression data, but also for miRNA and methylation time series data. The general strategy implemented in TPS has potential and could prove useful for future time course studies.</p><p>Essential concerns:</p><p>1) All the reviewers felt that the method is only compared to the most trivial baselines (uniform and random). E.g. there is no comparison to even the authors’ own 2005 paper on a closely related setup. There are various existing works on selecting knots for splines. One could use them, for example, by first fitting a spline to all the high-rate data, and then select points for that curve. Does TPS work better than non-trivial baselines? The authors must perform systematic comparisons to related work such as Rosa et al. 2012, Optimal Timepoint Sampling in High-Throughput Gene Expression Experiments. Further, the paragraph in the Discussion section showing the advantage of using TPS over phenotype-based sampling should be moved into the main text and presented clearly as this is a critical part of the paper.</p><p>2) All the reviewers also felt the manuscript required additional clarity and specific comments are below.</p><p>3) Since TPS uses an iterative algorithm for solving an optimization problem with many local optima, the initialization procedure is critical. I appreciate the fact the authors tested multiple procedures for initialization, and when using TPS one can try all initialization procedures (and in the end select the one with the best results on the left-out data). It is not clear, however, whether the software implemented by the authors tests all these initialization procedures.</p><p>4) In addition, the initialization metrics/methods are confusing. The Methods and Supplementary Methods sections talk about &quot;uniform&quot;, &quot;intervals of equal sizes&quot;, &quot;max distance&quot;, metricA, metricB, and metricC. But it is not clear what initialization method was used in different analyses/figures. What procedure was used in <xref ref-type="fig" rid="fig1">Figure 1</xref>? The figure caption should mention that. The authors should decide on specific names for the different initialization methods, and use them consistently throughout the paper. Also, some figures present redundant results. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> presents results for &quot;max distance&quot;, metricA, metricB, and metricC. <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> presents &quot;max distance&quot;, metricA, metricB, and metric, random points. So <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> could be removed.</p><p>5) The &quot;iterative improvement&quot; procedures are also confusing. The method presented in Methods optimizes the mean squared error (on the left out data points) by iteratively removing/adding one point at a time. I assume this method was used in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Then, in <xref ref-type="fig" rid="fig2">Figure 2A</xref>, what does &quot;absolute difference mean&quot;? (I assume this refers to an initialization procedure, right?) The way the authors name the combinations of search and initialization procedures in <xref ref-type="fig" rid="fig2">Figure 2</xref> is very confusing. Some names reflect an initialization procedure (Uniform Selection), other a search procedure (Simulated Annealing), others an evaluation criterion (Weighted Error). Thus, the results presented in <xref ref-type="fig" rid="fig2">Figure 2B</xref> are confusing, and neither the caption nor the main text clarify what is being tested. Similarly for <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><p>6) For the miRNA data, the authors perform a comparison of results using mRNA versus miRNA data for deciding the sampling time points. But the way the results are presented is again confusing. In the main text the authors say: &quot;The results are presented in <xref ref-type="fig" rid="fig4">Figure 4</xref>. In addition to the comparison included in the mRNA figure, the miRNA figure includes the optimal results for using the actual miRNA data (as opposed to mRNA data) to select the points.&quot; But the results using the miRNA data are <italic>not</italic> in that figure.</p><p>7) It is nice that the project has a website but it looks mostly incomplete. Can the authors make the site a full-fledged web service so novice users and biologists with no programming background can use the software? Users should be able to upload a time series dataset and receive results with interactive visualization.</p><p>8) There is only one case study. The method is described as a broad method, but since it was applied to one process, it should be stated more carefully that it is a general method. Perhaps the authors should focus on this case study without the need to &quot;sell&quot; the method as the primary focus of the study.</p><p>9) The examples in <xref ref-type="fig" rid="fig6">Figure 6</xref> are impressive. But how typical are they? What is the distribution of MSE across genes with TPS and with predefined timepoints?</p><p>10) Performance curves (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig4">4</xref>). Is the benefit due to a small number of genes, or consistent across the genome? It would be useful to show scatter plot (across genes) of MSE with TPS and with the best baseline.</p><p>11) <xref ref-type="fig" rid="fig5">Figure 5</xref>. How were these three genes selected? Are the correlations surprisingly strong when corrected for multiple comparisons? In 5A, the correlation is probably dominated by an outlier (third green marker) otherwise It is hard to see that the two curves are strongly anti-correlated. A similar outlier is also in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>. Accompanying with a scatter plot would clarify the relation between the two. Also, compute confidence-interval for that correlation using bootstrap.</p><p>12) <xref ref-type="fig" rid="fig2">Figure 2</xref>: Seems that the uniform baseline was omitted from the left panel, please add it. Please also provide error bars for TPS and uniform baseline (on the left panel) by bootstrapping across the set of genes.</p><p>13) Subsection “Identified time points using mRNA data are appropriate for miRNA profiling”, second paragraph: &quot;Using the selected based on mRNA data […] random points (p&lt;0.01)&quot;. What is the p-value for the uniform baseline?</p><p>14) There is a line in the paper that says 'performance is very similar [...].0.43 […] 0.40&quot;. Provide a measure supported by a statistical test.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Selecting the most appropriate time points to profile in high-throughput studies&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Aviv Regev as the Senior Editor, a Reviewing Editor, and two reviewers.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below by the referees. We ask that you pay close attention to these specific items, which we call out here, and are in the specific reviews below:</p><p>1) The revised version still has formatting issues. The response refers to Table 5, but no such table is given; figures are not numbered and provided separately from their captions, which makes it hard to follow and comment.</p><p>2) The new <xref ref-type="fig" rid="fig5">Figure 5</xref> replaced outlier genes. The main text should explain how the 3 examples shown were selected.</p><p>3) We do not see a benefit in having the left panel of <xref ref-type="fig" rid="fig2">Figure 2</xref>. In their response, the authors say they wanted to show the difference between TPS and uniform selection. But panel (A) shows random selection, not uniform selection. Random selection is a made-up baseline designed to make TPS look good. Now that they have better baselines comparisons, the paper does not need it, and panel (A) can be removed.</p><p>4) <xref ref-type="fig" rid="fig3">Figure 3</xref>. Replace &quot;Rem points&quot; with &quot;remaining points&quot;.</p><p>5) The authors mentioned that they &quot;improved the caption of <xref ref-type="fig" rid="fig1">Figure 1</xref> to explicitly state which initialization method is used for each result&quot;. But <xref ref-type="fig" rid="fig1">Figure 1</xref> caption is unchanged. (They did clarify other figure captions.)</p><p>6) The authors added Figure 4—figure supplement 3 to show the performance of TPS trained on miRNA data. But that plot could/should be included directly in <xref ref-type="fig" rid="fig4">Figure 4</xref>. Otherwise it is hard for the reader to compare TPS when trained on mRNA versus miRNA data. Also, since there are several versions of TPS, which one was used in Figure 4—figure supplement 3? These kinds of details are still missing.</p><p>7) Some of the figures are still of inadequate quality. Some plots have a strange aspect ratio (e.g. <xref ref-type="fig" rid="fig5">Figure 5</xref>). Several plots do not have a y-axis label (e.g. <xref ref-type="fig" rid="fig3">Figure 3</xref>). Sometimes the labels are incomplete (e.g. &quot;Error&quot; in the comparison to Singh et al.; is it mean squared error?) Overall, the paper is still difficult to follow. (The fact that all references appear as &quot;?&quot; in the PDF also makes the paper hard to read. I assume the text file was not processed correctly during submission. But shouldn't the author verify that before submitting the paper?)</p><p><italic>Reviewer #1:</italic> </p><p>The authors addressed most of the concerns raised. Most importantly, the authors added some evaluation to other approaches for selecting time points, and replaced results based on outliers.</p><p>The revised version still has formatting issues. The response refers to Table 5, but no such table is given; figures are not numbered and provided separately from their captions, which makes it hard to follow and comment.</p><p><italic>Reviewer #2:</italic> </p><p>The authors addressed several comments from reviewers. I am now ok with the substance of the paper. While it would be useful to see validation on additional data/systems, I appreciate the difficulties in getting additional data sets for further testing of the method.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.18541.033</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential concerns:</italic> </p><p><italic>1) All the reviewers felt that the method is only compared to the most trivial baselines (uniform and random). E.g. there is no comparison to even the authors’ own 2005 paper on a closely related setup. There are various existing works on selecting knots for splines. One could use them, for example, by first fitting a spline to all the high-rate data, and then select points for that curve. Does TPS work better than non-trivial baselines? The authors must perform systematic comparisons to related work such as Rosa et al. 2012, Optimal Timepoint Sampling in High-Throughput Gene Expression Experiments. Further, the paragraph in the Discussion section showing the advantage of using TPS over phenotype-based sampling should be moved into the main text and presented clearly as this is a critical part of the paper.</italic> </p><p>The reviewers are correct that two prior studies (one from our group) have discussed theoretical ideas about determining which points to sample. However, there are a number of key differences between TPS and these prior studies. The most important difference is the fact that both prior methods mentioned above require an iterative process. These methods start by profiling all genes at a small number of time points. Based on these initial experiments they select another time point, profile it etc. until they reach some stopping criteria. This strategy, while theoretically interesting, is not practical (and indeed, to best of our knowledge have not been used so far). The main issue is the fact that such a strategy can take a very long time to complete. Given sample preparations which should be performed several times (at each iteration) and the sequencing itself, which has to be done one at a time, the entire process of selecting the time points can take weeks and even month for an experiment with 20 total time points such as the one we discuss. It is very unlikely that anyone would be willing to spend this much time. In addition, such iterative process introduces several new issues including the fact that each time point is prepared and sequenced on a different day, which has been shown to introduce biases and the fact that there is no real way to tell when to stop. Unlike TPS that starts with oversampling, and can thus determine accuracies for the subset of selected points, the iterative methods cannot compare their final decisions to any true profile and so are much more likely to reach a local minimum. Finally, the Rosa et al. method mentioned above relies on the availability of accuracy of related gene expression experiments. While this may be O.K. for some biological processes that have already been studied, when studying a new process or a new treatment this method cannot be applied since it is likely that no such relevant datasets exist and even if they do exist they may themselves be sampled at the wrong time points and thus no ‘ground truth’ exists for these methods. In contrast, TPS is both practical (requires only additional step), cheap and does not rely on the availability of other high throughput studies for the same system.</p><p>The above discussion refers to convenience and practicality. Given the above comment we also compared the accuracy of TPS to these prior methods. The Rosa et al. implementation did not work and even after consulting with the authors we were unable to use it. We were able to run the Singh et al. method and perform the comparison with that method. As can be seen in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, for all selections of a specific number of time points TPS outperforms the Singh et al. method, in some cases leading to over 40% reduction in reconstruction error.</p><p>We have revised the Introduction to discuss these prior methods and the difference between TPS and these methods and revise the supplement to discuss the comparison between the two methods.</p><p>Based on these comments we have modified the text. First, we moved the paragraph mentioned in the comment from Discussion to Results. We also added the following to Introduction “Relatively little work has focused so far on the selection of time points to sample in high throughput time series studies. […] In addition, these methods employ a stopping criteria that does not take into account the full profile and the Rosa et al. method also requires that related time series expression experiments be used to select the point, which may be problematic when studying new processes or treatments.”</p><p><italic>2) All the reviewers also felt the manuscript required additional clarity and specific comments are below.</italic> </p><p><italic>3) Since TPS uses an iterative algorithm for solving an optimization problem with many local optima, the initialization procedure is critical. I appreciate the fact the authors tested multiple procedures for initialization, and when using TPS one can try all initialization procedures (and in the end select the one with the best results on the left-out data). It is not clear, however, whether the software implemented by the authors tests all these initialization procedures.</italic> </p><p>We have implemented and made available all initialization methods in the software. As we now note in Discussion, since we are optimizing a specific function (MSE for selected genes at the selected time points) all initialization methods can be compared and the solution that leads to the lowest error be used. Thus, the large number of initialization methods should not be a problem for users of the method.</p><p><italic>4) In addition, the initialization metrics/methods are confusing. The Methods and Supplementary Methods sections talk about &quot;uniform&quot;, &quot;intervals of equal sizes&quot;, &quot;max distance&quot;, metricA, metricB, and metricC. But it is not clear what initialization method was used in different analyses/figures. What procedure was used in <xref ref-type="fig" rid="fig1">Figure 1</xref>? The figure caption should mention that. The authors should decide on specific names for the different initialization methods, and use them consistently throughout the paper. Also, some figures present redundant results. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> presents results for &quot;max distance&quot;, metricA, metricB, and metricC. <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> presents &quot;max distance&quot;, metricA, metricB, and metric, random points. So <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> could be removed.</italic> </p><p>As the reviewer suggested, we improved the caption of <xref ref-type="fig" rid="fig1">Figure 1</xref> to explicitly state which initialization method is used for each result. We have also removed <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> from the supplement.</p><p><italic>5) The &quot;iterative improvement&quot; procedures are also confusing. The method presented in Methods optimizes the mean squared error (on the left out data points) by iteratively removing/adding one point at a time. I assume this method was used in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Then, in <xref ref-type="fig" rid="fig2">Figure 2A</xref>, what does &quot;absolute difference mean&quot;? (I assume this refers to an initialization procedure, right?) The way the authors name the combinations of search and initialization procedures in <xref ref-type="fig" rid="fig2">Figure 2</xref> is very confusing. Some names reflect an initialization procedure (Uniform Selection), other a search procedure (Simulated Annealing), others an evaluation criterion (Weighted Error). Thus, the results presented in <xref ref-type="fig" rid="fig2">Figure 2B</xref> are confusing, and neither the caption nor the main text clarify what is being tested. Similarly for <xref ref-type="fig" rid="fig4">Figure 4</xref>.</italic> </p><p>We agree with the reviewer and now explicitly state, in the caption, which names correspond to different initializations for <italic>our iterative method</italic> and which are for baseline / comparison methods that are not iterative.</p><p><italic>6) For the miRNA data, the authors perform a comparison of results using mRNA versus miRNA data for deciding the sampling time points. But the way the results are presented is again confusing. In the main text the authors say: &quot;The results are presented in <xref ref-type="fig" rid="fig4">Figure 4</xref>. In addition to the comparison included in the mRNA figure, the miRNA figure includes the optimal results for using the actual miRNA data (as opposed to mRNA data) to select the points.&quot; But the results using the miRNA data are not in that figure.</italic> </p><p>The reviewer is correct that the results were not shown in the figure. We have now added a new figure with these results (Figure 4—figure supplement 3) and changed the text to: “Figure 4—figure supplement 3 presents the error achieved when using the miRNA data itself to select the set of points (evaluated on the miRNA data). […] For example, when using the 13 selected mRNA points, the average mean squared error is 0.4312 whereas when using the optimal points based on the miRNA data itself the error is 0.4042.”</p><p><italic>7) It is nice that the project has a website but it looks mostly incomplete. Can the authors make the site a full-fledged web service so novice users and biologists with no programming background can use the software? Users should be able to upload a time series dataset and receive results with interactive visualization.</italic> </p><p>The software actually provides a graphical user interface which allows the user to determine how many time points to use by displaying different error levels for different selections and also the optimal time points for each selection. The software would be publicly available but we prefer not to implement it as a webserver. We had good success with prior stand-alone software tools we released (for example STEM and DREM) and the use of this one would also be easy and intuitive. We decided not to provide a webserver since some researchers prefer to not upload new data to public webservers and the ability to use the software on their own machines would be a plus for these individuals whereas it should not be detrimental to others.</p><p><italic>8) There is only one case study. The method is described as a broad method, but since it was applied to one process, it should be stated more carefully that it is a general method. Perhaps the authors should focus on this case study without the need to &quot;sell&quot; the method as the primary focus of the study.</italic> </p><p>While it is indeed focused on one biological process, we believe the analysis is pretty comprehensive. Specifically, we tested it on several different types of high throughput biological data (admittedly for the same process, but still a much more rigorous analysis than prior papers mentioned by the reviewers above). Still, to address this issue we added the following to Discussion “We evaluated TPS on several types of high throughput data. However, we have only tested it so far on data for a specific biological process (lung development in mice). While we believe that such data is both challenging and representative and thus provides a good test case for the method, analysis of additional datasets may identify new challenges that we have not addressed and we leave it to future work to address these.”’</p><p><italic>9) The examples in <xref ref-type="fig" rid="fig6">Figure 6</xref> are impressive. But how typical are they? What is the distribution of MSE across genes with TPS and with predefined timepoints?</italic> </p><p>This comment is addressed by Appendix-Table 4 which shows the difference in error from different sampling rate methods (TPS and prior sampling rates). As can be seen, TPS does much better even when considering the MSE across all genes.</p><p><italic>10) Performance curves (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig4">4</xref>). Is the benefit due to a small number of genes, or consistent across the genome? It would be useful to show scatter plot (across genes) of MSE with TPS and with the best baseline.</italic> </p><p>Again, as shown by the much better means, but also much better STD values (Appendix-Table 4), the performance of TPS is consistently better across most of the genes and is not a function of a few, very noisy, ones.</p><p><italic>11) <xref ref-type="fig" rid="fig5">Figure 5</xref>. How were these three genes selected? Are the correlations surprisingly strong when corrected for multiple comparisons? In 5A, the correlation is probably dominated by an outlier (third green marker) otherwise It is hard to see that the two curves are strongly anti-correlated. A similar outlier is also in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1C</xref>. Accompanying with a scatter plot would clarify the relation between the two. Also, compute confidence-interval for that correlation using bootstrap.</italic> </p><p>Based on this comment we have performed the bootstrapping proposed by the reviewers and we now include the result as <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>. As can be seen, for most genes the observed correlation (based on all points) and the bootstrapped results are quite similar. However, for some genes there is indeed an outlier effect. Based on this result we now only include in <xref ref-type="fig" rid="fig5">Figure 5</xref> genes that show consistent (negative) correlation in the bootstrap analysis. Note that time series methylation studies were only performed for 12 genes and comparison plots for <italic>all</italic> is available on the supporting website.</p><p>We also note that these correlation values are not a major aspect of the paper (the key for us is whether we can reconstruct the curves based on the time points selected) and were mainly presented to show that time series information could be useful to determine relationship between methylation and expression values.</p><p><italic>12) <xref ref-type="fig" rid="fig2">Figure 2</xref>: Seems that the uniform baseline was omitted from the left panel, please add it. Please also provide error bars for TPS and uniform baseline (on the left panel) by bootstrapping across the set of genes.</italic> </p><p>The reason we removed the uniform sampling from 2B is for clarity. We wanted to have one clean figure showing the difference between the standard method (uniform) and the basic TPS method (with a uniform weight and greedy search). Then, after establishing the advantage of the general version of TPS in 2A, we show in 2B that we can further improve its results by improving the search method (either to avoid local minima using Simulated Annealing or when changing the uniform weighting). We now explain this in the caption.</p><p><italic>13) Subsection “Identified time points using mRNA data are appropriate for miRNA profiling”, second paragraph: &quot;Using the selected based on mRNA data […] random points (p&lt;0.01)&quot;. What is the p-value for the uniform baseline?</italic> </p><p>The p-value is based on repeated (100) random samplings of time points and we have now clarified this in the text.</p><p><italic>14) There is a line in the paper that says 'performance is very similar [...].0.43 […] 0.40&quot;. Provide a measure supported by a statistical test.</italic> </p><p>As discussed in the response to 13, we evaluated error significance using errors produced by random sets of points. For these we see standard deviations in the range of 0.05 as can be seen in <xref ref-type="fig" rid="fig4">Figure 4</xref> but the reviewer is correct that ‘similar’ may be misplaced here since we do not provide any statistical guarantees. Instead, we have changed the text to say “As expected, the performance when using the miRNA data itself is better than when using the mRNA data. However, when taking into account the inherent noise in the data the differences are not large. For example, when using the 13 selected mRNA points, the average mean squared error is 0.4312 whereas when using the optimal points based on the miRNA data itself the error is 0.4042.”</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p><italic>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below by the referees. We ask that you pay close attention to these specific items, which we call out here, and are in the specific reviews below:</italic> </p><p><italic>1) The revised version still has formatting issues. The response refers to Table 5, but no such table is given; figures are not numbered and provided separately from their captions, which makes it hard to follow and comment.</italic> </p><p>This is indeed our mistake. Table 5 should have been referring to Appendix-Table 4 and we have now fixed all references in the text to the correct table. As for the comment about the figures, this is because of the <italic>eLife</italic> upload instructions and policy. In the initial version we uploaded figures and captions together but were told by the journal editorial team to upload figures separately. We believe this would be fixed after acceptance.</p><p><italic>2) The new <xref ref-type="fig" rid="fig5">Figure 5</xref> replaced outlier genes. The main text should explain how the 3 examples shown were selected.</italic> </p><p>Indeed, in response to a comment in the initial round of review we replaced some of the genes presented in <xref ref-type="fig" rid="fig5">Figure 5</xref>. We now state that ‘These were the genes with the strongest negative correlation between their methylation and expression.’ And refer to <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>, which presents results for all genes in our study.</p><p><italic>3) We do not see a benefit in having the left panel of <xref ref-type="fig" rid="fig2">Figure 2</xref>. In their response, the authors say they wanted to show the difference between TPS and uniform selection. But panel (A) shows random selection, not uniform selection. Random selection is a made-up baseline designed to make TPS look good. Now that they have better baselines comparisons, the paper does not need it, and panel (A) can be removed.</italic> </p><p>As the reviewer suggested we removed this panel to the supplement as ‘<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>’</p><p><italic>4) <xref ref-type="fig" rid="fig3">Figure 3</xref>. Replace &quot;Rem points&quot; with &quot;remaining points&quot;.</italic> </p><p>Fixed.</p><p><italic>5) The authors mentioned that they &quot;improved the caption of <xref ref-type="fig" rid="fig1">Figure 1</xref> to explicitly state which initialization method is used for each result&quot;. But <xref ref-type="fig" rid="fig1">Figure 1</xref> caption is unchanged. (They did clarify other figure captions.)</italic> </p><p>The reviewer is correct, we meant to say that we revised the captions for <xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig4">4</xref> as the reviewers requested in the previous round. These figures are the ones showing the results the reviewer refers to. <xref ref-type="fig" rid="fig1">Figure 1</xref> is an overview illustrative figure and does not show any specific results. Thus, it does not use any initialization method and so no additions were needed for its caption.</p><p><italic>6) The authors added Figure 4—figure supplement 3 to show the performance of TPS trained on miRNA data. But that plot could/should be included directly in <xref ref-type="fig" rid="fig4">Figure 4</xref>. Otherwise it is hard for the reader to compare TPS when trained on mRNA versus miRNA data. Also, since there are several versions of TPS, which one was used in Figure 4—figure supplement 3? These kinds of details are still missing.</italic> </p><p>As the reviewer suggested we now added Figure 4—figure supplement 3 as <xref ref-type="fig" rid="fig4">Figure 4B</xref> and we now explicitly mention in the caption that the max absolute difference initialization was used for these results.</p><p><italic>7) Some of the figures are still of inadequate quality. Some plots have a strange aspect ratio (e.g. <xref ref-type="fig" rid="fig5">Figure 5</xref>). Several plots do not have a y-axis label (e.g. <xref ref-type="fig" rid="fig3">Figure 3</xref>). Sometimes the labels are incomplete (e.g. &quot;Error&quot; in the comparison to Singh et al.; is it mean squared error?) Overall, the paper is still difficult to follow. (The fact that all references appear as &quot;?&quot; in the PDF also makes the paper hard to read. I assume the text file was not processed correctly during submission. But shouldn't the author verify that before submitting the paper?)</italic> </p><p>The reference issue was fixed earlier and resulted from problems related to the <italic>eLife</italic> conversion of the latex file. As for the figures, we added y-axis labels of relative expression to <xref ref-type="fig" rid="fig6">Figure 6</xref>, changed the y-axis label from error to mean squared error for <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, and rescaled <xref ref-type="fig" rid="fig5">Figure 5</xref> so the aspect ratio looked better. We made similar changes to all relevant supplementary figures as well.</p></body></sub-article></article>