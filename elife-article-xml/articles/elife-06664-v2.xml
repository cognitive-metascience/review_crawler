<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">06664</article-id><article-id pub-id-type="doi">10.7554/eLife.06664</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Structural Biology and Molecular Biophysics</subject></subj-group></article-categories><title-group><article-title>Low cost, high performance processing of single particle cryo-electron microscopy data in the cloud</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-27803"><name><surname>Cianfrocco</surname><given-names>Michael A</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataro1"/></contrib><contrib contrib-type="author" id="author-14036"><name><surname>Leschziner</surname><given-names>Andres E</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataro1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Molecular and Cellular Biology</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Cell Biology</institution>, <institution>Harvard Medical School</institution>, <addr-line><named-content content-type="city">Boston</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-3361"><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name><role>Reviewing editor</role><aff><institution>Medical Research Council Laboratory of Molecular Biology</institution>, <country>United Kingdom</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>mcianfrocco@fas.harvard.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>08</day><month>05</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e06664</elocation-id><history><date date-type="received"><day>25</day><month>01</month><year>2015</year></date><date date-type="accepted"><day>01</day><month>05</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Cianfrocco and Leschziner</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Cianfrocco and Leschziner</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-06664-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.06664.001</object-id><p>The advent of a new generation of electron microscopes and direct electron detectors has realized the potential of single particle cryo-electron microscopy (cryo-EM) as a technique to generate high-resolution structures. Calculating these structures requires high performance computing clusters, a resource that may be limiting to many likely cryo-EM users. To address this limitation and facilitate the spread of cryo-EM, we developed a publicly available ‘off-the-shelf’ computing environment on Amazon's elastic cloud computing infrastructure. This environment provides users with single particle cryo-EM software packages and the ability to create computing clusters with 16–480+ CPUs. We tested our computing environment using a publicly available 80S yeast ribosome dataset and estimate that laboratories could determine high-resolution cryo-EM structures for $50 to $1500 per structure within a timeframe comparable to local clusters. Our analysis shows that Amazon's cloud computing environment may offer a viable computing environment for cryo-EM.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.001">http://dx.doi.org/10.7554/eLife.06664.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.06664.002</object-id><title>eLife digest</title><p>Microscopes can be used to view objects or structural details that are not visible with the naked eye. A type of microscope called an electron microscope—which uses beams of particles called electrons—is particularly useful for examining tiny objects or structures because it can produce images with a higher level of detail than microscopes that use light.</p><p>There are several ways to prepare biological samples for electron microscopy. One technique is called cryo-electron microscopy, or cryo-EM for short, where the sample is rapidly frozen and then viewed under the electron microscope. Using this technique it is possible to produce highly detailed images of viruses, individual compartments within cells and even single proteins.</p><p>To convert the images of proteins into three-dimensional models, high-performing clusters of computers are required. It can be difficult and expensive for many scientists to access these resources, which may limit the wider use of cryo-EM in research.</p><p>To address this problem and aid the spread of cryo-EM, Cianfrocco and Leschziner developed a publicly available ‘off the shelf’ system on Amazon's elastic cloud computing infrastructure. This provides users with software packages and the ability to create a cluster containing up to around 480 computers to analyze cryo-EM data.</p><p>Cianfrocco and Leschziner tested the system using a publicly available cryo-EM dataset of a structure in yeast cells called the 80S ribosome, which contains proteins and molecules of ribonucleic acid. This revealed that a highly detailed model of the 80S ribosome could be developed in a time frame similar to what it would have taken on a local high-performing computing cluster within a university. The cost of using this system was also competitive in price with that of maintaining a local computing cluster, with the added flexibility of its ‘pay-as-you-go’ structure.</p><p>These findings show that Amazon's cloud computing infrastructure may be a useful alternative to using clusters of computers based within a research institute or university. This will help the spread of cryo-EM as a general tool to reveal the three-dimensional structures of large molecules. Further work is required to make this cloud-based computing tool easily accessible to researchers who may have limited experience with using Linux software and computing clusters.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.002">http://dx.doi.org/10.7554/eLife.06664.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>cryo-EM</kwd><kwd>cloud computing</kwd><kwd>image analysis</kwd><kwd>single-particle analysis</kwd><kwd>Amazon EC2</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>S. cerevisiae</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001021</institution-id><institution>Damon Runyon Cancer Research Foundation (Damon Runyon)</institution></institution-wrap></funding-source><award-id>2171-13</award-id><principal-award-recipient><name><surname>Cianfrocco</surname><given-names>Michael A</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health (NIH)</institution></institution-wrap></funding-source><award-id>R01GM107214</award-id><principal-award-recipient><name><surname>Leschziner</surname><given-names>Andres E</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health (NIH)</institution></institution-wrap></funding-source><award-id>R01GM092895A</award-id><principal-award-recipient><name><surname>Leschziner</surname><given-names>Andres E</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A freely available software environment on Amazon's cloud computing network makes processing of cryo-EM data accessible and affordable.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Cryo-electron microscopy (cryo-EM) has long served as an important tool to provide structural insights into biological samples. Recent advances in cryo-EM data collection and analysis, however, have transformed single particle cryo-EM (<xref ref-type="bibr" rid="bib13">Kuhlbrandt, 2014</xref>; <xref ref-type="bibr" rid="bib4">Bai et al., 2015</xref>), allowing it to achieve resolutions better than 5 Å for samples ranging in molecular weight from the 4 MDa eukaryotic ribosome (<xref ref-type="bibr" rid="bib3">Bai et al., 2013</xref>) to the 170 kDa membrane protein γ-secretase (<xref ref-type="bibr" rid="bib15">Lu et al., 2014</xref>). These high-resolution structures are the result of a new generation of cameras that detect electrons directly without the need of a scintillator, which results in a dramatic increase in the signal-to-noise ratio relative to CCD cameras, the previous most commonly used device (<xref ref-type="bibr" rid="bib17">McMullan et al., 2009</xref>). In addition to direct electron detection, the high frame rate of these cameras allows each image to be recorded as a ‘movie’, dividing it into multiple frames. These fractionated images can be used to correct for sample movement during the exposure, further increasing the quality of the cryo-EM images (<xref ref-type="bibr" rid="bib5">Campbell et al., 2012</xref>; <xref ref-type="bibr" rid="bib14">Li et al., 2013</xref>; <xref ref-type="bibr" rid="bib22">Scheres, 2014</xref>).</p><p>In addition to these technological developments in the detectors, improvements in computer software packages have played an equally important role in moving cryo-EM into the high-resolution era. Atomic or near-atomic structures have been obtained with software packages such as EMAN2 (<xref ref-type="bibr" rid="bib24">Tang et al., 2007</xref>), Sparx (<xref ref-type="bibr" rid="bib9">Hohn et al., 2007</xref>), FREALIGN (<xref ref-type="bibr" rid="bib8">Grigorieff, 2007</xref>), Spider (<xref ref-type="bibr" rid="bib7">Frank et al., 1996</xref>), and Relion (<xref ref-type="bibr" rid="bib21">Scheres, 2012</xref>, <xref ref-type="bibr" rid="bib22">2014</xref>). In general, obtaining these structures involved computational approaches that sorted out the data into homogenous classes that could then be refined to high resolution.</p><p>While these advances in microscopy and analysis have been essential for the recent breakthroughs in cryo-EM, their implementation is computationally intensive and requires high-performance computing clusters. A recent survey of high-resolution single particle cryo-EM structures showed that refinement of these structures required processing times in excess of 1000 CPU-hours (<xref ref-type="bibr" rid="bib22">Scheres, 2014</xref>). Therefore, computational time (i.e., access to high-performance clusters) may represent a bottleneck to determining high-resolution structures by single particle cryo-EM.</p><p>In order to address this limitation, we explored the possibility of using Amazon's elastic cloud computing (EC2) for processing cryo-EM data. To help others take advantage of this resource, we have created a publicly available ‘off-the-shelf’ software environment that allows new users to start up a cluster of Amazon CPUs preinstalled with cryo-EM software and we have used it to test the performance of Amazon's EC2 platform. We were able to determine a 4.6 Å structure of the 80S ribosome using a published dataset (<xref ref-type="bibr" rid="bib3">Bai et al., 2013</xref>) for an overall cost of $100 USD within a timeframe comparable to that of a local cluster. Given the range of prices for accessing Amazon CPUs (users can bid for significantly reduced costs) and the accessibility statistics, we estimate that typical cryo-EM structures can be determined for $50–$1500 per structure.</p><sec id="s1-1"><title>EC2 through Amazon Web Services (AWS)</title><p>AWS is a division of Amazon that offers a variety of cloud-based solutions for website hosting and high-performance computing, amongst other services. Many different types of privately held companies take advantage of Amazon's computing infrastructure because of its affordability, flexibility, and security. Of note, global biotechnology companies such as Novartis (<xref ref-type="bibr" rid="bib1b">AWS, 2014a</xref>), Bristol-Myers-Squibb (<xref ref-type="bibr" rid="bib1a">AWS, 2013</xref>), and Pfizer (<xref ref-type="bibr" rid="bib2">AWS, 2014b</xref>) have utilized the computing power of Amazon for scientific data processing. Many academic researchers have also begun to use Amazon's EC2 resources for analyzing datasets from super-resolution light microscopy (<xref ref-type="bibr" rid="bib10">Hu et al., 2013</xref>), genomics (<xref ref-type="bibr" rid="bib12">Krampis et al., 2012</xref>; <xref ref-type="bibr" rid="bib26">Yazar et al., 2014</xref>), and proteomics (<xref ref-type="bibr" rid="bib19">Mohammed et al., 2012</xref>; <xref ref-type="bibr" rid="bib25">Trudgian and Mirzaei, 2012</xref>).</p><p>The overall workflow starts with users logging into a virtual machine (‘instance’) on AWS (<xref ref-type="fig" rid="fig1">Figure 1</xref>). AWS offers a variety of instance types that have been configured for different computing tasks. For example, instances have been optimized for computing performance, GPU-based calculations, or memory-intensive calculations. After logging onto an instance, storage drives are mounted onto it, allowing data, which can be encrypted for security, to be transferred onto the storage drives (<xref ref-type="fig" rid="fig1">Figure 1</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06664.003</object-id><label>Figure 1.</label><caption><title>Workflow for analyzing cryo-EM data on Amazon's cloud computing infrastructure.</title><p>After collecting cryo-EM data (Step 1), particles are extracted from the micrographs and prepared for further analysis (Step 2). After logging into an ‘instance’ (Step 3), data are uploaded to a storage server (elastic block storage) (Step 4). At this point, STARcluster can be configured to launch a cluster of 2–30 instances that is mounted with the data from the storage volume (Step 5). A detailed protocol can be found at an accompanying Google site: <ext-link ext-link-type="uri" xlink:href="http://goo.gl/AIwZJz">http://goo.gl/AIwZJz</ext-link>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.003">http://dx.doi.org/10.7554/eLife.06664.003</ext-link></p></caption><graphic xlink:href="elife-06664-fig1-v2.tif"/></fig></p><p>While users can utilize a single instance for calculations, the maximum number of CPU cores per instance is 18. Therefore, creating a computing cluster with a larger number of CPUs on AWS requires additional steps. The Software Tools for Academics and Researchers (STAR) group at the Massachusetts Institute of Technology developed a straightforward package that allows users to group individual AWS instances into a cluster. The STARcluster program is a python-based, open source package that automatically creates a cluster preconfigured with the necessary software to manage a computer cluster (<xref ref-type="bibr" rid="bib11">Ivica et al., 2009</xref>). This package allows users to specify the number of instances to be included in the clusters as well as the instance type. By taking advantage of this tool, private clusters can be built with sizes ranging from 16 to 480 CPUs (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p></sec><sec id="s1-2"><title>Global availability of spot instances on Amazon EC2</title><p>While Amazon provides dedicated access to instances through ‘on-demand’ reservations, there are ‘spot instances’ that are 80–90% cheaper than the on-demand price. Spot instances are unused instances within Amazon EC2 that are open for competitive bidding, where users gain access to them by making offers above the current minimum bid. This means that while the on-demand rate for high-memory, 16-CPU instances (called ‘r3.8xlarge’) is $2.80/hr, spot instance prices can be as low as $0.25–$0.35/hr.</p><p>In order to determine if spot instances offer a consistent reduction in price, we analyzed the global availability of r3.8xlarge spot instances. Currently, Amazon has 9 regions worldwide within 7 countries: US-East-1 (United States), US-West-1 (United States), US-West-2 (United States), SA-East-1 (Brazil), EU-Central-1 (Germany), EU-West-1 (Ireland), AP-Northeast-1 (Japan), AP-Southeast-1 (Singapore), and AP-Southeast-2 (Australia). For each region, we retrieved spot instance prices for r3.8xlarge instances over the past 3 months and analyzed the time they spent at prices below $0.35–$0.65/hr (corresponding to discounts of 87.5–76.8% over the full on-demand rate of $2.80/hr) (<xref ref-type="fig" rid="fig2">Figure 2</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). This analysis revealed that, globally, 49.8% of r3.8xlarge instances were below $0.35/hr, 12.5% the on-demand price (<xref ref-type="fig" rid="fig2">Figure 2</xref>). For $0.65/hr, 76.5% below full price, one could access 82.2% of the global r3.8xlarge spot instances. These data indicate that spot instances provide dependable, cost-effective access to Amazon's computing resources.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06664.004</object-id><label>Figure 2.</label><caption><title>Global availability of Amazon r3.8xlarge spot instances.</title><p>Shown is the average percentage time spent by the r3.8xlarge type of instance when the current spot instance price was less than the queried price. The data are averaged over all Amazon's regions worldwide (except for SA-East-1, which does not offer r3.8xlarge instances). Spot instance prices were calculated over a 90-day period from 1 January 2015—1 April 2015, where the average is shown ± the s.e. Source data: <xref ref-type="supplementary-material" rid="SD1-data">Figure 2—source data 1</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.004">http://dx.doi.org/10.7554/eLife.06664.004</ext-link></p><p><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.06664.005</object-id><label>Figure 2—source data 1.</label><caption><title>Global spot instance price data from 1 January 2015 to 1 April 2015.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.005">http://dx.doi.org/10.7554/eLife.06664.005</ext-link></p></caption><media mime-subtype="txt" mimetype="text" xlink:href="elife-06664-fig2-data1-v2.txt"/></supplementary-material></p></caption><graphic xlink:href="elife-06664-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06664.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Availability of virtual machines within regions at specified spot instance prices.</title><p>For each Amazon region (excluding SA-East-1, which does not offer r3.8xlarge instances), r3.8xlarge spot instance prices were retrieved for each availability zone, where separate availability zones are shown as separate data points for a given spot instance price. (Note: each region can have different number of availability zones). From the spot instance prices, the percentage time of the spot instances that were spent below the specified spot instance price were calculated. The average value is shown as a solid black line. Source data: <xref ref-type="supplementary-material" rid="SD1-data">Figure 2—source data 1</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.006">http://dx.doi.org/10.7554/eLife.06664.006</ext-link></p></caption><graphic xlink:href="elife-06664-fig2-figsupp1-v2.tif"/></fig></fig-group></p></sec><sec id="s1-3"><title>Performance analysis of Amazon's EC2 environment with a 80S yeast ribosome dataset</title><p>To test the performance of Amazon's EC2 environment, we analyzed a previously published 80S <italic>Saccharomyces cerevisiae</italic> ribosome dataset (<xref ref-type="bibr" rid="bib3">Bai et al., 2013</xref>) (EMPIAR 10002) on a 128 CPU cluster (8 × 16 CPUs; using the r3.8xlarge instance). After extracting 62,022 particles, we performed 2D classification within Relion. Subsequent 3D classification of the particles into four classes revealed that two classes adopted a similar structural state. We merged those two classes and used the associated particles to carry out a 3D refinement in Relion—we were able to obtain a structure with an overall resolution of 4.6 Å (<xref ref-type="fig" rid="fig3">Figure 3A–C</xref>).<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.06664.007</object-id><label>Figure 3.</label><caption><title>Cryo-EM structure of 80S ribosome at an overall resolution of 4.6 Å.</title><p>(<bold>A</bold>) Overall view of 80S reconstruction filtered to 4.6 Å while applying a negative B-factor of −116 Å<sup>2</sup>. (<bold>B</bold>) Gold standard FSC curve. (<bold>C</bold>) Selected regions from the 60S subunit. Cryo-EM maps were visualized with UCSF Chimera (<xref ref-type="bibr" rid="bib20">Pettersen et al., 2004</xref>). Source data: Dryad Digital Repository dataset (<ext-link ext-link-type="uri" xlink:href="http://datadryad.org/review?doi=doi:10.5061/dryad.9mb54">http://datadryad.org/review?doi=doi:10.5061/dryad.9mb54</ext-link>) (<xref ref-type="bibr" rid="bib6">Cianfrocco and Leschziner</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.007">http://dx.doi.org/10.7554/eLife.06664.007</ext-link></p></caption><graphic xlink:href="elife-06664-fig3-v2.tif"/></fig></p><p>This structure, whose generation included particle picking, CTF estimation, 2D and 3D classification, and refinement, cost us $99.64 on Amazon's EC2 environment. This cost was achieved by bidding on spot instances for particle picking (m1.small at $0.02/hr), 2D classification (STARcluster of r3.8xlarge instances at $0.65/hr), and 3D classification and refinement (STARcluster of r3.8xlarge instances at $0.65/hr). Thus, even though obtaining this structure required 1266 total CPU-hours, Amazon's EC2 computing infrastructure provided the necessary resources to calculate it to near-atomic resolution at a reasonable price.</p><p>To further test the performance of Amazon instances, we carried out 3D classification and refinement on a variety of STARcluster configurations using Relion. As before, we ran our tests on clusters of r3.8xlarge high-memory instances (256 GiB RAM and 16 CPUs per instance). Comparing performance across cluster sizes showed that 256 CPUs had the fastest overall time and the highest speedup relative to a single CPU for both 3D classification and refinement (<xref ref-type="fig" rid="fig4">Figure 4A,B</xref>). However, cluster sizes of 128 and 64 CPUs were the most cost effective for 3D classification and refinement, respectively, as these were the cluster configurations where the speedup per dollar reached a maximum (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Importantly, the average time required to boot up these STARclusters was ≤ 10 min for all cluster sizes (<xref ref-type="fig" rid="fig4">Figure 4D</xref>) and, once booted up, the clusters do not have any associated job wait times. Therefore, these tests showed that Amazon's EC2 infrastructure was amenable to the analysis of single particle cryo-EM data using Relion over a range of STARcluster sizes.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.06664.008</object-id><label>Figure 4.</label><caption><title>Relion performance on STARcluster configurations of Amazon instances.</title><p>(<bold>A</bold>) Processing times (minutes) for Relion to perform 3D Classification or 3D refinement on 80S ribosome dataset. (<bold>B</bold>) Speedup for each cluster size relative to a single CPU (black line) shown alongside performance estimate for a perfectly parallel cluster using Amdahl's Law (curve labeled ‘Theoretical limit’). For cluster sizes ≤ 64 CPUs, Relion exhibits near-perfect performance on STARcluster configurations, while cluster sizes &gt; 64 show that Relion's performance reaches a maximum at 256 CPUs for both 3D classification and 3D refinement. (<bold>C</bold>) Speedup/Cost is plotted against cluster size, where Speedup/Cost is defined as the speedup observed divided by the cost associated with Amazon's pricing at $0.35/hr/16 CPUs. (<bold>D</bold>) Average STARcluster boot up time (± s.d.) was measured for clusters of increasing size (n = 5). Source data: <xref ref-type="supplementary-material" rid="SD2-data">Figure 4—source data 1</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.008">http://dx.doi.org/10.7554/eLife.06664.008</ext-link></p><p><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.06664.009</object-id><label>Figure 4—source data 1.</label><caption><title>Performance analysis statistics for Relion 3D classification and 3D refinement on STARcluster configurations.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.009">http://dx.doi.org/10.7554/eLife.06664.009</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-06664-fig4-data1-v2.xlsx"/></supplementary-material></p></caption><graphic xlink:href="elife-06664-fig4-v2.tif"/></fig></p><p>From our analysis of the 80S yeast ribosome, we extrapolated the processing times and combined them with previously published 3D refinement times to estimate typical costs on Amazon's EC2. First, we estimated the cost for 3D refinement in Relion for previously published structures (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 2A</xref>)—these calculated costs ranged from $12.65 to $379.03 per structure, depending on the spot instance price and required CPU-hours. We then combined these data with conservative estimates for particle picking, CTF estimation, particle extraction, 2D and 3D classification to predict the overall cost of structure determination on Amazon's EC2 (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 2B</xref>). From these considerations, we estimated that published structures could be determined using Amazon's EC2 environment at costs of $50–$1500 per structure (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 2B</xref>).</p></sec><sec id="s1-4"><title>EM-packages-in-the-Cloud: a pre-configured software environment for single-particle cryo-EM image analysis</title><p>Given the success we had in analyzing cryo-EM data on Amazon's EC2 at an affordable price and within a reasonable timeframe, we have made our software environment publicly available as an ‘Amazon Machine Image’ (AMI), under the name ‘EM-packages-in-the-Cloud-v3.93.’ The EM-packages-in-the-Cloud-v3.93 AMI provides the software environment necessary for analyzing data on a single instance, and is preconfigured with STARcluster software. The EM-packages-in-the-Cloud-v3.93 AMI has the following cryo-EM software packages installed: Relion (<xref ref-type="bibr" rid="bib21">Scheres, 2012</xref>, <xref ref-type="bibr" rid="bib22">2014</xref>), FREALIGN (<xref ref-type="bibr" rid="bib8">Grigorieff, 2007</xref>), EMAN2 (<xref ref-type="bibr" rid="bib24">Tang et al., 2007</xref>), Sparx (<xref ref-type="bibr" rid="bib9">Hohn et al., 2007</xref>), Spider (<xref ref-type="bibr" rid="bib7">Frank et al., 1996</xref>), EMAN (<xref ref-type="bibr" rid="bib16">Ludtke et al., 1999</xref>), and XMIPP (<xref ref-type="bibr" rid="bib23">Sorzano et al., 2004</xref>). In addition to this AMI that is capable of running on a single instance, we have also made available a second AMI—EM-packages-in-the-Cloud-Node-v3.1—that provides users with the same software packages as described above, but can set up and run within a cluster of multiple EC2 instances. These two publicly available AMIs allow users to boot up a cluster to analyze cryo-EM data in a few short steps. The protocols describing this can be found as a PDF (<xref ref-type="supplementary-material" rid="SD3-data">Supplementary file 1</xref>) or on a Google site that is being launched in conjunction with this article: <ext-link ext-link-type="uri" xlink:href="http://goo.gl/AIwZJz">http://goo.gl/AIwZJz</ext-link>. In addition to detailed instructions, the site includes a help forum to facilitate a conversation on cloud computing for single particle cryo-EM.</p></sec><sec id="s1-5"><title>Cloud computing as a tool to facilitate high-resolution cryo-EM</title><p>Recent advances in single particle cryo-EM have drawn the interest of the broader scientific community. In addition to technical advances in electron optics, the new direct electron detectors and data analysis software have dramatically improved the resolutions that can be achieved for a variety of structural targets. In contrast to the other high-resolution techniques (X-ray crystallography, NMR), structure determination by cryo-EM is extremely computationally intensive. The publicly available ‘EM-packages-in-the-Cloud’ environment we have presented and characterized here will help remove some of the limitations imposed by these computational requirements.</p><p>We believe that cloud-based approaches have the potential to impact the future of cryo-EM image processing in two fronts: (1) new cryo-EM users or laboratories will have immediate access to a high performance cluster, and (2) existing labs may use this resource to increase their productivity. As the number of laboratories using cryo-EM increases, and as existing laboratories begin to pursue high-resolution cryo-EM, gaining immediate access to a high performance cluster may become difficult. For instance, while there are government-funded high performance clusters in the United States (e.g., XSEDE STAMPEDE), it may take up to a month for a user application to be reviewed (Rogelio Hernandez-Lopez, personal communication). Assuming that the application is approved, these clusters may not have appropriate software installed, which further delays data processing. Finally, the user will have a set limit for the number of CPU hours available per project, requiring a new application to be submitted to access the cluster again. All of these problems can be circumvented by using Amazon's EC2 infrastructure, which provides immediate, cost-effective access to hundreds of CPUs with no geographic restrictions.</p><p>The power of cloud-based solutions to alleviate the computational burden associated with cryo-EM data processing stems from its high-degree of scalability and reasonable cost. By minimizing computational time and increasing global accessibility, high-performance cloud computing may help usher in the era when high-resolution cryo-EM becomes a routine structural biology tool.</p></sec></sec><sec id="s2" sec-type="materials|methods"><title>Materials and methods</title><sec id="s2-1"><title>Global availability of spot instances</title><p>Global spot instance prices were retrieved from the 90-day period from 1 January 2015 to 1 April 2015 using the Amazon Command Line Tools command <italic>ec2-describe-spot-price-history</italic>. Retrieval of spot instance prices for all regions was implemented automatically in a custom python program <italic>get_spot_histories_all_regions_all_zones.py</italic>. From these spot instance prices, the percentage time spent below given prices was calculated using <italic>measure_time_at_spotPrice.py</italic>, where the cumulative time of spot instances below a given price divided by the total time (90 days). Both programs can be found in the Github repository mcianfrocco/Cianfrocco-and-Leschziner-EMCloudProcessing.</p></sec><sec id="s2-2"><title>Setting up a cluster on Amazon EC2 with spot instances</title><p>In order to minimize costs, STARclusters were assembled from ‘spot instances,’ which are unused instances that can be reserved through a bidding process. The spot instances are different from ‘on-demand’ instances: on-demand instances provide users with guaranteed access while spot instances are reserved until there is a higher bid, at which point the user is logged out of the spot instance. When this happens, the MPI-threaded Relion calculation will abort, requiring the user to resubmit the job to the STARcluster and start Relion from the previous iteration. Even if the user is logged out of all instances within a STARcluster, the data is automatically saved within the EBS-backed volumes on Amazon EC2.</p></sec><sec id="s2-3"><title>CPUs vs vCPUs</title><p>In selecting an instance type, new users should be aware of the differences between CPUs and vCPUs on Amazon's EC2 network. Namely, that there are two vCPUs per physical CPU on Amazon. This means that while r3.8xlarge instances have 32 vCPUs, there are actually only 16 physical CPU cores in each instance, with each CPU having two hyperthreads. Practically, this means that Amazon's instances have higher performance than a 16 CPU machine and less performance than a 32 CPU machine. To account for this difference, all numbers reported here were CPU numbers that were converted from vCPUs: 1 CPU = 2 vCPUs.</p></sec><sec id="s2-4"><title>Image processing</title><p>Micrographs from the 80S <italic>S. cerevisiae</italic> ribosome dataset (<xref ref-type="bibr" rid="bib3">Bai et al., 2013</xref>) were downloaded from the EMPIAR database for electron microscopy data (EMPIAR 10002). The SWARM feature of EMAN2 (<xref ref-type="bibr" rid="bib24">Tang et al., 2007</xref>) was used to pick particles semi-automatically. Micrograph defocus was estimated using CTFFIND3 (<xref ref-type="bibr" rid="bib18">Mindell and Grigorieff, 2003</xref>). The resulting particle coordinates and defocus information were used for particle extraction by Relion-v1.3 (<xref ref-type="bibr" rid="bib21">Scheres, 2012</xref>, <xref ref-type="bibr" rid="bib22">2014</xref>). The particle stacks and associated data files were then uploaded to an elastic block storage volume on Amazon's EC2 processing environment at a speed of 10 MB/s (24 min total upload time).</p><p>After 2D classification in Relion, 3D classification was performed on 62,022 80S Ribosome particles (1.77 Å/pixel), also in Relion. These were classified into 4 groups (T = 4) for 13 iterations using a ribosome map downloaded from the Electron Microscopy Data Bank (EMDB-1780) that was low pass filtered to 60 Å. Further 3D classification using a local search of 10° and an angular sampling of 1.8° continued for 13 iterations. At this point, two classes were identified as belonging to the same structural state and were selected for high-resolution refinement (32,533 particles). Refinement of these selected particles continued for 31 iterations using <italic>3D auto-refine</italic> in Relion. The final resolution was determined to be 4.6 Å using <italic>Post process</italic> in Relion, applying a mask to the merged half volumes and a negative B-factor of −116 Å<sup>2</sup>.</p></sec><sec id="s2-5"><title>Performance analysis</title><p>80S ribosome data were reanalyzed on clusters of increasing size using both 3D classification and 3D refinement. The time points collected involved running 3D classification for 2 rounds and 3D refinement for 6 rounds, using the same number of particles and box sizes listed above: 62,022 particles for classification and 32,533 particles for refinement with box sizes of 240 × 240 pixels. The Relion commands were identical to the commands used above and the calculations were terminated after the specified iteration.</p><p>From these time points, the speedup of each cluster size was calculated relative to a single CPU. Speedup (<italic>S</italic>) was calculated as:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Calculation time for </mml:mtext><mml:mn>1</mml:mn><mml:mtext> CPU</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Calculation time for </mml:mtext><mml:mi>x</mml:mi><mml:mtext> CPUs</mml:mtext></mml:mrow></mml:mfrac><mml:mtext>.</mml:mtext></mml:mrow></mml:math></disp-formula></p><p>The measured speedup values were then compared to the speedup expected for a perfectly parallel algorithm (<italic>P</italic> = 1) using Amdahl's law (<xref ref-type="bibr" rid="bib1">Amdahl, 1967</xref>):<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>−</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>−</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mtext>,</mml:mtext></mml:mrow></mml:math></disp-formula></p><p>Where <italic>P</italic> is the fraction of an algorithm that is parallel and <italic>n</italic> is the number of processors. The calculation times for 3D classification on a single CPU were obtained by using 1 CPU on a 16 CPU r3.8xlarge instance. For calculating a 3D refinement on a single CPU, (or two vCPUs), the refinement was run on 4 vCPUs and then converted to a single CPU (or two vCPUs) by multiplying the calculation time by 2. For cost analysis, the measured speedup was divided by the cost to run the job on spot instances of r3.8xlarge at a price of $0.35/hr. Cluster boot up times were calculated from the elapsed time between submitting the STARcluster command and the STARcluster fully booting up.</p></sec><sec id="s2-6"><title>Data accession information</title><p>Further information regarding ‘EM-Packages-in-the-Cloud’ can be found in <xref ref-type="supplementary-material" rid="SD3-data">Supplementary file 1</xref> and at an associated Google Site: <ext-link ext-link-type="uri" xlink:href="http://goo.gl/AIwZJz">http://goo.gl/AIwZJz</ext-link>. The final 80S yeast ribosome structure at 4.6 Å has been submitted to the EM Databank as EMDB 2858. A detailed description of global spot instance price analyses and image processing is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mcianfrocco/Cianfrocco-and-Leschziner-EMCloudProcessing/wiki">https://github.com/mcianfrocco/Cianfrocco-and-Leschziner-EMCloudProcessing/wiki</ext-link>. Associated computing scripts and data files have been uploaded to Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/mcianfrocco/Cianfrocco-and-Leschziner-EMCloudProcessing">https://github.com/mcianfrocco/Cianfrocco-and-Leschziner-EMCloudProcessing</ext-link>) and Dryad Digital Repository (<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.9mb54">http://dx.doi.org/10.5061/dryad.9mb54</ext-link>) (<xref ref-type="bibr" rid="bib6">Cianfrocco and Leschziner, 2015</xref>), respectively.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We would like to thank all the members of the Leschziner and Reck-Peterson labs for critical discussions. We would like to especially thank Rogelio Hernandez-Lopez, Anthony Roberts, and Daniel Cianfrocco for critical feedback on the development of this Amazon computing environment. We also would like to thank the Structural Biology Consortium (SBGrid) for pricing information on cluster and file server sizes. MAC is an HHMI fellow of the Damon Runyon Cancer Research Foundation and AEL is supported by NIH/NIGMS (R01 GM107214 and R01 GM092895A).</p></ack><sec id="s3" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>MAC, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>AEL, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec id="s4" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD3-data"><object-id pub-id-type="doi">10.7554/eLife.06664.010</object-id><label>Supplementary file 1.</label><caption><p>Step-by-step tutorial describing how to use Amazon's EC2 environment to analyze cryo-EM data.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.010">http://dx.doi.org/10.7554/eLife.06664.010</ext-link></p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-06664-supp1-v2.pdf"/></supplementary-material><supplementary-material id="SD4-data"><object-id pub-id-type="doi">10.7554/eLife.06664.011</object-id><label>Supplementary file 2.</label><caption><p>Comparison of estimated processing times and costs for recent near-atomic cryo-EM structures on Amazon's EC2. Source data: <xref ref-type="supplementary-material" rid="SD5-data">Supplementary File 3</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.011">http://dx.doi.org/10.7554/eLife.06664.011</ext-link></p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-06664-supp2-v2.docx"/></supplementary-material><supplementary-material id="SD5-data"><object-id pub-id-type="doi">10.7554/eLife.06664.012</object-id><label>Supplementary file 3.</label><caption><p>Source data for tables in <xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 2</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.012">http://dx.doi.org/10.7554/eLife.06664.012</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-06664-supp3-v2.xlsx"/></supplementary-material><sec id="s4-1" sec-type="datasets"><title>Major datasets</title><p>The following dataset was generated:</p><p><related-object content-type="generated-dataset" id="dataro1" source-id="http://dx.doi.org/10.5061/dryad.9mb54" source-id-type="uri"><collab collab-type="author">Cianfrocco MA</collab>, <collab collab-type="author">Leschziner AE</collab>, <year>2014</year><x>, </x><source>Data from: Single particle cryo-electron microscopy image processing in the cloud: High performance at low cost</source><x>, </x><ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.9mb54">http://dx.doi.org/10.5061/dryad.9mb54</ext-link><x>, </x><comment>Available at Dryad Digital Repository under a CC0 Public Domain Dedication.</comment></related-object></p><p>The following previously published dataset was used:</p><p><related-object content-type="existing-dataset" id="dataro2" source-id="http://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10002/" source-id-type="uri"><collab collab-type="author">Bai XC</collab>, <collab collab-type="author">Fernandez IS</collab>, <collab collab-type="author">McMullan G</collab>, <collab collab-type="author">Scheres SH</collab>, <year>2013</year><x>, </x><source>S.cereviseae 80S ribosome direct electron detetector dataset</source><x>, </x><ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10002/">http://www.ebi.ac.uk/pdbe/emdb/empiar/entry/10002/</ext-link><x>, </x><comment>Publicly available at Electron Microscopy Pilot Image Archive.</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Amdahl</surname><given-names>GM</given-names></name></person-group><year>1967</year><article-title>Validity of the single processor approach to achieving large scale computing capabilities</article-title><source>Proceedings of the April 18-20, 1967, spring joint computer conference</source><publisher-loc>Atlantic City, New Jersey</publisher-loc><publisher-name>ACM</publisher-name><fpage>483</fpage><lpage>485</lpage></element-citation></ref><ref id="bib1a"><element-citation publication-type="web"><person-group person-group-type="author"><collab>AWS</collab></person-group><year>2013</year><article-title>Bristol-Myers Squibb on AWS</article-title><comment>Date Accessed: April 20, 2015. <ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/solutions/case-studies/bristol-myers-squibb/">http://aws.amazon.com/solutions/case-studies/bristol-myers-squibb/</ext-link></comment></element-citation></ref><ref id="bib1b"><element-citation publication-type="web"><person-group person-group-type="author"><collab>AWS</collab></person-group><year>2014a</year><article-title>AWS case study: Novartis</article-title><comment>Date Accessed: April 20, 2015. <ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/solutions/case-studies/novartis/">http://aws.amazon.com/solutions/case-studies/novartis/</ext-link></comment></element-citation></ref><ref id="bib2"><element-citation publication-type="web"><person-group person-group-type="author"><collab>AWS</collab></person-group><year>2014b</year><article-title>AWS case study: Pfizer</article-title><comment>Date Accessed: April 20, 2015. <ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/solutions/case-studies/pfizer/">http://aws.amazon.com/solutions/case-studies/pfizer/</ext-link></comment></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>XC</given-names></name><name><surname>Fernandez</surname><given-names>IS</given-names></name><name><surname>McMullan</surname><given-names>G</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><year>2013</year><article-title>Ribosome structures to near-atomic resolution from thirty thousand cryo-EM particles</article-title><source>eLife</source><volume>2</volume><fpage>e00461</fpage><pub-id pub-id-type="doi">10.7554/eLife.00461</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>XC</given-names></name><name><surname>McMullan</surname><given-names>G</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><year>2015</year><article-title>How cryo-EM is revolutionizing structural biology</article-title><source>Trends in Biochemical Sciences</source><volume>40</volume><fpage>49</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1016/j.tibs.2014.10.005</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Campbell</surname><given-names>MG</given-names></name><name><surname>Cheng</surname><given-names>A</given-names></name><name><surname>Brilot</surname><given-names>AF</given-names></name><name><surname>Moeller</surname><given-names>A</given-names></name><name><surname>Lyumkis</surname><given-names>D</given-names></name><name><surname>Veesler</surname><given-names>D</given-names></name><name><surname>Pan</surname><given-names>J</given-names></name><name><surname>Harrison</surname><given-names>SC</given-names></name><name><surname>Potter</surname><given-names>CS</given-names></name><name><surname>Carragher</surname><given-names>B</given-names></name><name><surname>Grigorieff</surname><given-names>N</given-names></name></person-group><year>2012</year><article-title>Movies of ice-embedded particles enhance resolution in electron cryo-microscopy</article-title><source>Structure</source><volume>20</volume><fpage>1823</fpage><lpage>1828</lpage><pub-id pub-id-type="doi">10.1016/j.str.2012.08.026</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Cianfrocco</surname><given-names>MA</given-names></name><name><surname>Leschziner</surname><given-names>AE</given-names></name></person-group><year>2015</year><article-title>Data from: single particle cryo-electron microscopy image processing in the cloud: high performance at low cost</article-title><source>Dryad Data Repository</source><pub-id pub-id-type="doi">10.5061/dryad.9mb54</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>J</given-names></name><name><surname>Radermacher</surname><given-names>M</given-names></name><name><surname>Penczek</surname><given-names>P</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Ladjadj</surname><given-names>M</given-names></name><name><surname>Leith</surname><given-names>A</given-names></name></person-group><year>1996</year><article-title>SPIDER and WEB: processing and visualization of images in 3D electron microscopy and related fields</article-title><source>Journal of Structural Biology</source><volume>116</volume><fpage>190</fpage><lpage>199</lpage><pub-id pub-id-type="doi">10.1006/jsbi.1996.0030</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grigorieff</surname><given-names>N</given-names></name></person-group><year>2007</year><article-title>FREALIGN: high-resolution refinement of single particle structures</article-title><source>Journal of Structural Biology</source><volume>157</volume><fpage>117</fpage><lpage>125</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2006.05.004</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hohn</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>G</given-names></name><name><surname>Goodyear</surname><given-names>G</given-names></name><name><surname>Baldwin</surname><given-names>PR</given-names></name><name><surname>Huang</surname><given-names>Z</given-names></name><name><surname>Penczek</surname><given-names>PA</given-names></name><name><surname>Yang</surname><given-names>C</given-names></name><name><surname>Glaeser</surname><given-names>RM</given-names></name><name><surname>Adams</surname><given-names>PD</given-names></name><name><surname>Ludtke</surname><given-names>SJ</given-names></name></person-group><year>2007</year><article-title>SPARX, a new environment for Cryo-EM image processing</article-title><source>Journal of Structural Biology</source><volume>157</volume><fpage>47</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2006.07.003</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>YS</given-names></name><name><surname>Nan</surname><given-names>X</given-names></name><name><surname>Sengupta</surname><given-names>P</given-names></name><name><surname>Lippincott-Schwartz</surname><given-names>J</given-names></name><name><surname>Cang</surname><given-names>H</given-names></name></person-group><year>2013</year><article-title>Accelerating 3B single-molecule super-resolution microscopy with cloud computing</article-title><source>Nature Methods</source><volume>10</volume><fpage>96</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2335</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ivica</surname><given-names>C</given-names></name><name><surname>Riley</surname><given-names>JT</given-names></name><name><surname>Shubert</surname><given-names>C</given-names></name></person-group><year>2009</year><article-title>StarHPC–Teaching parallel programming within elastic compute cloud</article-title><source>Paper presented at: information technology interfaces, 2009 ITI '09 proceedings of the ITI 2009 31st international conference on</source></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krampis</surname><given-names>K</given-names></name><name><surname>Booth</surname><given-names>T</given-names></name><name><surname>Chapman</surname><given-names>B</given-names></name><name><surname>Tiwari</surname><given-names>B</given-names></name><name><surname>Bicak</surname><given-names>M</given-names></name><name><surname>Field</surname><given-names>D</given-names></name><name><surname>Nelson</surname><given-names>KE</given-names></name></person-group><year>2012</year><article-title>Cloud BioLinux: pre-configured and on-demand bioinformatics computing for the genomics community</article-title><source>BMC Bioinformatics</source><volume>13</volume><fpage>42</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-13-42</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhlbrandt</surname><given-names>W</given-names></name></person-group><year>2014</year><article-title>Cryo-EM enters a new era</article-title><source>eLife</source><volume>3</volume><fpage>e03678</fpage><pub-id pub-id-type="doi">10.7554/eLife.03678</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Mooney</surname><given-names>P</given-names></name><name><surname>Zheng</surname><given-names>S</given-names></name><name><surname>Booth</surname><given-names>CR</given-names></name><name><surname>Braunfeld</surname><given-names>MB</given-names></name><name><surname>Gubbens</surname><given-names>S</given-names></name><name><surname>Agard</surname><given-names>DA</given-names></name><name><surname>Cheng</surname><given-names>Y</given-names></name></person-group><year>2013</year><article-title>Electron counting and beam-induced motion correction enable near-atomic-resolution single-particle cryo-EM</article-title><source>Nature Methods</source><volume>10</volume><fpage>584</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2472</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>P</given-names></name><name><surname>Bai</surname><given-names>XC</given-names></name><name><surname>Ma</surname><given-names>D</given-names></name><name><surname>Xie</surname><given-names>T</given-names></name><name><surname>Yan</surname><given-names>C</given-names></name><name><surname>Sun</surname><given-names>L</given-names></name><name><surname>Yang</surname><given-names>G</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>R</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name><name><surname>Shi</surname><given-names>Y</given-names></name></person-group><year>2014</year><article-title>Three-dimensional structure of human gamma-secretase</article-title><source>Nature</source><volume>512</volume><fpage>166</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1038/nature13567</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ludtke</surname><given-names>SJ</given-names></name><name><surname>Baldwin</surname><given-names>PR</given-names></name><name><surname>Chiu</surname><given-names>W</given-names></name></person-group><year>1999</year><article-title>EMAN: semiautomated software for high-resolution single-particle reconstructions</article-title><source>Journal of Structural Biology</source><volume>128</volume><fpage>82</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1006/jsbi.1999.4174</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMullan</surname><given-names>G</given-names></name><name><surname>Faruqi</surname><given-names>AR</given-names></name><name><surname>Henderson</surname><given-names>R</given-names></name><name><surname>Guerrini</surname><given-names>N</given-names></name><name><surname>Turchetta</surname><given-names>R</given-names></name><name><surname>Jacobs</surname><given-names>A</given-names></name><name><surname>van Hoften</surname><given-names>G</given-names></name></person-group><year>2009</year><article-title>Experimental observation of the improvement in MTF from backthinning a CMOS direct electron detector</article-title><source>Ultramicroscopy</source><volume>109</volume><fpage>1144</fpage><lpage>1147</lpage><pub-id pub-id-type="doi">10.1016/j.ultramic.2009.05.005</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mindell</surname><given-names>JA</given-names></name><name><surname>Grigorieff</surname><given-names>N</given-names></name></person-group><year>2003</year><article-title>Accurate determination of local defocus and specimen tilt in electron microscopy</article-title><source>Journal of Structural Biology</source><volume>142</volume><fpage>334</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1016/S1047-8477(03)00069-8</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohammed</surname><given-names>Y</given-names></name><name><surname>Mostovenko</surname><given-names>E</given-names></name><name><surname>Henneman</surname><given-names>AA</given-names></name><name><surname>Marissen</surname><given-names>RJ</given-names></name><name><surname>Deelder</surname><given-names>AM</given-names></name><name><surname>Palmblad</surname><given-names>M</given-names></name></person-group><year>2012</year><article-title>Cloud parallel processing of tandem mass spectrometry based proteomics data</article-title><source>Journal of Proteome Research</source><volume>11</volume><fpage>5101</fpage><lpage>5108</lpage><pub-id pub-id-type="doi">10.1021/pr300561q</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pettersen</surname><given-names>EF</given-names></name><name><surname>Goddard</surname><given-names>TD</given-names></name><name><surname>Huang</surname><given-names>CC</given-names></name><name><surname>Couch</surname><given-names>GS</given-names></name><name><surname>Greenblatt</surname><given-names>DM</given-names></name><name><surname>Meng</surname><given-names>EC</given-names></name><name><surname>Ferrin</surname><given-names>TE</given-names></name></person-group><year>2004</year><article-title>UCSF Chimera–a visualization system for exploratory research and analysis</article-title><source>Journal of Computational Chemistry</source><volume>25</volume><fpage>1605</fpage><lpage>1612</lpage><pub-id pub-id-type="doi">10.1002/jcc.20084</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><year>2012</year><article-title>RELION: implementation of a Bayesian approach to cryo-EM structure determination</article-title><source>Journal of Structural Biology</source><volume>180</volume><fpage>519</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2012.09.006</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheres</surname><given-names>SH</given-names></name></person-group><year>2014</year><article-title>Beam-induced motion correction for sub-megadalton cryo-EM particles</article-title><source>eLife</source><volume>3</volume><fpage>e03665</fpage><pub-id pub-id-type="doi">10.7554/eLife.03665</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sorzano</surname><given-names>CO</given-names></name><name><surname>Marabini</surname><given-names>R</given-names></name><name><surname>Velazquez-Muriel</surname><given-names>J</given-names></name><name><surname>Bilbao-Castro</surname><given-names>JR</given-names></name><name><surname>Scheres</surname><given-names>SH</given-names></name><name><surname>Carazo</surname><given-names>JM</given-names></name><name><surname>Pascual-Montano</surname><given-names>A</given-names></name></person-group><year>2004</year><article-title>XMIPP: a new generation of an open-source image processing package for electron microscopy</article-title><source>Journal of Structural Biology</source><volume>148</volume><fpage>194</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2004.06.006</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>G</given-names></name><name><surname>Peng</surname><given-names>L</given-names></name><name><surname>Baldwin</surname><given-names>PR</given-names></name><name><surname>Mann</surname><given-names>DS</given-names></name><name><surname>Jiang</surname><given-names>W</given-names></name><name><surname>Rees</surname><given-names>I</given-names></name><name><surname>Ludtke</surname><given-names>SJ</given-names></name></person-group><year>2007</year><article-title>EMAN2: an extensible image processing suite for electron microscopy</article-title><source>Journal of Structural Biology</source><volume>157</volume><fpage>38</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1016/j.jsb.2006.05.009</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trudgian</surname><given-names>DC</given-names></name><name><surname>Mirzaei</surname><given-names>H</given-names></name></person-group><year>2012</year><article-title>Cloud CPFP: a shotgun proteomics data analysis pipeline using cloud and high performance computing</article-title><source>Journal of Proteome Research</source><volume>11</volume><fpage>6282</fpage><lpage>6290</lpage><pub-id pub-id-type="doi">10.1021/pr300694b</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yazar</surname><given-names>S</given-names></name><name><surname>Gooden</surname><given-names>GE</given-names></name><name><surname>Mackey</surname><given-names>DA</given-names></name><name><surname>Hewitt</surname><given-names>AW</given-names></name></person-group><year>2014</year><article-title>Benchmarking undedicated cloud computing providers for analysis of genomic datasets</article-title><source>PLOS ONE</source><volume>9</volume><fpage>e108490</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0108490</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06664.013</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Scheres</surname><given-names>Sjors HW</given-names></name><role>Reviewing editor</role><aff><institution>Medical Research Council Laboratory of Molecular Biology</institution>, <country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled “Low cost, high performance processing of single particle cryo-electron microscopy data in the cloud” for consideration at <italic>eLife</italic>. Your Tools and Resources article has been favorably evaluated by John Kuriyan (Senior editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors.</p><p>The following individuals responsible for the peer review of your submission have agreed to reveal their identity: Sjors Scheres (Reviewing editor); Steven Ludtke (peer reviewer). A further reviewer remains anonymous.</p><p>The Reviewing editor and the other reviewers discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission.</p><p>All three reviewers agreed that this paper represents a novel and original way of alleviating the high computational burdens that many cryo-EM labs face with the advent of huge amounts of data from new direct electron detectors. As this paper has the potential to accelerate discovery, and to change how many labs operate, publication was recommended by all three.</p><p>The following concerns (in order of importance) were raised:</p><p>Firstly, one of the reviewers had actually recently performed the EC2 cost analysis himself and was surprised to see the estimates in this paper less expensive than his own. He writes: “The first issue is an Amazon trick. The r3.8xlarge instances are marketed as “32 vCPUs”. Actually this is 32 threads running on 16 cores when you read the fine print. For image processing this is generally 18-20 “CPUs” worth of compute power for the “32 vCPUs”. CPU-hr/mo/yr normally measure core-hours, not thread hours. This is a factor of ∼1.8. If the authors disagree, I would encourage them to run a scalability test on a small problem on a single 32 vCPU instance. Perusing the Amazon site, the cost of a single r3.8xlarge instance with 16 physical cores is currently $2.80 for on demand use, rather than the $0.35 quoted by this manuscript. While it is possible to reduce this by up to ∼50% through contract prepurchase, the only mechanism I can see for getting the price anywhere close to the cited level is by bidding on unused hours, which can mean substantial delays. Currently the purchase price for an equivalent cluster is ∼$350/core ($175/thread), or ∼$7500 for a node almost identical to the $2.80/hr instance. Anyway, by my calculation, when you take all expenses into account, EC2 is about 3-5x more expensive than owning a cluster. However, if the Amazon price were suddenly 10x lower, this would be compelling. If my cost analysis is in error, I would be honestly grateful to see a correction, as it would substantially alter how we operate.”</p><p>Secondly, in Table 1, the reported times for the other 3 cases are incorrect. They are merely the same of the values reported for the old and the new movie processing in the <xref ref-type="bibr" rid="bib22">Scheres, 2014</xref> <italic>eLife</italic> paper. There are no reported CPU costs for the entire processing procedures of these structures in the literature. However, on the RELION wiki (<ext-link ext-link-type="uri" xlink:href="http://www2.mrc-lmb.cam.ac.uk/relion/index.php/FAQs#Computational_issues">http://www2.mrc-lmb.cam.ac.uk/relion/index.php/FAQs#Computational_issues</ext-link>) it is stated: “We do 3.x Angstrom ribosome reconstructions from say 100-200 thousand particles in approximately two weeks using around 200-300 cores in parallel”. This would result (given current cost estimates) in about $800 per structure, which is still very reasonable.</p><p>Thirdly, the authors are encouraged to base their analysis on Amdahl's Law instead of the “near-linear increase” stated in the paper. While I would normally consider this a minor concern, this analysis will yield numbers which will be interesting to consider.</p><p>[Editors’ note: the decision letter after resubmission follows.]</p><p>Thank you for choosing to send your work entitled “Low cost, high performance processing of single particle cryo-electron microscopy data in the cloud” for consideration at <italic>eLife</italic>. Your revised submission has been evaluated by John Kuriyan (Senior editor) and Sjors Scheres (Reviewing editor). Based on our discussions and the individual reviews sent previously, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>.</p><p>It is unfortunate that the standard prices for Amazon's cloud are so high. We feel that bidding on unused hours is likely to be unpredictable in the future and this lack of predictability makes it less appropriate as a means of evaluating the costs of the calculations described in the paper. The true cost of doing an entire structure determination project (not only a single refinement run) at standard Amazon prices would probably quite substantially higher than the value mentioned in the Abstract. We fear that this could more expensive than buying a local cluster. Although some smaller labs may still benefit from the cloud setup, this paper will not likely change the way cryo-EM labs work in general.</p><p>[Editors’ note: after an appeal against the decision, further revisions were requested before acceptance.]</p><p>In order to give a fair and transparent view to the casual reader, we feel that the addition of a discussion on the costs of a “typical” structure determination project would add value to the paper. The phrase “as we illustrate here by determining a near-atomic resolution structure of the 80S yeast ribosome for $28.89 USD in ∼10 hours” in the current Abstract is not representative of a typical case. Many data sets will contain several hundreds of thousands of particles, and each 2D or 3D classification or refinement run will cost in the order of 100-200$ each (based on your estimates for gamma-secretase and mitoribosome). As in a typical project one would run multiple of these jobs, real costs will quickly reach more than a thousand dollars per structure, even when using the $0.35/hour bidding rate. This is perfectly well acceptable and still competitive with buying a local cluster. But discussing such values in the paper will prevent unpleasant surprises when PIs start receiving EC2 bills.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06664.014</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>The following concerns (in order of importance) were raised</italic>:</p><p><italic>Firstly, one of the reviewers had actually recently performed the EC2 cost analysis himself and was surprised to see the estimates in this paper less expensive than his own. He writes:</italic> “<italic>The first issue is an Amazon trick. The r3.8xlarge instances are marketed as</italic> “<italic>32 vCPUs</italic>”<italic>. Actually this is 32 threads running on 16 cores when you read the fine print. For image processing this is generally 18-20</italic> “<italic>CPUs</italic>” <italic>worth of compute power for the</italic> “<italic>32 vCPUs</italic>”<italic>. CPU-hr/mo/yr normally measure core-hours, not thread hours. This is a factor of ∼1.8. If the authors disagree, I would encourage them to run a scalability test on a small problem on a single 32 vCPU instance</italic>.</p><p>We would like to thank the reviewers for pointing out the difference between vCPUs and CPUs. To make sure there is no confusion, we updated the text so that all analysis and discussion of Amazon EC2 involves a discussion of CPUs and CPU core-hours (instead of hyperthreads and hyperthread-hours). This will allow the manuscript to be readily compared to other published work that reports on CPUs and CPU core-hours. We also included a section within the Materials and methods where we discuss the differences between CPUs and vCPUs.</p><p><italic>Perusing the Amazon site, the cost of a single r3.8xlarge instance with 16 physical cores is currently $2.80 for on demand use, rather than the $0.35 quoted by this manuscript. While it is possible to reduce this by up to ∼50% through contract prepurchase, the only mechanism I can see for getting the price anywhere close to the cited level is by bidding on unused hours, which can mean substantial delays. Currently the purchase price for an equivalent cluster is ∼$350/core ($175/thread), or ∼$7500 for a node almost identical to the $2.80/hr instance. Anyway, by my calculation, when you take all expenses into account, EC2 is about 3-5x more expensive than owning a cluster. However, if the Amazon price were suddenly 10x lower, this would be compelling. If my cost analysis is in error, I would be honestly grateful to see a correction, as it would substantially alter how we operate</italic>.”</p><p>We agree that Amazon EC2 is not particularly cost effective for the scenarios presented by the reviewers. We were able to minimize costs by bidding on unused hours through spot instance requests. This allowed us to reserve instances at a price of $0.35/hr instead of the on-demand cost of the r3.8xlarge is $2.80/hr. Also, we have not seen any delays in getting access to these spot instances (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), which has made them reliable during our experience with EC2. To help convey these ideas to the reader, we have included a section within the Materials and methods section describing how we were able to reserve the spot instances, comparing them to the on-demand instances.</p><p><italic>Secondly, in Table 1, the reported times for the other 3 cases are incorrect. They are merely the same of the values reported for the old and the new movie processing in the</italic> <xref ref-type="bibr" rid="bib22"><italic>Scheres, 2014</italic></xref> eLife <italic>paper. There are no reported CPU costs for the entire processing procedures of these structures in the literature. However, on the RELION wiki (</italic><ext-link ext-link-type="uri" xlink:href="http://www2.mrc-lmb.cam.ac.uk/relion/index.php/FAQs#Computational_issues"><italic>http://www2.mrc-lmb.cam.ac.uk/relion/index.php/FAQs#Computational_issues</italic></ext-link><italic>) it is stated:</italic> “<italic>We do 3.x Angstrom ribosome reconstructions from say 100-200 thousand particles in approximately two weeks using around 200-300 cores in parallel</italic>”<italic>. This would result (given current cost estimates) in about $800 per structure, which is still very reasonable</italic>.</p><p>During the preparation of the manuscript, we overlooked this incorrect comparison and we would like to thank the reviewers for raising this issue. We have updated the table to indicate that we are comparing 3D refinement processing times, not total processing times.</p><p><italic>Thirdly, the authors are encouraged to base their analysis on Amdahl's Law instead of the</italic> “<italic>near-linear increase</italic>” <italic>stated in the paper. While I would normally consider this a minor concern, this analysis will yield numbers which will be interesting to consider</italic>.</p><p>We performed the suggested analysis and found it to be very helpful in providing a theoretical limit to increases expected by Amazon STARcluster configurations. The results have been included in <xref ref-type="fig" rid="fig2">Figure 2B</xref>.</p><p>[Editors’ note: the author responses to the decision on the revised submission follows.]</p><p>While we understand the rationale behind your decision, we believe that some assumptions underlying this decision are not entirely correct. We realize we are at fault for not having presented enough data in our manuscript on the likelihood of being able to secure computational resources at the costs we quoted. We have included below these data, as part of a detailed response to the main points raised in your decision letter. We hope that this new information will more successfully make the point that cloud-based computing represents a cost-effective and general solution to the computational burden imposed by cryo-EM data analysis.</p><p><italic>It is unfortunate that the standard prices for Amazon's cloud are so high. We feel that bidding on unused hours is likely to be unpredictable in the future and this lack of predictability makes it less appropriate as a means of evaluating the costs of the calculations described in the paper</italic>.</p><p>We would like to thank you for bringing this up because it is an important concern that we should have addressed more clearly. As pointed out, the prices of Amazon’s instances can change. Despite this, the vast majority of spot instance prices have remained consistently low. This can be seen in an analysis of r3.8xlarge spot instance prices over the past three months in both the United States (Virginia) and European Union (Ireland) (<xref ref-type="fig" rid="fig5">Author response image 1</xref>). This analysis showed that users can gain access to &gt; 90% of instances at a price of $0.65/hr, which is 25% of the standard rate of $2.80/hr. Even at a price of $0.65/hr, the cost of 3D classification and refinement of the 80S ribosome would have been $53.64 (<xref ref-type="table" rid="tbl1">Author response table 1</xref>).<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.06664.015</object-id><label>Author response image 1.</label><caption><p>Percentage of instances below bid price over last 90 days. Shown are the percentages of r3.8xlarge instances that are below the spot instance price across different regions and zones.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.015">http://dx.doi.org/10.7554/eLife.06664.015</ext-link></p></caption><graphic xlink:href="elife-06664-resp-fig1-v2.tif"/></fig><table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06664.016</object-id><label>Author response table 1.</label><caption><p>Cost of 80S ribosome 3D classification and refinement on a 128 CPU STARcluster configuration at increasing spot instance price.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06664.016">http://dx.doi.org/10.7554/eLife.06664.016</ext-link></p></caption><table frame="hsides" rules="groups"><tbody><tr><td><p><italic>Spot instance bid price</italic></p></td><td><p><italic>$0.35</italic></p></td><td><p><italic>$0.45</italic></p></td><td><p><italic>$0.55</italic></p></td><td><p><italic>$0.65</italic></p></td></tr><tr><td><p>80S ribosome 3D classification and refinement cost</p></td><td><p>$28.89</p></td><td><p>$37.14</p></td><td><p>$45.39</p></td><td><p>$53.64</p></td></tr></tbody></table></table-wrap></p><p>We would also like to make two final points regarding the future of prices for Amazon instances:</p><p>Competition: Multiple cloud-based service providers (e.g. Google, Microsoft, Alibaba) already provide virtual machines for users across the world. These providers are vying to supply large privately held companies with computing resources. This will translate into stabilizing market forces that will help keep the price of cloud computing stable (if not lower it).</p><p>Moore’s law: Further development of CPU processing power will make the most ‘powerful’ generation of CPUs on Amazon cheaper within 2 years, further driving down cost.</p><p><italic>The true cost of doing an entire structure determination project (not only a single refinement run) at standard Amazon prices would probably quite substantially higher than the value mentioned in the Abstract. We fear that this could more expensive than buying a local cluster</italic>.</p><p>We would also like to thank the reviewers for raising the issue of the ‘true cost’ of single particle analysis on Amazon EC2. The estimates outlined below will highlight the cost-effectiveness of Amazon’s EC2 infrastructure; individual virtual machines can be used at rates as low as $0.003/hr. The following is an estimate for the entire processing of a single dataset:</p><p>1) Picking particles and CTF estimation: Estimated cost $2.00 (100 hrs at $0.02/hr)</p><p>For this estimate, we used a spot instance price of $0.02/hr on an m1.small instance, which has had an average spot instance price of $0.0103 +/- 0.0038 over the last 90 days in US-Virginia. At this rate, a user could select particles and estimate the CTF over the course of 100 hours (2.5 x 40 hr. work weeks) for $2.00.</p><p>2) Particle extraction: $0.20 (10 hrs at 0.02/hr)</p><p>The particle extraction of the 80S ribosome presented in our manuscript required ∼10 hrs.</p><p>3) 2D classification using Relion: $23.29 (8.32 hrs at $2.80/hr)</p><p>For the 80S ribosome dataset presented in <xref ref-type="bibr" rid="bib3">Bai et al. 2013</xref>, we performed 2D classification using Relion on a STARcluster of 128 CPUs at price of $0.35/instance/hr on 8 instances at a total cost of $2.80/hr. The final cost for classification was $23.29 to classify 62,022 at a pixel size 3.54 and a box size of 120 x 120 pixels into 250 classes (T=2) over 25 iterations.</p><p>4) 3D classification &amp; refinement using Relion: $28.89 (10.32 hrs at $2.80/hr)</p><p>This cost reflects of price of $0.35/hr/instance on a 128 CPU STARcluster, which comprises eight r3.8xlarge instances.</p><p>In summary:</p><p>Particle picking &amp; CTF estimation $2.00</p><p>Particle extraction $0.20</p><p>2D classification using Relion $23.29</p><p>3D classification &amp; refinement using Relion $28.89</p><p>Total cost $54.38</p><p><italic>Although some smaller labs may still benefit from the cloud setup, this paper will not likely change the way cryo-EM labs work in general</italic>.</p><p>The spread of cryo-EM as a common structural biology tool necessitates the spread of a cryo-EM computing software platform. Unlike X-ray crystallography, which can be used to solve atomic structures on a single workstation, cryo-EM data analysis inherently requires access to hundreds of CPUs for 3D structure determination. Currently, major universities have invested heavily in computing infrastructures, which are absent from many universities around the world. Therefore, as more labs begin to use cryo-EM software, they will need access to larger computing resources. Inherently, many of those newcomers may be small, or there may only be limited numbers of members within a laboratory that need high performance computing. We believe cloud-based computing will provide a solution to these challenges.</p><p>While cloud computing is continuing to mature, we have created a tool that will immediately address the computational burden imposed by cryo-EM data analysis. Cloud-based computing is a tool that could and would scale rapidly with the spread of cryo-EM.</p></body></sub-article></article>