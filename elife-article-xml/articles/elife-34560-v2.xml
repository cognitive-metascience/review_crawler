<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">34560</article-id><article-id pub-id-type="doi">10.7554/eLife.34560</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Learning place cells, grid cells and invariances with excitatory and inhibitory plasticity</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-90595"><name><surname>Weber</surname><given-names>Simon Nikolaus</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1169-9879</contrib-id><email>weber@tu-berlin.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-43434"><name><surname>Sprekeler</surname><given-names>Henning</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0690-3553</contrib-id><email>h.sprekeler@tu-berlin.de</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Modelling of Cognitive Processes, Institute of Software Engineering and Theoretical Computer Science</institution><institution>Technische Universität Berlin</institution><addr-line><named-content content-type="city">Berlin</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-92565"><name><surname>Foster</surname><given-names>David</given-names></name><role>Reviewing Editor</role><aff id="aff2"><institution>University of California, Berkeley</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>21</day><month>02</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e34560</elocation-id><history><date date-type="received" iso-8601-date="2017-12-21"><day>21</day><month>12</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2018-02-19"><day>19</day><month>02</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Weber et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Weber et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-34560-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.34560.001</object-id><p>Neurons in the hippocampus and adjacent brain areas show a large diversity in their tuning to location and head direction, and the underlying circuit mechanisms are not yet resolved. In particular, it is unclear why certain cell types are selective to one spatial variable, but invariant to another. For example, place cells are typically invariant to head direction. We propose that all observed spatial tuning patterns – in both their selectivity and their invariance – arise from the same mechanism: Excitatory and inhibitory synaptic plasticity driven by the spatial tuning statistics of synaptic inputs. Using simulations and a mathematical analysis, we show that combined excitatory and inhibitory plasticity can lead to localized, grid-like or invariant activity. Combinations of different input statistics along different spatial dimensions reproduce all major spatial tuning patterns observed in rodents. Our proposed model is robust to changes in parameters, develops patterns on behavioral timescales and makes distinctive experimental predictions.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.34560.002</object-id><title>eLife digest</title><p>Knowing where you are never hurts, be it during a holiday in New York or on a hiking trip in the Alps. Our sense of location seems to depend on a structure deep within the brain called the hippocampus, and its neighbor, the entorhinal cortex. Studies in rodents have shown that these areas act a little like an in-built GPS for the brain. They contain different types of neurons that help the animal to work out where it is and where it is going. Among those are place cells, present within the hippocampus, and grid cells and head direction cells, found within the entorhinal cortex and other areas.</p><p>Place cells fire whenever an animal occupies a specific location in its environment, with each place cell firing at a different spot. Grid cells generate virtual maps of the surroundings that resemble grids of repeating triangles. Whenever an animal steps onto a corner of one of these virtual triangles, the grid cell that generated that map starts to fire. Head direction cells increase their firing whenever an animal’s head is pointing in a specific direction. These cell types thus provide animals with complementary information about their location. But how do the cells first become selective for specific places or head directions?</p><p>Weber and Sprekeler propose that a single mechanism gives rise to the spatial characteristics of all these different types of cells. Like all neurons, these cells communicate with their neighbors at junctions called synapses. These may be either excitatory or inhibitory. Cells at excitatory synapses activate their neighbors, whereas cells at inhibitory synapses deactivate them. Weber and Sprekeler used a computer to simulate changes in excitatory and inhibitory synapses in a virtual rat exploring an environment. Interactions between the two types of synapses gave rise to virtual cells that behaved like place, grid or head direction cells. Which cell type emerged depended on whether the excitatory or the inhibitory synapses were more sensitive to the virtual rat’s location.</p><p>This idea adds to a range of others proposed to explain how the brain codes for locations. Whether any of these ideas or a combination of them is correct remains to be determined. Further pieces are needed if we are to solve the puzzle of how the brain supports navigation.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>synaptic plasticity</kwd><kwd>inhibition</kwd><kwd>grid cells</kwd><kwd>place cells</kwd><kwd>hippocampal formation</kwd><kwd>computational neuroscience</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002347</institution-id><institution>Bundesministerium für Bildung und Forschung</institution></institution-wrap></funding-source><award-id>FKZ 01GQ1201</award-id><principal-award-recipient><name><surname>Sprekeler</surname><given-names>Henning</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A large variety of spatial representations implied in rodent navigation could arise robustly and rapidly from inputs with a weak spatial structure, by an interaction of excitatory and inhibitory synaptic plasticity.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Neurons in the hippocampus and the adjacent regions exhibit a broad variety of spatial activation patterns that are tuned to position, head direction or both. Common observations in these spatial dimensions are localized, bell-shaped tuning curves (<xref ref-type="bibr" rid="bib67">O'Keefe, 1976</xref>; <xref ref-type="bibr" rid="bib87">Taube et al., 1990</xref>), periodically repeating activity (<xref ref-type="bibr" rid="bib32">Fyhn et al., 2004</xref>; <xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>) and invariances (<xref ref-type="bibr" rid="bib63">Muller et al., 1994</xref>; <xref ref-type="bibr" rid="bib12">Burgess et al., 2005</xref>), as well as combinations of these along different spatial dimensions (<xref ref-type="bibr" rid="bib75">Sargolini et al., 2006a</xref>; <xref ref-type="bibr" rid="bib46">Krupic et al., 2012</xref>). For example, head direction cells are often invariant to location (<xref ref-type="bibr" rid="bib12">Burgess et al., 2005</xref>), and place cells are commonly invariant to head direction (<xref ref-type="bibr" rid="bib63">Muller et al., 1994</xref>). The cellular and network mechanisms that give rise to each of these firing patterns are subject to extensive experimental and theoretical research. Several computational models have been suggested to explain the emergence of grid cells (<xref ref-type="bibr" rid="bib30">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib52">McNaughton et al., 2006</xref>; <xref ref-type="bibr" rid="bib28">Franzius et al., 2007a</xref>; <xref ref-type="bibr" rid="bib10">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib21">Couey et al., 2013</xref>; <xref ref-type="bibr" rid="bib11">Burgess et al., 2007</xref>; <xref ref-type="bibr" rid="bib43">Kropff and Treves, 2008</xref>; <xref ref-type="bibr" rid="bib14">Bush and Burgess, 2014</xref>; <xref ref-type="bibr" rid="bib15">Castro and Aguiar, 2014</xref>; <xref ref-type="bibr" rid="bib26">Dordek et al., 2016</xref>; <xref ref-type="bibr" rid="bib85">Stepanyuk, 2015</xref>; <xref ref-type="bibr" rid="bib33">Giocomo et al., 2011</xref>; <xref ref-type="bibr" rid="bib107">Zilli, 2012</xref>; <xref ref-type="bibr" rid="bib22">D'Albis and Kempter, 2017</xref>; <xref ref-type="bibr" rid="bib60">Monsalve-Mercado and Leibold, 2017</xref>), place cells (<xref ref-type="bibr" rid="bib89">Tsodyks and Sejnowski, 1995</xref>; <xref ref-type="bibr" rid="bib3">Battaglia and Treves, 1998</xref>; <xref ref-type="bibr" rid="bib1">Arleo and Gerstner, 2000</xref>; <xref ref-type="bibr" rid="bib82">Solstad et al., 2006</xref>; <xref ref-type="bibr" rid="bib29">Franzius et al., 2007b</xref>; <xref ref-type="bibr" rid="bib13">Burgess and O'Keefe, 2011</xref>; <xref ref-type="bibr" rid="bib28">Franzius et al., 2007a</xref>) and head direction cells (<xref ref-type="bibr" rid="bib53">McNaughton et al., 1991</xref>; <xref ref-type="bibr" rid="bib71">Redish et al., 1996</xref>; <xref ref-type="bibr" rid="bib106">Zhang, 1996</xref>; <xref ref-type="bibr" rid="bib28">Franzius et al., 2007a</xref>). Most of these models are designed to explain the spatial selectivity of one particular cell type and do not consider invariances along other dimensions, although the formation of invariant representations is a non-trivial problem (<xref ref-type="bibr" rid="bib24">DiCarlo and Cox, 2007</xref>). In view of the variety of spatial tuning patterns, the question arises of whether differences in tuning of different cells in different areas reflect differences in microcircuit connectivity, single cell properties or plasticity rules, or whether there is a unifying principle. In this paper we suggest that both the observed spatial selectivities and invariances can be explained by a common mechanism – interacting excitatory and inhibitory synaptic plasticity – and that the observed differences in the response profiles of grid, place and head direction cells result from differences in the spatial tuning of excitatory and inhibitory synaptic afferents. Here, we explore this hypothesis in a computational model of a feedforward network of rate-based neurons. Simulations as well as a mathematical analysis indicate that the model reproduces the large variety of response patterns of neurons in the hippocampal formation and adjacent areas and can be used to make predictions for the input statistics of each cell type.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We study the development of spatial representations in a network of rate-based neurons with interacting excitatory and inhibitory plasticity. A single model neuron that represents a cell in the hippocampal formation or adjacent areas receives feedforward input from excitatory and inhibitory synaptic afferents. As a simulated rat moves through an environment, these synaptic afferents are weakly modulated by spatial location and in later sections also by head direction. This modulation is irregular and non-localized with multiple maxima (<xref ref-type="bibr" rid="bib9">Buetfering et al., 2014</xref>); see <xref ref-type="fig" rid="fig1">Figure 1a</xref> and Materials and methods. Importantly, different inputs show different modulation profiles and each profile is temporally stable. We also show results for localized, that is, place cell-like, input (<xref ref-type="bibr" rid="bib66">O'Keefe and Dostrovsky, 1971</xref>; <xref ref-type="bibr" rid="bib50">Marshall et al., 2002</xref>; <xref ref-type="bibr" rid="bib100">Wilent and Nitz, 2007</xref>). The output rate is given by a weighted sum of the excitatory and inhibitory inputs.</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.003</object-id><label>Figure 1.</label><caption><title>Emergence of periodic, invariant and single field firing patterns.</title><p>(<bold>a</bold>) Network model for a linear track. A threshold-linear output neuron (gray) receives input from excitatory (red) and inhibitory (blue) cells, which are spatially tuned (curves on top and bottom). (<bold>b</bold>) Spatially tuned input with smoother inhibition than excitation. The fluctuating curves (top) show two exemplary spatial tunings (one is highlighted) of excitatory and inhibitory input neurons. Interacting excitatory and inhibitory synaptic plasticity gradually changes an initially random response of the output neuron (firing rate <inline-formula><mml:math id="inf1"><mml:msup><mml:mi>r</mml:mi><mml:mi>out</mml:mi></mml:msup></mml:math></inline-formula>) into a periodic, grid cell-like activity pattern. (<bold>c</bold>) If the spatial tuning of inhibitory input neurons is less smooth than that of excitatory input neurons, the interacting excitatory and inhibitory plasticity leads to a spatially invariant firing pattern. The output neuron fires close to the target rate of 1 Hz everywhere. (<bold>d</bold>) For very smooth or spatially untuned inhibitory inputs, the output neuron develops a single firing field, reminiscent of a place cell. (<bold>e</bold>) The mechanism, illustrated for place cell-like input. When a single excitatory weight is increased relative to the others, the balancing inhibitory plasticity rule leads to an immediate increase of inhibition at the associated location. If inhibitory inputs are smoother than excitatory inputs, the resulting approximate balance creates a center surround field: a local overshoot of excitation (firing field) surrounded by an inhibitory corona. The next firing field emerges at a distance where the inhibition has faded out. Iterated, this results in a spatially periodic arrangement of firing fields. (<bold>f</bold>) Inputs with place field-like tuning. Gaussian curves (top) show the spatial tuning of excitatory and inhibitory input neurons (one neuron of each kind is highlighted, 20 percent of all inputs are displayed). A grid cell firing pattern emerges from an initially random weight configuration. (<bold>g</bold>) Grid spacing <inline-formula><mml:math id="inf2"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula> scales with inhibitory tuning width <inline-formula><mml:math id="inf3"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula>. Simulation results (dots) agree with a mathematical bifurcation analysis (solid). Output firing rate examples at the two indicated locations are shown at the bottom. (<bold>h</bold>) Inhibitory smoothness <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo>,</mml:mo><mml:mi>corr</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> controls grid spacing; arrangement as in (<bold>d</bold>). Note that the time axes in (<bold>b,c,d,f</bold>) are different, because the speed at which the patterns emerge is determined by both the learning rates of the plasticity and the firing rate of the input neurons. We kept the learning rate constant and adjusted the simulation times to achieve convergence. Choosing identical simulation times, but different learning rates, leads to identical results (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Rat clip art from [<ext-link ext-link-type="uri" xlink:href="https://openclipart.org/detail/216359/klara">https://openclipart.org/detail/216359/klara</ext-link>; 2015].</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Statistics of the synaptic weights.</title><p>Depicted are the standard deviation (STD) and the coefficient of variation (CV) of excitatory (left) and inhibitory (right) weights as a function of the number of place fields per input neuron. The values are computed after the output neuron has established a stable grid pattern on a linear track. For excitatory weights, the CV decreases significantly with non-localized input. This indicates that different firing patterns in the output neuron are closer in ‘weight space’ for non-localized input. In other words, to obtain a different firing pattern, the weights must be modified by a lesser amount, that is, the configuration and thus the output pattern is less robust: An explanation for the defects in grids with non-localized input.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig1-figsupp1-v2"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Different learning rates lead to identical results.</title><p><bold>Top row:</bold> Each simulation with the same parameters as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Number of time steps and learning rates are indicated close to each plot.<bold>Bottom row:</bold> Same simulations as in top row, but with different excitatory and inhibitory learning rates and different number of simulation time steps.The two rows show basically identical time evolutions for the firing pattern of the output cell.As expected from the mathematical analysis, scaling the excitatory and inhibitory learning rates does not have an influence on the firing pattern of the output neuron, as long as learning is sufficiently slow.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig1-figsupp2-v2"/></fig></fig-group><p>In our model, both excitatory and inhibitory synaptic weights are subject to plasticity. The excitatory weights change according to a Hebbian plasticity rule (<xref ref-type="bibr" rid="bib40">Hebb, 1949</xref>) that potentiates the weights in response to simultaneous pre- and postsynaptic activity. The inhibitory synapses evolve according to a plasticity rule that changes their weights in proportion to presynaptic activity and the difference between postsynaptic activity and a target rate (1 Hz in all simulations). This rule has previously been shown to balance excitation and inhibition such that the firing rate of the output neuron approaches the target rate (<xref ref-type="bibr" rid="bib93">Vogels et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">D'Amour and Froemke, 2015</xref>). We assume the inhibitory plasticity will act fast enough to track changes of excitatory weights, so that excitation and inhibition are approximately balanced at all times.</p><sec id="s2-1"><title>Relative spatial smoothness of the excitatory and inhibitory input determines the firing pattern of the output neuron</title><p>We first simulate a rat that explores a linear track (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The spatial tuning of each input neuron is stable in time and depends smoothly on the location of the animal, but is otherwise random (e.g. <xref ref-type="fig" rid="fig1">Figure 1a</xref>). As a measure of smoothness, we use the spatial autocorrelation length. In the following, this is the central parameter of the input statistics, which is chosen separately for excitation and inhibition. In short, we assume that temporally stable spatial information is presynaptically present but we have minimal requirements on its format, aside from the spatial autocorrelation length.</p><p>At the beginning of each simulation, all synaptic weights are random. As the animal explores the track, the excitatory and inhibitory weights change in response to pre- and postsynaptic activity, and the output cell gradually develops a spatial activity pattern. We find that this pattern is primarily determined by whether the excitatory or inhibitory inputs are smoother in space. If the inhibitory tuning is smoother than the excitatory tuning (<xref ref-type="fig" rid="fig1">Figure 1b</xref>), the output neuron develops equidistant firing fields, reminiscent of grid cells on a linear track (<xref ref-type="bibr" rid="bib36">Hafting et al., 2008</xref>). If instead the excitatory tuning is smoother, the output neuron fires close to the target rate of 1 Hz everywhere (<xref ref-type="fig" rid="fig1">Figure 1c</xref>); it develops a spatial invariance. For spatially untuned inhibitory afferents (<xref ref-type="bibr" rid="bib35">Grienberger et al., 2017</xref>), the output neuron develops a single firing field, reminiscent of a one-dimensional place cell (<xref ref-type="fig" rid="fig1">Figure 1d</xref>); (cf. <xref ref-type="bibr" rid="bib19">Clopath et al., 2016</xref>).</p><p>The emergence of these firing patterns can be best explained in the simplified scenario of place field-like input tuning (<xref ref-type="fig" rid="fig1">Figure 1e,f</xref>). The spatial smoothness is then given by the size of the place fields. Let us assume that the output neuron fires at the target rate everywhere (see Materials and methods). From this homogeneous state, a small potentiation of one excitatory weight leads to an increased firing rate of the output neuron at the location of the associated place field (highlighted red curve in <xref ref-type="fig" rid="fig1">Figure 1e</xref>). To bring the output neuron back to the target rate, the inhibitory learning rule increases the synaptic weight of inhibitory inputs that are tuned to the same location (highlighted blue curve in <xref ref-type="fig" rid="fig1">Figure 1e</xref>). If these inhibitory inputs have smaller place fields than the excitatory inputs (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), this restores the target rate everywhere (<xref ref-type="bibr" rid="bib93">Vogels et al., 2011</xref>). Hence, inhibitory plasticity can stabilize spatial invariance if the inhibitory inputs are sufficiently precise (i.e. not too smooth) in space. In contrast, if the spatial tuning of the inhibitory inputs is smoother than that of the excitatory inputs, the target firing rate cannot be restored everywhere. Instead, the compensatory potentiation of inhibitory weights increases the inhibition in a spatial region at least the size of the inhibitory place fields. This leads to a corona of inhibition, in which the output neuron cannot fire (<xref ref-type="fig" rid="fig1">Figure 1e</xref>, blue region). Outside of this inhibitory surround the output neuron can fire again and the next firing field develops. Iterated, this results in a periodic arrangement of firing fields (<xref ref-type="fig" rid="fig1">Figure 1f</xref> and Figure 7b for a depiction of the input currents). Spatially untuned inhibition corresponds to a large inhibitory corona that exceeds the length of the linear track, so that only a single place field remains. From a different perspective, spatially untuned input can also be understood as a limit case of vanishing spatial variation in the firing rate rather than a limit of infinite smoothness. Consistent with this view, a development of grid patterns or invariance requires a sufficiently strong spatial modulation of the inhibitory inputs (Materials and methods).</p><p>The argument of the preceding paragraph can be extended to the scenario where input is irregularly modulated by space. For non-localized input tuning (<xref ref-type="fig" rid="fig1">Figure 1b,c,d</xref>), any weight change that increases synaptic input in one location will also increase it in a surround that is given by the smoothness of the input tuning (see Materials and methods for a mathematical analysis). In the simulations, the randomness manifests itself in occasional defects in the emerging firing pattern (<xref ref-type="fig" rid="fig1">Figure 1h</xref>, bottom, and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The above reasoning suggests that the width of individual firing fields is determined by the smoothness of the excitatory input tuning, while the distance between grid fields, that is, the grid spacing, is set by the smoothness of the inhibitory input tuning. Indeed, both simulations and a mathematical analysis (Materials and methods) confirm that the grid spacing scales linearly with the inhibitory smoothness in a large range, both for localized (<xref ref-type="fig" rid="fig1">Figure 1g</xref>) and non-localized input tuning (<xref ref-type="fig" rid="fig1">Figure 1h</xref>). The analysis also reveals a weak logarithmic dependence of the grid spacing on the ratio of the learning rates, the mean firing rates and the number of afferents of the excitatory and inhibitory population (<xref ref-type="disp-formula" rid="equ78">Equation 78</xref> and Figure 8b).</p><p>In summary, the interaction of excitatory and inhibitory plasticity can lead to spatial invariance, spatially periodic activity patterns or single place fields depending on the spatial statistics of the excitatory and inhibitory input.</p></sec><sec id="s2-2"><title>Emergence of hexagonal firing patterns</title><p>When a rat navigates in a two-dimensional arena, the spatial firing maps of grid cells in the medial entorhinal cortex (mEC) show pronounced hexagonal symmetry (<xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>; <xref ref-type="bibr" rid="bib32">Fyhn et al., 2004</xref>) with different grid spacings and spatial phases. To study whether a hexagonal firing pattern can emerge from interacting excitatory and inhibitory plasticity, we simulate a rat in a quadratic arena. The rat explores the arena for 10 hr, following trajectories extracted from behavioral data (<xref ref-type="bibr" rid="bib76">Sargolini et al., 2006b</xref>); Materials and methods. To investigate the role of the input statistics, we consider three different classes of input tuning: (i) place cell-like input (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), (ii) sparse non-localized input, in which the tuning of each input neuron is given by the sum of 100 randomly located place fields (<xref ref-type="fig" rid="fig2">Figure 2b</xref> and (iii) dense non-localized input, in which the tuning of each input is a random function with fixed spatial smoothness (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). For all input classes, the spatial tuning of the inhibitory inputs is smoother than that of the excitatory inputs.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.006</object-id><label>Figure 2.</label><caption><title>Emergence of two-dimensional grid cells.</title><p>(<bold>a,b,c</bold>) Columns from left to right: Spatial tuning of excitatory and inhibitory input neurons (two examples each); spatial firing rate map of the output neuron and corresponding autocorrelogram before and after spatial exploration of 10 hr. The number on the correlogram shows the associated grid score. Different rows correspond to different spatial tuning characteristics of the excitatory and inhibitory inputs. For all figures the spatial tuning of inhibitory input neurons is smoother than that of excitatory input neurons. (<bold>a</bold>) Each input neuron is a place cell with random location. (<bold>b</bold>) The tuning of each input neuron is given as the sum of 100 randomly located place fields. (<bold>c</bold>) The tuning of each input neuron is a random smooth function of the location. This corresponds to the sum of infinitely many randomly located place fields. Before learning, the spatial tuning of the output neuron shows no symmetry. After 10 hr of spatial exploration the output neuron developed a hexagonal pattern. (<bold>d</bold>) Grid score histogram for 500 output cells with place cell-like input. Before learning (light blue), 33% of the output cells have a positive grid score. After 10 hr of spatial exploration (dark blue), this value increases to 86%. Two example rate maps are shown. The arrows point to the grid score of the associated rate map. Even for low grid scores the learned firing pattern looks grid-like. (<bold>e,f</bold>) Grid score histograms for input tuning as in (<bold>b</bold>,<bold>c</bold>), arranged as in (<bold>d</bold>). (<bold>g</bold>) Fraction of neurons with positive grid score before (light blue) and after learning (dark blue) as a function of the number of fields per input neuron. Note that to learn within 10 hr of exploration time, we used different learning rates for different input scenarios. Using identical learning rates for all input scenarios but adjusting the simulation times to achieve convergence leads to identical results (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.007</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Influence of random simulation parameters on the final grid pattern.</title><p>Box plot of the cross correlations of the rate maps after learning of 500 simulations (i.e. <inline-formula><mml:math id="inf5"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mn>500</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>500</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>124750</mml:mn></mml:mrow></mml:math></inline-formula> cross correlations). For each set of 500 simulations, only the parameter that is indicated on the <inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo></mml:mrow></mml:math></inline-formula>axis was varied. A high cross correlation indicates that different simulations lead to similar grids and thus points towards a low influence of the varied parameter on the final grid pattern. We conclude that the influence on the final grid pattern in decreasing order is given by the parameters: Initial synaptic weights, trajectory of the rat, input tuning (i.e. locations of the randomly located input tuning curves). As expected, the correlation is lowest, if all parameters are different in each simulation (rightmost box). Each box extends from the first to the third quartile, with a dark blue line at the median. The lower whisker reaches from the lowest data point still within 1.5 IQR of the lower quartile, and the upper whisker reaches to the highest data point still within 1.5 IQR of the upper quartile, where IQR is the inter quartile range between the third and first quartile. Dots show flier points. See Appendix 1 for details on how trajectories, synaptic weights and inputs are varied.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig2-figsupp1-v2"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.008</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Using different input statistics for different populations also leads to hexagonal firing patterns.</title><p>(<bold>a</bold>) Arrangement as in <xref ref-type="fig" rid="fig2">Figure 2a</xref> but with place cell-like excitatory input and sparse non-localized inhibitory input (sum of 50 randomly located place fields). A hexagonal pattern emerges, comparable with that given in <xref ref-type="fig" rid="fig2">Figure 2a,b,c</xref>. (<bold>b</bold>) Grid score histogram of 500 realizations with mixed input statistics as in (<bold>a</bold>). Arrangement as in <xref ref-type="fig" rid="fig2">Figure 2d</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig2-figsupp2-v2"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.009</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Boundary effects in simulations with place field-like input.</title><p>(<bold>a</bold>) Simulations in a square box with input place fields that are arranged on a symmetric grid. From top to bottom: Firing rate map and corresponding autocorrelogram for an example grid cell; peak locations of 36 grid cells. The clusters at orientation of 0, 30, 60 and 90 degrees (red lines) indicate that the grids tend to be aligned to the boundaries. (<bold>b</bold>) Simulations in a circular box with input place fields that are arranged on a symmetric grid. Arrangement as in (<bold>a</bold>). The grids show no orientation preference, indicating that the orientation preference in (<bold>a</bold>) is induced by the square shape of the box. (<bold>c</bold>) Simulations in a square box with input place fields that are arranged on a distorted grid (see <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). Arrangement as in (<bold>a</bold>). The grids show no orientation preference, indicating that the influence of the boundary on the grid orientation is small compared with the effect of randomness in the location of the input centers.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig2-figsupp3-v2"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.010</object-id><label>Figure 2—figure supplement 4.</label><caption><title>Weight normalization is not crucial for the emergence of grid cells.</title><p>In all simulations in the main text we used quadratic multiplicative normalization for the excitatory synaptic weights – a conventional normalization scheme. This choice was not crucial for the emergence of patterns. (<bold>a</bold>) Firing rate map of a cell before it started exploring its surroundings. (<bold>b</bold>) From left to right: Firing rate of the output cell after 1 hr of spatial exploration for inactive, linear multiplicative, quadratic multiplicative and linear subtractive normalization. (<bold>c</bold>) Time evolution of excitatory and inhibitory weights for the simulations shown in (<bold>b</bold>). The colored lines show 200 individual weights. The black line shows the mean of all synaptic weights. From left to right: Inactive, linear multiplicative, quadratic multiplicative and linear subtractive normalization. Without normalization, the mean of the synaptic weights grows strongest and would grow indefinitely. On the normalization schemes: Linear multiplicative normalization keeps the sum of all weights constant by multiplying each weight with a factor in each time step. Linear subtractive normalization keeps the sum of all weights roughly constant by adding or subtracting a factor from all weights and ensuring that negative weights are set to zero. Quadratic multiplicative normalization is explained in Materials and methods.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig2-figsupp4-v2"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.011</object-id><label>Figure 2—figure supplement 5.</label><caption><title>Distribution of input fields.</title><p>Black square box: Arena in which the simulated rat can move (side length <inline-formula><mml:math id="inf7"><mml:mi>L</mml:mi></mml:math></inline-formula>). Blue circles: Locations of input firing fields. To create random place field locations that cover the space densely, we use locations from a distorted lattice. To this end we first create a symmetric lattice with <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>N</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> locations along the <inline-formula><mml:math id="inf9"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction and <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>N</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> locations along the <inline-formula><mml:math id="inf11"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction. To reduce boundary effects, these centers can lie a certain distance outside the boundary (typically taken as threefold the width of the Gaussian input fields). We then add noise from a uniform distribution (blue square) to each location and obtain a distorted lattice (right). See Appendix 1 for more details on the choice of input functions.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig2-figsupp5-v2"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.012</object-id><label>Figure 2—figure supplement 6.</label><caption><title>Different learning rates lead to identical results.</title><p>This is the same figure as <xref ref-type="fig" rid="fig2">Figure 2a,b,c</xref> but with identical learning rates for all three input scenarios: <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. To obtain similar results to those in <xref ref-type="fig" rid="fig2">Figure 2</xref>, we need to increase the simulation times. The exploration times for the three scenarios, from top to bottom, are: 335, 10 and 50 hr. Longer simulation times are needed for inputs with lower mean firing rate, because this corresponds to an effectively lower learning rate; compare to mathematical analysis. Note that 100 fields per neurons have a larger mean firing rate than the Gaussian random fields, because the Gaussian random fields are scaled to have a mean firing rate of 0.5 Hz (see Materials and methods). As in in one dimension, scaling the excitatory and inhibitory learning rates does not have an influence on the firing pattern of the output neuron, as long as learning is sufficiently slow. Note that the patterns here are not identical to the patterns in <xref ref-type="fig" rid="fig2">Figure 2</xref> because of a different random initialization.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig2-figsupp6-v2"/></fig></fig-group><p>Initially, all synaptic weights are random and the activity of the output neuron shows no spatial symmetry. While the rat forages through the environment, the output cell develops a periodic firing pattern for all three input classes, reminiscent of grid cells in the mEC (<xref ref-type="bibr" rid="bib32">Fyhn et al., 2004</xref>; <xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>) and typically with the same hexagonal symmetry. This hexagonal arrangement is again a result of smoother inhibitory input tuning, which generates a spherical inhibitory corona around each firing field (compare <xref ref-type="fig" rid="fig1">Figure 1e</xref>). These center-surround fields are arranged in a hexagonal pattern – the closest packing of spheres in two dimensions; (cf. <xref ref-type="bibr" rid="bib90">Turing, 1952</xref>). We find that the spacing of this pattern is determined by the inhibitory smoothness. The similarity between cells in terms of orientation and phase of the grid depends – in decreasing order – on whether they receive the same inputs, on the trajectories on which the tuning was learned and on the initial synaptic weights (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Two grid cells can thus have different phase and orientation, even if they share a large fraction or all of their inputs.</p><p>For the linear track, the randomness of the non-localized inputs leads to defects in the periodicity of the grid pattern. In two dimensions, we find that the randomness leads to distortions of the hexagonal grid. To quantify this effect, we simulated 500 random trials for each of the three input scenarios and plotted the grid score histogram (Appendix 1) before and after 10 hr of spatial exploration (<xref ref-type="fig" rid="fig2">Figure 2d,e,f</xref>). Different trials have different trajectories, different initial synaptic weights and different random locations of the input place fields (for sparse input) or different random input functions (for dense input). For place cell-like input, most of the output cells develop a positive grid score during 10 hr of spatial exploration (33% before to 86% after learning, <xref ref-type="fig" rid="fig2">Figure 2d</xref>). Even for low grid scores, the firing rate maps look grid-like after learning but exhibit a distorted symmetry (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). For sparse non-localized input, the fraction of output cells with a positive grid score increases from 35% to 87% and for dense non-localized input from 16% to 68% within 10 hr of spatial exploration (<xref ref-type="fig" rid="fig2">Figure 2e,f</xref>). The excitatory and inhibitory inputs are not required to have the same tuning statistics. Grid patterns also emerge when excitation is localized and inhibition is non-localized (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>In summary, the interaction of excitatory and inhibitory plasticity leads to grid-like firing patterns in the output neuron for all three input scenarios. The grids are typically less distorted for sparser input (<xref ref-type="fig" rid="fig2">Figure 2g</xref>).</p></sec><sec id="s2-3"><title>Rapid appearance of grid cells and their reaction to modifications of the environment</title><p>In unfamiliar environments, neurons in the mEC exhibit grid-like firing patterns within minutes (<xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>). Moreover, grid cells react quickly to changes in the environment (<xref ref-type="bibr" rid="bib31">Fyhn et al., 2007</xref>; <xref ref-type="bibr" rid="bib79">Savelli et al., 2008</xref>; <xref ref-type="bibr" rid="bib2">Barry et al., 2012</xref>). These observations challenge models for grid cells that require gradual synaptic changes during spatial exploration. In principle, the time scale of plasticity-based models can be augmented arbitrarily by increasing the synaptic learning rates. For stable patterns to emerge, however, significant weight changes must occur only after the animal has visited most of the environment. To explore the edge of this trade-off between speed and stability, we increased the learning rates to a point where the grids are still stable but where further increase would reduce the stability (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). For place cell-like input, periodic patterns can be discerned within 10 min of spatial exploration, starting with random initial weights (<xref ref-type="fig" rid="fig3">Figure 3a,b</xref>). The pattern further emphasizes over time and remains stable for many hours (<xref ref-type="fig" rid="fig3">Figure 3c</xref> and <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.013</object-id><label>Figure 3.</label><caption><title>Grid patterns form rapidly during exploration and remain stable for many hours.</title><p>(<bold>a,b</bold>) Rat trajectories with color-coded firing rate of a cell that receives place cell-like input. The color depicts the firing rate at the time of the location visit, not after learning. Bright colors indicate higher firing rates. The time interval of the trajectory is shown above each plot. Initially all synaptic weights are set to random values. Parts (<bold>a</bold>) and (<bold>b</bold>) show two different realizations with a good (red star) and a bad (orange triangle) grid score development. After a few minutes a periodic structure becomes visible and enhances over time. (<bold>c</bold>) Time course of the grid score in the simulations shown in (<bold>a</bold>) (red) and (<bold>b</bold>) (orange). While the periodic patterns emerge within minutes, the manifestation of the final hexagonal pattern typically takes a couple of hours. Once the pattern is established it remains stable for many hours. The gray scale shows the cumulative histogram of the grid scores of 500 realizations (black = 0, white = 1). The solid white and black lines indicate the 20% and 80% percentiles, respectively. (<bold>d</bold>) Histogram of grid scores of the 500 simulations shown in (<bold>c</bold>). Initial histogram in light blue, histogram after 1 hr and after 3 hr in dark blue. Numbers show the fraction of cells with positive grid score at the given time. Rat trajectories taken from <xref ref-type="bibr" rid="bib76">Sargolini et al., 2006b</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.014</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Learning too fast leads to unstable grids.</title><p>We showed that stable grid patterns emerge within minutes of behavioral rat trajectories (<xref ref-type="fig" rid="fig3">Figure 3</xref>) for high learning rates. Our model requires thorough spatial exploration of the rat, before significant weight changes occur. Accordingly, no stable patterns should emerge if the learning rate of the rat is too high. Left column: Same data as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>c with three different individual traces (top). Grid score histogram of 500 realizations before (light blue) and after 10 hr of spatial exploration (dark blue). Right column: The same simulations as shown on the left, but with twice the learning rates for excitatory and inhibitory synapses. The high learning rate leads to flickering unstable grids, as expressed in the large fluctuations in the grid score. The histogram after 10 hr of spatial exploration shows that fewer cells develop a hexagonal pattern if the learning rates are very high.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig3-figsupp1-v2"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.015</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Influence of input remapping on grid patterns.</title><p>(<bold>a</bold>) A grid is learned from random initial weights and place cell-like input. After 1 hr the grid pattern is apparent. After 5 hr we remap a fraction (number above arrows) of the input, that is, the field locations of a fraction of place fields are changed to new random locations. A remapping fraction of 0 indicates that the input is unchanged and 1 indicates that all input neurons have a new place field location. The synaptic weights are not changed in this ‘input remapping’. After the remapping, the rat explores and continues learning. For all four remapping scenarios, a periodic pattern is visible shortly after the remapping. For remapping fractions less than 1, it occurs faster than during the initial learning from random weights. (<bold>b</bold>) Time courses of the grid scores for four different input remapping fractions as in (<bold>a</bold>) (Remap. frac.; shown above). The gray scale shows the cumulative histogram of the grid scores of 500 realizations (black = 0, white = 1). The solid white and black lines indicate the 20% and 80% percentiles, respectively. Colored lines show three individual traces. The red traces correspond to the simulations shown in (<bold>a</bold>). Varying a substantial fraction of the input often does not destroy the hexagonality of the grid patterns: Note the small dip in the 80% percentile for a remapping fraction of 0.5. (<bold>c</bold>) Time course of the Pearson correlation of a developing rate map with the rate map of the same simulation at 5 hr (right before the input was modified) for the same simulations as in (<bold>b</bold>), using the same color scheme and labeling. The stronger the input remapping, the lower the correlation of the grid after remapping with the grid before remapping. Note that the grid spacing is comparable for all grids, because the spatial autocorrelation length of the input is not modified during the remapping. Thus, for complete input remapping (fraction = 1) the new grid could be realigned with the old grid by a rotation and a phase shift.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig3-figsupp2-v2"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.016</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Rapid development of grid patterns from non-localized input.</title><p>(<bold>a</bold>) Sparse non-localized input (sum of 100 randomly located place fields) as in <xref ref-type="fig" rid="fig2">Figure 2b</xref>. (<bold>b</bold>) Dense non-localized input (random function with fixed spatial smoothness) as in <xref ref-type="fig" rid="fig2">Figure 2c</xref>. While the emergence of the final patterns takes roughly an hour – and thus longer than for place cell-like inputs (<xref ref-type="fig" rid="fig3">Figure 3</xref>) – the early firing fields are still present in the final grid, as observed in experiments (<xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig3-figsupp3-v2"/></fig></fig-group><p>To investigate the robustness of this phenomenon, we ran 500 realizations with different trajectories, initial synaptic weights and locations of input place fields. In all simulations, a periodic pattern emerged within the first 30 min, and a majority of patterns exhibited hexagonal symmetry after 3 hr (increasing from 33% to 81%, <xref ref-type="fig" rid="fig3">Figure 3c,d</xref>). For non-localized input, the emergence of the final grids typically takes longer, but the first grid fields are also observed within minutes and are still present in the final grid, as observed in experiments (<xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>); (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>).</p><p>Above, we modeled the exploration of a previously unknown room by assuming the initial synaptic weights to be randomly distributed. If the rat had previous exposure to the room or to a similar room, a structure might already have formed in some of the synaptic weights. This structure could aid the development of the grid in similar rooms or hinder it in a novel room. To study this, we simulate a network that first learns the synaptic weights in one room. We then introduce a graded modification of the room by remapping the firing fields of a fraction of input neurons to random locations. We find that the output firing pattern is robust to such perturbations, even if more than half of the inputs are remapped (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). If all inputs are changed, corresponding to a novel room, a grid pattern is learned anew. The strong initial pattern in the weights does not hinder this development (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>).</p><p>Recently, <xref ref-type="bibr" rid="bib96">Wernle et al., 2018</xref> discovered that in an arena separated by a wall, single grid cells form two independent grid patterns — one on each side of the wall — that coalesce once the wall is removed. They find that grid fields close to the partition wall move to establish a more coherent pattern. In contrast, fields far away from the partition wall do not change their locations. Rosay et al. reproduced this experimental finding by simulating grid fields as interacting particles (Rosay et al., in preparation). They also demonstrated how it could be reproduced by a feedforward model for grid cells based on firing rate adaptation (Rosay et al., in preparation; <xref ref-type="bibr" rid="bib43">Kropff and Treves, 2008</xref>). Inspired by these experiments and simulations, we simulate a rat that first explores one half of a quadratic arena and then the other half, for 2.5 hr each (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). A grid pattern emerges in each compartment (<xref ref-type="fig" rid="fig4">Figure 4b,c</xref>). We then remove the partition wall and the rat explores the entire arena for another 5 hr (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). As observed experimentally, grid fields close to the former partition line rearrange to make the two grids more coherent and grid fields far away from the partition line basically stay where they were (<xref ref-type="fig" rid="fig4">Figure 4d</xref>).</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.017</object-id><label>Figure 4.</label><caption><title>Grids coalesce in contiguous environments.</title><p>(<bold>a</bold>) Illustration of the experiment. A quadratic arena (gray box) is divided into two rectangular compartments by a wall (black line). The animal explores one compartment (A) and then the other compartment (B) for 2.5 hr each. Then the wall is removed and the rat explores the entire arena (AB) for 5 hr. (<bold>b</bold>) Firing rate maps. From left to right: After learning in A; after learning in B; the maps from A and B shown side by side (A|B); after learning in AB. (<bold>c</bold>) Autocorrelograms of the rate maps shown in (<bold>b</bold>). The number inside the correlogram shows the grid score. (<bold>d</bold>) Box plot of the correlations of the firing rate map A|B with the firing rate map AB as a function of distance from the partition wall. Close to the partition wall the correlation is low, far away from the partition wall it is high. This indicates that grid fields rearrange only locally. Each box extends from the first to the third quartile, with a dark blue line at the median. The lower whisker reaches from the lowest data point still within 1.5 IQR of the lower quartile, and the upper whisker reaches to the highest data point still within 1.5 IQR of the upper quartile, where IQR is the inter quartile range between the third and first quartile. Dots show flier points. Data: 100 realizations of experiments as in (<bold>a</bold>,<bold>b</bold>,<bold>c</bold>). For simulation details see Appendix 1. Mouse clip art from lemmling, <ext-link ext-link-type="uri" xlink:href="https://openclipart.org/detail/17622/simple-cartoon-mouse-1">https://openclipart.org/detail/17622/simple-cartoon-mouse-1</ext-link>; 2006.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig4-v2"/></fig><p>In summary, periodic patterns emerge rapidly in our model and the associated time scale is limited primarily by how quickly the animal visits its surroundings, that is, by the same time scale that limits the experimental recognition of the grids.</p></sec><sec id="s2-4"><title>Place cells, band cells and stretched grids</title><p>In addition to grids, the mEC and adjacent brain areas exhibit a plethora of other spatial activity patterns including spatially invariant (<xref ref-type="bibr" rid="bib12">Burgess et al., 2005</xref>), band-like (periodic along one direction and invariant along the other) (<xref ref-type="bibr" rid="bib46">Krupic et al., 2012</xref>), and spatially periodic but non-hexagonal patterns (<xref ref-type="bibr" rid="bib46">Krupic et al., 2012</xref>; <xref ref-type="bibr" rid="bib39">Hardcastle et al., 2017</xref>; <xref ref-type="bibr" rid="bib25">Diehl et al., 2017</xref>). Note that it is currently debated whether or not some of the observed spatially periodic but non-hexagonal firing patterns are artifacts of poorly isolated single cell data in multi-electrode recordings (<xref ref-type="bibr" rid="bib64">Navratilova et al., 2016</xref>; <xref ref-type="bibr" rid="bib45">Krupic et al., 2015b</xref>). In contrast to spatially periodic tuning, place cells in the hippocampus proper are typically only tuned to a single or few locations in a given environment (<xref ref-type="bibr" rid="bib66">O'Keefe and Dostrovsky, 1971</xref>; <xref ref-type="bibr" rid="bib61">Moser et al., 2008</xref>; <xref ref-type="bibr" rid="bib49">Leutgeb et al., 2005</xref>). If the animal traversed the environment along a straight line, all of these cells would be classified as periodic, localized or invariant (<xref ref-type="fig" rid="fig1">Figure 1</xref>), although the classification could vary depending on the direction of the line. Based on this observation, we hypothesized that all of these patterns could be the result of an input autocorrelation structure that differs along different spatial directions.</p><p>We first verified that also in a two-dimensional arena, place cells emerge from a very smooth inhibitory input tuning (<xref ref-type="fig" rid="fig5">Figure 5a,b</xref>). The emergence of place cells is independent of the exact shape of the excitatory input. Non-localized inputs (<xref ref-type="fig" rid="fig5">Figure 5a</xref>) lead to similar results as those from grid cell-like inputs of different orientation and grid spacing (<xref ref-type="fig" rid="fig5">Figure 5b</xref>, Methods and materials); for other models for the emergence of place cells from grid cells see (<xref ref-type="bibr" rid="bib82">Solstad et al., 2006</xref>; <xref ref-type="bibr" rid="bib29">Franzius et al., 2007b</xref>; <xref ref-type="bibr" rid="bib72">Rolls et al., 2006</xref>; <xref ref-type="bibr" rid="bib59">Molter and Yamaguchi, 2008</xref>; <xref ref-type="bibr" rid="bib91">Ujfalussy et al., 2009</xref>; <xref ref-type="bibr" rid="bib77">Savelli and Knierim, 2010</xref>). Next we verified that also in two dimensions, spatial invariance results when excitation is broader than inhibition (<xref ref-type="fig" rid="fig5">Figure 5c</xref>). We then varied the smoothness of the inhibitory inputs independently along two spatial directions. If the spatial tuning of inhibitory inputs is smoother than the tuning of the excitatory inputs along one dimension but less smooth along the other, the output neuron develops band cell-like firing patterns (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). If inhibitory input is smoother than excitatory input, but not isotropic, the output cell develops stretched grids with different spacing along two axes (<xref ref-type="fig" rid="fig5">Figure 5e</xref>). For these anisotropic cases, stretched hexagonal grids and rectangular arrangements of firing fields appear similarly favorable (compare <xref ref-type="fig" rid="fig5">Figure 5e</xref>, second row and column). A hexagonal arrangement is favored by a dense packing of inhibitory coronas, whereas a rectangular arrangement would maximize the proximity of the excitatory centers, given the inhibitory corona (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.018</object-id><label>Figure 5.</label><caption><title>Emergence of spatially tuned cells of diverse symmetries.</title><p>(<bold>a,b,c,d</bold>) Arrangement as in <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>a,b</bold>) Place cells emerge if the inhibitory autocorrelation length exceeds the box length or if the inhibitory neurons are spatially untuned. The type of tuning of the excitatory input is not crucial: Place cells develop for non-localized input (<bold>a</bold>) as well as for grid cell input (<bold>b</bold>). (<bold>c</bold>) The output neuron develops an invariance if the spatial tuning of inhibitory input neurons is less smooth than the tuning of excitatory input neurons. (<bold>d</bold>) Band cells emerge if the spatial tuning of inhibitory input is asymmetric, such that its autocorrelation length is larger than that of excitatory input along one direction (here the <inline-formula><mml:math id="inf14"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction) and smaller along the other (here the <inline-formula><mml:math id="inf15"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction). (<bold>e</bold>) Overview of how the shape of the inhibitory input tuning determines the firing pattern of the output neuron. Each element depicts the firing rate map of the output neuron after 10 hr. White ellipses of width <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> in <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>x</mml:mi><mml:mo mathvariant="normal">-</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>y</mml:mi><mml:mo mathvariant="normal">-</mml:mo></mml:mrow></mml:math></inline-formula>direction indicate the direction-dependent standard deviation of the spatial tuning of the inhibitory input neurons. For simplicity, the width of the excitatory tuning fields, <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula>, is the same in all simulations. It determines the size of the circular firing fields. The red circle at the axis origin is of diameter <inline-formula><mml:math id="inf21"><mml:mrow><mml:mn mathvariant="normal">2</mml:mn><mml:mo mathvariant="italic">⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig5-v2"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.019</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Arrangement of firing fields for asymmetric input.</title><p>(<bold>a</bold>) For ellipsoidal spatial autocorrelation structures of inhibitory input (blue line), we observed band cell-like firing patterns or stretched grids (<xref ref-type="fig" rid="fig5">Figure 5e</xref>). Interestingly, the resulting patterns alternate between two different symmetries. This can be understood by two competing arrangements of ellipsoids. (<bold>b</bold>) A dense packing of ellipsoids maximizes the area with non-zero firing and is favored by the inhibitory learning rule. This leads to stretched grids. (<bold>c</bold>) Maximizing the overlap between excitatory input fields is favored by the excitatory learning rule and leads to quadratic grids with different periodicities along different directions. (<bold>d</bold>) Some simulations show a combination of both patterns; compare <xref ref-type="fig" rid="fig5">Figure 5e</xref>. The observed alignment of excitatory firing fields in (<bold>c</bold>) is particularly favored, if inhibition is very smooth along one direction. This could lead to alignment of the head direction of individual grid fields in the simulations shown in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig5-figsupp1-v2"/></fig></fig-group><p>In summary, the relative spatial smoothness of inhibitory and excitatory input determines the symmetry of the spatial firing pattern of the output neuron. The requirements for the input tuning that support invariance, periodicity and localization apply individually to each spatial dimension, opening up a combinatorial variety of spatial tuning patterns.</p></sec><sec id="s2-5"><title>Spatially tuned input combined with head direction selectivity leads to grid, conjunctive and head direction cells</title><p>Many cells in and around the hippocampus are tuned to the head direction of the animal (<xref ref-type="bibr" rid="bib87">Taube et al., 1990</xref>; <xref ref-type="bibr" rid="bib88">Taube, 1995</xref>; <xref ref-type="bibr" rid="bib17">Chen et al., 1994</xref>). These head direction cells are typically tuned to a single head direction, just like place cells are typically tuned to a single location. Moreover, head direction cells are often invariant to location (<xref ref-type="bibr" rid="bib12">Burgess et al., 2005</xref>), just like place cells are commonly invariant to head direction (<xref ref-type="bibr" rid="bib63">Muller et al., 1994</xref>). There are also cell types with conjoined spatial and head direction tuning. Conjunctive cells in the mEC fire like grid cells in space, but only in a particular head direction (<xref ref-type="bibr" rid="bib75">Sargolini et al., 2006a</xref>), and many place cells in the hippocampus of crawling bats also exhibit head direction tuning (<xref ref-type="bibr" rid="bib74">Rubin et al., 2014</xref>). To investigate whether these tuning properties could also result in our model, we simulated a rat that moves in a square box, whose head direction is constrained by the direction of motion (Appendix 1). Each input neuron is tuned to both space and head direction (see <xref ref-type="fig" rid="fig6">Figure 6</xref> for localized and <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> for non-localized input).</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.020</object-id><label>Figure 6.</label><caption><title>Combined spatial and head direction tuning.</title><p>(<bold>a,b,c</bold>) Columns from left to right: Spatial tuning and head direction tuning (polar plot) of excitatory and inhibitory input neurons (one example each); spatial firing rate map of the output neuron before learning and after spatial exploration of 10 hr with corresponding autocorrelogram; head direction tuning of the output neuron after learning. The numbers in the polar plots indicate the peak firing rate at the preferred head direction after averaging over space. (<bold>a</bold>) Wider spatial tuning of inhibitory input neurons than of excitatory input neurons combined with narrower head direction tuning of inhibitory input neurons leads to a grid cell-like firing pattern in space with invariance to head direction, that is, the output neuron fires like a pure grid cell. (<bold>b</bold>) The same spatial input characteristics combined with head direction-invariant inhibitory input neurons leads to grid cell-like activity in space and a preferred head direction, that is, the output neuron fires like a conjunctive cell. (<bold>c</bold>) If the spatial tuning of inhibitory input neurons is less smooth than that of excitatory neurons and the concurrent head direction tuning is wider for inhibitory than for excitatory neurons, the output neuron is not tuned to space but to a single head direction, that is, the output neuron fires like a pure head direction cell. (<bold>d</bold>) Head direction tuning and grid score of 10 simulations of the three cell types. Each symbol represents one realization with random input tuning. The markers correspond to the tuning properties of the input neurons as depicted in (<bold>a,b,c</bold>): grid cell (triangles), conjunctive cell (squares), head direction cell (circles). The values that correspond to the output cells in (<bold>a,b,c</bold>) are shown as filled symbols. (<bold>e</bold>) In our model, the head direction tuning of individual grid fields is sharper than the overall head direction tuning of the conjunctive cell. Depicted is a rate map of a conjunctive cell (left) and the corresponding head direction tuning (right, dashed). For three individual grid fields, indicated with colored squares, the head direction tuning is shown in the same polar plot. The overall tuning of the grid cell (dashed) is a superposition of the tuning of all grid fields. Numbers indicate the peak firing rate (in Hz) averaged individually within each of the four rectangles in the rate map.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig6-v2"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.021</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Cells with combined spatial and head direction tuning with input tuning that is given by the sum of 20 randomly located Gaussian ellipsoids.</title><p>Arrangement as in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig6-figsupp1-v2"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.34560.022</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Head direction tuning of individual grid fields is difficult to assess from grid cells with few firing fields.</title><p>(<bold>a</bold>) Spike locations of a grid cell color-coded with the head direction of the rat at the moment the respective spike was fired. Circular mean and circular standard deviation of head directions at spike firing (‘spike head directions’ in the following) shown above. (<bold>b</bold>) Polar histogram of spike head directions (filled fan) and trajectory head directions (black fan) for all spikes of the grid cell. <inline-formula><mml:math id="inf22"><mml:mi>N</mml:mi></mml:math></inline-formula>: Number of spikes. <inline-formula><mml:math id="inf23"><mml:mi>v</mml:mi></mml:math></inline-formula>: Sum of <inline-formula><mml:math id="inf24"><mml:mi>N</mml:mi></mml:math></inline-formula> unit vectors whose orientation is given by the spike head directions, normalized by <inline-formula><mml:math id="inf25"><mml:mi>N</mml:mi></mml:math></inline-formula>. The larger this number, the more precise the head direction tuning. <inline-formula><mml:math id="inf26"><mml:msup><mml:mi>U</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>: Watson’s <inline-formula><mml:math id="inf27"><mml:msup><mml:mi>U</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value (Appendix 1). The larger this number, the more the distribution of spike head directions deviates from the distribution of trajectory head directions. (<bold>c</bold>) Same arrangement as in (<bold>b</bold>) but for individual grid fields. Each plot corresponds to a different grid field. The colors of the filled fans correspond to the colors of the circles around grid fields in (<bold>a</bold>). Only spikes within these circles are considered. Individual grid fields often exhibit a sharper head direction tuning than the entire cell; compare the larger <inline-formula><mml:math id="inf28"><mml:mi>v</mml:mi></mml:math></inline-formula> values. However, the trajectory often exhibits a strong head direction bias; compare the directionality of black fans. The head direction tuning of a grid field tends to align with this bias; compare the smaller <inline-formula><mml:math id="inf29"><mml:msup><mml:mi>U</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values. Quantitative statements about the head direction tuning of individual grid fields would be easier for cells with more firing fields, because the head direction bias of rodents is less pronounced in central parts of the arena (<xref ref-type="bibr" rid="bib74">Rubin et al., 2014</xref>); compare the grid field in the light green circle. From the publicly available data, we did not come to a conclusive answer on the tuning of individual grid fields. Data obtained from (<xref ref-type="bibr" rid="bib75">Sargolini et al., 2006a</xref>; <xref ref-type="bibr" rid="bib76">Sargolini et al., 2006b</xref>).</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig6-figsupp2-v2"/></fig></fig-group><p>In line with the previous observations, we find that the spatial tuning of the output neuron is determined by the relative spatial smoothness of the excitatory and inhibitory inputs, and the head direction tuning of the output neuron is determined by the relative smoothness of the head direction tuning of the inputs from the two populations. If the head direction tuning of excitatory input neurons is smoother than that of inhibitory input neurons, the output neuron becomes invariant to head direction (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). If instead only the excitatory input is tuned to head direction, the output neuron develops a single activity bump at a particular head direction (<xref ref-type="fig" rid="fig6">Figure 6b,c</xref>). The concurrent spatial tuning of the inhibitory input neurons determines the spatial tuning of the output neuron. For spatially smooth inhibitory input, the output neuron develops a hexagonal firing pattern (<xref ref-type="fig" rid="fig6">Figure 6a,b</xref>), and for less smooth inhibitory input the firing of the output neuron is invariant to the location of the animal (<xref ref-type="fig" rid="fig6">Figure 6c</xref>).</p><p>In summary, the relative smoothness of inhibitory and excitatory input neurons in space and in head direction determines whether the output cell fires like a pure grid cell, a conjunctive cell or a pure head direction cell (<xref ref-type="fig" rid="fig6">Figure 6d</xref>).</p><p>We find that the overall head direction tuning of conjunctive cells is broader than that of individual grid fields (<xref ref-type="fig" rid="fig6">Figure 6e</xref>). This results from variations in the preferred head direction of different grid fields. Typically, however, these variations remain small enough to preserve an overall head direction tuning of the cell, because individual grid fields tend to align their head direction tuning (compare with <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, but in three dimensions). Whether or not a narrower head direction of individual grid fields or a different preferred direction for different grid fields is present also in rodents is not resolved (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We presented a self-organization model that reproduces the experimentally observed spatial and head direction tuning patterns in the hippocampus and adjacent brain regions. Its core mechanism is an interaction of Hebbian plasticity in excitatory synapses and homeostatic Hebbian plasticity in inhibitory synapses (<xref ref-type="bibr" rid="bib93">Vogels et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">D'Amour and Froemke, 2015</xref>). The main prediction of the model is that the spatial autocorrelation structure of excitatory and inhibitory inputs determines – and should thus be predictable from – the output pattern of the cell. Investigations of the tuning of individual cells (<xref ref-type="bibr" rid="bib97">Wertz et al., 2015</xref>) or even synapses (<xref ref-type="bibr" rid="bib102">Wilson et al., 2016</xref>) that project to spatially tuned cells would thus be a litmus test for the proposed mechanism.</p><sec id="s3-1"><title>Origin of spatially tuned synaptic input</title><p>The origin of synaptic input to spatially tuned cells is not fully resolved (<xref ref-type="bibr" rid="bib92">van Strien et al., 2009</xref>). Given that our model is robust to the precise properties of the input, it is consistent with input from higher sensory areas (<xref ref-type="bibr" rid="bib86">Tanaka, 1996</xref>; <xref ref-type="bibr" rid="bib70">Quiroga et al., 2005</xref>) that could inherit spatial tuning from their sensory tuning in a stable environment (<xref ref-type="bibr" rid="bib1">Arleo and Gerstner, 2000</xref>; <xref ref-type="bibr" rid="bib28">Franzius et al., 2007a</xref>). This is in line with the observation that grid cells lose their firing profiles in darkness (<xref ref-type="bibr" rid="bib16">Chen et al., 2016</xref>; <xref ref-type="bibr" rid="bib69">Pérez-Escobar et al., 2016</xref>) and that the hexagonal pattern rotates when a visual cue card is rotated (<xref ref-type="bibr" rid="bib69">Pérez-Escobar et al., 2016</xref>).</p><p>The input could also stem from within the hippocampal formation, where spatial tuning has been observed in both excitatory (<xref ref-type="bibr" rid="bib67">O'Keefe, 1976</xref>) and inhibitory (<xref ref-type="bibr" rid="bib50">Marshall et al., 2002</xref>; <xref ref-type="bibr" rid="bib100">Wilent and Nitz, 2007</xref>; <xref ref-type="bibr" rid="bib38">Hangya et al., 2010</xref>) neurons. For example, the notion that mEC neurons receive input from hippocampal place cells is supported by several studies: Place cells in the hippocampus emerge earlier during development than grid cells in the mEC (<xref ref-type="bibr" rid="bib47">Langston et al., 2010</xref>; <xref ref-type="bibr" rid="bib101">Wills et al., 2010</xref>), grid cells lose their tuning pattern when the hippocampus is deactivated (<xref ref-type="bibr" rid="bib5">Bonnevie et al., 2013</xref>) and both the firing fields of place cells and the spacing and field size of grid cells increase along the dorso-ventral axis (<xref ref-type="bibr" rid="bib41">Jung et al., 1994</xref>; <xref ref-type="bibr" rid="bib8">Brun et al., 2008b</xref>; <xref ref-type="bibr" rid="bib83">Stensola et al., 2012</xref>). Moreover, entorhinal stellate cells, which often exhibit grid-like firing patterns, receive a large fraction of their input from the hippocampal CA2 region (<xref ref-type="bibr" rid="bib73">Rowland et al., 2013</xref>), where many cells are tuned to the location of the animal (<xref ref-type="bibr" rid="bib51">Martig and Mizumori, 2011</xref>).</p><p>Inhibition is usually thought to arise from local interneurons – but see (<xref ref-type="bibr" rid="bib55">Melzer et al., 2012</xref>) – suggesting that spatially tuned inhibitory input to mEC neurons originates from the entorhinal cortex itself. Interneurons in mEC display spatial tuning (<xref ref-type="bibr" rid="bib9">Buetfering et al., 2014</xref>; <xref ref-type="bibr" rid="bib79">Savelli et al., 2008</xref>; <xref ref-type="bibr" rid="bib27">Frank et al., 2001</xref>) that could be inherited from hippocampal place cells, other grid cells (<xref ref-type="bibr" rid="bib21">Couey et al., 2013</xref>; <xref ref-type="bibr" rid="bib68">Pastoll et al., 2013</xref>; <xref ref-type="bibr" rid="bib103">Winterer et al., 2017</xref>) or from entorhinal cells with nongrid spatial tuning (<xref ref-type="bibr" rid="bib25">Diehl et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Hardcastle et al., 2017</xref>). The broader spatial tuning required for the emergence of spatial selectivity could be established, for example by pooling over cells with similar tuning or through a non-linear input-output transformation in the inhibitory circuitry. If inhibitory input is indeed local, the increase in grid spacing along the dorso-ventral axis (<xref ref-type="bibr" rid="bib8">Brun et al., 2008b</xref>) suggests that the tuning of inhibitory interneurons gets smoother along this axis. For smoother tuning functions, fewer neurons are needed to cover the whole environment, in accordance with the decrease in interneuron density along the dorso-ventral axis (<xref ref-type="bibr" rid="bib4">Beed et al., 2013</xref>).</p><p>The excitatory input to hippocampal place cells could originate from grid cells in entorhinal cortex (<xref ref-type="fig" rid="fig5">Figure 5b</xref>), which is supported by anatomical (<xref ref-type="bibr" rid="bib92">van Strien et al., 2009</xref>) and lesion studies (<xref ref-type="bibr" rid="bib7">Brun et al., 2008a</xref>). The required untuned inhibition could arrive from interneurons in the hippocampus proper that often show very weak spatial tuning (<xref ref-type="bibr" rid="bib50">Marshall et al., 2002</xref>). In addition to grid cell input, place cells are also thought to receive inputs from other cell types, such as border cells (<xref ref-type="bibr" rid="bib62">Muessig et al., 2015</xref>) and other brain regions such as the medial septum (<xref ref-type="bibr" rid="bib94">Wang et al., 2015</xref>) .</p></sec><sec id="s3-2"><title>Dissociation from continuous attractor network models</title><p>The observed spatial tuning patterns have also been explained by other models. In continuous attractor networks (CAN), each cell type could emerge from a specific recurrent connectivity pattern, combined with a mechanism that translates the motion of the animal into shifts of neural activity on an attractor. How the required connectivity patterns – which lie at the core of any CAN model – could emerge is subject to debate (<xref ref-type="bibr" rid="bib98">Widloski and Fiete, 2014</xref>). Our model is qualitatively different in that it does not rely on attractor dynamics in a recurrent neural network, but on experience-dependent plasticity of spatially modulated afferents to an individual output neuron (<xref ref-type="bibr" rid="bib54">Mehta et al., 2000</xref>). A measurable distinction of our model from CAN models is its response to a rapid global reduction of inhibition. While a modification of inhibition typically changes the grid spacing in CAN models of grid cells (<xref ref-type="bibr" rid="bib21">Couey et al., 2013</xref>; <xref ref-type="bibr" rid="bib99">Widloski and Fiete, 2015</xref>), the grid field locations generally remain untouched in our model. The grid fields merely change in size, until inhibition is recovered by inhibitory plasticity (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). This can be understood by the colocalization of the grid fields and the peaks in the excitatory membrane current (<xref ref-type="fig" rid="fig7">Figure 7b,c</xref>). A reduction of inhibition leads to an increased protrusion of these excitatory peaks and thus to wider firing fields. Grid patterns in mEC are temporally stable in spite of dopaminergic modulations of GABAergic transmission (<xref ref-type="bibr" rid="bib18">Cilz et al., 2014</xref>) and the spacing of mEC grid cells remains constant during the silencing of inhibitory interneurons (<xref ref-type="bibr" rid="bib57">Miao et al., 2017</xref>). Both observations are in line with our model. Moreover, we found that for localized input tuning, the inhibitory membrane current typically also peaks at the locations of the grid fields. This co-tuning breaks down for non-localized input (<xref ref-type="fig" rid="fig7">Figure 7b</xref>). In contrast, CAN models predict that the inhibitory membrane current has the same periodicity as the grid (<xref ref-type="bibr" rid="bib80">Schmidt-Hieber and Häusser, 2013</xref>), but possibly phase shifted.</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.023</object-id><label>Figure 7.</label><caption><title>Effect of reduced inhibition on grid cell properties.</title><p>(<bold>a</bold>) Reducing the strength of inhibitory synapses to a fraction of its initial value (from left to right: 1, 1/2, 1/4) leads to larger grid fields but unchanged grid spacing in our model. In continuous attractor network models, the same reduction of inhibition would affect not only the field size but also the grid spacing. (<bold>b</bold>) Excitatory (red) and inhibitory (blue) membrane current to a cell with grid-like firing pattern (gray) on a linear track. The currents are normalized to a maximum value of 1. Different rows correspond to different spatial tuning characteristics of the input neurons. From top to bottom: Place cell-like tuning, sparse non-localized tuning (sum of 100 randomly located place fields), dense non-localized tuning (Gaussian random fields). Peaks in excitatory membrane current are co-localized with grid fields (shaded area) for all input statistics. In contrast, the inhibitory membrane current is not necessarily correlated with the grid fields for non-localized input. Moreover, the dynamic range of the membrane currents is reduced for non-localized input. A reduction of inhibition as shown in (<bold>a</bold>) corresponds to a lowering of the inhibitory membrane current. (<bold>c</bold>) Excitatory and inhibitory membrane current to a grid cell receiving sparse non-localized input (sum of 100 randomly located place fields) in two dimensions. Top: Tuning of output firing rate, normalized excitatory and inhibitory membrane current. Bottom: Autocorrelograms thereof. The grid pattern is more apparent in the spatial tuning of the excitatory membrane current than in the inhibitory membrane current.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig7-v2"/></fig><p>The grid patterns of topologically nearby grid cells in the mEC typically have the same orientation and spacing but different phases (<xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>). Moreover, the coupling between anatomically nearby grid cells – for example their difference in spatial phase – is more stable to changes of the environment than the firing pattern of individual grid cells (<xref ref-type="bibr" rid="bib104">Yoon et al., 2013</xref>). These properties are immanent to CAN models. In contrast, single cell models (<xref ref-type="bibr" rid="bib11">Burgess et al., 2007</xref>; <xref ref-type="bibr" rid="bib43">Kropff and Treves, 2008</xref>; <xref ref-type="bibr" rid="bib15">Castro and Aguiar, 2014</xref>; <xref ref-type="bibr" rid="bib85">Stepanyuk, 2015</xref>; <xref ref-type="bibr" rid="bib26">Dordek et al., 2016</xref>; <xref ref-type="bibr" rid="bib22">D'Albis and Kempter, 2017</xref>; <xref ref-type="bibr" rid="bib60">Monsalve-Mercado and Leibold, 2017</xref>) require additional mechanisms to develop a coordination of neighboring grid cells. The challenge for any mechanism is to correlate the grid orientations, but leave the grid phases uncorrelated. The most obvious candidate, recurrent connections among different grid cells (<xref ref-type="bibr" rid="bib81">Si et al., 2012</xref>), requires an intricate combination of mechanisms to perform this balancing act. We assume that an appropriate recurrent connectivity would not be simpler in our model.</p><p>CAN models predict that all grid fields in a conjunctive (grid x head direction) cell have the same head direction tuning, whereas our model predicts that there could be differences between different grid fields (<xref ref-type="fig" rid="fig6">Figure 6e</xref>). Our preliminary analysis suggests that an in-depth evaluation would require data for central grid fields without trajectory biases (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>), which are at present not publicly available.</p><p>In addition, CAN models require that conjunctive (grid x head direction) cells are positively modulated by running speed. Such modulation has been observed in experiments (<xref ref-type="bibr" rid="bib42">Kropff et al., 2015</xref>). In our model, we could introduce a running speed dependence, for example as a global modulation of the input signals. We expect that in this case, the output neuron would inherit speed tuning from the input but would otherwise develop similar spatial tuning patterns.</p><p>A recent analysis has shown that periodic firing of entorhinal cells in rats that move on a linear track can be assessed as slices through a hexagonal grid (<xref ref-type="bibr" rid="bib105">Yoon et al., 2016</xref>), which arises naturally in a two-dimensional CAN model. In our model, we would obtain slices through a hexagonal grid if the rat learns the output pattern in two dimensions and afterwards is constrained to move on a linear track that is part of the same arena. If the rat learns the firing pattern on the linear track from scratch, the firing fields would be periodic.</p></sec><sec id="s3-3"><title>Rapid appearance and rearrangement of grids</title><p>Models that learn grid cells from spatially tuned input do not have to assume a preexisting connectivity pattern or specific mechanisms for path integration (<xref ref-type="bibr" rid="bib11">Burgess et al., 2007</xref>), but are challenged by the fast emergence of hexagonal firing patterns in unfamiliar environments (<xref ref-type="bibr" rid="bib37">Hafting et al., 2005</xref>). Most plasticity-based models require slow learning, such that the animal explores the whole arena before significant synaptic changes occur. Therefore, grid patterns typically emerge slower than experimentally observed (<xref ref-type="bibr" rid="bib26">Dordek et al., 2016</xref>). This delay is particularly pronounced in models that require an extensive exploration of both space and movement direction (<xref ref-type="bibr" rid="bib43">Kropff and Treves, 2008</xref>; <xref ref-type="bibr" rid="bib28">Franzius et al., 2007a</xref>; <xref ref-type="bibr" rid="bib22">D'Albis and Kempter, 2017</xref>). In contrast to these models, which give center stage to the temporal statistics of the animal’s movement, our approach relies purely on the spatial statistics of the input and is hence insensitive to running speed.</p><p>For the mechanism we suggested, the self-organization was very robust and allowed rapid pattern formation on short time scales, similar to those observed in rodents (<xref ref-type="fig" rid="fig3">Figure 3</xref>). This speed could be further increased by accelerated reactivation of previous experiences during periods of rest (<xref ref-type="bibr" rid="bib48">Lee and Wilson, 2002</xref>). By this means, the exploration time and the time it takes to activate all input patterns could be decoupled, leading to a much faster emergence of grid cells in all trajectory-independent models with associative learning. Other models that explain the emergence of grid patterns from place cell input through synaptic depression and potentiation also develop grid cells in realistic times (<xref ref-type="bibr" rid="bib15">Castro and Aguiar, 2014</xref>; <xref ref-type="bibr" rid="bib85">Stepanyuk, 2015</xref>; <xref ref-type="bibr" rid="bib60">Monsalve-Mercado and Leibold, 2017</xref>). These models differ from ours in that they do not require inhibition, but instead specific forms of rate-dependent synaptic depression and potentiation that change the synaptic weights such that place cell-like input leads to grid cell-like output. How these models generalize to potentially non-localized input is yet to be shown.</p><p>Learning the required connectivity in CAN models can take a long time (<xref ref-type="bibr" rid="bib98">Widloski and Fiete, 2014</xref>). However, as soon as the required connectivity and translation mechanism is established, a grid pattern would be observed immediately, even in a novel room. For different rooms this pattern could have different phases and orientations, but similar grid spacing (<xref ref-type="bibr" rid="bib31">Fyhn et al., 2007</xref>). Similarly, we found that room switches in our model lead to grid patterns of the same grid spacing but different phases and orientations. The pattern emerges rapidly, but is not instantaneously present (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). It would be interesting to study whether rotation of a fraction of the input would lead to a bimodal distribution of grid rotations: No rotation and co-rotation with the rotated input, as recently observed in experiments where distal cues were rotated but proximal cues stayed fixed (<xref ref-type="bibr" rid="bib78">Savelli et al., 2017</xref>).</p><p>Recently, it was discovered that in an arena separated by a wall, single grid cells form two independent grid patterns – one on each side – that coalesce once the wall is removed (<xref ref-type="bibr" rid="bib96">Wernle et al., 2018</xref>; Rosay et al., in preparation). This coalescence is local, that is, grid fields close to the partition wall readjust, whereas grid fields far away do not change their locations. Feedforward models like ours can explain such a local rearrangement (<xref ref-type="fig" rid="fig4">Figure 4</xref>; Rosay et al., in preparation).</p></sec><sec id="s3-4"><title>Boundary effects</title><p>Experiments show that the pattern and the orientation of grid cells is influenced by the geometry of the environment. In a quadratic arena, the orientation of grid cells tends to align – with a small offset – to one of the box axes (<xref ref-type="bibr" rid="bib84">Stensola et al., 2015</xref>). In trapezoidal arenas, the hexagonality of grids is distorted (<xref ref-type="bibr" rid="bib44">Krupic et al., 2015a</xref>). We considered quadratic and circular arenas with rat trajectories from behavioral experiments and found that the boundaries also distort the grid pattern in our simulations, particularly for localized inputs (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). In trapezoidal geometries, we expect this to lead to non-hexagonal grids. However, we did not observe a pronounced alignment to quadratic boundaries if the input place fields were randomly located (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>).</p></sec><sec id="s3-5"><title>Conclusion</title><p>We found that interacting excitatory and inhibitory plasticity serves as a simple and robust mechanism for rapid self-organization of stable and symmetric patterns from spatially modulated feedforward input. The suggested mechanism ports the robust pattern formation of attractor models from the neural to the spatial domain and increases the speed of self-organization of plasticity-based mechanisms to time scales on which the spatial tuning of neurons is typically measured. It will be interesting to explore how recurrent connections between output cells can help to understand the role of local inhibitory (<xref ref-type="bibr" rid="bib21">Couey et al., 2013</xref>; <xref ref-type="bibr" rid="bib68">Pastoll et al., 2013</xref>) and excitatory connections (<xref ref-type="bibr" rid="bib103">Winterer et al., 2017</xref>) and the presence or absence of topographic arrangements of spatially tuned cells (<xref ref-type="bibr" rid="bib65">O'Keefe et al., 1998</xref>; <xref ref-type="bibr" rid="bib83">Stensola et al., 2012</xref>; <xref ref-type="bibr" rid="bib34">Giocomo et al., 2014</xref>). We illustrated the properties and requirements of the model in the realm of spatial representations. As invariance and selectivity are ubiquitous properties of receptive fields in the brain, the interaction of excitatory and inhibitory synaptic plasticity could also be essential to form stable representations from sensory input in other brain areas (<xref ref-type="bibr" rid="bib20">Constantinescu et al., 2016</xref>; <xref ref-type="bibr" rid="bib19">Clopath et al., 2016</xref>).</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Code availability</title><p>The code for reproducing the essential findings of this article is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/sim-web/spatial_patterns">https://github.com/sim-web/spatial_patterns</ext-link> (<xref ref-type="bibr" rid="bib95">Weber, 2018</xref>) under the GNU General Public License v3.0. A copy is archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/spatial_patterns">https://github.com/elifesciences-publications/spatial_patterns</ext-link>. </p></sec><sec id="s4-2"><title>Network architecture and neuron model</title><p>We study a feedforward network where a single output neuron receives synaptic input from <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula> excitatory and <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> inhibitory neurons (<xref ref-type="fig" rid="fig1">Figure 1a</xref>) with synaptic weight vectors <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>∈</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>∈</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and spatially tuned input rates <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. Here <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes the location and later also the head direction of the animal. For simplicity and to allow a mathematical analysis we use a rate-based description for all neurons. The firing rate of the output neuron is given by the rectified sum of weighted excitatory and inhibitory inputs:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf37"><mml:mrow><mml:mo>[</mml:mo><mml:mo>⋅</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula><sub>+</sub> denotes a rectification that sets negative firing rates to zero. To comply with the notion of excitation and inhibition, all weights are constrained to be positive. In most simulations we use <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Simulation parameters are shown in <xref ref-type="table" rid="table1">Tables 1</xref>–<xref ref-type="table" rid="table3">3</xref> for the main figures and in <xref ref-type="table" rid="table4">Tables 4</xref>–<xref ref-type="table" rid="table6">6</xref> for the supplementary figures.</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.024</object-id><label>Table 1.</label><caption><title>Parameters for excitatory inputs for all figures in the manuscript.</title><p><inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates that the excitatory input is a Gaussian random field.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom"/><th valign="bottom"><inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1b</xref></td><td valign="bottom">0.05</td><td valign="bottom">2000</td><td valign="bottom">2 × 10<sup>−6</sup></td><td valign="bottom">1</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1c</xref></td><td valign="bottom">0.08</td><td valign="bottom">2000</td><td valign="bottom">2 × 10<sup>−6</sup></td><td valign="bottom">1</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1d</xref></td><td valign="bottom">0.06</td><td valign="bottom">2000</td><td valign="bottom">2 × 10<sup>−6</sup></td><td valign="bottom">1</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1f</xref></td><td valign="bottom">0.04</td><td valign="bottom">160</td><td valign="bottom">2 × 10<sup>−6</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1g</xref></td><td valign="bottom">0.03</td><td valign="bottom">1600</td><td valign="bottom">3.6 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1h</xref></td><td valign="bottom">0.03</td><td valign="bottom">10000</td><td valign="bottom">3.5 × 10<sup>−7</sup></td><td valign="bottom">1</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 2a</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">6.7 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 2b</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">2 × 10<sup>−6</sup></td><td valign="bottom">1</td><td valign="bottom">100</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 2c</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">6 × 10<sup>−6</sup></td><td valign="bottom">1</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 3a–d</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">2 × 10<sup>−4</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 4</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">2 × 4900</td><td valign="bottom">1.3 × 10<sup>−4</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5a</xref></td><td valign="bottom">[0.07, 0.07]</td><td valign="bottom">4900</td><td valign="bottom">6 × 10<sup>−6</sup></td><td valign="bottom">0.5</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5b</xref></td><td valign="bottom">[0.07, 0.07]</td><td valign="bottom">400</td><td valign="bottom">1.3 × 10<sup>−4</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5c</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">1.1 × 10<sup>−6</sup></td><td valign="bottom">0.0455</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5d</xref></td><td valign="bottom">[0.08, 0.08]</td><td valign="bottom">4900</td><td valign="bottom">6 × 10<sup>−6</sup></td><td valign="bottom">0.5</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5e</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">6.7 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6a</xref></td><td valign="bottom">[0.07, 0.07, 0.2]</td><td valign="bottom">37500</td><td valign="bottom">1.5 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6b</xref></td><td valign="bottom">[0.08, 0.08, 0.2]</td><td valign="bottom">50000</td><td valign="bottom">10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6c</xref></td><td valign="bottom">[0.1, 0.1, 0.2]</td><td valign="bottom">50000</td><td valign="bottom">10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7a</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">6.7 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7b</xref></td><td valign="bottom">0.04</td><td valign="bottom">2000</td><td valign="bottom">5 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">0.04</td><td valign="bottom">2000</td><td valign="bottom">5 × 10<sup>−7</sup></td><td valign="bottom">1.0</td><td valign="bottom">100</td></tr><tr><td rowspan="2" valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7c</xref></td><td valign="bottom">0.05</td><td valign="bottom">2000</td><td valign="bottom">5 × 10<sup>−6</sup></td><td valign="bottom">0.5</td><td valign="bottom">∞</td></tr><tr><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">2 × 10<sup>−6</sup></td><td valign="bottom">1</td><td valign="bottom">100</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 8b</xref></td><td valign="bottom">0.03</td><td valign="bottom">800</td><td valign="bottom">3.3 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr></tbody></table></table-wrap><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.025</object-id><label>Table 2.</label><caption><title>Parameters for inhibitory inputs for all figures in the manuscript.</title><p>indicates that the inhibitory input is a Gaussian random field. We denote spatially untuned inhibition with: σ<sub>I</sub> = ∞.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom"/><th valign="bottom"><inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1b</xref></td><td valign="bottom">0.12</td><td valign="bottom">500</td><td valign="bottom">2 × 10<sup>−5</sup></td><td valign="bottom">4:4</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1c</xref></td><td valign="bottom">0.07</td><td valign="bottom">2000</td><td valign="bottom">2 × 10<sup>−5</sup></td><td valign="bottom">1.1</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1d</xref></td><td valign="bottom">∞</td><td valign="bottom">500</td><td valign="bottom">2 × 10<sup>−5</sup></td><td valign="bottom">4.39</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1f</xref></td><td valign="bottom">0.13</td><td valign="bottom">40</td><td valign="bottom">2 × 10<sup>−5</sup></td><td valign="bottom">1.31</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1g</xref></td><td valign="bottom">From 0.08 to 0.3 in 0.02 steps</td><td valign="bottom">400</td><td valign="bottom">3.6 × 10<sup>−4</sup></td><td valign="bottom"><xref ref-type="disp-formula" rid="equ112">Equation 111</xref></td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1h</xref></td><td valign="bottom">From 0.08 to 0.3 in 0.02 steps</td><td valign="bottom">2500</td><td valign="bottom">7 × 10<sup>−6</sup></td><td valign="bottom">4.03</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 2a</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 2b</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">8 × 10<sup>−6</sup></td><td valign="bottom">1.52</td><td valign="bottom">100</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 2c</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">6 × 10<sup>−5</sup></td><td valign="bottom">4.0</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 3a–d</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">8 × 10<sup>−4</sup></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 4</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">2 × 1225</td><td valign="bottom">5.3 × 10<sup>−4</sup></td><td valign="bottom">1.51</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5a</xref></td><td valign="bottom">[∞, ∞]</td><td valign="bottom">1225</td><td valign="bottom">6 × 10<sup>−5</sup></td><td valign="bottom">2</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5b</xref></td><td valign="bottom">[∞, ∞]</td><td valign="bottom">1</td><td valign="bottom">5.3 × 10<sup>−4</sup></td><td valign="bottom">69.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5c</xref></td><td valign="bottom">[0.049, 0.049]</td><td valign="bottom">1225</td><td valign="bottom">4.4 × 10<sup>−5</sup></td><td valign="bottom">0.175</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5d</xref></td><td valign="bottom">[0.3, 0.07]</td><td valign="bottom">1225</td><td valign="bottom">6 × 10<sup>−5</sup></td><td valign="bottom">2</td><td valign="bottom">∞</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5e</xref></td><td valign="bottom">[0.049, 0.049]</td><td valign="bottom">4900</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.02</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[0.2, 0.1]; [0.1, 0.2]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.04</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[2, 0.1]; [0.1, 2]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">2.74</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[2, 0.2]; [0.2, 2]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.38</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[0.2, 0.2]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">0.709</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[2, 2]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>*−4</sup></td><td valign="bottom">0.259</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[0.1, 0.049]; [0.049, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">2.48</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">[0.2, 0.049]; [0.049, 0.2]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.74</td><td valign="bottom">1</td></tr><tr><td rowspan="2" valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6a</xref></td><td valign="bottom">[2, 0.049]; [0.049, 2]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">5.56</td><td valign="bottom">1</td></tr><tr><td valign="bottom">[0.15, 0.15, 0.2]</td><td valign="bottom">9375</td><td valign="bottom">1.5 × 10<sup>−4</sup></td><td valign="bottom">1.55</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6b</xref></td><td valign="bottom">[0.12, 0.12, 1.5]</td><td valign="bottom">3125</td><td valign="bottom">10<sup>−4</sup></td><td valign="bottom">5.68</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6c</xref></td><td valign="bottom">[0.09, 0.09, 1.5]</td><td valign="bottom">12500</td><td valign="bottom">10<sup>−4</sup></td><td valign="bottom">2.71</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6d</xref></td><td valign="bottom">Same as</td><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6a,b,c</xref></td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7a</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7b</xref></td><td valign="bottom">0.12</td><td valign="bottom">500</td><td valign="bottom">5 × 10<sup>−4</sup></td><td valign="bottom">1.6</td><td valign="bottom">1</td></tr><tr><td valign="bottom"/><td valign="bottom">0.12</td><td valign="bottom">500</td><td valign="bottom">5 × 10<sup>−6</sup></td><td valign="bottom">1.62</td><td valign="bottom">100</td></tr><tr><td rowspan="2" valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7c</xref></td><td valign="bottom">0.12</td><td valign="bottom">500</td><td valign="bottom">5 × 10<sup>−5</sup></td><td valign="bottom">1.99</td><td valign="bottom">∞</td></tr><tr><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">8 × 10<sup>−6</sup></td><td valign="bottom">1.52</td><td valign="bottom">100</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 8b</xref></td><td valign="bottom">0.1</td><td valign="bottom">varied</td><td valign="bottom">varied</td><td valign="bottom">varied</td><td valign="bottom">1</td></tr></tbody></table></table-wrap><table-wrap id="table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.026</object-id><label>Table 3.</label><caption><title>Simulation time <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and system size <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for all figures in the manuscript.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom"/><th valign="bottom"><inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><italic><inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></italic></th></tr></thead><tbody><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1b</xref></td><td valign="bottom">2,000,000</td><td valign="bottom">2</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1c</xref></td><td valign="bottom">2,000,000</td><td valign="bottom">2</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1d</xref></td><td valign="bottom">400,000</td><td valign="bottom">2</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1f</xref></td><td valign="bottom">20,000,000</td><td valign="bottom">2</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1g</xref></td><td valign="bottom">80,000,000</td><td valign="bottom">14</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 1h</xref></td><td valign="bottom">40,000,000</td><td valign="bottom">10</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 2a,b,c</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 3a,b,c,d</xref></td><td valign="bottom">540,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 4</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5a,c,d,e</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 5b</xref></td><td valign="bottom">180,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 6a,b,c,d</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7a,c</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 7b</xref></td><td valign="bottom">400,000</td><td valign="bottom">2</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1">Figure 8b</xref></td><td valign="bottom">40,000,000</td><td valign="bottom">3</td></tr></tbody></table></table-wrap><table-wrap id="table4" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.027</object-id><label>Table 4.</label><caption><title>Parameters for excitatory inputs in supplement figures.</title><p><inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates that the excitatory input is a Gaussian random field.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom"/><th valign="bottom"><inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td valign="bottom"><xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref></td><td valign="bottom">0.04</td><td valign="bottom">2000</td><td valign="bottom">5 × 10<sup>−7</sup></td><td valign="bottom">1</td><td valign="bottom">varied</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">6.7 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">6.7 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">2 ×10<sup>−4</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">3.3 × 10<sup>−5</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref></td><td valign="bottom">[0.05, 0.05]</td><td valign="bottom">4900</td><td valign="bottom">1.3 ×10<sup>−4</sup></td><td valign="bottom">1</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr></tbody></table></table-wrap><table-wrap id="table5" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.028</object-id><label>Table 5.</label><caption><title>Parameters for inhibitory inputs in supplement figures.</title><p><inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates that the inhibitory input is a Gaussian random field. We denote spatially untuned inhibition with: σ<sub>I</sub> = ∞.</p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom"/><th valign="bottom"><inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td valign="bottom"><xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref></td><td valign="bottom">0.12</td><td valign="bottom">500</td><td valign="bottom">5 × 10<sup>−6</sup></td><td valign="bottom">1.61</td><td valign="bottom">varied</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">2.7 × 10<sup>−4</sup></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">8× 10<sup>-4</sup> <break/></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">5.3 × 10<sup>−6</sup></td><td valign="bottom">0.03</td><td valign="bottom">50</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref></td><td valign="bottom">[0.1, 0.1]</td><td valign="bottom">1225</td><td valign="bottom">5.3×10<sup>-4</sup></td><td valign="bottom">1.5</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td><td valign="bottom"/><td valign="bottom"/><td valign="bottom"/></tr></tbody></table></table-wrap><table-wrap id="table6" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.029</object-id><label>Table 6.</label><caption><title>Simulation time <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and system size <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for supplement figures.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom"/><th valign="bottom"><inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th valign="bottom"><italic><inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></italic></th></tr></thead><tbody><tr><td valign="bottom"><xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref></td><td valign="bottom">48,000,000</td><td valign="bottom">1</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">0.5</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">0.5</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref></td><td valign="bottom">180,000</td><td valign="bottom">0.5</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">0.5</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref></td><td valign="bottom">1,800,000</td><td valign="bottom">0.5</td></tr><tr><td valign="bottom"><xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref></td><td valign="bottom">see</td><td valign="bottom">caption</td></tr></tbody></table></table-wrap></sec><sec id="s4-3"><title>Excitatory and inhibitory plasticity</title><p>In each unit time step (<inline-formula><mml:math id="inf70"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), the excitatory weights are updated according to a Hebbian rule:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1em"/><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The excitatory learning rate <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula> is a constant that we chose individually for each simulation. To avoid unbounded weight growth, we use a quadratic multiplicative normalization, that is, we keep the sum of the squared weights of the excitatory population <inline-formula><mml:math id="inf72"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> constant at its initial value, by rescaling the weights after each unit time step. However, synaptic weight normalization is not a necessary ingredient for the emergence of firing patterns (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). We model inhibitory synaptic plasticity using a previously suggested learning rule (<xref ref-type="bibr" rid="bib93">Vogels et al., 2011</xref>):<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>with inhibitory learning rate <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> and target rate <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 Hz. Negative inhibitory weights are set to zero.</p></sec><sec id="s4-4"><title>Rat trajectory</title><p>In the linear track model (one dimension, <xref ref-type="fig" rid="fig1">Figures 1</xref> and <xref ref-type="fig" rid="fig7">7</xref>), we create artificial run-and-tumble trajectories <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> constrained on a line of length <inline-formula><mml:math id="inf76"><mml:mi>L</mml:mi></mml:math></inline-formula> with constant velocity <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1 cm per unit time step and persistence length <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (Appendix 1).</p><p>In the open arena model (two dimensions, <xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig3">3</xref>, <xref ref-type="fig" rid="fig5">5</xref> and <xref ref-type="fig" rid="fig7">7</xref>), we use trajectories <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> from behavioral data (<xref ref-type="bibr" rid="bib76">Sargolini et al., 2006b</xref>) of a rat that moved in a 1 m × 1 m quadratic enclosure (Appendix 1). In the simulations with a separation wall (<xref ref-type="fig" rid="fig4">Figure 4</xref>), we create trajectories as a two-dimensional persistent random walk (Appendix 1). In the model for neurons with head direction tuning (three dimensions, <xref ref-type="fig" rid="fig6">Figure 6</xref>), we use the same behavioral trajectories as in two dimensions and model the head direction as noisily aligned to the direction of motion (Appendix 1).</p></sec><sec id="s4-5"><title>Spatially tuned inputs</title><p>The firing rates of excitatory and inhibitory synaptic inputs <inline-formula><mml:math id="inf80"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are tuned to the location <inline-formula><mml:math id="inf81"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula> of the animal. In the following, we use <inline-formula><mml:math id="inf82"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf83"><mml:mi>y</mml:mi></mml:math></inline-formula> for the first and second spatial dimension and <inline-formula><mml:math id="inf84"><mml:mi>z</mml:mi></mml:math></inline-formula> for the head direction.</p><p>For place field-like input, we use Gaussian tuning functions with standard deviation <inline-formula><mml:math id="inf85"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf86"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> for the excitatory and inhibitory population, respectively. In <xref ref-type="fig" rid="fig5">Figure 5</xref> the standard deviation is chosen independently along the <inline-formula><mml:math id="inf87"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf88"><mml:mi>y</mml:mi></mml:math></inline-formula> direction. The centers of the Gaussians are drawn randomly from a distorted lattice (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). This way we ensure random but spatially dense tuning. The lattice contains locations outside the box to reduce boundary effects.</p><p>For sparse non-localized input with <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> fields per neuron of population <inline-formula><mml:math id="inf90"><mml:mi mathvariant="normal">P</mml:mi></mml:math></inline-formula>, we first create <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> distorted lattices, each with <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> locations. We then assign <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> of the resulting <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> locations at random and without replacement to each input neuron (see also Appendix 1).</p><p>For dense non-localized input, we convolve Gaussians with white noise and increase the resulting signal to noise ratio by setting the minimum to zero and the mean to 0.5 (Appendix 1). The Gaussian convolution kernels have different standard deviations for different populations. For each input neuron we use a different realization of white noise. This results in arbitrary tuning functions of the same autocorrelation length as the – potentially asymmetric – Gaussian convolution kernel. For grid cell-like input, we place Gaussians of standard deviation <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula> on the nodes of perfect hexagonal grids whose spacing and orientation is variable. In <xref ref-type="fig" rid="fig5">Figure 5</xref>b we draw the grid spacing of each input from a normal distribution of mean <inline-formula><mml:math id="inf96"><mml:mrow><mml:mn>6</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>. The grid orientation was drawn from a uniform distribution between <inline-formula><mml:math id="inf98"><mml:mrow><mml:mo>-</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf99"><mml:mn>30</mml:mn></mml:math></inline-formula> degrees.</p><p>For input with combined spatial and head direction tuning, we use the Gaussian tuning curves described above for the spatial tuning and von Mises distributions along the head direction dimension (Appendix 1).</p><p>For all input tunings, the standard deviation of the firing rate is of the same order of magnitude as the mean firing rate (Appendix 1).</p></sec><sec id="s4-6"><title>Initial synaptic weights and global reduction of inhibition</title><p>We specify a mean for the initial excitatory and inhibitory weights, respectively, and randomly draw each synaptic weight from the corresponding mean <inline-formula><mml:math id="inf100"><mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The excitatory mean is chosen such that the output neuron would fire above the target rate everywhere in the absence of inhibition; we typically take this mean to be 1 (<xref ref-type="table" rid="table1">Table 1</xref> and Appendix 1). The mean inhibitory weight is then determined such that the output neuron would fire close to the target rate, if all the weights were at their mean value (<xref ref-type="table" rid="table2">Table 2</xref> and Appendix 1). Choosing the weights this way ensures that initial firing rates are random, but neither zero everywhere, nor inappropriately high. We model a global reduction of inhibition by scaling all inhibitory weights by a constant factor, after the grid has been learned.</p></sec><sec id="s4-7"><title>Mathematical analysis of the learning rules</title><p>In the following, we derive the spacing of periodic firing patterns as a function of the simulation parameters for the linear track.</p><p>We first show that homogeneous weights, chosen such that the output neuron fires at the target rate, are a fixed point for the time evolution of excitatory and inhibitory weights under the assumption of slow learning. We then perturb this fixed point and study the time evolution of the perturbations in Fourier space. The translational invariance of the input overlap leads to decoupling of spatial frequencies and leaves a two-dimensional dynamical system for each spatial frequency. For smoother spatial tuning of inhibitory input than excitatory input, the eigenvalue spectrum of the dynamical system has a unique maximum, which indicates the most unstable spatial frequency. This frequency accurately predicts the grid spacing. We first consider place cell-like input (Gaussians) and then non-localized input (Gaussians convolved with white noise).</p><p>At the end of the analysis, you will find a glossary of the notation. Whenever we use P as a sub- or superscript instead of E or I, this implies that the equation holds for neurons of the excitatory and the inhibitory population.</p><p>The analysis is written as a detailed and comprehensible walk-through. The reader who is interested only in the result can jump to <xref ref-type="disp-formula" rid="equ78 equ104">Equations 78 and 104</xref>.</p><sec id="s4-7-1"><title>Assumption of slow learning</title><p>The firing rate of the output neuron is the weighted sum of excitatory and inhibitory input rates:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>…</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> indicates that negative firing rates are set to zero.</p><p>Written as a differential equation, the excitatory learning rule with quadratic multiplicative normalization is given by:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the <inline-formula><mml:math id="inf103"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> identity matrix. The projection operator <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> ensures that the weights are constrained to remain on the hypersphere whose radius is determined by the initial value of the sum of the squares of all excitatory weights (<xref ref-type="bibr" rid="bib58">Miller and MacKay, 1994</xref>). The inhibitory learning rule is given by:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐰</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mi>out</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We assume that the rat will learn slowly, such that it forages through the environment before significant learning (i.e. weight change) occurs. Therefore we can coarsen the time scale and rewrite <xref ref-type="disp-formula" rid="equ5 equ6">Equation 5 and 6</xref> as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mn mathvariant="double-struck">𝟙</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>and<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>respectively, where the spatial average, <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mo>…</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, is defined as<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>…</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mo>…</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula>and <inline-formula><mml:math id="inf106"><mml:mi>L</mml:mi></mml:math></inline-formula> is the length of the linear track.</p></sec><sec id="s4-7-2"><title>High density assumption and continuum limit for place cell-like input</title><p>We assume a high density of input neurons and formulate the system in continuous variables. More precisely, we assume the distance between two neighboring firing fields to be much smaller than the width of the firing fields, that is, <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo>≪</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Furthermore, we assume that the linear track is very long compared with the width of the firing fields, that is, <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>We replace the neuron index with the continuous variable <inline-formula><mml:math id="inf109"><mml:mi>μ</mml:mi></mml:math></inline-formula> and denote the weight <inline-formula><mml:math id="inf110"><mml:msubsup><mml:mi>w</mml:mi><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup></mml:math></inline-formula> and the tuning function <inline-formula><mml:math id="inf111"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> associated with a place field that is centered at <inline-formula><mml:math id="inf112"><mml:mi>μ</mml:mi></mml:math></inline-formula> in the continuum limit as:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The distance between two neighboring place fields is given by <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, for sums over all neurons we get the following integral in the continuum limit:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mi>L</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>μ</mml:mi></mml:mpadded></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We will switch between the discrete and continuous formulations, using whatever is more convenient.</p><p>For place cell-like input we take Gaussian tuning curves:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo rspace="4.2pt">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with height <inline-formula><mml:math id="inf114"><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula>. Thus, in the continuum limit we get:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Because of the translational invariance of <inline-formula><mml:math id="inf116"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, integration over space gives the same result as integration over all center locations and the mean of all inputs is the same:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>μ</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mi>L</mml:mi></mml:mfrac><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula>where we introduced <inline-formula><mml:math id="inf117"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>:=</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula> for the area under the tuning curves. Accordingly, we get a summarized input activity that is independent of location:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">→</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>μ</mml:mi><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-7-3"><title>Equal weights form a fixed point</title><p>In the following, we will show that equal weights <inline-formula><mml:math id="inf118"><mml:mrow><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf119"><mml:mrow><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf120"><mml:mrow><mml:mrow><mml:mo>∀</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> form a fixed point if <inline-formula><mml:math id="inf121"><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:math></inline-formula> is chosen such that the output neuron fires at the target rate, <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, throughout the arena. With equal weights we get a constant firing rate <inline-formula><mml:math id="inf123"><mml:msubsup><mml:mi>r</mml:mi><mml:mn>0</mml:mn><mml:mi>out</mml:mi></mml:msubsup></mml:math></inline-formula>,<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mi>out</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mn>0</mml:mn><mml:mi>out</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which according to <xref ref-type="disp-formula" rid="equ17">Equation 17</xref> does not depend on <inline-formula><mml:math id="inf124"><mml:mi>x</mml:mi></mml:math></inline-formula>. Furthermore, according to <xref ref-type="disp-formula" rid="equ14">Equation 14</xref>, <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> does not depend on the neuron index <inline-formula><mml:math id="inf126"><mml:mi>i</mml:mi></mml:math></inline-formula>. Now the stationarity of the excitatory weight evolution follows from <xref ref-type="disp-formula" rid="equ7">Equation 7</xref>:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>that is, excitatory weights are stationary for all values of <inline-formula><mml:math id="inf127"><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf128"><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:math></inline-formula> (here <inline-formula><mml:math id="inf129"><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the Kronecker delta which is 1 if <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> and 0 otherwise). This holds for all input functions for which <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is independent of <inline-formula><mml:math id="inf132"><mml:mi>j</mml:mi></mml:math></inline-formula>. If <inline-formula><mml:math id="inf133"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mi>out</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, it immediately follows from <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> that <inline-formula><mml:math id="inf134"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, so the inhibitory weights are stationary if<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>which is fulfilled if<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-7-4"><title>Linear stability analysis</title><p>In the following, we will show that the fixed point of equal weights, the <italic>homogeneous steady state</italic>, is unstable when the spatial tuning of inhibitory inputs is broader than that of the excitatory inputs. In this case, perturbations of the fixed point will grow and one particular spatial frequency will grow fastest. We will show that this spatial frequency predicts the spacing of the resulting periodic pattern (<xref ref-type="fig" rid="fig1">Figure 1g</xref>).</p><p>We perturb the fixed point<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/></mml:mrow></mml:mstyle></mml:math></disp-formula>and look at the time evolution of the perturbations <inline-formula><mml:math id="inf135"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> of the excitatory and inhibitory weights around the fixed point.</p><p>Close to the fixed point the output neuron fires around the target rate <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. We thus ignore the rectification in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>, that is, <inline-formula><mml:math id="inf138"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mi>out</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mi>out</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf139"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mi>out</mml:mi></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>k</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-7-5"><title>Time evolution of perturbations of the inhibitory weights</title><p>We start with the time evolution of the inhibitory weight perturbations:<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where only the rates <inline-formula><mml:math id="inf140"><mml:msup><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msup></mml:math></inline-formula> depend on <inline-formula><mml:math id="inf141"><mml:mi>x</mml:mi></mml:math></inline-formula>. Intuitively, the first term in <xref ref-type="disp-formula" rid="equ29">Equation 29</xref> means that the rate of change of the inhibitory weight perturbation of the weight associated with one location depends on the excitatory perturbations of the weights associated with every other location, weighted with the overlap (the cross correlation) of the two associated tuning functions (analogous for inhibitory weight perturbations). In the continuum limit, the sums are:<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ31"><label>(31)</label><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where we introduce overlap kernels<disp-formula id="equ32"><label>(32)</label><mml:math id="m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The overlap <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>depends only on the distance of the Gaussian fields, that is,<disp-formula id="equ33"><label>(33)</label><mml:math id="m33"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:msup><mml:mi>PP</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:msup><mml:mi>PP</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Taking <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, the time evolution of the perturbations of the inhibitory weights can thus be written as convolutions:<disp-formula id="equ34"><label>(34)</label><mml:math id="m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>∗</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>∗</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf144"><mml:mo>*</mml:mo></mml:math></inline-formula> denotes a convolution.</p></sec><sec id="s4-7-6"><title>Time evolution of perturbations of the excitatory weights</title><p>To derive the time evolution of the excitatory weights, we first show that the weight normalization term in <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> , expressed through the projection operator <inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub></mml:mstyle><mml:msubsup><mml:mi>w</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, leads to a term that balances homogeneous weight perturbations and a term that can be neglected in the continuum limit.</p><p>Let <inline-formula><mml:math id="inf146"><mml:mi>P</mml:mi></mml:math></inline-formula> be the projection operator responsible for the normalization of the excitatory weights by projecting a weight update onto a vector that is orthogonal to the hypersphere of constant <inline-formula><mml:math id="inf147"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. We now determine the projection operator around the fixed point (We drop the index ‘E’ in the following, to improve readability):<disp-formula id="equ35"><label>(35)</label><mml:math id="m35"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐰</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐰</mml:mi></mml:mrow></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using Taylor’s theorem<disp-formula id="equ36"><label>(36)</label><mml:math id="m36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>δ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, we get<disp-formula id="equ37"><label>(37)</label><mml:math id="m37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ38"><label>(38)</label><mml:math id="m38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">w</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In summary this gives:<disp-formula id="equ39"><label>(39)</label><mml:math id="m39"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:munder accentunder="true"><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac><mml:mo movablelimits="false">⏟</mml:mo></mml:munder><mml:mrow><mml:mrow><mml:mi/><mml:mo>≡</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>⁣</mml:mo><mml:mrow><mml:mi/><mml:mo>∝</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒪</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo movablelimits="false">⁢</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo movablelimits="false">⁢</mml:mo><mml:mrow><mml:mo movablelimits="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo movablelimits="false">⁢</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:mrow><mml:mo movablelimits="false">+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo movablelimits="false">⁢</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo movablelimits="false">-</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo movablelimits="false">⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo movablelimits="false">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mi>δ</mml:mi><mml:mo movablelimits="false">⁢</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>l</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo movablelimits="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo movablelimits="false">⏟</mml:mo></mml:munder><mml:mrow><mml:mrow><mml:mi/><mml:mo>≡</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>⁣</mml:mo><mml:mrow><mml:mi/><mml:mo>∝</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒪</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="bold">𝐰</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒪</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐰</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using the perturbed projection operator <xref ref-type="disp-formula" rid="equ39">Equation 39</xref> with <xref ref-type="disp-formula" rid="equ7">Equation 7,</xref> we obtain the time evolution of the excitatory weight perturbation to linear order:<disp-formula id="equ40"><label>(40)</label><mml:math id="m40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ41"><label>(41)</label><mml:math id="m41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ42"><label>(42)</label><mml:math id="m42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ43"><label>(43)</label><mml:math id="m43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mrow><mml:munder><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">q</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mn>19</mml:mn></mml:mrow></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ44"><label>(44)</label><mml:math id="m44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒪</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Term <inline-formula><mml:math id="inf149"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ44">Equation 44</xref> has a similar structure as in the inhibitory case (<xref ref-type="disp-formula" rid="equ27">Equation 27</xref>), and will lead to analogous convolutions. he second term is given by<disp-formula id="equ45"><label>(45)</label><mml:math id="m45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ46"><label>(46)</label><mml:math id="m46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:mi>L</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ47"><label>(47)</label><mml:math id="m47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ48"><label>(48)</label><mml:math id="m48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ49"><label>(49)</label><mml:math id="m49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>cont. limit</mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/></mml:mrow></mml:mstyle></mml:math></disp-formula>and the third term by<disp-formula id="equ50"><label>(50)</label><mml:math id="m50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ51"><label>(51)</label><mml:math id="m51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ52"><label>(52)</label><mml:math id="m52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ53"><label>(53)</label><mml:math id="m53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ54"><label>(54)</label><mml:math id="m54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ55"><label>(55)</label><mml:math id="m55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>cont. limit</mml:mtext><mml:mo stretchy="false">→</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ56"><label>(56)</label><mml:math id="m56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>L</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the Dirac delta function. Together, this leads to the time evolution of the excitatory weight perturbations:<disp-formula id="equ57"><label>(57)</label><mml:math id="m57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">[</mml:mo></mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ58"><label>(58)</label><mml:math id="m58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mspace width="2em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ59"><label>(59)</label><mml:math id="m59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We now assume <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>≫</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and write everything as convolutions, also trivial ones:<disp-formula id="equ60"><label>(60)</label><mml:math id="m60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∗</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>∗</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-7-7"><title>Decoupling of spatial frequencies</title><p>The convolutions in <xref ref-type="disp-formula" rid="equ34 equ60">Equations 34 and 60</xref> show how the excitatory and inhibitory weight perturbations at one location influence the time evolution of weights at every other location. Transforming the system to frequency space leads to a drastic simplification: The time evolution of a perturbation of a particular spatial frequency depends only on the excitatory and inhibitory perturbation of the same spatial frequency, that is, the Fourier components decouple. We define the Fourier transform <inline-formula><mml:math id="inf152"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with wavevector <inline-formula><mml:math id="inf153"><mml:mi>k</mml:mi></mml:math></inline-formula> of a function <inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of location <inline-formula><mml:math id="inf155"><mml:mi>μ</mml:mi></mml:math></inline-formula> as:<disp-formula id="equ61"><label>(61)</label><mml:math id="m61"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>and note that<disp-formula id="equ62"><label>(62)</label><mml:math id="m62"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Using the Convolution theorem and the linearity of the Fourier transform we get<disp-formula id="equ63"><label>(63)</label><mml:math id="m63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mi>L</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>and<disp-formula id="equ64"><label>(64)</label><mml:math id="m64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> term in <xref ref-type="disp-formula" rid="equ63">Equation 63</xref> balances homogeneous perturbations in such a way that the output neuron would still fire at the target rate, if not for permutations at other frequencies. In the following, we drop this term, because we are not interested in spatially homogeneous perturbations. Moreover, the continuum limit is valid only for high densities: <inline-formula><mml:math id="inf157"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>. We can thus drop terms of lower order than <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, which eliminates the <inline-formula><mml:math id="inf159"><mml:mfrac><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> term. Writing the remaining terms of <xref ref-type="disp-formula" rid="equ63 equ64">Equations 63 and 64</xref> as a matrix leads to:<disp-formula id="equ65"><label>(65)</label><mml:math id="m65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>which no longer contains terms from the weight normalization. The characteristic polynomial of the above matrix is:<disp-formula id="equ66"><mml:math id="m66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The difference, <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, vanishes for Gaussian input, because:<disp-formula id="equ67"><label>(67)</label><mml:math id="m67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ68"><label>(68)</label><mml:math id="m68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>x</mml:mi><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ69"><label>(69)</label><mml:math id="m69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow></mml:msub><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mrow></mml:mfrac></mml:msqrt><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where we completed the square and used <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mi>π</mml:mi><mml:mi>a</mml:mi></mml:mfrac></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula>. Taking the Fourier transform and completing the square again gives<disp-formula id="equ70"><label>(70)</label><mml:math id="m70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and thus <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>For <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ70">Equation 70</xref> simplifies to:<disp-formula id="equ71"><label>(71)</label><mml:math id="m71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This leads to the eigenvalues:<disp-formula id="equ72"><label>(72)</label><mml:math id="m72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ73"><label>(73)</label><mml:math id="m73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ74"><label>(74)</label><mml:math id="m74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>which are shown in <xref ref-type="fig" rid="fig8">Figure 8a</xref>. Perturbations with spatial frequencies for which <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is positive will grow. Setting <inline-formula><mml:math id="inf165"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> gives the wavevector <inline-formula><mml:math id="inf166"><mml:msub><mml:mi>k</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> of the Fourier component that grows fastest:</p><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.34560.030</object-id><label>Figure 8.</label><caption><title>Results of the mathematical analysis.</title><p>(<bold>a</bold>) The eigenvalue spectrum for the eigenvalues of <xref ref-type="disp-formula" rid="equ72">Equation 72</xref> for an excitatory tuning of width <inline-formula><mml:math id="inf167"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math></inline-formula>. The first eigenvalue <inline-formula><mml:math id="inf168"><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is always 0. If the inhibitory tuning is more narrow than the excitatory tuning, that is, <inline-formula><mml:math id="inf169"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the second eigenvalue <inline-formula><mml:math id="inf170"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is negative for every wavevector <inline-formula><mml:math id="inf171"><mml:mi>k</mml:mi></mml:math></inline-formula>. For <inline-formula><mml:math id="inf172"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the eigenvalue spectrum has a unique positive maximum <inline-formula><mml:math id="inf173"><mml:msub><mml:mi>k</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula>, that is, a most unstable spatial frequency. The wavevector <inline-formula><mml:math id="inf174"><mml:msub><mml:mi>k</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> at which <inline-formula><mml:math id="inf175"><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is maximal is obtained from <xref ref-type="disp-formula" rid="equ78">Equation 78</xref> and marked with a dashed line. (<bold>b</bold>) The dependence of the grid spacing on learning rate <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula>, number of input neurons <inline-formula><mml:math id="inf177"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> and input height <inline-formula><mml:math id="inf178"><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> is accurately predicted by the theory. The gray line shows the grid spacing obtained from <xref ref-type="disp-formula" rid="equ78">Equation 78</xref>. We vary the inhibitory learning rate, <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> (circles), the number of inhibitory input neurons, <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> (squares), or the square of the height of the inhibitory input place fields, <inline-formula><mml:math id="inf181"><mml:msubsup><mml:mi>α</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> (diamonds). The horizontal axis shows the ratio of the product <inline-formula><mml:math id="inf182"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> to the initial value of the product <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. We keep <inline-formula><mml:math id="inf184"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf185"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>800</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf186"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in each simulation and the <inline-formula><mml:math id="inf187"><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> parameters are: <inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf189"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf190"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>c</bold>) Distribution of minimal values of GRF input. Histograms show the distribution of the minimal values of 1000 Gaussian random fields for a small linear track, <inline-formula><mml:math id="inf191"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, and a large linear track <inline-formula><mml:math id="inf192"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>. Red and blue colors correspond to the tuning of excitatory and inhibitory input neurons, respectively. Each dotted line indicates the mean of the histogram of the same color. For larger systems, the distribution of the minimum values gets more narrow and the relative distance between the minima of excitatory and inhibitory neurons decreases.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34560-fig8-v2"/></fig><p><disp-formula id="equ75"><label>(75)</label><mml:math id="m75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ76"><label>(76)</label><mml:math id="m76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">⇒</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ77"><label>(77)</label><mml:math id="m77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">⇒</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:msqrt><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Assuming that the fastest-growing spatial frequency from the linearized system will prevail, the final spacing of the periodic pattern, <inline-formula><mml:math id="inf193"><mml:mi mathvariant="normal">ℓ</mml:mi></mml:math></inline-formula>, is determined by:<disp-formula id="equ78"><label>(78)</label><mml:math id="m78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:msqrt><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:msqrt></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ78">Equation 78</xref> is in exact agreement with the grid spacing obtained in simulations (<xref ref-type="fig" rid="fig1">Figure 1</xref>g). Moreover, it indicates the bifurcation point: When excitation is as smooth as inhibition (<inline-formula><mml:math id="inf194"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), there is no unstable spatial frequency anymore and every perturbation gets balanced (<xref ref-type="fig" rid="fig1">Figure 1</xref>g compare <xref ref-type="disp-formula" rid="equ103">Equation 103</xref>). The grid spacing also depends on the ratio of the inhibitory and excitatory parameters <inline-formula><mml:math id="inf195"><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (logarithmic term in <xref ref-type="disp-formula" rid="equ78">Equation 78</xref>). We confirm this dependence with simulations on the linear track where we increase either <inline-formula><mml:math id="inf196"><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf197"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf198"><mml:msubsup><mml:mi>α</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> such that the product <inline-formula><mml:math id="inf199"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> increases with respect to the initial product <inline-formula><mml:math id="inf200"><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. We find a good agreement with the theoretical prediction for all three variations (<xref ref-type="fig" rid="fig8">Figure 8b</xref>).</p><p>Note that the term <inline-formula><mml:math id="inf201"><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in the logarithm in <xref ref-type="disp-formula" rid="equ78">Equation 78</xref> is essentially a factor that determines the rate of weight change of population <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mspace width="negativethinmathspace"/><mml:mo>:</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is just the scaling factor; <inline-formula><mml:math id="inf203"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> is the mass under a tuning function (with quadratic influence: once directly through the firing rate of the input, once through the increased firing rate of the output neuron); <inline-formula><mml:math id="inf204"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> is the number of tuning functions. The remaining <inline-formula><mml:math id="inf205"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> originates specifically from the Gaussian shape of the tuning functions.</p></sec><sec id="s4-7-8"><title>Analysis for non-localized input (Gaussian random fields)</title><p>Above, we derived the time evolution of perturbations of excitatory and inhibitory weights for place field-like input, that is, Gaussian tuning curves. In the following we conduct a similar analysis, using non-localized input, that is, random functions with a given spatial autocorrelation length. We show that the grid spacing is predicted by an equation that is equivalent to <xref ref-type="disp-formula" rid="equ78">Equation 78</xref>.</p><p>The non-localized input <inline-formula><mml:math id="inf206"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup></mml:math></inline-formula> for input neuron <inline-formula><mml:math id="inf207"><mml:mi>i</mml:mi></mml:math></inline-formula> of population <inline-formula><mml:math id="inf208"><mml:mi mathvariant="normal">P</mml:mi></mml:math></inline-formula> was obtained by rescaling a Gaussian random field (GRF) <inline-formula><mml:math id="inf209"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup></mml:math></inline-formula> to mean <inline-formula><mml:math id="inf210"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and minimum 0:<disp-formula id="equ79"><label>(79)</label><mml:math id="m79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>x</mml:mi></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf211"><mml:msub><mml:mi>min</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> denotes the minimum over all locations and the GRF <inline-formula><mml:math id="inf212"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup></mml:math></inline-formula> is obtained by convolving a Gaussian <inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> with white noise <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> from a uniform distribution between <inline-formula><mml:math id="inf215"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf216"><mml:mn>0.5</mml:mn></mml:math></inline-formula>:<disp-formula id="equ80"><label>(80)</label><mml:math id="m80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As the white noise has zero mean, the spatial average of a GRF is also 0 in expectation:<disp-formula id="equ81"><label>(81)</label><mml:math id="m81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ82"><label>(82)</label><mml:math id="m82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∝</mml:mo><mml:mo>∫</mml:mo><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The individual minima <inline-formula><mml:math id="inf217"><mml:mrow><mml:mrow><mml:msub><mml:mi>min</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ79">Equation 79</xref> would complicate the subsequent analysis. If we again consider infinitely large systems <inline-formula><mml:math id="inf218"><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula> with infinite density <inline-formula><mml:math id="inf219"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ79">Equation 79</xref> simplifies. The mean of the distribution of GRF minima over different input neurons scales logarithmically with the number of samples (<xref ref-type="bibr" rid="bib6">Bovier, 2005</xref>). Here the number of samples corresponds to the number of minima in a GRF, which scales inversely with the width of the convolution kernel that was used to obtain the GRF:<disp-formula id="equ83"><label>(83)</label><mml:math id="m83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mo>∝</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the continuum limit the variance of the minima distribution over cells decreases and the relative difference between the mean minimum value of excitation and inhibition vanishes (<xref ref-type="fig" rid="fig8">Figure 8c</xref>):<disp-formula id="equ84"><label>(84)</label><mml:math id="m84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">→</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>NB: For the argument it doesn’t matter if it scales purely logarithmically or with <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>log</mml:mi><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is any exponent.</p><p>Thus, we take the minimum value as a constant <italic>m</italic>, which does neither depend on the population nor on the input neuron. This leads to a simplified expression of the input tuning functions:<disp-formula id="equ85"><label>(85)</label><mml:math id="m85"><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>As <inline-formula><mml:math id="inf222"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup><mml:mo>⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> is independent of <inline-formula><mml:math id="inf223"><mml:mi>i</mml:mi></mml:math></inline-formula>, equal excitatory weights are a fixed point for the excitatory learning rule <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> as described in <xref ref-type="disp-formula" rid="equ19">Equation 19</xref>. Moreover, the sum over all input neurons does not depend on the location:<disp-formula id="equ86"><label>(86)</label><mml:math id="m86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Therefore, given constant excitatory weights, all inhibitory weights can be set to a value <inline-formula><mml:math id="inf224"><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:math></inline-formula> such that the output neuron fires at the target rate, that is, homogeneous weights are a fixed point of the learning rules, as in the scenario with Gaussian input. Moreover, <xref ref-type="disp-formula" rid="equ29">Equation 29</xref> holds also for GRF input. The analysis of the projection operator (see above) of the weight normalization lead to a term of homogeneous weight perturbations and a term that could be neglected in the high density limit. We now omit these terms a priori. The time evolution of excitatory and inhibitory weight perturbations can thus be summarized as (compare <xref ref-type="disp-formula" rid="equ29 equ44">Equations 29 and 44</xref>):<disp-formula id="equ87"><label>(87)</label><mml:math id="m87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The above equation describes the time evolution of each synaptic weight. For the Gaussian input of the earlier sections, each synaptic weight is associated with one location. In the continuum limit we thus identified the synaptic weight associated with location <inline-formula><mml:math id="inf225"><mml:mi>μ</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf226"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. An increase of <inline-formula><mml:math id="inf227"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> corresponded to an increase in firing at location <inline-formula><mml:math id="inf228"><mml:mi>μ</mml:mi></mml:math></inline-formula> (and in the surrounding, given by the width of the Gaussian of the excitatory tuning). Analogously, an increase of <inline-formula><mml:math id="inf229"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> caused a decrease in firing at location <inline-formula><mml:math id="inf230"><mml:mi>μ</mml:mi></mml:math></inline-formula> (and in the surrounding, given by the width of the Gaussian of the inhibitory tuning). Because of the non-localized tuning of GRF input, each synaptic weight has an influence on the firing rate at many locations. The influence of neuron <inline-formula><mml:math id="inf231"><mml:mi>i</mml:mi></mml:math></inline-formula> of population <inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> at location <inline-formula><mml:math id="inf233"><mml:mi>μ</mml:mi></mml:math></inline-formula> is expressed by <inline-formula><mml:math id="inf234"><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. If one wanted to increase the firing rate at a specific location <inline-formula><mml:math id="inf235"><mml:mi>μ</mml:mi></mml:math></inline-formula> – and not just everywhere – one would thus increase all excitatory weights with high <inline-formula><mml:math id="inf236"><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and decrease all excitatory weights with low <inline-formula><mml:math id="inf237"><mml:mrow><mml:msubsup><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (note that <inline-formula><mml:math id="inf238"><mml:msup><mml:mi>ξ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msup></mml:math></inline-formula> can also be negative). The ‘weight’ that corresponds to location <inline-formula><mml:math id="inf239"><mml:mi>μ</mml:mi></mml:math></inline-formula> is thus expressed as:<disp-formula id="equ88"><label>(88)</label><mml:math id="m88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where we weight each synaptic weight with the value of the corresponding white noise at location <inline-formula><mml:math id="inf240"><mml:mi>μ</mml:mi></mml:math></inline-formula>. This corresponds to expressing the weights in a basis that is associated with the location and not with the individual input neurons. Combining <xref ref-type="disp-formula" rid="equ88">Equation 88</xref> and <xref ref-type="disp-formula" rid="equ87">Equation 87</xref> gives the time evolution of the weight perturbations associated with location <inline-formula><mml:math id="inf241"><mml:mi>μ</mml:mi></mml:math></inline-formula>:<disp-formula id="equ89"><label>(89)</label><mml:math id="m89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ90"><label>(90)</label><mml:math id="m90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We now look at the first term of the above equation, the second term will be treated analogously:<disp-formula id="equ91"><label>(91)</label><mml:math id="m91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The sum containing the white noise can be simplified using the zero mean property and the expression for the variance of uniform white noise:<disp-formula id="equ92"><label>(92)</label><mml:math id="m92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ93"><label>(93)</label><mml:math id="m93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ94"><label>(94)</label><mml:math id="m94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf242"><mml:mi>β</mml:mi></mml:math></inline-formula> is a proportionality constant that does not depend on the population type <inline-formula><mml:math id="inf243"><mml:mi mathvariant="normal">P</mml:mi></mml:math></inline-formula>. The Dirac delta <inline-formula><mml:math id="inf244"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> occurs, because the white noise at different locations is uncorrelated. The sum of the product of weight perturbations and input rates can be rewritten as:<disp-formula id="equ95"><label>(95)</label><mml:math id="m95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mo>=:</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">q</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mn>88</mml:mn></mml:mrow></mml:mrow></mml:munder><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The first term is independent of location <inline-formula><mml:math id="inf245"><mml:mi>x</mml:mi></mml:math></inline-formula> and thus will lead only to spatially homogeneous perturbations, which we do not consider in the following. Inserting <xref ref-type="disp-formula" rid="equ94 equ95">Equations 94 and 95</xref> and the analogous terms for inhibition in Equation 91 leads to:<disp-formula id="equ96"><label>(96)</label><mml:math id="m96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:msubsup><mml:mi>ξ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ97"><label>(97)</label><mml:math id="m97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ98"><label>(98)</label><mml:math id="m98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>∗</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where we introduce kernels for the translation invariant overlap between two Gaussians with different centers (similar to <xref ref-type="disp-formula" rid="equ32">Equation 32</xref>):<disp-formula id="equ99"><label>(99)</label><mml:math id="m99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mi>η</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mi>η</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ89">Equation 89</xref> can thus be written as:<disp-formula id="equ100"><label>(100)</label><mml:math id="m100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup><mml:mo>∗</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msup><mml:mo>∗</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>which leads to a dynamical system for the Fourier components of the weight perturbations that is equivalent to <xref ref-type="disp-formula" rid="equ65">Equation 65</xref> with eigenvalues:<disp-formula id="equ101"><label>(101)</label><mml:math id="m101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ102"><label>(102)</label><mml:math id="m102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>K</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ103"><label>(103)</label><mml:math id="m103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, we get the same expression for the grid spacing as in the scenario of Gaussian input (with <inline-formula><mml:math id="inf246"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = <inline-formula><mml:math id="inf247"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1):<disp-formula id="equ104"><label>(104)</label><mml:math id="m104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:msqrt></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></sec><sec id="s4-8"><title>Glossary</title><p>A summary of notation:<disp-formula id="equ105"><mml:math id="m105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:msup><mml:mi mathvariant="normal">t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>z</mml:mi></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">E</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">I</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:mi mathvariant="normal">P</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">P</mml:mi><mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:mi>L</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mtd><mml:mtd><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></sec></body><back><sec id="s6" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Validation, Methodology, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.34560.031</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-34560-transrepform-v2.pdf"/></supplementary-material><sec id="s15" sec-type="datasets"><title>Major datasets</title><p>The following previously published dataset was used:</p><p><related-object content-type="generated-dataset" id="dataset1" source-id="http://www.ntnu.edu/kavli/research/grid-cell-data" source-id-type="uri"><collab collab-type="author">Sargolini F</collab><collab collab-type="author">Fyhn M</collab><collab collab-type="author">Hafting T</collab><collab collab-type="author">McNaughton BL</collab><collab collab-type="author">Witter MP</collab><collab collab-type="author">Moser M</collab><collab collab-type="author">Moser EI</collab><year>2006</year><source>Grid cell - raw data</source><ext-link ext-link-type="uri" xlink:href="http://www.ntnu.edu/kavli/research/grid-cell-data">http://www.ntnu.edu/kavli/research/grid-cell-data</ext-link><comment>Publicly available at the Kavli Institute for Systems Neuroscience</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arleo</surname> <given-names>A</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Spatial cognition and neuro-mimetic navigation: a model of hippocampal place cell activity</article-title><source>Biological Cybernetics</source><volume>83</volume><fpage>287</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1007/s004220000171</pub-id><pub-id pub-id-type="pmid">11007302</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Ginzberg</surname> <given-names>LL</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Grid cell firing patterns signal environmental novelty by expansion</article-title><source>PNAS</source><volume>109</volume><fpage>17687</fpage><lpage>17692</lpage><pub-id pub-id-type="doi">10.1073/pnas.1209918109</pub-id><pub-id pub-id-type="pmid">23045662</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battaglia</surname> <given-names>FP</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Attractor neural networks storing multiple space representations: A model for hippocampal place fields</article-title><source>Physical Review E</source><volume>58</volume><fpage>7738</fpage><lpage>7753</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.58.7738</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beed</surname> <given-names>P</given-names></name><name><surname>Gundlfinger</surname> <given-names>A</given-names></name><name><surname>Schneiderbauer</surname> <given-names>S</given-names></name><name><surname>Song</surname> <given-names>J</given-names></name><name><surname>Böhm</surname> <given-names>C</given-names></name><name><surname>Burgalossi</surname> <given-names>A</given-names></name><name><surname>Brecht</surname> <given-names>M</given-names></name><name><surname>Vida</surname> <given-names>I</given-names></name><name><surname>Schmitz</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inhibitory gradient along the dorsoventral axis in the medial entorhinal cortex</article-title><source>Neuron</source><volume>79</volume><fpage>1197</fpage><lpage>1207</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.06.038</pub-id><pub-id pub-id-type="pmid">24050405</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Grid cells require excitatory drive from the hippocampus</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>309</fpage><lpage>317</lpage><pub-id pub-id-type="doi">10.1038/nn.3311</pub-id><pub-id pub-id-type="pmid">23334581</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Bovier</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Extreme Values of Random Processes: Lecture Notes</article-title><ext-link ext-link-type="uri" xlink:href="https://wt.iam.uni-bonn.de/fileadmin/WT/Inhalt/people/Anton_Bovier/lecture-notes/extreme.pdf">https://wt.iam.uni-bonn.de/fileadmin/WT/Inhalt/people/Anton_Bovier/lecture-notes/extreme.pdf</ext-link><date-in-citation iso-8601-date="2017-02-08">February 8, 2017</date-in-citation></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brun</surname> <given-names>VH</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Wu</surname> <given-names>HQ</given-names></name><name><surname>Schwarcz</surname> <given-names>R</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008a</year><article-title>Impaired spatial representation in CA1 after lesion of direct input from entorhinal cortex</article-title><source>Neuron</source><volume>57</volume><fpage>290</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2007.11.034</pub-id><pub-id pub-id-type="pmid">18215625</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brun</surname> <given-names>VH</given-names></name><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Kjelstrup</surname> <given-names>KB</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008b</year><article-title>Progressive increase in grid scale from dorsal to ventral medial entorhinal cortex</article-title><source>Hippocampus</source><volume>18</volume><fpage>1200</fpage><lpage>1212</lpage><pub-id pub-id-type="doi">10.1002/hipo.20504</pub-id><pub-id pub-id-type="pmid">19021257</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buetfering</surname> <given-names>C</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>Monyer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Parvalbumin interneurons provide grid cell-driven recurrent inhibition in the medial entorhinal cortex</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>710</fpage><lpage>718</lpage><pub-id pub-id-type="doi">10.1038/nn.3696</pub-id><pub-id pub-id-type="pmid">24705183</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Accurate path integration in continuous attractor network models of grid cells</article-title><source>PLoS Computational Biology</source><volume>5</volume><elocation-id>e1000291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id><pub-id pub-id-type="pmid">19229307</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>An oscillatory interference model of grid cell firing</article-title><source>Hippocampus</source><volume>17</volume><fpage>801</fpage><lpage>812</lpage><pub-id pub-id-type="doi">10.1002/hipo.20327</pub-id><pub-id pub-id-type="pmid">17598147</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Lever</surname> <given-names>C</given-names></name><name><surname>O'keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Characterizing multiple independent behavioral correlates of cell firing in freely moving animals</article-title><source>Hippocampus</source><volume>15</volume><fpage>149</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1002/hipo.20058</pub-id><pub-id pub-id-type="pmid">15558542</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Models of place and grid cell firing and theta rhythmicity</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>734</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.07.002</pub-id><pub-id pub-id-type="pmid">21820895</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname> <given-names>D</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A hybrid oscillatory interference/continuous attractor network model of grid cell firing</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>5065</fpage><lpage>5079</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4017-13.2014</pub-id><pub-id pub-id-type="pmid">24695724</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castro</surname> <given-names>L</given-names></name><name><surname>Aguiar</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A feedforward model for the formation of a grid field where spatial information is provided solely from place cells</article-title><source>Biological Cybernetics</source><volume>108</volume><fpage>133</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1007/s00422-013-0581-3</pub-id><pub-id pub-id-type="pmid">24577877</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Manson</surname> <given-names>D</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Wills</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Absence of visual input results in the disruption of grid cell firing in the mouse</article-title><source>Current Biology</source><volume>26</volume><fpage>2335</fpage><lpage>2342</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2016.06.043</pub-id><pub-id pub-id-type="pmid">27498565</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>LL</given-names></name><name><surname>Lin</surname> <given-names>LH</given-names></name><name><surname>Barnes</surname> <given-names>CA</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Head-direction cells in the rat posterior cortex. II. Contributions of visual and ideothetic information to the directional firing</article-title><source>Experimental Brain Research</source><volume>101</volume><fpage>24</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1007/BF00243213</pub-id><pub-id pub-id-type="pmid">7843299</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cilz</surname> <given-names>NI</given-names></name><name><surname>Kurada</surname> <given-names>L</given-names></name><name><surname>Hu</surname> <given-names>B</given-names></name><name><surname>Lei</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dopaminergic modulation of GABAergic transmission in the entorhinal cortex: concerted roles of α1 adrenoreceptors, inward rectifier K⁺, and T-type Ca²⁺ channels</article-title><source>Cerebral Cortex</source><volume>24</volume><fpage>3195</fpage><lpage>3208</lpage><pub-id pub-id-type="doi">10.1093/cercor/bht177</pub-id><pub-id pub-id-type="pmid">23843440</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Vogels</surname> <given-names>TP</given-names></name><name><surname>Froemke</surname> <given-names>RC</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Receptive field formation by interacting excitatory and inhibitory synaptic plasticity</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/066589</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Constantinescu</surname> <given-names>AO</given-names></name><name><surname>O'Reilly</surname> <given-names>JX</given-names></name><name><surname>Behrens</surname> <given-names>TEJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Organizing conceptual knowledge in humans with a gridlike code</article-title><source>Science</source><volume>352</volume><fpage>1464</fpage><lpage>1468</lpage><pub-id pub-id-type="doi">10.1126/science.aaf0941</pub-id><pub-id pub-id-type="pmid">27313047</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couey</surname> <given-names>JJ</given-names></name><name><surname>Witoelar</surname> <given-names>A</given-names></name><name><surname>Zhang</surname> <given-names>SJ</given-names></name><name><surname>Zheng</surname> <given-names>K</given-names></name><name><surname>Ye</surname> <given-names>J</given-names></name><name><surname>Dunn</surname> <given-names>B</given-names></name><name><surname>Czajkowski</surname> <given-names>R</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Recurrent inhibitory circuitry as a mechanism for grid formation</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>318</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1038/nn.3310</pub-id><pub-id pub-id-type="pmid">23334580</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Albis</surname> <given-names>T</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A single-cell spiking model for the origin of grid-cell patterns</article-title><source>PLoS Computational Biology</source><volume>13</volume><elocation-id>e1005782</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005782</pub-id><pub-id pub-id-type="pmid">28968386</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Amour</surname> <given-names>JA</given-names></name><name><surname>Froemke</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Inhibitory and excitatory spike-timing-dependent plasticity in the auditory cortex</article-title><source>Neuron</source><volume>86</volume><fpage>514</fpage><lpage>528</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.014</pub-id><pub-id pub-id-type="pmid">25843405</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DiCarlo</surname> <given-names>JJ</given-names></name><name><surname>Cox</surname> <given-names>DD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Untangling invariant object recognition</article-title><source>Trends in Cognitive Sciences</source><volume>11</volume><fpage>333</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2007.06.010</pub-id><pub-id pub-id-type="pmid">17631409</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diehl</surname> <given-names>GW</given-names></name><name><surname>Hon</surname> <given-names>OJ</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Grid and nongrid cells in medial entorhinal cortex represent spatial location and environmental features with complementary coding schemes</article-title><source>Neuron</source><volume>94</volume><fpage>83</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.03.004</pub-id><pub-id pub-id-type="pmid">28343867</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dordek</surname> <given-names>Y</given-names></name><name><surname>Soudry</surname> <given-names>D</given-names></name><name><surname>Meir</surname> <given-names>R</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Extracting grid cell characteristics from place cell inputs using non-negative principal component analysis</article-title><source>eLife</source><volume>5</volume><elocation-id>e10094</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10094</pub-id><pub-id pub-id-type="pmid">26952211</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname> <given-names>LM</given-names></name><name><surname>Brown</surname> <given-names>EN</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A comparison of the firing properties of putative excitatory and inhibitory neurons from CA1 and the entorhinal cortex</article-title><source>Journal of Neurophysiology</source><volume>86</volume><fpage>2029</fpage><lpage>2040</lpage><pub-id pub-id-type="doi">10.1152/jn.2001.86.4.2029</pub-id><pub-id pub-id-type="pmid">11600659</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franzius</surname> <given-names>M</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name><name><surname>Wiskott</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2007">2007a</year><article-title>Slowness and sparseness lead to place, head-direction, and spatial-view cells</article-title><source>PLoS Computational Biology</source><volume>3</volume><elocation-id>e166</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0030166</pub-id><pub-id pub-id-type="pmid">17784780</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franzius</surname> <given-names>M</given-names></name><name><surname>Vollgraf</surname> <given-names>R</given-names></name><name><surname>Wiskott</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2007">2007b</year><article-title>From grids to places</article-title><source>Journal of Computational Neuroscience</source><volume>22</volume><fpage>297</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1007/s10827-006-0013-7</pub-id><pub-id pub-id-type="pmid">17195112</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuhs</surname> <given-names>MC</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>4266</fpage><lpage>4276</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4353-05.2006</pub-id><pub-id pub-id-type="pmid">16624947</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal remapping and grid realignment in entorhinal cortex</article-title><source>Nature</source><volume>446</volume><fpage>190</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1038/nature05601</pub-id><pub-id pub-id-type="pmid">17322902</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Spatial representation in the entorhinal cortex</article-title><source>Science</source><volume>305</volume><fpage>1258</fpage><lpage>1264</lpage><pub-id pub-id-type="doi">10.1126/science.1099901</pub-id><pub-id pub-id-type="pmid">15333832</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giocomo</surname> <given-names>LM</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Computational models of grid cells</article-title><source>Neuron</source><volume>71</volume><fpage>589</fpage><lpage>603</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.07.023</pub-id><pub-id pub-id-type="pmid">21867877</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giocomo</surname> <given-names>LM</given-names></name><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Van Cauter</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Topography of head direction cells in medial entorhinal cortex</article-title><source>Current Biology</source><volume>24</volume><fpage>252</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.12.002</pub-id><pub-id pub-id-type="pmid">24440398</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grienberger</surname> <given-names>C</given-names></name><name><surname>Milstein</surname> <given-names>AD</given-names></name><name><surname>Bittner</surname> <given-names>KC</given-names></name><name><surname>Romani</surname> <given-names>S</given-names></name><name><surname>Magee</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inhibitory suppression of heterogeneously tuned excitation enhances spatial coding in CA1 place cells</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>417</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1038/nn.4486</pub-id><pub-id pub-id-type="pmid">28114296</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hippocampus-independent phase precession in entorhinal grid cells</article-title><source>Nature</source><volume>453</volume><fpage>1248</fpage><lpage>1252</lpage><pub-id pub-id-type="doi">10.1038/nature06957</pub-id><pub-id pub-id-type="pmid">18480753</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Microstructure of a spatial map in the entorhinal cortex</article-title><source>Nature</source><volume>436</volume><fpage>801</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1038/nature03721</pub-id><pub-id pub-id-type="pmid">15965463</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hangya</surname> <given-names>B</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Czurkó</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Complementary spatial firing in place cell-interneuron pairs</article-title><source>The Journal of Physiology</source><volume>588</volume><fpage>4165</fpage><lpage>4175</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2010.194274</pub-id><pub-id pub-id-type="pmid">20819942</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Maheswaranathan</surname> <given-names>N</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A multiplexed, heterogeneous, and adaptive code for navigation in medial entorhinal cortex</article-title><source>Neuron</source><volume>94</volume><fpage>375</fpage><lpage>387</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.03.025</pub-id><pub-id pub-id-type="pmid">28392071</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hebb</surname> <given-names>DO</given-names></name></person-group><year iso-8601-date="1949">1949</year><source>The Organization of Behavior: A Neuropsychological Approach</source><publisher-name>John Wiley &amp; Sons</publisher-name></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jung</surname> <given-names>MW</given-names></name><name><surname>Wiener</surname> <given-names>SI</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Comparison of spatial firing characteristics of units in dorsal and ventral hippocampus of the rat</article-title><source>Journal of Neuroscience</source><volume>14</volume><fpage>7347</fpage><lpage>7356</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.14-12-07347.1994</pub-id><pub-id pub-id-type="pmid">7996180</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Carmichael</surname> <given-names>JE</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Speed cells in the medial entorhinal cortex</article-title><source>Nature</source><volume>523</volume><fpage>419</fpage><lpage>424</lpage><pub-id pub-id-type="doi">10.1038/nature14622</pub-id><pub-id pub-id-type="pmid">26176924</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The emergence of grid cells: Intelligent design or just adaptation?</article-title><source>Hippocampus</source><volume>18</volume><fpage>1256</fpage><lpage>1269</lpage><pub-id pub-id-type="doi">10.1002/hipo.20520</pub-id><pub-id pub-id-type="pmid">19021261</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krupic</surname> <given-names>J</given-names></name><name><surname>Bauza</surname> <given-names>M</given-names></name><name><surname>Burton</surname> <given-names>S</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015a</year><article-title>Grid cell symmetry is shaped by environmental geometry</article-title><source>Nature</source><volume>518</volume><fpage>232</fpage><lpage>235</lpage><pub-id pub-id-type="doi">10.1038/nature14153</pub-id><pub-id pub-id-type="pmid">25673417</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Krupic</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>O’Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015b</year><source>Spatially Periodic Cells Are Neither Formed From Grids Nor Poor Isolation</source></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krupic</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural representations of location composed of spatially periodic bands</article-title><source>Science</source><volume>337</volume><fpage>853</fpage><lpage>857</lpage><pub-id pub-id-type="doi">10.1126/science.1222403</pub-id><pub-id pub-id-type="pmid">22904012</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langston</surname> <given-names>RF</given-names></name><name><surname>Ainge</surname> <given-names>JA</given-names></name><name><surname>Couey</surname> <given-names>JJ</given-names></name><name><surname>Canto</surname> <given-names>CB</given-names></name><name><surname>Bjerknes</surname> <given-names>TL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Development of the spatial representation system in the rat</article-title><source>Science</source><volume>328</volume><fpage>1576</fpage><lpage>1580</lpage><pub-id pub-id-type="doi">10.1126/science.1188210</pub-id><pub-id pub-id-type="pmid">20558721</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Memory of sequential experience in the hippocampus during slow wave sleep</article-title><source>Neuron</source><volume>36</volume><fpage>1183</fpage><lpage>1194</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)01096-6</pub-id><pub-id pub-id-type="pmid">12495631</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leutgeb</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Barnes</surname> <given-names>CA</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Independent codes for spatial and episodic memory in hippocampal neuronal ensembles</article-title><source>Science</source><volume>309</volume><fpage>619</fpage><lpage>623</lpage><pub-id pub-id-type="doi">10.1126/science.1114037</pub-id><pub-id pub-id-type="pmid">16040709</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marshall</surname> <given-names>L</given-names></name><name><surname>Henze</surname> <given-names>DA</given-names></name><name><surname>Hirase</surname> <given-names>H</given-names></name><name><surname>Leinekugel</surname> <given-names>X</given-names></name><name><surname>Dragoi</surname> <given-names>G</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Hippocampal pyramidal cell-interneuron spike transmission is frequency dependent and responsible for place modulation of interneuron discharge</article-title><source>Journal of Neuroscience</source><volume>22</volume><elocation-id>RC197</elocation-id><pub-id pub-id-type="pmid">11784809</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martig</surname> <given-names>AK</given-names></name><name><surname>Mizumori</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Ventral tegmental area disruption selectively affects CA1/CA2 but not CA3 place fields during a differential reward working memory task</article-title><source>Hippocampus</source><volume>21</volume><fpage>172</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1002/hipo.20734</pub-id><pub-id pub-id-type="pmid">20082295</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Battaglia</surname> <given-names>FP</given-names></name><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Path integration and the neural basis of the 'cognitive map'</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>663</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1038/nrn1932</pub-id><pub-id pub-id-type="pmid">16858394</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Chen</surname> <given-names>LL</given-names></name><name><surname>Markus</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>&quot;Dead reckoning,&quot; landmark learning, and the sense of direction: a neurophysiological and computational hypothesis</article-title><source>Journal of Cognitive Neuroscience</source><volume>3</volume><fpage>190</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1162/jocn.1991.3.2.190</pub-id><pub-id pub-id-type="pmid">23972093</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname> <given-names>MR</given-names></name><name><surname>Quirk</surname> <given-names>MC</given-names></name><name><surname>Wilson</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Experience-dependent asymmetric shape of hippocampal receptive fields</article-title><source>Neuron</source><volume>25</volume><fpage>707</fpage><lpage>715</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)81072-7</pub-id><pub-id pub-id-type="pmid">10774737</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Melzer</surname> <given-names>S</given-names></name><name><surname>Michael</surname> <given-names>M</given-names></name><name><surname>Caputi</surname> <given-names>A</given-names></name><name><surname>Eliava</surname> <given-names>M</given-names></name><name><surname>Fuchs</surname> <given-names>EC</given-names></name><name><surname>Whittington</surname> <given-names>MA</given-names></name><name><surname>Monyer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Long-range-projecting GABAergic neurons modulate inhibition in hippocampus and entorhinal cortex</article-title><source>Science</source><volume>335</volume><fpage>1506</fpage><lpage>1510</lpage><pub-id pub-id-type="doi">10.1126/science.1217139</pub-id><pub-id pub-id-type="pmid">22442486</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Mégevand</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>watsons_u2</data-title><source>GitHub</source><version designator="09f649a">09f649a</version><ext-link ext-link-type="uri" xlink:href="https://github.com/pierremegevand/watsons_u2">https://github.com/pierremegevand/watsons_u2</ext-link></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miao</surname> <given-names>C</given-names></name><name><surname>Cao</surname> <given-names>Q</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Parvalbumin and somatostatin interneurons control different space-coding networks in the medial entorhinal cortex</article-title><source>Cell</source><volume>171</volume><fpage>507</fpage><lpage>521</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.08.050</pub-id><pub-id pub-id-type="pmid">28965758</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>MacKay</surname> <given-names>DJC</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The role of constraints in hebbian learning</article-title><source>Neural Computation</source><volume>6</volume><fpage>100</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1162/neco.1994.6.1.100</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molter</surname> <given-names>C</given-names></name><name><surname>Yamaguchi</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Entorhinal theta phase precession sculpts dentate gyrus place fields</article-title><source>Hippocampus</source><volume>18</volume><fpage>919</fpage><lpage>930</lpage><pub-id pub-id-type="doi">10.1002/hipo.20450</pub-id><pub-id pub-id-type="pmid">18528856</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monsalve-Mercado</surname> <given-names>MM</given-names></name><name><surname>Leibold</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Hippocampal spike-timing correlations lead to hexagonal grid fields</article-title><source>Physical Review Letters</source><volume>119</volume><elocation-id>038101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.119.038101</pub-id><pub-id pub-id-type="pmid">28777606</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Place cells, grid cells, and the brain's spatial representation system</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><elocation-id>69</elocation-id><lpage>89</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.31.061307.090723</pub-id><pub-id pub-id-type="pmid">18284371</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muessig</surname> <given-names>L</given-names></name><name><surname>Hauser</surname> <given-names>J</given-names></name><name><surname>Wills</surname> <given-names>TJ</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A developmental switch in place cell accuracy coincides with grid cell maturation</article-title><source>Neuron</source><volume>86</volume><fpage>1167</fpage><lpage>1173</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.05.011</pub-id><pub-id pub-id-type="pmid">26050036</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Bostock</surname> <given-names>E</given-names></name><name><surname>Taube</surname> <given-names>JS</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>On the directional firing properties of hippocampal place cells</article-title><source>Journal of Neuroscience</source><volume>14</volume><fpage>7235</fpage><lpage>7251</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.14-12-07235.1994</pub-id><pub-id pub-id-type="pmid">7996172</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Navratilova</surname> <given-names>Z</given-names></name><name><surname>Godfrey</surname> <given-names>KB</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Grids from bands, or bands from grids? An examination of the effects of single unit contamination on grid cell firing fields</article-title><source>Journal of Neurophysiology</source><volume>115</volume><fpage>992</fpage><lpage>1002</lpage><pub-id pub-id-type="doi">10.1152/jn.00699.2015</pub-id><pub-id pub-id-type="pmid">26683071</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Donnett</surname> <given-names>JG</given-names></name><name><surname>Jeffery</surname> <given-names>KJ</given-names></name><name><surname>Maguire</surname> <given-names>EA</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Place cells, navigational accuracy, and the human hippocampus</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>353</volume><fpage>1333</fpage><lpage>1340</lpage><pub-id pub-id-type="doi">10.1098/rstb.1998.0287</pub-id><pub-id pub-id-type="pmid">9770226</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Dostrovsky</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The hippocampus as a spatial map. Preliminary evidence from unit activity in the freely-moving rat</article-title><source>Brain Research</source><volume>34</volume><fpage>171</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(71)90358-1</pub-id><pub-id pub-id-type="pmid">5124915</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>Place units in the hippocampus of the freely moving rat</article-title><source>Experimental Neurology</source><volume>51</volume><fpage>78</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1016/0014-4886(76)90055-8</pub-id><pub-id pub-id-type="pmid">1261644</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastoll</surname> <given-names>H</given-names></name><name><surname>Solanka</surname> <given-names>L</given-names></name><name><surname>van Rossum</surname> <given-names>MC</given-names></name><name><surname>Nolan</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Feedback inhibition enables θ-nested γ oscillations and grid firing fields</article-title><source>Neuron</source><volume>77</volume><fpage>141</fpage><lpage>154</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.11.032</pub-id><pub-id pub-id-type="pmid">23312522</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez-Escobar</surname> <given-names>JA</given-names></name><name><surname>Kornienko</surname> <given-names>O</given-names></name><name><surname>Latuske</surname> <given-names>P</given-names></name><name><surname>Kohler</surname> <given-names>L</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Visual landmarks sharpen grid cell metric and confer context specificity to neurons of the medial entorhinal cortex</article-title><source>eLife</source><volume>5</volume><elocation-id>e16937</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.16937</pub-id><pub-id pub-id-type="pmid">27449281</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quiroga</surname> <given-names>RQ</given-names></name><name><surname>Reddy</surname> <given-names>L</given-names></name><name><surname>Kreiman</surname> <given-names>G</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Fried</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Invariant visual representation by single neurons in the human brain</article-title><source>Nature</source><volume>435</volume><fpage>1102</fpage><lpage>1107</lpage><pub-id pub-id-type="doi">10.1038/nature03687</pub-id><pub-id pub-id-type="pmid">15973409</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redish</surname> <given-names>AD</given-names></name><name><surname>Elga</surname> <given-names>AN</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A coupled attractor model of the rodent head direction system</article-title><source>Network: Computation in Neural Systems</source><volume>7</volume><fpage>671</fpage><lpage>685</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_7_4_004</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rolls</surname> <given-names>ET</given-names></name><name><surname>Stringer</surname> <given-names>SM</given-names></name><name><surname>Elliot</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Entorhinal cortex grid cells can map to hippocampal place cells by competitive learning</article-title><source>Network: Computation in Neural Systems</source><volume>17</volume><fpage>447</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1080/09548980601064846</pub-id><pub-id pub-id-type="pmid">17162463</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rowland</surname> <given-names>DC</given-names></name><name><surname>Weible</surname> <given-names>AP</given-names></name><name><surname>Wickersham</surname> <given-names>IR</given-names></name><name><surname>Wu</surname> <given-names>H</given-names></name><name><surname>Mayford</surname> <given-names>M</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Kentros</surname> <given-names>CG</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Transgenically targeted rabies virus demonstrates a major monosynaptic projection from hippocampal area CA2 to medial entorhinal layer II neurons</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>14889</fpage><lpage>14898</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1046-13.2013</pub-id><pub-id pub-id-type="pmid">24027288</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname> <given-names>A</given-names></name><name><surname>Yartsev</surname> <given-names>MM</given-names></name><name><surname>Ulanovsky</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Encoding of head direction by hippocampal place cells in bats</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>1067</fpage><lpage>1080</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5393-12.2014</pub-id><pub-id pub-id-type="pmid">24431464</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sargolini</surname> <given-names>F</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2006">2006a</year><article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title><source>Science</source><volume>312</volume><fpage>758</fpage><lpage>762</lpage><pub-id pub-id-type="doi">10.1126/science.1125572</pub-id><pub-id pub-id-type="pmid">16675704</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Sargolini</surname> <given-names>F</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>M</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2006">2006b</year><data-title>Grid cell– raw data</data-title><ext-link ext-link-type="uri" xlink:href="http://www.ntnu.edu/kavli/research/grid-cell-data">http://www.ntnu.edu/kavli/research/grid-cell-data</ext-link></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savelli</surname> <given-names>F</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Hebbian analysis of the transformation of medial entorhinal grid-cell inputs to hippocampal place fields</article-title><source>Journal of Neurophysiology</source><volume>103</volume><fpage>3167</fpage><lpage>3183</lpage><pub-id pub-id-type="doi">10.1152/jn.00932.2009</pub-id><pub-id pub-id-type="pmid">20357069</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savelli</surname> <given-names>F</given-names></name><name><surname>Luck</surname> <given-names>JD</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Framing of grid cells within and beyond navigation boundaries</article-title><source>eLife</source><volume>6</volume><elocation-id>e21354</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.21354</pub-id><pub-id pub-id-type="pmid">28084992</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savelli</surname> <given-names>F</given-names></name><name><surname>Yoganarasimha</surname> <given-names>D</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Influence of boundary removal on the spatial representations of the medial entorhinal cortex</article-title><source>Hippocampus</source><volume>18</volume><fpage>1270</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1002/hipo.20511</pub-id><pub-id pub-id-type="pmid">19021262</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt-Hieber</surname> <given-names>C</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cellular mechanisms of spatial navigation in the medial entorhinal cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>325</fpage><lpage>331</lpage><pub-id pub-id-type="doi">10.1038/nn.3340</pub-id><pub-id pub-id-type="pmid">23396102</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Si</surname> <given-names>B</given-names></name><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Grid alignment in entorhinal cortex</article-title><source>Biological Cybernetics</source><volume>106</volume><fpage>483</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1007/s00422-012-0513-7</pub-id><pub-id pub-id-type="pmid">22892761</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Einevoll</surname> <given-names>GT</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>From grid cells to place cells: a mathematical model</article-title><source>Hippocampus</source><volume>16</volume><fpage>1026</fpage><lpage>1031</lpage><pub-id pub-id-type="doi">10.1002/hipo.20244</pub-id><pub-id pub-id-type="pmid">17094145</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname> <given-names>H</given-names></name><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Frøland</surname> <given-names>K</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The entorhinal grid map is discretized</article-title><source>Nature</source><volume>492</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/nature11649</pub-id><pub-id pub-id-type="pmid">23222610</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Stensola</surname> <given-names>H</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Shearing-induced asymmetry in entorhinal grid cells</article-title><source>Nature</source><volume>518</volume><fpage>207</fpage><lpage>212</lpage><pub-id pub-id-type="doi">10.1038/nature14151</pub-id><pub-id pub-id-type="pmid">25673414</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stepanyuk</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Self-organization of grid fields under supervision of place cells in a neuron model with associative plasticity</article-title><source>Biologically Inspired Cognitive Architectures</source><volume>13</volume><fpage>48</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1016/j.bica.2015.06.006</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanaka</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Inferotemporal cortex and object vision</article-title><source>Annual Review of Neuroscience</source><volume>19</volume><fpage>109</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1146/annurev.ne.19.030196.000545</pub-id><pub-id pub-id-type="pmid">8833438</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname> <given-names>JS</given-names></name><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Ranck</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Head-direction cells recorded from the postsubiculum in freely moving rats. II. Effects of environmental manipulations</article-title><source>Journal of Neuroscience</source><volume>10</volume><fpage>436</fpage><lpage>447</lpage><pub-id pub-id-type="pmid">2303852</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Head direction cells recorded in the anterior thalamic nuclei of freely moving rats</article-title><source>Journal of Neuroscience</source><volume>15</volume><fpage>70</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.15-01-00070.1995</pub-id><pub-id pub-id-type="pmid">7823153</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname> <given-names>M</given-names></name><name><surname>Sejnowski</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Associative memory and hippocampal place cells</article-title><source>International Journal of Neural Systems</source><volume>6</volume><fpage>81</fpage><lpage>86</lpage></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turing</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="1952">1952</year><article-title>The chemical basis of morphogenesis</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>237</volume><fpage>37</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1098/rstb.1952.0012</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ujfalussy</surname> <given-names>B</given-names></name><name><surname>Kiss</surname> <given-names>T</given-names></name><name><surname>Erdi</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Parallel computational subunits in dentate granule cells generate multiple place fields</article-title><source>PLoS Computational Biology</source><volume>5</volume><elocation-id>e1000500</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000500</pub-id><pub-id pub-id-type="pmid">19750211</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Strien</surname> <given-names>NM</given-names></name><name><surname>Cappaert</surname> <given-names>NL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The anatomy of memory: an interactive overview of the parahippocampal-hippocampal network</article-title><source>Nature Reviews Neuroscience</source><volume>10</volume><fpage>272</fpage><lpage>282</lpage><pub-id pub-id-type="doi">10.1038/nrn2614</pub-id><pub-id pub-id-type="pmid">19300446</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogels</surname> <given-names>TP</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name><name><surname>Zenke</surname> <given-names>F</given-names></name><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inhibitory plasticity balances excitation and inhibition in sensory pathways and memory networks</article-title><source>Science</source><volume>334</volume><fpage>1569</fpage><lpage>1573</lpage><pub-id pub-id-type="doi">10.1126/science.1211095</pub-id><pub-id pub-id-type="pmid">22075724</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Romani</surname> <given-names>S</given-names></name><name><surname>Lustig</surname> <given-names>B</given-names></name><name><surname>Leonardo</surname> <given-names>A</given-names></name><name><surname>Pastalkova</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Theta sequences are essential for internally generated hippocampal firing fields</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>282</fpage><lpage>288</lpage><pub-id pub-id-type="doi">10.1038/nn.3904</pub-id><pub-id pub-id-type="pmid">25531571</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>SN</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title><italic>Spatial_patterns</italic></data-title><source>GitHub</source><version designator="2583a22">2583a22</version><ext-link ext-link-type="uri" xlink:href="https://github.com/sim-web/spatial_patterns">https://github.com/sim-web/spatial_patterns</ext-link></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wernle</surname> <given-names>T</given-names></name><name><surname>Waaga</surname> <given-names>T</given-names></name><name><surname>Mørreaunet</surname> <given-names>M</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integration of grid maps in merged environments</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>92</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0036-6</pub-id><pub-id pub-id-type="pmid">29230051</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wertz</surname> <given-names>A</given-names></name><name><surname>Trenholm</surname> <given-names>S</given-names></name><name><surname>Yonehara</surname> <given-names>K</given-names></name><name><surname>Hillier</surname> <given-names>D</given-names></name><name><surname>Raics</surname> <given-names>Z</given-names></name><name><surname>Leinweber</surname> <given-names>M</given-names></name><name><surname>Szalay</surname> <given-names>G</given-names></name><name><surname>Ghanem</surname> <given-names>A</given-names></name><name><surname>Keller</surname> <given-names>G</given-names></name><name><surname>Rózsa</surname> <given-names>B</given-names></name><name><surname>Conzelmann</surname> <given-names>KK</given-names></name><name><surname>Roska</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Single-cell-initiated monosynaptic tracing reveals layer-specific cortical network modules</article-title><source>Science</source><volume>349</volume><fpage>70</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1126/science.aab1687</pub-id><pub-id pub-id-type="pmid">26138975</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Widloski</surname> <given-names>J</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A model of grid cell development through spatial exploration and spike time-dependent plasticity</article-title><source>Neuron</source><volume>83</volume><fpage>481</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.06.018</pub-id><pub-id pub-id-type="pmid">25033187</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Widloski</surname> <given-names>J</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cortical microcircuit determination through global perturbation and sparse sampling in grid cells</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/019224</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilent</surname> <given-names>WB</given-names></name><name><surname>Nitz</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Discrete place fields of hippocampal formation interneurons</article-title><source>Journal of Neurophysiology</source><volume>97</volume><fpage>4152</fpage><lpage>4161</lpage><pub-id pub-id-type="doi">10.1152/jn.01200.2006</pub-id><pub-id pub-id-type="pmid">17392415</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wills</surname> <given-names>TJ</given-names></name><name><surname>Cacucci</surname> <given-names>F</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Development of the hippocampal cognitive map in preweanling rats</article-title><source>Science</source><volume>328</volume><fpage>1573</fpage><lpage>1576</lpage><pub-id pub-id-type="doi">10.1126/science.1188224</pub-id><pub-id pub-id-type="pmid">20558720</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DE</given-names></name><name><surname>Whitney</surname> <given-names>DE</given-names></name><name><surname>Scholl</surname> <given-names>B</given-names></name><name><surname>Fitzpatrick</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Orientation selectivity and the functional clustering of synaptic inputs in primary visual cortex</article-title><source>Nature Neuroscience</source><volume>19</volume><elocation-id>1003</elocation-id><lpage>1009</lpage><pub-id pub-id-type="doi">10.1038/nn.4323</pub-id><pub-id pub-id-type="pmid">27294510</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winterer</surname> <given-names>J</given-names></name><name><surname>Maier</surname> <given-names>N</given-names></name><name><surname>Wozny</surname> <given-names>C</given-names></name><name><surname>Beed</surname> <given-names>P</given-names></name><name><surname>Breustedt</surname> <given-names>J</given-names></name><name><surname>Evangelista</surname> <given-names>R</given-names></name><name><surname>Peng</surname> <given-names>Y</given-names></name><name><surname>D'Albis</surname> <given-names>T</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name><name><surname>Schmitz</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Excitatory microcircuits within superficial layers of the medial entorhinal cortex</article-title><source>Cell Reports</source><volume>19</volume><fpage>1110</fpage><lpage>1116</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2017.04.041</pub-id><pub-id pub-id-type="pmid">28494861</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname> <given-names>K</given-names></name><name><surname>Buice</surname> <given-names>MA</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1077</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1038/nn.3450</pub-id><pub-id pub-id-type="pmid">23852111</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname> <given-names>K</given-names></name><name><surname>Lewallen</surname> <given-names>S</given-names></name><name><surname>Kinkhabwala</surname> <given-names>AA</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Grid cell responses in 1D environments assessed as slices through a 2D lattice</article-title><source>Neuron</source><volume>89</volume><fpage>1086</fpage><lpage>1099</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.01.039</pub-id><pub-id pub-id-type="pmid">26898777</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-06-02112.1996</pub-id><pub-id pub-id-type="pmid">8604055</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zilli</surname> <given-names>EA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Models of grid cell spatial firing published 2005-2011</article-title><source>Frontiers in Neural Circuits</source><volume>6</volume><elocation-id>16</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2012.00016</pub-id><pub-id pub-id-type="pmid">22529780</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s7" sec-type="appendix"><title>Rat trajectory</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.34560.032</object-id><p>In the linear track model (one dimension, <xref ref-type="fig" rid="fig1">Figure 1</xref>), we create artificial trajectories <inline-formula><mml:math id="inf248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. The rat moves along a line of length <italic>L</italic> with constant velocity <italic>v</italic> = 1 cm per unit time step Δ<italic>t</italic> = 1. The rat always inverts its direction of motion when it hits either end of the enclosure at <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Additionally, in each unit time step it inverts its direction with a probability of <inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mi>υ</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, resulting in a typical persistence length of <italic>L</italic>∕2.</p><p>In the open arena model (two dimensions, <xref ref-type="fig" rid="fig1">Figures 2</xref>, <xref ref-type="fig" rid="fig3">3</xref> and <xref ref-type="fig" rid="fig5">5</xref>), we take trajectories <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> from behavioral data (<xref ref-type="bibr" rid="bib76">Sargolini et al., 2006b</xref>) of a rat that moved in a 1 m × 1 m quadratic enclosure. The data provide coherent trajectories in intervals of 10 min. To get a 10-hr trajectory, we concatenate 60 individual trajectories. Different trajectories in our simulations correspond to different random orders of concatenation. A 10-min trajectory contains 30,000 locations. We update the location in every unit time step. A time step thus corresponds to 20 ms. For simulations with a separation wall (<xref ref-type="fig" rid="fig4">Figure 4</xref>), we use a persistent random walk to constrain the motion of the rat to either side of the arena (see below).</p><p>In the model for neurons with head direction tuning (three dimensions, <xref ref-type="fig" rid="fig6">Figure 6</xref>), we use the same behavioral trajectories as in two dimensions. To account for the experimental observation that the head direction of the animal is only roughly aligned with the direction of motion, we model the head direction as the direction of motion plus a random angle that is drawn in each unit time step from a normal distribution with standard deviation <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>In all dimensions and for the learning rates under consideration, we find that the precise trajectory of the rat has only a small influence on the results (see also <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p></boxed-text></sec><sec id="s8" sec-type="appendix"><title>Spatial tuning of input neurons</title><boxed-text><p>The firing rates of excitatory and inhibitory synaptic inputs <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> are tuned to the location <italic>x</italic> of the animal. In the following, we use <inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the first and second spatial dimensions and <inline-formula><mml:math id="inf257"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the head direction. The values of <inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are in the range <inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Note that we take the interval of length <italic>L</italic> even for the dimension of head direction to have spatial and head direction input at the same scale. In the interpretation of head direction input, the periodic interval is to be understood as the full circle of 360 degrees.</p><p>We analyzed three different kinds of input tuning functions. Place cells (single Gaussians), several place fields (sum of multiple Gaussians) and non-localized input (Gaussians convolved with white noise). We summarize the tuning functions of neurons from the excitatory and the inhibitory population by referring to them as population <inline-formula><mml:math id="inf260"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mo>∈</mml:mo><mml:mtext> </mml:mtext><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">I</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>For readability, we define a Gaussian of height 1 with standard deviation <inline-formula><mml:math id="inf262"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ106"><label>(105)</label><mml:math id="m106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The input function of the <italic>i</italic>-th neuron of population P with <inline-formula><mml:math id="inf263"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> place fields per input neuron in one dimension is then given by:<disp-formula id="equ107"><label>(106)</label><mml:math id="m107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf264"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> denotes the center location of field number <italic>β</italic> of input neuron <italic>i</italic> of population P. The scenario of place cell-like inputs is obtained by setting <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>For higher dimensions we define the center components as <inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. In two dimensions, the tuning of the <italic>i</italic>-th neuron of population <inline-formula><mml:math id="inf267"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with <inline-formula><mml:math id="inf268"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> place fields per input neuron is thus given by:<disp-formula id="equ108"><label>(107)</label><mml:math id="m108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, the two one-dimensional Gaussians can have different standard deviations along different axes, <inline-formula><mml:math id="inf269"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf270"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. For simplicity, we constrain the resulting elliptic bell-shaped curve to be aligned with the <inline-formula><mml:math id="inf271"><mml:mi>x</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf272"><mml:mi>y</mml:mi></mml:math></inline-formula> axis.</p><p>In three dimensions we also consider bell-shaped tuning functions along the <inline-formula><mml:math id="inf273"><mml:mi>z</mml:mi></mml:math></inline-formula>-direction. However, as the head direction component is periodic, we take von Mises functions that are periodic in the interval <inline-formula><mml:math id="inf274"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ109"><label>(108)</label><mml:math id="m109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the interpretation of head direction input, the periodic interval is to be understood as the full circle of 360 degrees. In three dimensions, the tuning of the <inline-formula><mml:math id="inf275"><mml:mi>i</mml:mi></mml:math></inline-formula>-th neuron of population P with <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> place fields per input neurons is thus given by:<disp-formula id="equ110"><label>(109)</label><mml:math id="m110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">𝒢</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">ℳ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The center locations <inline-formula><mml:math id="inf277"><mml:msup><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msup></mml:math></inline-formula> for neurons of type P in an enclosure of side length <inline-formula><mml:math id="inf278"><mml:mi>L</mml:mi></mml:math></inline-formula> are drawn from a randomly distorted lattice (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). First, the total number of input neurons is factorized into its dimensional components <inline-formula><mml:math id="inf279"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Then, for example along the <inline-formula><mml:math id="inf280"><mml:mi>x</mml:mi></mml:math></inline-formula> dimension, center locations of neurons of population <inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> are placed equidistantly in <inline-formula><mml:math id="inf282"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Allowing the field centers to lie a multiple of their standard deviation outside the box reduces boundary effects. Each point on the equidistant lattice is subsequently distorted with noise drawn from a uniform distribution whose range is given by the distance between two points on the undistorted lattice, that is, <inline-formula><mml:math id="inf283"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>; see <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>. Other dimensions are treated analogously. This procedure ensures a random, but still dense, coverage of the arena with few place fields. A truly random distribution of centers leads to similar results (not shown), but requires more input neurons to cover the arena densely. We create <inline-formula><mml:math id="inf284"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> of such distorted lattices. To each input neuron we assign one center location from each of the <inline-formula><mml:math id="inf285"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> lattices at random and without replacement. This guarantees that each input neuron has <inline-formula><mml:math id="inf286"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> randomly located fields that together cover the arena densely.</p><p>We obtain dense non-localized input by convolving Gaussians as in <xref ref-type="disp-formula" rid="equ106 equ108">Equations 105 and 107</xref> (with <inline-formula><mml:math id="inf287"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) with uniform white noise between −0.5 and 0.5. For the discretization we choose <inline-formula><mml:math id="inf288"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> and center the Gaussian convolution kernel on an array of eight times its standard deviation. We convolve this array with a sufficiently large array of white noise such that we keep only the values where the array of the convolution kernel is inside the array of the white noise. This way we avoid boundary effects at the edges. From the resulting function we subtract its minimum and then divide by twice the mean of the difference between the function and its minimum. This increases the signal to noise ratio and ensures that all of the inputs have a mean value of 0.5 across the arena and a minimum at 0. For each input neuron we take a different realization of white noise. This results in arbitrary tuning functions of the same autocorrelation length as the Gaussian convolution kernel. We define the autocorrelation length as the distance at which the autocorrelation has decayed to <inline-formula><mml:math id="inf289"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> of its maximum, where <inline-formula><mml:math id="inf290"><mml:mi>e</mml:mi></mml:math></inline-formula> is Euler’s number. The above mentioned also holds for circular enclosures, but we drop all field centers outside of a circle of radius <inline-formula><mml:math id="inf291"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> because they never get activated. This is not necessary but it reduces simulation time.</p></boxed-text></sec><sec id="s9" sec-type="appendix"><title>Learning two sides of a room independently</title><boxed-text><p>In <xref ref-type="fig" rid="fig4">Figure 4</xref> we simulated a rat that explores each half of an arena that is divided by a wall. Then the wall is removed and the animal explores the entire arena. This setup was inspired by recent experiments (<xref ref-type="bibr" rid="bib96">Wernle et al., 2018</xref>) and simulations (Rosay et al., in preparation; <xref ref-type="bibr" rid="bib56">Mégevand, 2013</xref>). To simulate the two separated compartments, we use two independent sets of inputs, that is, place cells that are randomly distributed around the entire arena (AB). One set is active when the rat explores the first compartment, the other set is active when the rat explores the second compartment. Both sets are active when the wall is removed. If we used a single set of inputs, the grids would be merged, even before the wall was removed. The excitatory synaptic weights of the two sets are normalized independently. This is important, because otherwise the synaptic weights of inputs that are only active when the rat is in compartment A would die out while the rat explored compartment B.</p><p>To constrain the motion of the rat to one side of the arena, we create artificial rat trajectories as a persistent random walk with velocity <inline-formula><mml:math id="inf292"><mml:mi>v</mml:mi></mml:math></inline-formula> along a direction vector <inline-formula><mml:math id="inf293"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, with polar angle <inline-formula><mml:math id="inf294"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>. In each time step, <inline-formula><mml:math id="inf295"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, a random number drawn from a normal distribution with mean 0 and standard deviation <inline-formula><mml:math id="inf296"><mml:msqrt><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msqrt></mml:math></inline-formula> is added to <inline-formula><mml:math id="inf297"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, resulting in a two-dimensional random walk of persistence length <inline-formula><mml:math id="inf298"><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Whenever the rat hits one of the boundaries, the direction vector is modified such that the angle of incidence equals the angle of reflection. We relate the trajectory to behavioral times by assuming an average rat velocity of 20 cm/s.</p></boxed-text></sec><sec id="s10" sec-type="appendix"><title>Boundary effects and stability of grids</title><boxed-text><p>The motion of the rat is not periodic. We constrain it to either a square or a circular box. The input tuning is not periodic either. Consequently, input neurons with tuning fields that lie partially outside the boundary receive less activation. This leads to boundary effects: Excitatory weights associated with fields at the boundaries grow less, because the Hebbian learning scales with the presynaptic activation. This leads to smaller firing rates at the boundary. According to the inhibitory learning rule, the inhibitory weights of neurons that are tuned to boundary locations then also grow less. At a distance given by the width of the excitatory firing fields, the excitatory weights grow as fast as those that are far away from the boundary. However, if inhibition is more broadly tuned than excitation, the inhibitory input is still reduced at these locations. Firing fields are thus favored at a distance from the boundary that is determined by the width of the excitatory tuning, because at this location the excitation will exceed the inhibition. This preference of firing at a certain distance from the boundary competes with the preference for hexagonal firing that is induced by the interaction of excitatory and inhibitory plasticity. For place field-like input arranged on a symmetric lattice, the alignment to the boundary can be seen in the alignment of one grid axis to the boundary in a square box (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3a</xref>). This alignment is not an artifact of the symmetric distribution of input fields, because it is not present in a circular arena (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3b</xref>). The tendency to align with the boundary can be overcome using a random distribution of input fields (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3c</xref>), and in particular by using input with more than one place field per neuron, that is, non-localized input. Nonetheless, we observe boundary effects in all simulations when simulating for very long times.</p></boxed-text></sec><sec id="s11" sec-type="appendix"><title>Distribution of initial synaptic weights</title><boxed-text><p>To start with reasonable firing rates, we take the initial weights close to the values that would correspond to the fixed point weights (see also the mathematical analysis). More precisely, initially all synaptic weights are chosen from a uniform distribution. For the spreading of the distribution we take <inline-formula><mml:math id="inf299"><mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the mean value. For the mean value of the excitatory weights, <inline-formula><mml:math id="inf300"><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:math></inline-formula>, we typically take <inline-formula><mml:math id="inf301"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, see <xref ref-type="table" rid="table1">Table 1</xref>. We then determine the mean of the initial inhibitory weights, <inline-formula><mml:math id="inf302"><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:math></inline-formula>, such that the output neuron fires on average around the target rate:<disp-formula id="equ111"><label>(110)</label><mml:math id="m111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>!</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>so<disp-formula id="equ112"><label>(111)</label><mml:math id="m112"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mi>j</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The sums are given by:<disp-formula id="equ113"><label>(112)</label><mml:math id="m113"><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:munderover><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf303"><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> is the number of input neurons, <inline-formula><mml:math id="inf304"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> is the area under a tuning function and <inline-formula><mml:math id="inf305"><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> is the area in which the centers of the input tuning function can lie. For the fixed point weight relation <xref ref-type="disp-formula" rid="equ112">Equation 111</xref> this leads to<disp-formula id="equ114"><label>(113)</label><mml:math id="m114"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">I</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mn>0</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The values for <inline-formula><mml:math id="inf306"><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf307"><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> depend on the dimensionality of the system.</p><sec id="s11-1"><title>One dimension</title><p>For Gaussian input we have:<disp-formula id="equ115"><label>(114)</label><mml:math id="m115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:msqrt><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For Gaussian random field input we have:<disp-formula id="equ116"><label>(115)</label><mml:math id="m116"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo rspace="12.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>L</mml:mi></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s11-2"><title>Two dimensions</title><p>For Gaussian input we have:<disp-formula id="equ117"><label>(116)</label><mml:math id="m117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For Gaussian random field input we have:<disp-formula id="equ118"><label>(117)</label><mml:math id="m118"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo rspace="12.5pt">,</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s11-3"><title>Three dimensions</title><p>In three dimensions we use a von Mises distribution along the third dimension to account for the periodicity of the head direction angle. We thus get<disp-formula id="equ119"><mml:math id="m119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(118)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mo>∫</mml:mo><mml:mo>∫</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(119)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>L</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf308"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is the modified Bessel function. The area in which the function centers can lie is given by:<disp-formula id="equ120"><label>(120)</label><mml:math id="m120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>L</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></boxed-text></sec><sec id="s12" sec-type="appendix"><title>Grid score measure</title><boxed-text><p>We use the grid score suggested by <xref ref-type="bibr" rid="bib47">Langston et al. (2010</xref>) . More precisely, we determine the grid score of a spatial autocorrelogram – the Pearson correlation coefficients for all spatial shifts of the firing rate map against itself – in the following way: We crop a centered doughnut shape from the correlogram. To get the inner radius of the doughnut, we clip all values in the correlogram with values smaller than 0.1 to 0. We obtain the resulting clusters that are larger than 0.1 using scipy.ndimage.measurements.label from the SciPy package for Python with a quadratic filter structure, <inline-formula><mml:math id="inf309"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, for a correlogram with <inline-formula><mml:math id="inf310"><mml:mrow><mml:mn>51</mml:mn><mml:mo>×</mml:mo><mml:mn>51</mml:mn></mml:mrow></mml:math></inline-formula> pixels. We use the distance from the center to the outermost pixel of the innermost cluster as the inner radius of the doughnut. For the outer radius we try 50 values, linearly increasing from the inner radius to the corner of the quadratic arena. For each of the resulting 50 doughnuts, we rotate the doughnut around the center and correlate it with the unrotated doughnut. We determine the correlation for 30, 60, 90, 120 and 150 degrees. We define the grid score as the minimum of the correlation values at 60 and 120 degrees minus the maximum of the correlation values at 30, 90 and 150 degrees. After trying all 50 doughnuts, we take the highest resulting grid score as the grid score of the cell. A hexagonal symmetry thus leads to positive values, whereas a quadratic symmetry leads to negative values.</p></boxed-text></sec><sec id="s13" sec-type="appendix"><title>Measure for head direction tuning</title><boxed-text><p>To quantify the head direction tuning of a cell, we compare the head direction tuning to a uniform circular tuning, using Watson’s <inline-formula><mml:math id="inf311"><mml:msup><mml:mi>U</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> measure. We adopted the code from <xref ref-type="bibr" rid="bib56">Mégevand, 2013</xref> . We drew <inline-formula><mml:math id="inf312"><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> samples, s_HD , from a probability distribution created from the head direction tuning array, and <inline-formula><mml:math id="inf313"><mml:mrow><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> samples, s_uniform , from a uniform distribution and use watson_u2(s_uniform, s_HD) from <xref ref-type="bibr" rid="bib56">Mégevand, 2013</xref> to quantify the degree of non-circularity. The sharper the head direction tuning, the higher the resulting value.</p></boxed-text></sec><sec id="s14" sec-type="appendix"><title>Measure for grid spacing on the linear track</title><boxed-text><p>We define the grid spacing of one-dimensional grids as the location of the first non-centered peak in the autocorrelogram of the firing pattern (<xref ref-type="fig" rid="fig1">Figure 1g</xref>). For place cell-like input, we obtain the grid spacing from a single simulation.</p><p>For non-localized input the grids show defects, which results in misleading peaks in the correlogram. In this case, we used the first peak of the average of 50 correlograms to get the grid spacing (<xref ref-type="fig" rid="fig1">Figure 1h</xref>). The 50 correlograms were obtained from 50 realizations that differ only in the randomness of the input function. To avoid taking a fluctuation in the correlogram as the first peak – and thus obtaining misleading grid spacing – we take the maximum between <inline-formula><mml:math id="inf314"><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (to cut out the center of the correlogram) and 1 (a value larger than the largest grid spacing in <xref ref-type="fig" rid="fig1">Figure 1h</xref>).</p><p>For high values of the spatial smoothness of inhibition, <inline-formula><mml:math id="inf315"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula>, the simulation results deviate from the analytical solution. This is because for high <inline-formula><mml:math id="inf316"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> but small <inline-formula><mml:math id="inf317"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula>, the output neuron fires very sparsely, which impedes the learning. This can be readily overcome by increasing the tuning width, <inline-formula><mml:math id="inf318"><mml:msub><mml:mi>σ</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:msub></mml:math></inline-formula>, of the excitatory input.</p></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.34560.036</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Foster</surname><given-names>David</given-names></name><role>Reviewing Editor</role><aff id="aff3"><institution>University of California, Berkeley</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>[Editors’ note: a previous version of this study was rejected after peer review, but the authors submitted for reconsideration. The first decision letter after peer review is shown below.]</p><p>Thank you for submitting your work entitled &quot;Learning place cells, grid cells and invariances with excitatory and inhibitory plasticity&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Senior Editor and a Reviewing Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers independently prepare their comments and then engaged in a discussion, coordinated by the Reviewing Editor, leading to the final decision. Based on these discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>.</p><p>While all three reviewers found merit in the work, there were significant questions raised about the generality of the model. In particular, there was the concern that the model relies too heavily on assumed values for certain parameters (inputs, and learning rates), so that the contribution of the model is hard to interpret. For this reason, it was felt that the work, while potentially valuable, would be better directed to a more specialized readership than the general neuroscience readership of <italic>eLife</italic>.</p><p><italic>Reviewer #1:</italic> </p><p>The authors present a mathematical model with the ability to generate grid cells, as well as place cells. In this model, each neuron receives excitatory and inhibitory input, which can exhibit varying degrees of smoothness across space. The neural activity evolves according to classic Hebbian plasticity rules, and the relationship between the smoothness of the excitatory versus inhibitory input dictates whether a place field, grid fields, or no spatial tuning at all, is exhibited by the neuron after learning. The authors showed that this model can learn somewhat rapidly, and extended their results to include head direction tuning as well. I think while it is quite bold to present a non-attractor network model of grid cells, especially when there's a lot of evidence that point to grid cells as an attractor network (e.g. Yoon et al., 2013), this model is also interesting and may help explain some of the other non-grid spatial patterns, and conjunctive coding, found in MEC and other parahippocampal areas. The paper is also clear, well-presented, and appears to be very transparent, which is appreciated. However, I think this paper could be further improved by comparing to experimental results, and by fully detailing the caveats and differences with the attractor network model.</p><p>1) I don't know if this is possible, but it would be nice if the authors could connect more of the predictions of the model back to data. For example, the authors show that in their conjunctive grid-head direction cells, the head direction preference is also a function of location. The authors state that whether or not this is the case is the data is 'unresolved', but it would be really nice if the authors could dig into this a bit further. This is another prediction that could potentially allow the field to distinguish between this model and the attractor network, and with the amount of grid cell data that is publicly available, it seems possible to at least demonstrate what is currently known.</p><p>2) Additionally, it is not completely clear what bells and whistles would have to be added to this model to reproduce the experimental results that the attractor network captures (e.g. that nearby grid cells have a similar orientation and spacing, and may preferentially functionally connect to each other (Dunn et al., 2015)). The authors should expand upon this part so the two models can be compared on a more equal footing.</p><p>3) The timescale of learning seems to be a bit of an issue to me. I appreciate that this model does better than others, but I still think that this part of the paper could be expanded upon a bit. When an animal is in a novel environment, the grid pattern appears to be there almost immediately (Hafting et al., 2005). Perhaps this is difficult to actually see, since the animal needs to cover the environment at least once over to see a robust grid pattern. It might be nice to see some examples of what the firing pattern would look like after 3-5 minutes of exploration (perhaps with behavioral trajectories from the Sargolini data), so the model can be mapped directly back to what has been observed experimentally.</p><p>Alternatively – I suppose one way around this is that the spatial inputs to the cell don't change with environment, but then this input can't be place cells, which can remap across environments. Perhaps another alternative is that the input comes from non-grid spatial cells in MEC, although these also might not be stable enough across environments (Diehl et al., 2017). Have the authors considered whether the inputs do (or don't) change across environments, and what that might do the stability of the grid pattern?</p><p>4) It is a little unclear to me what the spatial inputs are – biologically speaking – to the place cells. The authors state that this is not fully resolved, but I think this should be fleshed out a bit more, given that the entire basis of the model is on these cell types. The input to the grid cells (combinations of place cell, or place cell like cells) seems a bit more grounded, but the authors should expand upon what the inputs to the place cells might actually be. Otherwise, in some parts of the paper, it seems a bit like a place cell is generated from the combined inputs of other place cells (which could also be true, but then as presented feels a bit circular and not as exciting or novel).</p><p>5) Is it possible to get non-grid spatial cells, and non-grid spatial cells that also encode head direction and/or running speed, like that seen in Deihl et al., 2017?</p><p><italic>Reviewer #2:</italic> </p><p>This paper presents a neural network model of the development of the spatial tunings of different cell types in the hippocampal formation, with special emphasis on grid cells. The authors use rate-based excitatory and inhibitory neurons, in conjunction with simple learning rules, to show that based on the relative smoothness of the spatial profiles of the inhibitory and excitatory inputs, the same learning rule can yield grid-like, place-like, or spatially invariant tunings in the output neurons. In particular, grid cell period is determined by the width of the inhibitory inputs, as shown through simulation and analytics. The authors demonstrate their finding using both simplistic unimodal spatial inputs as well as more realistic non-local, multimodal inputs.</p><p>I found the paper to be easy to understand, in particular because the learning rules (Hebbian excitatory and homeostatic Hebbian inhibitory) are straightforward, and their effects on the self-organization of the overall tuning by the rearrangement of activity clusters is intuitive and well described. Further, I found the extension of the model to non-local inputs to be an important result, as too often overly simplistic inputs are used for training. I have a few major comments:</p><p>1) As the authors point out, it is well known that grids belonging to the same module share a similar orientation, and that this is an issue for single-cell feedforward models. The authors cite Si et al., 2012 as a potential mechanism for orienting the grids, who show that grid formation and alignment emerge simultaneously. Given that a major thrust of the paper is to show that grids can be learned on the time scale at which they are experimentally ascertained, and therefore that the learning rule is biologically plausible, it is incumbent on the authors to demonstrate that learning to align the grids will not interfere with grid self-organization as proposed in their model, and that it is possible to do so within a reasonable time frame. A supplementary figure should be sufficient.</p><p>2) Along similar lines, the authors criticize continuous attractor network (CAN) developmental models of grid cells (in particular, Widloski and Fiete 2014) for their slowness of learning. The authors miss the point here, for while in these models grids are slow to develop during exposure to the first environment, during which the recurrent weights develop (trained on unimodal spatial inputs similar to those used in the author's work), they are rapidly expressed in any other environment afterwards, unfamiliar or not. This is because, once the continuous attractor is established (and this only needs to be done once), grid field expression is simply a matter of network path integration. Thus, grids appear instantly, even in the absence of localized information (e.g., darkness), and shared grid orientation comes for free.</p><p>3) In Figure 3—figure supplement 3, the author's state that &quot;early firing fields are still present in the final grid&quot;, and say that this is consistent with Hafting et al., 2005. In this figure, the considerable drift in the fields over time makes it hard to relate fields expressed at the end of learning with those at the beginning. I would like to see this quantified in some way other than gridness score, maybe through measuring rate map correlations between the final mature map and the map as it develops in time. To what extent is there phase/scale/orientation drift through time? Further, it is interesting that, according to Figure 3C, the gridness develops rather abruptly, consistent with papers from Wills et al., (Wills et al., 2010, 2012). Does phase/scale/orientation also develop/stabilize with a similar time course?</p><p>4) The distinction between feedforward models (for example in this paper) and CAN models is clear, but less so between different feed forward models that self-organize in similar ways. I would like to see these fleshed out a bit more in the Discussion, in particular with regards to Castro and Aguiar, 2014 and Stepanyuk, 2015, as many might not be aware of them.</p><p>5) It is well known that grid cells recorded in 1d exhibit tuning curves that are strikingly non-periodic. Recently, it was shown (Yoon et al., 2016) that for cells belonging to the same module, these 1d responses are consistent with slices through the same 2d lattice. The authors propose a model that can potentially develop aperiodic grids when using non-local inputs. However, getting the right aperiodicities across cells so that they correspond to slices through the same 2d lattice would seem difficult.</p><p><italic>Reviewer #3:</italic> </p><p>This study proposes a general mechanism for the emergence of the diverse spatial correlates found in the hippocampal formation. Through formal analysis and computational simulations, the authors show that the firing patterns of place cells, grid cells, head direction cells, and related conjunctive correlates can all be obtained by particular forms of synaptic plasticity operating on spatially modulated, excitatory and inhibitory inputs. This framework is interesting for at least two reasons. First, it offers insights that complement those derived from models based on path integration, especially in regard to the sensory-dependent characteristics of these correlates. Second, it suggests a specific role for inhibitory inputs and circuits, which have received increasing attention in the context of the entorhinal cortical architecture and grid cells. Below I summarize my main concerns before providing more detailed comments.</p><p>The success of this model appears to rest on the ad hoc design of spatial inputs (both excitatory and inhibitory) that often seem unrealistic, combined with equally ad hoc choices for the learning rates of the synaptic plasticity operating on these inputs (examples discussed below). Moreover, while I appreciate the theoretical appeal of reducing the emergence of the many diverse types of spatial correlates to a single unifying mechanism, this approach is very likely to overlook the functional significance of the complex and varied architecture of the circuits of the hippocampal formation, and to oversimplify the computational interaction of the spatial correlates in these circuits. Thus the proposed framework seems to shift the complexity of the spatial tunings that it aims to explain one synapse upstream, by assuming a perplexing and yet undocumented degree of specificity and organization in the modulation of inhibitory input patterns and their plasticity.</p><p>As to the organization of the paper, the mathematical analysis that is described in the Materials and methods section appears an important part of the results in this study. Checking all the mathematical derivations thoroughly is a task better fitting the peer-review style and timeframe of more theoretically oriented journals, and I have only read this part superficially. Still, I think that a summary of the main results of this analysis should be included in the Results section and accompanied by an intuitive explanation. Full derivations should still be provided separately (as they are now, but possibly in an appendix, rather than in the Materials and methods section – again this is because I see the mathematical analysis as one of the contributions/results of this paper, rather than a method). I think such a reorganization would benefit the dissemination of the complete results of this paper to a general audience.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.34560.037</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the author responses to the first round of peer review follow.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>The authors present a mathematical model with the ability to generate grid cells, as well as place cells. In this model, each neuron receives excitatory and inhibitory input, which can exhibit varying degrees of smoothness across space. The neural activity evolves according to classic Hebbian plasticity rules, and the relationship between the smoothness of the excitatory versus inhibitory input dictates whether a place field, grid fields, or no spatial tuning at all, is exhibited by the neuron after learning. The authors showed that this model can learn somewhat rapidly, and extended their results to include head direction tuning as well. I think while it is quite bold to present a non-attractor network model of grid cells, especially when there's a lot of evidence that point to grid cells as an attractor network (e.g. Yoon et al., 2013), this model is also interesting and may help explain some of the other non-grid spatial patterns, and conjunctive coding, found in MEC and other parahippocampal areas. The paper is also clear, well-presented, and appears to be very transparent, which is appreciated. However, I think this paper could be further improved by comparing to experimental results, and by fully detailing the caveats and differences with the attractor network model.</p><p>1) I don't know if this is possible, but it would be nice if the authors could connect more of the predictions of the model back to data. For example, the authors show that in their conjunctive grid-head direction cells, the head direction preference is also a function of location. The authors state that whether or not this is the case is the data is 'unresolved', but it would be really nice if the authors could dig into this a bit further. This is another prediction that could potentially allow the field to distinguish between this model and the attractor network, and with the amount of grid cell data that is publicly available, it seems possible to at least demonstrate what is currently known.</p></disp-quote><p>We now extended our manuscript to discuss more data. For example we reproduce a recent experiment of coalescing grids in contiguous environments (now Figure 4). We also looked at publicly available data of the head direction tuning of individual grid fields (Figure 6—figure supplement 1, former Figure 5). Unfortunately, this analysis is inconclusive because of a substantial trajectory bias in most of the grid fields, i.e., the distribution of head directions was too uneven in most individual grid fields. This problem tends to be less prominent for grid fields in the center of the arena. A thorough analysis would hence require grid cell recordings with several central firing fields, i.e., smaller grid spacing. Such recordings exist (e.g., Stensola et al. 2015), but we had no success in obtaining these data.</p><disp-quote content-type="editor-comment"><p>2) Additionally, it is not completely clear what bells and whistles would have to be added to this model to reproduce the experimental results that the attractor network captures (e.g. that nearby grid cells have a similar orientation and spacing, and may preferentially functionally connect to each other (Dunn et al., 2015)). The authors should expand upon this part so the two models can be compared on a more equal footing.</p></disp-quote><p>We appreciate that this is the achilles heel of all single cell models. Si et al., 2012 achieved a co-orientation of grid cells using recurrent connectivity, but required a set of intricate mechanisms to simultaneously obtain uncorrelated grid phases. In general, we strongly suspect that obtaining a co-orientation and phase dispersion together – while learning on all synapses – is challenging. In a separate project, a student is investigating to what extent the suggested mechanism can be implemented in a recurrent and fully plastic network. Even on a linear track – hence ignoring orientation of the grid – the phenomenology is very rich and clearly beyond the scope of the present manuscript. CAN models had 10+ years of refinement to accommodate an increasing number of experimental observations, and it is hard to exceed the resulting high bar with a new model.</p><disp-quote content-type="editor-comment"><p>3) The timescale of learning seems to be a bit of an issue to me. I appreciate that this model does better than others, but I still think that this part of the paper could be expanded upon a bit. When an animal is in a novel environment, the grid pattern appears to be there almost immediately (Hafting et al., 2005). Perhaps this is difficult to actually see, since the animal needs to cover the environment at least once over to see a robust grid pattern. It might be nice to see some examples of what the firing pattern would look like after 3-5 minutes of exploration (perhaps with behavioral trajectories from the Sargolini data), so the model can be mapped directly back to what has been observed experimentally.</p></disp-quote><p>The color coding in Figure 3A, B is showing the activity <italic>during learning</italic>, not <italic>after learning</italic>. Thus, the whole learning process is in principle visible in the figure. We now highlight this in the revised figure caption.</p><disp-quote content-type="editor-comment"><p>Alternatively – I suppose one way around this is that the spatial inputs to the cell don't change with environment, but then this input can't be place cells, which can remap across environments. Perhaps another alternative is that the input comes from non-grid spatial cells in MEC, although these also might not be stable enough across environments (Diehl et al., 2017). Have the authors considered whether the inputs do (or don't) change across environments, and what that might do the stability of the grid pattern?</p></disp-quote><p>Thank you very much for this interesting suggestion. In the revised manuscript we studied this and added a small section to the main text and a new figure as a supplement to Figure 3 (Figure 3—figure supplement 2). In short: the output firing pattern is robust to changes of a substantial fraction of the inputs. If all inputs are remapped, a grid is learned anew.</p><p>New text in Results paragraph “Rapid appearance of grid cells and their reaction to modifications of the environment”:</p><p>“Above, we modeled the exploration of a previously unknown room by assuming the initial synaptic weights to be randomly distributed. […] The strong initial pattern in the weights does not hinder this development (Figure 3—figure supplement 2).”</p><p>New text in the Discussion:</p><p>“Similarly, we found that room switches in our model lead to grid patterns of the same grid spacing but different phases and orientations. […] It would be interesting to study if a rotation of a fraction of the input would lead to a bimodal distribution of grid rotations: No rotation and co-rotation with the rotated input, as recently observed in experiments where distal cues were rotated but proximal cues stayed fixed (Savelli et al., 2017).”</p><disp-quote content-type="editor-comment"><p>4) It is a little unclear to me what the spatial inputs are – biologically speaking – to the place cells. The authors state that this is not fully resolved, but I think this should be fleshed out a bit more, given that the entire basis of the model is on these cell types. The input to the grid cells (combinations of place cell, or place cell like cells) seems a bit more grounded, but the authors should expand upon what the inputs to the place cells might actually be. Otherwise, in some parts of the paper, it seems a bit like a place cell is generated from the combined inputs of other place cells (which could also be true, but then as presented feels a bit circular and not as exciting or novel).</p></disp-quote><p>The requirement to obtain place cells is that the inhibitory input tuning is very smooth or not tuned to location at all, whereas the excitatory inputs show some kind of tuning to location. The <italic>type</italic> of the excitatory tuning is not crucial, be it place cells, grid cells or some form of non-localized non-periodic cells. In the revised manuscript, we emphasized this finding in the paragraph “Place cells, band cells and stretched grids” and added a simulation to Figure 5 (former Figure 4), where we obtain a place cell from excitatory grid cell input from EC and untuned inhibition.</p><p>New text in Results paragraph “Place cells, band cells and stretched grids”:</p><p>“The emergence of place cells is independent of the exact shape of the excitatory input. Non-localized inputs (Figure 5A) lead to similar results as grid cell-like inputs of different orientation and grid spacing (Figure 5B, Materials and methods); for other models for the emergence of place cells from grid cells see (Solstad et al., 2006; Franzius et al., 2007b; Rolls et al., 2006; Molter and Yamaguchi, 2008; Ujfalussy et al., 2009; Savelli and Knierim, 2010).”</p><disp-quote content-type="editor-comment"><p>5) Is it possible to get non-grid spatial cells, and non-grid spatial cells that also encode head direction and/or running speed, like that seen in Deihl et al., 2017?</p></disp-quote><p>Cells that would not be classified as grid cells occur naturally in our model. This can be seen, e.g., in the broad distribution of grid scores in Figure 2. Most of these cells show distorted grids, however. It is not difficult to obtain non-grid spatial cells, e.g., by perturbing the smoothness conditions in the input signals locally. Since there are many ways of introducing irregularities, any particular solution would appear arbitrary. For this reason, we did not include simulations in the manuscript. We now cite Diehl 2017 in the section 'Place cells, band cells and stretched grids’, where we introduce the zoo of firing patterns.</p><p>We added a small paragraph on running speed modulation to our Discussion:</p><p>“In addition, CAN models require that conjunctive (grid x head direction) cells are positively modulated by running speed. […] We expect that in this case, the output neuron would inherit a speed tuning from the input but would otherwise develop similar spatial tuning patterns.”</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>This paper presents a neural network model of the development of the spatial tunings of different cell types in the hippocampal formation, with special emphasis on grid cells. The authors use rate-based excitatory and inhibitory neurons, in conjunction with simple learning rules, to show that based on the relative smoothness of the spatial profiles of the inhibitory and excitatory inputs, the same learning rule can yield grid-like, place-like, or spatially invariant tunings in the output neurons. In particular, grid cell period is determined by the width of the inhibitory inputs, as shown through simulation and analytics. The authors demonstrate their finding using both simplistic unimodal spatial inputs as well as more realistic non-local, multimodal inputs.</p><p>I found the paper to be easy to understand, in particular because the learning rules (Hebbian excitatory and homeostatic Hebbian inhibitory) are straightforward, and their effects on the self-organization of the overall tuning by the rearrangement of activity clusters is intuitive and well described. Further, I found the extension of the model to non-local inputs to be an important result, as too often overly simplistic inputs are used for training. I have a few major comments:</p><p>1) As the authors point out, it is well known that grids belonging to the same module share a similar orientation, and that this is an issue for single-cell feedforward models. The authors cite Si et al., 2012 as a potential mechanism for orienting the grids, who show that grid formation and alignment emerge simultaneously. Given that a major thrust of the paper is to show that grids can be learned on the time scale at which they are experimentally ascertained, and therefore that the learning rule is biologically plausible, it is incumbent on the authors to demonstrate that learning to align the grids will not interfere with grid self-organization as proposed in their model, and that it is possible to do so within a reasonable time frame. A supplementary figure should be sufficient.</p></disp-quote><p>See reply to reviewer #1, point 2 above.</p><disp-quote content-type="editor-comment"><p>2) Along similar lines, the authors criticize continuous attractor network (CAN) developmental models of grid cells (in particular, Widloski and Fiete 2014) for their slowness of learning. The authors miss the point here, for while in these models grids are slow to develop during exposure to the first environment, during which the recurrent weights develop (trained on unimodal spatial inputs similar to those used in the author's work), they are rapidly expressed in any other environment afterwards, unfamiliar or not. This is because, once the continuous attractor is established (and this only needs to be done once), grid field expression is simply a matter of network path integration. Thus, grids appear instantly, even in the absence of localized information (e.g., darkness), and shared grid orientation comes for free.</p></disp-quote><p>Thanks for spotting this imprecise phrasing. In the revised manuscript, we removed the citation at this particular point in the text and explicitly comment on this matter in more detail in our Discussion:</p><p>“Learning the required connectivity in CAN models can take a long time (Widloski and Fiete, 2014). […] The pattern emerges rapidly, but is not instantaneously present (Figure 3—figure supplement 2).”</p><disp-quote content-type="editor-comment"><p>3) In Figure 3—figure supplement 3, the author's state that &quot;early firing fields are still present in the final grid&quot;, and say that this is consistent with Hafting et al., 2005. In this figure, the considerable drift in the fields over time makes it hard to relate fields expressed at the end of learning with those at the beginning. I would like to see this quantified in some way other than gridness score, maybe through measuring rate map correlations between the final mature map and the map as it develops in time. To what extent is there phase/scale/orientation drift through time? Further, it is interesting that, according to Figure 3C, the gridness develops rather abruptly, consistent with papers from Wills et al., (Wills et al., 2010, 2012). Does phase/scale/orientation also develop/stabilize with a similar time course?</p></disp-quote><p>The abruptness in Figure 3C is an artifact of the grid score, which is highly sensitive to displaced firing fields. On reasonable time scales (many tens of hours), we observed no grid drift, i.e., phase, spacing and orientation are rather stable. This can be seen, e.g., in the newly added Figure 3—figure supplement 2C (with remapping fraction 0), which shows the correlation coefficient of the grid pattern after 5h of learning with the grid patterns at earlier and later times. The correlation of the grid at 5 hours with the grid at 10 hours is very high considering the small size of the grid fields, suggesting that fields drift only very little once they are learned. The same figure also illustrates the claimed stability of the firing fields that arise early during learning, as the correlation with the grid pattern after 5h shows a very steep rise at learning onset. We refer to this figure also when we talk about grid stability: See response to major comment #3 of reviewer #1.</p><disp-quote content-type="editor-comment"><p>4) The distinction between feedforward models (for example in this paper) and CAN models is clear, but less so between different feed forward models that self-organize in similar ways. I would like to see these fleshed out a bit more in the Discussion, in particular with regards to Castro and Aguiar, 2014 and Stepanyuk, 2015, as many might not be aware of them.</p></disp-quote><p>In the revised version we now highlight the differences to our model when we cite these papers:</p><p>“Other models that explain the emergence of grid patterns from place cell input through synaptic depression and potentiation also develop grid cells in realistic times (Castro and Aguiar, 2014; Stepanyuk, 2015). […] How these models generalize to potentially non-localized input is yet to be shown.”</p><disp-quote content-type="editor-comment"><p>5) It is well known that grid cells recorded in 1d exhibit tuning curves that are strikingly non-periodic. Recently, it was shown (Yoon et al., 2016) that for cells belonging to the same module, these 1d responses are consistent with slices through the same 2d lattice. The authors propose a model that can potentially develop aperiodic grids when using non-local inputs. However, getting the right aperiodicities across cells so that they correspond to slices through the same 2d lattice would seem difficult.</p></disp-quote><p>The aperiodicities from general inputs would indeed not have to be consistent with slices through a 2d grid cell. We added a paragraph to our Discussion:</p><p>“A recent analysis has shown that the periodic firing of entorhinal cells in rats that move on a linear track can be assessed as slices through a hexagonal grid (Yoon et al., 2016), which arises naturally in a two dimensional CAN. In our model, we would obtain slices through a hexagonal grid if the rat learns the output pattern in two dimensions and afterwards is constrained to move on a linear track that is part of the same arena. If the rat learns the firing pattern on the linear track from scratch, the firing fields would be periodic.”</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>This study proposes a general mechanism for the emergence of the diverse spatial correlates found in the hippocampal formation. Through formal analysis and computational simulations, the authors show that the firing patterns of place cells, grid cells, head direction cells, and related conjunctive correlates can all be obtained by particular forms of synaptic plasticity operating on spatially modulated, excitatory and inhibitory inputs. This framework is interesting for at least two reasons. First, it offers insights that complement those derived from models based on path integration, especially in regard to the sensory-dependent characteristics of these correlates. Second, it suggests a specific role for inhibitory inputs and circuits, which have received increasing attention in the context of the entorhinal cortical architecture and grid cells. Below I summarize my main concerns before providing more detailed comments.</p><p>The success of this model appears to rest on the ad hoc design of spatial inputs (both excitatory and inhibitory) that often seem unrealistic, combined with equally ad hoc choices for the learning rates of the synaptic plasticity operating on these inputs (examples discussed below). Moreover, while I appreciate the theoretical appeal of reducing the emergence of the many diverse types of spatial correlates to a single unifying mechanism, this approach is very likely to overlook the functional significance of the complex and varied architecture of the circuits of the hippocampal formation, and to oversimplify the computational interaction of the spatial correlates in these circuits. Thus the proposed framework seems to shift the complexity of the spatial tunings that it aims to explain one synapse upstream, by assuming a perplexing and yet undocumented degree of specificity and organization in the modulation of inhibitory input patterns and their plasticity.</p></disp-quote><p>We are a bit surprised by the impression of the reviewer that we chose our input patterns ad-hoc, and interpret this as a signal that we presented our case poorly. The core idea of the model is that it is only statistical properties of the input tuning functions that shape the output patterns (their smoothness, i.e., autocorrelation length), and that details of these patterns do not change the results. Of course, any computational model has to commit to a particular input tuning to run analyses. Since we do not know enough about the actual inputs to the various cell types, we resorted to illustrating that the suggested mechanism produces the same results for various different input tunings, including input tuning functions that minimize any further assumptions (the Gaussian random field inputs in Figures 1, 2, 5 are samples from a maximum-entropy distribution for a given autocorrelation function). We were trying to make the point that the requirements of the model are relatively mild and leave significant flexibility regarding the actual input tuning functions, with the exception of the smoothness assumptions, which we regard as testable predictions. To further strengthen this point, we now added simulations with grid cells as inputs, and a simulation with place-field-like excitation and nonlocalized inhibition. If the reviewer has a suggestion how to make this point even clearer, we would appreciate it.</p><disp-quote content-type="editor-comment"><p>As to the organization of the paper, the mathematical analysis that is described in the Materials and methods section appears an important part of the results in this study. Checking all the mathematical derivations thoroughly is a task better fitting the peer-review style and timeframe of more theoretically oriented journals, and I have only read this part superficially. Still, I think that a summary of the main results of this analysis should be included in the Results section and accompanied by an intuitive explanation. Full derivations should still be provided separately (as they are now, but possibly in an appendix, rather than in the Materials and methods section – again this is because I see the mathematical analysis as one of the contributions/results of this paper, rather than a method). I think such a reorganization would benefit the dissemination of the complete results of this paper to a general audience.</p></disp-quote><p>We also regard the mathematical analysis as a strong point and result of the paper. For this reason, we decided to keep it in the Materials and methods section, to make sure it remains part of the main manuscript. Either option is fine for us, and we would leave this decision to the editors.</p></body></sub-article></article>