<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">11031</article-id><article-id pub-id-type="doi">10.7554/eLife.11031</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Integrative neuromechanics of crawling in <italic>D. melanogaster</italic> larvae</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-41363"><name><surname>Pehlevan</surname><given-names>Cengiz</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9767-6063</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41364"><name><surname>Paoletti</surname><given-names>Paolo</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6131-0377</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-32260"><name><surname>Mahadevan</surname><given-names>L</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5114-0519</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">The Swartz Program in Theoretical Neuroscience</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Simons Center for Data Analysis</institution>, <institution>Simons Foundation</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">School of Engineering</institution>, <institution>The University of Liverpool</institution>, <addr-line><named-content content-type="city">Liverpool</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">John A Paulson School of Engineering and Applied Sciences</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department of Organismic and Evolutionary Biology</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Wyss Institute for Bioinspired Engineering</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Kavli Institute for BioNano Science and Technology</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff><aff id="aff8"><label>8</label><institution content-type="dept">Department of Physics</institution>, <institution>Harvard University</institution>, <addr-line><named-content content-type="city">Cambridge</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><aff id="aff9"><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>lm@seas.harvard.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>25</day><month>07</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e11031</elocation-id><history><date date-type="received"><day>21</day><month>08</month><year>2015</year></date><date date-type="accepted"><day>30</day><month>05</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Pehlevan et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Pehlevan et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-11031-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.11031.001</object-id><p>Locomotion in an organism is a consequence of the coupled interaction between brain, body and environment. Motivated by qualitative observations and quantitative perturbations of crawling in <italic>Drosophila melanogaster</italic> larvae, we construct a minimal integrative mathematical model for its locomotion. Our model couples the excitation-inhibition circuits in the nervous system to force production in the muscles and body movement in a frictional environment, thence linking neural dynamics to body mechanics via sensory feedback in a heterogeneous environment. Our results explain the basic observed phenomenology of crawling with and without proprioception, and elucidate the stabilizing role that proprioception plays in producing a robust crawling phenotype in the presence of biological perturbations. More generally, our approach allows us to make testable predictions on the effect of changing body-environment interactions on crawling, and serves as a step in the development of hierarchical models linking cellular processes to behavior.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.001">http://dx.doi.org/10.7554/eLife.11031.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>locomotion</kwd><kwd>proprioception</kwd><kwd>central pattern generator</kwd><kwd>crawling</kwd><kwd>friction</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution>The Swartz Foundation</institution></institution-wrap></funding-source><award-id>Swartz Fellowship</award-id><principal-award-recipient><name><surname>Pehlevan</surname><given-names>Cengiz</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000870</institution-id><institution>John D. and Catherine T. MacArthur Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Mahadevan</surname><given-names>L</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>An integrative model of coordinated crawling in fruit fly maggots links neuromuscular dynamics to body-substrate mechanics in the presence of proprioceptive feedback.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A complete theory of locomotory behavior requires an integrative approach linking the nervous system in an organism to the body in which the nervous system lives and the environment that the body interacts with (<xref ref-type="bibr" rid="bib32">Pearson et al., 2006</xref>; <xref ref-type="bibr" rid="bib43">Tytell et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Chiel et al., 2009</xref>). However, most studies focus on rhythmic gait and its maintenance in an organism driven by the presence of a central pattern generator (CPG) that drives coordinated motor activity (<xref ref-type="bibr" rid="bib30">Marder and Bucher, 2001</xref>; <xref ref-type="bibr" rid="bib22">Ijspeert, 2008</xref>). While the existence of a CPG has been validated in a variety of organisms (<xref ref-type="bibr" rid="bib30">Marder and Bucher, 2001</xref>; <xref ref-type="bibr" rid="bib17">Grillner, 2006</xref>) and exploited in artificial systems (<xref ref-type="bibr" rid="bib22">Ijspeert, 2008</xref>; <xref ref-type="bibr" rid="bib2">Boxerbaum et al., 2012</xref>), growing evidence suggests that sensory feedback plays an important role in maintaining robust and stable locomotion. Indeed recent studies on <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib48">Wen et al., 2012</xref>; <xref ref-type="bibr" rid="bib3">Boyle et al., 2012</xref>) focusing on local sensory feedback and proprioception show that these modalities suffice to modulate the locomotory pattern and explain gait transitions associated with undulatory swimming and crawling, without the need for a central pattern generator. This has led to recent attempts to include proprioceptive coupling and build an integrative theory of locomotion in examples such as anguilliform swimming in fish (<xref ref-type="bibr" rid="bib12">Ekeberg, 1993</xref>; <xref ref-type="bibr" rid="bib11">Ekeberg and Grillner, 1999</xref>), swimming in leech (<xref ref-type="bibr" rid="bib6">Cang and Friesen, 2002</xref>), walking in insects (<xref ref-type="bibr" rid="bib27">Kukillaya et al., 2009</xref>; <xref ref-type="bibr" rid="bib34">Proctor et al., 2010</xref>; <xref ref-type="bibr" rid="bib33">Proctor and Holmes, 2010</xref>; <xref ref-type="bibr" rid="bib20">Holmes et al., 2006</xref>) and humanoids (<xref ref-type="bibr" rid="bib45">Verdaasdonk et al., 2009</xref>). However, the complexity of the brain-body-environment coupling in these organismal systems has been a substantial impediment in the use of models to make testable predictions on the biological mechanisms regulating locomotion.</p><p>Here, we consider the rectilinear crawling behavior of a model organism, the larva of the fruit fly, <italic>D. melanogaster</italic> (<xref ref-type="other" rid="media1">Video 1</xref>), which has increasingly become the focus of molecular, cellular, genetic and behavioral studies using a variety of experimental probes (<xref ref-type="bibr" rid="bib41">Suster and Bate, 2002</xref>; <xref ref-type="bibr" rid="bib13">Fox et al., 2006</xref>; <xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib8">Crisp et al., 2008</xref>; <xref ref-type="bibr" rid="bib40">Song et al., 2007</xref>; <xref ref-type="bibr" rid="bib28">Lahiri et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>; <xref ref-type="bibr" rid="bib1">Berni et al., 2012</xref>; <xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="bib9">Crisp et al., 2011</xref>; <xref ref-type="bibr" rid="bib14">Fushiki et al., 2013</xref>; <xref ref-type="bibr" rid="bib16">Gjorgjieva et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Vogelstein et al., 2014</xref>; <xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Itakura et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Pulver et al., 2015</xref>). The larva is a soft bodied cylindrical organism about 4 mm in length and about 800 μm in diameter in the third instar stage. It moves in a manner similar to other long soft-bodied creatures such as earthworms and leeches by exploiting the peristaltic propagation of muscular relaxation and contraction waves along their bodies to induce forward locomotion, or crawling (<xref ref-type="bibr" rid="bib42">Trueman, 1975</xref>); despite biomechanical differences between these different organisms, the crawling gait seems to be a convergent strategy across species. The dynamical process that triggers, coordinates and maintains the propagation of such waves has attracted the attention of researchers for a century (<xref ref-type="bibr" rid="bib15">Garrey, 1915</xref>). Early experimental efforts tried to understand the macroscopic mechanics of soft bodied animal locomotion (<xref ref-type="bibr" rid="bib42">Trueman, 1975</xref>) by focusing on one of the underlying subsystems: body mechanics, muscular force production and neural dynamics. More recently, there is a growing realization that the coupling between the nervous system, the body and the substrate in the presence of sensory feedback plays a major role in development and maintenance of crawling gaits, and perhaps even in evolution (<xref ref-type="bibr" rid="bib7">Chiel et al., 2009</xref>). For example, the locomotory behavior of <italic>Manduca sexta</italic> larvae, an organism where proprioceptive sensing displays a wide range of behaviors (<xref ref-type="bibr" rid="bib38">Simon and Trimmer, 2009</xref>), is known to be dependent on substrate stiffness that modulates the role of external stimuli and on body deformation rate (<xref ref-type="bibr" rid="bib29">Lin and Trimmer, 2010</xref>). In the <italic>D. melanogaster</italic> larva, there is strong evidence that proprioception plays as important a role as the CPG in generating coordinated motion. Eliminating proprioception with genetic (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>) and optogenetic (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>) methods leads to qualitative changes in the crawling gait: peristaltic waves have a period that is ≈4 times longer or may even stop propagating (<xref ref-type="bibr" rid="bib40">Song et al., 2007</xref>), and body segments contract ≈2 times more (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>). Experiments that block sensory input in the embryo show that crawling behavior still develops in the larva, but with longer peristaltic wave periods (<xref ref-type="bibr" rid="bib41">Suster and Bate, 2002</xref>; <xref ref-type="bibr" rid="bib14">Fushiki et al., 2013</xref>), providing further evidence for the importance of proprioception. Together, the classical and modern studies on locomotory physiology and the modern studies on the molecular and cellular subsystems in the larva suggest that it is an excellent biophysical testbed for an integrative theory that spans multiple scales.<media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-11031-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.11031.002</object-id><label>Video 1.</label><caption><title>GFP imaging of <italic>Drosophila</italic> larva forward crawling body segment and gut movements.</title><p>Courtesy of Ellie Heckscher. See also reference (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>). Original video is available at: <ext-link ext-link-type="uri" xlink:href="https://www.youtube.com/watch?v=1d7zMYWLjLI">https://www.youtube.com/watch?v=1d7zMYWLjLI</ext-link></p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.002">http://dx.doi.org/10.7554/eLife.11031.002</ext-link></p></caption></media></p><p>In this paper, we present a mathematical model of crawling in <italic>D. melanogaster</italic> larvae that is guided by the anatomy and the kinematics of the gait of the organism. Our theory explicitly accounts for the mechanics of the passive deformable soft body, properties of the substrate on which the crawling occurs, active muscular forcing, neural dynamics and the interactions and feedbacks between these sub-systems. This allows us to reproduce the robust crawling gait that is consistent with experimental findings in first (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>) and third (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>) instar larvae. Furthermore, our model qualitatively and quantitatively captures the effects of a) optogenetic perturbations of neural activity (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>; <xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>), and b) silencing proprioception with genetic (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>) and optogenetic (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>) methods.</p><p>Our integrated model also allows us to make specific experimentally testable predictions. In particular, by changing the strength of coupling between adjacent segments in the CPG, both in the absence and presence of proprioception, we show how proprioception increases the robustness of crawling. This leads to the prediction that there should be much more variability in crawling metrics among individuals with silenced or weakened proprioception. Furthermore, we predict that larvae could use the strength of CPG coupling as a means of controlling the speed of gait. Finally, we show that changing the frictional interactions of the organism with the substrate should yield observable effects on the efficiency of locomotion.</p><p>More broadly, our study also aims to provide a set of plausible scenarios for the biophysical mechanisms underlying crawling, by linking body mechanics, muscular forcing, neural dynamics, the properties of the substrate and their coupling, with natural implications for engineering applications.</p></sec><sec id="s2"><title>Mathematical model</title><sec id="s2-1"><title>Overview</title><p>We start with a broad overview of our model leaving aside the mathematical details and experimental justifications behind them in the rest of this section.</p><p>In <xref ref-type="fig" rid="fig1">Figure 1</xref>, we show our model of a <italic>D. melanogaster</italic> larva. Anatomically, the larva has 3 thoracic (T1-T3) and 8 abdominal (A1-A8) segments, <xref ref-type="fig" rid="fig1">Figure 1A</xref>. In addition, there is a head/mouth and a tail, but due to the lack of sharp boundaries in their musculature, experiments have not been able to distinguish the dynamics of the head motion from that of T1 and the tail from that of A8 (<xref ref-type="bibr" rid="bib28">Lahiri et al., 2011</xref>; <xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>). We therefore treat the head as a part of the T1 segment, and the tail as a part of the A8 segment. Moreover, here we focus on the simplest locomotory behavior associated with rectilinear motion along the anterior-posterior axis (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>), thus ignoring the individual dynamics of hemisegments which move together in rectilinear crawling, and enumerate segments from 0 to 10 starting from the head.<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.003</object-id><label>Figure 1.</label><caption><title>Schematic of the model.</title><p>(<bold>A</bold>) <italic>Drosophila</italic> larvae have segmented bodies. (<bold>B</bold>) An overview of the model for one segment. Only input neural and proprioceptive signals are shown to the neural controller, its output is not shown. Shades mark subsystems. Red lines show excitatory neural synapses, blue denotes inhibitory synapses. (<bold>C</bold>) The larva body is modeled as a linear chain of masses, connected by damped linear springs. Head and tail segments are coupled mechanically, denoted by the green line. Each segment feels friction due to contact with the substrate. Body segments are actuated with muscular forces, <inline-formula><mml:math id="inf1"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, that are excited by input from the larva VNC. VNC is modeled as a chain of excitatory, <inline-formula><mml:math id="inf2"><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and inhibitory, <inline-formula><mml:math id="inf3"><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, neural populations. Self-coupling of populations are not shown. VNC gets proprioceptive input that signals contraction of a particular segment, shown by lines with arrows on both ends. (<bold>D</bold>) Segment-to-segment propagation of neural activity happens through neural (<inline-formula><mml:math id="inf4"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and proprioceptive (<inline-formula><mml:math id="inf5"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) couplings. Detailed description and model equations are given in the Model section.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.003">http://dx.doi.org/10.7554/eLife.11031.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11031-fig1-v1"/></fig></p><p>The larva is modeled as a set of discrete, repetitive units, one unit for each body segment. The main features of each unit are illustrated in <xref ref-type="fig" rid="fig1">Figure 1B</xref>, while <xref ref-type="fig" rid="fig1">Figure 1C</xref> shows the collective dynamics of the multiple units. When stationary, each segment has length <inline-formula><mml:math id="inf6"><mml:mi>L</mml:mi></mml:math></inline-formula>, a parameter that sets the length scale in the model. The larva is soft-bodied and the elastic properties of body segments are approximated by a set of linear springs and dampers. A key parameter here is the stiffness of the springs that sets the scale of forces in the model. Each unit has a neural controller made of excitation-inhibition circuits in the Ventral Nerve Cord (VNC), which governs the reaction time of excitation in the neural controller. The excitatory neurons act also as motor neurons, and drive a muscle within the segment, which exerts a contractile force to the segment when activated. Crawling occurs on a substrate when the force rises above a threshold controlled by friction. Larvae lift segments off the ground when they contract (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>) and hence control friction actively.</p><p>The contraction wave propagates through the body by a sequential activation of neural controllers in the VNC, leading to propagation through two channels (<xref ref-type="fig" rid="fig1">Figure 1D</xref>): 1) A proprioceptive channel that is mediated by 'Stretch receptors', which respond to changes in segmental length, get activated when a segment contracts beyond a threshold and send two excitatory signals. One of them feeds the excitatory neurons in the next anterior segment and propagates the neural activity. The other signal feeds to the inhibitory neurons in the same segment, leading to the inhibition of excitatory neurons that then causes contraction to be stopped. This model of proprioception is consistent with the 'mission accomplished' model of proprioception, proposed in (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>). 2) A neural channel that is mediated by excitatory neurons in adjacent segments that are coupled from posterior to anterior direction.</p><p>Finally, our model also involves long range mechanical and neural/proprioceptive coupling between head and tail to trigger a new cycle of crawling as soon as the head starts moving. At the beginning of each crawling cycle, it has been observed that the head and the tail of a larva move concurrently in a motion called the 'visceral piston phase' of crawling (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="bib39">Simon et al., 2010</xref>), because the gut moves with the head and the tail, in advance of the surrounding body tissues. We model this behavior by forcing the displacement of head and tail segments to be the same. Once the peristaltic wave reaches the head, it propagates to the tail through assumed long range neural and proprioceptive couplings of T2 and A8 segments, and a new wave is initiated.</p><p>Our study builds on and extends a recent minimal model for crawling locomotion (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>) that shows how a local sensory feedback-based mechanism is capable of inducing rhythmic locomotion in soft bodied organisms by accounting for a fully coupled excitatory-inhibitory neural circuit, and the nonlinear frictional interaction with the substrate, while hewing close to experiments on the <italic>D. melanogaster</italic> larva.</p><p>It is useful to also contrast with a recent study <italic>(<xref ref-type="bibr" rid="bib16">Gjorgjieva et al., 2013</xref>),</italic> which focused on the neural dynamics of the VNC and studied conditions under which activity propagates in the VNC. The model differs from our neural model most importantly by including anterior-to-posterior couplings and intersegmental coupling from inhibitory to excitatory neurons, both of which were necessary to achieve bidirectional wave propagation in the VNC. The same study also considered a bilateral VNC model and examined its left-right synchronization properties. However, unlike the present study, this model did not include any mechanical, muscular and environmental coupling.</p></sec><sec id="s2-2"><title>Neural dynamics: excitation, inhibition and proprioceptive coupling</title><p>We model the neural dynamics of the ventral nerve chord (VNC) in terms of the classical Wilson-Cowan equations (<xref ref-type="bibr" rid="bib49">Wilson and Cowan, 1972</xref>) for the activity of excitatory and inhibitory populations of neurons in a segment. This choice leads to a more realistic model than the single population phase oscillators used in (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>) and is thus similar to recent approaches that consider the purely neural aspects of the locomotory circuit (<xref ref-type="bibr" rid="bib16">Gjorgjieva et al., 2013</xref>):<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>10.</mml:mn></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM15">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM16">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the activity levels of the excitatory and inhibitory neuron populations respectively, <inline-formula><mml:math id="inf9"><mml:mrow><mml:msub id="XM17"><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM18"><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM19"><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the weights for the excitatory-excitatory, excitatory-inhibitory and inhibitory-inhibitory couplings, <inline-formula><mml:math id="inf11"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf12"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula> are activation thresholds for the different neural populations, <inline-formula><mml:math id="inf13"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi id="XM20">E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM21">tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM22"><mml:msub><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is a sigmoid characterizing the switching threshold with <inline-formula><mml:math id="inf14"><mml:msub><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula> the dimensionless gain, and <inline-formula><mml:math id="inf15"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi id="XM23">E</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM24">I</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> refer to external inputs to these segmental populations. The external inputs take two forms: neural coupling that links to the neural populations in the neighboring posterior segment, and proprioceptive coupling that accounts for mechano-sensory feedback from the body to the VNC, shown in <xref ref-type="fig" rid="fig1">Figure 1B,C and D</xref>. A minimal mathematical description of this leads to the following dynamics of inputs <inline-formula><mml:math id="inf16"><mml:mrow><mml:mrow id="XM27"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM25">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM28"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>I</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM26">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> :<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>9</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-2_8"><mml:mtext>(2)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>10.</mml:mn></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For inputs to excitatory neurons, i.e. the first two equations, the first term on the right hand side corresponds to the input from the neural populations, which did not exist in (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>), while the last term corresponds to the proprioceptive input from the body. Here <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> governs the strength of neural coupling, <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the strengths of the proprioceptive couplings, <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM55">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the location of segment <inline-formula><mml:math id="inf21"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf22"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> being the segmental contraction threshold, and <inline-formula><mml:math id="inf23"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi id="XM56">u</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM57">tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM58"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> is the gain. The last <xref ref-type="disp-formula" rid="equ2">Equation in (2)</xref> characterizes proprioceptive input to inhibitory neurons thresholded by <inline-formula><mml:math id="inf25"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. We have assumed that the response time of the stretch receptors is relatively fast compared to the dynamics of the VNC neural populations, and model the input from the stretch receptors as sigmoids, <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, weighted by parameters <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Thus, when <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> there is no proprioception; as we will see, varying these parameters may be directly related to recent experimental manipulations (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>).</p><p>Observations show that larvae can crawl without proprioceptive feedback (<xref ref-type="bibr" rid="bib41">Suster and Bate, 2002</xref>; <xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>) or input from the brain (<xref ref-type="bibr" rid="bib1">Berni et al., 2012</xref>). Furthermore, the central nervous system, when isolated from the body, can still produce waves of neural activity propagating from posterior to anterior (<xref ref-type="bibr" rid="bib35">Pulver et al., 2015</xref>). Therefore, the VNC should be able to propagate neural activity purely by segment-to-segment neural coupling; in our model this is achieved by introducing excitatory neural couplings from posterior to adjacent anterior segments, strengths of which are governed by the parameter <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1B,C and D</xref>).</p><p>For the proprioceptive coupling we assume the 'mission accomplished' model (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib40">Song et al., 2007</xref>) (<xref ref-type="fig" rid="fig1">Figure 1B,C and D</xref>). In (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>) silencing bipolar dendrite and class I multidendritic types of sensory neurons was shown to slow down frequency of peristaltic waves significantly. The 'mission accomplished' model (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>) proposes that these neurons signal the VNC at the end of a successful contraction in a body segment. When a segment contracts relative to an adjacent anterior segment beyond a threshold, an excitatory signal is sent to the next anterior VNC segment to initiate contraction. Simultaneously, activity in the current segment is suppressed by exciting the inhibitory population, a mechanism that was not accounted for in our earlier minimal model (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>).</p><p>We also assume neural and proprioceptive inputs from segment T2 to segment A8, as modeled by the second <xref ref-type="disp-formula" rid="equ1">Equation (1)</xref>; these naturally lead to reinitiation of the crawling cycle. This again differs from (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>) and (<xref ref-type="bibr" rid="bib16">Gjorgjieva et al., 2013</xref>) where reinitiation is achieved by external inputs. Such long range coupling, also used in stick insect models (<xref ref-type="bibr" rid="bib10">Daun-Gruhn and Tóth, 2011</xref>), is plausible as neurons that extend across multiple segments have been observed in <italic>Drosophila</italic> larva VNC (<xref ref-type="bibr" rid="bib37">Schmid et al., 1999</xref>). We note that this is not the only possible mechanism to reinitiate crawling cycles, and an alternative is discussed in the Appendix 1.</p></sec><sec id="s2-3"><title>Body mechanics: active muscular and passive tissue mechanics</title><p>At the anatomical level, we assume that each segment has mass <inline-formula><mml:math id="inf32"><mml:mi>m</mml:mi></mml:math></inline-formula>, length <inline-formula><mml:math id="inf33"><mml:mi>L</mml:mi></mml:math></inline-formula> and is linked to its immediate neighbors by linear springs with stiffness <inline-formula><mml:math id="inf34"><mml:mi>k</mml:mi></mml:math></inline-formula> and damping coefficient <inline-formula><mml:math id="inf35"><mml:mi>c</mml:mi></mml:math></inline-formula>, as shown in <xref ref-type="fig" rid="fig1">Figure 1C</xref> and similar to what is described in (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>). As we will see, this minimal mechanical model suffices to explain a range of experimental observations.</p><p>One cycle of larval forward crawling has two phases (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>): (i) the 'visceral piston' phase (<xref ref-type="bibr" rid="bib39">Simon et al., 2010</xref>), where the gut moves forward in advance of the surrounding tissues, concurrently with the head and the tail, followed by (ii) the wave phase, where the peristaltic wave propagates from posterior to anterior in the remaining segments. The mechanism underlying the tail-head coordination during the visceral piston phase is unknown, however the observation that the gut moves together with the head and the tail (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>), is consistent with the suggestion that the gut mechanically couples the head and the tail and leads to visceral piston-like action as seen in other organisms such as the <italic>Manduca sexta</italic> larvae (<xref ref-type="bibr" rid="bib39">Simon et al., 2010</xref>). We chose to minimally implement this coupling by linking the head and the tail with a rod, i.e. an infinitely stiff spring, thus enforcing a 'periodic' boundary condition that leads to concurrent head-tail movement. Softening the spring will introduce a small temporal delay and allows for changes in the length of the larva during peristalsis, but does not change the qualitative nature of our results. Our model ignores the frictional interactions of the gut with the body segments, however in the absence of experimental data to guide modeling such interactions, we choose to keep our model minimal. Another mechanism for enforcing such periodic boundary condition could be synchronized neural drive at the head and the tail segments, which requires more elaborate models that we explore in the Appendix 1.</p><p>Further, since the maggot and its segments move relatively slowly, we assume that inertial effects are negligible so that segmental forces are balanced by friction locally. Although experimental measurements of these forces do not yet exist, a simple estimate shows that this hypothesis is justified. The mass of a third instar larva is ≈10<sup>-3</sup> g and the acceleration of the larvae is on the order of ≈10<sup>-3</sup> m/s<sup>2</sup>, which leads to an inertial force of ≈10<sup>-6</sup> gm/s<sup>2</sup>. In an experimental study (<xref ref-type="bibr" rid="bib47">Wallace, 1969</xref>), friction forces to draw a glass fiber of the size of a small nematode on an agar surface was measured to be ≈5·10<sup>-2</sup> gm/s<sup>2</sup>, justifying our approximation.</p><p>Collecting all these arguments together, the displacement of individual segments <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM59">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are governed by the equations:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>9</mml:mn></mml:mstyle></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>9</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-3_2"><mml:mtext>(3)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf37"><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:math></inline-formula> is the frictional force on the body segments, and <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the muscular forces. Here, the penultimate equation characterizes the mechanics of the first segment, while the last equation describes our enforced periodic boundary condition to model the concurrent head-tail motion in the visceral piston phase, a boundary condition that was not used in our earlier model (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>) that required an external periodic excitation signal to achieve sustained crawling.</p><p>Muscles in each segment provide contractile forces in the anterior-posterior axis necessary for locomotion (<xref ref-type="bibr" rid="bib19">Heckscher et al. (2012)</xref>). They are activated by excitatory input from the neurons of the corresponding segment of the VNC. This is consistent with the observation that the propagation of contraction waves can be temporarily stopped by locally inhibiting the motor neurons in one segment (<xref ref-type="bibr" rid="bib23">Inada et al. (2011)</xref>). As detailed studies of the muscular dynamics are not available in the larva, we model this behavior using a simple first-order dynamical law for the muscular force<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>f</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math></inline-formula> is the maximum force exerted by muscles, <inline-formula><mml:math id="inf40"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi id="XM90">E</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM91">tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM92"><mml:msub><mml:mi>g</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>g</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></inline-formula> is the gain and <inline-formula><mml:math id="inf42"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is a threshold for muscle activation.</p><p>Due to the assumed head-tail coupling, contraction of the tail segment leads to stretching of the head segment driven by <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula>, consistent with the observation in (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>), that tail muscles contract in the visceral piston phase. In (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>), it was speculated that tail contraction provides both a moving of the tail forward and pushing of the gut forward. Our model could be interpreted as adding to this speculation that the push gets transferred to the head by the gut and causes its motion. It is possible that motion in head segment is not totally passive, but mediated actively by contraction of muscles in the head. However, experimental evidence on this issue is not decisive (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>) and we do not consider this scenario here.</p></sec><sec id="s2-4"><title>Environmental mechanics: substrate frictional coupling</title><p>Directed rectilinear locomotion is a consequence of body contraction coupled to the anisotropic and inhomogeneous friction of the body relative to the substrate. Frictional inhomogeneity arises as segments are lifted off the ground when they contract (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>), allowing them to slip and providing the organism active control of friction. Indeed, activity of the muscles that coordinate segment lifting are synchronized with the activity of muscles that provide contractile forces in the segment (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>). Consistent with this, we assume that the frictional resistance <inline-formula><mml:math id="inf44"><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:math></inline-formula> vanishes when <inline-formula><mml:math id="inf45"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is above a threshold, i.e.<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mtext>sign</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mtr><mml:mlabeledtr><mml:mtd id="mjx-eqn-5_2"><mml:mtext>(5)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mtext>sign</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:math></inline-formula> is the maximum frictional force, <inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi id="XM111">f</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mi id="XM112">tanh</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM113"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>g</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:math></inline-formula> is the gain, and <inline-formula><mml:math id="inf49"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> is the threshold segmental muscular force associated with segment lifting and the resulting vanishing of friction. This nonlinear frictional interaction is different from that in our earlier minimal model (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>) where the strength of friction was dependent on the direction of motion. Again, the last equation describes the head-tail coupling. We note that the frictional interaction of the body with the substrate decouples segments far from each other both mechanically (due to inhomogeneous deformation) and neurally (due to inhomogeneous proprioception). Manipulating the body-substrate coupling by changing <inline-formula><mml:math id="inf50"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> allows us to make experimentally testable predictions for gait changes.</p><p><xref ref-type="disp-formula" rid="equ1">Equations (1–5)</xref> characterize the coupled neuromechanics of the larva linking the brain, body and environment by incorporating the neural dynamics that induces muscle contraction, the passive and active mechanics of the body, and the frictional interaction with the substrate on which the maggot moves, and the various interactions between these subsystems. Together with initial conditions, this completes the formulation of the problem. Our differential equations have strong nonlinearities associated with the sigmoids, which makes them numerically stiff. Introducing small inertial contributions for the segments allow us to use explicit numerical integration schemes encoded in MATLAB, although our results are robust with respect to changes in this parameter (see Appendix 2). We note that our numerical solution method differs from that used in (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan (2014)</xref>), where a continuum limit (when the number of segments is large) was taken first to derive a partial differential equation that was then solved numerically.</p></sec><sec id="s2-5"><title>Parameters</title><p>Our model is characterized by a number of dimensionless parameters that are given by the dimensionless damping <inline-formula><mml:math id="inf51"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, the scaled maximum frictional force <inline-formula><mml:math id="inf52"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, the scaled maximum muscular force <inline-formula><mml:math id="inf53"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, the scaled threshold muscular force that causes segment lifting <inline-formula><mml:math id="inf54"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, the activation thresholds for neural populations <inline-formula><mml:math id="inf55"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub></mml:math></inline-formula>, the activation threshold for muscular forces <inline-formula><mml:math id="inf57"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>, the scaled segment displacement <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, neural network weights <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the gains <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>g</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>g</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:math></inline-formula> and the scaled muscular relaxation time scale and inhibitory time scale <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. All our results are reported in units of segment length <inline-formula><mml:math id="inf72"><mml:mi>L</mml:mi></mml:math></inline-formula>, neural excitation time constant <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> and body stiffness <inline-formula><mml:math id="inf74"><mml:mi>k</mml:mi></mml:math></inline-formula>. To initiate crawling, we apply a rectangular pulse of height 0.61 for a duration of <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> to the appropriate segment's excitatory neuron.</p><p>The dimensionless parameters in the problem were adjusted to approximate the quantitative results reported in (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>), and reproduce the effects of optogenetic perturbations of neural activity in the VNC (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>; <xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>) (<xref ref-type="table" rid="tbl1">Table 1</xref>). First, the VNC model parameters were chosen so that the VNC by itself could produce repeated propagation of activity. We made sure that the VNC was configured much below the maximum excitation it can carry, to make room for the additional proprioceptive input when the full model is put together. Next, the scaled muscular force was chosen so that <inline-formula><mml:math id="inf76"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> for stability, and to allow for the large contractions observed in crawling without proprioception. Finally, the scaled friction force was chosen so that <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to avoid slippage. Together, this allowed us to find a stable crawling solution that matches experimental results (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>; <xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>).<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.004</object-id><label>Table 1.</label><caption><p>Dimensionless parameters of our model and their default values used in numerical simulations.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.004">http://dx.doi.org/10.7554/eLife.11031.004</ext-link></p></caption><table frame="hsides" rules="groups"><tbody><tr><th><inline-formula><mml:math id="inf78"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula></th><td>3.5</td><th><inline-formula><mml:math id="inf79"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula></th><td>5/6</td><th><inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></th><td>0.4</td></tr><tr><th><inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula></th><td>25/3</td><th><inline-formula><mml:math id="inf82"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula></th><td>5/12</td><th><inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></th><td>3</td></tr><tr><th><inline-formula><mml:math id="inf84"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>1</td><th><inline-formula><mml:math id="inf85"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>-2</td><th><inline-formula><mml:math id="inf86"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>0.6</td></tr><tr><th><inline-formula><mml:math id="inf87"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>0</td><th><inline-formula><mml:math id="inf88"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>0.6</td><th><inline-formula><mml:math id="inf89"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>1.95</td></tr><tr><th><inline-formula><mml:math id="inf90"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>1.95</td><th><inline-formula><mml:math id="inf91"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula></th><td>0.4</td><th><inline-formula><mml:math id="inf92"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi id="XM114">E</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM115">I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>0.6</td></tr><tr><th><inline-formula><mml:math id="inf93"><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula></th><td>-17/18</td><th><inline-formula><mml:math id="inf94"><mml:msub><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula></th><td>40000</td><th><inline-formula><mml:math id="inf95"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi id="XM116">f</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM117">p</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM118">F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></th><td>1000</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="s3" sec-type="results"><title>Results</title><p>We start with a quantitative description of our model results and their comparison to experiments before turning to make testable predictions.</p><sec id="s3-1"><title>Experimental validation of the model</title><sec id="s3-1-1"><title>The model produces sustained crawling with metrics matching experiments</title><p>Crawling is initiated with a short excitatory pulse to the excitatory neural population in the most posterior segment. We do not model the source of this initiation command; it could be, for instance, a descending signal from the brain initiating forward movement or sensory feedback from the tail initiating an escape. This yields a sustained crawling gait shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>, where a kymograph of body segments of the larva (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) as well as the corresponding muscular (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) and neural activity (<xref ref-type="fig" rid="fig2">Figure 2C</xref>) are shown (also see <xref ref-type="other" rid="media2">Video 2</xref>). We see that head and tail segments move together in the visceral piston phase (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="bib39">Simon et al., 2010</xref>), followed by a peristaltic wave with neural activity leading in phase, followed by muscular and contraction activity (<xref ref-type="fig" rid="fig2">Figure 2</xref>), propagating from posterior to anterior segments. Crawling can be stopped by shutting down the activity of excitatory neurons in the most posterior segment by an inhibitory input (see also section 3.1.2).<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.005</object-id><label>Figure 2.</label><caption><title>Sustained crawling.</title><p>Time is in units of <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula>. Model is simulated for <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>500</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, only first <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is shown. All simulations were based on <xref ref-type="disp-formula" rid="equ1">Equations (1–5)</xref>, with parameter values as specified in the <xref ref-type="table" rid="tbl1">Table 1</xref>. Shade shows the duration of an example peristaltic wave. (<bold>A</bold>) Kymograph of body segments. Distance is measured in units of <inline-formula><mml:math id="inf99"><mml:mi>L</mml:mi></mml:math></inline-formula>. (<bold>B</bold>) Muscular forces in segments. Same color code is used as in the <bold>A</bold>). (<bold>C</bold>) Neural activity in segments. Solid line denotes excitatory neuron population activity, and dashed lines denote inhibitory population. Same color code is used as in the A)</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.005">http://dx.doi.org/10.7554/eLife.11031.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11031-fig2-v1"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="media2" mime-subtype="mp4" mimetype="video" xlink:href="elife-11031-media2.mp4"><object-id pub-id-type="doi">10.7554/eLife.11031.006</object-id><label>Video 2.</label><caption><title>Crawling simulations of full model larva.</title><p>To illustrate the changes in friction, body segments are drawn off the ground when <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> exceeds <inline-formula><mml:math id="inf101"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.006">http://dx.doi.org/10.7554/eLife.11031.006</ext-link></p></caption></media></p><p>Our simulations show that the larva produces approximately 0.04 waves per unit time associated with the relaxation of the excitatory neurons <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula>, where waves start when the tail moves off the ground, leading to a larval speed ≈<inline-formula><mml:math id="inf103"><mml:mrow><mml:mrow><mml:mn>0.04</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Hughes and Thomas (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>) found that third instar larvae of typical length <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>≈4 mm (estimated from <xref ref-type="fig" rid="fig1">Figure 1</xref> of (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>)) produce ≈1.5 waves/s. Using this latter number, we can estimate the time scale: <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula>≈25 ms, a reasonable time constant for activity of neural populations. Combining the time scale estimate and the length of the third instar larvae, our model predicts a speed of ≈0.5 mm/s, comparable with the observed speed of ≈1 mm/s (estimated from Figure 1 of <xref ref-type="bibr" rid="bib21">Hughes and Thomas, [2007</xref>]). In another experiment, for first instar larvae with typical length <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>10</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>≈600 μm (estimated from Figure 1 of <xref ref-type="bibr" rid="bib19">Heckscher et al. [2012</xref>]), Heckscher et. al. <xref ref-type="bibr" rid="bib19">Heckscher et al. (2012)</xref> give a range of 0.5 <underline>−</underline> 1.5 waves produced per second, which suggests the neural time scale range <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>≈25 <underline>−</underline> 75 ms, again a reasonable time constant range. Combining the time scale estimate and the length of the first instar larvae, our model predicts a speed range of ≈30 <underline>−</underline> 90 <underline>μ</underline>m/s, in agreement with the range reported in (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>): ≈40 − 125 μm/s. Our simulations show that typically (median across time steps), three segments are off the ground, defined by the number of segments in which <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is above <inline-formula><mml:math id="inf109"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and thus friction vanishes, consistent with observations (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>). Furthermore, we find that peak segmental contraction, averaged over segments and waves, is ≈30%, consistent with observations (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>).</p></sec><sec id="s3-1-2"><title>The model reproduces the effects of optogenetic VNC perturbations</title><p>Our model shows that normal segment-to-segment propagation of activity arises through two different but coordinated channels, the posterior-to-anterior neural coupling between excitatory populations in adjacent segments, and via proprioceptive coupling (<xref ref-type="fig" rid="fig1">Figure 1C and D</xref>). Experimental perturbations of these channels are known to change the crawling modalities.</p><p>For example, recent advances in optogenetics have allowed for targeted manipulations of specific neuron types in the VNC (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>; <xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Itakura et al., 2015</xref>). When segment-to-segment propagation was perturbed with optogenetic inhibition of motor neurons in a VNC segment (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>), crawling stopped when the wave reached that segment. Conversely, when the inhibition is removed after up to <inline-formula><mml:math id="inf110"><mml:mn>10</mml:mn></mml:math></inline-formula> s, the larva resumed crawling from the same segment. To see whether this observation is reproduced in our model, we performed an acute shutdown of the excitatory population in a segment, modeling the effect of optogenetic inhibition on motor neurons. <xref ref-type="fig" rid="fig3">Figure 3A–C</xref> and <xref ref-type="other" rid="media3">Video 3</xref> show the results of this simulation. Crawling is stopped at segment A6 (<inline-formula><mml:math id="inf111"><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula>) by setting <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> when <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn id="XM119">65</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM120">95</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We note that crawling continues in this time frame until it reaches segment A6, consistent with that observed experimentally (Figure 7 of (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>)). Additionally, even after crawling stops, contraction of the body segment <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> keeps producing proprioceptive input to <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>E</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>I</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></inline-formula>. This can be seen by the sustained activity of <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>I</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></inline-formula> during stopping, while the activity of <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>E</mml:mi><mml:mn>9</mml:mn></mml:msub></mml:math></inline-formula> dies out. When the optogenetic inhibition is removed, allowing <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>E</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> to evolve according to its normal dynamics (<xref ref-type="disp-formula" rid="equ1">Equation (1)</xref>), proprioceptive input drives <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>E</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> to firing and the larva resumes crawling from A6.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.007</object-id><label>Figure 3.</label><caption><title>Perturbations of VNC.</title><p>Top row: <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>E</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> is inhibited for <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn id="XM123">65</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM124">95</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, shown in purple. Bottom row: <inline-formula><mml:math id="inf123"><mml:msub><mml:mi>I</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> is maximally excited in the range <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn id="XM125">65</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM126">95</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, shown in purple. Color code and parameters are the same as <xref ref-type="fig" rid="fig1">Figure 1</xref>. (<bold>A</bold>) and (<bold>D</bold>) Kymograph of body segments. (<bold>B</bold>) and (<bold>E</bold>) Muscular forces in segments. (<bold>C</bold>) and (<bold>F</bold>) Neural activity in segments. We note that in these simulations, crawling is started at <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> with an excitatory pulse applied to <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>E</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></inline-formula> of the stationary larva, demonstrating that our model allows for the peristaltic wave to start at any segment.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.007">http://dx.doi.org/10.7554/eLife.11031.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11031-fig3-v1"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="media3" mime-subtype="mp4" mimetype="video" xlink:href="elife-11031-media3.mp4"><object-id pub-id-type="doi">10.7554/eLife.11031.008</object-id><label>Video 3.</label><caption><title>Crawling simulations of full model larva.</title><p>Cycle is started at A4 and temporarily stopped at A6 by inhibiting the excitatory population.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.008">http://dx.doi.org/10.7554/eLife.11031.008</ext-link></p></caption></media></p><p>In our model (<xref ref-type="fig" rid="fig3">Figure 3</xref>), during a stop, the memory of crawling phase is kept in the contraction of the body and the proprioceptive channel which drives the proprioceptive activity. In Inada <italic>et. al.</italic>’s experiments (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>), it is possible to resume crawling even after the neighboring posterior segment to the one being inhibited completes a contraction and relaxes back to its equilibrium length (Figure 7 of (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>)). Hence, Inada <italic>et. al.</italic> propose that the memory is held in the VNC. At first this might seem to contradict our result that the memory is kept in the body and the proprioceptive channel, but, although our model does not include such mechanism, it is possible for the proprioceptive neurons to exhibit self-sustained activity and be the location of memory. We also want to point that in (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>) the memory can last as long as 10 s. Whether in the VNC or in the proprioceptive neurons, the mechanism that creates such long time intervals from neural time scales of a few tens of milliseconds is an open problem.</p><p>More recent experimental studies (<xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Itakura et al., 2015</xref>) identified pre-motor inhibitory neuron populations that play a role in locomotion. Specifically, during forward crawling, period-positive median segmental interneurons (PMSIs) were found to be activated slightly later than the motor neurons in the same segment (<xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>) and their optogenetic activation leads to inhibition of motor neuron activity locally, arresting peristaltic crawling. These observations match nicely with the dynamics of the inhibitory neurons in our model, which are activated slightly later than the excitatory neurons in the same segment (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Further, increasing their activity above what is normally seen during normal crawling led to the local arrest of crawling. In <xref ref-type="fig" rid="fig3">Figure 3D–F</xref> and <xref ref-type="other" rid="media4">Video 4</xref>, we show the results of a simulation where crawling is stopped at segment A6 (<inline-formula><mml:math id="inf127"><mml:msub><mml:mi>u</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula>) by setting <inline-formula><mml:math id="inf128"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>8</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the maximum inhibitory population activity in our model, over the time period <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn id="XM121">65</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM122">95</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Increased inhibitory neuron activity prevents the excitatory neurons from becoming active and stops the peristaltic wave. This causes the behavior of the model to be similar to the previous case where <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>E</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> was shut down, except that here <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>I</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> is active in the time frame of perturbation. When <inline-formula><mml:math id="inf132"><mml:msub><mml:mi>I</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> is left to evolve according to to its normal dynamics (<xref ref-type="disp-formula" rid="equ1">Equation (1)</xref>), proprioceptive input drives <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>E</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:math></inline-formula> to fire and larva resumes crawling from A6.<media content-type="glencoe play-in-place height-250 width-310" id="media4" mime-subtype="mp4" mimetype="video" xlink:href="elife-11031-media4.mp4"><object-id pub-id-type="doi">10.7554/eLife.11031.009</object-id><label>Video 4.</label><caption><title>Crawling simulations of full model larva.</title><p>Cycle is started at A4 and temporarily stopped at A6 by exciting the inhibitory population.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.009">http://dx.doi.org/10.7554/eLife.11031.009</ext-link></p></caption></media></p><p>In the optogenetic inhibition experiments of <xref ref-type="bibr" rid="bib26">Kohsaka et al. (2014)</xref>, when the activation of PMSIs is removed, the peristaltic wave did not continue from the inhibited segment, but a new wave from the posterior end started. This is in contrast to our model, where crawling continues from the inhibited segment. Other observations on PMSIs (<xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>) that remain to be incorporated into future models are: when inhibited using genetic and optogenetic methods, speed of peristalsis greatly decreased, duration of motor neuron bursting and muscle contraction increased however degree of segmental contraction did not change.</p></sec><sec id="s3-1-3"><title>The model reproduces effects of silencing proprioception</title><p>In another set of experiments, it was shown that silencing proprioceptive feedback to VNC using genetic (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib41">Suster and Bate, 2002</xref>) and optogenetic (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>) methods leads to an increase in peak segmental contraction from ≈30% to ≈65% (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>), and a reduction in rate to approximately one fourth (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>) and to one tenth (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>), and reduced speed (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>). To understand this, we implemented a purely neural coupling in our model by setting proprioceptive couplings <inline-formula><mml:math id="inf134"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf135"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. With purely neural coupling, the model still produces sustained crawling but with a qualitative change in the crawling pattern (<xref ref-type="fig" rid="fig4">Figure 4</xref> and <xref ref-type="other" rid="media5">Video 5</xref>). Only a single segment is off-the-ground at a time, while peak segmental contraction, averaged over all segments, increases to ≈65% of segmental length (≈70% for only A3-A4 segmental distance, <xref ref-type="fig" rid="fig4">Figure 4E</xref>) the larva produces a reduced rate of ≈0.01 waves per <inline-formula><mml:math id="inf136"><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> and moves with speed <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4A and D</xref>), in agreement with experiments. Furthermore, we see that inhibitory neural dynamics show a significant modulation, due to the removal of excitatory proprioceptive input to these populations, and peak activity of inhibitory population is reduced and delayed, as shown in <xref ref-type="fig" rid="fig4">Figure 4C</xref>. However, the phases of muscular and neural activity within a wave do not change, but the contraction phase is slightly earlier (<xref ref-type="fig" rid="fig4">Figure 4F</xref>).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.010</object-id><label>Figure 4.</label><caption><title>Sustained crawling without proprioception.</title><p>The absence of proprioception induces slower crawling. In the lower panels, “p.” denotes crawling with proprioception, 'np.' denotes crawling without proprioception. (<bold>A</bold>) Kymograph of body segments. (<bold>B</bold>) Muscular forces in segments. (<bold>C</bold>) Neural activity in segments. (<bold>D</bold>) Kymograph of A4 segment (<inline-formula><mml:math id="inf138"><mml:msub><mml:mi>u</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:math></inline-formula>) in the full model vs. the model without proprioceptive feedback. (<bold>E</bold>) Peak contraction of A3-A4 (<inline-formula><mml:math id="inf139"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) segmental distance averaged over waves. Here, we plot only one segment interval as in (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>) to ease comparison. (<bold>F</bold>) Phases of (excitatory) neural, muscular and contraction activity in different segments within a wave, with respect to excitatory neuron activity in tail segment. To calculate phases, first Discrete Fourier Transform of the relevant signal is obtained. Phase is the negative complex phase of the fundamental frequency. Contraction of a segment is the difference between its and next anterior neighbor segment’s center of mass displacements.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.010">http://dx.doi.org/10.7554/eLife.11031.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11031-fig4-v1"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="media5" mime-subtype="mp4" mimetype="video" xlink:href="elife-11031-media5.mp4"><object-id pub-id-type="doi">10.7554/eLife.11031.011</object-id><label>Video 5.</label><caption><title>Crawling simulations of larva with silenced proprioception.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.011">http://dx.doi.org/10.7554/eLife.11031.011</ext-link></p></caption></media></p></sec></sec><sec id="s3-2"><title>Predictions</title><sec id="s3-2-1"><title>Role of proprioceptive coupling</title><p>We tried the converse of silencing proprioception, and implemented a purely proprioceptive coupling with no neural coupling by setting the posterior-to-anterior neural coupling <inline-formula><mml:math id="inf140"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In this case, we find that our model produces sustained crawling almost identical to what is shown in <xref ref-type="fig" rid="fig2">Figure 2</xref> (see also below) where both channels are intact. This shows that a spatially coordinated CPG is not necessary for crawling, as was also suggested and shown in the simpler model put forward in (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>). While this might not be biologically realistic in an adult, our model shows that this plausible arrangement might be relevant in engineering coordinated locomotion, and even of some interest in an evolutionary or developmental setting.</p><p>The relative insensitivity of our model to variations in the parameters that describe neural coupling and the qualitative changes that result from silencing proprioception led us to investigate the stabilizing effect of proprioception in more detail. To this end, we varied posterior-to-anterior neural coupling, <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and investigated its effect when proprioception was silenced or intact. In <xref ref-type="fig" rid="fig5">Figure 5</xref>, we quantify various metrics characterizing the dynamics of the segments. As a function of <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <xref ref-type="fig" rid="fig5">Figure 5A</xref> shows the frequency of peristaltic waves which increases with <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>: stronger neural coupling leads to faster propagation of peristaltic wave. While higher frequency of peristaltic waves leads to faster locomotion as shown in <xref ref-type="fig" rid="fig5">Figure 5B</xref>, the relationship between speed and wave frequency is not linear as the size of step taken per peristaltic wave also increases with <inline-formula><mml:math id="inf144"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, see <xref ref-type="fig" rid="fig5">Figure 5C</xref>. <xref ref-type="fig" rid="fig5">Figure 5D</xref> shows that peak contraction falls as <inline-formula><mml:math id="inf145"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increases and <xref ref-type="fig" rid="fig5">Figure 5E</xref> shows that the number of simultaneously off-ground segments increases as <inline-formula><mml:math id="inf146"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increases: faster peristaltic waves leave less time for segments to contract.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.012</object-id><label>Figure 5.</label><caption><title>Proprioception increases robustness of crawling.</title><p>Crawling metrics as a function of <inline-formula><mml:math id="inf147"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. In dashed-red, we show the results from the model without proprioceptive feedback (np.), while in blue and black, we show the results with proprioception (p.) based on <xref ref-type="disp-formula" rid="equ1">Equation (1–5)</xref> with parameter values as described in the <xref ref-type="table" rid="tbl1">Table 1</xref>. (<bold>A</bold>) Peristaltic waves per unit time (<inline-formula><mml:math id="inf148"><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula>). (<bold>B</bold>) Speed of crawling in units of <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) Step size, defined as the tail displacement divided by number of waves. It is measured in units of (L) <bold>D</bold>) Peak contraction in a segment, averaged over segments and waves. E) Number of simultaneously off-ground segments. This number is calculated at each time step, and the median number across time steps are plotted. (<bold>F</bold>) Propagation delays through neural and proprioceptive channels (see text for a detailed discussion) are shown. 'n-to-n' denotes neuron propagation delay. 'n-to-p' denotes proprioceptive propagation delay.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.012">http://dx.doi.org/10.7554/eLife.11031.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11031-fig5-v1"/></fig></p><p>This manipulation suggests that proprioception increases robustness of locomotory behavior in two distinct ways. First, there is a wider range of neural coupling over which sustained crawling can be achieved. When proprioception is silenced, there is a minimum value of <inline-formula><mml:math id="inf150"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> below which crawling is not possible, due to neural coupling being too weak to excite the neural population in the next segment (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Proprioception provides the extra excitation that allows for sustained crawling till the neural coupling weight <inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Second, in all metrics that we used to characterize crawling, the observed changes as a function of <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was smaller when proprioception was intact (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Thus, proprioception has a stabilizing effect on crawling. <xref ref-type="bibr" rid="bib16">Gjorgjieva et al. (2013)</xref> came to a similar conclusion with their purely neural model.</p><p>In <xref ref-type="fig" rid="fig5">Figure 5</xref> all metrics of crawling with and without proprioception show a cross-over around <inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.65</mml:mn></mml:mrow></mml:math></inline-formula>, which also sets the threshold below which sustained crawling in the full model shows no dependence on <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. To understand these further, we investigate the propagation delays through both the neural and proprioceptive channels. In <xref ref-type="fig" rid="fig5">Figure 5F</xref>, we plot three quantities: 1) the time it takes for excitatory neurons in neighboring segments to cross <inline-formula><mml:math id="inf155"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> (threshold to activate muscular forces) in the presence of proprioception (blue line), which quantifies segment-to-segment signal propagation delay, 2) the time for supra-threshold activation of excitatory neurons without proprioception (dashed red line), which quantifies the propagation delay through the neural channel, and 3) the time it takes for the excitatory population in a segment to cross <inline-formula><mml:math id="inf156"><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> and the turning on of proprioceptive signal in that population (black line), which quantifies the propagation delay through the proprioceptive channel. We see that segment-to-segment signal propagation in the full model follows the faster channel, while in the proprioception silenced model it always follows the neural channel. Proprioceptive propagation delay becomes comparable to neural propagation delay around <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.65</mml:mn></mml:mrow></mml:math></inline-formula>, the threshold when the metrics of crawling with and without proprioception cross-over. Below this threshold, proprioception is faster, explaining why the full model is insensitive to <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Above this threshold, neural propagation is faster, but proprioception still has a stabilizing effect in this regime because of its inhibitory effect on the neural activity in the moving segment, neutralizing strong excitation. Furthermore, the proprioceptive channel gets slower beyond the cross-over point: it takes longer for a segment to contract to the proprioceptive threshold point. This is consistent with decreased peak contraction and increased number of simultaneously moving segments.</p><p>Our results with varied proprioceptive coupling lead us to make the following predictions:</p><list list-type="order"><list-item><p>Crawling without any direct segment-to-segment coupling in the VNC is possible by segment-to-segment transmission of activity through the proprioceptive channel (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p></list-item><list-item><p>Variation in parameters can be associated with variations across individuals in a population. Then, there should be much more variability in crawling metrics among individuals with silenced or weakened proprioception, a testable prediction using existing genetic tools (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>).</p></list-item><list-item><p>Our model predicts that in the presence of proprioception, increase in neural coupling leads to higher speeds, as was also observed in (<xref ref-type="bibr" rid="bib16">Gjorgjieva et al., 2013</xref>) in a purely neural model. In an analogous scenario in stick insects, experiments suggest that slow, steady-walking is mainly coordinated by local proprioceptive signals but faster motion is driven by increased neural coupling between legs (<xref ref-type="bibr" rid="bib5">Büschges, 2012</xref>). Then, our model suggests that the larva might modulate the strength of neural coupling to control speed. This suggestion brings accompanying predictions which can be read directly from <xref ref-type="fig" rid="fig5">Figure 5</xref>, e.g. faster speed comes with decreased peak contraction and a higher number of simultaneously off-ground segments.</p></list-item></list></sec><sec id="s3-2-2"><title>Role of body-substrate frictional coupling</title><p>To quantify the effect of the environment on the locomotion, we varied the maximum scaled frictional force, <inline-formula><mml:math id="inf159"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> between body and the substrate. Our results are shown in <xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="other" rid="media6">Video 6</xref>. Our main observation is that metrics of crawling are robust until friction falls below a threshold (<inline-formula><mml:math id="inf160"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>), when muscular forces become stronger than friction, leading to slippage. At this point the number of moving segments start differing from number of off-ground segments (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). An example kymograph from the slipping regime (<inline-formula><mml:math id="inf161"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula>), and corresponding muscular and neural activities are shown in <xref ref-type="fig" rid="fig6">Figure 6A</xref> and <xref ref-type="other" rid="media6">Video 6</xref>. Below the threshold, number of peristaltic waves per unit time drops (<xref ref-type="fig" rid="fig6">Figure 6B</xref>), as is confirmed by increased segment-to-segment propagation delay in the VNC (<xref ref-type="fig" rid="fig6">Figure 6G</xref>). Thus we see an effect on neural propagation due to a change in the mechanical interaction with the substrate, clearly showing how we cannot ignore the triad of nervous system-body-substrate in continuous conversation with each other. The speed of the larva (<xref ref-type="fig" rid="fig6">Figure 6C</xref>) also follows an interesting trend; with decreasing friction, speed first increases due to larger step sizes (<xref ref-type="fig" rid="fig6">Figure 6D</xref>), even though the frequency of peristaltic waves decreases (<xref ref-type="fig" rid="fig6">Figure 6B</xref>), but eventually saturates. Peak contraction of segments increase (<xref ref-type="fig" rid="fig6">Figure 6E</xref>) with decreased friction. These effects on behavior are clear testable predictions of our model.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.013</object-id><label>Figure 6.</label><caption><title>Decreasing friction leads to slippage.</title><p>(<bold>A</bold>) Kymograph, muscular forces and neural activity as a function of time for <inline-formula><mml:math id="inf162"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula>. See <xref ref-type="fig" rid="fig2">Figure 2</xref> and text for explanation of plots. (<bold>B</bold>,<bold>C</bold>,<bold>D</bold>,<bold>E</bold>) Crawling metrics as a function of <inline-formula><mml:math id="inf163"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. See <xref ref-type="fig" rid="fig5">Figure 5</xref> and text for explanation of plots.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.013">http://dx.doi.org/10.7554/eLife.11031.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11031-fig6-v1"/></fig><media content-type="glencoe play-in-place height-250 width-310" id="media6" mime-subtype="mp4" mimetype="video" xlink:href="elife-11031-media6.mp4"><object-id pub-id-type="doi">10.7554/eLife.11031.014</object-id><label>Video 6.</label><caption><title>Crawling simulations of larva with low friction.<inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>0.005.</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula></title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.014">http://dx.doi.org/10.7554/eLife.11031.014</ext-link></p></caption></media></p></sec></sec></sec><sec id="s4" sec-type="discussion"><title>Discussion</title><p>Our theoretical model for the forward crawling of a <italic>D. melanogaster</italic> larva incorporates the coupled mechanics of the soft body, the neural dynamics of VNC and frictional interactions with the substrate, complementing earlier isolated studies of these sub-systems. It produces a robust, sustained crawling gait with metrics consistent with experimental findings (<xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>), and furthermore, can reproduce qualitative and quantitative changes in crawling gait due to perturbations in proprioceptive (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>) and neural (<xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>; <xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>) channels of segment-to-segment wave propagation.</p><p>A surprising finding of our model is its ability to produce sustained crawling with purely proprioceptive coupling between segments, a scenario which was first suggested by us for a very general model of crawling (<xref ref-type="bibr" rid="bib31">Paoletti and Mahadevan, 2014</xref>). While both in our model and in experiments (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib19">Heckscher et al., 2012</xref>), the larvae can crawl without any proprioception, albeit much slower, the demonstration of purely proprioceptive crawling challenges the central role of CPG in crawling locomotion. It will be interesting to see if this finding can be experimentally tested by disrupting intersegmental coupling in the VNC.</p><p>Our study suggests that proprioception increases the robustness of crawling by effectively stabilizing segment-to-segment neural coupling. Interpreting this variation in parameters to that due to variations across individuals in a population, we predict that there should be much more variability in crawling metrics among individuals with silenced or weakened proprioception, a scenario amenable to testing using existing genetic tools (<xref ref-type="bibr" rid="bib21">Hughes and Thomas, 2007</xref>; <xref ref-type="bibr" rid="bib23">Inada et al., 2011</xref>).</p><p>In the context of body-nervous system coupling, proprioception is necessary for adaptive behavior, but are both neural and proprioceptive intersegmental coupling needed, since crawling is possible with only one of them? Neural coupling may be used to control speed. Indeed, our model predicts that increase in neural coupling leads to higher speeds, even in the presence of proprioception. This suggestion is supported by experiments in stick insects, which show that slow, steady-walking is mainly coordinated by local proprioceptive signals but faster motion is driven by increased neural coupling between legs (<xref ref-type="bibr" rid="bib5">Büschges, 2012</xref>).</p><p>Our model makes testable predictions on how crawling should change if body-substrate coupling is modified. In particular, decreasing friction below slippage threshold should lead to a higher speed with larger step sizes but a smaller number of waves per unit time, another testable prediction.</p><p>Our minimal model makes a number of assumptions and simplifications. Improvements, some of which are already pointed out, will be necessary to describe forward crawling as more experiments become available. For example, in a very recent experiment (<xref ref-type="bibr" rid="bib24">Itakura et al., 2015</xref>), a new class of pre-motor inhibitory neurons, Glutamatergic Ventro-Lateral Interneurons (GVLIs), were identified (glutamate inhibits larva motor neurons (<xref ref-type="bibr" rid="bib36">Rohrbough and Broadie, 2002</xref>)), which ceased locomotion in the same segment when optogenetically activated. During unperturbed peristaltic wave propagation, GVLIs’ activation lagged motor neurons by several segments, suggesting that GVLIs provide a contraction termination signal when the wave reaches anterior segments. In contrast, inhibitory neurons of our model get activated slightly later than the excitatory neurons in the same segment, and receive proprioceptive input only from the same segment. Therefore, our current model does not take into account the role of GLVIs in locomotion. Some other points of improvement could be moving beyond linear mechanics, taking into account different muscles, introducing dynamics for stretch receptors, incorporating observations on PMSI’s (<xref ref-type="bibr" rid="bib26">Kohsaka et al., 2014</xref>), including further specialized neuron types and accompanying connectivity profiles in a segment of the VNC, introducing possible long range intersegmental neural and proprioceptive connections, and using more sophisticated parameter fitting procedures.</p><p>Our integrated approach suggests generalizations that can move us beyond prograde rectilinear locomotion. Backward crawling, for instance, could be achieved by a separate neural circuit running from anterior-to-posterior, perhaps similar to that in <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib18">Haspel et al., 2010</xref>), or by introducing anterior to posterior neural coupling between individual segments as in the model of <xref ref-type="bibr" rid="bib16">Gjorgjieva et al. (2013)</xref>. Additional extensions of the body mechanics to account for bending by differential movement of hemisegments, and a bilateral VNC, similar to that in (<xref ref-type="bibr" rid="bib16">Gjorgjieva et al., 2013</xref>), allowing for propagation of neural excitation in opposite directions in different hemisegments will allow us to account for turning, and thus the larger behavioral repertoire of <italic>Drosophila</italic> larvae (<xref ref-type="bibr" rid="bib46">Vogelstein et al., 2014</xref>).</p><p>Finally, our model naturally suggests novel biomimetic designs for robotics crawlers. In fact, the interest in soft robots has significantly grown in the last few years thanks to these systems’ capability of moving in uncertain environments, a daunting task for traditional rigid robots. For example <xref ref-type="bibr" rid="bib4">Boyle et al., (2013)</xref> presented a proprioceptive-driven articulated crawler based on <italic>C. elegans</italic> morphology and showed that it is able to navigate arenas with unknown obstacles without requiring complex sensory capability. On the other hand, Trimmer and colleagues are developing a soft platform to build artificial crawlers, see for example (<xref ref-type="bibr" rid="bib44">Umedachi et al., 2013</xref>) and (<xref ref-type="bibr" rid="bib25">Kim et al., 2013</xref>) for a review of current attempts. Our model can then be exploited to merge soft robotics and proprioception to create novel biomimetic crawlers with an electromechanical circuit implementing force production and proprioception in a soft gel.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank E Heckscher for providing us a movie of crawling in <italic>D. melanogaster</italic> larvae, J Gjorgjieva, H Lacin, S Pulver, A Samuel, B Afonso and A Zarin for discussions, the anonymous reviewers for constructive comments and suggestions, and the Swartz Foundation (CP), and the MacArthur Foundation (LM) for partial financial support.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>CP, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>PP, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>LM, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berni</surname><given-names>J</given-names></name><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Griffith</surname><given-names>LC</given-names></name><name><surname>Bate</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Autonomous circuitry for substrate exploration in freely moving Drosophila larvae</article-title><source>Current Biology</source><volume>22</volume><fpage>1861</fpage><lpage>1870</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.07.048</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boxerbaum</surname><given-names>AS</given-names></name><name><surname>Shaw</surname><given-names>KM</given-names></name><name><surname>Chiel</surname><given-names>HJ</given-names></name><name><surname>Quinn</surname><given-names>RD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Continuous wave peristaltic motion in a robot</article-title><source>The International Journal of Robotics Research</source><volume>31</volume><fpage>302</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1177/0278364911432486</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyle</surname><given-names>JH</given-names></name><name><surname>Berri</surname><given-names>S</given-names></name><name><surname>Cohen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Gait Modulation in C. elegans: An Integrated Neuromechanical Model</article-title><source>Frontiers in Computational Neuroscience</source><volume>6</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2012.00010</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyle</surname><given-names>JH</given-names></name><name><surname>Johnson</surname><given-names>S</given-names></name><name><surname>Dehghani-Sanij</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Adaptive Undulatory Locomotion of a C. elegans Inspired Robot</article-title><source>IEEE/ASME Transactions on Mechatronics</source><volume>18</volume><fpage>439</fpage><lpage>448</lpage><pub-id pub-id-type="doi">10.1109/TMECH.2012.2210728</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Büschges</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Lessons for circuit function from large insects: towards understanding the neural basis of motor flexibility</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>602</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2012.02.003</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cang</surname><given-names>J</given-names></name><name><surname>Friesen</surname><given-names>WO</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Model for intersegmental coordination of leech swimming: central and sensory mechanisms</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>2760</fpage><lpage>2769</lpage></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiel</surname><given-names>HJ</given-names></name><name><surname>Ting</surname><given-names>LH</given-names></name><name><surname>Ekeberg</surname><given-names>O</given-names></name><name><surname>Hartmann</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The brain in its body: motor control and sensing in a biomechanical context</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>12807</fpage><lpage>12814</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3338-09.2009</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crisp</surname><given-names>S</given-names></name><name><surname>Evers</surname><given-names>JF</given-names></name><name><surname>Fiala</surname><given-names>A</given-names></name><name><surname>Bate</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The development of motor coordination in Drosophila embryos</article-title><source>Development</source><volume>135</volume><fpage>3707</fpage><lpage>3717</lpage><pub-id pub-id-type="doi">10.1242/dev.026773</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crisp</surname><given-names>SJ</given-names></name><name><surname>Evers</surname><given-names>JF</given-names></name><name><surname>Bate</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Endogenous patterns of activity are required for the maturation of a motor network</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>10445</fpage><lpage>10450</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0346-11.2011</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daun-Gruhn</surname><given-names>S</given-names></name><name><surname>Tóth</surname><given-names>TI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>An inter-segmental network model and its use in elucidating gait-switches in the stick insect</article-title><source>Journal of Computational Neuroscience</source><volume>31</volume><fpage>43</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0300-1</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekeberg</surname><given-names>O</given-names></name><name><surname>Grillner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Simulations of neuromuscular control in lamprey swimming</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>354</volume><fpage>895</fpage><lpage>902</lpage><pub-id pub-id-type="doi">10.1098/rstb.1999.0441</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekeberg</surname><given-names>Ö</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>A combined neuronal and mechanical model of fish swimming</article-title><source>Biological Cybernetic</source><volume>69</volume><fpage>363</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1007/bf01185408</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fox</surname><given-names>LE</given-names></name><name><surname>Soll</surname><given-names>DR</given-names></name><name><surname>Wu</surname><given-names>CF</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Coordination and modulation of locomotion pattern generators in Drosophila larvae: effects of altered biogenic amine levels by the tyramine beta hydroxlyase mutation</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>1486</fpage><lpage>1498</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4749-05.2006</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fushiki</surname><given-names>A</given-names></name><name><surname>Kohsaka</surname><given-names>H</given-names></name><name><surname>Nose</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Role of sensory experience in functional development of Drosophila motor circuits</article-title><source>PloS One</source><volume>8</volume><elocation-id>e62199</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0062199</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garrey</surname><given-names>W</given-names></name><name><surname>Moore</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="1915">1915</year><article-title>Peristalsis and coordination in the earthworm</article-title><source>American Journal of Physiology</source><volume>39</volume><fpage>139</fpage><lpage>148</lpage></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gjorgjieva</surname><given-names>J</given-names></name><name><surname>Berni</surname><given-names>J</given-names></name><name><surname>Evers</surname><given-names>JF</given-names></name><name><surname>Eglen</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Neural circuits for peristaltic wave propagation in crawling Drosophila larvae: analysis and modeling</article-title><source>Frontiers in Computational Neuroscience</source><volume>7</volume><elocation-id>24</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2013.00024</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grillner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Biological pattern generation: the cellular and computational logic of networks in motion</article-title><source>Neuron</source><volume>52</volume><fpage>751</fpage><lpage>766</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.11.008</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haspel</surname><given-names>G</given-names></name><name><surname>O'Donovan</surname><given-names>MJ</given-names></name><name><surname>Hart</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Motoneurons dedicated to either forward or backward locomotion in the nematode Caenorhabditis elegans</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>11151</fpage><lpage>11156</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2244-10.2010</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heckscher</surname><given-names>ES</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name><name><surname>Doe</surname><given-names>CQ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Characterization of Drosophila larval crawling at the level of organism, segment, and somatic body wall musculature</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>12460</fpage><lpage>12471</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0222-12.2012</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holmes</surname><given-names>P</given-names></name><name><surname>Full</surname><given-names>RJ</given-names></name><name><surname>Koditschek</surname><given-names>D</given-names></name><name><surname>Guckenheimer</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The Dynamics of Legged Locomotion: Models, Analyses, and Challenges</article-title><source>SIAM Review</source><volume>48</volume><fpage>207</fpage><lpage>304</lpage><pub-id pub-id-type="doi">10.1137/S0036144504445133</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname><given-names>CL</given-names></name><name><surname>Thomas</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A sensory feedback circuit coordinates muscle activity in Drosophila</article-title><source>Molecular and Cellular Neurosciences</source><volume>35</volume><fpage>383</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1016/j.mcn.2007.04.001</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ijspeert</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Central pattern generators for locomotion control in animals and robots: a review</article-title><source>Neural Networks</source><volume>21</volume><fpage>642</fpage><lpage>653</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2008.03.014</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inada</surname><given-names>K</given-names></name><name><surname>Kohsaka</surname><given-names>H</given-names></name><name><surname>Takasu</surname><given-names>E</given-names></name><name><surname>Matsunaga</surname><given-names>T</given-names></name><name><surname>Nose</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optical dissection of neural circuits responsible for Drosophila larval locomotion with halorhodopsin</article-title><source>PLoS ONE</source><volume>6</volume><fpage>e29019</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0029019</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itakura</surname><given-names>Y</given-names></name><name><surname>Kohsaka</surname><given-names>H</given-names></name><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Nose</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Identification of Inhibitory Premotor Interneurons Activated at a Late Phase in a Motor Cycle during Drosophila Larval Locomotion</article-title><source>PLoS ONE</source><volume>10</volume><fpage>e0136660</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0136660</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Laschi</surname><given-names>C</given-names></name><name><surname>Trimmer</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Soft robotics: a bioinspired evolution in robotics</article-title><source>Trends in Biotechnology</source><volume>31</volume><fpage>287</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1016/j.tibtech.2013.03.002</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kohsaka</surname><given-names>H</given-names></name><name><surname>Takasu</surname><given-names>E</given-names></name><name><surname>Morimoto</surname><given-names>T</given-names></name><name><surname>Nose</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A group of segmental premotor interneurons regulates the speed of axial locomotion in Drosophila larvae</article-title><source>Current Biology</source><volume>24</volume><fpage>2632</fpage><lpage>2642</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.09.026</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kukillaya</surname><given-names>R</given-names></name><name><surname>Proctor</surname><given-names>J</given-names></name><name><surname>Holmes</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Neuromechanical models for insect locomotion: Stability, maneuverability, and proprioceptive feedback</article-title><source>Chaos</source><volume>19</volume><fpage>026107</fpage><pub-id pub-id-type="doi">10.1063/1.3141306</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahiri</surname><given-names>S</given-names></name><name><surname>Shen</surname><given-names>K</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>A</given-names></name><name><surname>Kane</surname><given-names>E</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Garrity</surname><given-names>P</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Two alternating motor programs drive navigation in Drosophila larva</article-title><source>PloS One</source><volume>6</volume><elocation-id>e23180</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0023180</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>HT</given-names></name><name><surname>Trimmer</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The substrate as a skeleton: ground reaction forces from a soft-bodied legged animal</article-title><source>The Journal of Experimental Biology</source><volume>213</volume><fpage>1133</fpage><lpage>1142</lpage><pub-id pub-id-type="doi">10.1242/jeb.037796</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Central pattern generators and the control of rhythmic movements</article-title><source>Current Biology</source><volume>11</volume><fpage>R986</fpage><lpage>R996</lpage><pub-id pub-id-type="doi">10.1016/S0960-9822(01)00581-4</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paoletti</surname><given-names>P</given-names></name><name><surname>Mahadevan</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A proprioceptive neuromechanical theory of crawling</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>281</volume><elocation-id>20141092</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2014.1092</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname><given-names>K</given-names></name><name><surname>Ekeberg</surname><given-names>O</given-names></name><name><surname>Büschges</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Assessing sensory function in locomotor systems using neuro-mechanical simulations</article-title><source>Trends in Neurosciences</source><volume>29</volume><fpage>625</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2006.08.007</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proctor</surname><given-names>J</given-names></name><name><surname>Holmes</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Reflexes and preflexes: on the role of sensory feedback on rhythmic patterns in insect locomotion</article-title><source>Biological Cybernetics</source><volume>102</volume><fpage>513</fpage><lpage>531</lpage><pub-id pub-id-type="doi">10.1007/s00422-010-0383-9</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Proctor</surname><given-names>J</given-names></name><name><surname>Kukillaya</surname><given-names>RP</given-names></name><name><surname>Holmes</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A phase-reduced neuro-mechanical model for insect locomotion: feed-forward stability and proprioceptive feedback</article-title><source>Philosophical Transactions. Series A, Mathematical, Physical, and Engineering Sciences</source><volume>368</volume><fpage>5087</fpage><lpage>5104</lpage><pub-id pub-id-type="doi">10.1098/rsta.2010.0134</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pulver</surname><given-names>SR</given-names></name><name><surname>Bayley</surname><given-names>TG</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name><name><surname>Berni</surname><given-names>J</given-names></name><name><surname>Bate</surname><given-names>M</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Imaging fictive locomotor patterns in larval Drosophila</article-title><source>Journal of Neurophysiology</source><volume>114</volume><fpage>2564</fpage><lpage>2577</lpage><pub-id pub-id-type="doi">10.1152/jn.00731.2015</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohrbough</surname><given-names>J</given-names></name><name><surname>Broadie</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Electrophysiological analysis of synaptic transmission in central neurons of Drosophila larvae</article-title><source>Journal of Neurophysiology</source><volume>88</volume><fpage>847</fpage><lpage>860</lpage></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmid</surname><given-names>A</given-names></name><name><surname>Chiba</surname><given-names>A</given-names></name><name><surname>Doe</surname><given-names>CQ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Clonal analysis of Drosophila embryonic neuroblasts: neural cell types, axon projections and muscle targets</article-title><source>Development</source><volume>126</volume><fpage>4653</fpage><lpage>4689</lpage></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname><given-names>MA</given-names></name><name><surname>Trimmer</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Movement encoding by a stretch receptor in the soft-bodied caterpillar, Manduca sexta</article-title><source>The Journal of Experimental Biology</source><volume>212</volume><fpage>1021</fpage><lpage>1031</lpage><pub-id pub-id-type="doi">10.1242/jeb.023507</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname><given-names>MA</given-names></name><name><surname>Woods</surname><given-names>WA</given-names></name><name><surname>Serebrenik</surname><given-names>YV</given-names></name><name><surname>Simon</surname><given-names>SM</given-names></name><name><surname>van Griethuijsen</surname><given-names>LI</given-names></name><name><surname>Socha</surname><given-names>JJ</given-names></name><name><surname>Lee</surname><given-names>WK</given-names></name><name><surname>Trimmer</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Visceral-locomotory pistoning in crawling caterpillars</article-title><source>Current Biology</source><volume>20</volume><fpage>1458</fpage><lpage>1463</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2010.06.059</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>W</given-names></name><name><surname>Onishi</surname><given-names>M</given-names></name><name><surname>Jan</surname><given-names>LY</given-names></name><name><surname>Jan</surname><given-names>YN</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Peripheral multidendritic sensory neurons are necessary for rhythmic locomotion behavior in Drosophila larvae</article-title><source>PNAS</source><volume>104</volume><fpage>5199</fpage><lpage>5204</lpage><pub-id pub-id-type="doi">10.1073/pnas.0700895104</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suster</surname><given-names>ML</given-names></name><name><surname>Bate</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Embryonic assembly of a central pattern generator without sensory input</article-title><source>Nature</source><volume>416</volume><fpage>174</fpage><lpage>178</lpage><pub-id pub-id-type="doi">10.1038/416174a</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Trueman</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="1975">1975</year><source>The Locomotion of Soft Bodied Animals</source><publisher-loc>London</publisher-loc><publisher-name>Edward Arnold</publisher-name></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tytell</surname><given-names>ED</given-names></name><name><surname>Holmes</surname><given-names>P</given-names></name><name><surname>Cohen</surname><given-names>AH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spikes alone do not behavior make: why neuroscience needs biomechanics</article-title><source>Current Opinion in Neurobiology</source><volume>21</volume><fpage>816</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.05.017</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Umedachi</surname><given-names>T</given-names></name><name><surname>Vikas</surname><given-names>V</given-names></name><name><surname>Trimmer</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Highly deformable 3-d printed soft robot generating inching and crawling locomotions with variable friction legs, in Intelligent Robots and Systems (IROS)</article-title><conf-name>2013 IEEE/RSJ International Conference on Intelligent Robots and Systems</conf-name><fpage>4590</fpage><lpage>4595</lpage><pub-id pub-id-type="doi">10.1109/IROS.2013.6697016</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verdaasdonk</surname><given-names>BW</given-names></name><name><surname>Koopman</surname><given-names>HF</given-names></name><name><surname>van der Helm</surname><given-names>FC</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Energy efficient walking with central pattern generators: from passive dynamic walking to biologically inspired control</article-title><source>Biological Cybernetics</source><volume>101</volume><fpage>49</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1007/s00422-009-0316-7</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogelstein</surname><given-names>JT</given-names></name><name><surname>Park</surname><given-names>Y</given-names></name><name><surname>Ohyama</surname><given-names>T</given-names></name><name><surname>Kerr</surname><given-names>RA</given-names></name><name><surname>Truman</surname><given-names>JW</given-names></name><name><surname>Priebe</surname><given-names>CE</given-names></name><name><surname>Zlatic</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Discovery of brainwide neural-behavioral maps via multiscale unsupervised structure learning</article-title><source>Science</source><volume>344</volume><fpage>386</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1126/science.1250298</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wallace</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Wave formation by infective larvae of the plant parasitic nematode Meloidogyne Javanica</article-title><source>Biological Cybernetics</source><volume>15</volume><fpage>65</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1163/187529269x00100</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wen</surname><given-names>Q</given-names></name><name><surname>Po</surname><given-names>MD</given-names></name><name><surname>Hulme</surname><given-names>E</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Kwok</surname><given-names>SW</given-names></name><name><surname>Gershow</surname><given-names>M</given-names></name><name><surname>Leifer</surname><given-names>A</given-names></name><name><surname>Butler</surname><given-names>V</given-names></name><name><surname>Fang-Yen</surname><given-names>C</given-names></name><name><surname>Kawano</surname><given-names>T</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name><name><surname>Whitesides</surname><given-names>G</given-names></name><name><surname>Wyart</surname><given-names>M</given-names></name><name><surname>Chklovskii</surname><given-names>DB</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Proprioceptive coupling within motor neurons drives c.elegans forward locomotion</article-title><source>Neuron</source><volume>764</volume><fpage>750</fpage><lpage>761</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.08.039</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>HR</given-names></name><name><surname>Cowan</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Excitatory and inhibitory interactions in localized populations of model neurons</article-title><source>Biophysical Journal</source><volume>12</volume><fpage>1</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(72)86068-5</pub-id></element-citation></ref></ref-list><app-group><app id="app1"><title>Appendix 1</title><boxed-text><sec id="s18" sec-type="appendix"><title>Crawling simulations in a model with only head-tail neural coupling</title><p>Our model has two kinds of long range couplings. First is a mechanical coupling between head and tail, mediated by an infinitely stiff spring, which models the visceral piston-like action of the gut. Such coupling is important for reproducing the experimental observation that head and tail move together and provides a simple, passive mechanism for extending the head segment. Second is the input to <inline-formula><mml:math id="inf165"><mml:msub><mml:mi>E</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula> of tail segment from the stretch receptors and and the excitatory neurons in segment T2. Such input is responsible for reinitiating a crawling wave and sustain crawling gait without a CPG-like, periodic external drive. This kind of coupling needs to be mediated by neural fibers running across the VNC. Experimentally, interneurons that extend their axons across multiple VNC segments have been observed in <italic>Drosophila</italic> larvae (<xref ref-type="bibr" rid="bib37">Schmid et al., 1999</xref>).</p><p>Is it possible to build a model without any long range coupling? The head-tail synchrony at the visceral piston phase of crawling requires a means of transmission of timing information. Therefore, some form of a long range coupling is necessary. In this section, we discuss a model of crawling with only neural coupling (<xref ref-type="fig" rid="fig7">Appendix 1—figure 1A</xref>). Mathematical details of the model are given below, but first we briefly discuss its main properties.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.015</object-id><label>Appendix 1—figure 1.</label><caption><title>Crawling in a model with only head-tail neural coupling.</title><p>(<bold>A</bold>) Schematic of modified model. (<bold>B</bold>) Perfectly synchronous driving of <inline-formula><mml:math id="inf166"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf167"><mml:msub><mml:mi>E</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula>. A full kymograph, muscular activity and neural activity. Below the kymograph, the changes in total length of the larva is shown. Color code is the same as <xref ref-type="fig" rid="fig1">Figure 1</xref>. (<bold>C</bold>) Delayed forcing of tail by 0.2<inline-formula><mml:math id="inf168"><mml:mi>π</mml:mi></mml:math></inline-formula> radians. Same figures as B).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.015">http://dx.doi.org/10.7554/eLife.11031.015</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-11031-app1-fig1-v1"/></fig></p><p>Unfortunately, removal of the head-tail connecting spring from the original model does not ensue a model that produces a crawling gait, as the force that pushes head forward is mediated by the spring. To build a working model, first, an extensile muscular force, <inline-formula><mml:math id="inf169"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, should be included at the head segment for it to stretch, which would be implemented by a complex combination of circumferential and longitudinal muscular forces. Second, a neural circuit that controls this new muscle need to be introduced with a neural connection that synchronizes head-tail movements. Such circuit needs to stop the muscular activity when extension is beyond a threshold and therefore needs to be complemented by a receptor that gets activated with stretch, as opposed to receptors that gets activated with contraction in other segments.</p><p>Here, we present one such model where head-tail synchronization and crawling cycle reinitialization is achieved by CPG-like pulse inputs to tail and head segments. These pulses could be generated by two separate, synchronized, local oscillators in the VNC, or a common input that feeds both segments. Both cases still require neural fibers that traverse the VNC: in the former case to initialize oscillators simultaneously, and in the latter case to carry the input itself. Such model produces sustained crawling, as illustrated in <xref ref-type="fig" rid="fig7">Appendix 1—figure 1B</xref>. Not being constrained by a stiff gut, the total length of the larva oscillates around its stationary value, with a periodicity around <inline-formula><mml:math id="inf170"><mml:mrow><mml:mn>150</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and changes reaching about 10% of larval length at peaks. The extensile forcing and stretch activated proprioception in the head segment breaks the symmetry between segment and thus causes uneven contraction, muscular forcing and neural activity across segments. An interesting observation is the extended activation of <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> compared to other inhibitory neurons. <inline-formula><mml:math id="inf172"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> activates in the begining of the crawling cycle with a proprioceptive input due to head stretching. Such input is alive until the crawling cycle propagates from the tail to T2 and the stretch is dampened.</p><p>While this new model looks plausible, it is interesting to note that such model is sensitive to perturbations in synchrony between oscillators. For example, when a delay is introduced to the tail oscillators, which could happen due to delays in propagation of the external start signal, the total length of the crawling larva reduced from its stationary length, as illustrated in <xref ref-type="fig" rid="fig7">Appendix 1—figure 1C</xref>.</p></sec><sec id="s19" sec-type="appendix"><title>Details of the model</title><p>The dynamical equations are identical to the original model, except that there is an extra excitatory-inhibitory neural population pair at the head segment, labeled by <inline-formula><mml:math id="inf173"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf174"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>:<disp-formula id="equ6"><mml:math id="m6"><mml:mtable columnalign=" left right left right left right left right"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow id="XM128"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow id="XM139"><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow id="XM135"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>I</mml:mi></mml:msubsup></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="7.6pt">,</mml:mo><mml:mrow id="XM140"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM136">0</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM137" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM138">10.</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf175"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi id="XM141">E</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM142">I</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are again inputs to these population outside the segment and are given by:<disp-formula id="equ7"><mml:math id="m7"><mml:mtable columnalign=" left right left right left right left right left right left right left right left right left right left right"><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>h</mml:mi><mml:mn>0</mml:mn><mml:mi>E</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM144">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>E</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mrow id="XM155"><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow id="XM151"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="7.6pt">,</mml:mo><mml:mrow id="XM156"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM152">1</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM153" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM154">9</mml:mn></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>h</mml:mi><mml:mn>10</mml:mn><mml:mi>E</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM158">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>h</mml:mi><mml:mn>0</mml:mn><mml:mi>I</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow id="XM160"><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>I</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow id="XM171"><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow id="XM167"><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="7.6pt">,</mml:mo><mml:mrow id="XM172"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM168">1</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM169" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM170">10.</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Here, there are a few differences from the original model. First, we show the tonic inputs, <inline-formula><mml:math id="inf176"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM173">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf177"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM174">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that excite <inline-formula><mml:math id="inf178"><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>E</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula> explicitly. There is no proprioceptive or neuron-to-neuron input to <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>E</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula> from segment T2. Finally, the proprioceptive input to <inline-formula><mml:math id="inf181"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> comes from a contraction detector, rather than a strecth detector.</p><p>Displacement of the individual segments <inline-formula><mml:math id="inf182"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM175">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are again governed by Newtonian mechanics:<disp-formula id="equ8"><mml:math id="m8"><mml:mtable columnalign=" left right left right left right left right left right left right left right left right"><mml:mtr><mml:mtd/><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM178"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM179"><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mn>0</mml:mn><mml:mi>f</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM182"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM183"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mi>f</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mrow id="XM196"><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM191"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM192"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo rspace="42.5pt">,</mml:mo><mml:mrow id="XM197"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM193">2</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM194" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM195">9</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM200"><mml:msub><mml:mi>u</mml:mi><mml:mn>9</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM201"><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>9</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mn>10</mml:mn><mml:mi>f</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>In the absence of 'periodic' boundary conditions, the extensile force, <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, is responsible for extension of the head.</p><p>Muscular dynamics are identical to the original model except that there is an extra muscle, <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>:<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mrow id="XM212"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow id="XM208"><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>E</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow id="XM213"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM209">0</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM210" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM211">10.</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>We again assume that the friction <inline-formula><mml:math id="inf185"><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:math></inline-formula> drops to zero in a segment when <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is above a threshold, i.e.<disp-formula id="equ10"><mml:math id="m10"><mml:mtable columnalign=" left right left right"><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi></mml:msubsup></mml:mtd><mml:mtd><mml:mrow><mml:mrow id="XM226"><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mtext>max</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mtext>sign</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM221"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow id="XM222"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow id="XM227"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM223">0</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM224" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM225">10.</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Parameters of the model are identical to the original model, except <inline-formula><mml:math id="inf187"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. The inputs, <inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM228">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf189"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM229">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, are rectangular pulses with height 0.7 and witdth 10, with period 33.7. In the model where the tail input is delayed, <inline-formula><mml:math id="inf190"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM230">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> lags <inline-formula><mml:math id="inf191"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM231">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by 3.37 time units.</p></sec></boxed-text></app><app id="app2"><title>Appendix 2</title><boxed-text><sec id="s20" sec-type="appendix"><title>Robustness of simulations to inertial contribution of segments</title><p>In our simulations, we introduced a small inertial contribution for the segments that allowed to use explicit numerical integration schemes. Here we show that our results are robust with respect to changes in this parameter.</p><p>In <xref ref-type="fig" rid="fig8">Appendix 2—figure 1</xref>, we re-plot <xref ref-type="fig" rid="fig6">Figure 6C</xref>, the speed vs. friction force curve, for various values of the dimensionless segmental mass, <inline-formula><mml:math id="inf192"><mml:mi>m</mml:mi></mml:math></inline-formula>. The curves differ below <inline-formula><mml:math id="inf193"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. Above, they agree. Therefore, it is safe to use an <inline-formula><mml:math id="inf194"><mml:mi>m</mml:mi></mml:math></inline-formula> value much smaller than friction. Similar behavior is observed for all other metrics we looked at. In the main paper, we used the <inline-formula><mml:math id="inf195"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> curve which was well below the lowest <inline-formula><mml:math id="inf196"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> we plotted.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.11031.016</object-id><label>Appendix 2—figure 1.</label><caption><title>Speed vs. friction force for different values of inertia.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11031.016">http://dx.doi.org/10.7554/eLife.11031.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11031-app2-fig1-v1"/></fig></p></sec></boxed-text></app></app-group></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.11031.018</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><aff id="aff10"><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;Integrative neuromechanics of crawling in <italic>D. melanogaster</italic> larvae&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by Ronald L. Calabrese as the Reviewing Editor and K VijayRaghavan as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The neuro-mechanics underlying peristalsis in the <italic>Drosophila</italic> larva offers an excellent opportunity to understand the link between a body, its nervous system and the environment surrounding it. In recent years, the neural network underlying crawling in the larva has been investigated by numerous labs. Theorists have started integrating experimental data in quantitative models, as was done in pioneering work by Gjorgjieva et al. 2013. The present manuscript offers a detailed model of the dynamics produced by the neuro-mechanical coupling of larval segments. The model is minimally complex, which makes it elegant and powerful. Using this model, the authors explore the influence of proprioceptive inputs and body-substrate friction on quantitative aspects crawling behavior. Many behavioral observations are reproduced. Remarkably, the authors propose a set of experimentally testable predictions. The strength of the manuscript is the novelty and the elegance of the model, its ability to account for a number of experimental observed phenomena, and its clear experimental predictions.</p><p>Essential revisions:</p><p>The major weaknesses pointed out in the expert reviews and which require revision are:</p><p>1) At the moment, the model is presented for applied mathematicians but not biologists. Given that this paper targets an audience of biologists, an effort should be made to create a more intuitive understanding of the math behind the model. To help this issue, we suggest that the authors add a model overview section, preceding the current modeling section, that explains the physics and the biology of the model in a way that is accessible to a biologist, but without equations. Such a section would have to be written so that a reader who wants to struggle through the equations will have read the overview and therefore have a good intuitive understanding of what the model consists of/model assumptions etc., whereas a reader who chooses to skip the technical section can still fully follow the Results and Discussion of the paper. Particularly indicate how the parameters of the model pertain to specific interactions perhaps in reference to an expanded <xref ref-type="fig" rid="fig1">Figure 1</xref>. Given that the model contains a large number of parameters more effort must be made to explain how the different parameters were fitted to the model. It is important to discuss the limitations inherent in the assumptions of the model (i.e. obvious discrepancies with/simplifications of the biological process) and in the future how might these limitations be overcome?</p><p>2) In 2013, Gjorgjieva et al. proposed a model similar to that presented by the authors. Although the conclusions of both studies do not fully overlap, the authors should discuss more thoroughly how their findings compare to those of Gjorgjieva et al. One striking difference is related to the necessary involvement of a CPG to drive peristalsis. The authors demonstrate that peristalsis can emerge from a pure neuro-mechanical coupling between neighboring segments. This result should be highlighted in the context of the CPG-centric view prevailing in the field. Perhaps part of the discussion found in supplementary information should be moved to the main text? The authors should also emphasize the fundamental differences between a CPG-based and pure neuro-mechanical coupling model.</p><p>3) Currently, the model does not integrate the results of two recent studies from the lab of Aki Nose:</p><p>A) Kohsaka H, Takasu E, Morimoto T, Nose A. A group of segmental premotor interneurons regulates the speed of axial locomotion in <italic>Drosophila</italic> larvae. Curr Biol. 2014 Nov 17;24(22):2632-42. doi: 10.1016/j.cub.2014.09.026. Epub 2014 Oct 16. PubMed PMID: 25438948.</p><p>B) Itakura Y, Kohsaka H, Ohyama T, Zlatic M, Pulver SR, Nose A. Identification of Inhibitory Premotor Interneurons Activated at a Late Phase in a Motor Cycle during <italic>Drosophila</italic> Larval Locomotion. PLoS One. 2015 Sep 3;10(9):e0136660. doi: 10.1371/journal.pone.0136660. eCollection 2015. PubMed PMID: 26335437; PubMedCentral PMCID: PMC4559423.</p><p>These papers should be considered. See B. and D. below for more detail.</p><p>Below are excerpts from the expert reviews that expand on these needed revisions.</p><p>A) The model is simple and elegant. Necessarily, it includes a large number of assumptions and simplifications. These are in general clearly stated, but some of these lack justification (and references to the neurobiological evidence). For example, the proprioceptive coupling is only from the nearby segment (contraction of segment i+1 feeds into the neural activation of segment i). Furthermore, such coupling is subject to a highly nonlinear activation function (effectively a threshold), and is fast (the very strong nonlinearity is somewhat reminiscent of other models, e.g. in <italic>C. elegans</italic>, Bryden 2008, Boyle 2012) begging the question is such strong nonlinearity strictly necessary for the model to work and does this render the dynamics of each segment as effectively binary, up to the capacitive filtering?</p><p>B) The model assumes one excitatory and one inhibitory neuronal cell type. Recent literature has revealed more specialized cell types, e.g. excitatory PMSIs (Kohsaka et al., Curr Biol. 2014;24(22):2632-42.) and inhibitory GVLIs (Itakura et al. 2015, PLoS ONE 10(9):e0136660), with both classes implicated in peristaltic locomotion, and at least the inhibitory class also possibly consistent with the existing &quot;mission accomplished&quot; intuition. Is this more recent literature consistent with the model? Would it be possible to add a schematic with relevant cell types and lay out the reasoning of how these may be simplified/collapsed to the model presented?</p><p>C) The mathematical model builds on a 2014 paper by two of the authors (Paoletti and L Mahadevan, Proc. R. Soc. B, 2014). While this is stated, much more detail needs to be given to explain what elements of the previous model framework are built on, and what elements of the current model and results are novel (e.g. are the results in sections 3.2.1 new?). Specifically, the previous model seems to focus on the passive and active body model and a minimal control system consisting of nearest-neighbor inter-segmental proprioceptive and diffusive coupling. There, the rhythmic pattern was generated by an oscillator in the head. This model now adds neuronal detail (pattern generating neuronal populations in each segment along the VNC). Thus in this model, some patterns can be propagated along the body even in the absence of ascending (proprioceptive) or descending (brain) control, and the proprioception is then superimposed (with a demonstrated stabilizing effect). This offers an excellent framework to study the interplay between central and peripheral control in this system. It would be helpful to the readers if any differences from the previous model (regarding the biomechanics/proprioception) and head oscillator were highlighted and justified. Where there are none, this should also be stated.</p><p>Background and literature search – I was surprised the very relevant work on leech proprioception was not cited, e.g. Cang and Friesen (2002), Model for Intersegmental Coordination of Leech Swimming: Central and Sensory Mechanisms. J. Neurophys. 87(6): 2760-2769.</p><p>D) The inhibitory interneurons described in the last paragraph of section 2.1 should be related to the population of local interneurons neurons described by Kohsaka et al. 2014: the PMSIs. The same should be done for the glutamatergic interneuron GVLIs described in Itakura et al. 2015. The predictions of the model should be compared to the activity patterns reported for the PMSIs and GVLIs. The authors will note that the dynamics of GVLIs does not appear to be consistent with interactions that purely involves neighboring segments (the GVLIs lag behind the motor neurons by several segments).</p><p>Related to this point, Gjorgjieva et al. 2013 assumed a coupling of ipsilateral excitatory and inhibitory interneurons (nearest-neighbor coupling through inhibitory interneurons), which is different from that used by the authors (nearest-neighbor coupling through excitatory interneurons). Should one favor one connectivity pattern over the other one? Could the functional implications of these differences be commented on?</p><p>E) In the last paragraph of the section 3.1.2: the authors make an equivalence between the acute loss-of-function achieved through the expression of halo-rhodopsin experiments in the motorneurons (see Inada et al., 2011) and an acute increase in the activity of the inhibitory interneurons. In my view, this mathematical description of the loss-of-function is incorrect. The effect of halo-rhodopsin should be described as a dramatic reduction in the activity of the excitatory interneurons (possibly through a large increase in the value of Ei in equation 1). This perturbation might have different consequences on the network dynamics. In particular, it might explain why the authors still predict muscular contractions upon activation of halo-rhodospin, which seems incompatible with the inhibition of the motorneurons.</p><p>F) At several occasions, the length of larvae is incorrectly approximated. In the second paragraph of the Introduction, third instar larvae are assumed to be 8 mm long. I was wondering where this estimate comes from. In my experience, third instar larvae are typically 4 mm long, with a maximum length of 5 mm. In section 3.1.1, the length of the larva is assumed to be 0.7mm. Did the authors intend to write 7mm? In any case, this estimate is justified by referring to the <xref ref-type="fig" rid="fig1">Figure 1</xref> in Inada et al., 2011, but the scale bar on the figure of reference shows that the larva is not larger than 4mm. The authors should correct these dimension and update their parameter estimates.</p><p>G) In the Discussion, the authors should consider aspects of the biological phenomenology that have been neglected in their model. (1) The coupling of left and right hemi-segments. Gjorgjieva et al. 2013 have discussed that the contralateral coupling of excitatory and inhibitory interneurons might be important to produce robust propagation of peristaltic waves. How would such coupling affect the present model? (2) Can the present model account for the propagation of backward waves during backing-up movements?</p><p>H) It is not quite clear to me how the approach of Mahadevan and his colleagues differs from other modeling studies investigating crawling in <italic>D. melanogaster</italic> larvae or <italic>C. elegans</italic> or other worms or snakes. The authors state in the Introduction that recent studies on <italic>C. elegans</italic> (Wen et al., 2012; Boyle, Berri and Cohen, 2012) have already focused on local sensory feedback and proprioception and show that this suffices to modulate the locomotory pattern and explain gait transitions. Boyle and his colleagues have also shown that proprioception stabilizes crawling and makes it more robust against external perturbation. Furthermore, old studies by Niebur and Erdös in the 90s have already started to emphasize the role of sensory feedback in gait generation. Or, the works on crawling in leeches by Friesen and colleagues. I think it would be really helpful for the reader if the authors could include a paragraph into the Discussion stating how their approach differs from existing ones and what the specific advantages of their approach are.</p><p>I) The second point which was not quite clear to me concerns the coupling structure (neural and proprioceptive) that the authors used in their simulations. Which parts of this structure are based on neurobiological findings in D. melanogaster larvae and which are based on physiologically reasonable assumptions, because they are known to exist in other biological systems? In line with this, the question whether different neural coupling structures, e.g. including anterior to posterior couplings between the individual segments will interfere with the results, arises.</p><p>In case that not much is known about the neurobiology of the coupling structure and that it is mainly based on assumptions, did the authors test and compare different central/neural coupling structures and their outputs?</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.11031.019</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic></p><p><italic>The major weaknesses pointed out in the expert reviews and which require revision are:</italic></p><p><italic>1) At the moment, the model is presented for applied mathematicians but not biologists. Given that this paper targets an audience of biologists, an effort should be made to create a more intuitive understanding of the math behind the model. To help this issue, we suggest that the authors add a model overview section, preceding the current modeling section, that explains the physics and the biology of the model in a way that is accessible to a biologist, but without equations. Such a section would have to be written so that a reader who wants to struggle through the equations will have read the overview and therefore have a good intuitive understanding of what the model consists of/model assumptions etc., whereas a reader who chooses to skip the technical section can still fully follow the Results and Discussion of the paper. Particularly indicate how the parameters of the model pertain to specific interactions perhaps in reference to an expanded <xref ref-type="fig" rid="fig1">Figure 1</xref>. Given that the model contains a large number of parameters more effort must be made to explain how the different parameters were fitted to the model. It is important to discuss the limitations inherent in the assumptions of the model (i.e. obvious discrepancies with/simplifications of the biological process) and in the future how might these limitations be overcome?</italic></p><p>We thank the reviewers for encouraging us to make our presentation more accessible to biologists, who are our intended audience. As suggested, we introduced a new section (section 2.1) titled Overview, which aims to give an intuitive understanding of the model. The reader should be able to read this section, skip the mathematical details, and continue with the Results. The overview section is accompanied by an expanded <xref ref-type="fig" rid="fig1">Figure 1. A</xref> new panel zooms in a single segment and describes the important features and parameters of the model. In choosing the parameters we did not follow and automated approach but followed a few heuristics, which we now discuss in section 2.5. In section 2, we were already careful in pointing to the limitations of the model. Now this is accompanied by a much-expanded Discussion section where shortcomings of our model and possible ways to extend it are discussed.</p><p><italic>2) In 2013, Gjorgjieva et al. proposed a model similar to that presented by the authors. Although the conclusions of both studies do not fully overlap, the authors should discuss more thoroughly how their findings compare to those of Gjorgjieva et al. One striking difference is related to the necessary involvement of a CPG to drive peristalsis. The authors demonstrate that peristalsis can emerge from a pure neuro-mechanical coupling between neighboring segments. This result should be highlighted in the context of the CPG-centric view prevailing in the field. Perhaps part of the discussion found in supplementary information should be moved to the main text? The authors should also emphasize the fundamental differences between a CPG-based and pure neuro-mechanical coupling model.</italic></p><p>We thank the reviewer for bringing up these important issues. While the model of Gjorgjieva et al. was purely a neural model, some of their findings indeed overlap with ours. We added a paragraph in model section 2.2 highlighting the similarities and differences between our model and that of Gjorgjieva et al. Further, we added two more references to their paper in section 3.2.1 highlighting similarities in our results.</p><p>It is true that our model can produce crawling with pure proprioceptive coupling between segments. However, because the larva can crawl with silenced proprioception, see e.g. Hughes &amp; Thomas 2007, we do not believe such scenario is a viable model for larval crawling. Nevertheless, following the reviewer’s suggestion, we added a paragraph in Discussion highlighting this finding. We should also remind the reviewer that the possibility of sustained crawling with purely proprioceptive coupling was demonstrated and discussed in a model by two of the authors before (Paoletti and Mahadevan, 2014). Finally, the discussion in the supplementary information is not related a pure neuro-mechanical model, therefore we chose to keep it as it is.</p><p><italic>3) Currently, the model does not integrate the results of two recent studies from the lab of Aki Nose:</italic> </p><p> <italic>A) Kohsaka H, Takasu E, Morimoto T, Nose A. A group of segmental premotor interneurons regulates the speed of axial locomotion in Drosophila larvae. Curr Biol. 2014 Nov 17;24(22):2632-42. doi: 10.1016/j.cub.2014.09.026. Epub 2014 Oct 16. PubMed PMID: 25438948.</italic></p><p><italic>B) Itakura Y, Kohsaka H, Ohyama T, Zlatic M, Pulver SR, Nose A. Identification of Inhibitory Premotor Interneurons Activated at a Late Phase in a Motor Cycle during Drosophila Larval Locomotion. PLoS One. 2015 Sep 3;10(9):e0136660. doi: 10.1371/journal.pone.0136660. eCollection 2015. PubMed PMID: 26335437; PubMedCentral PMCID: PMC4559423.</italic></p><p><italic>These papers should be considered. See B. and D. below for more detail.</italic></p><p>We thank the reviewers for bringing these papers to our attention. Indeed, the inhibitory interneurons described in the first reference, PMSIs, seem to match some aspects of the inhibitory neurons in our model, i.e. that they get activated slightly after the motor neurons in the same segment and that their optogenetic excitation leads to a local arresting of the peristaltic wave. Now, we added a simulation showing this latter point, <xref ref-type="fig" rid="fig3">Figure 3D-F</xref>, and expanded the Results section 3.1.2 to discuss this simulation. Kohsaka et al. report on other results that are not consistent with our model, which we discuss in detail in section 3.1.2.</p><p>On the other hand, the activation of inhibitory interneurons described in the second reference, GLVIs, lag the motor neurons by 2-3 segments. Itakura et al. speculate that GVLIs provide a contraction termination signal when the wave reaches anterior segments. In contrast, our inhibitory neurons get only input from only the same segment. Therefore, our current model does not take into account the role of GLVIs in locomotion. We discuss this shortcoming of our model in a new paragraph in the Discussion section.</p><p><italic>Below are excerpts from the expert reviews that expand on these needed revisions.</italic> </p><p><italic>A) The model is simple and elegant. Necessarily, it includes a large number of assumptions and simplifications. These are in general clearly stated, but some of these lack justification (and references to the neurobiological evidence). For example, the proprioceptive coupling is only from the nearby segment (contraction of segment i+1 feeds into the neural activation of segment i). Furthermore, such coupling is subject to a highly nonlinear activation function (effectively a threshold), and is fast (the very strong nonlinearity is somewhat reminiscent of other models, e.g. in C. elegans, Bryden 2008, Boyle 2012) begging the question is such strong nonlinearity strictly necessary for the model to work and does this render the dynamics of each segment as effectively binary, up to the capacitive filtering?</italic></p><p>We are pleased to see that the reviewer finds the model elegant. We did do a large number of assumptions and simplifications, and we tried our best to point to biological literature when for evidence when it exists. However, there are many unknowns about how the larva crawls. When faced with an unknown, we assumed the minimal mechanism. The reviewer points to two such assumptions:</p><p>1) The proprioceptive coupling is only from the nearby segment: It is true that proprioceptive coupling could extend multiple segments, however in the lack of experimental data, we chose the minimal coupling, which is the nearest neighbor coupling.</p><p>2) The nonlinearity of the relationship between strain and proprioceptive signal: We want to make two points about this. 1) No characterization of a strain-output relationship of a proprioceptor is published in the larva. The sigmoidal relationship we used between strain and proprioceptive signal is not merely chosen for convenience: A sigmoid is a strong nonlinearity, but it is also a plausible nonlinearity. One would expect neurons detecting segmental contraction to be silent for low contraction, and saturate after some point. 2) It is true that the gain of the sigmoid in our model is large (1000), and it renders the proprioceptive signal to be binary. We can lower this gain from 1000 to 5 (which is still pretty steep), with little qualitative and quantitative change in sustained crawling. Below 5, the model stops producing sustained crawling. We do not want to draw strong conclusions from this observation and “predict” the necessity of a strong nonlinearity for crawling, because there are many other parameters to adjust which may allow gains below 5 possible.</p><p>The dynamics of each segment being effectively binary, up to the capacitive filtering (by which we believe the reviewer means the filtering due to springs in equation 3) is approximately true, because there are other time constants in play. The proprioceptive signal passes through neurons and muscles, each of which has its own time constants and nonlinearities, before feeding into the dynamical equations for segments (eq. 3). However, it is obvious, and we admit, that the dynamics described here is simple and would need to be modified to explain more complicated phenomena.</p><p><italic>B) The model assumes one excitatory and one inhibitory neuronal cell type. Recent literature has revealed more specialized cell types, e.g. excitatory PMSIs (Kohsaka et al., Curr Biol. 2014;24(22):2632-42.) and inhibitory GVLIs (Itakura et al. 2015, PLoS ONE 10(9):e0136660), with both classes implicated in peristaltic locomotion, and at least the inhibitory class also possibly consistent with the existing &quot;mission accomplished&quot; intuition. Is this more recent literature consistent with the model? Would it be possible to add a schematic with relevant cell types and lay out the reasoning of how these may be simplified/collapsed to the model presented?</italic></p><p>We thank the reviewer for bringing these papers to our attention. The results reported on PMSIs (which are inhibitory) do match some aspects of the inhibitory neurons in our model, i.e. that they get activated slightly after the motor neurons in the same segment and that their optogenetic excitation leads to a local arresting of the peristaltic wave. A simulation of such local arrest is added to the Results section 3.1.2 (<xref ref-type="fig" rid="fig3">Figure 3D-F</xref>). Kohsaka et al. report on other results that are not consistent with our model, which we discuss in detail in a new paragraph again in section 3.1.2.</p><p>Activation of GLVIs on the other hand lag the motor neurons by 2-3 segments. We therefore believe that our current model does not take into account the role of GLVIs in locomotion. We discuss this shortcoming of our model in a new paragraph in the Discussion section. Since our model does not include GLVIs, we did not add the schematic that the reviewer requested.</p><p><italic>C) The mathematical model builds on a 2014 paper by two of the authors (Paoletti and L Mahadevan, Proc. R. Soc. B, 2014). While this is stated, much more detail needs to be given to explain what elements of the previous model framework are built on, and what elements of the current model and results are novel (e.g. are the results in sections 3.2.1 new?). Specifically, the previous model seems to focus on the passive and active body model and a minimal control system consisting of nearest-neighbor inter-segmental proprioceptive and diffusive coupling. There, the rhythmic pattern was generated by an oscillator in the head. This model now adds neuronal detail (pattern generating neuronal populations in each segment along the VNC). Thus in this model, some patterns can be propagated along the body even in the absence of ascending (proprioceptive) or descending (brain) control, and the proprioception is then superimposed (with a demonstrated stabilizing effect). This offers an excellent framework to study the interplay between central and peripheral control in this system. It would be helpful to the readers if any differences from the previous model (regarding the biomechanics/proprioception) and head oscillator were highlighted and justified. Where there are none, this should also be stated.</italic> </p><p><italic>Background and literature search – I was surprised the very relevant work on leech proprioception was not cited, e.g. Cang and Friesen (2002), Model for Intersegmental Coordination of Leech Swimming: Central and Sensory Mechanisms. J. Neurophys. 87(6): 2760-2769.</italic></p><p>As the reviewer points out, and we state in the paper, our model builds on a 2014 paper by 2 of the authors (Paoletti and Mahadevan, 2014), but has many differences from it. Most importantly, the previous model was built thinking of a “generic” crawler to prove the point that crawling without a CPG is possible. Therefore, it lacked a neural coupling between segments. Besides, the neural dynamics within segments were approximated with an oscillator. The current paper aims to model larval crawling: It has neural coupling between segments because the larva is able to crawl without proprioception (Hughes and Thomas, 2007). Other main differences are: 1) Our current model does not need a start signal at the beginning of each wave as in the old model, but restarts a wave by the neural coupling between T2 and A8, 2) In the current model, friction is set to zero when muscular forces exceed a threshold, modeling lifting of the body from the ground. In the old model, friction changed by direction of motion. 3) The dynamics of neurons in the old model (phase oscillators) were different than the current one and there was only one population of neurons. 4) The proprioception only activated the next segment but did not inhibit the current segment. 5) The old model was actually numerically solved in the continuum limit assuming a large number of segments, whereas here we solve the model with discrete segments. These differences are now pointed in the mathematical model section.</p><p>Regarding novelty of our results, we claim that all are novel, except that the model is able to crawl with purely proprioceptive coupling, which is just one of the results reported in section 3.2.1. We inserted a citation to the old model, in addition to the existing one in section 2, when we discuss purely proprioceptive crawling in section 3.2.1. The rest of our results, an overwhelming majority, are novel because: 1) They involve features that did not exist in the previous model: perturbations of excitatory and inhibitory neurons (section 3.1.2), crawling with purely neural coupling (section 3.1.3), manipulations of neural coupling (section 3.2.1). 2) They report results that the previous model did not address: resemblance to <italic>D. melanogaster</italic> larva crawling (section 3.1.1) and role of friction (section 3.2.2).</p><p>We are pleased to see that the reviewer agrees that our model offers an excellent framework to study the interplay between central and peripheral control in this system. We did our best to exploit this feature in this paper.</p><p>We apologize for missing the references to the leech proprioception. We added references to it in the Introduction.</p><p><italic>D) The inhibitory interneurons described in the last paragraph of section 2.1 should be related to the population of local interneurons neurons described by Kohsaka et al. 2014: the PMSIs. The same should be done for the glutamatergic interneuron GVLIs described in Itakura et al. 2015. The predictions of the model should be compared to the activity patterns reported for the PMSIs and GVLIs. The authors will note that the dynamics of GVLIs does not appear to be consistent with interactions that purely involves neighboring segments (the GVLIs lag behind the motor neurons by several segments).</italic> </p><p><italic>Related to this point, Gjorgjieva et al. 2013 assumed a coupling of ipsilateral excitatory and inhibitory interneurons (nearest-neighbor coupling through inhibitory interneurons), which is different from that used by the authors (nearest-neighbor coupling through excitatory interneurons). Should one favor one connectivity pattern over the other one? Could the functional implications of these differences be commented on?</italic></p><p>We thank the reviewer for bringing these papers to our attention. We now relate the inhibitory population of our model to PMSIs in the Results section. Experimentally, PMSIs get activated slightly after the motor neurons in the same segment and their optogenetic excitation leads to a local arresting of the peristaltic wave. A simulation of such local arrest due to extra excitation of our inhibitory neurons is added to the Results section 3.1.2 (<xref ref-type="fig" rid="fig3">Figure 3D-F</xref>). Kohsaka et al. report on other results that are not consistent with our model, which we discuss in detail again in section 3.1.2. As the reviewer correctly points, activation of GLVIs lag the motor neurons by 2-3 segments and hence the inhibitory neurons in our model does not describe GLVIs. In a new paragraph in the Discussion section, we discuss this inconsistency.</p><p>Gjorgieva et al. assumed two kinds of bidirectional intersegmental couplings: 1) connections between the excitatory populations of the neighboring segments and 2) connections from the inhibitory populations to the neighboring excitatory populations. Our model only has the first type and it is unidirectional. Gjorgieva et al. comment that the function of the second type of connections is “to terminate activity in the previously active segment and ensure unidirectional wave propagation.” In our model, we were able to achieve termination of activity in the previously active segment by the activity of inhibitory neurons in that segment. Unidirectional wave propagation was built into the unidirectional connectivity in the intersegmental coupling. Therefore, our model did not need connections between inhibitory and excitatory neurons in neighboring segments and hence our choice of not including them. Favoring one coupling versus the other one will ultimately depend on experiments and currently we do not know of an experimental result that can distinguish between the two cases. In a new paragraph in section 2.2, we point to the differences between the results of Gjorgieva et al. and ours.</p><p><italic>E) In the last paragraph of the section 3.1.2: the authors make an equivalence between the acute loss-of-function achieved through the expression of halo-rhodopsin experiments in the motorneurons (see Inada et al., 2011) and an acute increase in the activity of the inhibitory interneurons. In my view, this mathematical description of the loss-of-function is incorrect. The effect of halo-rhodopsin should be described as a dramatic reduction in the activity of the excitatory interneurons (possibly through a large increase in the value of Ei in equation 1). This perturbation might have different consequences on the network dynamics. In particular, it might explain why the authors still predict muscular contractions upon activation of halo-rhodospin, which seems incompatible with the inhibition of the motorneurons.</italic></p><p>The reviewer is completely right in that “the effect of halo-rhodopsin should be described as a dramatic reduction in the activity of the excitatory interneurons”. This is exactly what we did in the model, however our wording was mistakenly suggests that we increased the activity of inhibitory interneurons. What was done was reducing the activity of excitatory population, by setting it to zero. This current did <italic>not</italic> come from an increase in inhibitory activity (see <xref ref-type="fig" rid="fig3">Figure 3C</xref>). We put in some more explanation in the paragraph to make this point clear.</p><p><italic>F) At several occasions, the length of larvae is incorrectly approximated. In the second paragraph of the Introduction, third instar larvae are assumed to be 8 mm long. I was wondering where this estimate comes from. In my experience, third instar larvae are typically 4 mm long, with a maximum length of 5 mm. In section 3.1.1, the length of the larva is assumed to be 0.7mm. Did the authors intend to write 7mm? In any case, this estimate is justified by referring to the Figure 1 in Inada et al., 2011, but the scale bar on the figure of reference shows that the larva is not larger than 4mm. The authors should correct these dimension and update their parameter estimates.</italic> </p><p>Many thanks for catching this one! Indeed, we made a mistake in our estimates. We changed our third instar larvae length assumption to 4mm. In line 229, we assumed L = 0.7 mm, which meant the length of the larva to be 10L = 7mm. We now changed it the assumption to 10L = 4mm. In addition, we rewrote the paragraph where our estimates are given, to avoid confusions. The section now reads:</p><p>“Our simulations show that the larva produces about 0.038 waves per unit time associated with the relaxation of the excitatory neurons 𝜏&quot;, where waves start when the tail moves off the ground, leading to a larval speed ≈ 0.036L/𝜏&quot;. […] This in perfect agreement with the range reported in (Heckscher, Lockery and Doe, 2012): ≈ 39.5-126.5 𝜇m/sec.”</p><p><italic>G) In the Discussion, the authors should consider aspects of the biological phenomenology that have been neglected in their model. (1) The coupling of left and right hemi-segments. Gjorgjieva et al. 2013 have discussed that the contralateral coupling of excitatory and inhibitory interneurons might be important to produce robust propagation of peristaltic waves. How would such coupling affect the present model? (2) Can the present model account for the propagation of backward waves during backing-up movements?</italic></p><p>Both issues brought up here are indeed phenomenology neglected in our model. We acknowledge both points (and more) in the penultimate paragraph of our Discussion. To answer in more detail:</p><p>1) Addressing the effects of contralateral coupling of excitatory and inhibitory neurons requires substantial additions to our model. In addition to building a two-sided model of VNC as in Gjorgieva et al., we need to introduce a two-sided mechanical model for body hemisegments. It is hard for us to say how the contralateral coupling would affect such model, without actually building it. We intend to do so in future work.</p><p>2) Repeating what is said in the paper, “Backward crawling, for instance, could be achieved by a separate neural circuit running from anterior-to-posterior, perhaps similar to that in C. elegans (Haspel, Donovan and Hart, 2010).” Yet another mechanism could be to introduce anterior to posterior couplings between the individual segments as in (Gjorgjieva et al. 2013) to allow propagation of activity in VNC in the opposite direction. We added this possibility to the sentence above, “…or by introducing anterior to posterior neural coupling between individual segments as in the model of (Gjorgjieva et al., 2013).”</p><p><italic>H) It is not quite clear to me how the approach of Mahadevan and his colleagues differs from other modeling studies investigating crawling in D. melanogaster larvae or C. elegans or other worms or snakes. The authors state in the Introduction that recent studies on C. elegans (Wen et al., 2012; Boyle, Berri and Cohen, 2012) have already focused on local sensory feedback and proprioception and show that this suffices to modulate the locomotory pattern and explain gait transitions. Boyle and his colleagues have also shown that proprioception stabilizes crawling and makes it more robust against external perturbation. Furthermore, old studies by Niebur and Erdös in the 90s have already started to emphasize the role of sensory feedback in gait generation. Or, the works on crawling in leeches by Friesen and colleagues. I think it would be really helpful for the reader if the authors could include a paragraph into the Discussion stating how their approach differs from existing ones and what the specific advantages of their approach are.</italic></p><p>The reviewer is correct in pointing that the role of sensory feedback in locomotion has been investigated before. However, our approach has novelty. First, we point that the gait we study is rectilinear crawling, which is different than the gaits studied before. As the reviewer would appreciate, it is not guaranteed that results obtained from other gaits are going to automatically generalize to all gaits, due to differences in mechanics, neural control and the interactions with the environment. The model that we present for crawling is novel and simple. Second, we study the crawling gait in <italic>Drosophila melanogaster</italic> larvae. As we discuss in the introduction, D. <italic>melanogaster</italic> is an excellent system because of especially the genetic and optogenetic tools that can be used to perturb neural and proprioceptive systems and see their effects on crawling. In the paper we reproduce many of these experiments. We don’t think any of the models cited by the reviewer have been subject to such detailed testing, except maybe that of Boyle et al. Further, we emphasize and predict how changes in friction can affect the gait, something that has not been considered in <italic>D. melanogaster</italic> literature. To summarize, the strength of our approach comes from the model system and the gait we study: we propose a simple and novel model for the crawling gait, our model reproduces many of perturbation experiments in <italic>D. melanogaster</italic> larvae and it produces clear, testable predictions.</p><p>We added the following sentences to the end of the first paragraph to address these points: “However, such attempts were mostly aimed at quantitatively replicating organisms' behaviors, without any rigorous experimental validation. Moreover, the complexity of the studied organisms prevents exploiting such models to make testable predictions that can be used to shed light on the biological mechanisms regulating locomotion.”</p><p><italic>I) The second point which was not quite clear to me concerns the coupling structure (neural and proprioceptive) that the authors used in their simulations. Which parts of this structure are based on neurobiological findings in D. melanogaster larvae and which are based on physiologically reasonable assumptions, because they are known to exist in other biological systems? In line with this, the question whether different neural coupling structures, e.g. including anterior to posterior couplings between the individual segments will interfere with the results, arises.</italic> </p><p> <italic>In case that not much is known about the neurobiology of the coupling structure and that it is mainly based on assumptions, did the authors test and compare different central/neural coupling structures and their outputs?</italic></p><p>There does not exist an anatomical study where the coupling structure in the VNC is mapped out. Therefore, there is no reason to choose one connectivity over the other, as long as one can reproduce experimental results. Therefore, as we mention a few times in the paper, we chose to use a minimal model that is able to reproduce experimental results and further able to make clear, testable predictions.</p><p>Different coupling structures may interfere with results, one of our contributions is to identify a coupling structure that can reproduce results of experiments where neural and proprioceptive systems are perturbed. This does not mean that our results are only specific to the particular coupling we used. For example, our results are consistent with that of (Gjorgjieva et al. 2013), where they considered a purely neural model with anterior to posterior couplings between segments (the scenario that the reviewer is inquiring about). They found that “sensory feedback improves wave propagation” as we also found, or that increasing excitatory coupling between segments makes the waves propagate faster as we also observed. The overlap between our results and that of Gjorgjieva et al. makes us believe that including anterior to posterior couplings between the individual segments will not interfere with our results. We added references to the overlap between and our results and (Gjorgjieva et al. 2013) in the section 3.2.1.</p><p>The space of all possible coupling structures is vast, and the reviewer would hopefully agree that it is an unreasonably complicated task to test and compare all such structures. Our aim here, after all, is to present a model, as minimal as it could be, to reproduce experiments and make testable predictions, as opposed to ruling out all implausible ones.</p><p>Finally, in the supplementary information, we do present an alternative coupling structure, where head and tail are driven by separate neural controls and are synchronized by an external signal. We show that such model can also produce sustained crawling gait. The reason we chose to implement this scenario was to point that the nature of head-tail synchrony, whether it is mechanical as in the main text or neural as in the supplementary information, does not change our results.</p></body></sub-article></article>