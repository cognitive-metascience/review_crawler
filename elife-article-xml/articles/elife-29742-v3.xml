<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">29742</article-id><article-id pub-id-type="doi">10.7554/eLife.29742</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Paradoxical response reversal of top-down modulation in cortical circuits with three interneuron types</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-91491"><name><surname>Garcia del Molino</surname><given-names>Luis Carlos</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9934-9461</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-91492"><name><surname>Yang</surname><given-names>Guangyu Robert</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8919-4248</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-91493"><name><surname>Mejias</surname><given-names>Jorge F</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8096-4891</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">†</xref></contrib><contrib contrib-type="author" corresp="yes" id="author-6345"><name><surname>Wang</surname><given-names>Xiao-Jing</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3124-8474</contrib-id><email>xjwang@nyu.edu</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution content-type="dept">Center for Neural Science</institution><institution>New York University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-6945"><name><surname>Latham</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Swammerdam Institute for Life Sciences, Center for Neuroscience, Faculty of Science, University of Amsterdam, Amsterdam, Netherlands</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>19</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e29742</elocation-id><history><date date-type="received" iso-8601-date="2017-06-19"><day>19</day><month>06</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2017-12-02"><day>02</day><month>12</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Garcia del Molino et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Garcia del Molino et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-29742-v3.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.29742.001</object-id><p>Pyramidal cells and interneurons expressing parvalbumin (PV), somatostatin (SST), and vasoactive intestinal peptide (VIP) show cell-type-specific connectivity patterns leading to a canonical microcircuit across cortex. Experiments recording from this circuit often report counterintuitive and seemingly contradictory findings. For example, the response of SST cells in mouse V1 to top-down behavioral modulation can change its sign when the visual input changes, a phenomenon that we call response reversal. We developed a theoretical framework to explain these seemingly contradictory effects as emerging phenomena in circuits with two key features: interactions between multiple neural populations and a nonlinear neuronal input-output relationship. Furthermore, we built a cortical circuit model which reproduces counterintuitive dynamics observed in mouse V1. Our analytical calculations pinpoint connection properties critical to response reversal, and predict additional novel types of complex dynamics that could be tested in future experiments.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>interneurons</kwd><kwd>top-down modulation</kwd><kwd>neural circuit</kwd><kwd>mouse V1</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000006</institution-id><institution>Office of Naval Research</institution></institution-wrap></funding-source><award-id>N00014-17-1-2041</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Xiao-Jing</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003399</institution-id><institution>Science and Technology Commission of Shanghai Municipality</institution></institution-wrap></funding-source><award-id>14JC1404900</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Xiao-Jing</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000135</institution-id><institution>NIH Blueprint for Neuroscience Research</institution></institution-wrap></funding-source><award-id>R01MH062349</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Xiao-Jing</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003399</institution-id><institution>Science and Technology Commission of Shanghai Municipality</institution></institution-wrap></funding-source><award-id>15JC1400104</award-id><principal-award-recipient><name><surname>Wang</surname><given-names>Xiao-Jing</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Computational simulations and mathematical derivations reveal why the response of neural populations to external modulation is sometimes reversed with respect to what intuition would lead to believe in cortical circuits with multiple types of inhibitory neurons.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Three major non-overlapping classes of interneurons expressing parvalbumin, somatostatin and vasoactive intestinal peptide (henceforth denoted PV, SST and VIP respectively) make up more than 80% of GABAergic cells of mouse cortex (<xref ref-type="bibr" rid="bib33">Rudy et al., 2011</xref>). These neurons show cell-type-specific connectivity among themselves and with excitatory (E) neurons (<xref ref-type="bibr" rid="bib29">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib10">Jiang et al., 2015</xref>) forming a canonical microcircuit in the cortex. This microcircuit motif, initially proposed theoretically (<xref ref-type="bibr" rid="bib37">Wang et al., 2004</xref>), has been the subject of numerous recent experimental studies using optogenetic tools applied to behaving mice (<xref ref-type="bibr" rid="bib15">Lee et al., 2012</xref>; <xref ref-type="bibr" rid="bib34">Saleem et al., 2013</xref>; <xref ref-type="bibr" rid="bib12">Kepecs and Fishell, 2014</xref>; <xref ref-type="bibr" rid="bib7">Hawrylycz et al., 2016</xref>) as well as computational studies (<xref ref-type="bibr" rid="bib17">Lee and Mihalas, 2015</xref>; <xref ref-type="bibr" rid="bib19">Lee and Mihalas, 2017</xref>; <xref ref-type="bibr" rid="bib18">Lee et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Yang et al., 2016</xref>; <xref ref-type="bibr" rid="bib40">Yang and Wang, 2017</xref>). However, we still do not fully understand the mechanisms that underlie the behavior of this microcircuit which are often complex and counterintuitive.</p><p>A notable observation was that pyramidal neurons and VIP interneurons concomitantly increase their activities in the primary visual cortex V1 during locomotion in comparison with immobility (<xref ref-type="bibr" rid="bib26">Niell and Stryker, 2010</xref>), even in the complete absence of visual input (<xref ref-type="bibr" rid="bib11">Keller et al., 2012</xref>). Moreover, optogenetically activating (respectively inactivating) VIP interneurons mimics (respectively eliminates) the effect of running (<xref ref-type="bibr" rid="bib4">Fu et al., 2014</xref>). Since VIP cells primarily target SST cells, a natural explanation for this phenomenon is disinhibition (<xref ref-type="bibr" rid="bib37">Wang et al., 2004</xref>; <xref ref-type="bibr" rid="bib16">Lee et al., 2013</xref>): activation of VIP cells suppresses SST cells, therefore neurons targeted by the SST population are disinhibited, enhancing the overall activity of excitatory neurons. However, recent experiments show that the network behavior might be more complex. Namely, in darkness the activation of VIP cells results in an average decrease of SST population activity (<xref ref-type="bibr" rid="bib4">Fu et al., 2014</xref>), whereas in the presence of visual stimulation the response of SST cells is reversed and its firing rate increases during locomotion compared to immobility (<xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>). These findings, which have been further confirmed in a recent preprint (<xref ref-type="bibr" rid="bib3">Dipoppa et al., 2017</xref>), appear to challenge the disinhibition hypothesis, suggesting that the nature of the interaction between VIP and SST could be stimulus dependent.</p><p>These experimental results raise two questions: First, the external activation of a population that directly inhibits a second population can trigger a positive response of the latter. What is the mechanism behind this apparently paradoxical behavior? Second, the same top-down modulation can trigger both a positive response and a negative response of certain populations of the circuit depending on the sensory input. Under which conditions can we expect one response or the other?</p><p>In this study, we model cortical activity and provide a comprehensive answers to these two questions. We show that these counterintuitive phenomena rely on two basic features of cortical networks: (i) the presence of multiple populations of interneurons and (ii) nonlinear responses to input. Finally, we use our model to predict complex behaviors that have not yet been experimentally tested. Beyond the mechanistic explanation for the observed behavior in mice V1, our work provides a very general and powerful framework to explain the dynamics of neural networks with multiple interneuron types, their context-dependent interactions, and the emergence of counterintuitive effects that may occur across different cortical structures and animals.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We simulate microcircuit activity using a four population firing rate model. The average rate of each population is given by a nonlinear function of its input that we refer to as the f-I curve (<xref ref-type="bibr" rid="bib1">Abbott and Chance, 2005</xref>). The f-I curve is such that when the input is low (below threshold), cells are little responsive to changes in external input. Instead for high input (above threshold) small changes in the input can drive substantial changes in the response (<xref ref-type="bibr" rid="bib24">Miller and Troyer, 2002</xref>) (see <xref ref-type="fig" rid="fig1">Figure 1b</xref>). This nonlinearity has been analyzed experimentally and theoretically (<xref ref-type="bibr" rid="bib25">Murphy and Miller, 2003</xref>; <xref ref-type="bibr" rid="bib30">Phillips and Hasenstaub, 2016</xref>) and as we will show later, it is a key feature of the model.</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.002</object-id><label>Figure 1.</label><caption><title>Response to top-down modulation depends on baseline activity.</title><p>(<bold>a</bold>) Microcircuit connectivity and top-down modulatory input. (<bold>b</bold>) f-I curve. When input is low changes in input have almost no effect on the output rate, instead, when input is high changes in input have a big effect on output rate. (<bold>c, d</bold>) Transient dynamics upon the onset of the top-down modulatory current for low baseline activity (i.e. when the rates are low before top-down modulation) and high baseline activity (i.e. when the rates are high before top-down modulation). Under a low baseline activity condition, SST is inhibited and E and PV are slightly disinhibited. The high baseline activity condition shows an example of response reversal in SST activity: it initially goes below the baseline rate but due to significant change in E activity and to the recurrent excitation it eventually reverses to a rate higher than baseline.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29742-fig1-v3"/></fig><p>Populations are connected according to the microcircuit scheme in <xref ref-type="fig" rid="fig1">Figure 1a</xref> which contains the connections reported in both <xref ref-type="bibr" rid="bib10">Jiang et al. (2015</xref>) and <xref ref-type="bibr" rid="bib29">Pfeffer et al. (2013</xref>). We also consider three sources of input: (i) top-down modulation that targets VIP cells (ii) local recurrent input and (iii) constant background input set so that the populations have some fixed baseline activity (see Materials and methods for details).</p><sec id="s2-1"><title>Response to top-down modulation depends on baseline activity</title><p>To illustrate possible complex behaviors displayed by the network, we first focused on the circuit responses to top-down modulation. The simulation results from our model allow us to identify two qualitatively different scenarios depending on the baseline activity of the network (the baseline activity is the activity before the onset of top-down modulation and we control it by changing the constant background input, see Materials and methods for details). On the one hand, when the baseline activity is low, top-down modulation will result in a decrease of the rate of the SST population and an increase of the rates of the other populations (E, PV and VIP) (see <xref ref-type="fig" rid="fig1">Figure 1c</xref>). On the other hand, when baseline activity is high, the rate of all populations increases with top-down modulation (see <xref ref-type="fig" rid="fig1">Figure 1d</xref>). These simulations reveal that population responses to top-down modulation depend in a complex way on the initial state of the network.</p><p>The striking behavior exhibited by the SST population can be explained heuristically by analyzing the response of the different populations to external excitatory input targeting VIP cells. When the top-down modulation starts, the rate of the VIP population increases. By calculating the time derivatives of the rates right after the onset of the top-down modulation (see Materials and methods) one can see that this effect always results in a transient reduction of SST activity and therefore a reduction of inhibition to VIP, PV and E cells. When baseline activity is low the E population is below threshold and this change in net input has a small effect in the output. In that situation, all populations quickly reach a stationary state. However, when the baseline activity is high, the E population is above threshold and a small change in input from SST cells has a big effect on the rate of the E population. If the recurrent excitation in the microcircuit is strong enough, it can reverse the initial response of the SST population making it increase its activity to a higher rate than the baseline.</p></sec><sec id="s2-2"><title>Circuit behavior explained by response matrix</title><p>In order to formally characterize the steady state response of a population to external input we introduce the response matrix <inline-formula><mml:math id="inf1"><mml:mi>M</mml:mi></mml:math></inline-formula>. The intuition behind the response matrix is that if we change the input to population <inline-formula><mml:math id="inf2"><mml:mi>j</mml:mi></mml:math></inline-formula> (where <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for excitatory, PV, SST and VIP populations respectively) by a small amount <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, then the change in rate of the population <inline-formula><mml:math id="inf5"><mml:mi>i</mml:mi></mml:math></inline-formula> will be <inline-formula><mml:math id="inf6"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is positive (negative), an increase of the external excitation to <inline-formula><mml:math id="inf8"><mml:mi>j</mml:mi></mml:math></inline-formula> will result in an increase (decrease) of the rate of population <inline-formula><mml:math id="inf9"><mml:mi>i</mml:mi></mml:math></inline-formula> (see Materials and methods and Table 3 for details). In contrast to the connectivity matrix, which takes into account only the direct path from population <inline-formula><mml:math id="inf10"><mml:mi>j</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf11"><mml:mi>i</mml:mi></mml:math></inline-formula>, the response matrix contains information about all the possible ways in which population <inline-formula><mml:math id="inf12"><mml:mi>j</mml:mi></mml:math></inline-formula> can affect population <inline-formula><mml:math id="inf13"><mml:mi>i</mml:mi></mml:math></inline-formula>, namely through indirect connections <inline-formula><mml:math id="inf14"><mml:mi>j</mml:mi></mml:math></inline-formula>-<inline-formula><mml:math id="inf15"><mml:mi>h</mml:mi></mml:math></inline-formula>-<inline-formula><mml:math id="inf16"><mml:mi>i</mml:mi></mml:math></inline-formula>. Due to the complexity of these indirect pathways, for different values of the connectivity matrix (but preserving the excitatory/inhibitory structure) <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be positive or negative irrespective of whether the connection from <inline-formula><mml:math id="inf18"><mml:mi>j</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf19"><mml:mi>i</mml:mi></mml:math></inline-formula> is inhibitory or excitatory. Furthermore, due to the nonlinearities in the f-I curve, the response depends on the baseline rate of each of the populations and, as shown before, it can reverse its sign.</p><p>As an example, we analyze in detail the response of the SST population to external input to VIP cells. As we show in the Materials and methods section, this term of the response matrix is given by:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the absolute values of the connection weights and therefore are positive by definition and for the system to be stable <inline-formula><mml:math id="inf21"><mml:mi>C</mml:mi></mml:math></inline-formula> has to be positive (see Materials and methods for details). The terms <inline-formula><mml:math id="inf22"><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are proportional to the inverse of the first derivative of the f-I curves and are always positive. In particular, <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> becomes arbitrarily large when the input is very low and tends monotonically to a positive constant <inline-formula><mml:math id="inf24"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup></mml:math></inline-formula> for high input. Therefore, if <inline-formula><mml:math id="inf25"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> then <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> will always be negative. However, for <inline-formula><mml:math id="inf27"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> the behavior is much richer: if input is high then <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> will be close to its minimum <inline-formula><mml:math id="inf29"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> allowing for <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to be positive (provided that the product <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is small enough). Instead if the input is low, <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math></inline-formula> will become very large and <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> will be negative.</p><p>It is remarkable that this change in the interaction between VIP and SST populations depends on the activation level of E: modifying the state of one population has a impact in the interactions between other populations. The heuristic explanation is that if the recurrent excitation is strong enough and the E population is already strongly excited (above threshold), a small decrease in the inhibition from SST to the E population can boost its activity and therefore strongly drive the whole microcircuit. If instead, the E population is in a low activation state the change in inhibition will have a weak effect that will not be able to reverse the response of SST.</p><p>This observation provides an explanation to the reversal of the response of SST to VIP activation when the baseline activity is changed: as we show in <xref ref-type="fig" rid="fig2">Figure 2a and c</xref> for low baseline activity, <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is negative and the presence of an external excitatory current targeting VIP cells will result in a negative response of SST cells and positive response of E, PV and VIP cells, conforming to the disinhibitory hypothesis. On the other hand, for high baseline activity (panels 2b and 2d), the response of the SST population to input to VIP cells becomes positive leading to the response reversal regime.</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.003</object-id><label>Figure 2.</label><caption><title>Response matrix and disinhibition vs.</title><p>response reversal regime. (<bold>a–b</bold>) Tuning curves for the different populations and baseline activity in both scenarios (low and high). In the low baseline activity scenario (<bold>a</bold>) all populations are below threshold (flat part of the fI curve), instead in the high baseline activity scenario (<bold>b</bold>) all populations are above threshold, where small changes in input result in large changes in rate. (<bold>c–d</bold>) Response matrices for the two scenarios. In (<bold>c</bold>) the response of SST to external excitation of VIP is negative, while the responses of E and PV are positive. This corresponds to the disinhibition regime. In (<bold>d</bold>) the responses of all populations to external excitation of VIP are positive, in particular, the response of SST is reversed with respect to (<bold>c</bold>) corresponding to the response reversal regime.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29742-fig2-v3"/></fig><p>A similar analysis can be conducted for all terms in <inline-formula><mml:math id="inf36"><mml:mi>M</mml:mi></mml:math></inline-formula>. For example, another case of response reversal in this circuit is that of <inline-formula><mml:math id="inf37"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> which can have different signs for different baseline activity levels, meaning that the excitatory population can have a negative response to excitatory input to itself. Intuitively, if an external excitatory current targets the E population, its rate will increase transiently and thus the excitation that SST and VIP receive will also increase. If this effect is stronger in SST than in VIP the rate of the VIP population will decrease and therefore the inhibition that SST receives will decrease as well resulting in stronger inhibition to E cells. Note that for this to happen both SST and VIP have to be in the high activity baseline (i.e. <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> have to be small) and <inline-formula><mml:math id="inf40"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf41"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> have to be strong. The explicit expression of <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (see Table 3) reveals that if the SST-VIP-SST loop is not strong enough or if <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf44"><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:math></inline-formula> are large <inline-formula><mml:math id="inf45"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> will always be positive.</p></sec><sec id="s2-3"><title>Random network model</title><p>Experimental recordings showed a great diversity across neural responses even when recording from the same class of cells (Pyramidal, SST, PV or VIP) (<xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>). Although this diversity can have many origins, such as intrinsic heterogeneity in the cells within the same class, we proposed that random connectivity alone is sufficient to explain it. To do so we develop an extension of our model where each population is composed of multiple identical randomly connected rate units and where the probability that one connection exists from one unit to another depends on the populations of the presynaptic and postsynaptic units according to data extracted from (<xref ref-type="bibr" rid="bib10">Jiang et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Pfeffer et al., 2013</xref>) (see Materials and methods for details).</p><p>For each unit, we measure the rate modulation (rate during top-down modulation minus baseline activity) for the different baselines. If the rate modulation is positive it means that the neuron is more active in the presence of the modulatory current and vice versa. In <xref ref-type="fig" rid="fig3">Figure 3</xref>, we show scatter plots of the rate modulation under the low baseline condition versus the rate modulation under the high baseline condition for each unit. These simulations reveal that the behavior of individual neurons can be quite variable while the population average still corresponds to the behavior of the population-based model. Since all units of each population are identical, variability in the response has to be due to the heterogeneity in the connectivity. This variability can result in cells within the same population having responses with opposite sign, as has been observed to be the case in mouse V1 (<xref ref-type="bibr" rid="bib31">Reimer et al., 2014</xref>; <xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>) and A1 (<xref ref-type="bibr" rid="bib14">Kuchibhotla et al., 2017</xref>). In addition, variability might also have further implications for gating of signals, since variability in inhibitory cells has been proposed to modulate the response gain of neural circuits (<xref ref-type="bibr" rid="bib22">Mejias and Longtin, 2014</xref>).</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.004</object-id><label>Figure 3.</label><caption><title>Random network model.</title><p>(<bold>a</bold>) Schematic of the model. Each population is composed of several rate units and the connectivity between units is random with probabilities extracted from experimental data in the literature. (<bold>b</bold>) Rate modulation (rate after the onset of the modulatory current minus baseline rate) for low and high baseline activities. Each colored point corresponds to one unit. Unit responses are very variable and, in particular within the same population different units might have responses with different sign. White points correspond to the population average. Despite the variability of individual responses the population average corresponds to the population responses in the single unit model in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29742-fig3-v3"/></fig></sec><sec id="s2-4"><title>Model of mouse V1 accounts for experimental measurements</title><p>Our framework allows us to easily understand the counterintuitive behavior of V1 during locomotion. In the experiments mice with their head fixed face a screen where different visual stimuli are presented and can run freely on a treadmill (<xref ref-type="bibr" rid="bib4">Fu et al., 2014</xref>; <xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>). Different visual stimuli result in different baseline activities in V1 and top-down modulation is triggered when the mice start running.</p><p>To model visual input we use external currents. In the case of size-varying gratings, this input has two sources: thalamic input that targets excitatory cells and cortical input that targets SST cells. In order to reproduce the surround suppression effect (<xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>; <xref ref-type="bibr" rid="bib2">Adesnik et al., 2012</xref>), excitatory cells have a small receptive field and therefore receive center input and SST cells have a large receptive field and receive surround input (see Materials and methods for details).</p><p><xref ref-type="fig" rid="fig4">Figure 4b</xref> shows the response reversal phenomenon when a weak visual stimulus is presented. Before the visual stimulation, the SST has higher activity for immobility than for locomotion, by contrast, when the visual stimulus is presented, the activity of the SST population is higher for locomotion. In <xref ref-type="fig" rid="fig4">Figure 4c</xref>, we show the experimental data from <xref ref-type="bibr" rid="bib28">Pakan et al. (2016)</xref> for three different experimental conditions (darkness, gray screen and grating) and in <xref ref-type="fig" rid="fig4">Figure 4d</xref> our simulations of V1 under the same conditions. <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> shows the experimental data from the preprint (<xref ref-type="bibr" rid="bib3">Dipoppa et al., 2017</xref>) for gratings of different sizes alongside with the behavior of our model.</p><p>Our simulations of this V1 circuit model reproduce the phenomena described in the literature: in the presence of visual stimulation, the activities of all populations, including SST, increase during locomotion (<xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>). In darkness, the activities of excitatory, PV and VIP populations increase during locomotion while the activity of SST decreases as reported in <xref ref-type="bibr" rid="bib4">Fu et al. (2014</xref>) and in the preprint (<xref ref-type="bibr" rid="bib3">Dipoppa et al., 2017</xref>). In <xref ref-type="bibr" rid="bib28">Pakan et al. (2016</xref>), the response of SST to locomotion in darkness is weakly positive but this result is not statistically significant while the other two are.</p><p>To show that our results do not rely on a fine tuning of the connectivity parameters or even on certain details of the microcircuit structure, we have run the model with several connectivity matrices and perturbations of them (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) and we find that different connectivity parameters can reproduce the same circuit behavior as has been shown before in other systems (<xref ref-type="bibr" rid="bib21">Marder et al., 2015</xref>). We have also considered other microcircuit structures to account for the differences between studies ([<xref ref-type="bibr" rid="bib29">Pfeffer et al., 2013</xref>] reports projections from PV to VIP and (<xref ref-type="bibr" rid="bib10">Jiang et al., 2015</xref>) from PV to SST) and we also consider thalamic input to PV (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). In all these cases, the results were consistent with our original findings showing that the phenomenon and the analysis are robust and not a peculiarity of one specific circuit.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.005</object-id><label>Figure 4.</label><caption><title>Model of mouse V1 behavior.</title><p>(<bold>a</bold>) Schematic of the microcircuit. Visual input targets E and SST cells. Behavior related top-down modulation targets VIP cells. (<bold>b</bold>) Response of E and SST populations when a weak visual stimulus (6 deg) is presented for locomotion and immobility. The E population always shows a higher response with locomotion. On the other hand, before the visual stimulation the SST population has higher activity for immobility than for locomotion and when the visual stimulus is presented, the activity of the SST population is higher for locomotion. (<bold>c</bold>) Relative change in calcium fluorescence for three levels of visual stimulation (darkness, gray screen and grating) and two behavioral states: immobility (empty bars) and locomotion (filled bars) extracted from (<xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>). (<bold>d</bold>) Rates (in Hz) of the populations in the V1 simulation for the same conditions as in (<bold>c</bold>). Comparison of (<bold>c</bold>) with (<bold>d</bold>) shows that our simulations reproduce qualitatively the activity of neural populations in mice V1. Namely the activity of all populations is higher during locomotion than during immobility whenever there is visual stimulation and for E, PV and VIP also in the absence of visual stimulation. Our model shows a decrease in activity of SST during locomotion as reported in (<xref ref-type="bibr" rid="bib4">Fu et al., 2014</xref>) (the change in activity of the SST population in darkness in (<xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>) is not statistically significant). The quantitative differences might be related to the fact that changes in calcium fluorescence are not proportional to changes in rate.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29742-fig4-v3"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.29742.006</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Model of mouse V1 behavior with different grating sizes.</title><p>(<bold>a</bold>) Relative change in calcium fluorescence for gratings of diameters ranging from 10 deg to 60 deg for the two behavioral states: immobility (empty dots) and locomotion (filled dots) extracted from the preprint (<xref ref-type="bibr" rid="bib3">Dipoppa et al., 2017</xref>) (<bold>b</bold>) Rates (in Hz) of the populations in the V1 simulation for the same conditions as in (<bold>a</bold>). As in <xref ref-type="fig" rid="fig4">Figure 4</xref>, our simulations reproduce qualitatively the activity of neural populations in mice V1. Our model also exhibits surround suppression for all populations.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29742-fig4-figsupp1-v3"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.29742.007</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Robustness of the behavior.</title><p>Top: Example of three connectivity matrices that have the same qualitative behavior (in pAs). Bottom: rate modulation (rate during locomotion minus rate for immobility). Each bar corresponds to the average rate modulation of 20 random perturbations of the matrices on the top where each entry has been multiplied by a random variable uniformly distributed in <inline-formula><mml:math id="inf46"><mml:mrow><mml:mo mathvariant="normal" maxsize="111%" minsize="111%">[</mml:mo><mml:mn mathsize="111%" mathvariant="normal">0.9</mml:mn><mml:mo mathsize="111%" mathvariant="normal" stretchy="false">,</mml:mo><mml:mn mathsize="111%" mathvariant="normal">1.1</mml:mn><mml:mo mathvariant="normal" maxsize="111%" minsize="111%">]</mml:mo></mml:mrow></mml:math></inline-formula>, which corresponds to random changes of up to <inline-formula><mml:math id="inf47"><mml:mrow><mml:mo mathsize="111%" mathvariant="normal" stretchy="false">±</mml:mo><mml:mn mathsize="111%" mathvariant="normal">10</mml:mn></mml:mrow></mml:math></inline-formula>%. Error bars correspond to the minimum and maximum rate modulations of the 20 realizations. Despite quantitative variations, the qualitative behavior is always the same: rate modulation of SST population in darkness is always negative; rate modulation for all other cases is always positive.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29742-fig4-figsupp2-v3"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.29742.008</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Alternative architectures.</title><p>Two alternative microcircuits with visual input targeting E, SST and PV populations and PV to VIP (<bold>a</bold>) and PV to SST (<bold>b</bold>) connections exhibit the same qualitative behavior as the circuit in <xref ref-type="fig" rid="fig4">Figure 1 snd Figure 4—figure supplement 1</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-29742-fig4-figsupp3-v3"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have developed a theoretical model of cortical circuit with multiple interneuron types that accounts for newly identified complex interactions between cell types. The model has been used to reproduce and explain two counterintuitive phenomena observed in mouse cortex. First, in certain cases the activation of VIP cells results in an overall positive response of the SST population (<xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>). Second, the sign of the SST population response to excitation of VIP cells depends on the baseline activity of the circuit (<xref ref-type="bibr" rid="bib4">Fu et al., 2014</xref>). Two features of the system lead to this behavior: the presence of multiple interneuron populations and the nonlinearity of f-I curves.</p><p>We explained heuristically the response reversal by closely looking at transient dynamics of the circuit. One experimentally testable prediction of our analysis is that, as <xref ref-type="fig" rid="fig1">Figure 1d</xref> and our calculations of the transient behavior show, in the response reversal regime, the overall SST population response to top-down modulation should initially decrease and later increase until reaching a higher rate than the baseline.</p><p>Based on our model, we introduced the response matrix <inline-formula><mml:math id="inf48"><mml:mi>M</mml:mi></mml:math></inline-formula>, which is a comprehensive framework to understand counterintuitive steady state responses. It provides explicit information about the contribution of each individual connection. For example by looking at the elements in <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (see Table 3), one can readily see that if the recurrent excitation between pyramidal cells is not large enough, <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can only be negative and therefore response reversal of SST would not happen. This statement can be easily tested by repeating the experiments while suppressing the activation of the E population. As we discussed before, another example is that if both SST and VIP populations have high baseline activities and if the SST-VIP-SST loop is strong enough, <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be negative, that is the excitatory population can have a negative response to excitatory input (see Table 3 for the explicit expression of <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). If the connections between the SST and the VIP populations are removed (or weakened) or if their baseline activities are sufficiently lowered <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> will always be positive. This constitutes another interesting prediction that can be experimentally tested.</p><p>Our calculations also revealed sign correlations between entries of <inline-formula><mml:math id="inf54"><mml:mi>M</mml:mi></mml:math></inline-formula>, for example <inline-formula><mml:math id="inf55"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> have opposite signs for any connectivity matrix (given the microcircuit) and for any baseline activity. This predicts that in the regime where SST activity has a positive response to excitatory input targeting VIP, SST has to have a negative response to external input targeting SST. In addition, our results are in line with experimental studies that show that VIP interneurons play an important role in cortical activity modulation (<xref ref-type="bibr" rid="bib23">Mesik et al., 2015</xref>; <xref ref-type="bibr" rid="bib8">Ibrahim et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">Jackson et al., 2016</xref>).</p><p>Our approach constitutes a general conceptual framework in which previous work regarding complex cortical interactions can be better understood (<xref ref-type="bibr" rid="bib36">Tsodyks et al., 1997</xref>; <xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>; <xref ref-type="bibr" rid="bib20">Litwin-Kumar et al., 2016</xref>). The analysis of the response matrix shows that for the given microcircuit structure all terms of the matrix can be positive or negative. This is not the case in E-I networks (networks with one excitatory (E) population and only one inhibitory (I) population) (<xref ref-type="bibr" rid="bib36">Tsodyks et al., 1997</xref>; <xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>). In that case <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf58"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are always positive, <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is always negative and only <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can have both signs (see Materials and methods). In this sense, having more than one inhibitory population results in a much more versatile network. Another important point that can be derived from our calculations is the relationship between response reversal and inhibition stabilized networks (ISN) (<xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>). Looking at the terms of the response matrix for an E-I network, we can see that the condition to have response reversal and the condition to be an ISN is the same: <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> has to be larger than <inline-formula><mml:math id="inf62"><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup></mml:math></inline-formula>. When analysing networks with more than one inhibitory population the relationship is not necessarily bidirectional any more. In the network that we analyzed, we found that in the high baseline activity the network is in the ISN regime and <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is positive (as observed in [<xref ref-type="bibr" rid="bib20">Litwin-Kumar et al., 2016</xref>), whereas in the low baseline activity the network is not in the ISN regime and <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is negative, so in this case there is a clear relationship between being an ISN and exhibiting response reversal. However, the condition for other cases of response reversal such as <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> do not involve <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and therefore do not require the network to be an ISN.</p><p>Finally, this study provides a parsimonious yet powerful explanation to striking observations of interneuronal circuits in V1 (<xref ref-type="bibr" rid="bib4">Fu et al., 2014</xref>; <xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>; <xref ref-type="bibr" rid="bib18">Lee et al., 2017</xref>) without requiring the assumption of top-down excitatory inputs explicitly targeting SST or PV neurons. Both our computational neural network model and the approach presented here (the response matrix analysis) go beyond circuit dynamics in mice V1 and can be easily applied to other species and cortical areas. By extending previous works (<xref ref-type="bibr" rid="bib36">Tsodyks et al., 1997</xref>; <xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>), it naturally explains the response reversal observed in cat visual cortex (<xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>). It could also be applied to explain similar phenomena observed in mouse primary auditory cortex (<xref ref-type="bibr" rid="bib35">Seybold et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Kuchibhotla et al., 2017</xref>). In particular, in <xref ref-type="bibr" rid="bib14">Kuchibhotla et al. (2017</xref>), the authors find that locomotion reduces the activity of excitatory cells. Assuming that the main modulation in the circuit is mediated by VIP cells this observation implies that <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> which is the case when the connections <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula> are strong enough. In mouse somatosensory cortex, activating VIP neurons results in an intuitive decrease in SST activity, instead of a response reversal (<xref ref-type="bibr" rid="bib16">Lee et al., 2013</xref>). As our results suggest, this qualitative difference between V1 and somatosensory cortex may be explained by the quantitative difference between their circuit architectures: in a recent study the authors showed that cell densities of different types of interneurons differ substantially across cortical areas resulting in counterintuitive impacts on circuit responses (<xref ref-type="bibr" rid="bib13">Kim et al., 2017</xref>). These responses can be readily understood using the response matrix.</p><p>In this work, we mainly focused on steady-state responses. However, neural responses in many cortical areas, including primary auditory cortex, are largely transient and dynamical (<xref ref-type="bibr" rid="bib38">Wehr and Zador, 2003</xref>). In addition, synaptic connections to and from interneurons are often subject to short-term plasticity (<xref ref-type="bibr" rid="bib32">Reyes et al., 1998</xref>). Understanding transient dynamics in nonlinear, multi-type interneuronal circuits would be an important topic for future research.</p><p>We have shown that similar to the now well-known paradoxical effect that the presence of a single inhibitory neuron type can cause (<xref ref-type="bibr" rid="bib36">Tsodyks et al., 1997</xref>; <xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>), the presence of multiple types of interneurons has an even stronger impact on the activity of neural circuits. We have also exposed the effect of nonlinearity of the f-I curve. Our analysis suggests that in a circuit with multiple populations, the most interesting circuit behavior is found when spontaneous baseline activity is close to threshold since in that regime responses will change the most with small changes in population rates. These two features significantly broaden the richness of the dynamics of cortical circuits and enhance their usefulness for cognitive and behavioral computations. We conclude that computational models and mathematical analysis are critical to fully understand the dynamics of neural circuits underlying behavior (<xref ref-type="bibr" rid="bib6">Gjorgjieva et al., 2016</xref>), especially when several types of interneurons are involved as intuition alone may be misleading and provide erroneous predictions on such circuits.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Firing-rate-based population model</title><p>The state of the system is characterized by the rates <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. To model the average rate of each population we use a function of the input <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> as the one introduced in <xref ref-type="bibr" rid="bib1">Abbott and Chance (2005</xref>) <disp-formula id="equ2"><label>(1)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV and <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV are the threshold and reset potentials respectively, <inline-formula><mml:math id="inf74"><mml:mi>τ</mml:mi></mml:math></inline-formula> is the membrane time constant and <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> mV. <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the average input to each of the populations and is given by<disp-formula id="equ3"><label>(2)</label><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf77"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV is the reversal potential and <inline-formula><mml:math id="inf78"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> is the membrane conductance. <inline-formula><mml:math id="inf79"><mml:mi>W</mml:mi></mml:math></inline-formula> is the connectivity matrix and therefore <inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the recurrent local input. <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the external input current and <inline-formula><mml:math id="inf82"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> is a constant current that is tuned to obtain the desired baseline activity and we find the specific values by solving the system <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>k</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. For example, for the baseline activity steady-state the background currents needed to obtain the desired rates (1, 10, 3 and 2 Hz for pyramidal, PV, SST and VIP, respectively) are 136.4, 238.8, 92.6 and 91.8 pA. The rate dynamics are given by<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> ms (<xref ref-type="bibr" rid="bib5">Gerstner, 2000</xref>). Since the parameters of the f-I curve are population dependent (see Table 2), different populations will have different rates for the same input. The nonlinearity of the f-I curve has very important consequences. Namely, for low input <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is almost flat, and therefore changes in the input will have almost no effect on the rate. By contrast, for strong input <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> tends asymptotically to a straight line with slope <inline-formula><mml:math id="inf87"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula> and changes in the input will elicit a large change in the rate. As we will show later, this feature is key to reproduce the response reversal observed in the experiments.</p><p>The connectivity matrix <inline-formula><mml:math id="inf88"><mml:mi>W</mml:mi></mml:math></inline-formula> used in the simulations is generated by rejection sampling, that is by generating random matrices that have the microcircuit structure given in <xref ref-type="fig" rid="fig1">Figure 1a</xref> and selecting the ones that produce the desired responses. The simulations of <xref ref-type="fig" rid="fig1">Figures 1</xref> and <xref ref-type="fig" rid="fig2">2</xref> were done with the connectivity matrix given in <xref ref-type="table" rid="table1">Table 1</xref>.</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.009</object-id><label>Table 1.</label><caption><title>Connectivity matrix (in pAs).</title></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th colspan="4">From</th></tr><tr><th/><th/><th>E</th><th>PV</th><th>SST</th><th>VIP</th></tr></thead><tbody><tr><td rowspan="4">to</td><td>E</td><td>2.42</td><td>−0.33</td><td>−0.80</td><td>0</td></tr><tr><td>PV</td><td>2.97</td><td>−3.45</td><td>−2.13</td><td>0</td></tr><tr><td>SST</td><td>4.64</td><td>0</td><td>0</td><td>−2.79</td></tr><tr><td>VIP</td><td>0.71</td><td>0</td><td>−0.16</td><td>0</td></tr></tbody></table></table-wrap><p>Behavioral state is modeled with a constant top-down modulatory current of 10 pA that targets VIP cells. The constant background inputs <inline-formula><mml:math id="inf89"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> are set so that in the absence of the top-down modulatory current, the E, PV, SST and VIP populations will have spontaneous average rates of 1, 10, 3 and 2 Hz, respectively, for the low baseline activity scenario and 30, 50, 30 and 20 Hz for the high baseline activity.</p></sec><sec id="s4-2"><title>Time derivatives of the rates after the onset of modulation</title><p>In this section, we calculate analytically the changes in rate right after the onset of the modulatory current. The intuition behind these calculations is that the initial change in activity of a population is driven by the fastest path from the external input to the neurons in that population.</p><p>We assume that the system is at a fixed point (therefore <inline-formula><mml:math id="inf90"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all populations) and that at time <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> an excitatory top-down modulatory current targets the VIP population. Taking into account that the time derivatives of the rates are given by <xref ref-type="disp-formula" rid="equ4">Equation (3)</xref> and since <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is monotonously increasing and the modulatory current <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, then <inline-formula><mml:math id="inf94"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will be positive and all other derivatives will still be 0. In order to estimate the behavior of the initial slope of <inline-formula><mml:math id="inf95"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, we calculate the second derivatives at <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ5"><label>(4)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where in the last step we used the fact that <inline-formula><mml:math id="inf97"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> except for VIP. Since <inline-formula><mml:math id="inf98"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>, <inline-formula><mml:math id="inf99"><mml:msubsup><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf100"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> are positive, the sign of <inline-formula><mml:math id="inf101"><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> will depend on the sign of <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. In particular, for SST we obtain<disp-formula id="equ6"><label>(5)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>S</mml:mi></mml:msubsup></mml:mfrac><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>meaning that in all regimes the initial (transient) response of the SST population to top-down modulation targeting VIP cells will be negative.</p></sec><sec id="s4-3"><title>Response matrix and response reversal</title><p>In order to characterize the response of a population to external excitatory input to the network we calculate how its rate will change for a small change in external input. We focus on stationary states <inline-formula><mml:math id="inf103"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. If we apply a small perturbation to the external input <inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the network will reach a new stationary state<disp-formula id="equ7"><label>(6)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>O</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf105"><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the derivative of <inline-formula><mml:math id="inf106"><mml:mi>f</mml:mi></mml:math></inline-formula> with respect to <inline-formula><mml:math id="inf107"><mml:mi>V</mml:mi></mml:math></inline-formula> and<disp-formula id="equ8"><label>(7)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, when we linearize <inline-formula><mml:math id="inf109"><mml:mi>f</mml:mi></mml:math></inline-formula> around <inline-formula><mml:math id="inf110"><mml:mi>V</mml:mi></mml:math></inline-formula> and ignore terms of order <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and higher we obtain the following self-consistent equation<disp-formula id="equ9"><label>(8)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We define the entries of response matrix as the derivative <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>, which can be obtained from the limit <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in the system of equations given by (<xref ref-type="disp-formula" rid="equ9">Equation 8</xref>) and in matrix form can be written as<disp-formula id="equ10"><label>(9)</label><mml:math id="m10"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf114"><mml:mi>D</mml:mi></mml:math></inline-formula> is a diagonal matrix with entries <inline-formula><mml:math id="inf115"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. As it was explained in the results section, the nonlinear behavior of the terms <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is essential to explain the response reversal regime. <inline-formula><mml:math id="inf117"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> becomes arbitrarily large as <inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and decreases monotonically to <inline-formula><mml:math id="inf119"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> when <inline-formula><mml:math id="inf120"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>In Table 3, we give the explicit formulas to all the entries of the response matrix in terms of the entries of the connectivity matrix <inline-formula><mml:math id="inf121"><mml:mi>W</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:mi>D</mml:mi></mml:math></inline-formula> (we denote <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf124"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mtext>det</mml:mtext><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>). Note that, because of the complex interactions in the network, the sign of <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is never determined exclusively by that of <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p></sec><sec id="s4-4"><title>Random network model</title><p>We consider a network with 800 E units, 100 PV units, 50 SST units and 50 VIP units. Each unit within a population has the same f-I curve with the parameters in <xref ref-type="table" rid="table2">Table 2</xref>. The probabilities <inline-formula><mml:math id="inf128"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of a connection from each unit in population <inline-formula><mml:math id="inf129"><mml:mi>j</mml:mi></mml:math></inline-formula> to each unit in population <inline-formula><mml:math id="inf130"><mml:mi>i</mml:mi></mml:math></inline-formula> are estimated from data (<xref ref-type="bibr" rid="bib29">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib10">Jiang et al., 2015-11</xref>) and are given in <xref ref-type="table" rid="table4">Table 4</xref>.</p><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.010</object-id><label>Table 2.</label><caption><title>Population-dependent parameters.</title></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>E</th><th>PV</th><th>SST</th><th>VIP</th></tr></thead><tbody><tr><th><inline-formula><mml:math id="inf131"><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula></th><td>6.25 nS</td><td>10 nS</td><td>five nS</td><td>five nS</td></tr><tr><th><inline-formula><mml:math id="inf132"><mml:mi>τ</mml:mi></mml:math></inline-formula></th><td>28 ms</td><td>8 ms</td><td>16 ms</td><td>16 ms</td></tr></tbody></table></table-wrap><table-wrap id="table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.011</object-id><label>Table 3.</label><caption><title>Entries of the respone matrix.</title></caption><table frame="hsides" rules="groups"><tbody><tr><td><inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf134"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf135"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf136"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf137"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf138"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf139"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf140"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf141"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf142"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf143"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf144"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf145"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf146"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf147"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf148"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap><table-wrap id="table4" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.012</object-id><label>Table 4.</label><caption><title>Connection probabilities for the random network model.</title></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th colspan="4">From</th></tr><tr><th/><th/><th>E</th><th>PV</th><th>SST</th><th>VIP</th></tr></thead><tbody><tr><th rowspan="4">to</th><th>E</th><td>0.02</td><td>1</td><td>1</td><td>0</td></tr><tr><th>PV</th><td>0.01</td><td>1</td><td>0.85</td><td>0</td></tr><tr><th>SST</th><td>0.01</td><td>0</td><td>0</td><td>−0.55</td></tr><tr><th>VIP</th><td>0.01</td><td>0</td><td>0.5</td><td>0</td></tr></tbody></table></table-wrap><p>The strengths of the connections are rescaled so that the average input of a unit in population <inline-formula><mml:math id="inf149"><mml:mi>i</mml:mi></mml:math></inline-formula> from all units in population <inline-formula><mml:math id="inf150"><mml:mi>j</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf151"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as given in <xref ref-type="table" rid="table1">Table 1</xref>. More specifically, each unit in population <inline-formula><mml:math id="inf152"><mml:mi>i</mml:mi></mml:math></inline-formula> will receive in average <inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> projections from population <inline-formula><mml:math id="inf154"><mml:mi>j</mml:mi></mml:math></inline-formula> (where <inline-formula><mml:math id="inf155"><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is the number of units in population <inline-formula><mml:math id="inf156"><mml:mi>j</mml:mi></mml:math></inline-formula>) and therefore the weight of these connections will be <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>Top-down modulatory current and background input is identical to all units within the same population and has the same value as in the population based model.</p></sec><sec id="s4-5"><title>Mouse V1 model</title><p>In the simulations of V1 activity, we use the connectivity matrix given in <xref ref-type="table" rid="table5">Table 5</xref>.</p><table-wrap id="table5" position="float"><object-id pub-id-type="doi">10.7554/eLife.29742.013</object-id><label>Table 5.</label><caption><title>Connectivity matrix for the mouse V1 model (in pAs).</title></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th colspan="4">From</th></tr><tr><th/><th/><th>E</th><th>PV</th><th>SST</th><th>VIP</th></tr></thead><tbody><tr><td rowspan="4">to</td><td>E</td><td>3.30</td><td>−3.48</td><td>−2.98</td><td>0</td></tr><tr><td>PV</td><td>1.73</td><td>−4.25</td><td>−1.07</td><td>0</td></tr><tr><td>SST</td><td>3.50</td><td>0</td><td>0</td><td>−4.51</td></tr><tr><td>VIP</td><td>0.53</td><td>0</td><td>−0.13</td><td>0</td></tr></tbody></table></table-wrap><p>We model visual input with an external excitatory current that targets E and SST cells. In the experiments in (<xref ref-type="bibr" rid="bib28">Pakan et al., 2016</xref>) and in the preprint (<xref ref-type="bibr" rid="bib3">Dipoppa et al., 2017</xref>) the authors consider three levels of visual stimulation which are: darkness, gray screen and grating. To model darkness condition, we assume a total absence of visual stimulation (therefore <inline-formula><mml:math id="inf158"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> pA, <inline-formula><mml:math id="inf159"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> pA). For gray screen, we use a small input current to the excitatory population (<inline-formula><mml:math id="inf160"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> pA, <inline-formula><mml:math id="inf161"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> pA). Finally to model different grating diameters the value of the input is a sigmoid function of the grating diameter <inline-formula><mml:math id="inf162"><mml:mi>θ</mml:mi></mml:math></inline-formula>:<disp-formula id="equ11"><label>(10)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf163"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf165"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> pA, <inline-formula><mml:math id="inf166"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> pA. With this parameters E cells receive center input (input saturates for diameters <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> deg) and SST cells receive surround input (input to SST saturates for diameters of <inline-formula><mml:math id="inf168"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:math></inline-formula> deg) (<xref ref-type="bibr" rid="bib3">Dipoppa et al., 2017</xref>).</p><p>To demonstrate that our results do hold for a wide range of connectivity matrices and do not have to be fine tuned, we simulate several different connectivity matrices that produce the same qualitative behavior. We also make perturbations of these matrices by multiplying each entry by a random variable uniformly distributed in the interval <inline-formula><mml:math id="inf169"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.9</mml:mn><mml:mo>,</mml:mo><mml:mn>1.1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. This amounts to randomly modifying each connection within <inline-formula><mml:math id="inf170"><mml:mo>±</mml:mo></mml:math></inline-formula>10% of its original value (see <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>).</p><p>In the alternative models of <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref> where visual stimulus input also targets PV cells, we use <inline-formula><mml:math id="inf171"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> pA for darkness, <inline-formula><mml:math id="inf172"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> pA for gray screen and <inline-formula><mml:math id="inf173"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf174"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> pA for gratings.</p></sec><sec id="s4-6"><title>Response matrix for an E-I network</title><p>For the sake of completeness, here we analyze the response matrix for a fully connected E-I network (<xref ref-type="bibr" rid="bib36">Tsodyks et al., 1997</xref>, <xref ref-type="bibr" rid="bib27">Ozeki et al., 2009</xref>) . The connectivity matrix is<disp-formula id="equ12"><label>(11)</label><mml:math id="m12"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>and therefore the response matrix is<disp-formula id="equ13"><label>(12)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>-</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Note that the only term that can change sign is <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> so the only population that can exhibit response reversal is the <inline-formula><mml:math id="inf177"><mml:mi>I</mml:mi></mml:math></inline-formula> population. Furthermore, note that the condition for having response reversal (<inline-formula><mml:math id="inf178"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>E</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>) is the same that defines the ISN regime, so this two properties are equivalent in the E-I network.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This work was supported by the NIH grant R01MH062349, the ONR grant N00014-17-1-2041, STCSM grants 14JC1404900 and 15JC1400104.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Investigation, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Funding acquisition, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.29742.014</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-29742-transrepform-v3.pdf"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Chance</surname> <given-names>FS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Drivers and modulators from push-pull and balanced synaptic input</article-title><source>Progress in Brain Research</source><volume>149</volume><fpage>147</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1016/S0079-6123(05)49011-1</pub-id><pub-id pub-id-type="pmid">16226582</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adesnik</surname> <given-names>H</given-names></name><name><surname>Bruns</surname> <given-names>W</given-names></name><name><surname>Taniguchi</surname> <given-names>H</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A neural circuit for spatial summation in visual cortex</article-title><source>Nature</source><volume>490</volume><fpage>226</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1038/nature11526</pub-id><pub-id pub-id-type="pmid">23060193</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Dipoppa</surname> <given-names>M</given-names></name><name><surname>Ranson</surname> <given-names>A</given-names></name><name><surname>Krumin</surname> <given-names>M</given-names></name><name><surname>Pachitariu</surname> <given-names>M</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Vision and locomotion shape the interactions between neuron types in mouse visual cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/058396</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname> <given-names>Y</given-names></name><name><surname>Tucciarone</surname> <given-names>JM</given-names></name><name><surname>Espinosa</surname> <given-names>JS</given-names></name><name><surname>Sheng</surname> <given-names>N</given-names></name><name><surname>Darcy</surname> <given-names>DP</given-names></name><name><surname>Nicoll</surname> <given-names>RA</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Stryker</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A cortical circuit for gain control by behavioral state</article-title><source>Cell</source><volume>156</volume><fpage>1139</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2014.01.050</pub-id><pub-id pub-id-type="pmid">24630718</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Population dynamics of spiking neurons: fast transients, asynchronous states, and locking</article-title><source>Neural Computation</source><volume>12</volume><fpage>43</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1162/089976600300015899</pub-id><pub-id pub-id-type="pmid">10636933</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gjorgjieva</surname> <given-names>J</given-names></name><name><surname>Drion</surname> <given-names>G</given-names></name><name><surname>Marder</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Computational implications of biophysical diversity and multiple timescales in neurons and synapses for circuit performance</article-title><source>Current Opinion in Neurobiology</source><volume>37</volume><fpage>44</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2015.12.008</pub-id><pub-id pub-id-type="pmid">26774694</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawrylycz</surname> <given-names>M</given-names></name><name><surname>Anastassiou</surname> <given-names>C</given-names></name><name><surname>Arkhipov</surname> <given-names>A</given-names></name><name><surname>Berg</surname> <given-names>J</given-names></name><name><surname>Buice</surname> <given-names>M</given-names></name><name><surname>Cain</surname> <given-names>N</given-names></name><name><surname>Gouwens</surname> <given-names>NW</given-names></name><name><surname>Gratiy</surname> <given-names>S</given-names></name><name><surname>Iyer</surname> <given-names>R</given-names></name><name><surname>Lee</surname> <given-names>JH</given-names></name><name><surname>Mihalas</surname> <given-names>S</given-names></name><name><surname>Mitelut</surname> <given-names>C</given-names></name><name><surname>Olsen</surname> <given-names>S</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name><name><surname>Teeter</surname> <given-names>C</given-names></name><name><surname>de Vries</surname> <given-names>S</given-names></name><name><surname>Waters</surname> <given-names>J</given-names></name><name><surname>Zeng</surname> <given-names>H</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><collab>MindScope</collab></person-group><year iso-8601-date="2016">2016</year><article-title>Inferring cortical function in the mouse visual system through large-scale systems neuroscience</article-title><source>PNAS</source><volume>113</volume><fpage>7337</fpage><lpage>7344</lpage><pub-id pub-id-type="doi">10.1073/pnas.1512901113</pub-id><pub-id pub-id-type="pmid">27382147</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ibrahim</surname> <given-names>LA</given-names></name><name><surname>Mesik</surname> <given-names>L</given-names></name><name><surname>Ji</surname> <given-names>XY</given-names></name><name><surname>Fang</surname> <given-names>Q</given-names></name><name><surname>Li</surname> <given-names>HF</given-names></name><name><surname>Li</surname> <given-names>YT</given-names></name><name><surname>Zingg</surname> <given-names>B</given-names></name><name><surname>Zhang</surname> <given-names>LI</given-names></name><name><surname>Tao</surname> <given-names>HW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cross-modality sharpening of visual cortical processing through layer-1-mediated inhibition and disinhibition</article-title><source>Neuron</source><volume>89</volume><fpage>1031</fpage><lpage>1045</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.01.027</pub-id><pub-id pub-id-type="pmid">26898778</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackson</surname> <given-names>J</given-names></name><name><surname>Ayzenshtat</surname> <given-names>I</given-names></name><name><surname>Karnani</surname> <given-names>MM</given-names></name><name><surname>Yuste</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>VIP+ interneurons control neocortical activity across brain states</article-title><source>Journal of Neurophysiology</source><volume>115</volume><fpage>3008</fpage><lpage>3017</lpage><pub-id pub-id-type="doi">10.1152/jn.01124.2015</pub-id><pub-id pub-id-type="pmid">26961109</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname> <given-names>X</given-names></name><name><surname>Shen</surname> <given-names>S</given-names></name><name><surname>Cadwell</surname> <given-names>CR</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name><name><surname>Sinz</surname> <given-names>F</given-names></name><name><surname>Ecker</surname> <given-names>AS</given-names></name><name><surname>Patel</surname> <given-names>S</given-names></name><name><surname>Tolias</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Principles of connectivity among morphologically defined cell types in adult neocortex</article-title><source>Science</source><volume>350</volume><elocation-id>aac9462</elocation-id><pub-id pub-id-type="doi">10.1126/science.aac9462</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keller</surname> <given-names>GB</given-names></name><name><surname>Bonhoeffer</surname> <given-names>T</given-names></name><name><surname>Hübener</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Sensorimotor mismatch signals in primary visual cortex of the behaving mouse</article-title><source>Neuron</source><volume>74</volume><fpage>809</fpage><lpage>815</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.03.040</pub-id><pub-id pub-id-type="pmid">22681686</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kepecs</surname> <given-names>A</given-names></name><name><surname>Fishell</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Interneuron cell types are fit to function</article-title><source>Nature</source><volume>505</volume><fpage>318</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1038/nature12983</pub-id><pub-id pub-id-type="pmid">24429630</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>Y</given-names></name><name><surname>Yang</surname> <given-names>GR</given-names></name><name><surname>Pradhan</surname> <given-names>K</given-names></name><name><surname>Venkataraju</surname> <given-names>KU</given-names></name><name><surname>Bota</surname> <given-names>M</given-names></name><name><surname>García Del Molino</surname> <given-names>LC</given-names></name><name><surname>Fitzgerald</surname> <given-names>G</given-names></name><name><surname>Ram</surname> <given-names>K</given-names></name><name><surname>He</surname> <given-names>M</given-names></name><name><surname>Levine</surname> <given-names>JM</given-names></name><name><surname>Mitra</surname> <given-names>P</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name><name><surname>Osten</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Brain-wide maps reveal stereotyped cell-type-based cortical architecture and subcortical sexual dimorphism</article-title><source>Cell</source><volume>171</volume><fpage>456</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2017.09.020</pub-id><pub-id pub-id-type="pmid">28985566</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuchibhotla</surname> <given-names>KV</given-names></name><name><surname>Gill</surname> <given-names>JV</given-names></name><name><surname>Lindsay</surname> <given-names>GW</given-names></name><name><surname>Papadoyannis</surname> <given-names>ES</given-names></name><name><surname>Field</surname> <given-names>RE</given-names></name><name><surname>Sten</surname> <given-names>TA</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>Froemke</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Parallel processing by cortical inhibition enables context-dependent behavior</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>62</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/nn.4436</pub-id><pub-id pub-id-type="pmid">27798631</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>SH</given-names></name><name><surname>Kwan</surname> <given-names>AC</given-names></name><name><surname>Zhang</surname> <given-names>S</given-names></name><name><surname>Phoumthipphavong</surname> <given-names>V</given-names></name><name><surname>Flannery</surname> <given-names>JG</given-names></name><name><surname>Masmanidis</surname> <given-names>SC</given-names></name><name><surname>Taniguchi</surname> <given-names>H</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name><name><surname>Dan</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Activation of specific interneurons improves V1 feature selectivity and visual perception</article-title><source>Nature</source><volume>488</volume><fpage>379</fpage><lpage>383</lpage><pub-id pub-id-type="doi">10.1038/nature11312</pub-id><pub-id pub-id-type="pmid">22878719</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Kruglikov</surname> <given-names>I</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Fishell</surname> <given-names>G</given-names></name><name><surname>Rudy</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A disinhibitory circuit mediates motor integration in the somatosensory cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1662</fpage><lpage>1670</lpage><pub-id pub-id-type="doi">10.1038/nn.3544</pub-id><pub-id pub-id-type="pmid">24097044</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>JH</given-names></name><name><surname>Mihalas</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cell-type specific connectivity accounts for diverse in vivo functional roles of inhibitory neurons in V1</article-title><source>BMC Neuroscience</source><volume>16</volume><elocation-id>P165</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2202-16-S1-P165</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>JH</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Mihalas</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A computational analysis of the function of three inhibitory cell types in contextual visual processing</article-title><source>Frontiers in Computational Neuroscience</source><volume>11</volume><elocation-id>28</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2017.00028</pub-id><pub-id pub-id-type="pmid">28487644</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>JH</given-names></name><name><surname>Mihalas</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Visual processing mode switching regulated by VIP cells</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>1843</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-01830-0</pub-id><pub-id pub-id-type="pmid">28500299</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname> <given-names>A</given-names></name><name><surname>Rosenbaum</surname> <given-names>R</given-names></name><name><surname>Doiron</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Inhibitory stabilization and visual coding in cortical circuits with multiple interneuron subtypes</article-title><source>Journal of Neurophysiology</source><volume>115</volume><fpage>1399</fpage><lpage>1409</lpage><pub-id pub-id-type="doi">10.1152/jn.00732.2015</pub-id><pub-id pub-id-type="pmid">26740531</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname> <given-names>E</given-names></name><name><surname>Goeritz</surname> <given-names>ML</given-names></name><name><surname>Otopalik</surname> <given-names>AG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Robust circuit rhythms in small circuits arise from variable circuit components and mechanisms</article-title><source>Current Opinion in Neurobiology</source><volume>31</volume><fpage>156</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.10.012</pub-id><pub-id pub-id-type="pmid">25460072</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mejias</surname> <given-names>JF</given-names></name><name><surname>Longtin</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Differential effects of excitatory and inhibitory heterogeneity on the gain and asynchronous state of sparse cortical networks</article-title><source>Frontiers in Computational Neuroscience</source><volume>8</volume><elocation-id>107</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2014.00107</pub-id><pub-id pub-id-type="pmid">25309409</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mesik</surname> <given-names>L</given-names></name><name><surname>Ma</surname> <given-names>WP</given-names></name><name><surname>Li</surname> <given-names>LY</given-names></name><name><surname>Ibrahim</surname> <given-names>LA</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Zhang</surname> <given-names>LI</given-names></name><name><surname>Tao</surname> <given-names>HW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Functional response properties of VIP-expressing inhibitory neurons in mouse visual and auditory cortex</article-title><source>Frontiers in Neural Circuits</source><volume>9</volume><elocation-id>22</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2015.00022</pub-id><pub-id pub-id-type="pmid">26106301</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>Troyer</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Neural noise can explain expansive, power-law nonlinearities in neural response functions</article-title><source>Journal of Neurophysiology</source><volume>87</volume><fpage>653</fpage><lpage>659</lpage><pub-id pub-id-type="doi">10.1152/jn.00425.2001</pub-id><pub-id pub-id-type="pmid">11826034</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murphy</surname> <given-names>BK</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Multiplicative gain changes are induced by excitation or inhibition alone</article-title><source>Journal of Neuroscience</source><volume>23</volume><fpage>10040</fpage><lpage>10051</lpage><pub-id pub-id-type="pmid">14602818</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niell</surname> <given-names>CM</given-names></name><name><surname>Stryker</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Modulation of visual responses by behavioral state in mouse visual cortex</article-title><source>Neuron</source><volume>65</volume><fpage>472</fpage><lpage>479</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.01.033</pub-id><pub-id pub-id-type="pmid">20188652</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozeki</surname> <given-names>H</given-names></name><name><surname>Finn</surname> <given-names>IM</given-names></name><name><surname>Schaffer</surname> <given-names>ES</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>Ferster</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Inhibitory stabilization of the cortical network underlies visual surround suppression</article-title><source>Neuron</source><volume>62</volume><fpage>578</fpage><lpage>592</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.03.028</pub-id><pub-id pub-id-type="pmid">19477158</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pakan</surname> <given-names>JM</given-names></name><name><surname>Lowe</surname> <given-names>SC</given-names></name><name><surname>Dylda</surname> <given-names>E</given-names></name><name><surname>Keemink</surname> <given-names>SW</given-names></name><name><surname>Currie</surname> <given-names>SP</given-names></name><name><surname>Coutts</surname> <given-names>CA</given-names></name><name><surname>Rochefort</surname> <given-names>NL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Behavioral-state modulation of inhibition is context-dependent and cell type specific in mouse visual cortex</article-title><source>eLife</source><volume>5</volume><elocation-id>e14985</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.14985</pub-id><pub-id pub-id-type="pmid">27552056</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeffer</surname> <given-names>CK</given-names></name><name><surname>Xue</surname> <given-names>M</given-names></name><name><surname>He</surname> <given-names>M</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inhibition of inhibition in visual cortex: the logic of connections between molecularly distinct interneurons</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1068</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1038/nn.3446</pub-id><pub-id pub-id-type="pmid">23817549</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phillips</surname> <given-names>EA</given-names></name><name><surname>Hasenstaub</surname> <given-names>AR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Asymmetric effects of activating and inactivating cortical interneurons</article-title><source>eLife</source><volume>5</volume><elocation-id>e18383</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.18383</pub-id><pub-id pub-id-type="pmid">27719761</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimer</surname> <given-names>J</given-names></name><name><surname>Froudarakis</surname> <given-names>E</given-names></name><name><surname>Cadwell</surname> <given-names>CR</given-names></name><name><surname>Yatsenko</surname> <given-names>D</given-names></name><name><surname>Denfield</surname> <given-names>GH</given-names></name><name><surname>Tolias</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pupil fluctuations track fast switching of cortical states during quiet wakefulness</article-title><source>Neuron</source><volume>84</volume><fpage>355</fpage><lpage>362</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.09.033</pub-id><pub-id pub-id-type="pmid">25374359</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reyes</surname> <given-names>A</given-names></name><name><surname>Lujan</surname> <given-names>R</given-names></name><name><surname>Rozov</surname> <given-names>A</given-names></name><name><surname>Burnashev</surname> <given-names>N</given-names></name><name><surname>Somogyi</surname> <given-names>P</given-names></name><name><surname>Sakmann</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Target-cell-specific facilitation and depression in neocortical circuits</article-title><source>Nature Neuroscience</source><volume>1</volume><fpage>279</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1038/1092</pub-id><pub-id pub-id-type="pmid">10195160</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudy</surname> <given-names>B</given-names></name><name><surname>Fishell</surname> <given-names>G</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Hjerling-Leffler</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Three groups of interneurons account for nearly 100% of neocortical GABAergic neurons</article-title><source>Developmental Neurobiology</source><volume>71</volume><fpage>45</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1002/dneu.20853</pub-id><pub-id pub-id-type="pmid">21154909</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saleem</surname> <given-names>AB</given-names></name><name><surname>Ayaz</surname> <given-names>A</given-names></name><name><surname>Jeffery</surname> <given-names>KJ</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Integration of visual motion and locomotion in mouse visual cortex</article-title><source>Nature Neuroscience</source><volume>16</volume><elocation-id>1864</elocation-id><lpage>1869</lpage><pub-id pub-id-type="doi">10.1038/nn.3567</pub-id><pub-id pub-id-type="pmid">24185423</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seybold</surname> <given-names>BA</given-names></name><name><surname>Phillips</surname> <given-names>EA</given-names></name><name><surname>Schreiner</surname> <given-names>CE</given-names></name><name><surname>Hasenstaub</surname> <given-names>AR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Inhibitory actions unified by network integration</article-title><source>Neuron</source><volume>87</volume><fpage>1181</fpage><lpage>1192</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.09.013</pub-id><pub-id pub-id-type="pmid">26402602</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname> <given-names>MV</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Paradoxical effects of external modulation of inhibitory interneurons</article-title><source>Journal of Neuroscience</source><volume>17</volume><fpage>4382</fpage><lpage>4388</lpage><pub-id pub-id-type="pmid">9151754</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>X-J</given-names></name><name><surname>Tegner</surname> <given-names>J</given-names></name><name><surname>Constantinidis</surname> <given-names>C</given-names></name><name><surname>Goldman-Rakic</surname> <given-names>PS</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Division of labor among distinct subtypes of inhibitory neurons in a cortical microcircuit of working memory</article-title><source>PNAS</source><volume>101</volume><fpage>1368</fpage><lpage>1373</lpage><pub-id pub-id-type="doi">10.1073/pnas.0305337101</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wehr</surname> <given-names>M</given-names></name><name><surname>Zador</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Balanced inhibition underlies tuning and sharpens spike timing in auditory cortex</article-title><source>Nature</source><volume>426</volume><elocation-id>442</elocation-id><lpage>446</lpage><pub-id pub-id-type="doi">10.1038/nature02116</pub-id><pub-id pub-id-type="pmid">14647382</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>GR</given-names></name><name><surname>Murray</surname> <given-names>JD</given-names></name><name><surname>Wang</surname> <given-names>XJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A dendritic disinhibitory circuit mechanism for pathway-specific gating</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>12815</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms12815</pub-id><pub-id pub-id-type="pmid">27649374</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname> <given-names>GR</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A disinhibitory motif and flexible information routing in the brain</article-title><source>Current Opinion in Neurobiology</source><comment>In press</comment></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.29742.016</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Latham</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution>University College London</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Paradoxical response reversal of top-down modulation in cortical circuits with three interneuron types&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Timothy Behrens (Senior Editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This manuscript presents some important insights into the diverse, counterintuitive behaviors of circuits with interacting inhibitory neuron populations. The authors show that, in a circuit with three types of interneuron, the functional sign of interactions can change depending on the exact activity level of the different cell types in the network – a population that inhibits another in one regime may suppress it in another regime. The essential features to enable this are: 1) more than one type of interneuron, 2) with diverse thresholds/nonlinearities. They relate this result to the experimental literature through citations, and directly compare their model results to data figures from other authors. In the discussion, they give testable predictions.</p><p>Essential revisions:</p><p>1) In the standard mode (van Vreeswijk and Sompolinsky, Neural Computation 1998), connectivity is high, and so the diagonal terms, d<sub>i</sub>, are large. In this regime, there is no response reversal. It's an open question exactly how high connectivity is; it certainly isn't infinity, which is what physicists would like it to be, and the effective strength of the connectivity drops as the firing rate drops. However, when firing rates drop, fluctuations become important, and firing rate models become less believable. We're not asking the authors to do full network simulations (although we would suggest that it would be an interesting avenue for future research). However, they should at least comment on this. Even better would be a back of the envelope calculation showing that the connection strengths between populations are in the right range.</p><p>2) The authors do a good job citing the relevant literature. However they avoid framing their work in the context of inhibitory stabilized networks (ISNs). ISNs have very strong recurrent excitation that needs to be stabilized by recurrent inhibition (Ozeki et al.), and show the signature of a complex transient before settling in the equilibrium state – reminiscent of the author's <xref ref-type="fig" rid="fig1">Figure 1D</xref>. As remarked in the manuscript the sign flip of M<sub>SV</sub> requires w<sub>EE</sub> to be sufficiently large. Is the network an ISN? <xref ref-type="fig" rid="fig2">Figure 2</xref> of Litwin-Kumar et al. (2016) extends ISNs to circuits with multiple interneurons subtypes, and they show that if the total inhibition received by E cells reduces under VIP stimulation then the network is an ISN. What regime is the author's model in? Is this a useful label for their network?</p><p>3) In <xref ref-type="fig" rid="fig2">Figure 2D</xref>, M<sub>EE</sub> is negative (-0.35), and if we understand things correctly, it's always negative in the high gain regime. Thus, in the high baseline activity state, an input to the pyramidal neuron population will result in a decrease of pyramidal neuron firing rates. This is at odds with most (all?) data sets. The authors remark on this feature in the last paragraph of the subsection “Circuit behavior explained by response matrix”, but do not address the plausibility of this prediction. Do the authors think this result is a problem for their model? More generally, with new parameters can the authors explain the sign flip in M<sub>SV</sub> without a sign flip in M<sub>EE</sub> or are these tethered together somehow?</p><p>4) Dipoppa et al. 2016 is important for justifying the model and the authors cite it frequently (and even republish some of its figures). But this paper has not been peer-reviewed (it's a Biorxiv report), giving it the same veridical status as a personal communication or SFN abstract. It's not appropriate for a peer-reviewed manuscript to depend on data that has not been reviewed. In addition, we're not sure how this will affect Dipoppa et al.'s attempts to get their work published. <italic>eLife</italic> is peer reviewed, and many journals won't let you republish work that's already published in a peer reviewed journal. In this manuscript, the authors actually take figures out of the other group's non-reviewed preprint and publish them in their own paper.</p><p>It seems to us that Dipoppa et al. is not absolutely essential; <xref ref-type="fig" rid="fig4">Figure 4E</xref> could be dropped without affecting the paper much. If the authors do want to include it, they should do two things. First, they should make it crystal clear that Dipoppa et al. is not peer-reviewed, every single time the citation is made. They can leave no doubt in the readers' minds that data is not yet part of the scientific literature. Second, they should get permission from Dipoppa et al. before publishing their data. We're guessing <italic>eLife</italic> requires this, but even if it doesn't, it's not worth irritating one's colleagues for something that is not essential to one's story.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.29742.017</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) In the standard mode (van Vreeswijk and Sompolinsky, Neural Computation 1998), connectivity is high, and so the diagonal terms, d<sub>i</sub>, are large. In this regime, there is no response reversal. It's an open question exactly how high connectivity is; it certainly isn't infinity, which is what physicists would like it to be, and the effective strength of the connectivity drops as the firing rate drops. However, when firing rates drop, fluctuations become important, and firing rate models become less believable. We're not asking the authors to do full network simulations (although we would suggest that it would be an interesting avenue for future research). However, they should at least comment on this. Even better would be a back of the envelope calculation showing that the connection strengths between populations are in the right range.</p></disp-quote><p>The network in our model is not a balanced network in the sense of [van Vreeswijk and Sompolinsky, 98]. In fact, it is dominated by inhibition (i.e. the sum of all the entries of the connectivity matrix is negative).</p><p>In the section “Random network model” (<xref ref-type="fig" rid="fig3">Figure 3</xref>) we build a network where each population has multiple units and the connections between units are random. In that case the weights are set so that, in average, the input to each unit of population <italic>i</italic> from population <italic>j</italic> is the same as in the population based model. This means that the scaling of the weights in our model is 1/<italic>m</italic> (where <italic>m</italic> is the expected number of connections from population <italic>j</italic> to each unit of population <italic>i</italic>) and not 1/sqrt(<italic>m</italic>) as in [van Vreeswijk and Sompolinsky, 98].</p><p>We have added a sentence in the Materials and methods section “Random network model” (first paragraph) to make this point clearer.</p><disp-quote content-type="editor-comment"><p>2) The authors do a good job citing the relevant literature. However they avoid framing their work in the context of inhibitory stabilized networks (ISNs). ISNs have very strong recurrent excitation that needs to be stabilized by recurrent inhibition (Ozeki et al.), and show the signature of a complex transient before settling in the equilibrium state – reminiscent of the author's <xref ref-type="fig" rid="fig1">Figure 1D</xref>. As remarked in the manuscript the sign flip of M<sub>SV</sub> requires w<sub>EE</sub> to be sufficiently large. Is the network an ISN? <xref ref-type="fig" rid="fig2">Figure 2</xref> of Litwin-Kumar et al. (2016) extends ISNs to circuits with multiple interneurons subtypes, and they show that if the total inhibition received by E cells reduces under VIP stimulation then the network is an ISN. What regime is the author's model in? Is this a useful label for their network?</p></disp-quote><p>For EI networks, the only term of the response matrix that can flip its sign is M<sub>II</sub> (as analyzed in [Tsodyks et al., 97, Ozeki et al., 09]). In order to have M<sub>II</sub> &lt; 0 the network has to be an ISN, so in EI networks having response reversal and being ISN are equivalent.</p><p>For a network with multiple interneuron types, the equivalence no long holds. The condition to realize M<sub>SV</sub> &gt; 0 is W<sub>EE</sub> &gt; d<sup>∞</sup><sub>E,</sub>therefore the network has to be an ISN. However, the sign of other entries of the response matrix does not depend on whether W<sub>EE</sub> is larger or smaller than d<sup>∞</sup><sub>E</sub>, meaning that in general response reversal is not related to ISNs.</p><p>In order to clarify this point we have extended the paragraph of the Discussion where we mention ISNs (fifth paragraph). We have also added a short Materials and methods section analyzing the response matrix for EI networks.</p><disp-quote content-type="editor-comment"><p>3) In <xref ref-type="fig" rid="fig2">Figure 2D</xref>, M<sub>EE</sub> is negative (-0.35), and if we understand things correctly, it's always negative in the high gain regime. Thus, in the high baseline activity state, an input to the pyramidal neuron population will result in a decrease of pyramidal neuron firing rates. This is at odds with most (all?) data sets. The authors remark on this feature in the last paragraph of the subsection “Circuit behavior explained by response matrix”, but do not address the plausibility of this prediction. Do the authors think this result is a problem for their model? More generally, with new parameters can the authors explain the sign flip in M<sub>SV</sub> without a sign flip in M<sub>EE</sub> or are these tethered together somehow?</p></disp-quote><p>The negative value of M<sub>EE</sub> in the high baseline scenario is not a feature of the model, but of the particular matrix that we showed. In fact, it is easy to find other matrices for which M<sub>EE</sub> is always positive.</p><p>In order to avoid confusions we have changed the matrix that we used for <xref ref-type="fig" rid="fig1">figures 1</xref> and <xref ref-type="fig" rid="fig2">2</xref> so that in the current version M<sub>EE</sub> is always positive.</p><disp-quote content-type="editor-comment"><p>4) Dipoppa et al. 2016 is important for justifying the model and the authors cite it frequently (and even republish some of its figures). But this paper has not been peer-reviewed (it's a Biorxiv report), giving it the same veridical status as a personal communication or SFN abstract. It's not appropriate for a peer-reviewed manuscript to depend on data that has not been reviewed. In addition, we're not sure how this will affect Dipoppa et al.'s attempts to get their work published. eLife is peer reviewed, and many journals won't let you republish work that's already published in a peer reviewed journal. In this manuscript, the authors actually take figures out of the other group's non-reviewed preprint and publish them in their own paper.</p><p>It seems to us that Dipoppa et al. is not absolutely essential; <xref ref-type="fig" rid="fig4">Figure 4E</xref> could be dropped without affecting the paper much. If the authors do want to include it, they should do two things. First, they should make it crystal clear that Dipoppa et al. is not peer-reviewed, every single time the citation is made. They can leave no doubt in the readers' minds that data is not yet part of the scientific literature. Second, they should get permission from Dipoppa et al. before publishing their data. We're guessing eLife requires this, but even if it doesn't, it's not worth irritating one's colleagues for something that is not essential to one's story.</p></disp-quote><p>We would like to thank the reviewers for this important remark. Following their advice, we have removed <xref ref-type="fig" rid="fig4">Figure 4E</xref> from the main text and we have included it as a supplement to <xref ref-type="fig" rid="fig4">Figure 4</xref> (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Furthermore, we have explicitly mentioned that [Dipoppa et al., 16] is a preprint whenever we cited it in the text.</p><p>We have also the explicit permission of Dipoppa and his collaborators to present their data in our manuscript.</p></body></sub-article></article>