<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">53385</article-id><article-id pub-id-type="doi">10.7554/eLife.53385</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>NeuroQuery, comprehensive meta-analysis of human brain mapping</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-164262"><name><surname>Dockès</surname><given-names>Jérôme</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5304-2496</contrib-id><email>jerome@dockes.org</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-27700"><name><surname>Poldrack</surname><given-names>Russell A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6755-0259</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-164263"><name><surname>Primet</surname><given-names>Romain</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-164264"><name><surname>Gözükan</surname><given-names>Hande</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-60357"><name><surname>Yarkoni</surname><given-names>Tal</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-164265"><name><surname>Suchanek</surname><given-names>Fabian</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-42423"><name><surname>Thirion</surname><given-names>Bertrand</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-42419"><name><surname>Varoquaux</surname><given-names>Gaël</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1076-5122</contrib-id><email>gael.varoquaux@inria.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution>Inria, CEA, Université Paris-Saclay</institution><addr-line><named-content content-type="city">Essonne</named-content></addr-line><country>France</country></aff><aff id="aff2"><label>2</label><institution>Stanford University</institution><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Inria</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff4"><label>4</label><institution>University of Texas at Austin</institution><addr-line><named-content content-type="city">Austin</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Télécom Paris University</institution><addr-line><named-content content-type="city">Palaiseau</named-content></addr-line><country>France</country></aff><aff id="aff6"><label>6</label><institution>Montréal Neurological Institute, McGill University</institution><addr-line><named-content content-type="city">Montreal</named-content></addr-line><country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Büchel</surname><given-names>Christian</given-names></name><role>Senior Editor</role><aff><institution>University Medical Center Hamburg-Eppendorf</institution><country>Germany</country></aff></contrib><contrib contrib-type="editor"><name><surname>Yeo</surname><given-names>Thomas</given-names></name><role>Reviewing Editor</role><aff><institution>National University of Singapore</institution><country>Singapore</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>04</day><month>03</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e53385</elocation-id><history><date date-type="received" iso-8601-date="2019-11-06"><day>06</day><month>11</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-03-03"><day>03</day><month>03</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Dockès et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Dockès et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-53385-v2.pdf"/><abstract><p>Reaching a global view of brain organization requires assembling evidence on widely different mental processes and mechanisms. The variety of human neuroscience concepts and terminology poses a fundamental challenge to relating brain imaging results across the scientific literature. Existing meta-analysis methods perform statistical tests on sets of publications associated with a particular concept. Thus, large-scale meta-analyses only tackle single terms that occur frequently. We propose a new paradigm, focusing on prediction rather than inference. Our multivariate model <italic>predicts</italic> the spatial distribution of neurological observations, given text describing an experiment, cognitive process, or disease. This approach handles text of arbitrary length and terms that are too rare for standard meta-analysis. We capture the relationships and neural correlates of 7547 neuroscience terms across 13 459 neuroimaging publications. The resulting meta-analytic tool, <ext-link ext-link-type="uri" xlink:href="https://neuroquery.org/query?text=perception+of+rhythm+in+music">neuroquery.org</ext-link>, can ground hypothesis generation and data-analysis priors on a comprehensive view of published findings on the brain.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>meta analysis</kwd><kwd>brain imaging</kwd><kwd>predictive models</kwd><kwd>cognitive ontologies</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution>Digiteo</institution></institution-wrap></funding-source><award-id>2016-1270D - Projet MetaCog</award-id><principal-award-recipient><name><surname>Dockès</surname><given-names>Jérôme</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01MH096906</award-id><principal-award-recipient><name><surname>Yarkoni</surname><given-names>Tal</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-16- CE23-0007-01</award-id><principal-award-recipient><name><surname>Suchanek</surname><given-names>Fabian</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>785907 (HBP SGA2)</award-id><principal-award-recipient><name><surname>Thirion</surname><given-names>Bertrand</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>826421 (VirtualbrainCloud)</award-id><principal-award-recipient><name><surname>Thirion</surname><given-names>Bertrand</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100010785</institution-id><institution>Canada First Research Excellence Fund</institution></institution-wrap></funding-source><award-id>Healthy Brains for Healthy Lives initiative</award-id><principal-award-recipient><name><surname>Varoquaux</surname><given-names>Gael</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>OAC-1649658</award-id><principal-award-recipient><name><surname>Poldrack</surname><given-names>Russell A</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Full-text analysis of the human brain-imaging literature can predict the spatial distribution of observations in the brain given the description of a subject of study.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><sec id="s1-1"><title>Pushing the envelope of meta-analyses</title><p>Each year, thousands of brain-imaging studies explore the links between brain and behavior: more than 6000 publications a year contain the term ‘neuroimaging’ on PubMed. Finding consistent trends in the knowledge acquired across these studies is crucial, as individual studies by themselves seldom have enough statistical power to establish fully trustworthy results (<xref ref-type="bibr" rid="bib5">Button et al., 2013</xref>; <xref ref-type="bibr" rid="bib31">Poldrack et al., 2017</xref>). But compiling an answer to a specific question from this impressive number of results is a daunting task. There are too many studies to manually collect and aggregate their findings. In addition, such a task is fundamentally difficult due to the many different aspects of behavior, as well as the diversity of the protocols used to probe them.</p><p>Meta-analyses can give objective views of the field, to ground a review article or a discussion of new results. Coordinate-Based Meta-Analysis (CBMA) methods (<xref ref-type="bibr" rid="bib15">Laird et al., 2005</xref>; <xref ref-type="bibr" rid="bib46">Wager et al., 2007</xref>; <xref ref-type="bibr" rid="bib9">Eickhoff et al., 2009</xref>) assess the consistency of results across studies, comparing the observed spatial density of reported brain stereotactic coordinates to the null hypothesis of a uniform distribution. Automating CBMA methods across the literature, as in NeuroSynth (<xref ref-type="bibr" rid="bib52">Yarkoni et al., 2011</xref>), enables large-scale analyses of brain-imaging studies, giving excellent statistical power. Existing meta-analysis methods focus on identifying effects reported consistently across the literature, to distinguish true discoveries from noise and artifacts. However, they can only address neuroscience concepts that are easy to define. Choosing which studies to include in a meta-analysis can be challenging. In principle, studies can be manually annotated as carefully as one likes. However, manual meta-analyses are not scalable, and the corresponding degrees of freedom are difficult to control statistically. In what follows, we focus on automated meta-analysis. To automate the selection of studies, the common solution is to rely on terms present in publications. But closely related terms can lead to markedly different meta-analyses (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The lack of a universally established vocabulary or ontology to describe mental processes and disorders is a strong impediment to meta-analysis (<xref ref-type="bibr" rid="bib32">Poldrack and Yarkoni, 2016</xref>). Indeed, only 30% of the terms contained in a neuroscience ontology or meta-analysis tool are common to another (see <xref ref-type="table" rid="table1">Table 1</xref>). In addition, studies are diverse in many ways: they investigate different mental processes, using different terms to describe them, and different experimental paradigms to probe them (<xref ref-type="bibr" rid="bib22">Newell, 1973</xref>). Yet, current meta-analysis approaches model all studies as asking the same question. They cannot model nuances across studies because they rely on in-sample statistical inference and are not designed to interpolate between studies that address related but different questions, or make predictions for unseen combinations of mental processes. A consequence is that, as we will show, their results are harder to control outside of well-defined and frequently-studied psychological concepts.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Taming query variability Maps obtained for a few words related to mental arithmetic.</title><p>By correctly capturing the fact that these words are related, NeuroQuery can use its map for easier words like ‘calculation’ and ‘arithmetic’ to encode terms like ‘computation’ and ‘addition’ that are difficult for meta-analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig1-v2.tif"/></fig><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Diversity of vocabularies: there is no established lexicon of neuroscience, even in hand-curated reference vocabularies, as visible across CognitiveAtlas (<xref ref-type="bibr" rid="bib32">Poldrack and Yarkoni, 2016</xref>), MeSH (<xref ref-type="bibr" rid="bib18">Lipscomb, 2000</xref>), NeuroNames (<xref ref-type="bibr" rid="bib4">Bowden and Martin, 1995</xref>), NIF (<xref ref-type="bibr" rid="bib12">Gardner et al., 2008</xref>), and NeuroSynth (<xref ref-type="bibr" rid="bib52">Yarkoni et al., 2011</xref>).</title><p>Our dataset, NeuroQuery, contains all the terms from the other vocabularies that occur in more than 5 out of 10 000 articles. ‘MeSH’ corresponds to the branches of PubMed’s MEdical Subject Headings related to neurology, psychology, or neuroanatomy (see Section 'The choice of vocabulary'). Many MeSH terms are hardly or never used in practice – For example variants of multi-term expressions with permuted word order such as ‘Dementia, Frontotemporal’, and are therefore not included in NeuroQuery’s vocabulary. Numbers above 25% are shown in bold.</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th>% of ↓ contained in →</th><th>Cognitive Atlas (895)</th><th>MeSH (21287)</th><th>NeuroNames (7146)</th><th>NIF (6912)</th><th>NeuroSynth (1310)</th><th>NeuroQuery(7547)</th></tr></thead><tbody><tr valign="top"><td>Cognitive Atlas</td><td><bold>100%</bold></td><td>14%</td><td>0%</td><td>3%</td><td>14%</td><td><bold>68%</bold></td></tr><tr valign="top"><td>MeSH</td><td>1%</td><td><bold>100%</bold></td><td>3%</td><td>4%</td><td>1%</td><td>9%</td></tr><tr valign="top"><td>NeuroNames</td><td>0%</td><td>9%</td><td><bold>100%</bold></td><td><bold>29%</bold></td><td>1%</td><td>10%</td></tr><tr valign="top"><td>NIF</td><td>0%</td><td>12%</td><td><bold>30%</bold></td><td><bold>100%</bold></td><td>1%</td><td>10%</td></tr><tr valign="top"><td>NeuroSynth</td><td>9%</td><td>14%</td><td>5%</td><td>5%</td><td><bold>100%</bold></td><td><bold>98%</bold></td></tr><tr valign="top"><td>NeuroQuery</td><td>8%</td><td><bold>25%</bold></td><td>9%</td><td>9%</td><td>17%</td><td><bold>100%</bold></td></tr></tbody></table></table-wrap><p>Currently, an automated meta-analysis cannot cover all studies that report a particular functional contrast (contrasting mental conditions to isolate a mental process, <xref ref-type="bibr" rid="bib29">Poldrack et al., 2011</xref>). Indeed, we lack the tools to parse the text in articles and reliably identify those that relate to equivalent or very similar contrasts. As an example, consider a study of the neural support of translating orthography to phonology, probed with visual stimuli by <xref ref-type="bibr" rid="bib26">Pinho et al. (2018)</xref>. The results of this study build upon an experimental contrast labeled by the authors as ‘Read pseudo-words vs. consonant strings’, shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Given this description, what prior hypotheses arise from the literature for this contrast? Conversely, given the statistical map resulting from the experiment, how can one compare it with previous reports on similar tasks? For these questions, meta-analysis seems the tool of choice. Yet, the current meta-analytic paradigm requires the practitioner to select a set of studies that are included in the meta-analysis. In this case, which studies from the literature should be included? Even with a corpus of 14 000 full-text articles, selection based on simple pattern matching –as with NeuroSynth– falls short. Indeed, only 29 studies contain all 5 words from the contrast description, which leads to a noisy and under-powered meta-analytic map (<xref ref-type="fig" rid="fig2">Figure 2</xref>). To avoid relying on the contrast name, which can be seen as too short and terse, one could do a meta-analysis based on the page-long task description (that can be found at <ext-link ext-link-type="uri" xlink:href="https://project.inria.fr/IBC/data/">https://project.inria.fr/IBC/data/</ext-link> and is reproduced in the supplementary data). However, that would require combining even more terms, which precludes selecting studies that contain all of them. A more manual selection may help to identify relevant studies, but it is far more difficult and time-consuming. Moreover, some concepts of interest may not have been investigated by themselves, or only in very few studies: rare diseases, or tasks involving a combination of mental processes that have not been studied together. For instance, there is evidence of agnosia in Huntington’s disease (<xref ref-type="bibr" rid="bib40">Sitek et al., 2014</xref>), but it has not been studied with brain imaging. To compile a brain map from the literature for such queries, it is necessary to interpolate between studies only partly related to the query. Standard meta-analytic methods lack an automatic way to measure the relevance of studies to a question, and to interpolate between them. This prevents them from answering new questions, or questions that cannot be formulated simply.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Illustration: studying the contrast ‘Read pseudo words <italic>vs.</italic> consonant strings’.</title><p>Left: Group-level map from the IBC dataset for the contrast ‘Read pseudo-words vs. consonant strings’ and contour of NeuroQuery map obtained from this query. The NeuroQuery map was obtained directly from the contrast description in the dataset’s documentation, without needing to manually select studies for the meta-analysis nor convert this description to a string pattern usable by existing automatic meta-analysis tools. The map from which the contour is drawn, as well as a NeuroQuery map for the page-long description of the RSVP language task, are shown in Section 'Example Meta-analysis results for the RSVP language task from the IBC dataset', in Section 'Example Meta-analysis results for the RSVP language task from the IBC dataset' c and Section 'Example Meta-analysis results for the RSVP language task from the IBC dataset'd respectively. Right: ALE map for 29 studies that contain all terms from the IBC contrast description. The map was obtained with the GingerALE tool (<xref ref-type="bibr" rid="bib9">Eickhoff et al., 2009</xref>). With only 29 matching studies, ALE lacks statistical power for this contrast description.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig2-v2.tif"/></fig><p>Many of the constraints of standard meta-analysis arise from the necessity to define an <italic>in-sample</italic> test on a given set of studies. Here, we propose a new kind of meta-analysis, that focuses on <italic>out-of-sample</italic> prediction rather than hypothesis testing. The focus shifts from establishing consensus for a particular subject of study to building multivariate mappings from mental diseases and psychological concepts to anatomical structures in the brain. This approach is complementary to classic meta-analysis methods such as Activation Likelihood Estimate (ALE) (<xref ref-type="bibr" rid="bib15">Laird et al., 2005</xref>), Multilevel Kernel Density Analysis (MKDA) (<xref ref-type="bibr" rid="bib46">Wager et al., 2007</xref>) or NeuroSynth (<xref ref-type="bibr" rid="bib52">Yarkoni et al., 2011</xref>): these perform statistical tests to evaluate trustworthiness of results from past studies, while our framework predicts, based on the description of an experiment or subject of study, which brain regions are most likely to be observed in a study. We introduce a new meta-analysis tool, NeuroQuery, that predicts the neural correlates of neuroscience concepts – related to behavior, diseases, or anatomy. To do so, it considers terms not in isolation, but in a dynamic, contextually-informed way that allows for mutual interactions. A predictive framework enables maps to be generated by generalizing from terms that are well studied (‘faces’) to those that are less well studied and inaccessible to traditional meta-analyses (‘prosopagnosia’). As a result, NeuroQuery produces high-quality brain maps for concepts studied infrequently in the literature and for a larger class of queries than existing tools – including, for example free text descriptions of a hypothetical experiment. These brain maps predict well the spatial distribution of findings and thus form good grounds to generate regions of interest or interpret results for studies of infrequent terms such as prosopagnosia. Yet, unlike with conventional meta-analysis, they do not control a voxel-level null hypothesis, hence are less suited to asserting that a particular area is activated in studies, for example of prosopagnosia.</p><p>Our approach, NeuroQuery, assembles results from the literature into a brain map using an arbitrary query with words from our vocabulary of 7547 neuroscience terms. NeuroQuery uses a multivariate model of the statistical link between multiple terms and corresponding brain locations. It is fitted using supervised machine learning on 13459 full-text publications. Thus, it learns to weight and combine terms to predict the brain locations most likely to be reported in a study. It can predict a brain map given any combination of terms related to neuroscience – not only single words, but also detailed descriptions, abstracts, or full papers. With an extensive comparison to published studies, we show in Section 'Quantitative evaluation: NeuroQuery is an accurate model of the literature' that it indeed approximates well results of actual experimental data collection. NeuroQuery also models the semantic relations that underlie the vocabulary of neuroscience. Using techniques from natural language processing, NeuroQuery infers semantic similarities across terms used in the literature. Thus, it makes better use of the available information, and can recover biologically plausible brain maps where other automated methods lack statistical power, for example with terms that are used in few studies, as shown in Section 'NeuroQuery can map rare or difficult concepts'. This semantic model also makes NeuroQuery less sensitive to small variations in terminology (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Finally, the semantic similarities captured by NeuroQuery can help researchers navigate related neuroscience concepts while exploring their associations with brain activity. NeuroQuery extends the scope of standard meta-analysis, as it extracts from the literature a comprehensive statistical summary of evidence accumulated by neuroimaging research. It can be used to explore the domain knowledge across sub-fields, generate new hypotheses, and construct quantitative priors or regions of interest for future studies, or put in perspective results of an experiment. NeuroQuery is easily usable online, at <ext-link ext-link-type="uri" xlink:href="https://neuroquery.org/query?text=visual+working+memory">neuroquery.org</ext-link>, and the data and source code can be freely downloaded. We start by briefly describing the statistical model behind NeuroQuery in Section 'Overview of the NeuroQuery model', then illustrate its usage (Section 'Illustration: using NeuroQuery for post-hoc interpretation') and show that it can map new combinations of concepts in Section 'NeuroQuery can map new combinations of concepts'. In Section 'NeuroQuery can map rare or difficult concepts and Quantitative evaluation: NeuroQuery is an accurate model of the literature', we conduct a thorough qualitative and quantitative assessment of the new possibilities it offers, before a discussion and conclusion.</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The NeuroQuery tool and what it can do</title><sec id="s2-1-1"><title>Overview of the NeuroQuery model</title><p>NeuroQuery is a statistical model that identifies brain regions related to an arbitrary text query – a single term, a few keywords, or a longer text. It is built on a controlled vocabulary of neuroscience terms and a large corpus containing the full text of neuroimaging publications and the coordinates that they report. The main components of the NeuroQuery model are an estimate of the relatedness of terms in the vocabulary, derived from co-occurrence statistics, and a regression model that links term occurrences to neural activations using supervised machine learning techniques. To generate a brain map, NeuroQuery first uses the estimated semantic associations to map the query onto a set of keywords that can be reliably associated with brain regions. Then, it transforms the resulting representation into a brain map using a linear regression model (<xref ref-type="fig" rid="fig3">Figure 3</xref>). This model can thus be understood as a reduced rank regression, where the low-dimensional representation is a distribution of weights over keywords selected for their strong link with brain activity. We emphasize the fact that NeuroQuery is a <italic>predictive</italic> model. The maps it outputs are predictions of the likelihood of observation brain location (rescaled by their standard deviation). They do not have the same meaning as ALE, MKDA or NeuroSynth maps as they do not show a voxel-level test statistic. In this section we describe our neuroscience corpus and how we use it to estimate semantic relations, select keywords, and map them onto brain activations.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Overview of the NeuroQuery model: two examples of how association maps are constructed for the terms ‘grasping’ and ‘visual’.</title><p>The query is expanded by adding weights to related terms. The resulting vector is projected on the subspace spanned by the smaller vocabulary selected during supervised feature selection. Those well-encoded terms are shown in color. Finally, it is mapped onto the brain space through the regression model. When a word (e.g., ‘visual’) has a strong association with brain activity and is selected as a regressor, the smoothing has limited effect. Details: the first bar plot shows the semantic similarities of neighboring terms with the query. It represents the smoothed TFIDF vector. Terms that are not used as features for the supervised regression are shown in gray. The second bar plot shows the similarities of selected terms, rescaled by the norms of the corresponding regression coefficient maps. It represents the relative contribution of each term in the final prediction. The coefficient maps associated with individual terms are shown next to the bar plot. These maps are combined linearly to produce the prediction shown on the right.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig3-v2.tif"/></fig><p>NeuroQuery relies on a corpus of 13459 full-text neuroimaging publications, described in Section 'Building the NeuroQuery training data'. This corpus is by far the largest of its kind; the NeuroSynth corpus contains a similar number of documents, but uses only the article abstracts, and not the full article texts. We represent the text of a document with the (weighted) occurrence frequencies of each phrase from a fixed vocabulary, that is Term Frequency · Inverse Document Frequency (TFIDF) features (<xref ref-type="bibr" rid="bib36">Salton and Buckley, 1988</xref>). This vocabulary is built from the union of terms from several ontologies (shown in <xref ref-type="table" rid="table1">Table 1</xref>) and labels from 12 anatomical atlases (listed in Table 4 in Section 'The choice of vocabulary'). It comprises 7547 terms or phrases related to neuroscience that occur in at least 0.05% of publications. We automatically extract 418772 peak activations coordinates from publications, and transform them to brain maps with a kernel density estimator. Coordinate extraction is discussed and evaluated in Section 'coordinate extraction'. This preprocessing step thus yields, for each article: its representation in term frequency space (a TFIDF vector), and a brain map representing the estimated density of activations for this study. The corresponding data is also openly available online.</p><p>The first step of the NeuroQuery pipeline is a semantic smoothing of the term-frequency representations. Many expressions are challenging for existing automated meta-analysis frameworks, because they are too rare, polysemic, or have a low correlation with brain activity. Rare words are problematic because peak activation coordinates are a very weak signal: from each article we extract little information about the associated brain activity. Therefore existing frameworks rely on the occurrence of a term in hundreds of studies in order to detect a pattern in peak activations. Term co-occurrences, on the other hand, are more consistent and reliable, and capture semantic relationships (<xref ref-type="bibr" rid="bib42">Turney and Pantel, 2010</xref>). The strength of these relationships encodes semantic proximity, from very strong for synonyms that occur in statistically identical contexts, to weaker for different yet related mental processes that are often studied one opposed to the other. Using them helps meta analysis: it would require hundreds of studies to detect a pattern in locations reported for ‘aphasia’, for example in lesion studies. But with the text of a few publications we notice that it often appears close to 'language', which is indeed a related mental process. By leveraging this information, NeuroQuery recovers maps for terms that are too rare to be mapped reliably with standard automated meta-analysis. Using Non-negative Matrix Factorization (NMF), we compute a low-rank approximation of word co-occurrences (the covariance of the TFIDF features), and obtain a denoised semantic relatedness matrix (details are provided in Section 'smoothing: regularization at test time'). These word associations guide the encoding of rare or difficult terms into brain maps. They can also be used to explore related neuroscience concepts when using the NeuroQuery tool.</p><p>The second step from a text query to a brain map is NeuroQuery’s text-to-brain encoding model. When analyzing the literature, we fit a linear regression to reliably map text onto brain activations. The intensity (across the peak density maps) of each voxel in the brain is regressed on the TFIDF descriptors of documents. This model is an additive one across the term occurrences, as opposed to logical operations traditionally used to select studies for meta-analysis. It results in higher predictive power (Section 'Word occurrence frequencies across the corpus').</p><p>One challenge is that TFIDF representations are sparse and high-dimensional. We use a reweighted ridge regression and feature selection procedure (described in Section 'reweighted ridge matrix and feature (vocabulary) selection') to prevent uninformative terms such as ‘magnetoencephalography’ from degrading performance. This procedure automatically selects around 200 keywords that display a strong statistical link with brain activity and adapts the regularization applied to each feature. Indeed, mapping too many terms (covariates) without appropriate regularization would degrade the regression performance due to multicolinearity.</p><p>To make a prediction, NeuroQuery combines semantic smoothing and linear regression of brain activations. To encode a new document or query, the text is expanded, or smoothed, by adding weight to related terms using the semantic similarity matrix. The resulting smoothed representation is projected onto the reduced vocabulary of selected keywords, then mapped onto the brain through the linear regression coefficients (<xref ref-type="fig" rid="fig3">Figure 3</xref>). The rank of this linear model is therefore the size of the restricted vocabulary that was found to be reliably mapped to the brain. Compared with other latent factor models, this 2-layer linear model is easily interpretable, as each dimension (both of the input and the latent space) is associated with a term from our vocabulary. In addition, NeuroQuery uses an estimate of the voxel-level variance of association (see methodological details in Section 'Mathematical details of the NeuroQuery statistical model'), and reports a map of Z statistics. Note that this variance represents an uncertainty around a <italic>prediction</italic> for a TFIDF representation of the concept of interest, which is treated as a fixed quantity. Therefore, the resulting map cannot be thresholded to reject any simple null hypothesis. NeuroQuery maps have a different meaning and different uses than standard meta-analysis maps obtained e.g. with ALE.</p></sec><sec id="s2-1-2"><title>Illustration: using NeuroQuery for post-hoc interpretation</title><p>After running a functional Magnetic Resonance Imaging (fMRI) experiment, it is common to compare the computed contrasts to what is known from the existing literature, and even use prior knowledge to assess whether some activations are not specific to the targeted mental process, but due to experimental artifacts such as the stimulus modality. It is also possible to introduce prior knowledge earlier in the study and choose a Region of Interest (ROI) before running the experiment. This is usually done based on the expertise of the researcher, which is hard to formalize and reproduce. With NeuroQuery, it is easy to capture the domain knowledge and perform these comparisons or ROI selections in a principled way.</p><p>As an example, consider again the contrast from the RSVP language task (<xref ref-type="bibr" rid="bib26">Pinho et al., 2018</xref>; <xref ref-type="bibr" rid="bib13">Humphries et al., 2006</xref>) in the Individual Brain Charting (IBC) dataset, shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. It is described as ‘Read pseudo-words vs. consonant strings’. We obtain a brain map from NeuroQuery by simply transforming the contrast description, without any manual intervention, and compare both maps by overlaying a contour of the NeuroQuery map on the actual IBC group contrast map. We can also obtain a meta-analytic map for the whole RSVP language task by analyzing the free-text task description with NeuroQuery (Section 'Example Meta-analysis results for the RSVP language task from the IBC dataset.').</p></sec><sec id="s2-1-3"><title>NeuroQuery can map new combinations of concepts</title><p>To study the predictions of NeuroQuery, we first demonstrate that it can indeed give good brain maps on combinations of terms that have never been studied together. For this, we leave out from our corpus of studies all the publications that simultaneously mention two given terms, we fit a NeuroQuery model on the resulting reduced corpus, and evaluate its predictions on the left out publications, that did actually report these terms together. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows an example of such an experiment: excluding publications mentioning simultaneously ‘distance’ and ‘color’. The figure compares a simple meta analysis of the combination of these two terms – contrasting the left-out studies with the remaining ones – with the predictions of the model fitted excluding studies that include the term conjunction. Qualitatively, the predicted maps comprise all the brain structures visible in the simultaneous studies of ‘distance’ and ‘color’: on the one hand, the intra-parietal sulci, the frontal eye fields, and the anterior cingulate/anterior insula network associated with distance perception, and on the other hand, the additional mid-level visual region around the approximate location of V4 associated with color perception. The extrapolation from two terms for which the model has seen studies, ‘distance’ and ‘color’, to their combination, for which the model has no data, is possible thanks to the linear additive model, combining regression maps for ‘distance’ and ‘color’.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Mapping an unseen combination of terms.</title><p>Left The difference in the spatial distribution of findings reported in studies that contains both ‘distance’ and ‘color’ (<inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>687</mml:mn></mml:mrow></mml:math></inline-formula>), and the rest of the studies. – Right Predictions of a NeuroQuery model fitted on the studies that do not contain simultaneously both terms ‘distance’ and ‘color’.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig4-v2.tif"/></fig><p>To assert that the good generalization to unseen pairs of terms is not limited to the above pair, we apply quantitative experiments of prediction quality (introduced later, in Section 'Quantitative evaluation: NeuroQuery is an accurate model of the literature') to 1 000 randomly-chosen pairs. We find that measures of how well predictions match the literature decrease only slightly for studies with terms already seen together compared to studies with terms never seen jointly (details in Section 'NeuroQuery performance on unseen pairs of terms'). Finally, we gauge the quality of the maps with a quantitative experiment mirroring the qualitative evaluation of <xref ref-type="fig" rid="fig4">Figure 4</xref>: for each of the 1 000 pairs of terms, we compute the Pearson correlation of the predicted map for the unseen combination of terms with the meta-analytic map obtained on the left-out studies. We find a median correlation of 0.85 which shows that the excellent performance observed on <xref ref-type="fig" rid="fig4">Figure 4</xref> is not due to a specific choice of terms.</p></sec><sec id="s2-1-4"><title>NeuroQuery can map rare or difficult concepts</title><p>We now we compare the NeuroQuery model to existing automated meta-analysis methods, investigate how it handles terms that are challenging for the current state of the art, and quantitatively evaluate its performance. We compare NeuroQuery with NeuroSynth (<xref ref-type="bibr" rid="bib52">Yarkoni et al., 2011</xref>), the best known automated meta-analytic tool, and with Generalized Correspondence Latent Dirichlet Allocation (GCLDA) (<xref ref-type="bibr" rid="bib34">Rubin et al., 2017</xref>). GCLDA is an important baseline because it is the only multivariate meta-analytic model to date. However, it produces maps with a low spatial resolution because it models brain activations as a mixture of Gaussians. Moreover, it takes several days to train and a dozen of seconds to produce a map at test time, and is thus unsuitable to build an online and responsive tool like NeuroSynth or NeuroQuery.</p><p>By combining term similarities and an additive encoding model, NeuroQuery can accurately map rare or difficult terms for which standard meta-analysis lacks statistical power, as visible on <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Examples of maps obtained for a given term, compared across different large-scale meta-analysis frameworks.</title><p>‘GCLDA’ has low spatial resolution and produces inaccurate maps for many terms. For relatively straightforward terms like ‘psts’ (posterior superior temporal sulcus), NeuroSynth and NeuroQuery give consistent results. For terms that are more rare or difficult to map like ‘dyslexia’, only NeuroQuery generates usable brain maps.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig5-v2.tif"/></fig><p>Quantitatively comparing methods on very rare terms is difficult for lack of ground truth. We therefore conduct meta-analyses on subsampled corpora, in which some terms are made artificially rare, and use the maps obtained from the full corpus as a reference. We choose a set of frequent and well-mapped terms, such as ‘language’, for which NeuroQuery and NeuroSynth (trained on a full corpus) give consistent results. For each of those terms, we construct a series of corpora in which the word becomes more and more rare: from a full corpus, we erase randomly the word from many documents until it occurs at most in 2<sup>13</sup> = 8912 articles, then 2<sup>12</sup> = 4096, and so on. For many terms, NeuroQuery only needs a dozen examples to produce maps that are qualitatively and quantitatively close to the maps it obtains for the full corpus – and to NeuroSynth’s full-corpus maps. NeuroSynth typically needs hundreds of examples to obtain similar results, as seen in <xref ref-type="fig" rid="fig6">Figure 6</xref>. Document frequencies roughly follow a power law (<xref ref-type="bibr" rid="bib25">Piantadosi, 2014</xref>), meaning that most words are very rare – half the terms in our vocabulary occur in less than 76 articles (see Section 'Word occurrence frequencies across the corpus'). Reducing the number of studies required to map well a term (a.k.a. the sample complexity of the meta-analysis model) therefore greatly widens the vocabulary that can be studied by meta-analysis.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Learning good maps from few studies.</title><p>left: maps obtained from subsampled corpora, in which the encoded word appears in 16 and 128 documents, and from the full corpus. NeuroQuery needs less examples to learn a sensible brain map. NeuroSynth maps correspond to NeuroSynth’s Z scores for the ‘association test’ from <ext-link ext-link-type="uri" xlink:href="https://neurosynth.org/">neurosynth.org</ext-link>. NeuroSynth’s ‘posterior probability’ maps for these terms for the full corpus are shown in <xref ref-type="fig" rid="fig19">Figure 19</xref>. Each tool is trained on its own dataset, which is why the full-corpus occurrence counts differ. right: convergence of maps toward their value for the full corpus, as the number of occurrences increases. Averaged over 13 words: ‘language’, ‘auditory’, ‘emotional’, ‘hand’, ‘face’, ‘default mode’, ‘putamen’, ‘hippocampus’, ‘reward’, ‘spatial’, ‘amygdala’, ‘sentence’, ‘memory’. On average, NeuroQuery is closer to the full-corpus map. This confirms quantitatively what we observe for the two examples ‘language’ and ‘reward’ on the left. Note that here convergence is only measured with respect to the model’s own behavior on the full corpus, hence a high value does not indicate necessarily a good face validity of the maps with respect to neuroscience knowledge. The solid line represents the mean across the 13 words and the error bands represent a 95% confidence interval based on 1 000 bootstrap repetitions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig6-v2.tif"/></fig><p>Capturing relations between terms is important because the literature does not use a perfectly consistent terminology. The standard solution is to use expert-built ontologies (<xref ref-type="bibr" rid="bib32">Poldrack and Yarkoni, 2016</xref>), but these tend to have low coverage. For example, the controlled vocabularies that we use display relatively small intersections, as can be seen in <xref ref-type="table" rid="table1">Table 1</xref>. In addition, ontologies are typically even more incomplete in listing relations across terms. Rather than ontologies, NeuroQuery relies on distributional semantics and co-occurrence statistics across the literature to estimate relatedness between terms. These continuous semantic links provide robustness to inconsistent terminology: consistent meta-analytic maps for similar terms. For instance, ‘calculation’, ‘computation’, ‘arithmetic’, and ‘addition’ are all related terms that are associated with similar maps by NeuroQuery. On the contrary, standard automated meta-analysis frameworks map these terms in isolation, and thus suffer from a lack of statistical power and produce empty, or nearly empty, maps for some of these terms (see <xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><p>NeuroQuery improves mapping not only for rare terms that are variants of concepts widely studied, but also for some concepts rarely studied, such as ‘color’ or ‘Huntington’ (<xref ref-type="fig" rid="fig5">Figure 5</xref>). The main reason is the semantic smoothing described in Section 'Overview of the NeuroQuery model'. Another reason is that working with the full text of publications associates many more studies to a query: 2779 for ‘color’, while NeuroSynth matches only 236 abstracts, and 147 for ‘huntington’, a term not known to NeuroSynth. Full-text matching however requires to give unequal weight to studies, to avoid giving too much weight to studies weakly related to the query. These weights are computed by the supervised-learning ridge regression: in its dual formulation, ridge regression is seen as giving weights to training samples (<xref ref-type="bibr" rid="bib1">Bishop, 2006</xref>, sec 6.1).</p></sec><sec id="s2-1-5"><title>Quantitative evaluation: NeuroQuery is an accurate model of the literature</title><p>Unlike standard meta-analysis methods, which compute in-sample summary statistics, NeuroQuery is a predictive model, that can produce brain maps for out-of-sample neuroimaging studies. This enables us to quantitatively assess its generalization performance. Here we check that NeuroQuery captures reliable links from concepts to brain activity – associations that generalize to new, unseen neuroimaging studies. We do this with 16-fold shuffle-split cross-validation. After fitting a NeuroQuery model on 90% of the corpus, for each document in the left-out test set (around 1 300), we encode it, normalize the predicted brain map to coerce it into a probability density, and compute the average log-likelihood of the coordinates reported in the article with respect to this density. The procedure is then repeated 16 times and results are presented in <xref ref-type="fig" rid="fig7">Figure 7</xref>. We also perform this procedure with NeuroSynth and GCLDA. NeuroSynth does not perform well for this test. Indeed, the NeuroSynth model is designed for single-phrase meta-analysis, and does not have a mechanism to combine words and encode a full document. Moreover, it is a tool for in-sample statistical inference, which is not well suited for out-of sample prediction. GCLDA performs significantly better than chance, but still worse than a simple ridge regression baseline. This can be explained by the unrealistic modelling of brain activations as a mixture of a small number of Gaussians, which results in low spatial resolution, and by the difficulty to perform posterior inference for GCLDA. Another metric, introduced in <xref ref-type="bibr" rid="bib20">Mitchell et al. (2008)</xref> predicting for encoding models, tests the ability of the meta-analytic model to match the text of a left-out study with its brain map. For each article in the test set, we draw randomly another one and check whether the predicted map is closer to the correct map (containing peaks at each reported location) or to the random negative example. More than 72% of the time, NeuroQuery’s output has a higher Pearson correlation with the correct map than with the negative example (see <xref ref-type="fig" rid="fig7">Figure 7</xref> right).</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Explaining coordinates reported in unseen studies.</title><p>Left: log-likelihood for coordinates reported in test articles, relative to the log-likelihood of a naive baseline that predicts the average density of the training set. NeuroQuery outperforms GCLDA, NeuroSynth, and a ridge regression baseline. Note that NeuroSynth is not designed to make encoding predictions for full documents, which is why it does not perform well on this task. – Right: how often the predicted map is closer to the true coordinates than to the coordinates for another article in the test set (<xref ref-type="bibr" rid="bib20">Mitchell et al., 2008</xref>). The boxes represent the first, second and third quartiles of scores across 16 cross-validation folds. Whiskers represent the rest of the distribution, except for outliers, defined as points beyond 1.5 times the IQR past the low and high quartiles, and represented with diamond fliers.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig7-v2.tif"/></fig></sec><sec id="s2-1-6"><title>NeuroQuery maps are close to reference meta-analytic maps and atlases</title><p>The above experiments quantify how well NeuroQuery captures the information in the literature, by comparing predictions to reported coordinates. However, the scores are difficult to interpret, as peak coordinates reported in the literature are noisy and incomplete with respect to the full activation maps. We also want to quantify the quality of the brain maps generated by NeuroQuery, extending the visual comparisons of <xref ref-type="fig" rid="fig5">Figure 5</xref>. For this purpose, we compare NeuroQuery predictions to a few reliable references.</p><p>First, we use a set of diverse and curated Coordinate-Based Meta-Analysis (IBMA) maps available publicly (<xref ref-type="bibr" rid="bib44">Varoquaux et al., 2018</xref>). This collection contains 19 IBMA brain maps, labelled with cognitive concepts such as ‘visual words’. For each of these labels, we obtain a prediction from NeuroQuery and compare it to the corresponding IBMA map. The IBMA maps are thresholded. We evaluate whether thresholding the NeuroQuery predicted maps can recover the above-threshold voxels in the IBMA, quantifying false detections and misses for all thresholds with the Area Under the Receiver Operating Characteristic (ROC) Curve (<xref ref-type="bibr" rid="bib10">Fawcett, 2006</xref>). NeuroQuery predictions match well the IBMA results, with a median Area Under the Curve (AUC) of 0.80. Such results cannot be directly obtained with NeuroSynth, as many labels are missing from NeuroSynth’s vocabulary. Manually reformulating the labels to terms from NeuroSynth’s vocabulary gives a median AUC of .83 for NeuroSynth, and also raises the AUC to .88 for NeuroQuery (details in Section 'Comparison with the BrainPedia IBMA study' and Figure 13).</p><p>We also perform a similar experiment for anatomical terms, relying on the Harvard-Oxford structural atlases (<xref ref-type="bibr" rid="bib8">Desikan et al., 2006</xref>). Both NeuroSynth and NeuroQuery produce maps that are close to the atlases’ manually segmented regions, with a median AUC of 0.98 for NeuroQuery and 0.95 for NeuroSynth, for the region labels that are present in NeuroSynth’s vocabulary. Details are provided in Section 'Comparison with Harvard-Oxford anatomical atlas' and Figure 14.</p><p>For frequent-enough terms, we consider NeuroSynth as a reference. Indeed, while the goal of NeuroSynth is to perform a voxel-level test of independence, and not to predict an activation distribution like NeuroQuery, in most casesNeuroQuery should predict few observations where the test statistic is small. We threshold NeuroSynth maps by controlling the False Discovery Rate (FDR) at 1% and select the 200 maps with the largest number of activations. We compare NeuroQuery predictions to NeuroSynth activations by computing the AUC. NeuroQuery and NeuroSynth maps for these well-captured terms are very similar, with a median AUC of 0.90. Details are provided in Section 'Comparison with NeuroSynth on terms with strong activations' and Figure 15.</p></sec><sec id="s2-1-7"><title>NeuroQuery is an openly available resource</title><p>NeuroQuery can easily be used online: <ext-link ext-link-type="uri" xlink:href="https://neuroquery.org">https://neuroquery.org</ext-link>. Users can enter free text in a search box (rather than select a single term from a list as is the case with existing tools) and discover which terms, neuroimaging publications, and brain regions are related to their query. NeuroQuery is also available as an open-source Python package that can be easily installed on all platforms: <ext-link ext-link-type="uri" xlink:href="https://github.com/neuroquery/neuroquery">https://github.com/neuroquery/neuroquery </ext-link>(copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/neuroquery">https://github.com/elifesciences-publications/neuroquery</ext-link>). This will enable advanced users to run extensive meta-analysis with Neuroquery, integrate it in other applications, and extend it. The package allows training new NeuroQuery models as well as downloading and using a pre-trained model. Finally, all the resources used to build NeuroQuery are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/neuroquery/neuroquery_data">https://github.com/neuroquery/neuroquery_data </ext-link>(copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/neuroquery_data">https://github.com/elifesciences-publications/neuroquery_data</ext-link>). This repository contains (<italic>i</italic>) the data used to train the model: vocabulary list and document frequencies, word counts (TFIDF features), and peak activation coordinates for our whole corpus of 13 459 publications, (<italic>ii</italic>) the semantic-smoothing matrix, that encodes relations across the terminology. The corpus is significantly richer than NeuroSynth, the largest corpus to date (see Table 3 for a comparison), and manual quality assurance reveals more accurate extraction of brain coordinates (Table 2).</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>NeuroQuery makes it easy to perform meta-analyses of arbitrary questions on the human neuroscience literature: it uses a full-text description of the question and the studies and it provides an online query interface with a rich database of studies. For this, it departs from existing meta-analytic frameworks by treating meta-analysis as a prediction problem. It describes neuroscience concepts of interest by continuous combinations of terms rather than matching publications for exact terms. As it combines multiple terms and interpolates between available studies, it extends the scope of meta-analysis in neuroimaging. In particular, it can capture information for concepts studied much less frequently than those that are covered by current automated meta-analytic approaches.</p><sec id="s3-1"><title>Related work</title><p>A variety of prior works have paved the way for NeuroQuery. Brainmap (<xref ref-type="bibr" rid="bib15">Laird et al., 2005</xref>) was the first systematic database of brain coordinates. NeuroSynth (<xref ref-type="bibr" rid="bib52">Yarkoni et al., 2011</xref>) pioneered automated meta-analysis using abstracts from the literature, broadening a lot the set of terms for which the consistency of reported locations can be tested. These works perform classic meta-analysis, which considers terms in isolation, unlike NeuroQuery. Topic models have also been used to find relationships across terms used in meta-analysis. <xref ref-type="bibr" rid="bib23">Nielsen et al. (2004)</xref> used a non-negative matrix factorization on the matrix of occurrences of terms for each brain location (voxel): their model outputs a set of seven spatial networks associated with cognitive topics, described as weighted combinations of terms. <xref ref-type="bibr" rid="bib30">Poldrack et al. (2012)</xref> used topic models on the full text of 5800 publications to extract from term cooccurrences 130 topics on mental function and disorders, followed by a classic meta-analysis to map their neural correlates in the literature. These topic-modeling works produce a reduced number of cognitive latent factors –or topics– mapped to the brain, unlike NeuroQuery which strives to map <italic>individual</italic> terms and uses their cooccurences in publications only to infer the semantic links. From a modeling perspective, the important difference of NeuroQuery is supervised learning, used as an encoding model (<xref ref-type="bibr" rid="bib21">Naselaris et al., 2011</xref>). In this sense, the supervised learning used in NeuroQuery differs from that used in <xref ref-type="bibr" rid="bib52">Yarkoni et al. (2011)</xref> : the latter is a decoding model that, given brain locations in a study, predicts the likelihood of neuroscience terms without using relationships between terms. Unlike prior approaches, the maps of NeuroQuery are predictions of its statistical model, as opposed to model parameters. Finally, other works have modelled co-activations and interactions between brain locations (<xref ref-type="bibr" rid="bib14">Kang et al., 2011</xref>; <xref ref-type="bibr" rid="bib47">Wager et al., 2015</xref>; <xref ref-type="bibr" rid="bib50">Xue et al., 2014</xref>). We do not explore this possibility here, and except for the density estimation NeuroQuery treats voxels independently.</p></sec><sec id="s3-2"><title>Usage recommendations and limitations</title><p>We have thoroughly validated that NeuroQuery gives quantitatively and qualitatively good results that summarize well the literature. Yet, the tool has strengths and weaknesses that should inform its usage. Brain maps produced by NeuroQuery are predictions, and a specific prediction may be wrong although the tool performs well on average. A NeuroQuery prediction by itself therefore does not support definite conclusions as it does not come with a statistical test. Rather, NeuroQuery will be most successfully used to produce hypotheses and as an exploratory tool, to be confronted with other sources of evidence. To prepare a new functional neuroimaging study, NeuroQuery helps to formulate hypotheses, defining ROIs or other formal priors (for Bayesian analyses). To interpret results of a neuroimaging experiment, NeuroQuery can readily use the description of the experiment to assemble maps from the literature, which can be compared against, or updated using, experimental findings. As an exploratory tool, extracting patterns from published neuroimaging findings can help conjecture relationships across mental processes as well as their neural correlates (<xref ref-type="bibr" rid="bib53">Yeo et al., 2015</xref>). NeuroQuery can also facilitate literature reviews: given a query, it uses its semantic model to list related studies and their reported activations. What NeuroQuery does not do is provide conclusive evidence that a brain region is recruited by a mental process or affected by a pathology. Compared to traditional meta-analysis tools, NeuroQuery is particularly beneficial (<italic>i</italic>) when the term of interest is rare, (<italic>ii</italic>) when the concept of interest is best described by a combination of multiple terms, and (<italic>iii</italic>) when a fully automated method is necessary and queries would otherwise need cumbersome manual curation to be understood by other tools.</p><p>Understanding the components of NeuroQuery helps interpreting its results. We now describe in details potential failures of the tool, and how to detect them. NeuroQuery builds predictions by combining brain maps each associated with a keyword related to the query. A first step to interpret results is to inspect this list of keywords, displayed by the online tool. These keywords are selected based on their semantic relation to the query, and as such will usually be relevant. However, in rare cases, they may build upon undesirable associations. For example, ‘agnosia’ is linked to ‘visual’, ‘fusiform’, ‘word’ and ‘object’, because visual agnosia is the type of agnosia most studied in the literature, even though ‘agnosia’ is a much more general concept. In this specific case, the indirect association is problematic because ‘agnosia’ is not a <italic>selected</italic> term that NeuroQuery can map by itself, as it is not well-represented in the source data. As a result, the NeuroQuery prediction for ‘agnosia’ is driven by indirect associations, and focuses on the visual system, rather than areas related to, for example auditory agnosia. By contrast, ‘aphasia’ is an example of a term that is well mapped, building on maps for ‘speech’ and ‘language’, terms that are semantically close to aphasia and well captured in the literature.</p><p>A second consideration is that, in some extreme cases, the semantic smoothing fails to produce meaningful results. This happens when a term has no closely related terms that correlate well with brain activity. For instance, ‘ADHD’ is very similar to ‘attention deficit hyperactivity disorder’, ‘hyperactivity’, ‘inattention’, but none of these terms is selected as a feature mapped in itself, because their link with brain activity is relatively loose. Hence, for ‘ADHD’, the model builds its prediction on terms that are distant from the query, and produces a misleading map that highlights mostly the cerebellum (<ext-link ext-link-type="uri" xlink:href="https://neuroquery.org/query?text=adhd">https://neuroquery.org/query?text=adhd</ext-link>). While this result is not satisfying, the failure is detected by the NeuroQuery interface and reported with a warning stating that results may not be reliable. To a user with general knowledge in psychology, the failure can also be seen by inspecting the associated terms, as displayed in the user interface.</p><p>A third source of potential failure stems from NeuroQuery’s model of additive combination. This model is not unique to NeuroQuery, and lies at the heart of functional neuroimaging, which builds upon the hypothesis of pure insertion of cognitive processes (<xref ref-type="bibr" rid="bib43">Ulrich et al., 1999</xref>; <xref ref-type="bibr" rid="bib28">Poldrack, 2010</xref>). An inevitable consequence is that, in some cases, a group of words will not be well mapped by its constituents. For example, ‘visual sentence comprehension’ is decomposed into two constituents known to Neuroquery: ‘visual’ and ‘sentence comprehension’. Unfortunately, the map corresponding to the combination is then dominated by the primary visual cortex, given that it leads to very powerful activations in fMRI. Note that ‘visual word comprehension’, a slightly more common subject of interest, is decomposed into ‘visual word’ and ‘comprehension’, which leads to a more plausible map, with strong loadings in the visual word form area.</p><p>A careful user can check that each constituent of a query is associated with a plausible map, and that they are well combined. The NeuroQuery interface enables to gauge the quality of the mapping of each individual term by presenting the corresponding brain map as well as the number of associated studies. The final combination can be understood by inspecting the weights of the combination as well as comparing the final combined map with the maps for individual terms. Such an inspection can for instance reveal that, as mentioned above, ‘visual’ dominates ‘sentence comprehension’ when mapping ‘visual sentence comprehension’.</p><p>We have attempted to provide a comprehensive overview of the main pitfalls users are likely to encounter when using NeuroQuery, but we hasten to emphasize that all of these pitfalls are infrequent. NeuroQuery produces reliable maps for the typical queries, as quantified by our experiments.</p></sec><sec id="s3-3"><title>General considerations on meta-analyses</title><p>When using NeuroQuery to foster scientific progress, it is useful to keep in mind that meta-analyses are not a silver bullet. First, meta-analyses have little or no ability to correct biases present in the primary literature (e.g., perhaps confirmation bias drives researchers to overreport amygdala activation in emotion studies). Beyond increased statistical power, one promise of meta-analysis is to afford a wider perspective on results—in particular, by comparing brain structures detected across many different conditions. However, claims that a structure is selective to a mental condition need an explicit statistical model of reverse inference (<xref ref-type="bibr" rid="bib48">Wager et al., 2016</xref>). Gathering such evidence is challenging: selectivity means that changes at the given brain location specifically <italic>imply</italic> a mental condition, while brain imaging experiments most often do not manipulate the brain itself, but rather the experimental conditions it is placed in <xref ref-type="bibr" rid="bib27">Poldrack (2006)</xref>. In a meta-analysis, the most important confound for reverse inferences is that some brain locations are reported for many different conditions. NeuroQuery accounts for this varying baseline across the brain by fitting an intercept and reporting only differences from the baseline. While helpful, this is not a formal statistical test of reverse inference. For example, the NeuroQuery map for ‘interoception’ highlights the insula, because studies that mention ‘interoception’ tend to mention and report coordinates in the insula. This, of course, does <italic>not</italic> mean that interoception is the only function of the insula. Another fundamental challenge of meta-analyses in psychology is the decomposition of the tasks in mental processes: the descriptions of the dimensions of the experimental paradigms are likely imperfect and incomplete. Indeed, even for a task as simple as finger tapping, minor variations in task design lead to reproducible variations in neural responses (<xref ref-type="bibr" rid="bib49">Witt et al., 2008</xref>). However, quantitatively describing all aspects of all tasks and cognitive strategies is presently impossible, as it would require a universally-accepted, all-encompassing psychological ontology. Rather, NeuroQuery grounds meta-analysis in the full-text descriptions of the studies, which in our view provide the best available proxy for such an idealized ontology.</p></sec><sec id="s3-4"><title>Conclusion</title><p>NeuroQuery stems from a desire to compile results across studies and laboratories, an essential endeavor for the progress of human brain mapping (<xref ref-type="bibr" rid="bib51">Yarkoni et al., 2010</xref>). Mental processes are difficult to isolate and findings of individual studies may not generalize. Thus, tools are needed to denoise and summarize knowledge accumulated across a large number of studies. Such tools must be usable in practice and match the needs of researchers who exploit them to study human brain function and disorders. NeuroSynth took a huge step in this direction by enabling anyone to perform, in a few seconds, a fully automated meta-analysis across thousands of studies, for an important number of isolated terms. Still, users are faced with the difficult task of mapping their question to a single term from the NeuroSynth vocabulary, which cannot always be done in a meaningful way. If the selected term is not popular enough, the resulting map also risks being unusable for lack of statistical power. NeuroQuery provides statistical maps for arbitrary queries – from seldom-studied terms to free-text descriptions of experimental protocols. Thus, it enables applying fully-automated and quantitative meta-analysis in situations where only semi-manual and subjective solutions were available. It therefore brings an important advancement towards grounding neuroscience on quantitative knowledge representations.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>We now expose methodological details: first the constitution of the NeuroQuery data, then the statistical model, the validation experiments in details, and the word-occurrence statistics in the corpus of studies.</p><sec id="s4-1"><title>Building the NeuroQuery training data</title><sec id="s4-1-1"><title>A new dataset</title><p>The dataset collected by NeuroSynth (<xref ref-type="bibr" rid="bib52">Yarkoni et al., 2011</xref>) is openly available (<ext-link ext-link-type="uri" xlink:href="https://github.com/neurosynth/neurosynth-data">https://github.com/neurosynth/neurosynth-data</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/neurosynth-data">https://github.com/elifesciences-publications/neurosynth-data</ext-link>). In July, 2019, NeuroSynth contains 448255 unique locations for 14371 studies. It also contains the term frequencies for 3228 terms (1335 are actually used in the NeuroSynth online tool (<ext-link ext-link-type="uri" xlink:href="http://neurosynth.org">http://neurosynth.org</ext-link>), based on the abstracts of the studies. However, it only contains term frequencies for the abstracts, and not the articles themselves. This results in a shallow description of the studies, based on a very short text (around 20 times smaller than the full article). As a result, many important terms are very rare: they seldom occur in abstracts, and can be associated with very few studies. For example, in our corpus of 13459 studies, ‘huntington disease’ occurs in 32 abstracts, and ‘prosopagnosia’ in 25. For such terms, meta-analysis lacks statistical power. When the full text is available, many more term occurrences – associations between a term and a study – are observed (Figure 16). This means that more information is available, terms are better described by their set of associated studies, and meta-analyses have more statistical power. Moreover, as publications cannot always be redistributed for copyright reasons, NeuroSynth (and any dataset of this nature) can only provide term frequencies for a fixed vocabulary, and not the text they were extracted from. We therefore decided to collect a new corpus of neuroimaging studies, which contains the full text. We also created a new peak activation coordinate extraction system, which achieved a higher precision and recall than NeuroSynth’s on a small sample of manually annotated studies.</p></sec><sec id="s4-1-2"><title>Journal articles in a uniform and validated format</title><p>We downloaded around 149000 full-text journal articles related to neuroimaging from the PubMed Central (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/">https://www.ncbi.nlm.nih.gov/pmc/</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/books/NBK25501/">https://www.ncbi.nlm.nih.gov/books/NBK25501/</ext-link>) (<xref ref-type="bibr" rid="bib37">Sayers, 2009</xref>) and Elsevier (<ext-link ext-link-type="uri" xlink:href="https://dev.elsevier.com/api_docs.html">https://dev.elsevier.com/api_docs.html</ext-link>) APIs. We focus on these sources of data because they provide many articles in a structured format. It should be noted that this could result in a selection bias, as some scientific journals – mostly paid journals – are not available through these channels. The articles are selected by querying the ESearch Entrez utility (<xref ref-type="bibr" rid="bib37">Sayers, 2009</xref>) either for specific neuroimaging journals or with query strings such as ‘fMRI’. The resulting studies are mostly based on fMRI experiments, but the dataset also contains Positron Emission Tomography (PET) or structural Magnetic Resonance Imaging (MRI) studies. It contains studies about diverse types of populations: healthy adults, patients, elderly, children.</p><p>We use eXtensible Stylesheet Language Transformations (XSLT) to convert all articles to the Journal Article Tag Suite (JATS) Archiving and Interchange XML language (<ext-link ext-link-type="uri" xlink:href="https://jats.nlm.nih.gov/archiving/">https://jats.nlm.nih.gov/archiving/</ext-link>) and validate the result using the W3C XML Schema (XSD) schemas provided on the JATS website. From the resulting XML documents, it is straightforward to extract the title, keywords, abstract, and the relevant parts of the article body, discarding the parts which would add noise to our data (such as the acknowledgements or references).</p></sec><sec id="s4-1-3"><title>Coordinate extraction</title><p>We extract tables from the downloaded articles and convert them to the XHTML 1.1 table model (the JATS also allows using the OASIS CALS table model). We use stylesheets provided by docbook (<ext-link ext-link-type="uri" xlink:href="https://docbook.org/tools/">https://docbook.org/tools/</ext-link>) to convert from CALS to XHTML. Cells in tables can span several rows and columns. When extracting a table, we normalize it by splitting cells that span several rows or columns and duplicating these cells’ content; the normalized table thus has the shape of a matrix. Finally, all unicode characters that can be used to represent ‘+' or ‘-' signs (such as − ‘MINUS SIGN’) are mapped to their ASCII equivalents, ‘+' (+ ‘PLUS SIGN’) or ‘-” (- ‘HYPHEN MINUS’). Once tables are isolated, in XHTML format, and their rows and columns are well aligned, the last step is to find and extract peak activation coordinates. Heuristics find columns containing either single coordinates or triplets of coordinates based on their header and the cells’ content. A heuristic detects when the coordinates extracted from a table are probably not stereotactic peak activation coordinates, either because many of them lie outside a standard brain mask, or because the group of coordinates as a whole fits a normal distribution too well. In such cases the whole table is discarded. Out of the 149000 downloaded and formatted articles, 13459 contain coordinates that could be extracted by this process, resulting in a total of 418772 locations.</p><p>All the extracted coordinates are treated as coordinates in the Montreal Neurological Institute (MNI) space, even though some articles still refer to the Talairach space. The precision of extracted coordinates could be improved by detecting which reference is used and transforming Talairach coordinates to MNI coordinates. However, differences between the two coordinate systems are at most of the order of 1 cm, and much smaller in most of the brain. This is comparable to the size of the Gaussian kernel used to smooth images. Moreover, the alignment of brain images does not only depend on the used template but also on the registration method, and there is no perfect transformation from Talairach to MNI space (<xref ref-type="bibr" rid="bib16">Lancaster et al., 2007</xref>). Therefore, treating all coordinates uniformly is acceptable as a first approximation, but better handling of Talairach coordinates is a clear direction for improving the NeuroQuery dataset.</p><sec id="s4-1-3-1"><title>Coordinate extraction evaluation</title><p>To evaluate the coordinate extraction process, we focused on articles that are present in both NeuroSynth’s dataset and NeuroQuery’s, and for which the two coordinate extraction systems disagree. Out of 8692 articles in the intersection of both corpora, the extracted coordinates differ (for at least one coordinate) in 1961 (i.e. in 23% of articles). We selected the first 40 articles (sorted by PubMed ID) and manually evaluated the extracted coordinates. As shown in <xref ref-type="table" rid="table2">Table 2</xref>, our method extracted false coordinates from fewer articles: 3/40 articles have at least one false location in our dataset, against 20 for NeuroSynth. While these numbers may seem high, note that errors are far less likely to occur in articles for which both methods extract exactly the same locations.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Number of extracted coordinate sets that contain at least one error of each type, out of 40 manually annotated articles.</title><p>The articles are chosen from those on which NeuroSynth and NeuroQuery disagree – the ones most likely to contain errors.</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th/><th>False positives</th><th>False negatives</th></tr></thead><tbody><tr valign="top"><td>NeuroSynth</td><td align="center">20</td><td align="center">28</td></tr><tr valign="top"><td>NeuroQuery</td><td align="center">3</td><td align="center">8</td></tr></tbody></table></table-wrap></sec></sec><sec id="s4-1-4"><title>Density maps</title><p>For each article, the coordinates from all tables are pooled, resulting in a set of peak activation coordinates. We then use Gaussian Kernel Density Estimation (KDE) (<xref ref-type="bibr" rid="bib39">Silverman, 1986</xref>; <xref ref-type="bibr" rid="bib38">Scott, 2015</xref>) to estimate the density of these activations over the brain. The chosen bandwidth of the Gaussian kernel yields a Full Width at Half Maximum (FWHM) close to 9 mm, which is in the range of smoothing kernels that are typically used for fMRI meta-analysis (<xref ref-type="bibr" rid="bib46">Wager et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Wager et al., 2004</xref>; <xref ref-type="bibr" rid="bib41">Turkeltaub et al., 2002</xref>). For comparison, NeuroSynth uses a hard ball of 10 mm radius.</p><p>One benefit of focusing on the density of peak coordinates (which is <inline-formula><mml:math id="inf2"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>-normalized) is that it does not depend on the number of contrasts presented in an article, nor on other analytic choices that cause the number of reported coordinates to vary widely, ranging from less than a dozen to several hundreds.</p></sec><sec id="s4-1-5"><title>Vocabulary and TFIDF features</title><p>We represent the text of our articles by TFIDF features (<xref ref-type="bibr" rid="bib36">Salton and Buckley, 1988</xref>). These simple representations are popular in document retrieval and text classification because they are very efficient for many applications. They contain the (reweighted) frequencies of many terms in the text, discarding the order in which words appear. An important choice when building TFIDF vectors is the vocabulary: the words or expressions whose frequency are measured. It is common to use all words encountered in the training corpus, possibly discarding those that are too frequent or too rare. The vocabulary is often enriched with ‘n-grams’, or collocations: groups of words that often appear in the same sequence, such as ‘European Union’ or ‘default mode network’. These collocations are assigned a dimension of the TFIDF representations and counted as if they were a single token. There are several strategies to discover such collocations in a training corpus (<xref ref-type="bibr" rid="bib19">Mikolov et al., 2013</xref>; <xref ref-type="bibr" rid="bib3">Bouma, 2009</xref>).</p><p>We do not extract the vocabulary and collocations from the training corpus, but instead rely on existing, manually-curated vocabularies and ontologies of neuroscience. This ensures that we only consider terms that are relevant to brain function, anatomy or disorders, and that we only use meaningful collocations. Moreover, it helps to reduce the dimensionality of the TFIDF representations. Our vocabulary comprises five important lexicons of neuroscience, based on community efforts: the subset of Medical Subject Headings (MeSH) (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/mesh">https://www.ncbi.nlm.nih.gov/mesh</ext-link>) dedicated to neuroscience and psychology, detailed in Section 'The choice of vocabulary' (MeSH are the terms used by PubMed to index articles), Cognitive Atlas (<ext-link ext-link-type="uri" xlink:href="http://www.cognitiveatlas.org/">http://www.cognitiveatlas.org/</ext-link>), NeuroNames (<ext-link ext-link-type="uri" xlink:href="http://braininfo.rprc.washington.edu/NeuroNames.xml">http://braininfo.rprc.washington.edu/NeuroNames.xml</ext-link>) and NIF (<ext-link ext-link-type="uri" xlink:href="https://neuinfo.org/">https://neuinfo.org/</ext-link>). We also include all the terms and bigrams used by NeuroSynth (<ext-link ext-link-type="uri" xlink:href="http://neurosynth.org">http://neurosynth.org</ext-link>). We discard all the terms and expressions that occur in less than 5/10 000 articles. The resulting vocabulary contains 7547 terms and expressions related to neuroscience.</p></sec><sec id="s4-1-6"><title>Summary of collected data</title><p>The data collection described in this section provides us with important resources: (<italic>i</italic>) Over 149K full-text journal articles related to neuroscience – 13.5K of which contain peak activation coordinates – all translated into the same structured format and validated. (<italic>ii</italic>) Over 418K peak activation coordinates for more than 13.5K articles. (<italic>iii</italic>) A vocabulary of 7547 terms related to neuroscience, each occurring in at least six articles from which we extracted coordinates. This dataset is the largest of its kind. In what follows we focus on the set of 13.5K articles from which we extracted peak locations.</p><p>Some quantitative aspects of the NeuroQuery and NeuroSynth datasets are summarized in <xref ref-type="table" rid="table3">Table 3</xref>.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Comparison with NeuroSynth.</title><p>‘voc intersection’ is the set of terms present in both NeuroSynth’s and NeuroQuery’s vocabularies. The ‘conflicting articles’ are papers present in both datasets, for which the coordinate extraction tools disagree, 40 of which were manually annotated.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>NeuroSynth</th><th>NeuroQuery</th></tr></thead><tbody><tr><td>Dataset size</td><td/><td/></tr><tr><td>articles</td><td>14 371</td><td>13 459</td></tr><tr><td>terms</td><td>3 228 (1 335 online)</td><td>7 547</td></tr><tr><td>journals</td><td>60</td><td>458</td></tr><tr><td>raw text length (words)</td><td>≈4 M</td><td>≈75 M</td></tr><tr><td>unique term occurrences</td><td>1 063 670</td><td>5 855 483</td></tr><tr><td>unique term occurrences in voc intersection</td><td>677 345</td><td>3 089 040</td></tr><tr><td>coordinates</td><td>448 255</td><td>418 772</td></tr><tr><td>Coordinate extraction errors on conflicting articles</td><td/><td/></tr><tr><td>articles with false positives / 40</td><td>20</td><td>3</td></tr><tr><td>articles with false negatives / 40</td><td>28</td><td>8</td></tr></tbody></table></table-wrap><sec id="s4-1-6-1"><title>Text</title><p>In terms of raw amount of text, this corpus is 20 times larger than NeuroSynth’s. Combined with our vocabulary, it yields over 5.5M occurrences of a unique term in an article. This is over five times more than the word occurrence counts distributed by NeuroSynth (<ext-link ext-link-type="uri" xlink:href="https://github.com/neurosynth/neurosynth-data">https://github.com/neurosynth/neurosynth-data</ext-link>). When considering only terms in NeuroSynth’s vocabulary, the corpus still contains over 3M term-study associations, 4.6 times more than NeuroSynth. Using this larger corpus results in denser representations, higher statistical power, and coverage of a wider vocabulary. There is an important overlap between the selected studies: 8 692 studies are present in both datasets – the Intersection Over Union is 0.45.</p></sec><sec id="s4-1-6-2"><title>Coordinates</title><p>The set of extracted coordinates is almost the size of NeuroSynth’s (which is 7% larger with 448255 coordinates after removing duplicates), and is less noisy. To compare coordinate extractions, we manually annotated a small set of articles for which NeuroSynth’s coordinates differ from NeuroQuery’s. Compared with NeuroSynth, NeuroQuery’s extraction method reduced the number of articles with incorrect coordinates (false positives) by a factor of 7, and the number of articles with missing coordinates (false negatives) by a factor of 3 (<xref ref-type="table" rid="table2">Table 2</xref>). Less noisy brain activation data is useful for training encoding models.</p></sec><sec id="s4-1-6-3"><title>Sharing data</title><p>We do not have the right to share the full text of the articles, but the vocabulary, extracted coordinates, and term occurrence counts for the whole corpus are freely available online (<ext-link ext-link-type="uri" xlink:href="https://github.com/neuroquery/neuroquery_data">https://github.com/neuroquery/neuroquery_data</ext-link>).</p></sec></sec></sec><sec id="s4-2"><title>Mathematical details of the NeuroQuery statistical model</title><sec id="s4-2-1"><title>Notation</title><p>We denote scalars, vectors and matrices with lower-case, bold lower-case, and bold-upper case letters respectively: <inline-formula><mml:math id="inf3"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We denote the elements of <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> by <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, its rows by <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and its columns by <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. We denote <inline-formula><mml:math id="inf10"><mml:mi>p</mml:mi></mml:math></inline-formula> the number of voxels in the brain, <inline-formula><mml:math id="inf11"><mml:mi>v</mml:mi></mml:math></inline-formula> the size of the vocabulary, and <inline-formula><mml:math id="inf12"><mml:mi>n</mml:mi></mml:math></inline-formula> the number of studies in the dataset. We use indices <inline-formula><mml:math id="inf13"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf14"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf15"><mml:mi>k</mml:mi></mml:math></inline-formula> to indicate indexing samples (studies), features (terms), and outputs (voxels) respectively. We use a hat to denote estimated values, for example <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the vector scalar product.</p></sec><sec id="s4-2-2"><title>TFIDF feature extraction</title><p>We represent a document by its TFIDF features (<xref ref-type="bibr" rid="bib36">Salton and Buckley, 1988</xref>), which are reweighted Bag-Of-Words features. A TFIDF representation is a vector in which each entry corresponds to the (reweighted) frequency of occurrence of a particular term. The <italic>term frequency</italic>, tf, of a word in a document is the number of times the word occurs, divided by the total number of words in the document. The <italic>document frequency</italic>, df, of a word in a corpus is the proportion of documents in which it appears. The <italic>inverse document frequency</italic>, idf, is defined as:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">w</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>df</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mspace width="thickmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mspace width="thickmathspace"/><mml:mi mathvariant="normal">w</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow><mml:mspace width="thickmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf17"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of documents in the corpus and | · | is the cardinality. Term frequencies are reweighted by their idf, so that frequent words, which occur in many documents (such as ‘results’ or ‘brain’), are given less importance. Indeed, such words are usually not very informative.</p><p>Our TFIDF representation for a study is the uniform average of the normalized TFIDF vectors for its title, abstract, full text, and keywords. Therefore, all parts of the article are taken into account, but a word that occurs in the title is more important than a word the article body (since the title is shorter).</p><p>TFIDF features exploit a fixed vocabulary – each dimension is associated with a particular word. The vocabulary we consider comprises 7547 terms or phrases related to neuroscience that occur in at least 0.05% of publications. These terms are extracted from manually curated sources shown in <xref ref-type="table" rid="table1">Table 1</xref> and <xref ref-type="table" rid="table4">Table 4</xref>.</p><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Atlases included in NeuroQuery’s vocabulary.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Url</th></tr></thead><tbody><tr><td>talairach</td><td><ext-link ext-link-type="uri" xlink:href="http://www.talairach.org/talairach.nii">http://www.talairach.org/talairach.nii</ext-link></td></tr><tr><td>harvard_oxford</td><td><ext-link ext-link-type="uri" xlink:href="http://www.nitrc.org/frs/download.php/7700/HarvardOxford.tgz">http://www.nitrc.org/frs/download.php/7700/HarvardOxford.tgz</ext-link></td></tr><tr><td>destrieux</td><td><ext-link ext-link-type="uri" xlink:href="https://www.nitrc.org/frs/download.php/7739/destrieux2009.tgz">https://www.nitrc.org/frs/download.php/7739/destrieux2009.tgz</ext-link></td></tr><tr><td>aal</td><td><ext-link ext-link-type="uri" xlink:href="http://www.gin.cnrs.fr/AAL-217">http://www.gin.cnrs.fr/AAL-217</ext-link></td></tr><tr><td>JHU-labels</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#JHU-labels">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#JHU-labels</ext-link></td></tr><tr><td>Striatum-Structural</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Striatum-Structural">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Striatum-Structural</ext-link></td></tr><tr><td>STN</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#STN">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#STN</ext-link></td></tr><tr><td>Striatum-Connectivity-7sub</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Striatum-Connectivity-7sub">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Striatum-Connectivity-7sub</ext-link></td></tr><tr><td>Juelich</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Juelich">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Juelich</ext-link></td></tr><tr><td>MNI</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#MNI">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#MNI</ext-link></td></tr><tr><td>JHU-tracts</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#JHU-tracts">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#JHU-tracts</ext-link></td></tr><tr><td>Thalamus</td><td><ext-link ext-link-type="uri" xlink:href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Thalamus">https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Atlases#Thalamus</ext-link></td></tr></tbody></table></table-wrap></sec><sec id="s4-2-3"><title>Reweighted ridge matrix and feature (vocabulary) selection</title><p>Here we give some details about the feature selection and adaptive ridge regularization. After extracting TFIDF features and computing density estimation maps, we fit a linear model by regressing the activity of each voxel on the TFIDF descriptors (Section 'Overview of the NeuroQuery model'). We denote <inline-formula><mml:math id="inf18"><mml:mi>p</mml:mi></mml:math></inline-formula> the number of voxels, <inline-formula><mml:math id="inf19"><mml:mi>v</mml:mi></mml:math></inline-formula> the size of the vocabulary, and <inline-formula><mml:math id="inf20"><mml:mi>n</mml:mi></mml:math></inline-formula> the number of documents in the corpus. We construct a design matrix <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> containing the TFIDF features of each study, and the dependent variables <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> representing the activation density at each voxel for each study. The linear model thus writes:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mspace width="thinmathspace"/><mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">E</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is Gaussian noise and <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are the unknown model coefficients. We use ridge regression (least-squares regression with a penalty on the <inline-formula><mml:math id="inf25"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> norm of the model coefficients). Some words are much more informative than others, or have a much stronger correlation with brain activity. For example, ‘auditory’ is well correlated with activations in the auditory areas, whereas ‘attention’ has a lower signal-to-noise ratio, as it is polysemic and, even when used as a psychological concept, has a weaker link to reported neural activations. Therefore it is beneficial to adapt the amount of regularization for each word, to strongly penalize (or even discard) the most noisy features.</p><p>Many existing methods for feature selection are not adapted to our case, because: (<italic>i</italic>) the design matrix <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is very sparse, and more importantly (<italic>ii</italic>) we want to select the same features for ≈ 28 000 outputs (each voxel in the brain is a dependent variable). We therefore introduce a new reweighted ridge regression and feature selection procedure.</p><p>Our approach is based on the observation that when fitting a ridge regression with a uniform regularization, the most informative words are associated with large coefficients for many voxels. We start by fitting a ridge regression with uniform regularization. We obtain one statistical map of the brain for every feature (every term in the vocabulary). The maps are rescaled to reduce the importance of coefficients with a high variance. We then compute the squared <inline-formula><mml:math id="inf27"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> norms of these brain maps across voxels. These norms are a good proxy for the importance of each feature. Terms associated with large norms explain well the activity of many voxels and tend to be helpful features. We rely on these brain map norms to determine which features are selected and what regularization is applied. The feature selection and adaptive regularization are described in detail in the rest of this section.</p><sec id="s4-2-3-1"><title>Z scores for ridge regression coefficients</title><p>Our design matrix <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> holds TFIDF features for <inline-formula><mml:math id="inf29"><mml:mi>v</mml:mi></mml:math></inline-formula> terms in <inline-formula><mml:math id="inf30"><mml:mi>n</mml:mi></mml:math></inline-formula> studies. There are <inline-formula><mml:math id="inf31"><mml:mi>p</mml:mi></mml:math></inline-formula> dependent variables, one for each voxel in the brain, which form <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. The first ridge regression fit yields coefficients <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a hyperparameter set with Generalized Cross-Validation (GCV); (<xref ref-type="bibr" rid="bib33">Rifkin and Lippert, 2007</xref>). We then compute an estimate of the variance of these coefficients. The approach is similar to the one presented in <xref ref-type="bibr" rid="bib11">Gaonkar and Davatzikos (2012)</xref> for the case of SVMs. A simple estimator can be obtained by noting that the coefficients of a ridge regression are a linear function of the dependent variables. Indeed, solving <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> yields:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi mathvariant="bold-italic">I</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mspace width="thickmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Defining<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi mathvariant="bold-italic">I</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>for a voxel <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and a feature <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">𝒎</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is the <inline-formula><mml:math id="inf38"><mml:msup><mml:mi>i</mml:mi><mml:mtext>th</mml:mtext></mml:msup></mml:math></inline-formula> row of <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the <inline-formula><mml:math id="inf41"><mml:msup><mml:mi>k</mml:mi><mml:mtext>th</mml:mtext></mml:msup></mml:math></inline-formula> column of <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The activations of voxel <inline-formula><mml:math id="inf43"><mml:mi>k</mml:mi></mml:math></inline-formula> across studies are considered to be independent identically distributed (i.i.d), so<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Var</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thickmathspace"/><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub><mml:mo>≜</mml:mo><mml:msubsup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thickmathspace"/><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub><mml:mspace width="thickmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>An estimate of this variance can be obtained from the residuals:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≜</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mspace width="thinmathspace"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="thickmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>A simple estimate of the coefficients’ variance is then:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≜</mml:mo><mml:mrow><mml:mover><mml:mi>Var</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thickmathspace"/><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo fence="false" stretchy="false">⟩</mml:mo><mml:mspace width="thickmathspace"/><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thickmathspace"/><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We can thus estimate the standard deviation of each entry of <inline-formula><mml:math id="inf44"><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝑩</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. We obtain a brain map of Z scores for each term in the vocabulary: for term <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and voxel <inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≜</mml:mo><mml:mpadded width="+2.8pt"><mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We denote <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>…</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; and the Z-map for term <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-2-3-2"><title>Reweighted ridge matrix</title><p>Once we have a Z-map for each term, we summarize these maps by computing their squared Euclidean norm. In practice, we smooth the Z scores: <inline-formula><mml:math id="inf49"><mml:msub><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ10">Equation 10</xref> is replaced by<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+2.8pt"><mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf50"><mml:mi>δ</mml:mi></mml:math></inline-formula> is a constant offset. The offset <inline-formula><mml:math id="inf51"><mml:mi>δ</mml:mi></mml:math></inline-formula> allows us to interpolate between basing the regularization on the Z scores, or on the raw coefficients, that is the <inline-formula><mml:math id="inf52"><mml:mi>β</mml:mi></mml:math></inline-formula>-maps. We obtain better results with a large value for <inline-formula><mml:math id="inf53"><mml:mi>δ</mml:mi></mml:math></inline-formula>, such as the mean variance of all the regression coefficients. This prevents selecting terms only because they have a very small estimated variance in some voxels. Note that this offset <inline-formula><mml:math id="inf54"><mml:mi>δ</mml:mi></mml:math></inline-formula> is only used to compute the regularization, and not to compute the rescaled predictions produced by NeuroQuery as in <xref ref-type="disp-formula" rid="equ17">Equation 17</xref>.</p><p>We denote <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="thickmathspace"/><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Next, we compute the mean µ and standard deviation <inline-formula><mml:math id="inf56"><mml:mi>e</mml:mi></mml:math></inline-formula> of <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>v</mml:mi><mml:mspace width="thinmathspace"/><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, and set an arbitrary cutoff<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>2</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+2.8pt"><mml:mi>e</mml:mi></mml:mpadded></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>All features <inline-formula><mml:math id="inf58"><mml:mi>j</mml:mi></mml:math></inline-formula> such that <inline-formula><mml:math id="inf59"><mml:mrow><mml:msubsup><mml:mrow><mml:mo fence="true">||</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝜻</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo fence="true">||</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf60"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is a small margin to avoid division by zero in <xref ref-type="disp-formula" rid="equ14">Equation 14</xref>, are discarded. In practice we set <inline-formula><mml:math id="inf61"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> to 0.001. The value of <inline-formula><mml:math id="inf62"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is not important, because features that are not discarded but have their <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">ζ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> norm close to <inline-formula><mml:math id="inf64"><mml:mi>c</mml:mi></mml:math></inline-formula> get very heavily penalized in <xref ref-type="disp-formula" rid="equ14">Equation 14</xref> and have coefficients very close to .</p><p>We denote <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula> the number of features that remain in the selected vocabulary. We denote <inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>:</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> the strictly increasing mapping that reindexes the features by keeping only the <inline-formula><mml:math id="inf67"><mml:mi>u</mml:mi></mml:math></inline-formula> selected terms: <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the set of selected features. We denote <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> the corresponding projection matrix:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo><mml:mspace width="thickmathspace"/><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>u</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf70"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">𝒆</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo rspace="4.2pt">,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is the natural basis of <inline-formula><mml:math id="inf71"><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>v</mml:mi></mml:msup></mml:math></inline-formula>. The regularization for the selected features is then set to<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="thickmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Finally, we define the diagonal matrix <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>×</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> such that the <inline-formula><mml:math id="inf73"><mml:msup><mml:mi>j</mml:mi><mml:mtext>th</mml:mtext></mml:msup></mml:math></inline-formula> element of its diagonal is <inline-formula><mml:math id="inf74"><mml:msub><mml:mi>w</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> and fit a new set of coefficients <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> with this new ridge matrix.</p></sec><sec id="s4-2-3-3"><title>Fitting the reweighted ridge regression</title><p>The reweighted ridge regression problem writes:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mspace width="thinmathspace"/><mml:msup><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>Tr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Where <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a new hyperparameter, that is again set by Generalized Cross-Validation (GCV). With a change of variables this becomes equivalent to solving the usual ridge regression problem:<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mspace width="thinmathspace"/><mml:msup><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and we recover <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mover><mml:mi mathvariant="bold">Γ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> .</p><p>The variance of the parameters <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> can be estimated as in <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> – without applying the smoothing of <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>. NeuroQuery can thus report rescaled predictions<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>Var</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>One benefit of this rescaling is to provide the user a natural value to threshold the maps. As visible on <xref ref-type="fig" rid="fig4">Figures 4</xref>, <xref ref-type="fig" rid="fig5">5</xref> and <xref ref-type="fig" rid="fig6">6</xref>, thresholding for example at <inline-formula><mml:math id="inf81"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝒛</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> selects regions typical of the query, that can be used for instance in a region of interest analysis.</p></sec><sec id="s4-2-3-4"><title>Summary of the regression with adaptive regularization</title><p>The whole procedure for feature selection and adaptive regularization is summarized in Algorithm 1.</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><tbody><tr valign="top"><td colspan="3"><bold>Algorithm 1</bold> Reweighted Ridge Regression</td></tr><tr valign="top"><td colspan="3"><bold>Input:</bold> TFIDF features <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, brain activation densities <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, regularization hyperparameter grid <inline-formula><mml:math id="inf84"><mml:mi mathvariant="normal">Λ</mml:mi></mml:math></inline-formula>, variance smoothing parameter <inline-formula><mml:math id="inf85"><mml:mi>δ</mml:mi></mml:math></inline-formula> use</td></tr><tr valign="top"><td colspan="3">use GCV to compute the best hyperparameter <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow></mml:math></inline-formula> and <break/><inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo lspace="0" movablelimits="true" rspace="0">argmin</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>;</td></tr><tr valign="top"><td colspan="3">compute variance estimates <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> as in <xref ref-type="disp-formula" rid="equ9">Equation 9</xref></td></tr><tr valign="top"><td colspan="3"><inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1...</mml:mn><mml:mi>v</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td colspan="3">compute <inline-formula><mml:math id="inf90"><mml:mi>c</mml:mi></mml:math></inline-formula> according to <xref ref-type="disp-formula" rid="equ12">Equation 12</xref></td></tr><tr valign="top"><td colspan="3">define <inline-formula><mml:math id="inf91"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> the reindexing that selects features <inline-formula><mml:math id="inf92"><mml:mi>j</mml:mi></mml:math></inline-formula> such that <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>;</td></tr><tr valign="top"><td colspan="3">define <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> the projection matrix for <inline-formula><mml:math id="inf95"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> as in <xref ref-type="disp-formula" rid="equ13">Equation 13</xref></td></tr><tr valign="top"><td colspan="3"><inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">ζ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1...</mml:mn><mml:mi>u</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td colspan="3"><inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1...</mml:mn><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td colspan="3">use GCV to compute the best hyperparameter <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi></mml:mrow></mml:math></inline-formula> and <break/><inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>Tr</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr valign="top"><td colspan="3"><bold>return</bold> <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>Var</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf102"><mml:mi>γ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table></table-wrap><p>In practice, the feature selection keeps u ≈ 200 features. It has a very low computational cost compared to other feature selection schemes. The computational cost is that of fitting two ridge regressions (and the second one is fitted with a much smaller number of features). Moreover, the feature selection also reduces computation at prediction time, which is useful because we deploy an online tool based on the NeuroQuery model (<ext-link ext-link-type="uri" xlink:href="https://neuroquery.org">https://neuroquery.org</ext-link>).</p></sec></sec><sec id="s4-2-4"><title>Smoothing: regularization at test time</title><p>In order to smooth the sparse input features, we exploit the covariance of our training corpus. We rely on Non-negative Matrix Factorization (NMF) (<xref ref-type="bibr" rid="bib17">Lee and Seung, 1999</xref>). We use a NMF of <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> to compute a low-rank approximation of the covariance <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Thus, we obtain a denoised term co-occurrence matrix, which measures the strength of association between pairs of terms. We start by computing an approximate factorization of the corpus TFIDF matrix <inline-formula><mml:math id="inf107"><mml:mi mathvariant="bold-italic">𝑿</mml:mi></mml:math></inline-formula>:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula> is a hyperparameter and <inline-formula><mml:math id="inf109"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo rspace="4.2pt" stretchy="false">|</mml:mo><mml:mo rspace="4.2pt">⋅</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> designates the sum of absolute values of all entries of a matrix. Computing this factorization amounts to describing each document in the corpus as a linear mixture of <inline-formula><mml:math id="inf110"><mml:mi>d</mml:mi></mml:math></inline-formula> latent factors, or <italic>topics</italic>. In natural language processing, similar decomposition methods are referred to as <italic>topic modelling</italic> (<xref ref-type="bibr" rid="bib2">Blei et al., 2003</xref>; <xref ref-type="bibr" rid="bib7">Deerwester et al., 1990</xref>).</p><p>The latent factors, or topics, are the rows of <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>: each topic is characterized by a vector of positive weights over the terms in the vocabulary. <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> contains the weight that each document gives to each topic. For each term in the vocabulary, the corresponding column of <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is a a <inline-formula><mml:math id="inf114"><mml:mi>d</mml:mi></mml:math></inline-formula>-dimensional <italic>embedding</italic> in the low-dimensional, latent space: this embedding contains the strength of association of the term with each topic. These embeddings capture semantic relationships: related terms tend to be associated with embeddings that have large inner products.</p><p>The hyperparameters <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> are set by evaluating the reconstruction error, sparsity of the similarity matrix, and extracted topics (rows of <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) on an unlabelled (separate) corpus. We find that the NeuroQuery model as a whole is not very sensitive to these hyperparameters and we obtain similar results for a range of different values.</p><p><xref ref-type="disp-formula" rid="equ18">Equation 18</xref> is a well-known problem. We solve it with a coordinate-descent algorithm described in <xref ref-type="bibr" rid="bib6">Cichocki and Phan (2009)</xref> and implemented in scikit-learn (<xref ref-type="bibr" rid="bib24">Pedregosa et al., 2011</xref>). Then, let <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> be the diagonal matrix containing the Euclidean norms of the columns of <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, that is such that <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and let <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We define the word similarity matrix <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. This matrix is a denoised, low-rank approximation of the corpus covariance. Indeed<disp-formula id="equ19"><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(19)</mml:mtext></mml:mtd><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>≈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mi mathvariant="bold-italic">V</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(20)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">U</mml:mi><mml:msup><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mtd><mml:mtd/><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(21)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mspace width="2em"/><mml:mo>≈</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The last approximation is justified by the fact that the columns of <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are almost orthogonal, and <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is almost a diagonal matrix. This is what we observe in practice, and is due to the fact that <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≈</mml:mo><mml:mn>13 000</mml:mn></mml:mrow></mml:math></inline-formula> is much larger than <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mrow></mml:math></inline-formula>, and that to minimize the reconstruction error in <xref ref-type="disp-formula" rid="equ18">Equation 18</xref> the columns of <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">U</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> have an incentive to span a large subspace of <inline-formula><mml:math id="inf129"><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula>.</p><p>The similarity matrix <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> contains the inner products of the low-dimensional embeddings of the terms in our vocabulary. We form the matrix <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> by dividing the rows of <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> by their <inline-formula><mml:math id="inf133"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> norm:<disp-formula id="equ20"><label>(22)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo fence="true">||</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="bold-italic">𝒂</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mpadded><mml:mo fence="true">||</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo rspace="5.3pt">∀</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>v</mml:mi></mml:mpadded></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This normalization ensures that terms that have many neighbors are not given more importance in the smoothed representation. The smoothing matrix that we use is then defined as:<disp-formula id="equ21"><label>(23)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>with <inline-formula><mml:math id="inf134"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (in our experiments <inline-formula><mml:math id="inf135"><mml:mi>α</mml:mi></mml:math></inline-formula> is set to 0.1). This smoothing matrix is a mixture of the identity matrix and the term associations <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The model is not very sensitive to the parameter <inline-formula><mml:math id="inf137"><mml:mi>α</mml:mi></mml:math></inline-formula> as long as it is chosen small enough for terms actually present in the query to have a higher weight than terms introduced by the query expansion. This prevents degrading performance for documents which contain well-encoded terms, which obtain good prediction even without smoothing. This explains why in <xref ref-type="fig" rid="fig3">Figure 3</xref>, the prediction for ‘visual’ relies mostly on the regression coefficient for this exact term, whereas the prediction for ‘agnosia’ relies on coefficients of terms that are <italic>related</italic> to ‘agnosia’ – ‘agnosia’ itself is not kept by the feature selection procedure.</p><p>The smoothed representation for a query <bold>q</bold> becomes:<disp-formula id="equ22"><label>(24)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the TFIDF representation of the query in large vocabulary space, and <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi mathvariant="bold-italic">𝑺</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the smoothing matrix. And the prediction for <inline-formula><mml:math id="inf140"><mml:mi>q</mml:mi></mml:math></inline-formula> is:<disp-formula id="equ23"><label>(25)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mspace width="thinmathspace"/><mml:msup><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">q</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>×</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the projection onto the useful vocabulary (selected features), <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> are the estimated linear regression coefficients, <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the predicted map.</p></sec></sec><sec id="s4-3"><title>Validation experiments: additional details</title><sec id="s4-3-1"><title>Example meta-analysis results for the RSVP language task from the IBC dataset</title><p>Here we provide more details on the meta-analyses for ‘Read pseudo-words vs consonant strings’ shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. The PMIDS of the studies included in the GingerALE meta-analysis are: 15961322, 16574082, 16968771, 17189619, 17884585, 17933023, 18272399, 18423780, 18476755, 18778780, 19396362, 19591947, 20035884, 20600985, 20650450, 20961169, 21767584, 22285025, 22659111, 23117157, 23270676, 24321558, 24508158, 24667455, 25566039, 26017384, 26188258, 26235228, 28780219. Representing a total of 29 studies and 2025 peak activation coordinates. They are the studies from our corpus (the largest existing corpus of text and peak activation coordinates, with ≈ 14 000 studies) which contain the terms: ‘reading’, ‘pseudo’, ‘word’, ‘consonant’ and ‘string’. The map shown on the right of <xref ref-type="fig" rid="fig2">Figure 2</xref> was obtained with GingerALE, 5000 permutations and the default settings otherwise. Note that an unrealistically low threshold is used for the display because the map would be empty otherwise. <xref ref-type="fig" rid="fig8">Figure 8</xref> displays more maps with different analysis strategies: the details of the original contrasts and the difference between running NeuroQuery the contrast definition or the task definition. The task definition leads to predicted activations in the early visual cortex, as in the actual group-level maps from the experiment but unlike the predictions from the contrast definition, as the later contains no information on the stimulus modality.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Using meta-analysis to interpret fMRI maps.</title><p>Example of the ‘Read pseudo-words vs. consonant strings’ contrast, derived from the RSVP language task in the IBC dataset. (<bold>a</bold>): the group-level map obtained from the actual fMRI data from IBC. (<bold>b</bold>): ALE map using the 29 studies in our corpus that contain all five terms from the contrast name. (<bold>c</bold>): NeuroQuery map obtained from the contrast name. (<bold>d</bold>): NeuroQuery map obtained from the page-long RSVP task description in the IBC dataset documentation: <ext-link ext-link-type="uri" xlink:href="https://project.inria.fr/IBC/files/2019/03/documentation.pdf">https://project.inria.fr/IBC/files/2019/03/documentation.pdf</ext-link>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig8-v2.tif"/></fig></sec><sec id="s4-3-2"><title>NeuroQuery performance on unseen pairs of terms</title><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows in a qualitative way that NeuroQuery can produce useful brain maps on a combination of terms that have not been studied together. To give a quantitative evaluation that is not limited to a specific pair of terms, we perform a systematic experiment, studying prediction on many unseen pairs of term. For this purpose, we chose pairs of terms in our full corpus and leave out all the studies where both of these terms appear. We train a NeuroQuery model on the reduced corpus of studies obtained by excluding studies with both terms, and evaluate its predictions on the left-out studies.</p><p>We choose terms that appear simultaneously in studies frequently (more than 500) to ensure a good estimation of the combined locations for these terms in the test set, but not too frequently (less than 1000), to avoid depleting the training set too much. Indeed, removing the studies for both terms from the corpus not only decreases the statistical power to map these terms but also, more importantly, it creates a negative correlation between these terms. Out of these terms, we select 1000 out random as a left-out and run the experiment 1000 times.</p><p>To evaluate NeuroQuery’s prediction on these unseen pairs of terms, we first use the same metrics as in Section 'Quantitative evaluation: NeuroQuery is an accurate model of the literature.' <xref ref-type="fig" rid="fig9">Figure 9</xref> -left shows the log-likelihood of coordinates reported in a publication evaluated on left-out studies that contain the combination of terms excluded from the train set. Compared to testing on a random subset of studied, identically distributed to the training, there is a slight decrease in likelihood but it is small compared to the variance between cross-validation runs. <xref ref-type="fig" rid="fig9">Figure 9</xref>-right shows results for our other validation metric adapted from <xref ref-type="bibr" rid="bib20">Mitchell et al. (2008)</xref>: matching 1 publication out of 2 to its observed locations. The decrease in performance is more marked. However, it should be noted that the task is more difficult when the test set is made only of publications that all contain two terms, as these publications are all more similar to each other than random publications from the general corpus.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Quantitative evaluations on unseen pairs.</title><p>A quantitative comparison of prediction on random unseen studies (i.i.d.cross-validation) to prediction on studies containing pairs of terms never seen before, using the two measures of predictions performance (as visible on <xref ref-type="fig" rid="fig7">Figure 7</xref> for standard cross-validation).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig9-v2.tif"/></fig><p>To gauge the quality of the maps on unseen pairs, and not only how well the corresponding publications are captured, <xref ref-type="fig" rid="fig10">Figure 10</xref> shows the Pearson correlation between the predicted brain map and the average density of the reported locations in the left-out studies. The excellent median Pearson correlation of .85 shows that the predicted brain map is indeed true to what a meta-analysis of these studies would reveal.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Consistency between prediction of unseen pairs and meta-analysis.</title><p>The Pearson correlation between the map predicted by NeuroQuery on a pair of unseen terms and the average density of locations reported on the studies containing this pair of terms (hence excluded from the training set of NeuroQuery).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig10-v2.tif"/></fig></sec><sec id="s4-3-3"><title>NeuroQuery prediction performance without anatomical terms</title><p>In <xref ref-type="fig" rid="fig11">Figure 11</xref>, we present an additional quantitative measure of prediction performance. We delete all terms that are related to anatomy in test articles, to see how NeuroQuery performs without these highly predictive features, which may be missing from queries related to brain function. As the GCLDA and NeuroSynth tools are designed to work with NeuroSynth data, they are only tested on NeuroSynth’s TFIDF features, which represent the articles’ abstracts.</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Explaining coordinates reported in unseen studies.</title><p>left: log-likelihood of reported coordinates in test articles. right: how often the predicted map is closer to the true coordinates than to the coordinates for another article in the test set [mitchell2008predicting, ]. The boxes represent the first, second and third quartiles of scores across 16 cross-validation folds. Whiskers represent the rest of the distribution, except for outliers, defined as points beyond 1.5 times the IQR past the low and high quartiles, and represented with diamond fliers.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig11-v2.tif"/></fig></sec><sec id="s4-3-4"><title>Variable terminology</title><p>In <xref ref-type="fig" rid="fig12">Figure 12</xref>, we show predictions for some terms related to mental arithmetic. NeuroQuery’s semantic smoothing produces consistent results for related terms.</p><fig id="fig12" position="float"><label>Figure 12.</label><caption><title>Taming arbitrary query variability Maps obtained for a few words related to mental arithmetic.</title><p>By correctly capturing the fact that these words are related, NeuroQuery can use its map for easier words like ‘calculation’ and ‘arithmetic’ to encode terms like ‘computation’ and ‘addition’ that are difficult for meta-analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig12-v2.tif"/></fig></sec><sec id="s4-3-5"><title>Comparison with the BrainPedia IBMA study</title><p>To compare maps produced by NeuroQuery with a reliable ground truth, we use the BrainPedia study (<xref ref-type="bibr" rid="bib44">Varoquaux et al., 2018</xref>), which exploits IBMA to produce maps for 19 cognitive concepts. Indeed, when it its feasible, IBMA of manually selected studies produces high-quality brain maps and has been used as a reference for CBMA methods (<xref ref-type="bibr" rid="bib35">Salimi-Khorshidi et al., 2009</xref>). We download the BrainPedia maps and their cognitive labels from the NeuroVault platform (<ext-link ext-link-type="uri" xlink:href="https://neurovault.org/collections/4563/">https://neurovault.org/collections/4563/</ext-link>). BrainPedia maps combine forward and reverse inference, and are thresholded to identify regions that are both recruited and predictive of each cognitive process. We treat these maps as a binary ground truth: above-threshold voxels are relevant to the map’s label. For each label, we obtain a brain map from NeuroQuery, NeuroSynth and GCLDA. We compare these results to the BrainPedia thresholded maps and measure the Area Under the ROC Curve. This standard classification metric measures the probability that a voxel that is active in the BrainPedia reference map will be given a higher intensity in the NeuroQuery prediction than a voxel that is inactive in the BrainPedia map.</p><p>We consider two settings. First, we use the original labels provided in the NeuroVault metadata. However, some of these labels are missing from the NeuroSynth vocabulary. In a second experiment, we therefore replace these labels with the most similar term we can find in the NeuroSynth vocabulary. These replacements are shown in <xref ref-type="fig" rid="fig13">Figure 13</xref>.</p><fig id="fig13" position="float"><label>Figure 13.</label><caption><title>Comparison of CBMA maps with IBMA maps from the BrainPedia study.</title><p>We use labelled and thresholded maps resulting from a manual IBMA. The labels are fed to NeuroQuery, NeuroSynth and GCLDA and their results are compared to the reference by measuring the Area under the ROC Curve. The black vertical bars show the median. When using the original BrainPedia labels, NeuroQuery performs relatively well but NeuroSynth fails to recognize most labels. When reformulating the labels, that is replacing them with similar terms from NeuroSynth’s vocabulary, both NeuroSynth and NeuroQuery match the manual IBMA reference for most terms. On the top, we show the BrainPedia map (first row) and NeuroQuery prediction (second row) for the quartiles of the AUC obtained by NeuroQuery on the original labels. A lower AUC for some concepts can sometimes be explained by a more noisy BrainPedia reference map.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig13-v2.tif"/></fig><p>When replacing the original labels with less specific terms understood by NeuroSynth, both NeuroQuery and NeuroSynth perform well: NeuroQuery’s median AUC is 0.9 and NeuroSynth’s is 0.8. When using the original labels, NeuroSynth fails to produce results for many labels as they are missing from its vocabulary. NeuroQuery still performs well on these uncurated labels with a median AUC of 0.8. Finally, we can note that although the BrainPedia maps come from IBMA conducted on carefully selected fMRI studies, they also contain some noise. As can be seen in <xref ref-type="fig" rid="fig13">Figure 13</xref>, BrainPedia maps that qualitatively match the domain knowledge also tend to be close to the CBMA results produced by NeuroQuery and NeuroSynth.</p></sec><sec id="s4-3-6"><title>Comparison with Harvard-Oxford anatomical atlas</title><p>Here, we compare CBMA maps to manually segmented regions of the Harvard-Oxford anatomical atlas (<xref ref-type="bibr" rid="bib8">Desikan et al., 2006</xref>). We feed the labels from this atlas to NeuroQuery, NeuroSynth and GCLDA and compare the resulting maps to the atlas regions. This experiment provides a sanity check that relies on an excellent ground truth, as the atlas regions are labelled and segmented by experts. For simplicity, atlas labels absent from NeuroSynth’s vocabulary are discarded. For the remaining 18 labels, we compute the Area Under the ROC Curve of the maps produced by each meta-analytic tool. This experiment is therefore identical to the one presented in Section 'Comparison with the BrainPedia IBMA study', except that the reference ground truth is a manually segmented anatomical atlas, and that we do not consider reformulating the labels. GCLDA is not used in this experiment as the trained model distributed by the authors does not recognize anatomical terms. We observe that both NeuroSynth and NeuroQuery match closely the reference atlas, with a median AUC above 0.9, as seen in <xref ref-type="fig" rid="fig14">Figure 14</xref>.</p><fig id="fig14" position="float"><label>Figure 14.</label><caption><title>Comparison of predictions with regions of the Harvard-Oxford anatomical atlas.</title><p>Labels of the Harvard-Oxford anatomical atlas present in NeuroSynth’s vocabulary are fed to NeuroSynth and NeuroQuery. The meta-analytic maps are compared to the manually segmented reference by measuring the Area Under the ROC Curve. The black vertical bars show the median. Both NeuroSynth and NeuroQuery achieve a median AUC above 0.9. On the top, we show the atlas region (first row) and NeuroQuery prediction (second row) for the quartiles of the NeuroQuery AUC scores.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig14-v2.tif"/></fig></sec><sec id="s4-3-7"><title>Comparison with NeuroSynth on terms with strong activations</title><p>As NeuroSynth performs a statistical test, when a term has a strong link with brain activity and is popular enough for NeuroSynth to detect many activations, the resulting map is trustworthy and can be used as a reference. Moreover, it is a well-established tool that has been adopted by the neuroimaging community. Here, we verify that when a term is well captured by NeuroSynth, NeuroQuery predicts a similar brain map. To identify terms that NeuroSynth captures well, we compute the NeuroSynth maps for all the terms in NeuroSynth’s vocabulary. We use the Benjamini-Hochberg procedure to threshold the maps, controlling the FDR at 1%. We then select the 200 maps with the largest number of active (above-threshold) voxels. We use these activation maps as a reference to which we compare the NeuroQuery prediction. For each term, we compute the Area Under the ROC Curve: the probability that a voxel that is active in the NeuroSynth map will have a higher value in the NeuroQuery prediction than an inactive voxel. We find that NeuroQuery and NeuroSynth’s maps coincide well, with a median AUC of 0.90. The distribution of the AUC and the brain map corresponding to each quartile are shown in <xref ref-type="fig" rid="fig15">Figure 15</xref>.</p><fig id="fig15" position="float"><label>Figure 15.</label><caption><title>Comparison with NeuroSynth.</title><p>NeuroSynth maps are thresholded controlling the FDR at 1%. The 200 words with the largest number of active voxels are selected and NeuroQuery predictions are compared to the NeuroSynth activations by computing the Area Under the ROC Curve. The distribution of the AUC is shown on the top. The vertical black line shows the median (0.90). On the bottom, we show the NeuroQuery maps (first row) and NeuroSynth activations (second row) for the quartiles of the NeuroQuery AUC scores.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig15-v2.tif"/></fig></sec></sec><sec id="s4-4"><title>The NeuroQuery publication corpus and associated vocabulary</title><sec id="s4-4-1"><title>Word occurrence frequencies across the corpus</title><sec id="s4-4-1-1"><title>The challenge: most words are rare</title><p>As shown on <xref ref-type="fig" rid="fig16">Figure 16</xref> right, most words occur in very few documents, which is why correctly mapping rare words is important. The problem of rare words is more severe in the NeuroSynth corpus, which contains only the abstracts. As the NeuroQuery corpus contains the full text of the articles (around 20 times more text), more occurrences of a unique term in a document are observed, as shown in <xref ref-type="fig" rid="fig16">Figure 16</xref> left, and in <xref ref-type="fig" rid="fig17">Figure 17</xref> for a few example terms.</p><fig id="fig16" position="float"><label>Figure 16.</label><caption><title>Right: benefit of using full-text articles.</title><p>Document frequencies (number of documents in which a word appears) for terms from the NeuroSynth vocabulary, in the NeuroSynth corpus (<inline-formula><mml:math id="inf144"><mml:mi>x</mml:mi></mml:math></inline-formula> axis) and the NeuroQuery corpus (<inline-formula><mml:math id="inf145"><mml:mi>y</mml:mi></mml:math></inline-formula> axis). Words appear in much fewer documents in the NeuroSynth corpus because it only contains abstracts. Even when considering only terms present in the NeuroSynth vocabulary, the NeuroQuery corpus contains over 3M term-study associations – 4.6 times more than NeuroSynth. Left: Most terms occur in few documents Plot of the document frequencies in the NeuroQuery corpus, for terms in the vocabulary, sorted in decreasing order. While some terms are very frequent, occurring in over 12 000 articles, most are very rare: half occur in less than 76 (out of 14 000) articles.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig16-v2.tif"/></fig><fig id="fig17" position="float"><label>Figure 17.</label><caption><title>Document frequencies for some example words, in NeuroQuery’s and NeuroSynth’s corpora.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig17-v2.tif"/></fig><p>Document set intersections lack statistical power. For example, ‘face perception’ occurs in 413 articles, and ‘dementia’ in 1312. 1703 articles contain at least one of these words and could be used for a multivariate regression’s prediction for the query ‘face perception and dementia’. Indeed, denoting <inline-formula><mml:math id="inf146"><mml:mi>c</mml:mi></mml:math></inline-formula> the dual coefficients of the ridge regression and <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> the training design matrix, the prediction for a query <inline-formula><mml:math id="inf148"><mml:mi>q</mml:mi></mml:math></inline-formula> is <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>c</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and any document that has a nonzero dot product with the query can participate in the prediction. However, only 22 documents contain both terms and would be used with the classical meta-analysis selection, which would lack statistical power and fail to produce meaningful results. Exact matches of multi-word expressions such as ‘creative problem solving’, ' facial trustworthiness recognition ', ‘positive feedback processing’, ‘potential monetary reward’, ‘visual word recognition’ (all cognitive atlas concepts, all occurring in less than 5/10 000 full-text articles), are very rare – and classical meta-analysis thus cannot produce results for such expressions. In <xref ref-type="fig" rid="fig18">Figure 18</xref>, we compare the frequency of multi-word expressions from our vocabulary (such as ‘face recognition’) with the frequency of their constituent words. Being able to combine words in an additive fashion is crucial to encode such expressions into brain space.</p><fig id="fig18" position="float"><label>Figure 18.</label><caption><title>Occurrences of phrases versus its constituents How often a phrase from the vocabulary (e.g.</title><p>‘face recognition’) occurs, versus at least one of its constituent words (e.g. ‘face’). Expressions involving several words are typically very rare.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig18-v2.tif"/></fig></sec></sec><sec id="s4-4-2"><title>The choice of vocabulary</title><sec id="s4-4-2-1"><title>Details on the Medical Subject Headings</title><p>The Medical Subject Headings (MeSH) are concerned with all of medicine. We only included in NeuroQuery’s vocabulary the parts of this graph that are relevant for neuroscience and psychology. Here we list the branches of Medical Subject Headings (MeSH) that we included in our vocabulary:</p><list list-type="simple"><list-item><p>Neuroanatomy: ’A08.186.211’</p></list-item><list-item><p>Neurological disorders: ’C10.114’, ’C10.177’, ’C10.228’, ’C10.281’, ’C10.292’, ’C10.314’, ’C10.500’, ’C10.551’, ’C10.562’, ’C10.574’, ’C10.597’, ’C10.668’, ’C10.720’, ’C10.803’, ’C10.886’, ’C10.900’</p></list-item><list-item><p>Psychology: ’F02.463’, ’F02.830’, ’F03’, ’F01.058’, ’F01.100’, ’F01.145’, ’F01.318’, ’F01.393’, ’F01.470’, ’F01.510’, ’F01.525’, ’F01.590’, ’F01.658’, ’F01.700’, ’F01.752’, ’F01.829’, ’F01.914’</p></list-item></list><p>Many MeSH terms are too rare to be part of NeuroQuery’s vocabulary. Some are too specific, e.g. ‘Diffuse Neurofibrillary Tangles with Calcification’. More importantly, many terms are absent because for each heading, MeSH provides many <italic>Entry Terms</italic> – various ways to refer to a concept, some of which are almost never used in practice in the text of publications. For example NeuroQuery recognizes the MeSH <italic>Preferred Term</italic> ‘Frontotemporal Dementia’ but not some of its variations (<ext-link ext-link-type="uri" xlink:href="https://meshb.nlm.nih.gov/record/ui?ui=D057180">https://meshb.nlm.nih.gov/record/ui?ui=D057180</ext-link>) such as ‘Dementia, Frontotemporal’, ‘Disinhibition-Dementia-Parkinsonism-Amyotrophy Complex’, or ‘HDDD1’. Note that even when absent from the vocabulary as single phrases, many of these variations can be parsed as a combination of several terms, resulting in a similar brain map as the one obtained for the preferred term.</p></sec><sec id="s4-4-2-2"><title>Atlas labels included in the vocabulary</title><p>The labels from the 12 atlases shown in <xref ref-type="table" rid="table4">Table 4</xref> were included in the NeuroQuery vocabulary.</p></sec></sec></sec><sec id="s4-5"><title>NeuroSynth posterior probability maps</title><p>The NeuroSynth maps shown in <xref ref-type="fig" rid="fig6">Figure 6</xref> are the NeuroSynth ‘association test’ maps. For completeness, in <xref ref-type="fig" rid="fig19">Figure 19</xref> we show the other kind of map that NeuroSynth can produce, called ‘posterior probability’ maps.</p><fig id="fig19" position="float"><label>Figure 19.</label><caption><title>NeuroSynth posterior probability maps for ‘language’ (top) and ‘reward’ (bottom), using the full corpus.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53385-fig19-v2.tif"/></fig></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>JD acknowledges funding from Digiteo under project Metacog (2016-1270D). RP received funding from the US National Science Foundation (Award # OAC-1649658). TY acknowledges funding from NIH under grant number R01MH096906. BT received funding from the European Union’s Horizon 2020 Research and Innovation Programme under Grant Agreement No. 785907 (HBP SGA2) and No 826421 (VirtualbrainCloud). FS acknowledges funding from ANR via grant ANR-16- CE23-0007-01 (‘DICOS’). GV was partially funded by the Canada First Research Excellence Fund, awarded to McGill University for the Healthy Brains for Healthy Lives initiative. We also thank the reviewers, including Tor D Wager, for their suggestions that improved the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Methodology</p></fn><fn fn-type="con" id="con3"><p>Software, Visualization</p></fn><fn fn-type="con" id="con4"><p>Software, Visualization</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Validation</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Validation, Visualization, Project administration</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Supervision, Funding acquisition, Project administration</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Software, Supervision, Funding acquisition, Validation, Visualization, Methodology, Project administration</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="sdata1"><label>Source data 1.</label><caption><title>Source code for figures and tables.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-53385-data1-v2.zip"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-53385-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All the data that we can share without violating copyright (including word counts of publications) have been shared on <ext-link ext-link-type="uri" xlink:href="https://github.com/neuroquery/">https://github.com/neuroquery/</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/neuroquery">https://github.com/elifesciences-publications/neuroquery</ext-link>) alongside with the analysis scripts. Everything is readily downloadable without any authorization or login required. For each figure and table, the data directly used to generate it is made available in a separate zip file.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Dockès</surname><given-names>J</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>NeuroQuery</data-title><source>GitHub</source><pub-id assigning-authority="other" pub-id-type="archive" xlink:href="https://github.com/neuroquery/neuroquery_data">neuroquery_data</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Pattern Recognition and Machine Learning</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blei</surname> <given-names>DM</given-names></name><name><surname>Ng</surname> <given-names>AY</given-names></name><name><surname>Jordan</surname> <given-names>MI</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Latent dirichlet allocation</article-title><source>Journal of Machine Learning Research</source><volume>3</volume><fpage>993</fpage><lpage>1022</lpage></element-citation></ref><ref id="bib3"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bouma</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Normalized (pointwise) mutual information in collocation extraction</article-title><conf-name>Proceedings of GSCL</conf-name><fpage>31</fpage><lpage>40</lpage></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bowden</surname> <given-names>DM</given-names></name><name><surname>Martin</surname> <given-names>RF</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>NeuroNames brain hierarchy</article-title><source>NeuroImage</source><volume>2</volume><fpage>63</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1006/nimg.1995.1009</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Button</surname> <given-names>KS</given-names></name><name><surname>Ioannidis</surname> <given-names>JPA</given-names></name><name><surname>Mokrysz</surname> <given-names>C</given-names></name><name><surname>Nosek</surname> <given-names>BA</given-names></name><name><surname>Flint</surname> <given-names>J</given-names></name><name><surname>Robinson</surname> <given-names>ESJ</given-names></name><name><surname>Munafò</surname> <given-names>MR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Power failure: why small sample size undermines the reliability of neuroscience</article-title><source>Nature Reviews Neuroscience</source><volume>14</volume><fpage>365</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1038/nrn3475</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cichocki</surname> <given-names>A</given-names></name><name><surname>Phan</surname> <given-names>A-H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Fast local algorithms for large scale nonnegative matrix and tensor factorizations</article-title><source>IEICE Transactions on Fundamentals of Electronics, Communications and Computer Sciences</source><volume>E92-A</volume><fpage>708</fpage><lpage>721</lpage><pub-id pub-id-type="doi">10.1587/transfun.E92.A.708</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deerwester</surname> <given-names>S</given-names></name><name><surname>Dumais</surname> <given-names>ST</given-names></name><name><surname>Furnas</surname> <given-names>GW</given-names></name><name><surname>Landauer</surname> <given-names>TK</given-names></name><name><surname>Harshman</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Indexing by latent semantic analysis</article-title><source>Journal of the American Society for Information Science</source><volume>41</volume><fpage>391</fpage><lpage>407</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-4571(199009)41:6&lt;391::AID-ASI1&gt;3.0.CO;2-9</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desikan</surname> <given-names>RS</given-names></name><name><surname>Ségonne</surname> <given-names>F</given-names></name><name><surname>Fischl</surname> <given-names>B</given-names></name><name><surname>Quinn</surname> <given-names>BT</given-names></name><name><surname>Dickerson</surname> <given-names>BC</given-names></name><name><surname>Blacker</surname> <given-names>D</given-names></name><name><surname>Buckner</surname> <given-names>RL</given-names></name><name><surname>Dale</surname> <given-names>AM</given-names></name><name><surname>Maguire</surname> <given-names>RP</given-names></name><name><surname>Hyman</surname> <given-names>BT</given-names></name><name><surname>Albert</surname> <given-names>MS</given-names></name><name><surname>Killiany</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>An automated labeling system for subdividing the human cerebral cortex on MRI scans into gyral based regions of interest</article-title><source>NeuroImage</source><volume>31</volume><fpage>968</fpage><lpage>980</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2006.01.021</pub-id><pub-id pub-id-type="pmid">16530430</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eickhoff</surname> <given-names>SB</given-names></name><name><surname>Laird</surname> <given-names>AR</given-names></name><name><surname>Grefkes</surname> <given-names>C</given-names></name><name><surname>Wang</surname> <given-names>LE</given-names></name><name><surname>Zilles</surname> <given-names>K</given-names></name><name><surname>Fox</surname> <given-names>PT</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Coordinate-based activation likelihood estimation meta-analysis of neuroimaging data: a random-effects approach based on empirical estimates of spatial uncertainty</article-title><source>Human Brain Mapping</source><volume>30</volume><fpage>2907</fpage><lpage>2926</lpage><pub-id pub-id-type="doi">10.1002/hbm.20718</pub-id><pub-id pub-id-type="pmid">19172646</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fawcett</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>An introduction to ROC analysis</article-title><source>Pattern Recognition Letters</source><volume>27</volume><fpage>861</fpage><lpage>874</lpage><pub-id pub-id-type="doi">10.1016/j.patrec.2005.10.010</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Gaonkar</surname> <given-names>B</given-names></name><name><surname>Davatzikos</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Deriving statistical significance maps for svm based image classification and group comparisons</article-title><conf-name>International Conference on Medical Image Computing and Computer-Assisted Intervention</conf-name><fpage>723</fpage><lpage>730</lpage></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname> <given-names>D</given-names></name><name><surname>Akil</surname> <given-names>H</given-names></name><name><surname>Ascoli</surname> <given-names>GA</given-names></name><name><surname>Bowden</surname> <given-names>DM</given-names></name><name><surname>Bug</surname> <given-names>W</given-names></name><name><surname>Donohue</surname> <given-names>DE</given-names></name><name><surname>Goldberg</surname> <given-names>DH</given-names></name><name><surname>Grafstein</surname> <given-names>B</given-names></name><name><surname>Grethe</surname> <given-names>JS</given-names></name><name><surname>Gupta</surname> <given-names>A</given-names></name><name><surname>Halavi</surname> <given-names>M</given-names></name><name><surname>Kennedy</surname> <given-names>DN</given-names></name><name><surname>Marenco</surname> <given-names>L</given-names></name><name><surname>Martone</surname> <given-names>ME</given-names></name><name><surname>Miller</surname> <given-names>PL</given-names></name><name><surname>Müller</surname> <given-names>HM</given-names></name><name><surname>Robert</surname> <given-names>A</given-names></name><name><surname>Shepherd</surname> <given-names>GM</given-names></name><name><surname>Sternberg</surname> <given-names>PW</given-names></name><name><surname>Van Essen</surname> <given-names>DC</given-names></name><name><surname>Williams</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The neuroscience information framework: a data and knowledge environment for neuroscience</article-title><source>Neuroinformatics</source><volume>6</volume><fpage>149</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1007/s12021-008-9024-z</pub-id><pub-id pub-id-type="pmid">18946742</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname> <given-names>C</given-names></name><name><surname>Binder</surname> <given-names>JR</given-names></name><name><surname>Medler</surname> <given-names>DA</given-names></name><name><surname>Liebenthal</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Syntactic and semantic modulation of neural activity during auditory sentence comprehension</article-title><source>Journal of Cognitive Neuroscience</source><volume>18</volume><fpage>665</fpage><lpage>679</lpage><pub-id pub-id-type="doi">10.1162/jocn.2006.18.4.665</pub-id><pub-id pub-id-type="pmid">16768368</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname> <given-names>J</given-names></name><name><surname>Johnson</surname> <given-names>TD</given-names></name><name><surname>Nichols</surname> <given-names>TE</given-names></name><name><surname>Wager</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Meta analysis of functional neuroimaging data via bayesian spatial point processes</article-title><source>Journal of the American Statistical Association</source><volume>106</volume><fpage>124</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1198/jasa.2011.ap09735</pub-id><pub-id pub-id-type="pmid">21706069</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laird</surname> <given-names>AR</given-names></name><name><surname>Lancaster</surname> <given-names>JJ</given-names></name><name><surname>Fox</surname> <given-names>PT</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Brainmap</article-title><source>Neuroinformatics</source><volume>3</volume><fpage>65</fpage><lpage>77</lpage><pub-id pub-id-type="doi">10.1385/NI:3:1:065</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lancaster</surname> <given-names>JL</given-names></name><name><surname>Tordesillas-Gutiérrez</surname> <given-names>D</given-names></name><name><surname>Martinez</surname> <given-names>M</given-names></name><name><surname>Salinas</surname> <given-names>F</given-names></name><name><surname>Evans</surname> <given-names>A</given-names></name><name><surname>Zilles</surname> <given-names>K</given-names></name><name><surname>Mazziotta</surname> <given-names>JC</given-names></name><name><surname>Fox</surname> <given-names>PT</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Bias between MNI and talairach coordinates analyzed using the ICBM-152 brain template</article-title><source>Human Brain Mapping</source><volume>28</volume><fpage>1194</fpage><lpage>1205</lpage><pub-id pub-id-type="doi">10.1002/hbm.20345</pub-id><pub-id pub-id-type="pmid">17266101</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>DD</given-names></name><name><surname>Seung</surname> <given-names>HS</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Learning the parts of objects by non-negative matrix factorization</article-title><source>Nature</source><volume>401</volume><fpage>788</fpage><lpage>791</lpage><pub-id pub-id-type="doi">10.1038/44565</pub-id><pub-id pub-id-type="pmid">10548103</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lipscomb</surname> <given-names>CE</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Medical subject headings (mesh)</article-title><source>Bulletin of the Medical Library Association</source><volume>88</volume><elocation-id>265</elocation-id><pub-id pub-id-type="pmid">10928714</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Mikolov</surname> <given-names>T</given-names></name><name><surname>Sutskever</surname> <given-names>I</given-names></name><name><surname>Chen</surname> <given-names>K</given-names></name><name><surname>Corrado</surname> <given-names>GS</given-names></name><name><surname>Dean</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Distributed representations of words and phrases and their compositionality</article-title><conf-name>In Advances in Neural Information Processing Systems</conf-name><fpage>3111</fpage><lpage>3119</lpage></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname> <given-names>TM</given-names></name><name><surname>Shinkareva</surname> <given-names>SV</given-names></name><name><surname>Carlson</surname> <given-names>A</given-names></name><name><surname>Chang</surname> <given-names>KM</given-names></name><name><surname>Malave</surname> <given-names>VL</given-names></name><name><surname>Mason</surname> <given-names>RA</given-names></name><name><surname>Just</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Predicting human brain activity associated with the meanings of nouns</article-title><source>Science</source><volume>320</volume><fpage>1191</fpage><lpage>1195</lpage><pub-id pub-id-type="doi">10.1126/science.1152876</pub-id><pub-id pub-id-type="pmid">18511683</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naselaris</surname> <given-names>T</given-names></name><name><surname>Kay</surname> <given-names>KN</given-names></name><name><surname>Nishimoto</surname> <given-names>S</given-names></name><name><surname>Gallant</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Encoding and decoding in fMRI</article-title><source>NeuroImage</source><volume>56</volume><fpage>400</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.07.073</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Newell</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>You can’t play 20 questions with nature and win: Projective comments on the papers of this symposium</article-title><conf-name>Visual Information Processing: Proceedings of the Eighth Annual Carnegie Symposium on Cognition</conf-name></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname> <given-names>FA</given-names></name><name><surname>Hansen</surname> <given-names>LK</given-names></name><name><surname>Balslev</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Mining for associations between text and brain activation in a functional neuroimaging database</article-title><source>Neuroinformatics</source><volume>2</volume><fpage>369</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1385/NI:2:4:369</pub-id><pub-id pub-id-type="pmid">15800369</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname> <given-names>F</given-names></name><name><surname>Varoquaux</surname> <given-names>G</given-names></name><name><surname>Gramfort</surname> <given-names>A</given-names></name><name><surname>Michel</surname> <given-names>V</given-names></name><name><surname>Thirion</surname> <given-names>B</given-names></name><name><surname>Grisel</surname> <given-names>O</given-names></name><name><surname>Blondel</surname> <given-names>M</given-names></name><name><surname>Prettenhofer</surname> <given-names>P</given-names></name><name><surname>Weiss</surname> <given-names>R</given-names></name><name><surname>Dubourg</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Scikit-learn: machine learning in Python</article-title><source>Journal of Machine Learning Research</source><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Piantadosi</surname> <given-names>ST</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Zipf's word frequency law in natural language: a critical review and future directions</article-title><source>Psychonomic Bulletin &amp; Review</source><volume>21</volume><fpage>1112</fpage><lpage>1130</lpage><pub-id pub-id-type="doi">10.3758/s13423-014-0585-6</pub-id><pub-id pub-id-type="pmid">24664880</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pinho</surname> <given-names>AL</given-names></name><name><surname>Amadon</surname> <given-names>A</given-names></name><name><surname>Ruest</surname> <given-names>T</given-names></name><name><surname>Fabre</surname> <given-names>M</given-names></name><name><surname>Dohmatob</surname> <given-names>E</given-names></name><name><surname>Denghien</surname> <given-names>I</given-names></name><name><surname>Ginisty</surname> <given-names>C</given-names></name><name><surname>Becuwe-Desmidt</surname> <given-names>S</given-names></name><name><surname>Roger</surname> <given-names>S</given-names></name><name><surname>Laurier</surname> <given-names>L</given-names></name><name><surname>Joly-Testault</surname> <given-names>V</given-names></name><name><surname>Médiouni-Cloarec</surname> <given-names>G</given-names></name><name><surname>Doublé</surname> <given-names>C</given-names></name><name><surname>Martins</surname> <given-names>B</given-names></name><name><surname>Pinel</surname> <given-names>P</given-names></name><name><surname>Eger</surname> <given-names>E</given-names></name><name><surname>Varoquaux</surname> <given-names>G</given-names></name><name><surname>Pallier</surname> <given-names>C</given-names></name><name><surname>Dehaene</surname> <given-names>S</given-names></name><name><surname>Hertz-Pannier</surname> <given-names>L</given-names></name><name><surname>Thirion</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Individual brain charting, a high-resolution fMRI dataset for cognitive mapping</article-title><source>Scientific Data</source><volume>5</volume><elocation-id>180105</elocation-id><pub-id pub-id-type="doi">10.1038/sdata.2018.105</pub-id><pub-id pub-id-type="pmid">29893753</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poldrack</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Can cognitive processes be inferred from neuroimaging data?</article-title><source>Trends in Cognitive Sciences</source><volume>10</volume><fpage>59</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2005.12.004</pub-id><pub-id pub-id-type="pmid">16406760</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poldrack</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Subtraction and beyond: the logic of experimental designs for neuroimaging</article-title><source>In Foundational Issues in Human Brain Mapping</source><volume>147</volume><elocation-id>14</elocation-id><pub-id pub-id-type="doi">10.7551/mitpress/9780262014021.003.0014</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Mumford</surname> <given-names>JA</given-names></name><name><surname>Nichols</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Handbook of Functional MRI Data Analysis</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511895029</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Mumford</surname> <given-names>JA</given-names></name><name><surname>Schonberg</surname> <given-names>T</given-names></name><name><surname>Kalar</surname> <given-names>D</given-names></name><name><surname>Barman</surname> <given-names>B</given-names></name><name><surname>Yarkoni</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Discovering relations between mind, brain, and mental disorders using topic mapping</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002707</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002707</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Baker</surname> <given-names>CI</given-names></name><name><surname>Durnez</surname> <given-names>J</given-names></name><name><surname>Gorgolewski</surname> <given-names>KJ</given-names></name><name><surname>Matthews</surname> <given-names>PM</given-names></name><name><surname>Munafò</surname> <given-names>MR</given-names></name><name><surname>Nichols</surname> <given-names>TE</given-names></name><name><surname>Poline</surname> <given-names>JB</given-names></name><name><surname>Vul</surname> <given-names>E</given-names></name><name><surname>Yarkoni</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Scanning the horizon: towards transparent and reproducible neuroimaging research</article-title><source>Nature Reviews Neuroscience</source><volume>18</volume><fpage>115</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1038/nrn.2016.167</pub-id><pub-id pub-id-type="pmid">28053326</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Yarkoni</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>From brain maps to cognitive ontologies: informatics and the search for mental structure</article-title><source>Annual Review of Psychology</source><volume>67</volume><fpage>587</fpage><lpage>612</lpage><pub-id pub-id-type="doi">10.1146/annurev-psych-122414-033729</pub-id><pub-id pub-id-type="pmid">26393866</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rifkin</surname> <given-names>RM</given-names></name><name><surname>Lippert</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>Notes on Regularized Least Squares</source><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname> <given-names>TN</given-names></name><name><surname>Koyejo</surname> <given-names>O</given-names></name><name><surname>Gorgolewski</surname> <given-names>KJ</given-names></name><name><surname>Jones</surname> <given-names>MN</given-names></name><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Yarkoni</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Decoding brain activity using a large-scale probabilistic functional-anatomical atlas of human cognition</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005649</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005649</pub-id><pub-id pub-id-type="pmid">29059185</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salimi-Khorshidi</surname> <given-names>G</given-names></name><name><surname>Smith</surname> <given-names>SM</given-names></name><name><surname>Keltner</surname> <given-names>JR</given-names></name><name><surname>Wager</surname> <given-names>TD</given-names></name><name><surname>Nichols</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Meta-analysis of neuroimaging data: a comparison of image-based and coordinate-based pooling of studies</article-title><source>NeuroImage</source><volume>45</volume><fpage>810</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.12.039</pub-id><pub-id pub-id-type="pmid">19166944</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salton</surname> <given-names>G</given-names></name><name><surname>Buckley</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Term-weighting approaches in automatic text retrieval</article-title><source>Information Processing &amp; Management</source><volume>24</volume><fpage>513</fpage><lpage>523</lpage><pub-id pub-id-type="doi">10.1016/0306-4573(88)90021-0</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sayers</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><chapter-title>The e-utilities in-depth: parameters, syntax and more</chapter-title><source>Entrez Programming Utilities Help [Internet]</source><publisher-loc>Bethesda, MD</publisher-loc><publisher-name>National Center for Biotechnology Information (US)</publisher-name></element-citation></ref><ref id="bib38"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Scott</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Multivariate Density Estimation: Theory, Practice, and Visualization</source><publisher-name>John Wiley &amp; Sons</publisher-name><pub-id pub-id-type="doi">10.1002/9780470316849</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Silverman</surname> <given-names>BW</given-names></name></person-group><year iso-8601-date="1986">1986</year><source>Density Estimation for Statistics and Data Analysis</source><publisher-name>CRC Press</publisher-name></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sitek</surname> <given-names>EJ</given-names></name><name><surname>Thompson</surname> <given-names>JC</given-names></name><name><surname>Craufurd</surname> <given-names>D</given-names></name><name><surname>Snowden</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Unawareness of deficits in Huntington's disease</article-title><source>Journal of Huntington's Disease</source><volume>3</volume><fpage>125</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.3233/JHD-140109</pub-id><pub-id pub-id-type="pmid">25062855</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turkeltaub</surname> <given-names>PE</given-names></name><name><surname>Eden</surname> <given-names>GF</given-names></name><name><surname>Jones</surname> <given-names>KM</given-names></name><name><surname>Zeffiro</surname> <given-names>TA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Meta-analysis of the functional neuroanatomy of single-word reading: method and validation</article-title><source>NeuroImage</source><volume>16</volume><fpage>765</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1006/nimg.2002.1131</pub-id><pub-id pub-id-type="pmid">12169260</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turney</surname> <given-names>PD</given-names></name><name><surname>Pantel</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>From frequency to meaning: vector space models of semantics</article-title><source>Journal of Artificial Intelligence Research</source><volume>37</volume><fpage>141</fpage><lpage>188</lpage><pub-id pub-id-type="doi">10.1613/jair.2934</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulrich</surname> <given-names>R</given-names></name><name><surname>Mattes</surname> <given-names>S</given-names></name><name><surname>Miller</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Donders's assumption of pure insertion: an evaluation on the basis of response dynamics</article-title><source>Acta Psychologica</source><volume>102</volume><fpage>43</fpage><lpage>76</lpage><pub-id pub-id-type="doi">10.1016/S0001-6918(99)00019-0</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varoquaux</surname> <given-names>G</given-names></name><name><surname>Schwartz</surname> <given-names>Y</given-names></name><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Gauthier</surname> <given-names>B</given-names></name><name><surname>Bzdok</surname> <given-names>D</given-names></name><name><surname>Poline</surname> <given-names>JB</given-names></name><name><surname>Thirion</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Atlases of cognition with large-scale human brain mapping</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006565</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006565</pub-id><pub-id pub-id-type="pmid">30496171</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wager</surname> <given-names>TD</given-names></name><name><surname>Jonides</surname> <given-names>J</given-names></name><name><surname>Reading</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Neuroimaging studies of shifting attention: a meta-analysis</article-title><source>NeuroImage</source><volume>22</volume><fpage>1679</fpage><lpage>1693</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.03.052</pub-id><pub-id pub-id-type="pmid">15275924</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wager</surname> <given-names>TD</given-names></name><name><surname>Lindquist</surname> <given-names>M</given-names></name><name><surname>Kaplan</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Meta-analysis of functional neuroimaging data: current and future directions</article-title><source>Social Cognitive and Affective Neuroscience</source><volume>2</volume><fpage>150</fpage><lpage>158</lpage><pub-id pub-id-type="doi">10.1093/scan/nsm015</pub-id><pub-id pub-id-type="pmid">18985131</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wager</surname> <given-names>TD</given-names></name><name><surname>Kang</surname> <given-names>J</given-names></name><name><surname>Johnson</surname> <given-names>TD</given-names></name><name><surname>Nichols</surname> <given-names>TE</given-names></name><name><surname>Satpute</surname> <given-names>AB</given-names></name><name><surname>Barrett</surname> <given-names>LF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A bayesian model of category-specific emotional brain responses</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004066</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004066</pub-id><pub-id pub-id-type="pmid">25853490</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wager</surname> <given-names>TD</given-names></name><name><surname>Atlas</surname> <given-names>LY</given-names></name><name><surname>Botvinick</surname> <given-names>MM</given-names></name><name><surname>Chang</surname> <given-names>LJ</given-names></name><name><surname>Coghill</surname> <given-names>RC</given-names></name><name><surname>Davis</surname> <given-names>KD</given-names></name><name><surname>Iannetti</surname> <given-names>GD</given-names></name><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Shackman</surname> <given-names>AJ</given-names></name><name><surname>Yarkoni</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pain in the ACC?</article-title><source>PNAS</source><volume>113</volume><fpage>E2474</fpage><lpage>E2475</lpage><pub-id pub-id-type="doi">10.1073/pnas.1600282113</pub-id><pub-id pub-id-type="pmid">27095849</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Witt</surname> <given-names>ST</given-names></name><name><surname>Laird</surname> <given-names>AR</given-names></name><name><surname>Meyerand</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Functional neuroimaging correlates of finger-tapping task variations: an ALE meta-analysis</article-title><source>NeuroImage</source><volume>42</volume><fpage>343</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.04.025</pub-id><pub-id pub-id-type="pmid">18511305</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xue</surname> <given-names>W</given-names></name><name><surname>Kang</surname> <given-names>J</given-names></name><name><surname>Bowman</surname> <given-names>FD</given-names></name><name><surname>Wager</surname> <given-names>TD</given-names></name><name><surname>Guo</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Identifying functional co-activation patterns in neuroimaging studies via poisson graphical models</article-title><source>Biometrics</source><volume>70</volume><fpage>812</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1111/biom.12216</pub-id><pub-id pub-id-type="pmid">25147001</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yarkoni</surname> <given-names>T</given-names></name><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Van Essen</surname> <given-names>DC</given-names></name><name><surname>Wager</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cognitive neuroscience 2.0: building a cumulative science of human brain function</article-title><source>Trends in Cognitive Sciences</source><volume>14</volume><fpage>489</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2010.08.004</pub-id><pub-id pub-id-type="pmid">20884276</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yarkoni</surname> <given-names>T</given-names></name><name><surname>Poldrack</surname> <given-names>RA</given-names></name><name><surname>Nichols</surname> <given-names>TE</given-names></name><name><surname>Van Essen</surname> <given-names>DC</given-names></name><name><surname>Wager</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Large-scale automated synthesis of human functional neuroimaging data</article-title><source>Nature Methods</source><volume>8</volume><fpage>665</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1635</pub-id><pub-id pub-id-type="pmid">21706013</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeo</surname> <given-names>BT</given-names></name><name><surname>Krienen</surname> <given-names>FM</given-names></name><name><surname>Eickhoff</surname> <given-names>SB</given-names></name><name><surname>Yaakub</surname> <given-names>SN</given-names></name><name><surname>Fox</surname> <given-names>PT</given-names></name><name><surname>Buckner</surname> <given-names>RL</given-names></name><name><surname>Asplund</surname> <given-names>CL</given-names></name><name><surname>Chee</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Functional specialization and flexibility in human association cortex</article-title><source>Cerebral Cortex</source><volume>25</volume><fpage>3654</fpage><lpage>3672</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhu217</pub-id><pub-id pub-id-type="pmid">25249407</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53385.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Yeo</surname><given-names>Thomas</given-names></name><role>Reviewing Editor</role><aff><institution>National University of Singapore</institution><country>Singapore</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Wager</surname><given-names>Tor D</given-names></name><role>Reviewer</role><aff><institution>Dartmouth</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This paper describes NeuroQuery, a new approach to automated meta-analysis of the neuroimaging literature. It is demonstrably superior for many purposes, particularly as a starting point for constraining predictive models and as regions or patterns of interest in new studies. We believe that this will be a very widely used tool. It's also a tremendous amount of work to build and validate, and very few groups have both the skills and motivation to build this and make it accessible to the broad neuroscience/neuroimaging community.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;NeuroQuery: comprehensive meta-analysis of human brain mapping&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Christian Büchel as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Tor D. Wager (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This paper describes NeuroQuery, a new approach to automated meta-analysis of the neuroimaging literature. It is demonstrably superior for many purposes – particularly as a starting point for constraining predictive models and as regions or patterns of interest in new studies. We believe that this will be a very widely used, and cited, tool. It's also a tremendous amount of work to build and validate, and very few groups have both the skills and motivation to build this and make it accessible to the broad neuroscience/neuroimaging community.</p><p>There are a number of exemplary features of this work, including:</p><p>– A full implementation that is openly shared on Github, including source code, models, and data</p><p>– A fully functional web interface that runs simply and beautifully</p><p>– Several types of validation of the model's performance, including (a) stability with rare terms listed in few studies, (b) reproducibility of maps with limited data, (c) better encoding/prediction of brain maps associated with terms.</p><p>This work dramatically expands the vocabulary of search terms that can be used in neuroimaging meta-analyses. We believe this is going to be really useful. The model framework is also interesting and motivated by some careful considerations in terms of how the model should be affected by certain classes of rare terms, features included in the model, etc. The bottom line for users is a better set of predictive maps. While there are many potential varieties of such models and one could second-guess some particular choices, the beauty of the authors' approach is that the code is available for others to try out variations and build/validate a different model based on their sensibilities and preferences.</p><p>Essential revisions:</p><p>1) We believe that the validations are insufficient for some of the claims. The authors should either expand their experiments to validate these claims or tone down their claims.</p><p>A) &quot;NeuroQuery, can assemble results from the literature into a brain map based on an arbitrary query.&quot; This statement can be mis-interpreted to mean that users can enter any terms they want. My understanding is that the query has to comprise words from the 7547 dictionary words. Words outside the dictionary are ignored.</p><p>B) Introduction: &quot;For example, some rare diseases, or a task involving a combination of mental processes that have been studied separately, but never – or rarely – together.&quot; This suggests NeuroQuery can do this with precision, but the authors have not experimentally demonstrated that activation maps involving &quot;combination of mental processes that have been studied separately, but never together&quot; can be accurately predicted. To validate this, the authors should consider cases involving compound mental processes (e.g., &quot;auditory working memory&quot;) and remove all experiments involving both &quot;auditory&quot; + &quot;working memory&quot;. Care has to be taken to also remove experiments using words similar to &quot;auditory&quot; + &quot;working memory&quot;, so that experiments such as &quot;auditory n-back&quot; are also removed, even though the experiments did not explicitly use the term &quot;working memory&quot;. Note that the entire experiments should be removed, rather than just the specific words. The authors can then re-train their model and show whether the query &quot;auditory working memory&quot; yields activation similar to the removed experiments involving auditory working memory.</p><p>C) For subsection “NeuroQuery can map rare or difficult concepts”, it's important to differentiate between a concept that is rarely studied versus a rare word that seldom appears in the literature even though variations of the word might be widely studied. The whole section seems to imply that the NeuroQuery is able to accomplish the former very well, but in the experiment, they chose frequent terms (e.g., language) and progressively delete them from their dataset, thus they are really testing the latter. To really test the former, rather than just deleting the word &quot;language&quot; from the documents, they should delete entire documents containing &quot;language&quot; and/or other terms similar to language (e.g., semantic).</p><p>2) Figure 8 (right panel) should be in the main text in addition to (or replacing) Figure 6. While the log likelihood measure is valid, the &quot;absolute&quot; measure is much more helpful to the users of knowing how much to trust the results. Along this note, it is somewhat concerning that the overall accuracy is only 70% – how much should a user trust a tool with a 70% accuracy? However, this is perhaps underselling NeuroQuery because coordinates tend to be sparse, so just based on the reported coordinates, this classification task might simply be very hard. What might be more useful would be for the user to get a sense of how much the NeuroQuery maps actually matches real activation maps. Can the authors perform the same experiment, but using real activation maps from NeuroVault or their own Individual Brain Charting dataset? This is just a suggestion. The authors can choose to just discuss this issue.</p><p>3) Results section: some pieces of argumentation presented here are not fully convincing. The authors propose that: &quot;Term co-occurrences, on the other hand, are more consistent and reliable, and capture semantic relationships [Turney and Pantel, 2010]&quot;. Most of the brain mapping literature is made of attempts to differentiate cognitive processes inferred from the study of human behaviour such as &quot;proactive control VS retroactive control&quot;, &quot;recollection VS familiarity&quot;, &quot;face perception VS place perception&quot;, &quot;positive emotion VS negative emotion&quot;. In that context, it is unclear how terms co-occurrence for example between &quot;face&quot; and &quot;place&quot; would be more consistent and reliable than &quot;face&quot; alone. Term co-occurrence mainly reflects what type of concepts tend to be studied together.</p><p>4) The authors suggest that &quot;It would require hundreds of studies to detect a peak activation pattern for &quot;aphasia&quot;. It is not clear what do the authors mean here. Aphasia is a clinical construct referring to a behavioural disturbance. It is defined as &quot;an inability (or impaired ability) to produce or understand speech&quot;. Accordingly, we don't see how one could search for a peak of activation related to aphasia? The line of argumentation could be clarified here by starting with concrete examples. Perhaps an example the authors may refer to is that, starting from a clinical point of view, researchers may want to investigate brain activation related to the processes of language production in order to better understand dysfunctions such those seen in aphasia. Accordingly, the related publication will probably mention &quot;aphasia&quot; &quot;language production&quot; &quot;phonological output lexicon&quot; etc… and this pattern of terms could in turn be linked to similar language related terms in other publications. An alternative guess is that maybe the authors actually refer here to lesion studies that have, for example, searched for correlation between grey matter volume atrophy and aphasia?</p><p>5) We have some suggestions for improving the Abstract/Introduction</p><p>A) Explaining how a predictive framework allows maps to be generated by generalizing from terms that are well studied (&quot;faces&quot;) to those that are less well studied and inaccessible to traditional meta-analyses (&quot;prosopagnosia&quot;). And explaining that this is good for some use cases (generating sensible ROIs/making guesses about where future studies of prosopagnosia might activate), but not good for others (e.g., knowing that a particular area is (de)activated in studies of prosopagnosia).</p><p>B) Can you provide a bit more context on previous topic models (e.g., Nielsen/Hansen NNMF &quot;bag of words&quot; work from way back, Poldrack/Yarkoni topic models, GCLDA) and how this approach is different. After reading the Introduction, readers have a sense of what Neuroquery does (its goal), but not how it actually does it (no algorithmic insight). For example, Neuroquery &quot;infers semantic similarities across terms used in the literature&quot;, but so does a topic model (which is not mentioned/cited). We recommend including more description early on of what the algorithmic differences are relative to previous work that confer advantages. This is explained later (with some redundancy across sections), but more up front would be helpful.</p><p>C) In the Introduction, the authors argue that meta-analyses are limited primarily by performance of in-sample statistical inference (they &quot;model all studies asking the same question&quot;) and lack of use of a predictive framework. While there is great value in the current work, we don't think that is strictly true. Other meta-analyses have taken a predictive approach, in a limited way, and also modeled differences across study categories. The Naive Bayes classifier analyses in the Neurosynth paper (Yarkoni, 2011) are an example. And Neurosynth considers topics across tasks and fields of study. Analyzing studies by single search terms is an important limitation (topic models by Poldrack and Yarkoni help; perhaps acknowledge their 2014 paper). Viewing the paper as a whole, we understand why the authors focus on prediction vs. inference in the Introduction, but it's hard to understand how this other work fits in without having gone through the whole paper.</p><p>D) Likewise, the emphasis on the ability to interpolate struck us as odd. We understand this as generalizing based on semantic smoothing. This is useful, but we don't think what you meant was really clearly explained in the Introduction.</p><p>E) The authors make a compelling case that current meta-analyses are limited. The Pinho 2018 example is very helpful: An automated meta-analysis of all the studies performing the same or a similar contrast is not currently possible, primarily because we have lacked the tools to parse the natural language text in articles well enough to identify an &quot;equivalence class&quot; of functional contrasts.</p><p>F) &quot;For example, some rare diseases, or a task involving a combination of mental processes that have been studied separately, but never – or rarely – together.&quot; Could the authors provide a concrete example?</p><p>6) We have some suggestions for improving the clarity of the Results section:</p><p>A) “NeuroQuery relies on a corpus of 13459 full-text neuroimaging publications”</p><p>What type of neuroimaging publications? task-based activations experiments? If so, of which type: PET and fMRI or only fMRI-based? does it also include structural MRI studies? does it include all types of populations (healthy adults, elderly, patients studies)?</p><p>B) It is not clear how to read Figure 1. What do the length and width of the color and grey lines represent? could this figure be more elaborated to integrate additional aspects of the procedure? e.g. each of the three brain slice has a color that seems to reflect their respective association with the term, how is all that information combine to a single brain pattern?</p><p>C) Terminological precision: Results paragraph one: the term &quot;area&quot; is usually reserved for brain territories defined based on microstructure features (e.g. Area 4). Here the authors refer to a spatial location in the brain (or maybe a zone of homogeneity with regards to a specific feature), so they should prefer the term &quot;brain region&quot; for that purpose.</p><p>D) Finally, the supplement material provides several quantitative evidence of significant improvement compared to Neurosynth, such as:</p><p>– &quot;our method extracted false coordinates from fewer articles: 3 / 40 articles have at least one false location in our dataset, against 20 for NeuroSynth&quot;</p><p>– &quot;In terms of raw amount of text, this corpus is 20 times larger than NeuroSynth's&quot;</p><p>– &quot;Compared with NeuroSynth, NeuroQuery's extraction method reduced the number of articles with incorrect coordinates (false positives) by a factor of 7, and the number of articles with missing coordinates (false negatives) by a factor of 3 (Table 2).&quot;</p><p>All these aspects could be summarized together with the more qualitative aspects in a table to emphasize the significant improvements over Neurosynth.</p><p>7) In the Discussion, it would be very helpful to give readers some intuition for when NeuroQuery will not yield sensible results and when/how exactly it should be used (e.g., even a table of use cases that would be appropriate and inappropriate) – and how to interpret carefully (e.g., look at the semantic loadings, and if there is one anatomical term that dominates, realize that you're essentially getting a map for that brain region). The ADHD example is useful but doesn't really cover the space of principles/use cases. Here are some possible examples we have thought of:</p><p>A) Some particular limitations may arise from the predictive nature of neuroquery, which may be less intuitive to many readers. For example, if I put in &quot;aphasia&quot;, I will get map for &quot;language&quot;, because aphasia is semantically close to language. This is very sensible, but users should not, of course, take this as a map of &quot;aphasia&quot; to be related other terms and used in inference. Users might &quot;discover&quot; that aphasia patterns are very closely related to &quot;language&quot; patterns and make an inference about co-localization of healthy and abnormal function. Of course, it's not your responsibility to control all kinds of potential misuse. But pointers would be helpful to avoid another, e.g., &quot;#cingulategate&quot; (Lieberman et al., 2016 PNAS).</p><p>B) For example, let's consider again the case about &quot;combination of mental processes that have been studied separately, but never together&quot;. From my understanding of the algorithm, suppose users query &quot;auditory&quot; + &quot;working memory&quot;, basically the prediction will be a linear combination of activation maps from &quot;auditory&quot; and &quot;working memory&quot; (+ similar terms due to the smoothing/query expansion). As such, this assumes that compound mental processes yield activations that are linear combination of activation maps of individual mental processes. This should be made clear.</p><p>C) Playing around with NeuroQuery, there are some queries that generate obviously wrong results. For example, &quot;autobiographical memory&quot; should probably yield the default network, but we getting hippocampal/retrosplenial activation instead. This presumably happens because NeuroQuery &quot;expanded&quot; the query to become memory because &quot;autobiographical memory&quot; is not one of the 200 keywords? Interesting that NeuroSynth does get it correct (https://neurosynth.org/analyses/terms/autobiographical%20memory/).</p><p>D) Perhaps a brief discussion of other limitations would be helpful. We submit that some of the fundamental problems are those not easily solved – that we usually perform meta-analyses based on studies of the same nominal task type (e.g., N-back), and sometimes minor variations in task structure can yield divergent findings. We don't know what all the dimensions are yet. This problem goes far beyond the challenge of establishing a set of consensus labels for task types and relevant cognitive processes. In short, we don't really even know what task features to label yet in many cases, and they don't combine additively. A stop-signal task with one adaptive random walk may be different than one with four, as it allows a different type of cognitive strategy.</p><p>E) When to use it: For common terms, meta-analysis (e.g., Neurosynth) does very well (e.g., Figure 4). When would the authors recommend using NeuroQuery over another meta-analytic tool? Maybe they could provide a summary of use cases and conditions (e.g., when few studies of a term/topic are available). Also see point (C).</p><p>8) Discussion of other approaches: We submit that the field has become tracked into a relatively narrow space of the possible options and techniques for meta-analysis, based on local analysis of coordinates in MKDA/ALE. Alternatives could be mentioned as potential future directions. For example, early work explored clustering of spatial locations and spatial discriminant tests (e.g., Wager et al., 2002, 2004, 2005), and later work has explored spatial models (e.g., Kang, 2011, Kang, 2014, Wager, 2015) and more advanced co-activation models (Xue, 2014). While this is obviously beyond the scope of the present paper, future work might consider models of spatial co-activation when generating predictions and inferences about meta-analytic maps.</p><p>9) The methods are a bit unclear:</p><p>A) Significant details about methodologies are missing. How are term frequency and inverse document frequency computed?</p><p>B) Equation 5: How is σ^ij computed? Square root of the entries of equation 8?</p><p>C) Equation 5: What is the difference between σ^<sub>i</sub> and σ^<sub>ij</sub>? σ^<sub>i</sub> is a column/row of σ^<sub>ij</sub>?</p><p>D) Y<sub>j</sub> is the j-th column not i-th column of Y?</p><p>E) M is a v x n matrix, so equation 8 is a v x v matrix? We are confused how this maps to σ^<sub>ij</sub>.</p><p>F) In Equation 10, is ||U||_1 just the sum of absolute values of all entries in U?</p><p>G) What is k set to be in equation 10?</p><p>H) &quot;More than 72% of the time, NeuroQuery's output has a higher Pearson correlation with the correct map than with the negative example&quot; – &quot;correct map&quot; refers to the KDE density maps?</p><p>10) Subsection “Smoothing: regularization at test time” is hard to read. It would be helpful if the authors explain the intuition behind the different steps and what the different matrices represent. For example, it might be helpful to explain that each row of V can be thought of as the association of words with topic k, so a higher value for row i, column j suggests the j-th dictionary word is more strongly related to the topic k. As another example, the authors should also unpack subsection “Smoothing: regularization at test time”: why do we take V and scale with 𝑛<sub>𝑖,𝑖</sub> and then compute C and then l1-normalizing the rows of C to produce T and then finally S. What does each step try to do? We guess roughly speaking VV^T is like a co-occurrence matrix (how likely are two words likely to appear together?), but we are not sure why we have to do the extra normalization with 𝑛<sub>𝑖,𝑖</sub>, l1-normalization, etc.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53385.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) We believe that the validations are insufficient for some of the claims. The authors should either expand their experiments to validate these claims or tone down their claims.</p></disp-quote><p>We have both added evidence, and toned down claims where they were not justified.</p><disp-quote content-type="editor-comment"><p>A) &quot;NeuroQuery, can assemble results from the literature into a brain map based on an arbitrary query.&quot; This statement can be mis-interpreted to mean that users can enter any terms they want. My understanding is that the query has to comprise words from the 7547 dictionary words. Words outside the dictionary are ignored.</p></disp-quote><p>Indeed, we made this statement more precise.</p><disp-quote content-type="editor-comment"><p>B) Introduction: &quot;For example, some rare diseases, or a task involving a combination of mental processes that have been studied separately, but never – or rarely – together.&quot; This suggests NeuroQuery can do this with precision, but the authors have not experimentally demonstrated that activation maps involving &quot;combination of mental processes that have been studied separately, but never together&quot; can be accurately predicted. To validate this, the authors should consider cases involving compound mental processes (e.g., &quot;auditory working memory&quot;) and remove all experiments involving both &quot;auditory&quot; + &quot;working memory&quot;. Care has to be taken to also remove experiments using words similar to &quot;auditory&quot; + &quot;working memory&quot;, so that experiments such as &quot;auditory n-back&quot; are also removed, even though the experiments did not explicitly use the term &quot;working memory&quot;. Note that the entire experiments should be removed, rather than just the specific words. The authors can then re-train their model and show whether the query &quot;auditory working memory&quot; yields activation similar to the removed experiments involving auditory working memory.</p></disp-quote><p>We thank the reviewers for outlining this aspect of the contribution that was not sufficiently validated. We have added a section (“NeuroQuery can map new combinations of concepts”) with new experiments to showcase that NeuroQuery indeed can map unseen combinations of terms, following the reviewers’ suggestion to fit NeuroQuery on a corpus of study excluding studies of the combination of two given terms. We have first shown the maps for qualitative assessment on the combination of &quot;color&quot; and &quot;distance&quot; (Figure 3). We have also performed a quantitative assessment leaving random pairs of terms unseen (also section “NeuroQuery can map new combinations of concepts”). When choosing the random pairs of terms, we did not remove related words as it is very difficult to do in an automated way, in particular it runs the risk of depleting the corpus by removing too many studies. However, for the specific case of &quot;color&quot; and &quot;distance&quot;, we do not see any clear synonyms or alternate way of referring to the same exact mental process in our vocabulary. Hence we feel that the corresponding figure addresses the reviewers’ suggestion.</p><disp-quote content-type="editor-comment"><p>C) For subsection “NeuroQuery can map rare or difficult concepts”, it's important to differentiate between a concept that is rarely studied versus a rare word that seldom appears in the literature even though variations of the word might be widely studied. The whole section seems to imply that the NeuroQuery is able to accomplish the former very well, but in the experiment, they chose frequent terms (e.g., language) and progressively delete them from their dataset, thus they are really testing the latter. To really test the former, rather than just deleting the word &quot;language&quot; from the documents, they should delete entire documents containing &quot;language&quot; and/or other terms similar to language (e.g., semantic).</p></disp-quote><p>We have added at the end of subsection “NeuroQuery can map rare or difficult concepts” a paragraph making explicit the difference between these two aspects. We explain how NeuroQuery improves also for seldom-studied concepts. However, we can only present face validity as evidence for this claim, for lack of solid ground truth on these terms. We have added maps for &quot;color&quot; and &quot;Huntington&quot; on Figure 4: these terms are rare (the number of occurrences is shown on Figure 4), and they do not have synonyms in our vocabulary and therefore the quality of the maps that they produce is evidence that NeuroQuery maps rare concepts.</p><disp-quote content-type="editor-comment"><p>2) Figure 8 (right panel) should be in the main text in addition to (or replacing) Figure 6. While the log likelihood measure is valid, the &quot;absolute&quot; measure is much more helpful to the users of knowing how much to trust the results. Along this note, it is somewhat concerning that the overall accuracy is only 70% – how much should a user trust a tool with a 70% accuracy? However, this is perhaps underselling NeuroQuery because coordinates tend to be sparse, so just based on the reported coordinates, this classification task might simply be very hard. What might be more useful would be for the user to get a sense of how much the NeuroQuery maps actually matches real activation maps. Can the authors perform the same experiment, but using real activation maps from NeuroVault or their own Individual Brain Charting dataset? This is just a suggestion. The authors can choose to just discuss this issue.</p></disp-quote><p>We have moved the &quot;mix and match&quot; results to the main manuscript. While the reviewer finds that 72% accuracy in distinguishing studies is a disappointing result, we fear that it might not be a limitation of the statistical modeling, but rather a measure of noise in reported results. Indeed, the amount of variability in reported results can be gauged visually with the Neuroquery only interface: for a given query, the coordinates reported in the most relevant publications can be seen by hovering over the list, below the predicted map. Such an experiment shows a great variability in publications on similar topics.</p><p>We thank the reviewers for suggesting to compare NeuroQuery predictions to real activation maps. We have addressed it in subsection “NeuroQuery maps reflect well other meta-analytic maps”. We considered using the IBC dataset as suggested. IBC activation maps do not suffer from the sparsity of peak coordinates. However, as many individual fMRI maps, they are also tainted by an important amount of noise.</p><p>To confront NeuroQuery to a more reliable ground truth, we therefore preferred to rely on an Image-Based Meta-Analysis study. We compared NeuroQuery predictions to maps of the BrainPedia study, published last year by some authors of the current submission. This dataset is interesting because it covers a wide variety of cognitive concepts, the studies included in the meta-analysis were chosen manually, and the meta-analytic maps were carefully labelled. The maps and labels from this publication were uploaded to NeuroVault in December, 2018.</p><p>When reformulating the BrainPedia labels to match NeuroSynth’s vocabulary, both NeuroSynth and NeuroQuery matched well the IBMA results, with a median AUC of respectively 0.8 and 0.9. Importantly, while reformulating the labels is necessary to obtain results from NeuroSynth, NeuroQuery coped well with the original, uncurated labels, obtaining a median AUC of 0.8. This illustrates NeuroQuery’s capacity to handle less restricted queries, that enables it to be integrated in more automated pipelines.</p><p>Although they come from an IBMA of manually selected studies, BrainPedia maps still contain some noise. To perform a sanity check relying on an excellent ground truth, we obtained maps from NeuroSynth and NeuroQuery for labels of the Harvard-Oxford structural atlases. The CBMA maps matched well the regions manually segmented by experts, with a median AUC above 0.9.</p><p>Finally, we compared NeuroQuery predictions to NeuroSynth activations for terms that NeuroSynth captures well (the 200 words that produce the largest number of activations with NeuroSynth). We found that the results of NeuroQuery and NeuroSynth for these terms were close, with a median AUC of 0.9. Results from these experiments are presented in subsection “NeuroQuery maps reflect well other meta-analytic maps”.</p><disp-quote content-type="editor-comment"><p>3) Results section: some pieces of argumentation presented here are not fully convincing. The authors propose that: &quot;Term co-occurrences, on the other hand, are more consistent and reliable, and capture semantic relationships [Turney and Pantel, 2010]&quot;. Most of the brain mapping literature is made of attempts to differentiate cognitive processes inferred from the study of human behaviour such as &quot;proactive control VS retroactive control&quot;, &quot;recollection VS familiarity&quot;, &quot;face perception VS place perception&quot;, &quot;positive emotion VS negative emotion&quot;. In that context, it is unclear how terms co-occurrence for example between &quot;face&quot; and &quot;place&quot; would be more consistent and reliable than &quot;face&quot; alone. Term co-occurrence mainly reflects what type of concepts tend to be studied together.</p></disp-quote><p>An important aspect of the semantic techniques that we use is that they give a continuous measure of relatedness. For this reason, we think that the use of oppositions in neuroimaging is not a fundamental roadblock: terms that are often studied in opposition are different, but they are related, on the bigger picture of cognition. All the examples listed by the reviewer are pairs drawn from the same subfield of cognition, which would be encoded as a specific branch in a cognitive ontology. The co-occurrences thus help meta-analysis: &quot;recollection&quot; is closer to &quot;familiarity&quot; than to &quot;positive emotion&quot;. Yet, research in distributional semantics (which lead for instance to the famous &quot;word2vec&quot; model) has shown that they will have a less strong co-occurrence than exact synonyms, such as &quot;acc&quot; and &quot;anterior cingulate cortex&quot;. We have added these considerations in the middle of subsection “Overview of the NeuroQuery model”: &quot;The strength of these relationships encode semantic proximity, from very strong for synonyms that occur in statistically identical contexts, to weaker for different yet related mental processes that are often studied one opposed to the other.&quot;</p><disp-quote content-type="editor-comment"><p>4) The authors suggest that &quot;It would require hundreds of studies to detect a peak activation pattern for &quot;aphasia&quot;. It is not clear what do the authors mean here. Aphasia is a clinical construct referring to a behavioural disturbance. It is defined as &quot;an inability (or impaired ability) to produce or understand speech&quot;. Accordingly, we don't see how one could search for a peak of activation related to aphasia? The line of argumentation could be clarified here by starting with concrete examples. Perhaps an example the authors may refer to is that, starting from a clinical point of view, researchers may want to investigate brain activation related to the processes of language production in order to better understand dysfunctions such those seen in aphasia. Accordingly, the related publication will probably mention &quot;aphasia&quot; &quot;language production&quot; &quot;phonological output lexicon&quot; etc… and this pattern of terms could in turn be linked to similar language related terms in other publications. An alternative guess is that maybe the authors actually refer here to lesion studies that have, for example, searched for correlation between grey matter volume atrophy and aphasia?</p></disp-quote><p>Indeed, the formulation here was not suitable, as &quot;aphasia&quot; is not a mental process but a pathology, and thus not mapped by brain activations. We changed the sentence to &quot;It would require hundreds of studies to detect a pattern in localizations reported for’ aphasia’, as one would appear in lesion studies. But with the text of a few publications we notice that it often appears close to’ language’, which is indeed a related mental process&quot;. We choose to do a light rewording rather to discuss in depth how pathologies are captured in the brain-imaging literature: via lesions, but also by studying related mental processes, or simulated with transcranial magnetic stimulation. Indeed, we feel that this is not central to the topic of the manuscript.</p><disp-quote content-type="editor-comment"><p>5) We have some suggestions for improving the Abstract/Introduction</p><p>A) Explaining how a predictive framework allows maps to be generated by generalizing from terms that are well studied (&quot;faces&quot;) to those that are less well studied and inaccessible to traditional meta-analyses (&quot;prosopagnosia&quot;). And explaining that this is good for some use cases (generating sensible ROIs/making guesses about where future studies of prosopagnosia might activate), but not good for others (e.g., knowing that a particular area is (de)activated in studies of prosopagnosia).</p></disp-quote><p>Indeed, these are good suggestions, that we added to the Introduction.</p><disp-quote content-type="editor-comment"><p>B) Can you provide a bit more context on previous topic models (e.g., Nielsen/Hansen NNMF &quot;bag of words&quot; work from way back, Poldrack/Yarkoni topic models, GCLDA) and how this approach is different. After reading the Introduction, readers have a sense of what Neuroquery does (its goal), but not how it actually does it (no algorithmic insight). For example, Neuroquery &quot;infers semantic similarities across terms used in the literature&quot;, but so does a topic model (which is not mentioned/cited). We recommend including more description early on of what the algorithmic differences are relative to previous work that confer advantages. This is explained later (with some redundancy across sections), but more up front would be helpful.</p></disp-quote><p>The goal of a topic model is not to infer semantic similarity but to extract latent factors. This is a subtle difference, as much of the techniques are the same (though recent work in distributional semantics departs more and more from topic modeling), however this is the reason why we did not mention topic modeling. We have added a section on related work in the Discussion, that stresses the links and the differences to prior art. We would like our manuscript to be appealing to users of NeuroQuery, and not only to experts of meta-analysis or text mining, hence we choose to keep technicalities outside of the Introduction. Nevertheless, we added in the Introduction the mention of supervised learning to give the important keywords to the expert reader.</p><disp-quote content-type="editor-comment"><p>C) In the Introduction, the authors argue that meta-analyses are limited primarily by performance of in-sample statistical inference (they &quot;model all studies asking the same question&quot;) and lack of use of a predictive framework. While there is great value in the current work, we don't think that is strictly true. Other meta-analyses have taken a predictive approach, in a limited way, and also modeled differences across study categories. The Naive Bayes classifier analyses in the Neurosynth paper (Yarkoni, 2011) are an example. And Neurosynth considers topics across tasks and fields of study. Analyzing studies by single search terms is an important limitation (topic models by Poldrack and Yarkoni help; perhaps acknowledge their 2014 paper). Viewing the paper as a whole, we understand why the authors focus on prediction vs. inference in the Introduction, but it's hard to understand how this other work fits in without having gone through the whole paper.</p></disp-quote><p>To discuss better the links with prior art, we have added a section: “Related work” Indeed, the reviewer is right that ingredients of our approach have been used for meta-analysis, and yet not in the way our work combines them. The predictive model of Neurosynth is a decoding model: it predicts (mutually exclusive) terms from brain activations, while we are doing the converse. As a result, it cannot combine information across the terms, which is the crucial aspect of our predictive framework. The Neurosynth maps are not based on the prediction of a model, but the ingredients of a model. Topic models have also been used (we believe the reviewer refers to the 2012 Poldrack paper), but again the prior art uses the model parameters to derive conclusions. Using predictions enables extrapolations, as demonstrated in our manuscript. In addition, the quality of these predictions can be directly assessed, as in the experiments that we perform.</p><disp-quote content-type="editor-comment"><p>D) Likewise, the emphasis on the ability to interpolate struck us as odd. We understand this as generalizing based on semantic smoothing. This is useful, but we don't think what you meant was really clearly explained in the Introduction.</p></disp-quote><p>We have reworked the part of the Introduction that mentioned interpolation to be more clearly related to the aspects that are important for our work: &quot;They cannot model nuances across studies because they rely on in-sample statistical inference and are not designed to interpolate between studies that address related but different questions, or make predictions for unseen combination of mental processes.&quot;</p><disp-quote content-type="editor-comment"><p>E) The authors make a compelling case that current meta-analyses are limited. The Pinho 2018 example is very helpful: An automated meta-analysis of all the studies performing the same or a similar contrast is not currently possible, primarily because we have lacked the tools to parse the natural language text in articles well enough to identify an &quot;equivalence class&quot; of functional contrasts.</p></disp-quote><p>We thank the reviewers for this elegant phrasing. We have taken the liberty to add an adapted version in the Introduction, at the beginning of the paragraph on the Pinho, 2018 example.</p><disp-quote content-type="editor-comment"><p>F) &quot;For example, some rare diseases, or a task involving a combination of mental processes that have been studied separately, but never – or rarely – together.&quot; Could the authors provide a concrete example?</p></disp-quote><p>We have added the specific case of &quot;huntingon&quot; and &quot;agnosia&quot;: &quot;For instance, there is evidence of agnosia in Huntington’s disease [sitek2014], but no neuroimaging study&quot;. Indeed, no publications in the dataset contain both terms, ie, no existing imaging study, but it’s not meaningless as a subject of interest (see https://www. ncbi.nlm.nih.gov/pubmed/25062855).</p><disp-quote content-type="editor-comment"><p>6) We have some suggestions for improving the clarity of the Results section:</p><p>A) “NeuroQuery relies on a corpus of 13459 full-text neuroimaging publications”</p><p>What type of neuroimaging publications? task-based activations experiments? If so, of which type: PET and fMRI or only fMRI-based? does it also include structural MRI studies? does it include all types of populations (healthy adults, elderly, patients studies)?</p></disp-quote><p>We added a short paragraph to clarify this point: &quot;The articles are selected by querying the ESearch Entrez utility either for specific neuroimaging journals or with query strings suchs as’ fMRI’. The resulting studies are mostly based on fMRI experiments, but the dataset also contains PET or structural MRI studies. It contains studies about diverse types of populations: healthy adults, patients, elderly, children.&quot;</p><disp-quote content-type="editor-comment"><p>B) It is not clear how to read Figure 1. What do the length and width of the color and grey lines represent? could this figure be more elaborated to integrate additional aspects of the procedure? e.g. each of the three brain slice has a color that seems to reflect their respective association with the term, how is all that information combine to a single brain pattern?</p></disp-quote><p>We have clarified and expanded the caption of Figure 1, after &quot;Details:.…&quot;. As is now explained in the caption, the length of the lines in the first graph shows the semantic similarity. The length of the lines in the second graph shows the weight of each term in the final prediction (the coefficient of its normalized brain map in the linear combination that produces the final prediction). The width is the same for all bars within each graph and carries no special meaning. The brain maps associated with each colored term are combined linearly, with the weights shown on the second graph, to form the final prediction shown on the far right. As this figure is meant to serve as a high-level, schematic summary of the main steps followed by NeuroQuery, we prefer not to complicate it further by integrating additional aspects of the procedure. Indeed, the exact details of the procedure are described at length in subsection “Overview of the NeuroQuery model”.</p><disp-quote content-type="editor-comment"><p>C) Terminological precision: Results paragraph one: the term &quot;area&quot; is usually reserved for brain territories defined based on microstructure features (e.g. Area 4). Here the authors refer to a spatial location in the brain (or maybe a zone of homogeneity with regards to a specific feature), so they should prefer the term &quot;brain region&quot; for that purpose.</p></disp-quote><p>We thank the reviewers for this correction and replaced &quot;area&quot; with &quot;region&quot; in two phrases: &quot;which brain regions are most likely to be observed in a study.&quot;; &quot;NeuroQuery is a statistical model that identifies brain regions&quot;.</p><disp-quote content-type="editor-comment"><p>D) Finally, the supplement material provides several quantitative evidence of significant improvement compared to Neurosynth, such as:</p><p>– &quot;our method extracted false coordinates from fewer articles: 3 / 40 articles have at least one false location in our dataset, against 20 for NeuroSynth&quot;</p><p>– &quot;In terms of raw amount of text, this corpus is 20 times larger than NeuroSynth's&quot;</p><p>– &quot;Compared with NeuroSynth, NeuroQuery's extraction517 method reduced the number of articles with incorrect coordinates (false positives) by a factor of 7, and the number of articles with missing coordinates (false negatives) by a factor of 3 (Table 2).&quot;</p><p>All these aspects could be summarized together with the more qualitative aspects in a table to emphasize the significant improvements over Neurosynth.</p></disp-quote><p>We have added Table 3 and referenced it in subsection “NeuroQuery maps reflect well other meta-analytic maps” on NeuroQuery as an openly available resource.</p><disp-quote content-type="editor-comment"><p>7) In the Discussion, it would be very helpful to give readers some intuition for when NeuroQuery will not yield sensible results and when/how exactly it should be used (e.g., even a table of use cases that would be appropriate and inappropriate) – and how to interpret carefully (e.g., look at the semantic loadings, and if there is one anatomical term that dominates, realize that you're essentially getting a map for that brain region). The ADHD example is useful but doesn't really cover the space of principles/use cases. Here are some possible examples we have thought of:</p><p>A) Some particular limitations may arise from the predictive nature of neuroquery, which may be less intuitive to many readers. For example, if I put in &quot;aphasia&quot;, I will get map for &quot;language&quot;, because aphasia is semantically close to language. This is very sensible, but users should not, of course, take this as a map of &quot;aphasia&quot; to be related other terms and used in inference. Users might &quot;discover&quot; that aphasia patterns are very closely related to &quot;language&quot; patterns and make an inference about co-localization of healthy and abnormal function. Of course, it's not your responsibility to control all kinds of potential misuse. But pointers would be helpful to avoid another, e.g., &quot;#cingulategate&quot; (Lieberman et al., 2016 PNAS).</p></disp-quote><p>We have added, in the limitation paragraph, a discussion of the possible failures of NeuroQuery, as well as indications on how these failures can be detected from the user interface.</p><p>We have added a lengthy paragraph in the Discussion (beginning of subsection “Usage recommendations and limitations”) on limitations, going into the various reasons why a brain map predicted by NeuroQuery may not match the expected map. This paragraph basically explains how to craft queries to break the tool. We do hope that, given this power, the reviewers will still appreciate that the average prediction for typical query is good.</p><p>With regards to the bigger picture mentioned by the reviewers, we feel misuse of meta-analysis, as in the cingulategate, arises from a lack of understanding of the limitations of meta-analysis. Hence, we added a broad picture section (Conclusion), discussing these limitations, and positioning explicitly NeuroQuery with regards to these. This paragraph gives a broader picture than the rest of the manuscript, and we hope that it does not feel off topic.</p><p>To avoid another &quot;cingulategate&quot;, we also chose to be very explicit in the Discussion: &quot;A NeuroQuery prediction by itself therefore does not support definite conclusions&quot;, and later: &quot;What NeuroQuery does not do is provide conclusive evidence that a brain region is recruited by a mental process, or affected by a pathology&quot;.</p><disp-quote content-type="editor-comment"><p>B) For example, let's consider again the case about &quot;combination of mental processes that have been studied separately, but never together&quot;. From my understanding of the algorithm, suppose users query &quot;auditory&quot; + &quot;working memory&quot;, basically the prediction will be a linear combination of activation maps from &quot;auditory&quot; and &quot;working memory&quot; (+ similar terms due to the smoothing/query expansion). As such, this assumes that compound mental processes yield activations that are linear combination of activation maps of individual mental processes. This should be made clear.</p></disp-quote><p>Indeed this is our assumption, though it is a common one in functional neuroimaging (often referred to as the &quot;pure insertion&quot; hypothesis). We have made it very explicit in our own limitation paragraph and have exhibited a situation where it leads to undesirable result.</p><disp-quote content-type="editor-comment"><p>C) Playing around with NeuroQuery, there are some queries that generate obviously wrong results. For example, &quot;autobiographical memory&quot; should probably yield the default network, but we getting hippocampal/retrosplenial activation instead. This presumably happens because NeuroQuery &quot;expanded&quot; the query to become memory because &quot;autobiographical memory&quot; is not one of the 200 keywords? Interesting that NeuroSynth does get it correct (https://neurosynth.org/analyses/terms/autobiographical%20memory/).</p></disp-quote><p>Neuroquery’s map is actually quite close to neurosynth: both segment the hippocampus, the retrosplenial cortex and the precuneus. The difference lies mostly in the ACC/parietal parts of the default mode network. However we are aware that the query expansion is sometimes too sharp and can deteriorate results. In future work, we hope that ensemble models can help mitigate this issue. A first approach using random subspaces is already demonstrated in the gallery of neuroquery examples, and in an interactive demo, and seems to improve results for the case of &quot;autobiographical memory&quot;.</p><p>The queries that give maps that do not ressemble what we would expect from an experiment targeted to answer the corresponding question are often queries that combine a term that is well mapped in brain-imaging experiments with a term that is harder to capture, such as &quot;autobiographical memory of faces&quot;, as the published results are then dominated by &quot;faces&quot;.</p><disp-quote content-type="editor-comment"><p>D) Perhaps a brief discussion of other limitations would be helpful. We submit that some of the fundamental problems are those not easily solved – that we usually perform meta-analyses based on studies of the same nominal task type (e.g., N-back), and sometimes minor variations in task structure can yield divergent findings. We don't know what all the dimensions are yet. This problem goes far beyond the challenge of establishing a set of consensus labels for task types and relevant cognitive processes. In short, we don't really even know what task features to label yet in many cases, and they don't combine additively. A stop-signal task with one adaptive random walk may be different than one with four, as it allows a different type of cognitive strategy.</p></disp-quote><p>We have included a discussion of the issue mentioned by the reviewers in the Discussion, starting with &quot;Another fundamental challenge of meta-analyses in psychology is the decomposition of the tasks in mental processes […]&quot;</p><disp-quote content-type="editor-comment"><p>E) When to use it: For common terms, meta-analysis (e.g., Neurosynth) does very well (e.g., Figure 4). When would the authors recommend using NeuroQuery over another meta-analytic tool? Maybe they could provide a summary of use cases and conditions (e.g., when few studies of a term/topic are available). Also see point (C).</p></disp-quote><p>We have added recommendations on when NeuroQuery is beneficial around, starting with &quot;NeuroQuery will be most successfully used to produce hypotheses […]&quot;, and this paragraph finishes with a list of situations where using NeuroQuery is particularly indicated.</p><disp-quote content-type="editor-comment"><p>8) Discussion of other approaches: We submit that the field has become tracked into a relatively narrow space of the possible options and techniques for meta-analysis, based on local analysis of coordinates in MKDA/ALE. Alternatives could be mentioned as potential future directions. For example, early work explored clustering of spatial locations and spatial discriminant tests (e.g., Wager et al., 2002, 2004, 2005), and later work has explored spatial models (e.g., Kang, 2011, Kang, 2014, Wager, 2015) and more advanced co-activation models (Xue, 2014). While this is obviously beyond the scope of the present paper, future work might consider models of spatial co-activation when generating predictions and inferences about meta-analytic maps.</p></disp-quote><p>We now mention this line of work at the end of the paragraph on prior work, starting with &quot;other works have modelled co-activations and interactions between brain locations&quot;</p><p>One way to adapt the NeuroQuery model to better leverage the spatial structure of activations could be to use loadings on dictionary or ICA components as dependent variables rather than estimated density at each voxel.</p><disp-quote content-type="editor-comment"><p>9) The methods are a bit unclear:</p></disp-quote><p>We have made important changes to the organization and notations of the methods. Below we provide answers to the issues raised by the reviewers.</p><disp-quote content-type="editor-comment"><p>A) Significant details about methodologies are missing. How are term frequency and inverse document frequency computed?</p></disp-quote><p>We have added a section B.1 on the computation of TFIDF features.</p><p><italic>B) Equation 5: How is</italic> σ^<italic><sub>ij</sub> computed? Square root of the entries of equation 8?</italic></p><p>σ^2jk is now explicitly defined in Equation 9.</p><p><italic>C) Equation 5: What is the difference between</italic> σ^<italic><sub>i</sub> and</italic> σ^<italic><sub>ij</sub>?</italic> σ^<italic><sub>i</sub> is a column/row of</italic> σ^<italic><sub>ij</sub>?</italic></p><p>Indeed σ^<italic> <sub>j</sub></italic> is the vector containing the entries (σ^<sub><italic>j</italic></sub>,1,..., σ^<sub><italic>j</italic></sub>,<italic>p</italic>) as made explicit at the end of section B.2.1. We have also added a short section on notations</p><disp-quote content-type="editor-comment"><p>D) Y:,j is the j-th column not i-th column of Y?</p></disp-quote><p>Indeed this was a typo, which has now been corrected (below Equation 6.)</p><p><italic>E) M is a v x n matrix, so equation 8 is a v x v matrix? We are confused how this maps to</italic> σ^<italic><sub>ij</sub>.</italic></p><p>We have now defined σ^<sub><italic>ij</italic></sub> in Equation 9 using the sum notation, we hope that this definition is now clear.</p><disp-quote content-type="editor-comment"><p>F) In Equation 10, is ||U||_1 just the sum of absolute values of all entries in U?</p></disp-quote><p>This is what we intended. This choice of notation was bad as it is usually employed for the operator norm induced by the l1 vector norm. We replaced this notation with that of the 𝐿<sub>1,1</sub> norm ie ||.||<sub>1,1</sub></p><disp-quote content-type="editor-comment"><p>G) What is k set to be in equation 10?</p></disp-quote><p>k has now been renamed d to avoid confusion with the index k used to index voxels. It is set to 300, as is now specified in the paragraph after Equation 18: &quot;the hyperparameters d=300,.…&quot;</p><disp-quote content-type="editor-comment"><p>H) &quot;More than 72% of the time, NeuroQuery's output has a higher Pearson correlation with the correct map than with the negative example&quot; – &quot;correct map&quot; refers to the KDE density maps?</p></disp-quote><p>&quot;correct map&quot; refers here to an unsmoothed maps where peaks have been placed in the voxels that contain the reported peak coordinates. We have now clarified this in the text &quot;whether the predicted map is closer to the correct map (containing peaks at each reported location) or to the random negative example&quot;</p><disp-quote content-type="editor-comment"><p>10) Subsection “Smoothing: regularization at test time” is hard to read. It would be helpful if the authors explain the intuition behind the different steps and what the different matrices represent. For example, it might be helpful to explain that each row of V can be thought of as the association of words with topic k, so a higher value for row i, column j suggests the j-th dictionary word is more strongly related to the topic k. As another example, the authors should also unpack subsection “Smoothing: regularization at test time”: why do we take V and scale with 𝑛<sub>𝑖,𝑖</sub> and then compute C and then l1-normalizing the rows of C to produce T and then finally S. What does each step try to do? We guess roughly speaking VV^T is like a co-occurrence matrix (how likely are two words likely to appear together?), but we are not sure why we have to do the extra normalization with 𝑛<sub>𝑖,𝑖</sub>, l1-normalization, etc.</p></disp-quote><p>We have reworked this section in depth. More details on the interpretation of rows of 𝑉 are provided in the second paragraph after Equation 18, starting with &quot;The latent factors, or topics, are the rows of.…&quot;We provide some justification for scaling 𝑉 with 𝑛<sub>𝑖,𝑖</sub> in equations 19-21: as the reviewers suspected, V~TV~~ 𝑉 𝑇 ~ 𝑉 can be seen as a regularized (low-rank) co-occurrence matrix. Our motivation for the subsequent l1-normalization is stated after Equation 22: &quot;This normalization ensures that terms that have many neighbors are not given more importance in the smoothed representation&quot;. Overall we hope that this section is now clearer and provides better intuitions and justifications for the choices we made in the design of the NeuroQuery model.</p></body></sub-article></article>