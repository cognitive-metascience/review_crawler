<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">08208</article-id><article-id pub-id-type="doi">10.7554/eLife.08208</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Calibration and analysis of genome-based models for microbial ecology</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-27350"><name><surname>Louca</surname><given-names>Stilianos</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-5614"><name><surname>Doebeli</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Institute of Applied Mathematics</institution>, <institution>University of British Columbia</institution>, <addr-line><named-content content-type="city">Vancouver</named-content></addr-line>, <country>Canada</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Zoology</institution>, <institution>University of British Columbia</institution>, <addr-line><named-content content-type="city">Vancouver</named-content></addr-line>, <country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-2203"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing editor</role><aff><institution>Fred Hutchinson Cancer Research Center,</institution> <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>stilianos.louca@gmail.com</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>16</day><month>10</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e08208</elocation-id><history><date date-type="received"><day>18</day><month>04</month><year>2015</year></date><date date-type="accepted"><day>17</day><month>09</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Louca and Doebeli</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Louca and Doebeli</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-08208-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.08208.001</object-id><p>Microbial ecosystem modeling is complicated by the large number of unknown parameters and the lack of appropriate calibration tools. Here we present a novel computational framework for modeling microbial ecosystems, which combines genome-based model construction with statistical analysis and calibration to experimental data. Using this framework, we examined the dynamics of a community of <italic>Escherichia coli</italic> strains that emerged in laboratory evolution experiments, during which an ancestral strain diversified into two coexisting ecotypes. We constructed a microbial community model comprising the ancestral and the evolved strains, which we calibrated using separate monoculture experiments. Simulations reproduced the successional dynamics in the evolution experiments, and pathway activation patterns observed in microarray transcript profiles. Our approach yielded detailed insights into the metabolic processes that drove bacterial diversification, involving acetate cross-feeding and competition for organic carbon and oxygen. Our framework provides a missing link towards a data-driven mechanistic microbial ecology.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.001">http://dx.doi.org/10.7554/eLife.08208.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.08208.002</object-id><title>eLife digest</title><p>Microbes like bacteria and yeast play important roles in the environment, human health and even some industrial processes. However, it is difficult to understand the roles of microbes in these situations because many different types of microbes often live together in complex communities. Some of the microbes may compete with each other for resources like oxygen or sugar. Others may rely on one another for survival. For example, one microbe may feed on molecules that are released as waste from another microbe.</p><p>To better understand these microbial communities, we first need to understand the processes by which each microbe uses nutrients and releases waste molecules that influence other microbes. Researchers have used a technique called ‘genome sequencing’ to reconstruct the networks of genes and chemical reactions that are involved in these processes, and to build computer models of microbial communities in different environments.</p><p>However, the existing models can be labor intensive and do not allow researchers to easily use statistics to analyse them. To address this problem, Louca and Doebeli created a new computer model with built-in statistical tools that accurately predicts the interactions in communities that contain multiple strains of a bacterium called <italic>Escherichia coli.</italic> First, Louca and Doebeli grew a single strain of <italic>E. coli</italic> in the laboratory for many generations, which led to the evolution of the bacteria so that two new strains emerged. One of the new strains was more efficient at using sugar as a food source than the other and sometimes released a molecule called acetate. The other new strain became more efficient at using this acetate.</p><p>Next, Louca and Doebeli used data that had been collected for each individual strain, to test whether the model could recreate the way that the new strains had evolved together. The model accurately predicted that the two new strains would gradually replace the original strain. The strain that was more efficient at using sugar emerged first, which led to extra acetate being available for the other new strain that became more efficient at using acetate.</p><p>Louca and Doebeli's findings demonstrate for the first time that data collected for individual microbes can be used to explain the dynamics and evolution of small communities of microbes using mathematical models. The next step is to test this approach on larger communities in the environment.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.002">http://dx.doi.org/10.7554/eLife.08208.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>experimental evolution</kwd><kwd>microbial metabolism</kwd><kwd>flux balance analysis</kwd><kwd>model calibration</kwd><kwd>diversity</kwd><kwd>microbial ecology</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada (NSERC)</institution></institution-wrap></funding-source><award-id>Discovery Grant, 21990</award-id><principal-award-recipient><name><surname>Doebeli</surname><given-names>Michael</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009059</institution-id><institution>Pacific Institute for Mathematical Sciences (PIMS)</institution></institution-wrap></funding-source><award-id>International Graduate Training Centre (IGTC) in Mathematical Biology</award-id><principal-award-recipient><name><surname>Louca</surname><given-names>Stilianos</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005247</institution-id><institution>University of British Columbia (UBC)</institution></institution-wrap></funding-source><award-id>Graduate Student Fellowship</award-id><principal-award-recipient><name><surname>Louca</surname><given-names>Stilianos</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel computation tool for microbial community modeling predicts the evolution and diversification of <italic>E. coli</italic> in laboratory evolution experiments and gives insight into the underlying metabolic processes.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Metabolic interactions are an emergent property of microbial communities (<xref ref-type="bibr" rid="bib44">Morris et al., 2013</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>). Even the simplest life forms can only be understood in terms of biological consortia characterized by shared metabolic pathways and distributed biosynthetic capacities (<xref ref-type="bibr" rid="bib34">Klitgord and Segrè, 2010</xref>; <xref ref-type="bibr" rid="bib40">McCutcheon and Moran, 2012</xref>; <xref ref-type="bibr" rid="bib30">Husnik et al., 2013</xref>). For example, glucose catabolism to carbon dioxide or methane is a multi-step process often involving several organisms that indirectly exchange intermediate products through their environment (<xref ref-type="bibr" rid="bib55">Stams, 1994</xref>). Microbial communities are thus complex systems comprising several interacting components that cannot be fully understood in isolation. In fact, metabolic interdependencies between organisms are at least partially responsible for our current inability to culture the great majority of prokaryotes (<xref ref-type="bibr" rid="bib50">Schink and Stams, 2006</xref>). Understanding the emergent dynamics of microbial communities is crucial to harnessing these multicomponent assemblages and using synthetic ecology for medical, environmental and industrial purposes (<xref ref-type="bibr" rid="bib4">Brenner et al., 2008</xref>).</p><p>Genome sequencing has enabled the reconstruction of full-scale cell-metabolic networks (<xref ref-type="bibr" rid="bib26">Henry et al., 2010</xref>), which have provided a firm basis for understanding individual cell metabolism (<xref ref-type="bibr" rid="bib61">Varma and Palsson, 1994</xref>; <xref ref-type="bibr" rid="bib12">Duarte et al., 2004</xref>; <xref ref-type="bibr" rid="bib34">Klitgord and Segrè, 2010</xref>). Recent work indicates that multiple cell models can be combined to understand microbial community metabolism and population dynamics (<xref ref-type="bibr" rid="bib57">Stolyar et al., 2007</xref>; <xref ref-type="bibr" rid="bib34">Klitgord and Segrè, 2010</xref>; <xref ref-type="bibr" rid="bib64">Zengler and Palsson, 2012</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). These approaches assume knowledge of all model parameters such as stoichiometric coefficients, maintenance energy requirements or extracellular transport kinetics, a requirement that is rarely met in practice (<xref ref-type="bibr" rid="bib17">Feist et al., 2008</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). Experiments and monitoring of environmental samples could provide valuable data to calibrate microbial community models, for example, via statistical parameter estimation, but appropriate tools are lacking. So far, the standard approach has been to obtain each parameter through laborious specific measurements or from the available literature, or to manually adjust parameters to match observations (<xref ref-type="bibr" rid="bib39">Mahadevan et al., 2002</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). Furthermore, statistical model evaluation and sensitivity analysis is typically performed using ad hoc code, thus increasing the effort required for the construction of any new model. Consequently, the experimental validation of genome-based microbial community models and their application to biological questions are rare (<xref ref-type="bibr" rid="bib41">Meadows et al., 2010</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>).</p><p>We have developed MCM (Microbial Community Modeler), a mathematical framework and computational tool that unifies model construction with statistical evaluation, sensitivity analysis and parameter calibration. MCM is designed for modeling multi-species microbial communities, in which the metabolism and growth of individual cell species is predicted using genome-based metabolic models. Cells in the community interact in a dynamical environment in which metabolite concentrations and other environmental variables influence, and are influenced by, microbial metabolism. Unknown model parameters can be automatically calibrated (fitted) using experimental data such as cell densities, nutrient concentrations or rate measurements. To demonstrate the potential of MCM, we modeled a bacterial community that has emerged from in vitro evolution experiments, during which an ancestral strain repeatedly diversified into two distinct ecotypes. Experiments with microbes have an established tradition as model systems for understanding ecological and evolutionary processes (<xref ref-type="bibr" rid="bib13">Elena and Lenski, 2003</xref>; <xref ref-type="bibr" rid="bib33">Kassen and Rainey, 2004</xref>). We show that the predictions derived from MCM are in very good agreement with the outcomes of several monoculture and coculture experiments. While the experimental results described below have been found over the course of several years (<xref ref-type="bibr" rid="bib20">Friesen et al., 2004</xref>; <xref ref-type="bibr" rid="bib53">Spencer et al., 2007</xref>; <xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>; <xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>), it is only now that a mechanistic model has managed to unify them in a clear, unambiguous and synergistic manner. The analysis presented here thus provides strong credence to a large body of experimental work that was done in our lab over the course of roughly a decade.</p><sec id="s1-1"><title>Model</title><p>In MCM, a microbial community model is a set of differential equations for the population densities of the cell species comprising the community and of the ambient concentrations of utilized nutrients (metabolites), coupled to optimization problems for the cell-specific rates of reactions involving these metabolites. Each cell is characterized by its metabolic potential, that is, the genetically determined subset of reactions it can catalyze, as well as any available metabolite transport mechanisms. The reaction rates and metabolite exchange rates (i.e. the metabolism) of each cell are assumed to depend on its metabolic potential as well as on the current environmental conditions, such as metabolite concentrations. Through their metabolism, in turn, cells act as sinks and sources of metabolites in the environment. Additional metabolite fluxes, such as oxygen diffusion from the atmosphere into the growth medium of a modeled bacterial culture, can be included in the model.</p><p>At any point in time, individual cell metabolism is determined using flux balance analysis (FBA) (<xref ref-type="bibr" rid="bib45">Orth et al., 2010</xref>), a widely used framework in cell-metabolic modeling (<xref ref-type="bibr" rid="bib61">Varma and Palsson, 1994</xref>; <xref ref-type="bibr" rid="bib12">Duarte et al., 2004</xref>; <xref ref-type="bibr" rid="bib34">Klitgord and Segrè, 2010</xref>; <xref ref-type="bibr" rid="bib19">Freilich et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>). In FBA, cell metabolism is assumed to be regulated in such a way that the rate of biosynthesis is maximized (<xref ref-type="bibr" rid="bib61">Varma and Palsson, 1994</xref>; <xref ref-type="bibr" rid="bib18">Feist and Palsson, 2010</xref>). The chemical state of cells is assumed to be steady, leading to stoichiometric constraints that need to be satisfied for any particular combination of intracellular reaction rates. Reaction rates, on the other hand, are limited due to finite enzyme capacities. Metabolite uptake/export rates can also be limited due to finite diffusion rates or limited transmembrane transporter efficiency. For example, uptake rates can be Monod-like functions of substrate concentrations (<xref ref-type="bibr" rid="bib39">Mahadevan et al., 2002</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). Taken together, cell-metabolic potential, stoichiometric consistency, reaction rate limits and transport rate limits define the constraints of a linear optimization problem for each cell species at each point in time. The optimized biosynthesis rate is translated into a cell production rate by dividing by the cell's mass, thus defining the species' population growth (<xref ref-type="fig" rid="fig1">Figure 1</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.08208.003</object-id><label>Figure 1.</label><caption><title>Framework used by MCM.</title><p>(<bold>A</bold>) Conceptual framework used by MCM. Cells (colored shapes) optimize their metabolism for maximal growth and influence their environment via metabolite exchange (small colored arrows). Additional external fluxes can also affect the environment (large grey arrows). The environment, in turn, influences each cell's metabolism. (<bold>B</bold>) Computational framework used by MCM. Each iteration consists of four steps: flux balance analysis (FBA) is used to translate cell-metabolic potentials and environmental conditions (1) into a linear optimization problem for the growth rate of each cell species (2). The set of possible reaction rates corresponds to a polytope in high-dimensional space. Solving the optimization problems (3) yields predictions on microbial metabolite exchange rates (4). Metabolic fluxes and cell growth rates are used to predict metabolite and cell concentrations in the next iteration (1).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.003">http://dx.doi.org/10.7554/eLife.08208.003</ext-link></p></caption><graphic xlink:href="elife-08208-fig1-v1.tif"/></fig></p><p>The central assumption of individual cells maximizing biosynthesis, subject to environmental and physiological constraints, is rooted in the idea that evolution has shaped regulatory mechanisms of unicellular organisms in such a way that they strive for maximum growth whenever possible. Biosynthesis has been experimentally verified as an objective for <italic>Saccharomyces cerevisiae</italic> and <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib5">Burgard and Maranas, 2003</xref>; <xref ref-type="bibr" rid="bib21">Gianchandani et al., 2008</xref>; <xref ref-type="bibr" rid="bib24">Harcombe et al., 2013</xref>). The assumption of maximized biosynthesis is less valid for genetically engineered organisms or those exposed to environments that are radically different from the environments that shaped their evolution (<xref ref-type="bibr" rid="bib51">Segrè et al., 2002</xref>). Despite its limitations, FBA has greatly contributed to the understanding of several genome-scale metabolic networks and metabolic interactions between cells (<xref ref-type="bibr" rid="bib57">Stolyar et al., 2007</xref>; <xref ref-type="bibr" rid="bib34">Klitgord and Segrè, 2010</xref>; <xref ref-type="bibr" rid="bib45">Orth et al., 2010</xref>; <xref ref-type="bibr" rid="bib19">Freilich et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). One advantage of FBA models over full biochemical cell models is their independence of intracellular kinetics and gene regulation, which limits the number of required parameters to stoichiometric coefficients and uptake kinetics.</p><p>The combination of FBA with a varying environmental metabolite pool, as implemented by MCM, is known as dynamic flux balance analysis (DFBA) (<xref ref-type="bibr" rid="bib39">Mahadevan et al., 2002</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). In contrast to conventional FBA, DFBA models are dynamical because cell densities and environmental metabolite concentrations both change with time, and the rate of change of each cell density and metabolite concentration depends on the current cell densities and metabolite concentrations (<xref ref-type="bibr" rid="bib39">Mahadevan et al., 2002</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). Because metabolites can be depleted or produced by several cell species, the environmental metabolite pool mediates the metabolic interactions between cells (<xref ref-type="bibr" rid="bib50">Schink and Stams, 2006</xref>). For example, oxygen uptake rates might depend on environmental oxygen concentrations, which in turn are reduced by cellular respiration. Similarly, cells might excrete acetate as a byproduct of glucose catabolism, which then becomes available to other cells. The metabolic optimization of individual cells striving for maximal growth, while modifying their environment, leads to non-trivial community dynamics that can include competition, cooperation and exploitation. The cell-centric nature of DFBA differs fundamentally from other flux balance analyses of microbial communities that assume an optimization of a community-wide objective such as total biomass synthesis (<xref ref-type="bibr" rid="bib57">Stolyar et al., 2007</xref>; <xref ref-type="bibr" rid="bib35">Klitgord and Segrè, 2011</xref>; <xref ref-type="bibr" rid="bib65">Zomorrodi and Maranas, 2012</xref>). Such an assumption is at least questionable from an evolutionary perspective and likely not appropriate for communities comprising several species (<xref ref-type="bibr" rid="bib43">Mitri and Foster, 2013</xref>).</p><p>Recent work suggests that DFBA is a promising approach to microbial ecological modeling (<xref ref-type="bibr" rid="bib41">Meadows et al., 2010</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). For example, <xref ref-type="bibr" rid="bib25">Harcombe et al. (2014)</xref> designed a computational tool (COMETS) based on DFBA, which was able to accurately predict equilibrium compositions of mixed bacterial cultures grown on petri dishes. However, COMETS offers limited model versatility in terms of uptake and reaction kinetics and only has few environmental feedback mechanisms (namely, varying extracellular metabolite concentrations). Furthermore, it assumes complete knowledge of all required model parameters and provides no generic statistical model analysis. Hence, while COMETS sets an important precedent, considerable work is still needed to make DFBA a practical approach in microbial ecosystem modeling. MCM extends Harcombe et al.'s framework to more versatile microbial ecological models that include arbitrary reaction kinetics (e.g., subject to product-inhibition) as well as dynamical environmental variables (e.g., pH) that influence, and are influenced by, microbial metabolism. In addition, MCM supports cell models in which internal molecules act as dynamical constraints that further restrict the FBA solution space, for example to account for post-transcriptional regulation or delays in enzyme synthesis (<xref ref-type="bibr" rid="bib3">Blazier and Papin, 2012</xref>). These so called regulatory FBA models have been shown to improve the fidelity of conventional FBA models for <italic>E. coli</italic> and <italic>S. cerevisiae</italic> (<xref ref-type="bibr" rid="bib10">Covert et al., 2001</xref>; <xref ref-type="bibr" rid="bib9">Covert and Palsson, 2002</xref>; <xref ref-type="bibr" rid="bib8">Covert et al., 2004</xref>; <xref ref-type="bibr" rid="bib27">Herrgård et al., 2006</xref>), however their application to microbial communities remains untested. MCM can statistically evaluate models against data, analyze their sensitivity to varying parameters (<xref ref-type="bibr" rid="bib6">Cariboni et al., 2007</xref>), and estimate the uncertainty of model predictions in the face of stochasticity (<xref ref-type="bibr" rid="bib23">Hammersley and Handscomb, 1964</xref>). Perhaps most importantly, MCM can automatically calibrate unknown model parameters to data, for example obtained from monoculture experiments (as demonstrated below), from bioreactor experiments involving multiple species (<xref ref-type="bibr" rid="bib38">Louca and Doebeli, 2015</xref>) or from environmental samples of unculturable communities (<xref ref-type="fig" rid="fig2">Figure 2</xref>; see the ‘Materials and methods’ and the Supplement for details). MCM can thus be used to understand the dynamics of realistic microbial ecosystems, ranging from the soil or groundwater to mixed laboratory cultures and bioreactors.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.08208.004</object-id><label>Figure 2.</label><caption><title>Overview of MCM's working principle and functionalities: A microbial community model is specified using human-readable configuration files in terms of metabolites, reactions, the metabolic potential of cell species and any additional environmental variables.</title><p>Models with multiple ecosystem compartments are also possible. A script with MCM commands controls the analysis of the model and, if needed, its calibration using experimental data. The calibrated model can also be used to create new, more complex models (as exemplified in this article).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.004">http://dx.doi.org/10.7554/eLife.08208.004</ext-link></p></caption><graphic xlink:href="elife-08208-fig2-v1.tif"/></fig></p></sec></sec><sec id="s2" sec-type="results|discussion"><title>Results and discussion</title><sec id="s2-1"><title>Successional dynamics of a microbial community</title><p>In a series of laboratory evolution experiments with <italic>E. coli</italic> (strain B REL606; <xref ref-type="bibr" rid="bib63">Yoon et al., 2012</xref>) in glucose-acetate supplemented medium, two metabolically distinct strains consistently evolved from the ancestral (A) strain (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>; <xref ref-type="bibr" rid="bib54">Spencer et al., 2008</xref>; <xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>). When grown in monoculture with the same medium composition, all three strains exhibit diauxic growth curves with a fast glucose-driven growth phase followed by slower growth on acetate. However, the three strains differ in their efficiencies to catabolize glucose and acetate: Strain SS (slow switcher) is a better glucose utilizer when compared to strain A, and the depletion of glucose only leads to a slow switch to acetate consumption. On the other hand, the FS (fast switcher) strain has evolved to be a better acetate utilizer, initiating acetate consumption at higher remnant glucose concentrations than strains A and SS. This acetate specialization is based on a tradeoff in the citric acid cycle and comes at the cost of being a less competitive glucose consumer.</p><p>Replicated serial dilution experiments starting with strain A monocultures have shown a consistent phenotypic diversification, involving an initial invasion of the SS phenotype and a subsequent invasion of the FS phenotype, leading to the eventual extinction or near-extinction of the ancestor and the stable coexistence of the SS and FS phenotypes (<xref ref-type="fig" rid="fig3">Figure 3</xref>) (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>; <xref ref-type="bibr" rid="bib54">Spencer et al., 2008</xref>; <xref ref-type="bibr" rid="bib60">Tyerman et al., 2008</xref>; <xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>). Genome sequencing revealed that this metabolic diversification can be attributed to point-mutations in genes linked to glucose and acetate uptake kinetics and metabolism (<xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>). The successional dynamics of the three phenotypes are thus likely driven by adaptations to a changing metabolic niche space, defined by fluctuating glucose, acetate and, potentially, oxygen availabilities (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>; <xref ref-type="bibr" rid="bib60">Tyerman et al., 2008</xref>; <xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>). An understanding of the underlying ecological processes would shed light on the ecology and evolution of natural microbial communities with shared catabolic pathways.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.08208.005</object-id><label>Figure 3.</label><caption><title>Estimated relative cell densities of the A, SS and FS types during three replicated evolution experiments by Herron and Doebeli (2013, <xref ref-type="fig" rid="fig2">Figure 2</xref>), starting with the same ancestral <italic>E. coli</italic> strain.</title><p>Within each of the three experiments (<bold>A</bold>–<bold>C</bold>), the illustrated SS or FS lineage comprises several strains with varyingly pronounced SS or FS phenotypes, respectively. Cell generations were translated to days by assuming an average of 6.7 generations per day (<xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.005">http://dx.doi.org/10.7554/eLife.08208.005</ext-link></p></caption><graphic xlink:href="elife-08208-fig3-v1.tif"/></fig></p><p>To mechanistically explain the observed community dynamics, we used MCM to construct a model comprising the ancestral and the two evolved <italic>E. coli</italic> types. By keeping track of pathway activation, cell densities, metabolic fluxes and nutrient concentrations, we gained detailed insight into the processes driving the successional dynamics of metabolic diversification.</p></sec><sec id="s2-2"><title>Experimental calibration</title><p>Based on a published cell-metabolic template for the ancestral <italic>E. coli</italic> strain comprising over 2000 reactions (<xref ref-type="bibr" rid="bib63">Yoon et al., 2012</xref>), we first constructed three separate cell models for the phenotypes A, SS and FS, respectively. In these preliminary models, cells grew on a substrate pool that resembled previous batch-fed monoculture experiments with glucose-acetate supplemented minimal medium (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>). Cell-specific oxygen, acetate and glucose uptake rate limits were Monod-like functions of substrate concentrations (<xref ref-type="bibr" rid="bib15">Emerson and Hedges, 2008</xref>; <xref ref-type="bibr" rid="bib42">Millero, 2013</xref>). We calibrated several physiological parameters for each cell type to measured chemical concentration and cell density profiles, using least squares fitting (<xref ref-type="fig" rid="fig4">Figure 4</xref>). MCM automatically calibrates free parameters to data through an optimization algorithm that involves step-wise exploration of parameter space and repeated simulations (see ‘Materials and methods’ and Supplementary Material).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.08208.006</object-id><label>Figure 4.</label><caption><title>Calibration of <italic>E. coli</italic> cell models.</title><p>Continuous curves: Time course of cell densities, glucose concentration, acetate concentration and oxygen concentration (columns 1–4, respectively) predicted by MCM for monocultures of strain A, SS and FS (rows 1–3, respectively) grown on glucose-acetate medium. Points are data used for model calibration, and were obtained from analogous monoculture growth experiments (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>). Oxygen data were not available for strain A.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.006">http://dx.doi.org/10.7554/eLife.08208.006</ext-link></p></caption><graphic xlink:href="elife-08208-fig4-v1.tif"/></fig></p><p>We then constructed the microbial community (MC) model by combining the three calibrated cell models into a community growing in a common substrate pool. The environmental context resembles Herron &amp; Doebeli's evolution experiments (<xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>). In particular, the model includes realistic oxygen depletion-repletion dynamics (<xref ref-type="bibr" rid="bib22">Gupta and Rao, 2003</xref>), glucose and acetate depletion by microbial consumption, as well as daily dilutions into fresh glucose-acetate supplemented medium at a factor 1:100. The microbial community initially consists mostly of type A (10<sup>10</sup> cells/l), while both SS as well as FS cells are assumed to be rare (1 cell/l). Because the model is deterministic, the invasion or extinction of each type only depends on its growth rate in a possibly changing environment, but not on random mutation events, nor on demographic stochastic fluctuations.</p></sec><sec id="s2-3"><title>Predicting microbial community dynamics</title><p>Simulations of the MC model reproduced the successional dynamics observed in Herron &amp; Doebeli's experiments: An initial replacement of the ancestor by the SS type is followed by an invasion of the FS type, leading to the eventual coexistence of the SS and FS types and extinction of the ancestral strain (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Interestingly, FS can also invade in the absence of SS, however invasion occurs much slower and FS reaches lower densities than in the presence of SS (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). This is consistent with an early presence of the FS lineage at low densities in the evolution experiments (<xref ref-type="fig" rid="fig3">Figure 3</xref>), indicating that some of the first FS mutations already confer a slight advantage over the ancestor when FS is rare (<xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>).<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.08208.007</object-id><label>Figure 5.</label><caption><title>Dynamics of the <italic>E</italic><italic>. coli</italic> microbial community model.</title><p>(<bold>A</bold>) Relative cell densities of the A, SS and FS types over time. (<bold>B</bold>) Acetate concentration over time. (<bold>C</bold>), (<bold>D</bold>) and (<bold>E</bold>): SS and FS cell densities, relative cell densities and growth rates over time, respectively, during stable coexistence. (<bold>F</bold>), (<bold>G</bold>) and (<bold>H</bold>): Cell-specific glucose, acetate and oxygen uptake rates over time, respectively. Negative values correspond to export. (<bold>I</bold>), (<bold>J</bold>) and (<bold>K</bold>): Glucose, acetate and oxygen concentrations over time, respectively. Diurnal fluctuations in all figures are due to daily dilutions into fresh medium. Tics on the time axes in (<bold>C</bold>–<bold>K</bold>) mark points of dilution.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.007">http://dx.doi.org/10.7554/eLife.08208.007</ext-link></p></caption><graphic xlink:href="elife-08208-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.08208.008</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Predicted relative cell densities of the A and FS types in coculture, in the absence of SS.</title><p>Initial cell densities were 10<sup>10</sup> cells/L for type A and 1 cell/L for type FS. All other model parameters are identical to the microbial community model (comprising the A, SS and FS types) described in the main article.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.008">http://dx.doi.org/10.7554/eLife.08208.008</ext-link></p></caption><graphic xlink:href="elife-08208-fig5-figsupp1-v1.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.08208.009</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Robustness of the predicted stable coexistence of the SS and FS types in coculture.</title><p>Shown are the probability distributions of the relative SS (<bold>A</bold>) and FS (<bold>B</bold>) cell densities over time, when calibrated model parameters (Table 3) are randomly chosen within an interval spanning 10% above and 10% below their fitted values. Initial cell densities were 10<sup>10</sup> cells/L for both types, all other parameters were as described in the main article. Probability distributions were estimated using 50 Monte Carlo simulations. In all cases both the SS and FS type persisted. The analysis was performed using the MCM command <italic>UAMCM</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.009">http://dx.doi.org/10.7554/eLife.08208.009</ext-link></p></caption><graphic xlink:href="elife-08208-fig5-figsupp2-v1.tif"/></fig></fig-group></p><p>Time series of acetate concentrations (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) link the observed successional dynamics of the three types to a gradually changing metabolic niche space: The replacement of type A by the more efficient glucose specialist SS leads to an accumulation of acetate and facilitates the invasion of the FS type. The specialization of the SS and FS types on glucose and acetate, respectively (<xref ref-type="fig" rid="fig6">Figure 6A</xref>), enables their long-term coexistence on glucose-acetate enriched medium through frequency dependent competition (<xref ref-type="bibr" rid="bib20">Friesen et al., 2004</xref>; <xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>; <xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>). In fact, cell-specific acetate exchange rates reveal that the SS type temporarily excretes acetate during short intervals, which is concurrently and subsequently consumed by the FS type (<xref ref-type="fig" rid="fig5">Figure 5G</xref>). This periodic acetate cross-feeding is an evolutionarily emergent property of the microbial community (<xref ref-type="bibr" rid="bib59">Treves et al., 1998</xref>). The temporary production of acetate by the SS type is consistent with previous SS-FS coculture experiments, which revealed slightly increased acetate concentrations towards the end of the SS exponential growth phase (<xref ref-type="bibr" rid="bib53">Spencer et al., 2007</xref>). An evolved increase of acetate excretion by <italic>E. coli</italic> in glucose minimal medium has also been reported by <xref ref-type="bibr" rid="bib24">Harcombe et al. (2013)</xref>.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.08208.010</object-id><label>Figure 6.</label><caption><title>Metabolic differentiation of the A, SS and FS types.</title><p>(<bold>A</bold>) Predicted cell-specific net metabolite uptake rates in coculture. (<bold>B</bold>) Predicted cell-specific reaction rates in coculture, for <italic>acs</italic> (acetyl-CoA synthesis), <italic>ack</italic> (acetate synthesis), <italic>pta</italic> (acetyl phosphate synthesis), <italic>ppc</italic> (oxaloacetate synthesis from phosphoenolpyruvate), <italic>pdh</italic> (decarboxylation of pyruvate to acetyl-CoA) and <italic>pyk</italic> (pyruvate synthesis from phosphoenolpyruvate). Rates in (<bold>A</bold>) and (<bold>B</bold>) are averaged over all time points within the first 100 days of evolution, with reversed reactions or net metabolite export represented by negative rates. (<bold>C</bold>) and (<bold>D</bold>): Simplified model subset of <italic>E. coli</italic> acetate and glucose metabolism, showing pathway activations in type SS (<bold>C</bold>) and FS (<bold>D</bold>) relative to type A during exponential growth in monoculture. Non-bracketed numeric values are ratios of predicted fluxes in the evolved types over fluxes in type A. Bracketed values are ratios of mRNA harvested from monoculture experiments by <xref ref-type="bibr" rid="bib37">Le Gac et al. (2008)</xref>, for comparison. A ratio of 0/0 indicates zero flux in both the evolved and ancestral type, a ratio of 1 corresponds to an unchanged flux or mRNA, a ratio of 0 corresponds to complete deactivation in the evolved type. Darker arrows indicate increased predicted fluxes in the evolved type. Flux predictions correspond to the time points of mRNA measurements, that is, 3.5 hr after dilution for SS and 4 hr after dilution for A and SS (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.010">http://dx.doi.org/10.7554/eLife.08208.010</ext-link></p></caption><graphic xlink:href="elife-08208-fig6-v1.tif"/></fig></p><p>It should be noted that cell metabolism depends on substrate concentrations and is subject to strong temporal variation. In particular, acetate excretion by SS cells correlates strongly with oxygen limitation (<xref ref-type="fig" rid="fig5">Figure 5G,K</xref>). The excretion of acetate by <italic>E. coli</italic> as a byproduct of oxygen-limited glucose catabolism has been observed experimentally and explained using flux balance analysis (<xref ref-type="bibr" rid="bib39">Mahadevan et al., 2002</xref>). In the absence of oxygen limitation, complete aerobic glucose catabolism to carbon dioxide is preferred over incomplete glucose catabolism with acetate excretion. On the other hand, oxygen limitation leads to an energetic tradeoff between complete glucose catabolism and efficient oxygen utilization, resulting in the excretion of acetate.</p><p>Furthermore, the depletion of oxygen during cell growth makes oxygen a temporary limiting resource for all cells (<xref ref-type="fig" rid="fig5">Figure 5K</xref>). Shortly after dilution into fresh medium, the exponential growth of the SS type on glucose leads to a rapid drop of oxygen to nanomolar concentrations. Despite oxygen diffusion into the medium, oxygen remains at sub-saturation levels for several more hours because the slow-growing acetate-consuming FS cells still consume oxygen after the growth of SS cells has halted. Differences in SS and FS growth rates (<xref ref-type="fig" rid="fig5">Figure 5C,E</xref>) thus mitigate competition for oxygen through temporal niche separation. Hence, oxygen likely plays an important role in the metabolic diversification, as previously hypothesized by <xref ref-type="bibr" rid="bib37">Le Gac et al. (2008)</xref>. This shows that the splitting of metabolic pathways across specialists can be caused by the composite effects of competition for electron donors and electron acceptors.</p><p>Consistent with differential substrate usage, average cell-specific reaction rates (<xref ref-type="fig" rid="fig6">Figure 6B</xref>) reveal differences in pathway activation: The transformation of acetate into acetyl-CoA by acetyl-CoA synthetase (<italic>acs</italic>) is decreased in type SS and increased in type FS, when compared to the ancestral type. Furthermore, the conversion of phosphoenolpyruvate to oxaloacetate (<italic>ppc</italic>), the conversion of phosphoenolpyruvate to pyruvate (<italic>pyk</italic>) and the decarboxylation of pyruvate to acetyl-CoA (<italic>pdh</italic>), linking the glycolysis pathway to the citric acid cycle, are all upregulated in the SS type when compared to the FS type. Similar differences in pathway activation also exist during early exponential growth in monoculture (<xref ref-type="fig" rid="fig6">Figure 6C,D</xref>), because FS grows partly on acetate and SS excretes acetate (<xref ref-type="fig" rid="fig4">Figure 4F,J</xref>). Previous microarray profiles of mRNA concentrations during exponential growth in monocultures (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>) found an upregulation of acetate consumption genes in FS and acetate excretion genes in SS compared to A, qualitatively confirming our predictions (<xref ref-type="fig" rid="fig6">Figure 6C,D</xref>). Interestingly, our simulations suggest a significant downregulation of glucose catabolism (<italic>pyk</italic>, <italic>pdh</italic> and <italic>ppc</italic>) in FS compared to A, which contradicts the transcript profiles (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). However, mRNA was harvested from well-aerated flasks, while the monoculture experiments (<xref ref-type="fig" rid="fig4">Figure 4</xref>) and evolution experiments (<xref ref-type="fig" rid="fig3">Figure 3</xref>) were performed in test tubes where oxygen can become limiting (<xref ref-type="bibr" rid="bib1">Andersen and von Meyenburg, 1980</xref>). Oxygen becomes particularly scarce in the FS tubes (<xref ref-type="fig" rid="fig4">Figure 4K</xref>) and temporarily limits glucose catabolism, which would explain the strong downregulation not reflected in the transcript profiles (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>). Furthermore, while broad pathway activation patterns could be qualitatively reproduced in our system, this might be harder in other cases due to post-transcriptional regulation or post-translational modifications (<xref ref-type="bibr" rid="bib3">Blazier and Papin, 2012</xref>).</p><p>The periodic (seasonal) changes in glucose and acetate concentrations in batch culture have previously been shown to promote coexistence of the SS and FS types, in analogy to the maintenance of phytoplankton diversity via fluctuations of resource availability (<xref ref-type="bibr" rid="bib52">Sommer, 1984</xref>; <xref ref-type="bibr" rid="bib53">Spencer et al., 2007</xref>). Experiments with SS-FS batch cocultures revealed that the SS type quickly dominates over the FS type, when restricted to the first glucose-rich season through frequent dilution into fresh growth medium. Reciprocally, when SS and FS are grown in solution resembling the second glucose-depleted acetate-rich season, the FS type quickly dominates over the SS type (<xref ref-type="bibr" rid="bib53">Spencer et al., 2007</xref>). Accordingly, in a full batch cycle the relative SS cell density has been shown to culminate within 4–8 hr and to gradually decrease afterwards (<xref ref-type="bibr" rid="bib20">Friesen et al., 2004</xref>, <xref ref-type="fig" rid="fig6">Figure 6B</xref>), in consistence with our simulations (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). Simulations of the SS and FS batch coculture restricted to the first or second season, analogous to Spencer et al.'s experiments, reproduce these observations and verify the role of periodic variation of glucose and acetate concentrations in maintaining the coexistence of both types (<xref ref-type="fig" rid="fig7">Figure 7</xref>, see the ‘Materials and methods’ for details).<fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.08208.011</object-id><label>Figure 7.</label><caption><title>Predicted relative cell densities of the SS and FS types in batch coculture when restricted to either the first glucose-rich (<bold>A</bold>) or second glucose-depleted (<bold>B</bold>) season.</title><p>In (<bold>A</bold>), restriction to the first season was achieved by shorter dilution periods which prevented the complete depletion of glucose. In (<bold>B</bold>), restriction to the second season was achieved by using the glucose-depleted acetate-rich solution, produced by the full-batch coculture, as growth medium (see the Methods for details). See <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> for results from analogous experiments by <xref ref-type="bibr" rid="bib53">Spencer et al. (2007)</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.011">http://dx.doi.org/10.7554/eLife.08208.011</ext-link></p></caption><graphic xlink:href="elife-08208-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.08208.012</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Measured relative cell densities of the SS and FS types in batch coculture, when restricted to either the first glucose-rich (left column) or second glucose-depleted (right column) season for three independently evolved communities (rows 1–3), as reported by Spencer <italic>et al.</italic> (2007, Figures 2A,B therein).</title><p>Restriction to the first season was achieved by shorter dilution periods which prevented the complete depletion of glucose. Restriction to the second season was achieved by using the glucose-depleted acetate-rich solution, produced by the full-batch coculture, as growth medium. Initial population sizes differed between experiments. Strains used by <xref ref-type="bibr" rid="bib53">Spencer et al. (2007)</xref> evolved in slightly different growth medium than in this article. Cell generations were translated to days by assuming an average of 6.7 generations per day (<xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.012">http://dx.doi.org/10.7554/eLife.08208.012</ext-link></p></caption><graphic xlink:href="elife-08208-fig7-figsupp1-v1.tif"/></fig></fig-group></p></sec><sec id="s2-4"><title>Conclusions</title><p>The models presented here make detailed predictions about the microbial dynamics in the considered experiments. First, after calibration the cell models largely explain the data from the monoculture experiments (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Second, the predictions for pathway activation in the three strains (<xref ref-type="fig" rid="fig6">Figure 6</xref>) are roughly consistent with transcription profiles. Third, simulations of the microbial community consisting of all three strains (<xref ref-type="fig" rid="fig5">Figure 5</xref>) reproduce the successional dynamics of diversification observed in the evolution experiments (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Fourth, simulations of the SS-FS cocultures restricted to either the glucose-rich or glucose-depleted season reproduce the dominance of the SS or FS type (<xref ref-type="fig" rid="fig7">Figure 7</xref>), respectively, in consistence with previous co-culture experiments. It is important to note that only data from monoculture experiments were used to calibrate the cell models for the three strains (A, SS and FS). In particular, no information from co-culture experiments was used in the setup of the microbial community model, and thus there was no a priori knowledge about what the emergent community dynamics would be. Hence, our work conceptually produced non-trivial predictions that could be compared to experimental observations, although all experiments had already been performed.</p><p>Our work sheds light on the fundamental problem of metabolic diversification and the emergence of shared catabolic pathways. In particular, our model allowed quantitative predictions for the metabolic fluxes for each strain in coculture, revealing temporary cross-feeding as an emergent property of the evolved community (<xref ref-type="bibr" rid="bib59">Treves et al., 1998</xref>). Cross-feeding, conventionally seen as a beneficial interaction (<xref ref-type="bibr" rid="bib44">Morris et al., 2013</xref>), thus emerged as a form of niche segregation driven by competition for organic carbon and oxygen. Because both evolved types prefer glucose whenever available at high concentrations, but exchange acetate under oxygen limitation, the community constantly switches between competitive and beneficial interactions. Natural microbial populations might thus also oscillate between negative and positive interactions, for example depending on oxygen levels. Our findings also support previous suggestions that microbial evolution can be driven by deterministic ecological processes (<xref ref-type="bibr" rid="bib62">Wood et al., 2005</xref>; <xref ref-type="bibr" rid="bib46">Oxman et al., 2008</xref>; <xref ref-type="bibr" rid="bib28">Herron and Doebeli, 2013</xref>). In this case, the observed diversification is due to competition for limiting resources whose use is constrained by basic metabolic tradeoffs. Other instances of ecological diversification in microbial evolution experiments, for example as reported by <xref ref-type="bibr" rid="bib48">Plucain et al. (2014)</xref>, might be explained using a similar approach.</p><p>More generally, we have demonstrated how MCM can be used to experimentally calibrate and combine genome-based cell models to predict the emergent dynamics of microbial communities. Our framework thus provides a starting point for designing microbial communities with particular metabolic properties, such as optimized catabolic performance. While MCM is designed for genome-based metabolic models, it can also accommodate conventional functional group models. In these models, different ecological functions such as photosynthesis, heterotrophy or nitrification are performed by distinct populations whose metabolic activity is determined, for example, by Michaelis–Menten kinetics and whose growth is described by simple substrate-biomass yield factors (<xref ref-type="bibr" rid="bib29">Hood et al., 2006</xref>; <xref ref-type="bibr" rid="bib49">Reed et al., 2014</xref>). Hence, natural microbial communities could be modeled even if annotated genomes are not available for each member species. While functional group models general require fewer parameters, their calibration remains a challenge (<xref ref-type="bibr" rid="bib47">Panikov and Sizova, 1996</xref>). In MCM, model calibration becomes analogous to coefficient estimation in conventional multivariate regression, and can be used to estimate poorly known parameters such as stoichiometric coefficients, growth kinetics or extracellular transport coefficients (MCM user manual, <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>, section 12). To our knowledge, no existing comparable framework offers the flexibility combined with the statistical functionality of MCM. In view of the increasing availability of genome-scale metabolic models (<xref ref-type="bibr" rid="bib17">Feist et al., 2008</xref>), our work provides a missing link to a predictive and synthetic microbial ecology.</p></sec></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><sec id="s3-1"><title>MCM overview</title><p>MCM is a mathematical and computational framework for the construction, simulation, statistical analysis and calibration of microbial community models (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Models are specified in special files that define all metabolites, reactions, cell species and environmental variables. MCM is controlled through custom scripts, that is, text files containing a sequence of special commands, such as for running simulations or fitting parameters. MCM includes tools for the conversion of conventional genome-scale FBA models, such as generated by the Model SEED pipeline (<xref ref-type="bibr" rid="bib26">Henry et al., 2010</xref>) based on sequenced genomes, into a draft MC model.</p><p>MCM can accommodate microbial communities comprising genome-based cell models with arbitrary environmental variables, metabolite exchange kinetics and regulatory mechanisms. For example, environmental variables may be stochastic processes (e.g., representing climate), or specified using measured data (e.g., redox potential in bioreactor experiments), or depend on metabolite concentrations (e.g., pH determined by acetate concentration) or even be dynamical (e.g., temperature increasing at a rate proportional to biomass production rates). This versatility allows for the incorporation of complex environmental feedbacks, such as host immune responses in gut microbiota (<xref ref-type="bibr" rid="bib32">Karlsson et al., 2011</xref>). Metabolite uptake and export rate limits can be arbitrary functions of metabolite concentrations or environmental variables. Similar interdependencies are possible for reaction rate limits, thus allowing the inclusion of inhibitory or regulatory mechanisms (<xref ref-type="bibr" rid="bib11">Covert et al., 2008</xref>). Metabolite concentrations can be explicitly specified, for example, using measured time series, or depend dynamically on microbial export and other external fluxes. Effects of phage predation (<xref ref-type="bibr" rid="bib31">Jensen et al., 2006</xref>), reaction energetics (<xref ref-type="bibr" rid="bib49">Reed et al., 2014</xref>) or stochastic environments can also be incorporated.</p><p>MCM keeps track of a multitude of output variables such as cell densities, reaction rates, metabolite concentrations and metabolite exchange rates. Because each reaction can be formally associated with a particular enzyme, in turn encoded by a particular gene, MCM also makes predictions about gene densities as a product of cell densities and gene copy numbers per cell. Metabolic activity statistics (e.g., <xref ref-type="fig" rid="fig6">Figure 6A,B</xref>) facilitate the identification of metabolic interactions such as cross-feeding (<xref ref-type="bibr" rid="bib44">Morris et al., 2013</xref>). The predicted time courses of output variables can be statistically evaluated against time series ranging from chemical concentrations, rate measurements to cell densities and metagenomics.</p><p>MC models can include arbitrary abstract (symbolic) numeric parameters with a predefined value range or probability distribution. Symbolic parameters can represent, for example, stoichiometric coefficients, gene copy numbers, cell life expectancies, half-saturation constants or environmental variables. The inclusion of symbolic parameters enables a high-level analysis of microbial communities: For example, MCM can automatically calibrate (fit) unknown symbolic parameters to time series using maximum–likelihood parameter estimation (<xref ref-type="bibr" rid="bib14">Eliason, 1993</xref>). The likelihood of the data, given a particular parameter choice, is calculated by assuming a mixed deterministic-stochastic model in which the deterministic part is given by the model predictions, and the stochastic part is given by normally distributed errors. The likelihood is minimized using an iterative optimization algorithm involving step-wise parameter adjustments and repeated simulations. Other fitting algorithms are also available, such as maximization of the average coefficient of determination (<italic>R</italic><sup>2</sup>), which is equivalent to weighted least-squares fitting. Because MCM can calibrate unknown measurement units, raw uncalibrated data (e.g., optical cell densities with no calibration to colony forming units, <xref ref-type="fig" rid="fig4">Figure 4A</xref>) can also be used.</p><p>In this paper single-cell models were calibrated to monoculture experiments, however models can also be calibrated using data from experimental or natural communities that include unculturable species (MCM user manual, <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>, sections 7 and 12; <xref ref-type="bibr" rid="bib38">Louca and Doebeli, 2015</xref>). In general, fitted parameters need not be directly connected to the data used for calibration, as long as a change in the parameters influences the predictions that are being compared to the data. While this is a general principle of parameter estimation (<xref ref-type="bibr" rid="bib58">Tarantola, 2005</xref>), in practice the uncertainty of calibrated parameters (e.g., in terms of confidence intervals) increases when their influence on the ‘goodness of fit’ is weaker. Moreover, alternative parameter combinations can sometimes yield a comparable match to the data, especially if multiple parameters influence the same variables (inverse problem degeneracy). Local fitting optima can be detected through repeated randomly seeded calibrations (see next section), and overfitting can be partially avoided by keeping the number of free parameters at a bare minimum. Nevertheless, in certain cases good knowledge of the system or previous literature may be required to identify the most plausible calibrations. Finally, we emphasize that MCM is, after all, merely a framework enabling the construction, calibration and analysis of microbial community models. MCM models are thus limited by the same caveats and assumptions as other constraint-based metabolic models (<xref ref-type="bibr" rid="bib3">Blazier and Papin, 2012</xref>; <xref ref-type="bibr" rid="bib2">Antoniewicz, 2013</xref>) and any predictions made by MCM should be subject to similar scrutiny.</p></sec><sec id="s3-2"><title>Calibration of <italic>E. coli</italic> cell models</title><p><italic>E. coli</italic> strains were obtained from an evolution experiment performed in a batch culture environment with daily dilutions into glucose-acetate supplemented Davis minimal medium (<xref ref-type="bibr" rid="bib54">Spencer et al., 2008</xref>; <xref ref-type="bibr" rid="bib60">Tyerman et al., 2008</xref>). For each phenotype, three clones were isolated from population 20 after 150 days and used for three independent monoculture growth experiments. Optical densities, as well as glucose, acetate and oxygen concentration data from these experiments were used to calibrate the individual cell-metabolic models for the A, SS and FS phenotypes. Oxygen measurements were not available for type A. Experimental details and results are described by <xref ref-type="bibr" rid="bib37">Le Gac et al. (2008)</xref>.</p><p>In the models, the limiting nutrients are assumed to be oxygen, glucose and acetate; all other nutrients can be taken up at an arbitrary rate. Oxygen, glucose and acetate uptake rate limits were described by Monod-like kinetics. The maximum cell-specific oxygen uptake rate was set to <inline-formula><mml:math id="inf1"><mml:mrow><mml:mn>1.008</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:msup><mml:mtext> mol</mml:mtext><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>d</mml:mtext><mml:mo>⋅</mml:mo><mml:mtext>cell</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, according to <xref ref-type="bibr" rid="bib61">Varma and Palsson (1994)</xref>. The oxygen half-saturation constant was set to 1.21×10<sup>−7</sup> M according to <xref ref-type="bibr" rid="bib56">Stolper et al. (2010)</xref>. Oxygen was assumed to be initially at atmospheric saturation levels (0.217 mM at 37<sup>∘</sup> C) and repleted at a rate proportional to its deviation from saturation (<xref ref-type="bibr" rid="bib22">Gupta and Rao, 2003</xref>).</p><p>The fitted parameters for each cell type were the maximum cell-specific uptake rates and half-saturation constants for glucose and acetate, as well as initial cell densities and non-growth associated ATP maintenance energy requirements. The initial glucose and acetate concentrations were set to the average value measured at the earliest sampling point (1 hr after incubation) for each type. The oxygen mass transfer coefficient (<inline-formula><mml:math id="inf2"><mml:mrow><mml:mtext>M</mml:mtext><mml:mo>/</mml:mo><mml:mtext>day</mml:mtext></mml:mrow></mml:math></inline-formula> per M deviation) was initially fitted individually for each type together with all other parameters, and then fixed to the average of all three initial fits. All other parameters were then again fitted individually for each type. Parameter fitting was done by maximizing the average coefficient of determination (<italic>R</italic><sup>2</sup>) using the MCM command <italic>fitMCM</italic>. A total of 237 data points were used to fit 19 parameters (Table in <xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>). To reduce the possibility of only reaching a local maximum, fitting was repeated 100 times for each strain starting at random initial parameter values and the best fit among all 100 runs was used. While some fitting runs reached alternative local maxima, the best overall fit was reached in most cases.</p><p>Cell densities were directly compared to optical density (OD) measurements. The appropriate calibrations were estimated by MCM and ranged within <inline-formula><mml:math id="inf3"><mml:mrow><mml:mn>8.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mn>1.3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msup><mml:mtext> cells</mml:mtext><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>L</mml:mtext><mml:mo>⋅</mml:mo><mml:mtext>OD</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. These estimates are consistent with previous experimental calibrations (<xref ref-type="bibr" rid="bib36">Lawrence and Maier, 1977</xref>) yielding <inline-formula><mml:math id="inf4"><mml:mrow><mml:mn>0.26</mml:mn><mml:mtext> g dry weight</mml:mtext><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>L</mml:mtext><mml:mo>⋅</mml:mo><mml:mtext>OD</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> which corresponds to <inline-formula><mml:math id="inf5"><mml:mrow><mml:mn>1.4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msup><mml:mtext> cells</mml:mtext><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtext>L</mml:mtext><mml:mo>⋅</mml:mo><mml:mtext>OD</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (assuming a cell dry weight of 1.8×10<sup>−13</sup> g in the stationary phase; <xref ref-type="bibr" rid="bib16">Fagerbakke et al., 1996</xref>).</p></sec><sec id="s3-3"><title>Simulation of the microbial community model</title><p>The microbial community model was simulated using the MCM command <italic>runMCM</italic>. Initial glucose and acetate concentrations were set to the average of all values measured at the earliest sampling point of the monoculture incubations. Cell death was not explicitly included, because of lack of appropriate data for calibration and because daily dilutions by far exceeded cell death as a factor of cell population reduction.</p></sec><sec id="s3-4"><title>Robustness of the SS-FS coexistence</title><p>To verify the robustness of the stable SS-FS coexistence in coculture, we randomly varied each fitted model parameter uniformly within an interval spanning 10% above and 10% below its calibrated value. Both types coexisted in 50 out of 50 random simulations (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>).</p></sec><sec id="s3-5"><title>Seasonal restriction of the SS-FS cocultures</title><p>Simulations of the SS-FS cocultures restricted to the first glucose-rich or second glucose-depleted season, as opposed to the full batch cycle, were performed in analogy to the experiments by <xref ref-type="bibr" rid="bib53">Spencer et al. (2007)</xref>. More precisely, to model the first season experiment we changed the dilution rate to <inline-formula><mml:math id="inf6"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:math></inline-formula> every 5 hr, so that at the end of each batch cycle glucose was not yet completely depleted. Similarly, for the second season experiment we changed the dilution rate to <inline-formula><mml:math id="inf7"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>32</mml:mn></mml:mrow></mml:math></inline-formula> every 19 hr, and adjusted the growth medium to resemble the glucose-depleted acetate-rich solution reported by Spencer et al. (no glucose, 3.59 mM acetate). Initial cell densities were set to <inline-formula><mml:math id="inf8"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msup><mml:mtext> cells</mml:mtext><mml:mo>/</mml:mo><mml:mtext>l</mml:mtext></mml:mrow></mml:math></inline-formula> for both types. All other model parameters were kept unchanged. The original experiments by <xref ref-type="bibr" rid="bib53">Spencer et al. (2007)</xref> were performed at higher dilution rates (4 and 15 hr for the first and second season experiment, respectively), however in our simulations neither the FS nor SS type could persist at these high dilution rates. We note that the strains used in our work (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>) had evolved in separate evolution experiments using a different growth medium than those by <xref ref-type="bibr" rid="bib53">Spencer et al. (2007)</xref>.</p></sec><sec id="s3-6"><title>Obtaining MCM</title><p>MCM is open source and available at <ext-link ext-link-type="uri" xlink:href="http://www.zoology.ubc.ca/MCM">http://www.zoology.ubc.ca/MCM</ext-link>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>SL acknowledges the financial support of the PIMS IGTC for Mathematical Biology as well as the Department of Mathematics, UBC. SL and MD acknowledge the support of NSERC. We thank Evan Durno and Matthew Osmond for comments. We thank Sung Ho Yoon (Korea Research Institute of Bioscience &amp; Biotechnology) for providing us with a copy of the REL606 cell-metabolic model (<xref ref-type="bibr" rid="bib63">Yoon et al., 2012</xref>). We thank Mickaël Le Gac (Laboratoire d'Ecologie Pélagique, France) for providing us with the raw data of his monoculture incubation experiments (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>).</p></ack><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>MD: Reviewing editor, <italic>eLife.</italic></p></fn><fn fn-type="conflict" id="conf2"><p>The other author declares that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>SL, Conceived and developed MCM. Designed the <italic>E. coli</italic> community model and performed the calibration and simulations. Analyzed and interpreted the simulations. Wrote the article</p></fn><fn fn-type="con" id="con2"><p>MD, Interpreted the simulations. Contributed to writing the article. Supervised the project</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.08208.013</object-id><label>Supplementary file 1.</label><caption><p>A thorough user manual for MCM, including an in-depth description of MCM's mathematical framework and step-by-step examples. The latest version can also be retrieved at <ext-link ext-link-type="uri" xlink:href="http://www.zoology.ubc.ca/MCM">http://www.zoology.ubc.ca/MCM</ext-link>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.013">http://dx.doi.org/10.7554/eLife.08208.013</ext-link></p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-08208-supp1-v1.pdf"/></supplementary-material><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.08208.014</object-id><label>Supplementary file 2.</label><caption><p>An overview of the fitted parameter values for the <italic>E. coli</italic> models.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.014">http://dx.doi.org/10.7554/eLife.08208.014</ext-link></p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-08208-supp2-v1.pdf"/></supplementary-material><supplementary-material id="SD3-data"><object-id pub-id-type="doi">10.7554/eLife.08208.015</object-id><label>Source code 1.</label><caption><p>Includes the full calibrated MC model of the <italic>E. coli</italic> microbial community, together with all MCM scripts required for its simulation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.08208.015">http://dx.doi.org/10.7554/eLife.08208.015</ext-link></p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-08208-code1-v1.zip"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersen</surname><given-names>KB</given-names></name><name><surname>von Meyenburg</surname><given-names>K</given-names></name></person-group><year>1980</year><article-title>Are growth rates of <italic>Escherichia coli</italic> in batch cultures limited by respiration?</article-title><source>Journal of Bacteriology</source><volume>144</volume><fpage>114</fpage><lpage>123</lpage></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antoniewicz</surname><given-names>MR</given-names></name></person-group><year>2013</year><article-title>Dynamic metabolic flux analysis – tools for probing transient states of metabolic networks</article-title><source>Current Opinion in Biotechnology</source><volume>24</volume><fpage>973</fpage><lpage>978</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2013.03.018</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blazier</surname><given-names>AS</given-names></name><name><surname>Papin</surname><given-names>JA</given-names></name></person-group><year>2012</year><article-title>Integration of expression data in genome-scale metabolic network reconstructions</article-title><source>Frontiers in Physiology</source><volume>3</volume><pub-id pub-id-type="doi">10.3389/fphys.2012.00299</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname><given-names>K</given-names></name><name><surname>You</surname><given-names>L</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><year>2008</year><article-title>Engineering microbial consortia: a new frontier in synthetic biology</article-title><source>Trends in Biotechnology</source><volume>26</volume><fpage>483</fpage><lpage>489</lpage><pub-id pub-id-type="doi">10.1016/j.tibtech.2008.05.004</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burgard</surname><given-names>AP</given-names></name><name><surname>Maranas</surname><given-names>CD</given-names></name></person-group><year>2003</year><article-title>Optimization-based framework for inferring and testing hypothesized metabolic objective functions</article-title><source>Biotechnology and Bioengineering</source><volume>82</volume><fpage>670</fpage><lpage>677</lpage><pub-id pub-id-type="doi">10.1002/bit.10617</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cariboni</surname><given-names>J</given-names></name><name><surname>Gatelli</surname><given-names>D</given-names></name><name><surname>Liska</surname><given-names>R</given-names></name><name><surname>Saltelli</surname><given-names>A</given-names></name></person-group><year>2007</year><article-title>The role of sensitivity analysis in ecological modelling</article-title><source>Ecological Modelling</source><volume>203</volume><fpage>167</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1016/j.ecolmodel.2005.10.045</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiu</surname><given-names>HC</given-names></name><name><surname>Levy</surname><given-names>R</given-names></name><name><surname>Borenstein</surname><given-names>E</given-names></name></person-group><year>2014</year><article-title>Emergent biosynthetic capacity in simple microbial communities</article-title><source>PLOS Computational Biology</source><volume>10</volume><fpage>e1003695</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003695</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Covert</surname><given-names>MW</given-names></name><name><surname>Knight</surname><given-names>EM</given-names></name><name><surname>Reed</surname><given-names>JL</given-names></name><name><surname>Herrgard</surname><given-names>MJ</given-names></name><name><surname>Palsson</surname><given-names>BO</given-names></name></person-group><year>2004</year><article-title>Integrating high-throughput and computational data elucidates bacterial networks</article-title><source>Nature</source><volume>429</volume><fpage>92</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1038/nature02456</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Covert</surname><given-names>MW</given-names></name><name><surname>Palsson</surname><given-names>BØ</given-names></name></person-group><year>2002</year><article-title>Transcriptional regulation in constraints-based metabolic models of <italic>Escherichia coli</italic></article-title><source>Journal of Biological Chemistry</source><volume>277</volume><fpage>28058</fpage><lpage>28064</lpage><pub-id pub-id-type="doi">10.1074/jbc.M201691200</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Covert</surname><given-names>MW</given-names></name><name><surname>Schilling</surname><given-names>CH</given-names></name><name><surname>Palsson</surname><given-names>B</given-names></name></person-group><year>2001</year><article-title>Regulation of gene expression in flux balance models of metabolism</article-title><source>Journal of Theoretical Biology</source><volume>213</volume><fpage>73</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.1006/jtbi.2001.2405</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Covert</surname><given-names>MW</given-names></name><name><surname>Xiao</surname><given-names>N</given-names></name><name><surname>Chen</surname><given-names>TJ</given-names></name><name><surname>Karr</surname><given-names>JR</given-names></name></person-group><year>2008</year><article-title>Integrating metabolic, transcriptional regulatory and signal transduction models in <italic>Escherichia coli</italic></article-title><source>Bioinformatics</source><volume>24</volume><fpage>2044</fpage><lpage>2050</lpage></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duarte</surname><given-names>NC</given-names></name><name><surname>Herrgård</surname><given-names>MJ</given-names></name><name><surname>Palsson</surname><given-names>BØ</given-names></name></person-group><year>2004</year><article-title>Reconstruction and validation of <italic>Saccharomyces cerevisiae</italic> iND750, a fully compartmentalized genome-scale metabolic model</article-title><source>Genome Research</source><volume>14</volume><fpage>1298</fpage><lpage>1309</lpage><pub-id pub-id-type="doi">10.1101/gr.2250904</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elena</surname><given-names>SF</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name></person-group><year>2003</year><article-title>Evolution experiments with microorganisms: the dynamics and genetic bases of adaptation</article-title><source>Nature Reviews Genetics</source><volume>4</volume><fpage>457</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1038/nrg1088</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Eliason</surname><given-names>SR</given-names></name></person-group><year>1993</year><source>Maximum likelihood estimation: logic and practice</source><publisher-loc>Newbury Park, CA</publisher-loc><publisher-name>SAGE Publications</publisher-name></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Emerson</surname><given-names>S</given-names></name><name><surname>Hedges</surname><given-names>J</given-names></name></person-group><year>2008</year><source>Chemical oceanography and the marine carbon cycle</source><publisher-loc>Cambridge, UK</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fagerbakke</surname><given-names>K</given-names></name><name><surname>Heldal</surname><given-names>M</given-names></name><name><surname>Norland</surname><given-names>S</given-names></name></person-group><year>1996</year><article-title>Content of carbon, nitrogen, oxygen, sulfur and phosphorus in native aquatic and cultured bacteria</article-title><source>Aquatic Microbial Ecology</source><volume>10</volume><fpage>15</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.3354/ame010015</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feist</surname><given-names>AM</given-names></name><name><surname>Herrgård</surname><given-names>MJ</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name><name><surname>Reed</surname><given-names>JL</given-names></name><name><surname>Palsson</surname><given-names>BØ</given-names></name></person-group><year>2008</year><article-title>Reconstruction of biochemical networks in microorganisms</article-title><source>Nature Reviews Microbiology</source><volume>7</volume><fpage>129</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1038/nrmicro1949</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feist</surname><given-names>AM</given-names></name><name><surname>Palsson</surname><given-names>BO</given-names></name></person-group><year>2010</year><article-title>The biomass objective function</article-title><source>Current Opinion in Microbiology</source><volume>13</volume><fpage>344</fpage><lpage>349</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2010.03.003</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freilich</surname><given-names>S</given-names></name><name><surname>Zarecki</surname><given-names>R</given-names></name><name><surname>Eilam</surname><given-names>O</given-names></name><name><surname>Segal</surname><given-names>ES</given-names></name><name><surname>Henry</surname><given-names>CS</given-names></name><name><surname>Kupiec</surname><given-names>M</given-names></name><name><surname>Gophna</surname><given-names>U</given-names></name><name><surname>Sharan</surname><given-names>R</given-names></name><name><surname>Ruppin</surname><given-names>E</given-names></name></person-group><year>2011</year><article-title>Competitive and cooperative metabolic interactions in bacterial communities</article-title><source>Nature Communications</source><volume>2</volume><fpage>589</fpage><pub-id pub-id-type="doi">10.1038/ncomms1597</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friesen</surname><given-names>ML</given-names></name><name><surname>Saxer</surname><given-names>G</given-names></name><name><surname>Travisano</surname><given-names>M</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2004</year><article-title>Experimental evidence for sympatric ecological diversification due to frequency-dependent competition in <italic>Escherichia coli</italic></article-title><source>Evolution</source><volume>58</volume><fpage>245</fpage><lpage>260</lpage></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gianchandani</surname><given-names>EP</given-names></name><name><surname>Oberhardt</surname><given-names>MA</given-names></name><name><surname>Burgard</surname><given-names>AP</given-names></name><name><surname>Maranas</surname><given-names>CD</given-names></name><name><surname>Papin</surname><given-names>JA</given-names></name></person-group><year>2008</year><article-title>Predicting biological system objectives de novo from internal state measurements</article-title><source>BMC Bioinformatics</source><volume>9</volume><fpage>43</fpage><pub-id pub-id-type="doi">10.1186/1471–2105-9–43</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Rao</surname><given-names>G</given-names></name></person-group><year>2003</year><article-title>A study of oxygen transfer in shake flasks using a non-invasive oxygen sensor</article-title><source>Biotechnology and Bioengineering</source><volume>84</volume><fpage>351</fpage><lpage>358</lpage><pub-id pub-id-type="doi">10.1002/bit.10740</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hammersley</surname><given-names>JM</given-names></name><name><surname>Handscomb</surname><given-names>DC</given-names></name></person-group><year>1964</year><article-title>Monte carlo methods</article-title><publisher-name>Methuen</publisher-name></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harcombe</surname><given-names>WR</given-names></name><name><surname>Delaney</surname><given-names>NF</given-names></name><name><surname>Leiby</surname><given-names>N</given-names></name><name><surname>Klitgord</surname><given-names>N</given-names></name><name><surname>Marx</surname><given-names>CJ</given-names></name></person-group><year>2013</year><article-title>The ability of flux balance analysis to predict evolution of central metabolism scales with the initial distance to the optimum</article-title><source>PLOS Computational Biology</source><volume>9</volume><fpage>e1003091</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003091</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harcombe</surname><given-names>WR</given-names></name><name><surname>Riehl</surname><given-names>WJ</given-names></name><name><surname>Dukovski</surname><given-names>I</given-names></name><name><surname>Granger</surname><given-names>BR</given-names></name><name><surname>Betts</surname><given-names>A</given-names></name><name><surname>Lang</surname><given-names>AH</given-names></name><name><surname>Bonilla</surname><given-names>G</given-names></name><name><surname>Kar</surname><given-names>A</given-names></name><name><surname>Leiby</surname><given-names>N</given-names></name><name><surname>Mehta</surname><given-names>P</given-names></name><name><surname>Marx</surname><given-names>CJ</given-names></name><name><surname>Segrè</surname><given-names>D</given-names></name></person-group><year>2014</year><article-title>Metabolic resource allocation in individual microbes determines ecosystem interactions and spatial dynamics</article-title><source>Cell Reports</source><volume>7</volume><fpage>1104</fpage><lpage>1115</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2014.03.070</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henry</surname><given-names>CS</given-names></name><name><surname>DeJongh</surname><given-names>M</given-names></name><name><surname>Best</surname><given-names>AA</given-names></name><name><surname>Frybarger</surname><given-names>PM</given-names></name><name><surname>Linsay</surname><given-names>B</given-names></name><name><surname>Stevens</surname><given-names>RL</given-names></name></person-group><year>2010</year><article-title>High-throughput generation, optimization and analysis of genome-scale metabolic models</article-title><source>Nature Biotechnology</source><volume>28</volume><fpage>977</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nbt.1672</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herrgård</surname><given-names>MJ</given-names></name><name><surname>Lee</surname><given-names>BS</given-names></name><name><surname>Portnoy</surname><given-names>V</given-names></name><name><surname>Palsson</surname><given-names>BØ</given-names></name></person-group><year>2006</year><article-title>Integrated analysis of regulatory and metabolic networks reveals novel regulatory mechanisms in <italic>Saccharomyces cerevisiae</italic></article-title><source>Genome Research</source><volume>16</volume><fpage>627</fpage><lpage>635</lpage></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herron</surname><given-names>MD</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2013</year><article-title>Parallel evolutionary dynamics of adaptive diversification in <italic>Escherichia coli</italic></article-title><source>PLOS Biology</source><volume>11</volume><fpage>e1001490</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1001490</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hood</surname><given-names>RR</given-names></name><name><surname>Laws</surname><given-names>EA</given-names></name><name><surname>Armstrong</surname><given-names>RA</given-names></name><name><surname>Bates</surname><given-names>NR</given-names></name><name><surname>Brown</surname><given-names>CW</given-names></name><name><surname>Carlson</surname><given-names>CA</given-names></name><name><surname>Chai</surname><given-names>F</given-names></name><name><surname>Doney</surname><given-names>SC</given-names></name><name><surname>Falkowski</surname><given-names>PG</given-names></name><name><surname>Feely</surname><given-names>RA</given-names></name><name><surname>Friedrichs</surname><given-names>MA</given-names></name><name><surname>Landry</surname><given-names>MR</given-names></name><name><surname>Keith Moore</surname><given-names>J</given-names></name><name><surname>Nelson</surname><given-names>DM</given-names></name><name><surname>Richardson</surname><given-names>TL</given-names></name><name><surname>Salihoglu</surname><given-names>B</given-names></name><name><surname>Schartau</surname><given-names>M</given-names></name><name><surname>Toole</surname><given-names>DA</given-names></name><name><surname>Wiggert</surname><given-names>JD</given-names></name></person-group><year>2006</year><article-title>Pelagic functional group modeling: Progress, challenges and prospects</article-title><source>Deep Sea Research II</source><volume>53</volume><fpage>459</fpage><lpage>512</lpage><pub-id pub-id-type="doi">10.1016/j.dsr2.2006.01.025</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Husnik</surname><given-names>F</given-names></name><name><surname>Nikoh</surname><given-names>N</given-names></name><name><surname>Koga</surname><given-names>R</given-names></name><name><surname>Ross</surname><given-names>L</given-names></name><name><surname>Duncan</surname><given-names>RP</given-names></name><name><surname>Fujie</surname><given-names>M</given-names></name><name><surname>Tanaka</surname><given-names>M</given-names></name><name><surname>Satoh</surname><given-names>N</given-names></name><name><surname>Bachtrog</surname><given-names>D</given-names></name><name><surname>Wilson</surname><given-names>ACC</given-names></name><name><surname>von Dohlen</surname><given-names>CD</given-names></name><name><surname>Fukatsu</surname><given-names>T</given-names></name><name><surname>McCutcheon</surname><given-names>JP</given-names></name></person-group><year>2013</year><article-title>Horizontal gene transfer from diverse bacteria to an insect genome enables a tripartite nested mealybug symbiosis</article-title><source>Cell</source><volume>153</volume><fpage>1567</fpage><lpage>1578</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2013.05.040</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>MA</given-names></name><name><surname>Faruque</surname><given-names>SM</given-names></name><name><surname>Mekalanos</surname><given-names>JJ</given-names></name><name><surname>Levin</surname><given-names>BR</given-names></name></person-group><year>2006</year><article-title>Modeling the role of bacteriophage in the control of cholera outbreaks</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>103</volume><fpage>4652</fpage><lpage>4657</lpage><pub-id pub-id-type="doi">10.1073/pnas.0600166103</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karlsson</surname><given-names>FH</given-names></name><name><surname>Nookaew</surname><given-names>I</given-names></name><name><surname>Petranovic</surname><given-names>D</given-names></name><name><surname>Nielsen</surname><given-names>J</given-names></name></person-group><year>2011</year><article-title>Prospects for systems biology and modeling of the gut microbiome</article-title><source>Trends in Biotechnology</source><volume>29</volume><fpage>251</fpage><lpage>258</lpage><pub-id pub-id-type="doi">10.1016/j.tibtech.2011.01.009</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kassen</surname><given-names>R</given-names></name><name><surname>Rainey</surname><given-names>PB</given-names></name></person-group><year>2004</year><article-title>The ecology and genetics of microbial diversity</article-title><source>Annual Review of Microbiology</source><volume>58</volume><fpage>207</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1146/annurev.micro.58.030603.123654</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klitgord</surname><given-names>N</given-names></name><name><surname>Segrè</surname><given-names>D</given-names></name></person-group><year>2010</year><article-title>Environments that induce synthetic microbial ecosystems</article-title><source>PLOS Computational Biology</source><volume>6</volume><fpage>e1001002</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001002</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klitgord</surname><given-names>N</given-names></name><name><surname>Segrè</surname><given-names>D</given-names></name></person-group><year>2011</year><article-title>Ecosystems biology of microbial metabolism</article-title><source>Current Opinion in Biotechnology</source><volume>22</volume><fpage>541</fpage><lpage>546</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2011.04.018</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>J</given-names></name><name><surname>Maier</surname><given-names>S</given-names></name></person-group><year>1977</year><article-title>Correction for the inherent error in optical density readings</article-title><source>Applied and Environmental Microbiology</source><volume>33</volume><fpage>482</fpage><lpage>484</lpage></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Le Gac</surname><given-names>M</given-names></name><name><surname>Brazas</surname><given-names>MD</given-names></name><name><surname>Bertrand</surname><given-names>M</given-names></name><name><surname>Tyerman</surname><given-names>JG</given-names></name><name><surname>Spencer</surname><given-names>CC</given-names></name><name><surname>Hancock</surname><given-names>REW</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Metabolic changes associated with adaptive diversification in <italic>Escherichia coli</italic></article-title><source>Genetics</source><volume>178</volume><fpage>1049</fpage><lpage>1060</lpage></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louca</surname><given-names>S</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2015</year><article-title>Transient dynamics of competitive exclusion in microbial communities</article-title><source>Environmental Microbiology</source><pub-id pub-id-type="doi">10.1111/1462-2920.13058</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahadevan</surname><given-names>R</given-names></name><name><surname>Edwards</surname><given-names>JS</given-names></name><name><surname>Doyle</surname><given-names>FJ</given-names><suffix>III</suffix></name></person-group><year>2002</year><article-title>Dynamic flux balance analysis of diauxic growth in <italic>Escherichia coli</italic></article-title><source>Biophysical Journal</source><volume>83</volume><fpage>1331</fpage><lpage>1340</lpage></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCutcheon</surname><given-names>JP</given-names></name><name><surname>Moran</surname><given-names>NA</given-names></name></person-group><year>2012</year><article-title>Extreme genome reduction in symbiotic bacteria</article-title><source>Nature Reviews Microbiology</source><volume>10</volume><fpage>13</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2670</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meadows</surname><given-names>AL</given-names></name><name><surname>Karnik</surname><given-names>R</given-names></name><name><surname>Lam</surname><given-names>H</given-names></name><name><surname>Forestell</surname><given-names>S</given-names></name><name><surname>Snedecor</surname><given-names>B</given-names></name></person-group><year>2010</year><article-title>Application of dynamic flux balance analysis to an industrial <italic>Escherichia coli</italic> fermentation</article-title><source>Metabolic Engineering</source><volume>12</volume><fpage>150</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1016/j.ymben.2009.07.006</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Millero</surname><given-names>FJ</given-names></name></person-group><year>2013</year><source>Chemical oceanography. Marine science series</source><publisher-loc>Bosa Roca</publisher-loc><publisher-name>Taylor &amp; Francis</publisher-name><edition>4th edn</edition></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitri</surname><given-names>S</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name></person-group><year>2013</year><article-title>The genotypic view of social interactions in microbial communities</article-title><source>Annual Review of Genetics</source><volume>47</volume><fpage>247</fpage><lpage>273</lpage><pub-id pub-id-type="doi">10.1146/annurev-genet-111212-133307</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>BE</given-names></name><name><surname>Henneberger</surname><given-names>R</given-names></name><name><surname>Huber</surname><given-names>H</given-names></name><name><surname>Moissl-Eichinger</surname><given-names>C</given-names></name></person-group><year>2013</year><article-title>Microbial syntrophy: interaction for the common good</article-title><source>FEMS Microbiology Reviews</source><volume>37</volume><fpage>384</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1111/1574-6976.12019</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orth</surname><given-names>JD</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name><name><surname>Palsson</surname><given-names>BO</given-names></name></person-group><year>2010</year><article-title>What is flux balance analysis?</article-title><source>Nature Biotechnology</source><volume>28</volume><fpage>245</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1038/nbt.1614</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oxman</surname><given-names>E</given-names></name><name><surname>Alon</surname><given-names>U</given-names></name><name><surname>Dekel</surname><given-names>E</given-names></name></person-group><year>2008</year><article-title>Defined order of evolutionary adaptations: experimental evidence</article-title><source>Evolution</source><volume>62</volume><fpage>1547</fpage><lpage>1554</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2008.00397.x</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panikov</surname><given-names>NS</given-names></name><name><surname>Sizova</surname><given-names>MV</given-names></name></person-group><year>1996</year><article-title>A kinetic method for estimating the biomass of microbial functional groups in soil</article-title><source>Journal of Microbiological Methods</source><volume>24</volume><fpage>219</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1016/0167-7012(95)00074-7</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plucain</surname><given-names>J</given-names></name><name><surname>Hindré</surname><given-names>T</given-names></name><name><surname>Le Gac</surname><given-names>M</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name><name><surname>Cruveiller</surname><given-names>S</given-names></name><name><surname>Médigue</surname><given-names>C</given-names></name><name><surname>Leiby</surname><given-names>N</given-names></name><name><surname>Harcombe</surname><given-names>WR</given-names></name><name><surname>Marx</surname><given-names>CJ</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Schneider</surname><given-names>D</given-names></name></person-group><year>2014</year><article-title>Epistasis and allele specificity in the emergence of a stable polymorphism in <italic>Escherichia coli</italic></article-title><source>Science</source><volume>343</volume><fpage>1366</fpage><lpage>1369</lpage><pub-id pub-id-type="doi">10.1126/science.1248688</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reed</surname><given-names>DC</given-names></name><name><surname>Algar</surname><given-names>CK</given-names></name><name><surname>Huber</surname><given-names>JA</given-names></name><name><surname>Dick</surname><given-names>GJ</given-names></name></person-group><year>2014</year><article-title>Gene-centric approach to integrating environmental genomics and biogeochemical models</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>111</volume><fpage>1879</fpage><lpage>1884</lpage><pub-id pub-id-type="doi">10.1073/pnas.1313713111</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schink</surname><given-names>B</given-names></name><name><surname>Stams</surname><given-names>A</given-names></name></person-group><year>2006</year><article-title>Syntrophism among prokaryotes</article-title><person-group person-group-type="editor"><name><surname>Dworkin</surname><given-names>M</given-names></name><name><surname>Falkow</surname><given-names>S</given-names></name><name><surname>Rosenberg</surname><given-names>E</given-names></name><name><surname>Schleifer</surname><given-names>KH</given-names></name><name><surname>Stackebrandt</surname><given-names>E</given-names></name></person-group><source>The prokaryotes</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><fpage>309</fpage><lpage>335</lpage></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segrè</surname><given-names>D</given-names></name><name><surname>Vitkup</surname><given-names>D</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year>2002</year><article-title>Analysis of optimality in natural and perturbed metabolic networks</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>99</volume><fpage>15112</fpage><lpage>15117</lpage></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sommer</surname><given-names>U</given-names></name></person-group><year>1984</year><article-title>The paradox of the plankton: fluctuations of phosphorus availability maintain diversity of phytoplankton in flow-through cultures</article-title><source>Limnology and Oceanography</source><volume>29</volume><fpage>633</fpage><lpage>636</lpage><pub-id pub-id-type="doi">10.4319/lo.1984.29.3.0633</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spencer</surname><given-names>CC</given-names></name><name><surname>Saxer</surname><given-names>G</given-names></name><name><surname>Travisano</surname><given-names>M</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2007</year><article-title>Seasonal resource oscillations maintain diversity in bacterial microcosms</article-title><source>Evolutionary Ecology Research</source><volume>9</volume><fpage>775</fpage></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spencer</surname><given-names>CC</given-names></name><name><surname>Tyerman</surname><given-names>J</given-names></name><name><surname>Bertrand</surname><given-names>M</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Adaptation increases the likelihood of diversification in an experimental bacterial lineage</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>105</volume><fpage>1585</fpage><lpage>1589</lpage><pub-id pub-id-type="doi">10.1073/pnas.0708504105</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stams</surname><given-names>AJ</given-names></name></person-group><year>1994</year><article-title>Metabolic interactions between anaerobic bacteria in methanogenic environments</article-title><source>Antonie van Leeuwenhoek</source><volume>66</volume><fpage>271</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1007/BF00871644</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stolper</surname><given-names>DA</given-names></name><name><surname>Revsbech</surname><given-names>NP</given-names></name><name><surname>Canfield</surname><given-names>DE</given-names></name></person-group><year>2010</year><article-title>Aerobic growth at nanomolar oxygen concentrations</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>107</volume><fpage>18755</fpage><lpage>18760</lpage><pub-id pub-id-type="doi">10.1073/pnas.1013435107</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stolyar</surname><given-names>S</given-names></name><name><surname>Van Dien</surname><given-names>S</given-names></name><name><surname>Hillesland</surname><given-names>KL</given-names></name><name><surname>Pinel</surname><given-names>N</given-names></name><name><surname>Lie</surname><given-names>TJ</given-names></name><name><surname>Leigh</surname><given-names>JA</given-names></name><name><surname>Stahl</surname><given-names>DA</given-names></name></person-group><year>2007</year><article-title>Metabolic modeling of a mutualistic microbial community</article-title><source>Molecular Systems Biology</source><volume>3</volume><fpage>92</fpage><pub-id pub-id-type="doi">10.1038/msb4100131</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tarantola</surname><given-names>A</given-names></name></person-group><year>2005</year><source>Inverse problem theory and methods for model parameter estimation</source><publisher-loc>Philadelphia</publisher-loc><publisher-name>Society for Industrial and Applied Mathematics</publisher-name></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treves</surname><given-names>DS</given-names></name><name><surname>Manning</surname><given-names>S</given-names></name><name><surname>Adams</surname><given-names>J</given-names></name></person-group><year>1998</year><article-title>Repeated evolution of an acetate-crossfeeding polymorphism in long-term populations of <italic>Escherichia coli</italic></article-title><source>Molecular Biology and Evolution</source><volume>15</volume><fpage>789</fpage><lpage>797</lpage><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a025984</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tyerman</surname><given-names>JG</given-names></name><name><surname>Bertrand</surname><given-names>M</given-names></name><name><surname>Spencer</surname><given-names>CC</given-names></name><name><surname>Doebeli</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Experimental demonstration of ecological character displacement</article-title><source>BMC Evolutionary Biology</source><volume>8</volume><fpage>34</fpage><pub-id pub-id-type="doi">10.1186/1471–2148-8–34</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Varma</surname><given-names>A</given-names></name><name><surname>Palsson</surname><given-names>BO</given-names></name></person-group><year>1994</year><article-title>Stoichiometric flux balance models quantitatively predict growth and metabolic by-product secretion in wild-type <italic>Escherichia coli</italic> W3110</article-title><source>Applied and Environmental Microbiology</source><volume>60</volume><fpage>3724</fpage><lpage>3731</lpage></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wood</surname><given-names>T</given-names></name><name><surname>Burke</surname><given-names>J</given-names></name><name><surname>Rieseberg</surname><given-names>L</given-names></name></person-group><year>2005</year><article-title>Parallel genotypic adaptation: when evolution repeats itself</article-title><source>Genetica</source><volume>123</volume><fpage>157</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1007/s10709-003-2738-9</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname><given-names>SH</given-names></name><name><surname>Han</surname><given-names>MJ</given-names></name><name><surname>Jeong</surname><given-names>H</given-names></name><name><surname>Lee</surname><given-names>CH</given-names></name><name><surname>Xia</surname><given-names>XX</given-names></name><name><surname>Lee</surname><given-names>DH</given-names></name><name><surname>Shim</surname><given-names>JH</given-names></name><name><surname>Lee</surname><given-names>SY</given-names></name><name><surname>Oh</surname><given-names>TK</given-names></name><name><surname>Kim</surname><given-names>JF</given-names></name></person-group><year>2012</year><article-title>Comparative multi-omics systems analysis of <italic>Escherichia coli</italic> strains B and K-12</article-title><source>Genome Biology</source><volume>13</volume><fpage>R37</fpage><pub-id pub-id-type="doi">10.1186/gb-2012-13-5-r37</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zengler</surname><given-names>K</given-names></name><name><surname>Palsson</surname><given-names>BO</given-names></name></person-group><year>2012</year><article-title>A road map for the development of community systems (CoSy) biology</article-title><source>Nature Reviews Microbiology</source><volume>10</volume><fpage>366</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2763</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zomorrodi</surname><given-names>AR</given-names></name><name><surname>Maranas</surname><given-names>CD</given-names></name></person-group><year>2012</year><article-title>OptCom: a multi-level optimization framework for the metabolic modeling and analysis of microbial communities</article-title><source>PLOS Computational Biology</source><volume>8</volume><fpage>e1002363</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002363</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.08208.016</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing editor</role><aff><institution>Fred Hutchinson Cancer Research Center,</institution> <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for submitting your work entitled “Predicting the dynamics of microbial communities using genome-based metabolic models” for peer review at <italic>eLife</italic>. Your submission has been favorably evaluated by Naama Barkai (Senior Editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors.</p><p>The reviewers have discussed the reviews with one another and the Reviewing editor has drafted this decision to help you prepare a revised submission.</p><p>This manuscript presents (a) a computational pipeline for calibrating genome-scale models of metabolism through fitting to experimental data and (b) the application of calibrated <italic>E. coli</italic> models to the study of a previously published evolutionary experiment, in which two mutants were found to coexist, after outcompeting the ancestral strain. What have we learned? From the point of view of this biological system, this paper provided yet another piece of data to the many already existing that the niche for FS emerges after the SS rise in frequency, but does not go to fixation. This has been known for quite a while, but it is nice to see the model agree with this finding. The calibration of individual genome scale models prior to studying communities seems a nice addition to existing frameworks, in fact one that should become a standard approach, whenever possible, for ecosystem-level modeling. The modeling and calibration software developed by the authors seems very well documented.</p><p>Shared major concerns:</p><p>1) Your paper did not explicitly compare model predictions with experiments. We would like to see a comparison of predicted metabolic and population dynamics with experimental coculture dynamics. There are no new experiments to test any predicted effect of perturbations. To at least test that FS can't invade alone is totally easy. Presumably one could also find an acetate concentration that would have been high enough to obviate the need for SS to come first (or a shorter duration or larger dilution that would have left enough acetate by the time of the transfer to have had the same effect). Another major prediction – that was pretty cool – is that acetate is excreted during a short window of time. This would be an excellent experiment to validate the model's predictions. Finally, you have to actually <italic>show</italic> us the comparison of predicted fluxes and mRNA that is supposed to be such a great fit. If it really is that good, we'd be rather impressed, for there is a huge literature about how this is not the case.</p><p>2) MCM seems to be sold too hard and does not responsibly acknowledge other DFBA platforms for communities like COMETS that do nearly everything mentioned here except the statistical fitting of parameters. We rather like that extension, but it seems to be advertised as more than it is.</p><p>3) Given that the authors propose their approach as broadly applicable to studying microbial communities, we think it may be important for them to comment on the realistic applicability of the method beyond <italic>E. coli</italic> wild type and mutants, or other well-annotated models. Would their method be useful, for example, for improving models that lack precision not just at the level of uptake kinetics, but at the level of the stoichiometry itself?</p><p>Specific major concerns:</p><p><italic>Reviewer 1:</italic></p><p>1) I don't understand <xref ref-type="fig" rid="fig3">Figure 3</xref>. If SS released acetate under oxygen limitation (∼1/4 day after daily dilution, <xref ref-type="fig" rid="fig3">Figure 3 i,j</xref>), then why should acetate be accumulated that quickly – immediately after daily dilution (<xref ref-type="fig" rid="fig3">Figure 3f</xref>)?</p><p>2) The Introduction should clearly discuss where the field stands currently and how MCM pushes the field forward. I am not sure how, for example, COMETS of the Segre group could have predicted the spatial-temporal dynamics in microbial communities if they had not somehow calibrated their model. Only after I talked to an expert did I realize that usually parameter choice is done through looking for values in literature, which leaves a few tunable parameters. Then, parameters are adjusted manually to fit experimental dynamics. This is because some of these parameters may not be directly measured experimentally. A thoughtful discussion on this will be helpful.</p><p>3) The end of conclusion mentioned that parameter estimation does not necessarily require monoculture measurements. This is a critical point, and should be formally demonstrated (rather than hidden in a supplementary file). For example, the authors could model the three-member community with parameters derived from cocultures of two members starting at arbitrary initial compositions. This is to mimic cases (e.g. soil microbes) where many species are not individually culturable.</p><p>4) The flow of the paper is suboptimal, especially to an outside reader. For example, you can move “MCM overview” to immediately after the Introduction. You may also want to add concrete examples to your figures to demonstrate how MCM works in reality.</p><p><italic>Reviewer 2:</italic></p><p>1) The novelty of this work is mainly in the combination of different approaches and data, rather than in the approaches and data themselves. I find fascinating that the model recapitulates the observations, and that model-predicted fluxes are consistent with previously measured gene expression data. However, it is not clear to me what aspects of the insight provided by the model were not known or suspected before, given that extensive work was done on this system.</p><p>2) As mentioned above, I like the calibration approach. However, I think that some important information is missing. First, there should be a table (fine as supplementary) detailing the values of fitted parameters, and any available comparative values from the literature (only a few examples are provided in the Methods section). Also: is the fitted ATP maintenance the value for the non-growth associated maintenance, or the coefficients of growth-associated maintenance? Second, it would important for readers to know whether the solutions found by the fitting algorithm are unique, and how sensitive the result are to parameter precision. Sensitivity analyses are discussed in the user manual, and seem to have been applied to a different microbial community. I think it would be particularly important to know whether the main result of stable coexistence is sensitive to the choice of fitted parameters.</p><p><italic>Reviewer 3:</italic></p><p>1) The text reads that “these observations are in exact agreement with microarray transcriptional profiles”. Given the strength of “exact agreement”, I was very surprised that there was no display of experiment versus model. This was a major finding, but no figures or statistical analysis of what “exact” means.</p><p>A related point: it is claimed that “MCM also makes predictions about gene densities” because each flux is associated with an enzyme. This is actually a fairly ludicrous claim. There have been paper after paper showing that, not only can there be a lack of correlation between flux and enzyme activity, they can even be negatively correlated. This is a central tenet of Metabolic Control Analysis, and has been well documented and commented upon by folks such as Dan Fraenkel (2003, Current Opinion in Microbiology) and Hans Westerhoff (Rossell et al., 2006. PNAS). This possibility must be addressed to make the reader aware that there should never be the assumption that flux is proportionally related to enzyme levels for all enzymes. If that were so, every enzyme would have a control coefficient of 1, which is absolutely impossible because the sum of control coefficients from the entire cell is 1.</p><p>Returning to the point above, then, if there really is a good quantitative correlation between the array data from the Le Gac work and the DFBA model here – for matching timepoints as the mRNA was harvested – it would be quite a nice finding. This analysis is absolutely essential to the paper.</p><p>2) An advance stated is MCM itself. I am not sold upon exactly how this is really a major advance beyond a variety of other DFBA approaches, including prior work on communities. For example, a very large number of MCM features that are described in a way that comes across as them being novel also exist in COMETS (2014, Cell Reports). At the very least, acknowledge where this is so, and use it as an opportunity to more precisely say where this goes above and beyond. For example, I like the inherent fitting of data and perhaps more could be made of exactly how this works. COMETS does not use fitting to each substrate, and frankly an objective means to parameterize when canonical parameters fail to work well is a nice step.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled “Calibration and analysis of genome-based models for microbial ecology” for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Naama Barkai (Senior Editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p><italic>Reviewer 1:</italic></p><p>For this to be a useful Tools and Resources article, I'd still like to see a discussion on MCM's limitations and requirements in the main text. For example, what is enough data for calibrating a model? Under what situations will MCM give you several solutions and what do you do in this case? What should be avoided or advocated when using MCM? You probably discussed these in the manual, but it will be helpful to summarize the main points in the text.</p><p><italic>Reviewer 2:</italic></p><p>The authors have overall addressed my concerns, partially by answering the issues raised, partially by transforming their work into a Tools and Resources article.</p><p>There are still two points that need some revision:</p><p>1) Even if biological insight is no more the main focus of the paper, I still think that the authors could explain a little bit in the Introduction why people may care about the specific example they study. For example, I like the following rebuttal of the authors to one of the questions: “While most of the results have been found experimentally over the course of several years, it is only now that a mechanistic model has managed to unify many of them in such a clear, unambiguous and synergistic manner. These modeling results provide very strong credence to a large body of experimental work that was done in our lab over the course of roughly a decade.” I think that a slightly expanded version of this text would help orient the broad readership towards understanding why their example is interesting (in addition to the fact that it works).</p><p>2) Most importantly, I think that in talking about their software, as well as previous tools, the authors should be very careful to clearly distinguish between features that ere possible (currently or in principle) in the different tools, vs. features that are actually presented in detail and tested in the manuscript. I am referring in particular to the last paragraph in the subsection “Model”, which is quite problematic in a number of ways. For example, regulation (both allosteric and transcriptional) in FBA models is notoriously a very tricky, overall unresolved problem. MCM has the potentially useful feature of allowing users to set rules to limit fluxes as a function of other parameters. This feature, described in one page in the user manual, is oversold in the main text as a capacity of MCM to include regulation. Similarly superficial is the description of the inclusion of phages in the model. Again, this is described shortly in the user manual with no justification or testing. All these features are unnecessarily used as a way of contrasting MCM with previous software, leading to unjustified conclusions, e.g. that COMETS “offers limited model versatility in terms of uptake kinetics” (COMETS does allow different parameters for different molecules and organisms, even if parameters were chosen to be equal in the specific simulations presented in the COMETS paper), that COMETS “seems limited to Petri dishes”, whereas “MCM can be used to understand the dynamics of realistic microbial communities, ranging from the soil or groundwater to artificial communities and bioreactors”. Both COMETS and MCM, after all, were based on the same underlying modeling framework, and tested on laboratory systems. I think the authors should definitely mention (with added accuracy) – perhaps in the Discussion – the additional features of their software that are not described and tested in detail in the main text. At the same time, I think they should limit their claims of major innovation to the components that are actually tested and presented in detail. The capacity to perform calibration on individual organisms, followed by proof of predictive capacity of the global dynamics on a highly interesting system is elegant and brilliant, and I think it is unnecessarily weakened by these other dubious claims.</p><p><italic>Reviewer 3:</italic></p><p>First off, I strongly agree with Reviewer 2's comments above. They have done much to improve the paper to show more and fix much of the language. As noted, however, saying why this matters in the paper as well as they did in the rebuttal would be great, and they still need to back down from hyping a large series of bells and whistles that may be great features but are not demonstrated here. There are plenty of nice advances in their method and they should stick to these.</p><p>As for my own concerns, the direct comparison to data and clarification that expression and flux should not be expected to perfectly correlate is a massive relief. The qualitative agreement is not bad in <xref ref-type="fig" rid="fig6">Figure 6c and d</xref>, and can rest on its own laurels. The figures are also particularly improved in their clarity.</p><p>I still find the concept of an “average flux” over such a dynamic experiment to be strange, but at least it is now explained. Using the same time point as the RNA data is <italic>far</italic> better.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.08208.017</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Shared major concerns:</italic></p><p><italic>1) Your paper did not explicitly compare model predictions with experiments. We would like to see a comparison of predicted metabolic and population dynamics with experimental coculture dynamics. There are no new experiments to test any predicted effect of perturbations. To at least test that FS can't invade alone is totally easy. Presumably one could also find an acetate concentration that would have been high enough to obviate the need for SS to come first (or a shorter duration or larger dilution that would have left enough acetate by the time of the transfer to have had the same effect).</italic></p><p>To address this concern, we would like to first clarify our methodology: to calibrate our microbial community model we have only used data from monoculture experiments, and we have completely ignored any information from co-culture experiments. This calibration yields the parameters that we used to characterize each of the three strains (ancestor, SS and FS). We then put these three calibrated strains into an artificial MCM community, which predicted emergent dynamics of the microbial community. Because the model strains were calibrated in monoculture, there was no guarantee as to what these emergent dynamics would be. Our main result is that in fact, the emergent dynamics very closely correspond to those that had previously been found in a series of co-culture experiments. Thus, conceptually our model yielded predictions that were borne out by experiments, albeit experiments that had already been performed. Nevertheless, the editors' and reviewers' suggestion for a more extensive experimental validation is well taken, and we have now expanded that part of the manuscript.</p><p>In summary:</p><p>1) Our MCM simulations predict a clear succession of the three phenotypes and an eventual coexistence of the SS and FS phenotypes (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). This has been shown repeatedly in previous evolution experiments.</p><p>2). Our simulations of a single batch of FS and SS co-culture predict a culmination of the SS relative density within 4-8 hours, and a subsequent decline due to the growth of the FS type (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). This has been shown experimentally in Friesen et al<italic>.</italic> (2004, <xref ref-type="fig" rid="fig6">Figure 6B</xref> therein). We now discuss this observation in the manuscript (last paragraph of the “Predicting microbial community dynamics” section).</p><p>3) Our simulations of the FS and SS co-culture predict a small increase in acetate concentration, shortly after depletion of the glucose within each batch cycle (<xref ref-type="fig" rid="fig5">Figure 5b and 5j</xref>). This has been shown experimentally by Spencer et al. (2007, p. 779). We have added an appropriate comment to the manuscript (second paragraph of the “Predicting microbial community dynamics” section).</p><p>4) Our simulations predict differential pathway activation between the SS and FS types in co-culture, particularly of the <italic>acs</italic>, <italic>ack</italic>, <italic>pta</italic>, <italic>ppc</italic>, <italic>pdh</italic> and <italic>pyk</italic> genes, which are important determinants of the acetate and glucose pathways. These patterns are qualitatively consistent with microarray transcript profiles by <xref ref-type="bibr" rid="bib37">Le Gac et al. (2008)</xref>. Also see our response to related questions by the reviewers.</p><p>5) Additional MCM simulations of the FS and SS co-culture, restricted to either the glucose-rich season or the glucose-depleted season, predict a rapid extinction of the FS or SS type, respectively (<xref ref-type="fig" rid="fig7">Figure 7</xref>). This behavior was found in the experiments by <xref ref-type="bibr" rid="bib53">Spencer et al. (2007)</xref> and we now discuss this in the article (last paragraph of the “Predicting microbial community dynamics” section).</p><p>Again, it is important to point out that all the experimental findings mentioned in points 1.-5. above were obtained in experimental co-cultures, whereas our calibration involved only monocultures, so that the subsequent MCM simulations with the calibrated strains in co-culture yield dynamics that are not part of the model assumptions, but instead is an emergent property of the MCM system. The fact that this dynamics closely corresponds to various salient experimental findings in co-culture constitutes a validation of the MCM predictions.</p><p>Regarding the invasion of the FS type in the absence of SS: Simulations predict that FS also invades in the absence of type SS, however the invasion speed is much slower and FS reaches lower densities than in the presence of the SS type. This is consistent with an early presence of the FS lineage at low densities in the evolution experiments, as reported in <xref ref-type="bibr" rid="bib28">Herron and Doebeli (2013)</xref>, indicating that some of the first FS mutations already confer a slight advantage over the ancestor when FS is rare. We now discuss these observations in the article (first paragraph of the “Predicting microbial community dynamics” section), and we have added the appropriate figures (<xref ref-type="fig" rid="fig5s1">Figure 5-figure supplement 1</xref> and <xref ref-type="fig" rid="fig3">Figure 3</xref> in the main article).</p><p>Performing additional co-culture experiments is, unfortunately, easier said than done because these experiments were performed several years ago and the appropriately skilled staff has long left our lab. Our goal is to present a novel mathematical and computational framework, and to use our wealth of pre-existing experimental data to validate its practicality and accuracy. The fact that the experiments were done beforehand, we argue, does not influence information flow nor does it compromise the validity of our arguments.</p><p><italic>Another major prediction – that was pretty cool – is that acetate is excreted during a short window of time. This would be an excellent experiment to validate the model's predictions.</italic></p><p>Previous SS-FS coculture experiments (<xref ref-type="bibr" rid="bib53">Spencer et al., 2007</xref>) have indeed shown a temporary increase of acetate concentration towards the end of the SS exponential growth phase, validating our prediction. We now mention this in the article (second paragraph of the “Predicting microbial community dynamics” section).</p><p><italic>Finally, you have to actually</italic> show <italic>us the comparison of predicted fluxes and mRNA that is supposed to be such a great fit. If it really is that good, we'd be rather impressed, for there is a huge literature about how this is not the case.</italic></p><p>Our predicted pathway activation patterns are qualitatively consistent with the mRNA measurements by <xref ref-type="bibr" rid="bib37">Le Gac et al. (2008)</xref>. That is, the upregulation of acetate consumption genes in FS and acetate production genes in SS, when compared to the ancestor, is reflected in the transcript profiles. We now elaborate more on this comparison in the manuscript (second-last paragraph of the “Predicting microbial community dynamics” section). We also added a figure comparing the predictions to the experimental data (<xref ref-type="fig" rid="fig6">Figure 6c,d</xref>). Please also see our responses to related questions by the other reviewers.</p><p><italic>2) MCM seems to be sold too hard and does not responsibly acknowledge other DFBA platforms for communities like COMETS that do nearly everything mentioned here except the statistical fitting of parameters. We rather like that extension, but it seems to be advertised as more than it is.</italic></p><p>We now modified our manuscript to include a better description of existing techniques (including COMETS; <xref ref-type="bibr" rid="bib25">Harcombe et al. 2014</xref>). We also better highlight what we think are the novelties of our work. We encourage the reviewers to look at MCM's User Manual (<xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>) to see the versatility and wealth of functionalities introduced by MCM.</p><p>For example, COMETS offers limited model versatility in terms of uptake kinetics, no gene regulation and few environmental feedback mechanisms (namely, only dynamic extracellular metabolite concentrations). Furthermore, it assumes complete knowledge of all required model parameters and provides no generic statistical model analysis. Hence, while COMETS sets an important precedent, it is of limited applicability to microbial ecological questions outside of petri dishes.</p><p>MCM extends Harcombe et al.'s approach to more versatile microbial ecological models that include, for example, arbitrary dynamical environmental variables (e.g. pH and temperature), stochastic processes, phage predation, product inhibition, arbitrary uptake kinetics, reaction energetics and gene regulation. Furthermore, MCM can perform statistical model evaluation, sensitivity analysis, Monte Carlo-based uncertainty analysis as well as automatic parameter fitting to data. We now point out these extensions in the Model section.</p><p><italic>3) Given that the authors propose their approach as broadly applicable to studying microbial communities, we think it may be important for them to comment on the realistic applicability of the method beyond</italic> E. coli <italic>wild type and mutants, or other well-annotated models.</italic></p><p>While MCM is designed for genome-based metabolic models, it can also accommodate conventional functional models in which the growth of each functional group is determined, for example, by simple Michaelis-Menten kinetics (<xref ref-type="bibr" rid="bib29">Hood et al., 2006</xref>) or the thermodynamics of biocatalyzed redox reactions (<xref ref-type="bibr" rid="bib49">Reed et al., 2014</xref>). Hence, natural microbial communities could be modeled even if annotated genomes are not available for each member species. While functional models require fewer parameters, their calibration remains a challenge (<xref ref-type="bibr" rid="bib47">Panikov and Sizova, 1996</xref>). MCM would thus also be useful to such conventional modeling efforts. We now discuss this in the Conclusions.</p><p><italic>Would their method be useful, for example, for improving models that lack precision not just at the level of uptake kinetics, but at the level of the stoichiometry itself?</italic></p><p>Thanks to MCM's design, any numerical model parameter can in principle be calibrated, provided that suitable data is available. That includes stoichiometric coefficients, uptake kinetics, extracellular transport coefficients (e.g. for O<sub>2</sub>, as in our model), cell death rates, product inhibition kinetics or environmental pH levels. We now make this more clear in the Conclusions and the Methods.</p><p><italic>Specific major concerns:</italic></p><p>Reviewer 1:</p><p><italic>1) I don't understand</italic> <xref ref-type="fig" rid="fig3"><italic>Figure 3</italic></xref><italic>. If SS released acetate under oxygen limitation (∼1/4 day after daily dilution,</italic> <xref ref-type="fig" rid="fig3"><italic>Figure 3</italic></xref> <italic>i,j), then why should acetate be accumulated that quickly – immediately after daily dilution (</italic><xref ref-type="fig" rid="fig3"><italic>Figure 3f</italic></xref><italic>)?</italic></p><p>Acetate is included in the growth medium with every dilution (see the Methods for details). In fact, the acetate produced by the SS type is only a small fraction of the total acetate present. We now make this more clear in section “Experimental calibration”, by emphasizing that the dilution is performed “into fresh glucose-acetate supplemented medium”. Please note that <xref ref-type="fig" rid="fig3">Figure 3</xref> is now renamed to <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><p><italic>2) The Introduction should clearly discuss where the field stands currently and how MCM pushes the field forward</italic>.</p><p>We now added the following to the Introduction:</p><p>“So far, the standard approach has been to obtain each parameter through laborious specific measurements or from the available literature, or to manually adjust parameters to match observations (<xref ref-type="bibr" rid="bib39">Mahadevan et al., 2002</xref>; <xref ref-type="bibr" rid="bib7">Chiu et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Harcombe et al., 2014</xref>). Furthermore, statistical model evaluation and sensitivity analysis is typically performed using ad-hoc code, thus increasing the effort required for the construction of any new model.”</p><p>We now also moved the Model section so that it immediately follows the Introduction. There we explain the underlying concepts and clarify our contributions to the field of microbial community modeling (last paragraph).</p><p><italic>I am not sure how, for example, COMETS of the Segre group could have predicted the spatial-temporal dynamics in microbial communities if they had not somehow calibrated their model</italic>.</p><p>Segre's group chose uptake kinetic parameters, as well as diffusion coefficients, to be equal for all substrates and based on typical values from the literature. Not doubting the quality of their work, we are unsure about the biological realism of such assumptions, but we prefer not to discuss this in the paper. Certainly, in many other cases a differentiation of kinetics between different metabolites and a calibration of parameters will be needed. Currently, no systematic automated method exists for estimating arbitrary model parameters.</p><p><italic>Only after I talked to an expert did I realize that usually parameter choice is done through looking for values in literature, which leaves a few tunable parameters. Then, parameters are adjusted manually to fit experimental dynamics. This is because some of these parameters may not be directly measured experimentally. A thoughtful discussion on this will be helpful</italic>.</p><p>We now discuss this in the Introduction and the Conclusions. In the Model section (last paragraph) we further elaborate on the advancements of MCM compared to COMETS.</p><p><italic>3) The end of conclusion mentioned that parameter estimation does not necessarily require monoculture measurements. This is a critical point, and should be formally demonstrated (rather than hidden in a supplementary file). For example, the authors could model the three-member community with parameters derived from cocultures of two members starting at arbitrary initial compositions. This is to mimic cases (e.g. soil microbes) where many species are not individually culturable</italic>.</p><p>We designed MCM so that it is completely irrelevant whether the fitted parameters belong to a one- or multiple-species model. Including an additional example in the main article demonstrating this would, in our opinion, not add anything new conceptually, neither is it required for the completeness of our arguments. In fact, as we explain above, our goal was to demonstrate that independent data from monoculture experiments (i.e. without knowledge of the dynamics emerging in co-culture) can be used to calibrate a model, which would then predict novel emergent dynamics of a microbial community.</p><p>We do realize that some readers might be skeptical about MCM's ability to calibrate multi-species models. Hence, we now specify the section in the supplement where the interested reader can see an elaborate example using real data. We are reluctant to include that example in the main article, because it would confuse our main example of the <italic>E. coli</italic> evolution experiment. We would be happy to create a separate supplementary section focused on such an example, if the editors or reviewers believe that is appropriate.</p><p>We have recently completed a separate project where we use MCM to study the stability of microbial communities in bioreactors. That work is based on calibration of a multi-species model to real data, and has recently been submitted for review in another journal.</p><p><italic>4) The flow of the paper is suboptimal, especially to an outside reader. For example, you can move “MCM overview” to immediately after the Introduction</italic>.</p><p>We have now restructured the manuscript in line with the reviewer's suggestions. We now introduce the model framework (in particular FBA and DFBA) and MCM's principles right after the Introduction. We then introduce the microbial evolution experiments. We still keep a more technical “MCM overview” section in the Methods.</p><p><italic>You may also want to add concrete examples to your figures to demonstrate how MCM works in reality</italic>.</p><p>We have now added appropriate comments to the MCM overview figure and its legend (<xref ref-type="fig" rid="fig2">Figure 2</xref> in the revised manuscript). We hope that the Methods section and our extensive MCM User Manual (<xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>) will provide sufficient information to the interested reader.</p><p>Reviewer 2:</p><p><italic>1) The novelty of this work is mainly in the combination of different approaches and data, rather than in the approaches and data themselves. I find fascinating that the model recapitulates the observations, and that model-predicted fluxes are consistent with previously measured gene expression data. However, it is not clear to me what aspects of the insight provided by the model were not known or suspected before, given that extensive work was done on this system</italic>.</p><p>Our main contribution is the computational framework, MCM, which combines microbial community model construction with statistical model evaluation, sensitivity analysis and automated, statistically rigorous calibration to data. The versatility and functionalities of MCM are discussed and demonstrated throughout our paper. We now elaborate more on the novelties of MCM compared to existing techniques (e.g. in the Introduction and the Model sections).</p><p>Furthermore, to the best of our knowledge, this is the first time that monocultures of multiple strains were used to calibrate individual FBA models, which were then combined into a microbial community to predict the dynamics emerging in co-culture.</p><p>We go through some lengths to show that this approach, and MCM for that matter, is capable of correctly predicting the dynamics of microbial communities, both in terms of population dynamics as well as pathway activation patterns and metabolic fluxes (e.g. periodic acetate production by SS). In view of the conventional approach for obtaining model parameters (see Introduction), we expect that systematic model calibration as demonstrated in our paper will find widespread use in microbial systems biology.</p><p>In terms of the results on the <italic>E. coli</italic> system, we agree that our paper is mainly a synthesis. While most of the results have been found experimentally over the course of several years, it is only now that a mechanistic model has managed to unify many of them in such a clear, unambiguous and synergistic manner. These modeling results provide very strong credence to a large body of experimental work that was done in our lab over the course of roughly a decade.</p><p>To conclude, as we focus mainly on methodological novelties and synthesis, our paper is better suited as a Tools and Resources paper. As suggested, we have adjusted our title accordingly.</p><p><italic>2) As mentioned above, I like the calibration approach. However, I think that some important information is missing. First, there should be a table (fine as supplementary) detailing the values of fitted parameters, and any available comparative values from the literature (only a few examples are provided in the Methods section). Also: is the fitted ATP maintenance the value for the non-growth associated maintenance</italic>, <italic>or the coefficients of growth-associated maintenance?</italic></p><p>The fitted ATP maintenance is the non-growth associated maintenance, in terms of ATP molecules per unit time. The appropriate “loss reaction” is part of the <italic>E. coli</italic> FBA model template, published by <xref ref-type="bibr" rid="bib63">Yoon et al. (2012)</xref>. Growth-associated maintenance is incorporated as inefficiencies of biomass synthesis from precursors biomolecules. We now make that more clear in the Methods section. We have also included a table listing the fitted parameters (Supplementary file 3), as suggested by the reviewer.</p><p>The value of non-growth associated maintenance energy was calibrated, along with the other model parameters, using the available monoculture data. For clarification, in general fitted parameters need not be directly connected to the data used for calibration, as long as a change of the parameters influences the variables that are being compared to the data. This is a general principle of parameter estimation, which is further exemplified in the MCM user manual (e.g. section 2.6). However, the uncertainty of calibrated parameters increases when their influence on the “goodness of fit” is weaker.</p><p><italic>Second, it would important for readers to know whether the solutions found by the fitting algorithm are unique, and how sensitive the result are to parameter precision. Sensitivity analyses are discussed in the user manual, and seem to have been applied to a different microbial community. I think it would be particularly important to know whether the main result of stable coexistence is sensitive to the choice of fitted parameters</italic>.</p><p>To reduce the possibility of only reaching a local maximum, fitting was repeated 100 times for each strain starting at random initial parameter values and the best fit among all 100 runs was used (MCM handles this automatically). While some fitting runs reached alternative local maxima, the best overall fit was reached in most cases. We have now added this information to the Methods section.</p><p>We also analyzed the sensitivity of stable SS-FS coexistence in co-culture by randomly choosing each fitted parameter within an interval spanning 10% below and 10% above its calibrated value. In 50 out of 50 random simulations both types coexisted. We now mention this in the Methods section and have added an appropriate figure to the supplement (<xref ref-type="fig" rid="fig5s2">Figure 5-figure supplement 2</xref>).</p><p>Reviewer 3:</p><p><italic>1) The text reads that “these observations are in exact agreement with microarray transcriptional profiles”. Given the strength of “exact agreement”, I was very surprised that there was no display of experiment versus model. This was a major finding, but no figures or statistical analysis of what “exact” means</italic>.</p><p>FBA makes predictions about reaction rates, and a correlation with mRNA levels is expected to be at most qualitative, not quantitative.</p><p>Our choice of wording was unfortunate, and we now corrected it to emphasize the qualitative nature of the agreement. That is, the upregulation of acetate consumption genes in FS and acetate production genes in SS, when compared to the ancestor, is reflected in the mRNA profiles. We now elaborate this comparison in the manuscript (at the end of the “Predicting microbial community dynamics” section). We also added a figure comparing the predictions to the experimental data (<xref ref-type="fig" rid="fig6">Figure 6c,d</xref>).</p><p><italic>A related point: it is claimed that “MCM also makes predictions about gene densities” because each flux is associated with an enzyme. This is actually a fairly ludicrous claim. There have been paper after paper showing that, not only can there be a lack of correlation between flux and enzyme activity, they can even be negatively correlated. This is a central tenet of Metabolic Control Analysis, and has been well documented and commented upon by folks such as Dan Fraenkel (2003, Current Opinion in Microbiology) and Hans Westerhoff (Rossell et al., 2006. PNAS). This possibility must be addressed to make the reader aware that there should never be the assumption that flux is proportionally related to enzyme levels for all enzymes. If that were so, every enzyme would have a control coefficient of 1, which is absolutely impossible because the sum of control coefficients from the entire cell is 1</italic>.</p><p>We appreciate the reviewer's (correct) observation. To clarify, we do not assume that flux is correlated with enzyme activity in any way. Predictions about gene densities (i.e. gene copies per liter) made by MCM are based on predicted cell densities and the number of gene copies per cell. Hence, for example, the density of the <italic>amo</italic> gene (associated with aerobic ammonium oxidation) would be the sum of cell densities for all cell species capable of producing the <italic>amo</italic> enzyme (i.e., in the context of FBA, capable of potentially performing the <italic>amo</italic> reaction) multiplied by the number of <italic>amo</italic> gene copies per cell. Gene copies can be different across cell species. This is explained in detail in the MCM user manual. We now also make that more clear in the manuscript (“MCM overview” section in the Methods).</p><p>Of course, the very assumption that each reaction corresponds to one gene via one enzyme can be questioned, e.g. when protein complexes are encoded by several genes. Hence, the final interpretation or use of MCM's predictions about gene densities should be case-dependent and subject to the user's judgment.</p><p><italic>Returning to the point above, then, if there really is a good quantitative correlation between the array data from the Le Gac work and the DFBA model here – for matching timepoints as the mRNA was harvested – it would be quite a nice finding. This analysis is absolutely essential to the paper</italic>.</p><p>We now elaborate on that comparison in more detail. We also added a figure, which directly compares our predictions with Le Gac's results (<xref ref-type="fig" rid="fig6">Figure 6c,d</xref>). To clarify, we do not claim a quantitative correlation exists between reaction rates and mRNA concentrations. Rather, our predictions on the upregulation of acetate production genes in SS and acetate consumption genes in FS, when compared to the ancestor, are consistent with analogous changes in mRNA levels. We now make that more clear.</p><p><italic>2) An advance stated is MCM itself. I am not sold upon exactly how this is really a major advance beyond a variety of other DFBA approaches, including prior work on communities. For example, a very large number of MCM features that are described in a way that comes across as them being novel also exist in COMETS (2014, Cell Reports). At the very least, acknowledge where this is so, and use it as an opportunity to more precisely say where this goes above and beyond. For example, I like the inherent fitting of data and perhaps more could be made of exactly how this works. COMETS does not use fitting to each substrate, and frankly an objective means to parameterize when canonical parameters fail to work well is a nice step</italic>.</p><p>As mentioned in our responses to Reviewer 1, in contrast to COMETS, MCM can accommodate more versatile microbial ecological models that include, for example, dynamical environmental variables (such as pH or temperature, that can change in response to microbial metabolism), stochastic processes, phage predation, product inhibition, arbitrary uptake kinetics, reaction energetics and gene regulation. Furthermore, MCM can perform statistical model evaluation and sensitivity analysis, as well as automatic parameter fitting to data.</p><p>In the Model section (last two paragraphs) we now compare our work to previous DFBA approaches, and in particular COMETS, and we further emphasize the importance of MCM's fitting capacities in the Conclusions section. We now also elaborate more on the fitting algorithms used by MCM in the Methods section.</p><p><italic>[Editors' note: further revisions were requested prior to acceptance, as described below.]</italic></p><p>Reviewer 1:</p><p><italic>For this to be a useful Tools and Resources article, I'd still like to see a discussion on MCM's limitations and requirements in the main text. For example, what is enough data for calibrating a model? Under what situations will MCM give you several solutions and what do you do in this case? What should be avoided or advocated when using MCM? You probably discussed these in the manual, but it will be helpful to summarize the main points in the text.</italic></p><p>The amount of required data is highly case-specific and indeed a non-trivial question that cannot be answered in general. MCM calibrations will always be subject to the same fundamental limitations as other non-linear inverse problems. We now added a discussion of the points raised by the reviewer, in the “MCM overview” section: “In this paper single-cell models were calibrated to monoculture experiments […] MCM models are thus limited by the same caveats and assumptions as other constraint-based metabolic models (<xref ref-type="bibr" rid="bib3">Blazier and Papin, 2012</xref>; <xref ref-type="bibr" rid="bib2">Antoniewics, 2013</xref>) and any predictions made by MCM should be subject to similar scrutiny.”</p><p>Reviewer 2:</p><p><italic>The authors have overall addressed my concerns, partially by answering the issues raised, partially by transforming their work into a Tools and Resources</italic>.</p><p><italic>There are still two points that need some revision:</italic></p><p><italic>1) Even if biological insight is no more the main focus of the paper, I still think that the authors could explain a little bit in the Introduction why people may care about the specific example they study. For example, I like the following rebuttal of the authors to one of the questions: “While most of the results have been found experimentally over the course of several years, it is only now that a mechanistic model has managed to unify many of them in such a clear, unambiguous and synergistic manner. These modeling results provide very strong credence to a large body of experimental work that was done in our lab over the course of roughly a decade.” I think that a slightly expanded version of this text would help orient the broad readership towards understanding why their example is interesting (in addition to the fact that it works)</italic>.</p><p>We now finish the Introduction with the following passage: “To demonstrate the potential of MCM, we modeled a bacterial community that has emerged from in-vitro evolution experiments […] a large body of experimental work that was done in our lab over the course of roughly a decade.”</p><p><italic>2) Most importantly, I think that in talking about their software, as well as previous tools, the authors should be very careful to clearly distinguish between features that ere possible (currently or in principle) in the different tools, vs. features that are actually presented in detail and tested in the manuscript. I am referring in particular to the last paragraph in the subsection “Model”, which is quite problematic in a number of ways. For example, regulation (both allosteric and transcriptional) in FBA models is notoriously a very tricky, overall unresolved problem. MCM has the potentially useful feature of allowing users to set rules to limit fluxes as a function of other parameters. This feature, described in one page in the user manual, is oversold in the main text as a capacity of MCM to include regulation. Similarly superficial is the description of the inclusion of phages in the model. Again, this is described shortly in the user manual with no justification or testing. All these features are unnecessarily used as a way of contrasting MCM with previous software, leading to unjustified conclusions, e.g. that COMETS “offers limited model versatility in terms of uptake kinetics” (COMETS does allow different parameters for different molecules and organisms, even if parameters were chosen to be equal in the specific simulations presented in the COMETS paper), that COMETS “seems limited to Petri dishes”, whereas “MCM can be used to understand the dynamics of realistic microbial communities, ranging from the soil or groundwater to artificial communities and bioreactors”. Both COMETS and MCM, after all, were based on the same underlying modeling framework, and tested on laboratory systems. I think the authors should definitely mention (with added accuracy) – perhaps in the Discussion – the additional features of their software that are not described and tested in detail in the main text. At the same time, I think they should limit their claims of major innovation to the components that are actually tested and presented in detail. The capacity to perform calibration on individual organisms, followed by proof of predictive capacity of the global dynamics on a highly interesting system is elegant and brilliant, and I think it is unnecessarily weakened by these other dubious claims</italic>.</p><p>Regarding gene regulation:</p><p>Incorporating post-transcriptional or post-translational gene regulation in FBA models is indeed tricky for fundamental reasons, and we likely have overstated MCM's potential to that end. The incorporation of gene regulation into MCM models follows published regulatory FBA approaches (<xref ref-type="bibr" rid="bib10">Covert et al., 2001</xref>; <xref ref-type="bibr" rid="bib9">Covert and Palsson, 2002</xref>; <xref ref-type="bibr" rid="bib8">Covert et al., 2004</xref>; Herrgard et al., 2006) that have been shown to improve the fidelity of <italic>E. coli</italic> and <italic>S. cerevisiae</italic> FBA models, but are yet to be tested at the microbial community level. Hence, the underlying theory is definitely not our innovation, and MCM merely provides a convenient tool for constructing and calibrating such models. We now clarify this in the last paragraph of the “Model” section. We also further explain regulatory FBA and non-stationary cell models in the MCM User Manual.</p><p>Regarding COMETS:</p><p>We would like to clarify that while COMETS does indeed allow different parameters for different molecules and organisms, the assumed kinetics are all the same, namely single-substrate Michaelis-Menten uptake kinetics (with an optional Hill coefficient) and constant reaction rate bounds. More complicated kinetics, or multi-substrate dependencies, or environmental influences (such as effects of temperature or pH) are simply not possible. We have now rephrased our conclusions on COMETS to the following: “Hence, while COMETS sets an important precedent, considerable work is still needed to make DFBA a practical approach in microbial ecosystem modeling.” We have also adjusted the remaining text in that paragraph (last paragraph of the “Model” section), where we explain the main distinguishing features of MCM.</p><p>Regarding MCM's untested features:</p><p>At the end of the day MCM is a framework facilitating the construction, analysis and calibration of microbial ecosystem models. MCM's versatility should thus be understood in terms of possible model structures and possible couplings between components (e.g. environment-cell coupling). The actual model will always be subject to the user's choice. Hence, for example, saying that MCM “supports phage predation” is merely a claim that MCM supports model structures that have conventionally been used to model phage predation (at the population level; for an example see <xref ref-type="bibr" rid="bib31">Jensen et al., 2006</xref>). Similarly, when we say “MCM supports reaction energetics” this means that MCM allows for the calculation of free energies and their incorporation into models (e.g. influencing growth factors), regardless of how this is used in any particular case (for an example see <xref ref-type="bibr" rid="bib49">Reed et al., 2014</xref>).</p><p>We now make this clear in the “MCM overview” section, saying: “Finally, we emphasize that MCM is, after all, merely a framework enabling the construction, calibration and analysis of microbial community models. MCM models are thus limited by the same caveats and assumptions as other constraint-based metabolic models (<xref ref-type="bibr" rid="bib3">Blazier and Papin, 2012</xref>; <xref ref-type="bibr" rid="bib2">Antoniewicz, 2013</xref>) and any predictions made by MCM should be subject to similar scrutiny.”</p><p>Furthermore, to avoid confusion, we omit several of MCM's features from the main text. For the ones kept, we refer to existing literature that demonstrates their potential use.</p><p>Reviewer 3:</p><p><italic>First off, I strongly agree with Reviewer 2's comments above. They have done much to improve the paper to show more and fix much of the language. As noted, however, saying why this matters in the paper as well as they did in the rebuttal would be great, and they still need to back down from hyping a large series of bells and whistles that may be great features but are not demonstrated here. There are plenty of nice advances in their method and they should stick to these</italic>.</p><p>We have now further emphasized the significance of our experimental system in the Introduction. We also rephrased the comparison of MCM to previous tools in a more conservative way. Please see our responses to Reviewer 2 for details.</p><p><italic>As for my own concerns, the direct comparison to data and clarification that expression and flux should not be expected to perfectly correlate is a massive relief. The qualitative agreement is not bad in</italic> <xref ref-type="fig" rid="fig6"><italic>Figure 6c and d</italic></xref><italic>, and can rest on its own laurels. The figures are also particularly improved in their clarity</italic>.</p><p><italic>I still find the concept of an “average flux” over such a dynamic experiment to be strange, but at least it is now explained. Using the same time point as the RNA data is</italic> far <italic>better</italic>.</p><p>For the comparison of predicted pathway activations to transcript microarray profiles (<xref ref-type="fig" rid="fig6">Figure 6c and d</xref>) we do indeed use the same time points as the RNA data. We now make that more clear by ending the figure caption as follows: “Flux predictions correspond to the time points of mRNA measurements, i.e. 3.5 hours after dilution for SS and 4 hours after dilution for A and SS (<xref ref-type="bibr" rid="bib37">Le Gac et al., 2008</xref>).”</p></body></sub-article></article>