<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">51810</article-id><article-id pub-id-type="doi">10.7554/eLife.51810</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Genetics and Genomics</subject></subj-group></article-categories><title-group><article-title>Attacks on genetic privacy via uploads to genealogical databases</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-156874"><name><surname>Edge</surname><given-names>Michael D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8773-2906</contrib-id><email>edgem@usc.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-19147"><name><surname>Coop</surname><given-names>Graham</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8431-0302</contrib-id><email>gmcoop@ucdavis.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Center for Population Biology</institution><institution>University of California, Davis</institution><addr-line><named-content content-type="city">Davis</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Evolution and Ecology</institution><institution>University of California, Davis</institution><addr-line><named-content content-type="city">Davis</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Quantitative and Computational Biology, Department of Biological Sciences</institution><institution>University of Southern California</institution><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role>Reviewing Editor</role><aff><institution>Austrian Academy of Sciences</institution><country>Austria</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>McCarthy</surname><given-names>Mark I</given-names></name><role>Senior Editor</role><aff><institution>Genentech</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>07</day><month>01</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e51810</elocation-id><history><date date-type="received" iso-8601-date="2019-09-12"><day>12</day><month>09</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-12-23"><day>23</day><month>12</month><year>2019</year></date></history><permissions><copyright-statement>© 2020, Edge and Coop</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Edge and Coop</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-51810-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.54467"/><abstract><p>Direct-to-consumer (DTC) genetics services are increasingly popular, with tens of millions of customers. Several DTC genealogy services allow users to upload genetic data to search for relatives, identified as people with genomes that share identical by state (IBS) regions. Here, we describe methods by which an adversary can learn database genotypes by uploading multiple datasets. For example, an adversary who uploads approximately 900 genomes could recover at least one allele at SNP sites across up to 82% of the genome of a median person of European ancestries. In databases that detect IBS segments using unphased genotypes, approximately 100 falsified uploads can reveal enough genetic information to allow genome-wide genetic imputation. We provide a proof-of-concept demonstration in the GEDmatch database, and we suggest countermeasures that will prevent the exploits we describe.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>identity by state</kwd><kwd>identity by descent</kwd><kwd>genetic genealogy</kwd><kwd>genetic privacy</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>GM108779</award-id><principal-award-recipient><name><surname>Coop</surname><given-names>Graham</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>GM130050</award-id><principal-award-recipient><name><surname>Edge</surname><given-names>Michael D</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Direct-to-consumer genetic genealogy services that allow users to upload their own datasets are vulnerable to attacks on genetic privacy that exploit the structure of genetic variation.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>As genotyping costs have fallen over the last decade, direct-to-consumer (DTC) genetic testing (<xref ref-type="bibr" rid="bib34">Hogarth et al., 2008</xref>; <xref ref-type="bibr" rid="bib35">Hogarth and Saukko, 2017</xref>; <xref ref-type="bibr" rid="bib45">Khan and Mittelman, 2018</xref>) has become a major industry, with over 26 million people enrolled in the databases of the five largest companies (<xref ref-type="bibr" rid="bib68">Regalado, 2019</xref>). One of the major applications of DTC genetics is genetic genealogy. Customers of companies such as 23andMe and Ancestry, once they are genotyped, can view a list of other customers who are likely to be genetic relatives. These putative relatives’ full names are often given, and sometimes contact details are given as well. Such genealogical matching services are of interest to people who want to find distant genetic relatives to extend their family tree, and can be particularly useful to people who otherwise may not have information about their genetic relatives, such as adoptees or the biological children of sperm donors. Several genetic genealogy services—including GEDmatch, MyHeritage, FamilyTreeDNA, and LivingDNA (<xref ref-type="table" rid="table1">Table 1</xref>)—allow users to upload their own genetic data if they have been genotyped by another company. These entities generally offer some subset of their services at no charge to uploaders, which helps to grow their databases. Upload services have also been used by law enforcement, with the goal of identifying relatives of the source of a crime-scene sample (<xref ref-type="bibr" rid="bib24">Erlich et al., 2018</xref>; <xref ref-type="bibr" rid="bib23">Edge and Coop, 2019</xref>), prompting discussion about genetic privacy (<xref ref-type="bibr" rid="bib74">Syndercombe Court, 2018</xref>; <xref ref-type="bibr" rid="bib65">Ram et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Kennett, 2019</xref>; <xref ref-type="bibr" rid="bib70">Scudder et al., 2019</xref>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Key parameters for several genetic genealogy services that allow user uploads as of July 26th, 2019.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Service</th><th>Database size (millions)</th><th>Individuals shown</th><th>IBS/IBD Segments Reported</th></tr></thead><tbody><tr><td>GEDmatch</td><td>1.2</td><td>3000 closest matches shown free; Unlimited w/ $10/month license; any two kits can be searched against each other</td><td>Yes if longer than user-set threshold. Min. threshold 0.1 cM, default 7 cM</td></tr><tr><td>FamilyTreeDNA</td><td>1*</td><td>All that share at least one 9 cM block or one 7.69 cM block and 20 total cM</td><td>Yes, down to 1 cM, for $19 per kit</td></tr><tr><td>MyHeritage</td><td>3</td><td>All that share at least one 8 cM block</td><td>Yes, down to 6 cM, for $29 per kit or unlimited for $129/year. Customers may opt out</td></tr><tr><td>LivingDNA</td><td>Unknown</td><td>Putative relatives out to about 4th-cousin range</td><td>Only sum length of matching segments reported</td></tr><tr><td>DNA.LAND**</td><td>0.159</td><td>Top 50 matches shown with minimum 3 cM segment</td><td>Yes</td></tr></tbody></table><table-wrap-foot><fn><p>*Although <xref ref-type="bibr" rid="bib68">Regalado (2019)</xref> reports that FamilyTreeDNA has two million users, he also suggests that only about half of these are genotyped at genome-wide autosomal SNPs, which is in line with other estimates (<xref ref-type="bibr" rid="bib48">Larkin, 2018</xref>).</p><p>**DNA.LAND has discontinued genealogical matching for uploaded samples as of July 26th, 2019.</p></fn></table-wrap-foot></table-wrap><p>The genetic signal used to identify likely genealogical relatives is identity by descent (IBD, [<xref ref-type="bibr" rid="bib9">Browning and Browning, 2012</xref>; <xref ref-type="bibr" rid="bib75">Thompson, 2013</xref>]. We use 'IBD’ to indicate both 'identity by descent’ and 'identical by descent', depending on context). Pairs of people who share an ancestor in the recent past can share segments of genetic material from that ancestor. The distribution of IBD sharing as a function of genealogical relatedness is well studied (<xref ref-type="bibr" rid="bib20">Donnelly, 1983</xref>; <xref ref-type="bibr" rid="bib39">Huff et al., 2011</xref>; <xref ref-type="bibr" rid="bib9">Browning and Browning, 2012</xref>; <xref ref-type="bibr" rid="bib75">Thompson, 2013</xref>; <xref ref-type="bibr" rid="bib12">Buffalo et al., 2016</xref>; <xref ref-type="bibr" rid="bib17">Conomos et al., 2016</xref>; <xref ref-type="bibr" rid="bib67">Ramstetter et al., 2018</xref>), and DTC genetics entities can use information about the number and length of inferred IBD segments between a pair of people to estimate their likely genealogical relationship (<xref ref-type="bibr" rid="bib73">Staples et al., 2016</xref>; <xref ref-type="bibr" rid="bib66">Ramstetter et al., 2017</xref>). These shared segments—IBD segments—result in the sharing of a near-identical stretch of chromosome (a shared haplotype). Shared haplotypes can most easily be identified looking for long genomic regions where two people share at least one allele at nearly every locus.</p><p>For the rest of the main text, we focus on identical-by-state (IBS) segments, which are genomic runs of (near) identical sequence shared among individuals and can be thought of as a superset of true IBD segments. Very long IBS segments, say over 7 centiMorgans (cM), are likely to be IBD, but shorter IBS segments, say &lt;4 cM, may or may not represent true IBD due to recent sharing—they may instead represent a mosaic of shared ancestry deeper in the past. Many of the algorithms for IBD detection that scale well to large datasets rely principally on detection of long IBS segments, at least as their first step (<xref ref-type="bibr" rid="bib29">Gusev et al., 2009</xref>; <xref ref-type="bibr" rid="bib33">Henn et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Huang et al., 2014</xref>). We consider the effect on our results of attempting to distinguish IBS and IBD in supplementary material.</p><p>Many DTC genetics companies, in addition to sharing a list of putative genealogical relatives, give customers information about their shared IBS with each putative relative, possibly including the number, lengths, and locations of shared genetic segments (<xref ref-type="table" rid="table1">Table 1</xref>). This IBS report may represent substantial information about one’s putative relatives—one already has access to one’s own genotype, and so knowing the locations of IBS sharing with putative relatives reveals information about those relatives’ genotypes in those locations (<xref ref-type="bibr" rid="bib32">He et al., 2014</xref>). Users of genetic genealogy services implicitly or explicitly agree to this kind of genetic information sharing, in which large amounts of genetic information are shared with close biological relatives and small amounts of information are shared with distant relatives.</p><p>Here, we consider methods by which it may be possible to compromise the genetic privacy of users of genetic genealogy databases. In particular, we show that for services where genotype data can be directly uploaded by users, many users may be at risk of sharing a substantial proportion of their genome-wide genotypes with any party that is able to upload and combine information about several genotypes. We consider two major tools that might be used by an adversary to reveal genotypes in a genetic genealogy database. One tool available to the adversary is to upload real genotype data or segments of real genotype data. When uploading real genotypes, the information gained comes by virtue of observed sharing between the uploaded genotypes and genotypes in the database (an issue also raised by <xref ref-type="bibr" rid="bib47">Larkin, 2017</xref>). Publicly available genotypes from the 1000Genomes Project (<xref ref-type="bibr" rid="bib1">Abecasis et al., 2012</xref>), Human Genome Diversity Project (<xref ref-type="bibr" rid="bib13">Cann et al., 2002</xref>), OpenSNP project (<xref ref-type="bibr" rid="bib27">Greshake et al., 2014</xref>), or similar initiatives might be uploaded.</p><p>A second tool available to the adversary is to upload artificial genetic datasets (<xref ref-type="bibr" rid="bib54">Ney et al., 2018</xref>). In particular, we consider the use of artificial genetic datasets that are tailored to trick algorithms that use a simple, scalable method for IBS detection, that of identifying long segments in which a pair of genomes contains no incompatible homozygous sites (<xref ref-type="bibr" rid="bib33">Henn et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Huang et al., 2014</xref>). Such artificial datasets can be designed to reveal the genotypes of users at single sites of interest or sufficiently widely spaced sites genome-wide. We describe how a set of a few hundred artificial datasets could be designed to reveal enough genotype information to allow accurate imputation of common genotypes for every user in the database.</p><p>Below, we describe these procedures and illustrate them using either publicly available or artificial data. We show that under some circumstances, many users could be at risk of having their genotypes revealed, either at key positions or at many sites genome-wide. In particular, we show that GEDmatch, as of mid-December 2019, was vulnerable to an attack we term IBS baiting that obtains genotype data via artificial data uploads. Our results are largely complementary to the independent work of <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref>, which was first posted publicly within a week of the first public posting of this manuscript on bioRxiv. In the discussion, we consider our work in light of other genetic privacy concerns (<xref ref-type="bibr" rid="bib25">Erlich and Narayanan, 2014</xref>; <xref ref-type="bibr" rid="bib53">Naveed et al., 2015</xref> and the work of <xref ref-type="bibr" rid="bib55">Ney et al., 2020</xref>), and we give some suggested practices that DTC genetics services can adopt to prevent privacy breaches by the techniques described here.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We describe three general methods for revealing the genotypes of users in genetic genealogy databases that allow uploads. The first, IBS tiling, involves uploading many real genotypes in order to identify genotype information from many regions in many people. The second, IBS probing, involves uploading a dataset containing a long haplotype that includes an allele of interest, creating matches at this locus. Genotypes at other places in the genome are chosen to be unlikely to generate IBS with any user in the database, so matches with the uploaded dataset are likely to be users who carry the allele of interest. The third method, IBS baiting, involves uploading fake datasets with long runs of heterozygosity to induce phase-unaware methods for IBS calling to reveal genotypes.</p><sec id="s2-1"><title>IBS tiling</title><p>In IBS tiling, the genotype information shared between a target user in the database and each member of a set of comparison genomes is aggregated into potentially substantial information about the target’s genotypes. For example, consider a user of European ancestries. She is likely to have some degree of IBS sharing with a large set of people from across Europe (<xref ref-type="bibr" rid="bib64">Ralph and Coop, 2013</xref>) and beyond. If one knows the user’s IBS sharing locations with one random person of European ancestries (and the random person’s genotype), then one can learn a little about the user’s genotype. But if one can upload many people’s genotypes for comparison, then one can uncover small proportions of the target user’s genotypes from many of the comparison genotypes, eventually uncovering much of the target user’s genome by virtue of a ‘tiling’ of shared IBS with known genotypes (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Similar ideas have been suggested with application to IBD-based genotype imputation (<xref ref-type="bibr" rid="bib15">Carmi et al., 2014</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Schematics of the IBS tiling and IBS probing procedures.</title><p>(<bold>A</bold>) In IBS tiling, multiple genotypes are uploaded (green lines) and the positions at which they are IBS with the target (represented by blue lines) are recorded. Once enough datasets have been uploaded, the target will eventually have a considerable proportion of their genome 'tiled’ by IBS with uploads that have known genotypes. (<bold>B</bold>) In IBS probing, the uploaded probe consists of a haplotype carrying an allele of interest (red dot) surrounded by 'IBS-inert’ segments (purple dashed lines)—fake genotype data designed to be unlikely to share any IBS regions with anyone in the database. In the event of an IBS match in the database, the matching database entry is likely to carry the allele of interest.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig1-v2.tif"/></fig><p>We consider the amount of IBS tiling possible within a set of publicly available genotypes for 872 people of European origin genotyped at 544,139 sites. We phased the sample using Beagle 5.0 (<xref ref-type="bibr" rid="bib8">Browning and Browning, 2007</xref>) and used Refined IBD software (<xref ref-type="bibr" rid="bib10">Browning and Browning, 2013</xref>) to identify IBS segments (see Materials and methods). In the main text, we include IBS segments that are not particularly likely to be IBD—these are IBS segments returned by Refined IBD with relatively low LOD scores for IBD, between 1 and 3. True IBD segments reveal more than mere IBS segments about shared genotypes because untyped variants (including rare variants) within an IBD segment are likely to be shared. At the same time, mere IBS is sufficient to infer sharing for SNPs that are genotyped within the segment.</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref> shows the median amount of coverage obtainable by IBS tiling as a function of comparison sample size, imposing various restrictions on the minimum segment length in cM. (For similar results, see Figure 2b of <xref ref-type="bibr" rid="bib15">Carmi et al., 2014</xref> and Figure 2 of <xref ref-type="bibr" rid="bib58">Panoutsopoulou et al., 2014</xref>) Approximately 2.8 Giga base-pairs (Gbp) were covered by IBS segments anywhere in the genome; we take this to be approximately the maximum possible genomic length recoverable by IBS with our SNP set. Using the entire sample (871 genotypes, since the target is left out) and including all called IBS segments &gt;1 cM, the median person has an average of 60% of the maximum length of 2.8 Gbp covered by IBS segments (with the average taken across their two chromosomes), and sites across 82% of this length have at least one of two alleles recoverable by IBS tiling. Increasing the cM threshold required for reporting substantially reduces the amount of IBS tiling. With a cutoff of 3 cM, approximately 6.9% of the median person’s genotype information is recoverable, including at least one of two alleles at sites in 11% of the genome. When a more stringent cutoff of 8 cM is used, only 1% of the genome has at least one of two alleles recoverable for the median person when using a comparison sample of 871. Our reports for segments longer than 3 cM may be conservative because Refined IBD sometimes splits long IBS segments into multiple shorter segments in the presence of phasing errors (<xref ref-type="bibr" rid="bib10">Browning and Browning, 2013</xref>; <xref ref-type="bibr" rid="bib6">Bjelland et al., 2017</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Lengths of genome in Giga base-pairs (Gbp) covered by IBS tiling as a function of minimum required length of IBS segments in centiMorgans (cM) and size of a randomly selected comparison sample for the median person in our dataset.</title><p>The top-left panel shows the average coverage across each of the person’s two haplotypes. The top-right shows IBS2 coverage, the length of genome where both haplotypes are covered by IBS tiles. The bottom-left panel shows IBS1, the length of genome where exactly one haplotype is covered by IBS tiles. (IBS1 coverage can decrease at larger comparison sample sizes because IBS2 coverage increases). The bottom-right panel shows IBS1+ coverage, the length of genome covered by either IBS1 or IBS2.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>IBS tiling performance.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-51810-fig2-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Tiling performance with IBS segments that are unlikely to be IBD filtered out.</title><p>Conventions are the same as in <xref ref-type="fig" rid="fig2">Figure 2</xref>; the difference is that now only IBS segments that represent likely IBD (LOD score &gt;3) are included. As expected, the amount of tiling possible is reduced when the LOD score threshold is increased, particularly when segments as short as 1 cM are allowed. However, tiling still reveals a substantial amount of information about target genotypes. Using a comparison sample of 871, and including all called IBS segments &gt;1 cM, the median person has an average of 35% of the maximum length of 2.8 Gbp covered by IBD segments with LOD &gt;3, and has at least one chromosome covered for approximately 57% of the genome. If only segments &gt;3 cM are included, then averaging across the two chromosomes, median coverage is 5.0%, and the median proportion for which at least one chromosome is covered is 9.5%. As before, the percentage of the genome recoverable by tiling varies among people, and some people still have large proportions of their genetic data recoverable by tiling. With a LOD score threshold of 3, the top 10% of people have at least 58% of their total genotype information covered by IBD tiles, including one or more alleles at sites in at least 81% of the genome covered by IBD tiles.</p><p><supplementary-material id="fig2s1sdata1"><label>Figure 2—figure supplement 1—source data 1.</label><caption><title>Tiling performance with IBS segments that are unlikely to be IBD filtered out.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-51810-fig2-figsupp1-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>IBS tiling performance, limiting to comparison samples who share at least 1 IBS segment of 8 cM or more with the target.</title><p>Conventions are the same as in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Some DTC genetics companies use a two-step approach for reporting IBS information to users. For example, at this writing, MyHeritage identifies people who are likely matches of a given user as all those who share an apparent IBD segment of at least 8 cM with the user. However, once matches are identified, inferred IBD segments down to a minimum length of 6 cM are reported to the user (see <xref ref-type="table" rid="table1">Table 1</xref>). Similarly, FamilyTreeDNA only reports matching segments for pairs of people who pass a sharing threshold, and for those pairs of individuals they report all matches down to 1 cM. As expected, reporting only IBS segments for pairs of people who share at least one long IBS segment (&gt;8 cM) substantially reduces but does not eliminate the effectiveness of IBS tiling. With 872 comparison samples, the median person has approximately 12% of their genome covered by IBS tiles of 1 cM or more (averaged across both chromosomes) and at least one chromosome covered for 21% of the genome. People in the top 10% of IBS tiling coverage have 44% of their genome length recoverable by tiling (averaging across both chromosomes), with at least one chromosome tiled over more than 67% of the genome. Importantly, the practice of requiring at least one long IBS match in order to report any IBS segments will not reduce the effectiveness of IBS tiling if phase-unaware methods are used for calling IBS. In that case, the attacker could simply insert a long run of heterozygous sites in each of the genomic datasets uploaded, causing an apparent long run of IBS with every user in the database (see section 'IBS baiting’). After getting 'in the door’ with a long run of heterozygous sites, the attacker could then use tiling to find out about the rest of the genome.</p><p><supplementary-material id="fig2s2sdata1"><label>Figure 2—figure supplement 2—source data 1.</label><caption><title>IBS tiling performance, limiting to comparison samples who share at least 1 IBS segment of8cMor more with the target.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-51810-fig2-figsupp2-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>IBS tiling performance when genotype phasing switches are disallowed.</title><p>Conventions are the same as in the <xref ref-type="fig" rid="fig2">Figure 2</xref>. We called IBS segments using Germline (<xref ref-type="bibr" rid="bib29">Gusev et al., 2009</xref>), using the haploid flag to find IBS segments within the phased chromosomes produced by Beagle. We also set the err_hom argument to zero, set the bits argument to 32 to increase sensitivity for short segments, used the w_extend flag to extend segments beyond the slices produced by Germline, and set the minimum IBS segment length to 1 cM. (Setting the minimum segment length shorter than 1 cM does not appear to be possible in Germline). The amount of tiling possible is reduced somewhat when phase switches are disallowed. However, tiling still reveals substantial information about target genotypes. Using a comparison sample of 871, and including all called IBS segments &gt;1 cM, the median person has an average of 57% of the maximum length of 2.8 Gbp covered by IBS segments, and has at least one chromosome covered for approximately 79% of the genome. If only segments &gt;3 cM are included, then averaging across the two chromosomes, median coverage is 6.5%, and the median proportion for which at least one chromosome is covered is 11%. The top 10% of people have at least 73% of their genomes covered by IBS tiles of 1 cM or more, including one or more alleles at sites in at least 91% of the genome covered by IBS tiles.</p><p><supplementary-material id="fig2s3sdata1"><label>Figure 2—figure supplement 3—source data 1.</label><caption><title>IBS tiling performance when genotype phasing switches are disallowed.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-51810-fig2-figsupp3-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>IBS tiling performance in selected populations.</title><p>We examined IBS tiling performance in four European populations from the 1000Genomes data—Finnish in Finland (FIN, top left, 99 people), British in England and Scotland (GBR, top right, 91 people), Iberian in Spain (IBS, bottom left, 107 people), and Toscani in Italia (TSI, bottom left, 107 people). In all panels, median average IBS tiling coverage is shown on the vertical axis using refinedIBD with LOD&gt;1, as in the top-left panel of <xref ref-type="fig" rid="fig2">Figure 2</xref>. Median tiling accuracy varies among populations. For example, using IBS tiles &gt;1 cM and with all 871 other individuals used in the comparison sample, the median coverage percentages by population were 79% (FIN), 63% (GBR), 55% (IBS), and 51% (TSI). The most striking population difference is the higher IBS tiling rates attained among Finns, who have long been of interest as a founder population, having experienced a bottleneck approximately 100 generations ago (<xref ref-type="bibr" rid="bib44">Kere, 2001</xref>). Another factor that likely influences these results is the genetic similarity of members of each population to members of other populations included—for example, the CEU population of 1000Genomes is closely related to the GBR population, and the inclusion of CEU may partially account for the higher tiling rates in GBR than in IBS or TSI.</p><p><supplementary-material id="fig2s4sdata1"><label>Figure 2—figure supplement 4—source data 1.</label><caption><title>IBS tiling performance in selected populations.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-51810-fig2-figsupp4-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>IBS tiling performance in terms of number of total alleles covered (left panel) and number of minor alleles covered (right panel, 18.6% of total alleles were minor alleles).</title><p>We used Germline in haploid mode (as in <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>), as it allows easier identification of which allele is covered by a given IBS segment. Dashed lines show the results in terms of fraction of base pairs covered, whereas the solid lines show results in terms of alleles covered. Results for cM cutoffs &lt;1 are not shown because they cannot be run in Germline, and results for cM cutoffs &gt;3 are not shown because it is difficult to distinguish the dashed and solid lines. As would be expected, there is a slight bias for IBS tiles to fall in regions with lower SNP density, leading to slightly fewer alleles on the chip being covered than would be expected on the basis of total base pairs covered. For example, with a 1 cM cutoff and all samples included, the median is 57% of the genome length in base pairs covered by IBS tiles, whereas the median proportion of total alleles covered by IBS tiles is 55%. It also appears that IBS tiles may be more likely to appear in regions that are less genetically diverse, as the proportion of minor alleles tiled is slightly lower than the proportion of total alleles covered. For example, with a 1 cM cutoff and all samples included, the proportion of minor alleles covered by IBS tiles is 52%.</p><p><supplementary-material id="fig2s5sdata1"><label>Figure 2—figure supplement 5—source data 1.</label><caption><title>IBS tiling performance in terms of number of total alleles covered (left panel) and number of minor alleles covered.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-51810-fig2-figsupp5-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig2-figsupp5-v2.tif"/></fig></fig-group><p>For some people, the amount of information obtainable by IBS tiling is even larger. In our sample, the top 10% of people have genotypes across 76% of their total genome covered by IBS tiles, including one or more alleles at sites in at least 93% of the 2.8 Gbp covered by IBS tiles anywhere. If only segments longer than 3 cM are reported, the top 10% of people have one or both alleles covered at sites in at least 38% of the total, and if only segments longer than 8 cM are reported, the top 10% have one or both alleles covered at sites in at least 6% of the total.</p><p>The coverage obtained by IBS tiling and its informativeness about target genotypes depends on the specific practices used for reporting IBS information (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref>–<xref ref-type="fig" rid="fig2s5">5</xref>). For example, DTC genealogy services may take additional steps to ensure that any short segments reported are likely to be IBD, not merely IBS. Such steps will tend to decrease the amount of IBS tiling possible, particularly for short segments (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). As another example, some DTC genealogy services only report matching segments for pairs of people who share at least one long IBS segment (<xref ref-type="table" rid="table1">Table 1</xref>), but then allow users to see shorter IBS segments (&gt;1cM) for those pairs of people. Unsurprisingly, we find that this strategy allows a higher level of IBS tiling than if only long segments are revealed (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>), because people who share a long IBS segment may also share shorter segments that are hidden if only long segments are reported.</p><p>In this demonstration of IBS tiling, we used haplotype information provided by the Refined IBD software to determine which haplotypes were covered by IBS in each person. Most genetic genealogy services that provide information on the location of IBS matches with putative relatives do not provide haplotype information, making it difficult to distinguish IBS1 (in which one chromosome is covered by an IBS segment) and IBS2 (in which both chromosomes are covered by IBS segments). One tool available to an adversary pursuing IBS tiling is to upload genotype information that is homozygous at all sites using one of two phased haplotypes as a basis, effectively searching for IBS with one chromosome at a time. In the presence of phasing errors, some IBS segments may be missed, and the assumption that phase is known would render the coverage rates in <xref ref-type="fig" rid="fig2">Figure 2</xref> overestimates. At the same time, the decrease in tiling performance is small for short segments, which can be seen by conducting our test of IBS tiling using Germline software with the haploid flag, which causes putative IBS segments to terminate with a single phasing error (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). It may remain difficult to distinguish some cases—such as distinguishing IBS1 from IBS2 with a run of homozygosity on the database genotype—but there will be no question about which uploaded haplotype is IBS with the database genotype. Thus, at any point where a homozygous upload and a target are IBS, at least one of the target’s alleles is known. Further, if the target is IBS with any other uploaded datasets at a genetic locus of interest, it will often be possible to infer the target’s full genotype.</p><p>IBS tiling rates vary somewhat by population, with Finnish samples showing the highest tiling rates among the 1000Genomes populations included (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). There also appear to be slight biases for IBS tiles to appear in regions with low SNP density and lower heterozygosity, meaning that the proportion of alleles—and particularly the proportion of minor alleles—recovered by tiling is typically slightly lower than the proportion of the genome length in Mbp covered (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>).</p></sec><sec id="s2-2"><title>IBS probing</title><p>IBS probing is an application of the same idea underlying IBS tiling. By IBS probing, one could identify people with specific genotypes of interest, such as risk alleles for Alzheimer’s disease (<xref ref-type="bibr" rid="bib18">Corder et al., 1993</xref>), even if the DTC service does not report chromosomal locations of IBS matches. To identify people carrying a particular allele at a locus of interest, one could use haplotypes carrying the allele in publicly available databases. To do so, one would extract a haplotype that surrounds the allele of interest and place it into a false genetic dataset designed to have no long IBS segments with any real genomes (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Thus, any returned putative relatives must match at the allele of interest, revealing that they carry the allele. We call this attack ‘IBS probing’ by analogy with hybridization probes, as the genuine haplotype around the allele of interest acts as a probe. Whereas IBS tiling recovers genetic information from across the genome, IBS probing acts only on a single locus of interest. The advantage is that IBS probing is possible even in databases that do not report the chromosomal locations of IBS segments.</p><p>There are several ways of generating chromosomes unlikely to have long shared segments with any entries in the database. One simple way is to sample alleles at each locus in proportion to their frequencies. Chromosomes generated in this way are free of linkage disequilibrium (LD) and thus unlike genuine chromosomes. If the database distinguishes between IBS and IBD, then these fake data are unlikely to register as IBD with any genuine haplotypes. However, they may appear as IBS in segments where genetic diversity is low, depending on the length threshold used by the database. Near-zero rates of IBS can be obtained by generating more unusual-looking fake data, such as by sampling alleles from one minus their frequency or by generating a dataset of all minor alleles.</p><p><xref ref-type="fig" rid="fig3">Figure 3</xref> shows a demonstration of IBS probing performance in our set of 872 Europeans in a window around the APOE locus. For a 1-cM threshold for reporting IBS, we generated probes by retaining 1.9 cM of real data around a site of interest in the APOE locus from all 872 people. Outside that 1.9-cM window, we generated data by drawing alleles randomly (see Materials and methods). For a 3-cM threshold for reporting IBS, we generated probes by retaining 5.9 cM of real data around the site of interest. With 1-cM matching, 1497 of 1744 haplotypes (86%) matched one of the probes at the site of interest. (Target haplotypes were not allowed to match probes constructed from the same person that carried the target haplotype). With 3-cM matching, 164 of 1744 haplotypes (9.4%) matched one of the probes at the site of interest. Very few matches occurred outside the region of interest—none with a 3-cM threshold and only 0.1% of matches with a 1-cM threshold. Moreover, we generated different inert genotypes for all 872 probes, and the great majority of these had no matches with any real sample. An adversary would only need to generate one inert dataset, which can be tested by uploading to the database and confirming that no matches are returned. Probes could then be constructed by stitching real haplotypes at the site of interest into the the same set of inert data. The probes would then be likely to match each other, but the adversary would know those identities and could ignore those matches.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>A demonstration of the IBS probing method around position 45411941 on chromosome 19 (GRCh37 coordinates), in the APOE locus.</title><p>We show the proportion of haplotypes among the 872 Europeans in our sample covered IBS by probes constructed from the sample, as a function of the chromosomal location in a 10-Mb region around the site of interest. In red, we show the coverage using a 1-cM threshold for reporting IBS, where the probes are constructed using real data in a 1.9-cM region centered on the site of interest (region boundaries shown in dashed orange). In orange, we show the coverage using a 3-cM threshold for reporting IBS, where the probes are constructed using real data in a 5.9-cM region around the site of interest.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>IBS probing with including only segments with LOD&gt;3.</title><p>A demonstration of the IBD probing method around position 45411941 on chromosome 19 (GRCh37 coordinates), in the APOE locus. Conventions are the same as in <xref ref-type="fig" rid="fig3">Figure 3</xref>; the difference is that only IBS segments with a LOD score &gt;3 for IBD are included. When IBD probing is performed with a 1-cM threshold, 9.6% of haplotypes had a match among the probes constructed from the other 871 people in the dataset. With a 3-cM threshold, 9.2% of haplotypes had a match. .</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>IBS probing using Germline (<xref ref-type="bibr" rid="bib29">Gusev et al., 2009</xref>) in haploid mode.</title><p>A demonstration of the IBS probing method around position 45411941 on chromosome 19 (GRCh37 coordinates), in the APOE locus. Conventions are the same as in <xref ref-type="fig" rid="fig3">Figure 3</xref>; the difference is that IBS calling was performed by Germline (<xref ref-type="bibr" rid="bib29">Gusev et al., 2009</xref>) in haploid mode, meaning that phasing switches are disallowed. We set the err_hom argument to zero, we used the w_extend flag to extend segments beyond the slices produced by Germline, and we set the minimum IBS segment length to 1-cM. All other arguments were kept at their default values. When IBS probing is performed with a 1-cM threshold, 67.5% of haplotypes had a match among the probes constructed from the other 871 people in the dataset. With a 3 cM threshold, 0.2% of haplotypes had a match.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig3-figsupp2-v2.tif"/></fig></fig-group><p>The efficacy of IBS probing will depend on the minimum IBS-match length reported to users, the specific methods used for identifying IBS segments (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplements 1</xref>–<xref ref-type="fig" rid="fig3s2">2</xref>), and whether the genotype of interest is included on the SNP chip. These factors vary in terms of whether they affect the sensitivity of IBS probing—the proportion of people carrying the allele of interest returned by a probe or set of probes—or the precision of IBS probing—the proportion of people returned by a probe who in fact carry the genotype of interest. For example, high thresholds for IBS reporting will mean that uploaded genotypes will need to have long IBS segments with targets at the locus of interest. Long IBS segments are likely to represent relatively close genealogical relatives (i.e. long IBS segments are likely to be IBD segments), and not many targets will be close relatives of the source of any given haplotype of interest, meaning that the sensitivity of IBS probing is reduced by reporting thresholds that require long IBS segments. If the locus of interest or a highly correlated one is not included on the chip used to genotype either the uploaded sample or the target sample, then probing may only expected to work well if the upload and the target are truly IBD rather than merely IBS, reducing the precision of IBS probing for variants that are not genotyped. Limiting probing results to likely IBD matches will decrease the number of matches returned, particularly for short cM thresholds (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p><p>Another factor that will affect the success of IBS probing is the frequency of the allele of interest. For example, if the allele of interest is very rare, then it is likely to be only somewhat enriched on the haplotypes that tend to carry it, and reported matches may not actually carry the allele, even if they are IBD with an uploaded haplotype that carries it. IBS probing will perhaps be most sensitive and precise when the allele of interest is both common and relatively young, as is the case for founder mutations. In this case, most carriers of the allele will share the same long haplotype around the site of interest, meaning that fewer probes would need to be uploaded in order to learn the identities of the majority of the carriers in the database.</p></sec><sec id="s2-3"><title>IBS baiting</title><p>IBS tiling and IBS probing take advantage of publicly available genotype data. The idea of both is that an adversary uploads genuine genetic datasets—or, in the case of IBS probing, datasets with genuine segments—to learn about entries in the database that share segments with the uploaded genomes.</p><p>In this section, we describe an exploit called IBS baiting. The specific strategy for IBS baiting that we describe is possible if the database identifies putative IBS segments by searching for long regions where a pair of people has no incompatible homozygous sites. An incompatible homozygous site is a site at which one person in the pair is homozygous for one allele, and the other person is homozygous for the other allele. Identifying IBS segments in this way does not require phased genotypes and scales relatively easily to large datasets—we refer to methods in this class as 'phase-unaware’ and contrast them with phase-aware methods for IBS detection. Phase-unaware methods are robust to phasing errors, which are an issue for long IBD segments (<xref ref-type="bibr" rid="bib21">Durand et al., 2014</xref>). Major DTC genetics companies have used phase-unaware methods in the past for IBS detection (<xref ref-type="bibr" rid="bib33">Henn et al., 2012</xref>; <xref ref-type="bibr" rid="bib37">Hon et al., 2013</xref>), and some state-of-the-art IBD detection and phasing pipelines feature an initial phase-unaware step (<xref ref-type="bibr" rid="bib38">Huang et al., 2014</xref>; <xref ref-type="bibr" rid="bib51">Loh et al., 2016</xref>).</p><p>The main tool used in IBS baiting is the construction of apparently IBS segments by assigning every uploaded site in the region to be heterozygous. (SNPs with missing data may also be included in these regions). These runs of heterozygosity, which are unlikely to occur naturally (unlike runs of homozygosity, [<xref ref-type="bibr" rid="bib52">McQuillan et al., 2008</xref>; <xref ref-type="bibr" rid="bib60">Pemberton et al., 2012</xref>]), will be identified as IBS with every genome in the database using phase-unaware methods: because they contain no homozygous sites at all, they cannot contain homozygous sites incompatible with any person in the database.</p><p>Here, we consider a database in which an apparent IBS segment is halted exactly at the places at which the first incompatible homozygous site occurs on each side of the segment. We also assume that the database detects all segments without incompatible homozygous sites that pass the required length threshold. <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref> independently proposed a similar approach in their section VII ‘Genetic Marker Extraction Using Matching Segments,’ showing that GEDmatch was vulnerable to it. Similarly, we demonstrate below that IBS baiting can be implemented against GEDmatch.</p><sec id="s2-3-1"><title>Single-site IBS baiting</title><p>The simplest application of IBS baiting is to use it to reveal genotypes at a single site. If IBS is identified by looking for single incompatible homozygous sites and missing data can be ignored, then users’ genotypes at any single biallelic site of interest can be determined by examining their putative IBS with each of two artificial datasets (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). In each artificial dataset, the site of interest is flanked by a run of heterozygosity. The combined length of these two runs of heterozygosity must exceed the minimum length of IBS segment reported by the database. The adversary uploads two datasets with these runs of heterozygosity in place. In one dataset, the site of interest is homozygous for the major allele, and in the other, the site of interest is homozygous for the minor allele. If the target user is homozygous at the site of interest, then one of these two uploads will not show a single, uninterrupted IBS segment—IBS will be interrupted at the site of interest (or may not be called at all). If the IBS segment with the dataset homozygous for the major allele is interrupted, then the target user is homozygous for the minor allele. Similarly, if the IBS segment with the dataset homozygous for the minor allele is interrupted, then the target user is homozygous for the major allele. If both uploads show uninterrupted IBS segments with the target, then the target user is heterozygous at the site of interest. Thus, for any genotyped biallelic site of interest, the genotypes of every user shown as a match can be revealed after uploading two artificial datasets. Depending on how possible matches are made accessible to the adversary, the genotypes of every user could be returned. Genotypes of medical interest that are often included in SNP chips, such as those in the APOE locus (<xref ref-type="bibr" rid="bib18">Corder et al., 1993</xref>), are potentially vulnerable to single-site IBS baiting.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Schematics of the IBS baiting procedure.</title><p>(<bold>A</bold>) To perform IBS baiting at a single site, two uploads are required, each with runs of heterozygous genotypes flanking the key site. At the key site, the two uploaded datasets are homozygous for different alleles. The three possible target genotypes at the key site can each be determined by examining their IBS coverage with the uploads. If there is a break in IBS with either upload, then the target is homozygous for the allele not carried by the upload that shows the break in IBS (with the broken IBS segment shown as a cyan line). If there is no break in IBS with either upload, then the target is heterozygous at the key site. (<bold>B</bold>) Target genotypes at many key sites across the genome can be learned by comparison with two uploaded datasets, as long as key sites are spaced widely enough.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig4-v2.tif"/></fig><p>Here, we have considered a database using the simplest possible version of a phase-unaware method for detecting IBS, that in which an apparent IBS segment is halted exactly at the places at which the first incompatible homozygous site occurs on each side of the segment. In principle, phase-unaware IBS-detection algorithms can be altered to allow for occasional incompatible homozygous sites before halting as an allowance for genotyping error, or the extent of the reported region might be modified to be less than the full range between incompatible homozygous sites. Versions of IBS baiting might be developed to work within such modifications. The key insight is that if two artificial kits differ at exactly one site in a region and they produce two different patterns of called IBS with a target, then the target’s genotype is revealed at that site. For example, if a database uses a phase-unaware method for IBS calling that requires two incompatible homozygous sites before a putative IBS segment is halted, then an attacker might modify our scheme by putting in a rare homozygote at a site near the key site. For most target users, the rare homozygote in the uploaded files would be an incompatible homozygous site, implying that a mismatch at the key site will cause a break in a putative IBS region. By using different homozygote genotypes nearby, an attacker might still identify the genotypes of everyone in the database at the key site. As discussed below, such measures do not appear to be necessary to perform IBS baiting in GEDmatch. Further, in GEDmatch, uploading a third bait dataset with a missing genotype at the key site can distinguish targets with missing genotypes from heterozygous targets.</p><p>Single-site IBS baiting could also be used if chromosomal locations of matches are not reported. To do so, one would use the the scheme we describe in a large region surrounding the locus of interest and use fake IBS-inert segments to fill in the rest of the dataset.</p></sec><sec id="s2-3-2"><title>Parallel IBS baiting</title><p>The second method we consider applies the IBS baiting technique to many sites in parallel (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). By parallel application of IBS baiting, users’ genotypes at hundreds or thousands of sites across the genome can be identified by comparison with each pair of artificial genotypes. By repeated parallel IBS baiting, eventually enough genotypes can be learned that genotype imputation becomes accurate, and genome-wide genotypes could in principle be imputed for every user in the database. If IBS segments as short as 1 cM are reported to the user, then accurate imputation (97–98% accuracy) becomes possible after comparison with only about 100 uploaded datasets. The procedure starts by designing a single pair of uploaded files as follows:</p><list list-type="order"><list-item><p>Identify a set of key sites to be revealed by the IBS baiting procedure. For every key site, the sum of the distances in cM to the nearest neighboring key site on each side (or the end of the chromosome, if there is no flanking key site on one side) must be at least the minimum IBS length reported by the database.</p></list-item><list-item><p>Produce two artificial genetic datasets. In each, every non-key site is heterozygous. In one, each key site is homozygous for the major allele, in the other, each key site is homozygous for the minor allele.</p></list-item><list-item><p>Upload each artificial dataset and compare them to a target user. Key sites that are covered by putative IBS segments between the target and both artificial datasets are heterozygous in the target. The target is homozygous for the major allele at key sites that are covered by putative IBS segments between the target and the major-allele-homozygous dataset only. Similarly, the target is homozygous for the minor allele at key sites that are covered by putative IBS segments between the target and the minor-allele-homozygous dataset only.</p></list-item></list><p>Carrying out this procedure reveals the target’s genotype at every key site. If IBS segments of length at least <inline-formula><mml:math id="inf1"><mml:mi>t</mml:mi></mml:math></inline-formula> cM are reported, and a chromosome is <inline-formula><mml:math id="inf2"><mml:mi>c</mml:mi></mml:math></inline-formula> cM long, then up to <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mi>c</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> key sites can be revealed with each pair of uploaded files. (To see this, consider the case where <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf5"><mml:mi>k</mml:mi></mml:math></inline-formula> a positive integer, and place key sites at <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. This calculation ignores the possibility of missing data at key sites in the target). This means that with a minimum reported IBS threshold of 1 cM, 100 uploaded datasets could reveal approximately 100 genotypes per cM, which is enough to impute genome-wide genotypes at 97 - 98% accuracy (<xref ref-type="bibr" rid="bib71">Shi et al., 2018</xref>). In principle, the key sites could also be chosen to ensure good LD coverage and higher imputation accuracy. Of course, higher accuracy imputation can be obtained by recovering exact genotypes for more sites, and with several thousand uploads, the genotypes at every genotyped site could be revealed by IBS baiting without the need to impute.</p></sec><sec id="s2-3-3"><title>IBS baiting in GEDmatch</title><p>We hypothesized that IBS baiting would work in the GEDmatch DTC database. GEDmatch provides no public documentation of the IBS algorithm they use, but IBS segments identified by GEDMatch seem to terminate only on incompatible homozygous sites, as would be expected if they use phase-unaware IBS detection. Specifically, the GEDmatch 1-to-1 match tool identifies the locations of IBS segments between pairs of genetic datasets ('kits’ in GEDMatch terminology) and allows the user to specify the minimum genetic length and minimum number of matching SNPs to include in a segment. The 1-to-1 tool also returns a ‘full resolution’ picture of the chromosome that appears to be a SNP-by-SNP picture of the match between the kits along each chromosome. (These pictures are themselves a major security risk. We alerted GEDmatch to the risk in a July 24th email (posted here: <ext-link ext-link-type="uri" xlink:href="https://github.com/mdedge/IBS_privacy/blob/master/IBS_baiting_demo/GEDmatch_emails.pdf">https://github.com/mdedge/IBS_privacy/blob/master/IBS_baiting_demo/GEDmatch_emails.pdf</ext-link>) but did not analyze them further. <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref> showed in detail that the images provided by GEDmatch allow an adversary to learn the full genotype of a target person).</p><p>To demonstrate IBS baiting in GEDmatch, we uploaded a small number of artificial genotypes to their database beginning in late November 2019. These kits were designed in accordance with the algorithm discussed above, but with some slight alterations to bypass counter-measures that GEDMatch has put in place since we (and, independently, Ney and colleagues) informed them of the risk of IBS baiting in summer 2019. Before uploading any data to GEDmatch, we first confirmed our planned procedure with the UC Davis IRB and with GEDmatch representatives. We uploaded our kits into the GEDmatch ‘research’ and not ‘public’ category to prevent matches to the public database, and only used the 1-to-1 IBS match tool among our own uploaded test kits. In this way, we avoided interacting with any genotype data of real GEDmatch users and did not violate GEDmatch’s terms and conditions.</p><p>We targeted four random SNPs along chromosome 22 for IBS baiting. We uploaded two bait genotype kits (B1 and B2) that had opposite-homozygote genotypes at each of these key SNPs. Each key SNP was in turn surrounded by a ∼1cM stretch of SNPs containing genotypes that were either heterozygoous or coded missing. The rest of the genome was specified to be IBS-inert. We then uploaded three target genotype datasets whose genotypes we wanted to determine at the key sites. Two of these target kits (T1 and T3) had opposite-homozygous genotypes at each of the key SNPs, while the third (T2) was heterozygous at each key SNP. (See subsection 'GEDmatch demonstration’ in the Materials and methods for more details on the kit design). We then used the GEDmatch 1-to-1 match tool, choosing the parameters so a single opposite-homozygous genotype between a bait and target kit would interrupt a putative IBS segment.</p><p>In each case, our two bait kits had the correct IBS patterns with the target kits, allowing correct determination of the target genotypes by IBS baiting. On the left of <xref ref-type="fig" rid="fig5">Figure 5</xref>, we show a zoomed-in view of the three targets’ matches around one of the key SNP sites. The homozygous targets have IBS matches with only one of the bait kits, whereas the heterozygous target has IBS matches with both bait kits. This pattern is seen across all four target regions (right side of <xref ref-type="fig" rid="fig5">Figure 5</xref>, see section 'GEDmatch demonstration’ of the Materials and methods for more detailed results). The target and bait kits displayed in <xref ref-type="fig" rid="fig5">Figure 5</xref> were uploaded and analyzed on December 15, 2019, showing that GEDmatch has remained vulnerable to IBS-baiting attacks even after its acquisition by Verogen, which was announced on December 9, 2019.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Visualization of IBS baiting using GEDmatch’s 1-to-1 chromosome browser.</title><p>Left: Zoomed-in view of the region containing key SNP 1, showing the three target kits (T1–T3) matched to the two bait kits (<bold>B1 and B2</bold>). Right: Zoomed-out views of regions containing all four key SNPs on chromosome 22. For each pair of bait and target kits, the top rectangle (red, yellow, or green) shows the GEDmatch SNP-level pairwise genotype-match image (colored to show no match, half match, or full match) returned by the 1-to-1 GEDmatch tool. The bottom rectangle (black and blue) shows the GEDmatch IBD-track image, black for no putative IBD match, blue regions showing putative IBD segments. The white text on the IBS track is not provided by GEDmatch and was added as a guide to the eye. Opposite-homozygote calls at the key SNP are seen in the left panel as a red line in an otherwise matching region (yellow and green). The spatial positions of SNPs in the match panel appears to have been jittered; for example the location of the red line varies slightly in the different plots that should have the same coordinate system (perhaps as a countermeasure against a <xref ref-type="bibr" rid="bib55">Ney et al., 2020</xref>-style attack).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51810-fig5-v2.tif"/></fig></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We have suggested several methods by which an adversary might learn the genotypes of people included in a genetic genealogy database that allows uploads. Our methods take advantage of both the population-genetic distributions of IBS segments and of methods used for calling IBS. In particular, IBS tiling works simply because there are background levels of IBS (and IBD) even among distantly related members of a population (e.g. <xref ref-type="bibr" rid="bib64">Ralph and Coop, 2013</xref>). In our dataset, the median person had the majority of their genetic information susceptible to IBS tiling on the basis of other members of the dataset, depending on the procedures used for reporting IBS. IBS tiling performance will also depend on the ancestries of the target and comparison samples because IBD rates differ within and among populations (<xref ref-type="bibr" rid="bib57">Palamara et al., 2012</xref>; <xref ref-type="bibr" rid="bib14">Carmi et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Ralph and Coop, 2013</xref>), as well as on the prevalence of close biological relatives in the dataset. IBS tiling performance improves as the size of the comparison sample increases. Thus, if enough genomes are compared with a target for IBS, eventually a substantial amount of the target genome is covered by IBS with one or more of the comparison genomes.</p><p>IBS probing combines the principles behind IBS tiling with the idea of 'IBS-inert’ artificial segments. If the majority of the genome—everywhere except a locus of interest—can be replaced with artificial segments that will not have IBS with any genome in the database, then the adversary knows that any matches identified are in a locus of interest. As such, IBS probing could be used to reveal sensitive genetic information about database participants even if chromosomal locations of matches are not reported to users.</p><p>Finally, IBS baiting exploits phase-unaware IBS calling algorithms that use incompatible homozygous sites to delimit putative IBS regions. Although such methods can be useful in genetic genealogy because they scale well to large data, they are vulnerable to fake datasets that include runs of heterozygous sites, which will be identified as IBS with everyone in the database. By inserting homozygous genotypes at key sites and heterozygotes everywhere else, we estimate that approximately 100 well-designed uploads could reveal enough genotypes to impute genome-wide information for any user in a database, provided that the threshold for reporting a matching segment is approximately 1 cM. Similarly, two uploads could reveal any genotype at a single site of interest, such as rs429358, which reveals whether the user carries an APOE-ε4 variant and is associated with risk of late-onset Alzheimer’s disease.</p><p>There are millions of people enrolled in genetic genealogy databases that allow uploads (<xref ref-type="table" rid="table1">Table 1</xref>). Genetic genealogy has many applications, and uploads are popular with users who want to find relatives who may be scattered across different databases. Though allowing uploads brings several benefits for both customers and DTC services, it also entails additional privacy risks. Users of DTC genetic genealogy services that allow uploads could be at risk of having their genetic information extracted by the procedures we describe here, depending on the methods that these services use to identify and report IBS. Concerns arising from the methods we report are in addition to standard digital security concerns. The attacks we describe require little special expertise in computing; the adversary only needs to be able to procure or create the appropriate data files and to process and aggregate the information returned from the database.</p><p>We have not set out to determine precisely how vulnerable users of each specific DTC service are. We do not know the full details of methods used by each service for matching, nor have we attempted to deanonymize any real users’ genotypes. We contacted representatives of each of the organizations listed in <xref ref-type="table" rid="table1">Table 1</xref> 90 days (July 24th, 2019) before posting this manuscript publicly in order to give them time to repair any security vulnerabilities related to the methods we describe. We have posted our emails to GEDmatch representatives here: <ext-link ext-link-type="uri" xlink:href="https://github.com/mdedge/IBS_privacy/blob/master/IBS_baiting_demo/GEDmatch_emails.pdf">https://github.com/mdedge/IBS_privacy/blob/master/IBS_baiting_demo/GEDmatch_emails.pdf</ext-link>.</p><p>On the basis of our results, we do have serious concerns about the privacy of GEDmatch users. As of this writing, GEDmatch uses length thresholds for displaying matching segments that are too short, allowing for effective IBS tiling attacks, and GEDmatch also appears to use phase-unaware IBD detection methods, allowing for IBS baiting attacks. Additionally, as detailed by <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref>, whose work was independent of ours, GEDmatch provides users with high-resolution images comparing the chromosomes of any two users at SNP-level resolution, allowing for reconstruction of a target’s genotype using these images. GEDmatch was recently purchased by Verogen, a forensic genetics company, but as of December 15, 2019, GEDmatch has not as yet prevented the attacks we describe. Since our and <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref>’s initial communications with GEDmatch in July, GEDmatch has placed a reCAPTCHA on its upload and 1-to-1 tool forms. Though reCAPTCHA may deter bulk bot attacks to harvest large numbers of kit genotypes, it is still possible for a human to carry out small-scale attacks. Further, even as reCAPTCHA has improved at blocking non-human users in recent years, new attacks have been developed to bypass reCAPTCHA (<xref ref-type="bibr" rid="bib4">Baecher et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Brown et al., 2017</xref>; <xref ref-type="bibr" rid="bib76">Zhou et al., 2018</xref>; <xref ref-type="bibr" rid="bib2">Akrout et al., 2019</xref>). As we outline below, there are simple steps that could be taken to make IBS attacks much less of a risk.</p><p>In our estimation, the other active services listed in <xref ref-type="table" rid="table1">Table 1</xref> (MyHeritage, FamilyTreeDNA, and LivingDNA) are likely substantially less vulnerable than GEDmatch to the attacks we describe here. LivingDNA does not provide a chromosome browser, precluding IBS tiling attacks. MyHeritage and FamilyTreeDNA use thresholds for revealing matching segment locations that make IBS tiling much less efficient. (However, FamilyTreeDNA’s practice of showing matches as short as 1 cM given that two people share at least one long match is still somewhat permissive, see <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Representatives of MyHeritage, FamilyTreeDNA, and LivingDNA have confirmed to us that their IBD-calling algorithms rely on phased data, which should preclude IBS baiting. (We have not tested this ourselves). DTC genetic genealogy is a growing field, and any new entities that begin offering upload services may also face threats of the kind we describe.</p><p>Genetic genealogy databases that allow uploads have been in the public eye recently because of their role in long-range familial search strategies recently adopted by law enforcement. In long-range familial search, investigators seek to identify the source of a crime-scene sample by identifying relatives of the sample in a genetic genealogy database that allows uploads. Searching in SNP-based genealogy databases allows the detection of much more distant relationships than does familial searching in traditional forensic microsatellite datasets (<xref ref-type="bibr" rid="bib69">Rohlfs et al., 2012</xref>), vastly increasing the number of people detectable by familial search (<xref ref-type="bibr" rid="bib24">Erlich et al., 2018</xref>; <xref ref-type="bibr" rid="bib23">Edge and Coop, 2019</xref>). At this writing, both GEDmatch and FamilyTreeDNA have been searched in this way. Long-range familial search raises a range of privacy concerns (<xref ref-type="bibr" rid="bib74">Syndercombe Court, 2018</xref>; <xref ref-type="bibr" rid="bib65">Ram et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Kennett, 2019</xref>; <xref ref-type="bibr" rid="bib70">Scudder et al., 2019</xref>). One response from advocates of long-range search has been to note that 'raw genetic data are not disclosed to law enforcement… Search results display only the length and chromosomal location of shared DNA blocks’ (<xref ref-type="bibr" rid="bib28">Greytak et al., 2018</xref>). However, the methods we describe here illustrate that there are several ways to reveal users’ raw genetic data on the basis of the locations of shared DNA blocks. Because companies that work with law enforcement on long-range familial searching—including Parabon Nanolabs and Bode Technology (<xref ref-type="bibr" rid="bib43">Kennett, 2019</xref>)—now routinely upload tens of datasets to genetic genealogy databases, they may be accidentally accumulating information that would allow them to reconstruct many people’s genotypes.</p><p>Data breaches via IBS tiling, IBS probing, and IBS baiting are preventable. We have identified a set of strategies that genetic genealogy services could adopt to protect their genotype data from IBS-based attacks. We give a detailed list of these strategies in Appendix A (also summarized in <xref ref-type="table" rid="table2">Table 2</xref>). Broadly, the suggestions consist of restrictions on they types of datasets that can be uploaded, restrictions on the kinds of information shared with users, and restrictions on classes of methods used for identifying putative IBD segments. For example, to prevent IBS tiling, the simplest measures are either to forgo the use of a chromosome browser feature or only to show users the positions of long IBS segments, such as segments of at least 8 cM. To prevent IBS baiting, the most robust countermeasure is to phase data before identifying IBS segments, allowing only relatively few phase switches in any putative segment. Phasing the data and only reporting long segments both decrease the uncertainty of IBD calls and so may improve user experience as well. Finally, we also support the strategy of requiring encrypted signatures on uploaded files, proposed by <xref ref-type="bibr" rid="bib24">Erlich et al. (2018)</xref>, which would allow DTC databases to block any files that do not originate from trusted sources. Some of our suggestions limit the potential uses of genetic genealogy data, and users will vary in the degree to which they value these potential uses and in the degree to which they want to protect their genetic information.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Potential countermeasures against the methods of attack outlined here, with their likely effectiveness against IBS tiling, IBS probing, and IBS baiting.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Strategy</th><th>Prevents IBS tiling</th><th>Prevents IBS probing</th><th>Prevents IBS baiting</th></tr></thead><tbody><tr><td>Require cryptographic signature from genotyping service</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>Restrict reporting of IBS to long segments (e.g. &gt;8 cM)</td><td>Partially</td><td>Partially</td><td>Weakly</td></tr><tr><td>Report number and lengths of IBS segments but not locations</td><td>Yes</td><td>No</td><td>Partially</td></tr><tr><td>Block homozygous uploads</td><td>Partially</td><td>No</td><td>No</td></tr><tr><td>Report small number of matching individuals per kit</td><td>Partially</td><td>Partially</td><td>Partially</td></tr><tr><td>Disallow matching between arbitrary kits</td><td>Partially</td><td>Partially</td><td>Partially</td></tr><tr><td>Block uploads of publicly available genomes</td><td>Partially</td><td>No</td><td>No</td></tr><tr><td>Block uploads with evidence of IBS-inert segments</td><td>No</td><td>Yes</td><td>No</td></tr><tr><td>Block uploads with long runs of heterozygosity</td><td>No</td><td>No</td><td>Partially</td></tr><tr><td>Use phase-aware methods for IBS detection</td><td>No</td><td>No</td><td>Yes</td></tr></tbody></table></table-wrap><p>All these suggestions assume that genealogy services will maintain raw genetic data for people in their database. Another possibility would be for individual people instead to upload an encrypted version of their genetic data, with relative matching performed on the encrypted datasets, as has been suggested previously (<xref ref-type="bibr" rid="bib32">He et al., 2014</xref>).</p><p>Our IBS tiling and IBS probing results focus on users of European ancestries, in part because most users of DTC genetic genealogy services appear to have substantial European ancestries. (DTC genetics companies generally do not release this kind of information on their users, but their research papers suggest that they have access to especially large samples with European ancestries—for example, a 23andMe paper on demography in the United States included almost 150,000 self-described European Americans and less than 10,000 each of self-described African Americans and Latino Americans [<xref ref-type="bibr" rid="bib11">Bryc et al., 2015</xref>]. For a qualitatively similar sample composition in a study from Ancestry, see <xref ref-type="bibr" rid="bib31">Han et al. (2017)</xref>. One question is how these results would generalize to other populations. Because IBD sharing is generally greater within populations than between populations (e.g. <xref ref-type="bibr" rid="bib64">Ralph and Coop, 2013</xref>), potential users are more vulnerable if there are more publicly available genomes from people with similar ancestries. If IBD-detection algorithms are not well calibrated to differences in heterozygosity across populations, then spurious IBD calls will be more common in populations with lower heterozygosity, leading to greater risk of IBD tiling. Finally, we show in <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref> that in our sample, Finnish samples are more vulnerable to IBS tiling than other populations, which is likely due to Finns tracing substantial ancestry to a founder population that experienced a bottleneck 1̃00 generations ago (<xref ref-type="bibr" rid="bib44">Kere, 2001</xref>). Members of other groups with similar demographic histories are likely to be at elevated risk of IBS tiling and IBS probing as well.</p><p>We have focused on genetic genealogy databases that allow uploads because at this writing, it is straightforward to download publicly available genetic datasets and to produce fake genetic datasets for upload. In principle, however, another way to perform attacks like the ones we describe would be to use biological samples. For example, a group of people willing to share their genetic data with each other could collaborate to perform IBS tiling by sending actual biological samples for genotyping. Even IBS probing and IBS baiting could be performed with biological samples by adversaries who could synthesize the samples. Though synthesizing such samples is technically challenging now, it may become easier in the future. Such methods could present opportunities to attack databases that do not allow uploads, such as the large databases maintained by Ancestry (&gt;14 million) and 23andMe (&gt;9 million) (<xref ref-type="bibr" rid="bib68">Regalado, 2019</xref>). They would also thwart the countermeasure of requiring uploaded datasets to include an cryptographic signature indicating their source.</p><p>The IBS-based privacy attacks we describe here add to a growing set of threats to genetic privacy (<xref ref-type="bibr" rid="bib36">Homer et al., 2008</xref>; <xref ref-type="bibr" rid="bib56">Nyholt et al., 2009</xref>; <xref ref-type="bibr" rid="bib42">Im et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Gymrek et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Humbert et al., 2015</xref>; <xref ref-type="bibr" rid="bib72">Shringarpure and Bustamante, 2015</xref>; <xref ref-type="bibr" rid="bib22">Edge et al., 2017</xref>; <xref ref-type="bibr" rid="bib3">Ayday and Humbert, 2017</xref>; <xref ref-type="bibr" rid="bib46">Kim et al., 2018</xref>; <xref ref-type="bibr" rid="bib24">Erlich et al., 2018</xref>). A person’s genotype includes sensitive health information that might be used for discrimination, and people whose genetic information is compromised may be vulnerable to scams involving falsified relatives (<xref ref-type="bibr" rid="bib55">Ney et al., 2020</xref>). Athough there are many emerging threats to privacy, some of the more unsettling of which have nothing to do with genetics, genetic data do have special features that might require special considerations. In particular, genetic privacy concerns not only the person whose genotypes are directly revealed but also their relatives whose genotypes may be revealed indirectly (<xref ref-type="bibr" rid="bib40">Humbert et al., 2013</xref>), a point highlighted by the use of genetic genealogy for long-range forensic searches (<xref ref-type="bibr" rid="bib24">Erlich et al., 2018</xref>; <xref ref-type="bibr" rid="bib23">Edge and Coop, 2019</xref>).</p><p>Although many forms of genetic discrimination are prohibited legally, rules vary between countries and states. For example, in the United States, the Genetic Information Nondiscrimination Act (GINA) protects against genetic discrimination in the provision of health insurance but does not explicitly disallow genetic discrimination in the provision of life insurance, disability insurance, or long-term care insurance (<xref ref-type="bibr" rid="bib5">Bélisle-Pipon et al., 2019</xref>). In addition to measures for protecting genetic privacy in the short term, there is a need for more complete frameworks governing the circumstances under which genetic data can be used (<xref ref-type="bibr" rid="bib16">Clayton et al., 2019</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Data assembly</title><p>We performed IBS tiling with publicly available genoytpes from 872 people of European ancestries. Of these 872 genotypes, 503 came from the EUR subset of the 20130502 release of phase 3 of the 1000 Genomes project (<xref ref-type="bibr" rid="bib1">Abecasis et al., 2012</xref>), downloaded from <ext-link ext-link-type="uri" xlink:href="ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/">ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/</ext-link>. This release set has been pruned to remove close biological relatives. The EUR subset includes the following population codes and numbers of people: CEU (Utah residents with Northern and Western European Ancestry, 99 people), FIN (Finnish in Finland, 99 people), GBR (British in England and Scotland, 91 people), IBS (Iberian Population in Spain, 107 people), TSI (Toscani in Italia, 107 people).</p><p>The remaining 369 were selected from samples typed on the Human Origins SNP array (<xref ref-type="bibr" rid="bib59">Patterson et al., 2012</xref>), including 142 genotypes from the Human Genome Diversity Project (<xref ref-type="bibr" rid="bib13">Cann et al., 2002</xref>). Specifically, we downloaded the Human Origins data from <ext-link ext-link-type="uri" xlink:href="https://reich.hms.harvard.edu/downloadable-genotypes-present-day-and-ancient-dna-data-compiled-published-papers">https://reich.hms.harvard.edu/downloadable-genotypes-present-day-and-ancient-dna-data-compiled-published-papers</ext-link>, using the 1240K+HO dataset, version 37.2. The 372 selected people were all contemporary samples chosen according to population labels. We also excluded people from the Human Origins dataset if they appeared in the 1000 Genomes dataset. The populations used for selecting data, along with the number of participants included after excluding 1000 Genomes samples, were as follows: 'Adygei’ (16), 'Albanian’ (6), 'Basque’ (29), 'Belarusian’ (10), 'Bulgarian’ (10), 'Croatian’ (10), 'Czech’ (10), 'English’ (0), 'Estonian’ (10), 'Finnish’ (0), 'French’ (61), 'Greek’ (20), 'Hungarian’ (20), 'Icelandic’ (12), 'Italian_North’ (20), 'Italian_South’ (4), 'Lithuanian’ (10), 'Maltese’ (8), 'Mordovian’ (10), 'Norwegian’ (11), 'Orcadian’ (13), 'Romanian’ (10), 'Russian’ (22), 'Sardinian’ (27), 'Scottish’ (0), 'Sicilian’ (11), 'Spanish’ (0), 'Spanish_North’ (0), and 'Ukrainian’ (9). The populations with 0 people included are those for which all the samples in the Human Origins dataset are included in the 1000 Genomes phase 3 panel. Samples with group labels marked 'ignore’ were excluded, including samples marked as close relatives.</p><p>We down-sampled the sequence data from the 1000 Genomes project to include only sites typed by the Human Origins chip. Of the 597,573 SNPs included in the Human Origins dataset, 558,257 sites appeared at the same position in the 1000 Genomes dataset, 557,999 of which appear as biallelic SNPs. For 546,530 of these, both the SNP identifier and position match in 1000 Genomes, and for 544,139 of them, the alleles agreed as well. We merged the dataset at the set of 544,139 SNPs at which SNP identifiers, positions, and alleles matched between the Human Origins and 1000 Genomes datasets.</p><p>We used vcftools (<xref ref-type="bibr" rid="bib19">Danecek et al., 2011</xref>), bcftools (<xref ref-type="bibr" rid="bib50">Li, 2011</xref>), PLINK (<xref ref-type="bibr" rid="bib62">Purcell et al., 2007</xref>), and EIGENSOFT (<xref ref-type="bibr" rid="bib61">Price et al., 2006</xref>) to create the merged file. The script used to create it is maintained at <ext-link ext-link-type="uri" xlink:href="https://github.com/mdedge/IBS_privacy">github.com/mdedge/IBS_privacy/</ext-link>, and the merged data file is available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.25338/B8X619">https://doi.org/10.25338/B8X619</ext-link>. A permanent version of the scripts used in the publication version of this paper is available with doi <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.3620958">10.5281/zenodo.3620958</ext-link>.</p></sec><sec id="s4-2"><title>Phasing, IBS calling, and IBS tiling</title><p>We phased the combined dataset using Beagle 5.0 (<xref ref-type="bibr" rid="bib8">Browning and Browning, 2007</xref>) using the default settings and genetic maps for each chromosome. We used linear interpolation to obtain the genetic map position of each SNP on the build GRCh37 LDhat genetic map (<xref ref-type="bibr" rid="bib26">Frazer et al., 2007</xref>) downloaded from the Beagle website (<ext-link ext-link-type="uri" xlink:href="http://bochet.gcc.biostat.washington.edu/beagle/genetic_maps/">http://bochet.gcc.biostat.washington.edu/beagle/genetic_maps/</ext-link>). We used Refined IBD software (<xref ref-type="bibr" rid="bib10">Browning and Browning, 2013</xref>) to identify IBS segments, retaining segments of at least .1 centiMorgans (cM) with LOD scores &gt;1. We also used Germline (<xref ref-type="bibr" rid="bib29">Gusev et al., 2009</xref>) to identify IBS segments under alternative parameters, shown in the supplement. The resulting IBS segments were analyzed using the GenomicRanges package (<xref ref-type="bibr" rid="bib49">Lawrence et al., 2013</xref>) in R (<xref ref-type="bibr" rid="bib63">R Development Core Team, 2013</xref>). Scripts used for phasing, IBS calling, and IBS tiling are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mdedge/IBS_privacy/">github.com/mdedge/IBS_privacy/</ext-link>.</p></sec><sec id="s4-3"><title>IBS probing</title><p>To generate IBS-inert genotypes for IBS probing in <xref ref-type="fig" rid="fig3">Figure 3</xref>, we computed allele frequencies within the set of 872 Europeans for chromosome 19. Allele frequencies less than 10% were changed to 10%, and then alleles were sampled at one minus their frequency. This strategy generates genetic data that look quite unlike real data, with the advantage (for the purposes of IBS probing) of being unlikely to return IBS matches anywhere. An adversary attempting IBS probing in a real database would need to tailor the approach to the quality control and IBS calling methods used by the database.</p><p>After inert genotypes were produced, we stitched them with real phased genotypes from windows around GRCh position 45411941 on chromosome 19, the site of SNP rs429358. SNP rs429358 is in the APOE locus; if a haplotype has a C at rs429358 and a C at nearby SNP rs7412, then that haplotype is said to harbor the APO-<inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> allele, which confers risk for Alzheimer’s disease (<xref ref-type="bibr" rid="bib18">Corder et al., 1993</xref>). rs429358 is not genotyped on the Human Origins chip, but it is included on recent chips used by both Ancestry and 23andMe. To simulate probing with a 1 cM threshold for matching, we pulled real data from a region of 1.9 cM around the site, and to simulate probing with a 3 cM threshold, we pulled real data from a region of 5.9 cM around the site. Distances in cM were computed by linear interpolation from a genetic map in GRCh37 coordinates. Scripts used to generate <xref ref-type="fig" rid="fig3">Figure 3</xref> are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mdedge/IBS_privacy/">github.com/mdedge/IBS_privacy/</ext-link>.</p></sec><sec id="s4-4"><title>GEDmatch demonstration</title><p>On Novermber 21st, 2019, we first uploaded artificial genetic datasets to GEDmatch’s research mode in order to demonstrate the possibility of IBS baiting. GEDMatch has not published details of its IBS detection procedures. However, the options available to users in the 1-to-1 match tool and the description of how those options can be used to ignore single-site matches led us to hypothesize that GEDmatch uses phase-unaware IBS detection and that the 1-to-1 match tool might be vulnerable to IBS baiting.</p><sec id="s4-4-1"><title>Description of GEDmatch 1-to-1 tool</title><p>GEDmatch’s 1-to-1 match tool allows the user to compare the IBS matches of any two genetic datasets (or, in GEDmatch parlance, 'kits’), as long as the kit numbers are known to the user. Thus, to identify the genotypes of many users an adversary would need access to the kit numbers of many users. The 1-to-many tool in default GEDmatch reports 3000 of the closest genetic relatives of any kit whose number is known to the user, and reports the kit numbers of those match kits (along with names and email addresses). Thus an adversary can iteratively search for all the kit numbers matching a known kit, and so obtain many kit numbers to use in 1-to-1 searches. We alerted GEDmatch to this issue with the 1-to-many tool, as nearly the entire GEDmatch database of kit numbers and genetic relationships could be scraped.</p><p>The 1-to-1 match tool allows the user to specify parameters that govern IBS calling. In particular, the user can specify the minimum cM length of the blocks (down to 0.1 cM) and the minimum number of SNPs in a block (down to 25 SNPs). GEDmatch also allows the user to specify the ‘mis-match bunch limit,’ which appears to be the minimum number of IBS-compatible SNPs after an opposite-homozygous site that are required in order for a second opposite-homozygous site not to break the IBS segment.</p></sec></sec><sec id="s4-5"><title>Ethics</title><p>In order to comply with GEDmatch’s terms and conditions, we used artificial datasets designed not to match any genuine genetic data uploaded to GEDmatch. The kits were uploaded in 'Research’ mode, where they are not visible to other users via 1-to-many search. We did not interact with any other users’ data; we ran GEDmatch’s 1-to-1 comparison tools only comparing among our artificial kits. We exercised care not to interact with any other tools and to avoid accidental discoveries. Prior to uploading the artificial datasets, we also consulted with the UC Davis Institutional Review Board (IRB) to ensure that these uploads do not constitute human subjects research. Upon receiving confirmation from the IRB that our uploads do not constitute human subjects research and before uploading the datasets, we alerted GEDmatch that we would be making the uploads, and we also shared the kit numbers with them after we had completed our analyses.</p></sec><sec id="s4-6"><title>Construction of artificial datasets</title><p>We constructed artificial 'target’ and 'bait’ kits using the SNPs included in the 23 and Me v4 chip. (The 'target’ kits are the targets of inference, and the 'bait’ kits are designed to reveal their genotypes). We identified the alleles at these SNP positions in the 1000Genomes dataset, along with their frequencies in the EUR subset of 1000Genomes. We assigned as missing (‘- -’) any SNP that we could not match by position in 1000Genomes. We chose four target SNPs at random on chromosome 22. These SNPs were chosen at random from the set of strand-unambiguous polymorphisms, that is not A/T and G/C SNPs. These strand-unambiguous sites include the majority of SNPs on the chip, for example 89% of the SNPs on the 23andMe chip on chromosome 22.</p><sec id="s4-6-1"><title>Target genomes</title><p>We uploaded three artificial target genome kits (T1-T3). These vary in their genotypes at the target SNPs. T1 and T3 are homozygous for different alleles; T2 is heterozygous. At the rest of the loci, we constructed genotypes by randomly sampling alleles according to their frequencies at each SNP. Thus, there is no LD among loci.</p></sec><sec id="s4-6-2"><title>Bait genomes</title><p>We uploaded two artificial bait genome kits. These two kits have opposite-homozygote genotypes at each of the target SNPs. The two bait uploads were then set to have identical genotypes in the rest of their autosomes, with their genotypes specified as below.</p><p>To create a region around the target that would bait a phase-unaware method into calling IBD, we took SNPs in the 0.6cM on either side of the target SNP, selected at random 22 on each side, and set them to be heterozygous in both bait genomes. The rest of the SNPs within this bait region were set to be missing. We used only 22 heterozygous SNPs on each side and filled in the rest with missing data (rather than making all sites heterozygous) because large numbers of heterozygous sites generated an error on upload, ‘HTZ string too long’ and would not be processed further. Blocking uploads with long runs of heterozygous sites is a countermeasure put in place by GEDmatch after we and (<xref ref-type="bibr" rid="bib55">Ney et al., 2020</xref>) initially alerted GEDmatch to the risks of upload-based privacy attacks. However, we found that the countermeasure was not triggered by runs of heterozygous sites with missing sites interspersed, and these runs of heterozygosity interspersed with missingness also effectively baited GEDmatch into calling IBD segments. Additionally, we confirmed with Peter Ney (personal communication) that his previously uploaded kits including long runs of heterozygosity remain active even though re-uploads of those same kits are blocked as of December 3rd, 2019, suggesting that the block applies only to newly uploaded kits and not to existing data on GEDmatch.</p><p>The alleles in target kits at all other autosomal SNPs in the genome were drawn at random with frequency <inline-formula><mml:math id="inf8"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf9"><mml:mi>p</mml:mi></mml:math></inline-formula> is the frequency in the 1000Genomes EUR subsample. This scheme was chosen to ensure that the bait genomes were unlikely to have spurious IBS matches anywhere with any target genome, so that the only potential IBS was in the target regions.</p></sec></sec><sec id="s4-7"><title>Detailed results of baiting</title><p>We compared each target to both bait genomes using the 1-to-1 GEDmatch tool. We set the minimum block to a length of &gt; 0.7cM and 25 SNPs, with a mismatch cutoff of 25 SNPs. This ensured that we could detect IBS in the key regions, but that a single opposite-homozygous mismatch would be sufficient to prevent the identification of a putative IBS segment in the key region.</p><p>The baiting attempt was successful; we observed IBS only where we expected it between bait and target kits (<xref ref-type="fig" rid="fig5">Figure 5</xref>). We observed no putative IBD segments on any chromosome except 22, as expected on the basis of our procedure for filling in artificial genotypes in both sets of kits. The details of the matches on chromosome 22 are reported in <xref ref-type="table" rid="table3">Table 3</xref>. We observed 4 putative IBD segments overlapping our target bait regions in the comparisons with matching homozygote genotypes at the bait site, that is in the T1-B1 and T3-B2 comparisons, as well in both heterozygote-homozygote comparisons, that is T2-B1 and T2-B2. We observed no putative IBD segments in the pairs with opposite-homozygous mismatches, T1-B1 and T3-B2. Thus the genotypes of the targets are readily discernable from from the putative IBD segments output by GEDmatch. The full results returned by GEDmatch are available as images here (<ext-link ext-link-type="uri" xlink:href="https://github.com/mdedge/IBS_privacy/tree/master/IBS_baiting_demo">https://github.com/mdedge/IBS_privacy/tree/master/IBS_baiting_demo</ext-link>; the kit numbers are redacted to prevent reuse).</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Summary of the SNPs targeted by baiting and the IBS returned by GEDmatch.</title><p>For each region, we give the position of the key SNP (target bp). Because by design our bait kits are genetically identical outside of the target SNPs, the IBS regions returned by GEDmatch’s 1-to-1 tool are identical across bait kits generating a match. For each pairwise comparison, we report the IBS information returned: Left-Right bp of the IBS region, the cM length, the number (#) of SNPs in the IBS region with a non-missing target. We also report the number (#) of SNPs spanned by the region IBS when matched to the missing target Bmiss.</p><p><supplementary-material id="table3sdata1"><label>Table 3—source data 1.</label><caption><title>GEDmatch demonstration summary.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-51810-table3-data1-v2.csv"/></supplementary-material></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Matching pairs</th><th/><th>Target 1</th><th>Target 2</th><th>Target 3</th><th>Target 4</th></tr></thead><tbody><tr><td/><td>target bp</td><td>27613130</td><td>34024097</td><td>37673781</td><td>42008068</td></tr><tr><td>T1-(B1 Bmiss)</td><td/><td/><td/><td/><td/></tr><tr><td/><td>IBS L bp</td><td>27427698</td><td>33771672</td><td>37519864</td><td>40054428</td></tr><tr><td/><td>IBS R bp</td><td>27680780</td><td>34328741</td><td>37827711</td><td>43112674</td></tr><tr><td/><td>IBS cM</td><td>1.3</td><td>0.8</td><td>1.1</td><td>1.2</td></tr><tr><td/><td># SNPs</td><td>47</td><td>45</td><td>42</td><td>40</td></tr><tr><td/><td># SNPs Bmiss</td><td>46</td><td>44</td><td>41</td><td>39</td></tr><tr><td>T2-(B1 B2 Bmiss)</td><td/><td/><td/><td/><td/></tr><tr><td/><td>IBS L bp</td><td>27433179</td><td>33771672</td><td>37508507</td><td>40357667</td></tr><tr><td/><td>IBS R bp</td><td>27680780</td><td>34328741</td><td>37827711</td><td>43112674</td></tr><tr><td/><td>IBS cM</td><td>1.3</td><td>0.8</td><td>1.2</td><td>0.9</td></tr><tr><td/><td># SNPs</td><td>45</td><td>45</td><td>45</td><td>32</td></tr><tr><td/><td># SNPs Bmiss</td><td>44</td><td>44</td><td>44</td><td>31</td></tr><tr><td>T3-(B3 Bmiss)</td><td/><td/><td/><td/><td/></tr><tr><td/><td>IBS L bp</td><td>27433179</td><td>33771672</td><td>37519864</td><td>40357667</td></tr><tr><td/><td>IBS R bp</td><td>27680780</td><td>34328741</td><td>37827711</td><td>43112674</td></tr><tr><td/><td>IBS cM</td><td>1.3</td><td>0.8</td><td>1.1</td><td>0.9</td></tr><tr><td/><td># SNPs</td><td>45</td><td>45</td><td>45</td><td>32</td></tr><tr><td/><td># SNPs Bmiss</td><td>44</td><td>44</td><td>41</td><td>31</td></tr><tr><td>Tmiss-(All Baits)</td><td/><td/><td/><td/><td/></tr><tr><td/><td>IBS L bp</td><td>27433179</td><td>33771672</td><td>37519864</td><td>40357667</td></tr><tr><td/><td>IBS R bp</td><td>27680780</td><td>34328741</td><td>37827711</td><td>43112674</td></tr><tr><th/><td>IBS cM</td><td>1.3</td><td>0.8</td><td>1.1</td><td>0.9</td></tr><tr><td/><td># SNPs</td><td>44</td><td>44</td><td>44</td><td>31</td></tr><tr><td/><td># SNPs Bmiss</td><td>44</td><td>44</td><td>44</td><td>31</td></tr></tbody></table></table-wrap><p>Some of the IBS blocks have fewer SNPs than we expect. We believe this to be due to the removal of SNPs during the tokenization stage, during which rare SNPs and SNPs with stand-ambiguous alleles seem to be removed (<xref ref-type="bibr" rid="bib55">Ney et al., 2020</xref>). We did not investigate this further, but multiple uploads could be used to determine the approximate criteria for SNPs to be included, and hence determine where an adversary should set cutoffs.</p><p>Our two bait kits could both generate IBS matches to the target because the target genotype is missing rather than heterozygous. To determine whether a genotype was missing, we implemented a trick borrowed from <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref>, and uploaded a third bait kit (Bmiss) with the target SNP set to missing (i.e. ‘- -’) and then looked at the number of SNPs an IBS match across the target site spans. In each case, the non-missing baits (B1 and B2) generated an IBS block match with with T1-T3 that was one SNP longer than the IBS block generated by the Bmiss bait (<xref ref-type="table" rid="table3">Table 3</xref>). Comparing these baits to a new target with a missing genotype at each target site (Tmiss), we see that in each pairwise comparison the IBS blocks are the same number of SNPs long regardless of whether the target SNP bait genotype was missing (<xref ref-type="table" rid="table3">Table 3</xref>). Therefore, we can distinguish the target being heterozygote or missing by the use of a third bait kit and inspection of the number of SNPs included in an IBS match.</p><p>The possibility of IBS-baiting-like procedures also interacts with the vulnerabilities arising from the presentation of SNP-level visualizations explored by <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref>. Even if short IBS blocks were not reported to the user explicitly, it is clear from the zoomed-in view that we can see the target mismatches in question (see <xref ref-type="fig" rid="fig5">Figure 5</xref>). One measure that GEDmatch appears to have taken against a <xref ref-type="bibr" rid="bib55">Ney et al. (2020)</xref>-style attack is to jitter the positions of SNPs in their visualization slightly. However, an attacker could counter such jittering by embedding key sites in runs of heterozygosity, making it easier to identify them in visualizations after jittering. Thus, the images displayed by GEDmatch still pose additional security risks.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Matt Bishop, Elizabeth Joh, Peter Ney, and Mike Sweeney for useful conversations, and we thank Shai Carmi, Yaniv Erlich, Debbie Kennett, Leah Larkin, Magnus Nordborg, Rori Rohlfs, Noah Rosenberg, Ann Turner, Amy Williams, and an anonymous reviewer for helpful comments on the manuscript. Swapan Mallick and David Reich answered questions about the Human Origins dataset, Brian Browning answered questions about Refined IBD, and Alexander Gusev answered questions about Germline software. We acknowledge support from the National Institutes of Health (R01-GM108779 and F32-GM130050).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Formal analysis, Funding acquisition, Validation, Investigation, Visualization, Methodology</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-51810-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The dataset used here was assembled from publicly available datasets. The combined dataset has been deposited in Dryad at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.25338/B8X619">https://doi.org/10.25338/B8X619</ext-link>, and scripts for assembling and analyzing the data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mdedge/IBS_privacy">https://github.com/mdedge/IBS_privacy</ext-link>. Previously published data used includes the 1000 Genomes Project Phase 3 data (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.1000genomes.491ebi.ac.uk/vol1/ftp/release/20130502/">ftp://ftp.1000genomes.491ebi.ac.uk/vol1/ftp/release/20130502/</ext-link>) and downloadable genotypes of present-day and ancient DNA data (compiled from published papers) from the Reich Lab Harvard Medical School (<ext-link ext-link-type="uri" xlink:href="https://reich.hms.harvard.edu/downloadable-genotypes-present-day-and-ancient-dna-data-compiled-published-papers">https://reich.hms.harvard.edu/downloadable-genotypes-present-day-and-ancient-dna-data-compiled-published-papers</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation id="dataset3" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Michael</surname><given-names>D Edge</given-names></name><name><surname>Graham</surname><given-names>Coop</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Data from: Attacks on genetic privacy via uploads to genealogical databases</data-title><source>Dryad Digital Repository</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.25338/B8X619</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abecasis</surname> <given-names>GR</given-names></name><name><surname>Auton</surname> <given-names>A</given-names></name><name><surname>Brooks</surname> <given-names>LD</given-names></name><name><surname>DePristo</surname> <given-names>MA</given-names></name><name><surname>Durbin</surname> <given-names>RM</given-names></name><name><surname>Handsaker</surname> <given-names>RE</given-names></name><name><surname>Kang</surname> <given-names>HM</given-names></name><name><surname>Marth</surname> <given-names>GT</given-names></name><name><surname>McVean</surname> <given-names>GA</given-names></name><collab>1000 Genomes Project Consortium</collab></person-group><year iso-8601-date="2012">2012</year><article-title>An integrated map of genetic variation from 1,092 human genomes</article-title><source>Nature</source><volume>491</volume><fpage>56</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1038/nature11632</pub-id><pub-id pub-id-type="pmid">23128226</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Akrout</surname> <given-names>I</given-names></name><name><surname>Feriani</surname> <given-names>A</given-names></name><name><surname>Akrout</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hacking google recaptcha v3 using reinforcement learning</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1903.01003">https://arxiv.org/abs/1903.01003</ext-link></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayday</surname> <given-names>E</given-names></name><name><surname>Humbert</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inference attacks against kin genomic privacy</article-title><source>IEEE Security &amp; Privacy</source><volume>15</volume><fpage>29</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1109/MSP.2017.3681052</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Baecher</surname> <given-names>P</given-names></name><name><surname>Büscher</surname> <given-names>N</given-names></name><name><surname>Fischlin</surname> <given-names>M</given-names></name><name><surname>Milde</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title><italic>Breaking reCAPTCHA: A Holistic Approach via Shape Recognition</italic></chapter-title><person-group person-group-type="editor"><name><surname>Camenisch</surname> <given-names>J</given-names></name><name><surname>Fischer-Hübner</surname> <given-names>S</given-names></name><name><surname>Murayama</surname> <given-names>Y</given-names></name><name><surname>Portmann</surname> <given-names>A</given-names></name><name><surname>Rieder</surname> <given-names>C</given-names></name></person-group><source>Future Challenges in Security and Privacy for Academia and Industry</source><publisher-loc>Berlin, Heidelberg</publisher-loc><publisher-name>Springer Berlin Heidelberg</publisher-name><fpage>56</fpage><lpage>67</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bélisle-Pipon</surname> <given-names>JC</given-names></name><name><surname>Vayena</surname> <given-names>E</given-names></name><name><surname>Green</surname> <given-names>RC</given-names></name><name><surname>Cohen</surname> <given-names>IG</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genetic testing, insurance discrimination and medical research: what the united states can learn from peer countries</article-title><source>Nature Medicine</source><volume>25</volume><fpage>1198</fpage><lpage>1204</lpage><pub-id pub-id-type="doi">10.1038/s41591-019-0534-z</pub-id><pub-id pub-id-type="pmid">31388181</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bjelland</surname> <given-names>DW</given-names></name><name><surname>Lingala</surname> <given-names>U</given-names></name><name><surname>Patel</surname> <given-names>PS</given-names></name><name><surname>Jones</surname> <given-names>M</given-names></name><name><surname>Keller</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A fast and accurate method for detection of IBD shared haplotypes in genome-wide SNP data</article-title><source>European Journal of Human Genetics</source><volume>25</volume><fpage>617</fpage><lpage>624</lpage><pub-id pub-id-type="doi">10.1038/ejhg.2017.6</pub-id><pub-id pub-id-type="pmid">28176766</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>SS</given-names></name><name><surname>DiBari</surname> <given-names>N</given-names></name><name><surname>Bhatia</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>I am ’totally’ Human: Bypassing the Recaptcha</article-title><conf-name>2017 13th International Conference on Signal-Image Technology Internet-Based Systems</conf-name></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname> <given-names>SR</given-names></name><name><surname>Browning</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Rapid and accurate haplotype phasing and missing-data inference for whole-genome association studies by use of localized haplotype clustering</article-title><source>The American Journal of Human Genetics</source><volume>81</volume><fpage>1084</fpage><lpage>1097</lpage><pub-id pub-id-type="doi">10.1086/521987</pub-id><pub-id pub-id-type="pmid">17924348</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname> <given-names>SR</given-names></name><name><surname>Browning</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Identity by descent between distant relatives: detection and applications</article-title><source>Annual Review of Genetics</source><volume>46</volume><fpage>617</fpage><lpage>633</lpage><pub-id pub-id-type="doi">10.1146/annurev-genet-110711-155534</pub-id><pub-id pub-id-type="pmid">22994355</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname> <given-names>BL</given-names></name><name><surname>Browning</surname> <given-names>SR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Improving the accuracy and efficiency of identity-by-descent detection in population data</article-title><source>Genetics</source><volume>194</volume><fpage>459</fpage><lpage>471</lpage><pub-id pub-id-type="doi">10.1534/genetics.113.150029</pub-id><pub-id pub-id-type="pmid">23535385</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bryc</surname> <given-names>K</given-names></name><name><surname>Durand</surname> <given-names>EY</given-names></name><name><surname>Macpherson</surname> <given-names>JM</given-names></name><name><surname>Reich</surname> <given-names>D</given-names></name><name><surname>Mountain</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The genetic ancestry of african americans, latinos, and european americans across the united states</article-title><source>The American Journal of Human Genetics</source><volume>96</volume><fpage>37</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2014.11.010</pub-id><pub-id pub-id-type="pmid">25529636</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buffalo</surname> <given-names>V</given-names></name><name><surname>Mount</surname> <given-names>SM</given-names></name><name><surname>Coop</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A genealogical look at shared ancestry on the X chromosome</article-title><source>Genetics</source><volume>204</volume><fpage>57</fpage><lpage>75</lpage><pub-id pub-id-type="doi">10.1534/genetics.116.190041</pub-id><pub-id pub-id-type="pmid">27356612</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cann</surname> <given-names>HM</given-names></name><name><surname>de Toma</surname> <given-names>C</given-names></name><name><surname>Cazes</surname> <given-names>L</given-names></name><name><surname>Legrand</surname> <given-names>MF</given-names></name><name><surname>Morel</surname> <given-names>V</given-names></name><name><surname>Piouffre</surname> <given-names>L</given-names></name><name><surname>Bodmer</surname> <given-names>J</given-names></name><name><surname>Bodmer</surname> <given-names>WF</given-names></name><name><surname>Bonne-Tamir</surname> <given-names>B</given-names></name><name><surname>Cambon-Thomsen</surname> <given-names>A</given-names></name><name><surname>Chen</surname> <given-names>Z</given-names></name><name><surname>Chu</surname> <given-names>J</given-names></name><name><surname>Carcassi</surname> <given-names>C</given-names></name><name><surname>Contu</surname> <given-names>L</given-names></name><name><surname>Du</surname> <given-names>R</given-names></name><name><surname>Excoffier</surname> <given-names>L</given-names></name><name><surname>Ferrara</surname> <given-names>GB</given-names></name><name><surname>Friedlaender</surname> <given-names>JS</given-names></name><name><surname>Groot</surname> <given-names>H</given-names></name><name><surname>Gurwitz</surname> <given-names>D</given-names></name><name><surname>Jenkins</surname> <given-names>T</given-names></name><name><surname>Herrera</surname> <given-names>RJ</given-names></name><name><surname>Huang</surname> <given-names>X</given-names></name><name><surname>Kidd</surname> <given-names>J</given-names></name><name><surname>Kidd</surname> <given-names>KK</given-names></name><name><surname>Langaney</surname> <given-names>A</given-names></name><name><surname>Lin</surname> <given-names>AA</given-names></name><name><surname>Mehdi</surname> <given-names>SQ</given-names></name><name><surname>Parham</surname> <given-names>P</given-names></name><name><surname>Piazza</surname> <given-names>A</given-names></name><name><surname>Pistillo</surname> <given-names>MP</given-names></name><name><surname>Qian</surname> <given-names>Y</given-names></name><name><surname>Shu</surname> <given-names>Q</given-names></name><name><surname>Xu</surname> <given-names>J</given-names></name><name><surname>Zhu</surname> <given-names>S</given-names></name><name><surname>Weber</surname> <given-names>JL</given-names></name><name><surname>Greely</surname> <given-names>HT</given-names></name><name><surname>Feldman</surname> <given-names>MW</given-names></name><name><surname>Thomas</surname> <given-names>G</given-names></name><name><surname>Dausset</surname> <given-names>J</given-names></name><name><surname>Cavalli-Sforza</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A human genome diversity cell line panel</article-title><source>Science</source><volume>296</volume><fpage>261</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1126/science.296.5566.261b</pub-id><pub-id pub-id-type="pmid">11954565</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carmi</surname> <given-names>S</given-names></name><name><surname>Palamara</surname> <given-names>PF</given-names></name><name><surname>Vacic</surname> <given-names>V</given-names></name><name><surname>Lencz</surname> <given-names>T</given-names></name><name><surname>Darvasi</surname> <given-names>A</given-names></name><name><surname>Pe’er</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The variance of Identity-by-Descent sharing in the Wright–Fisher Model</article-title><source>Genetics</source><volume>193</volume><fpage>911</fpage><lpage>928</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.147215</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carmi</surname> <given-names>S</given-names></name><name><surname>Hui</surname> <given-names>KY</given-names></name><name><surname>Kochav</surname> <given-names>E</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Xue</surname> <given-names>J</given-names></name><name><surname>Grady</surname> <given-names>F</given-names></name><name><surname>Guha</surname> <given-names>S</given-names></name><name><surname>Upadhyay</surname> <given-names>K</given-names></name><name><surname>Ben-Avraham</surname> <given-names>D</given-names></name><name><surname>Mukherjee</surname> <given-names>S</given-names></name><name><surname>Bowen</surname> <given-names>BM</given-names></name><name><surname>Thomas</surname> <given-names>T</given-names></name><name><surname>Vijai</surname> <given-names>J</given-names></name><name><surname>Cruts</surname> <given-names>M</given-names></name><name><surname>Froyen</surname> <given-names>G</given-names></name><name><surname>Lambrechts</surname> <given-names>D</given-names></name><name><surname>Plaisance</surname> <given-names>S</given-names></name><name><surname>Van Broeckhoven</surname> <given-names>C</given-names></name><name><surname>Van Damme</surname> <given-names>P</given-names></name><name><surname>Van Marck</surname> <given-names>H</given-names></name><name><surname>Barzilai</surname> <given-names>N</given-names></name><name><surname>Darvasi</surname> <given-names>A</given-names></name><name><surname>Offit</surname> <given-names>K</given-names></name><name><surname>Bressman</surname> <given-names>S</given-names></name><name><surname>Ozelius</surname> <given-names>LJ</given-names></name><name><surname>Peter</surname> <given-names>I</given-names></name><name><surname>Cho</surname> <given-names>JH</given-names></name><name><surname>Ostrer</surname> <given-names>H</given-names></name><name><surname>Atzmon</surname> <given-names>G</given-names></name><name><surname>Clark</surname> <given-names>LN</given-names></name><name><surname>Lencz</surname> <given-names>T</given-names></name><name><surname>Pe'er</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Sequencing an ashkenazi reference panel supports population-targeted personal genomics and illuminates jewish and european origins</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>4835</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms5835</pub-id><pub-id pub-id-type="pmid">25203624</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clayton</surname> <given-names>EW</given-names></name><name><surname>Evans</surname> <given-names>BJ</given-names></name><name><surname>Hazel</surname> <given-names>JW</given-names></name><name><surname>Rothstein</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The law of genetic privacy: applications, implications, and limitations</article-title><source>Journal of Law and the Biosciences</source><volume>6</volume><fpage>1</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1093/jlb/lsz007</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conomos</surname> <given-names>MP</given-names></name><name><surname>Reiner</surname> <given-names>AP</given-names></name><name><surname>Weir</surname> <given-names>BS</given-names></name><name><surname>Thornton</surname> <given-names>TA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Model-free estimation of recent genetic relatedness</article-title><source>The American Journal of Human Genetics</source><volume>98</volume><fpage>127</fpage><lpage>148</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.11.022</pub-id><pub-id pub-id-type="pmid">26748516</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corder</surname> <given-names>EH</given-names></name><name><surname>Saunders</surname> <given-names>AM</given-names></name><name><surname>Strittmatter</surname> <given-names>WJ</given-names></name><name><surname>Schmechel</surname> <given-names>DE</given-names></name><name><surname>Gaskell</surname> <given-names>PC</given-names></name><name><surname>Small</surname> <given-names>GW</given-names></name><name><surname>Roses</surname> <given-names>AD</given-names></name><name><surname>Haines</surname> <given-names>JL</given-names></name><name><surname>Pericak-Vance</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Gene dose of apolipoprotein E type 4 allele and the risk of alzheimer's disease in late onset families</article-title><source>Science</source><volume>261</volume><fpage>921</fpage><lpage>923</lpage><pub-id pub-id-type="doi">10.1126/science.8346443</pub-id><pub-id pub-id-type="pmid">8346443</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danecek</surname> <given-names>P</given-names></name><name><surname>Auton</surname> <given-names>A</given-names></name><name><surname>Abecasis</surname> <given-names>G</given-names></name><name><surname>Albers</surname> <given-names>CA</given-names></name><name><surname>Banks</surname> <given-names>E</given-names></name><name><surname>DePristo</surname> <given-names>MA</given-names></name><name><surname>Handsaker</surname> <given-names>RE</given-names></name><name><surname>Lunter</surname> <given-names>G</given-names></name><name><surname>Marth</surname> <given-names>GT</given-names></name><name><surname>Sherry</surname> <given-names>ST</given-names></name><name><surname>McVean</surname> <given-names>G</given-names></name><name><surname>Durbin</surname> <given-names>R</given-names></name><collab>1000 Genomes Project Analysis Group</collab></person-group><year iso-8601-date="2011">2011</year><article-title>The variant call format and VCFtools</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2156</fpage><lpage>2158</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr330</pub-id><pub-id pub-id-type="pmid">21653522</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donnelly</surname> <given-names>KP</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>The probability that related individuals share some section of genome identical by descent</article-title><source>Theoretical Population Biology</source><volume>23</volume><fpage>34</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(83)90004-7</pub-id><pub-id pub-id-type="pmid">6857549</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durand</surname> <given-names>EY</given-names></name><name><surname>Eriksson</surname> <given-names>N</given-names></name><name><surname>McLean</surname> <given-names>CY</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reducing pervasive False-Positive Identical-by-Descent segments detected by Large-Scale pedigree analysis</article-title><source>Molecular Biology and Evolution</source><volume>31</volume><fpage>2212</fpage><lpage>2222</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu151</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edge</surname> <given-names>MD</given-names></name><name><surname>Algee-Hewitt</surname> <given-names>BFB</given-names></name><name><surname>Pemberton</surname> <given-names>TJ</given-names></name><name><surname>Li</surname> <given-names>JZ</given-names></name><name><surname>Rosenberg</surname> <given-names>NA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Linkage disequilibrium matches forensic genetic records to disjoint genomic marker sets</article-title><source>PNAS</source><volume>114</volume><fpage>5671</fpage><lpage>5676</lpage><pub-id pub-id-type="doi">10.1073/pnas.1619944114</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Edge</surname> <given-names>MD</given-names></name><name><surname>Coop</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>How lucky was the genetic investigation in the golden state killer case?</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/531384</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erlich</surname> <given-names>Y</given-names></name><name><surname>Shor</surname> <given-names>T</given-names></name><name><surname>Pe’er</surname> <given-names>I</given-names></name><name><surname>Carmi</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Identity inference of genomic data using long-range familial searches</article-title><source>Science</source><volume>362</volume><fpage>690</fpage><lpage>694</lpage><pub-id pub-id-type="doi">10.1126/science.aau4832</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Erlich</surname> <given-names>Y</given-names></name><name><surname>Narayanan</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Routes for breaching and protecting genetic privacy</article-title><source>Nature Reviews Genetics</source><volume>15</volume><fpage>409</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1038/nrg3723</pub-id><pub-id pub-id-type="pmid">24805122</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frazer</surname> <given-names>KA</given-names></name><name><surname>Ballinger</surname> <given-names>DG</given-names></name><name><surname>Cox</surname> <given-names>DR</given-names></name><name><surname>Hinds</surname> <given-names>DA</given-names></name><name><surname>Stuve</surname> <given-names>LL</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Belmont</surname> <given-names>JW</given-names></name><name><surname>Boudreau</surname> <given-names>A</given-names></name><name><surname>Hardenbol</surname> <given-names>P</given-names></name><name><surname>Leal</surname> <given-names>SM</given-names></name><name><surname>Pasternak</surname> <given-names>S</given-names></name><name><surname>Wheeler</surname> <given-names>DA</given-names></name><name><surname>Willis</surname> <given-names>TD</given-names></name><name><surname>Yu</surname> <given-names>F</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Zeng</surname> <given-names>C</given-names></name><name><surname>Gao</surname> <given-names>Y</given-names></name><name><surname>Hu</surname> <given-names>H</given-names></name><name><surname>Hu</surname> <given-names>W</given-names></name><name><surname>Li</surname> <given-names>C</given-names></name><name><surname>Lin</surname> <given-names>W</given-names></name><name><surname>Liu</surname> <given-names>S</given-names></name><name><surname>Pan</surname> <given-names>H</given-names></name><name><surname>Tang</surname> <given-names>X</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>W</given-names></name><name><surname>Yu</surname> <given-names>J</given-names></name><name><surname>Zhang</surname> <given-names>B</given-names></name><name><surname>Zhang</surname> <given-names>Q</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Zhou</surname> <given-names>J</given-names></name><name><surname>Gabriel</surname> <given-names>SB</given-names></name><name><surname>Barry</surname> <given-names>R</given-names></name><name><surname>Blumenstiel</surname> <given-names>B</given-names></name><name><surname>Camargo</surname> <given-names>A</given-names></name><name><surname>Defelice</surname> <given-names>M</given-names></name><name><surname>Faggart</surname> <given-names>M</given-names></name><name><surname>Goyette</surname> <given-names>M</given-names></name><name><surname>Gupta</surname> <given-names>S</given-names></name><name><surname>Moore</surname> <given-names>J</given-names></name><name><surname>Nguyen</surname> <given-names>H</given-names></name><name><surname>Onofrio</surname> <given-names>RC</given-names></name><name><surname>Parkin</surname> <given-names>M</given-names></name><name><surname>Roy</surname> <given-names>J</given-names></name><name><surname>Stahl</surname> <given-names>E</given-names></name><name><surname>Winchester</surname> <given-names>E</given-names></name><name><surname>Ziaugra</surname> <given-names>L</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Yao</surname> <given-names>Z</given-names></name><name><surname>Huang</surname> <given-names>W</given-names></name><name><surname>Chu</surname> <given-names>X</given-names></name><name><surname>He</surname> <given-names>Y</given-names></name><name><surname>Jin</surname> <given-names>L</given-names></name><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Shen</surname> <given-names>Y</given-names></name><name><surname>Sun</surname> <given-names>W</given-names></name><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Xiong</surname> <given-names>X</given-names></name><name><surname>Xu</surname> <given-names>L</given-names></name><name><surname>Waye</surname> <given-names>MM</given-names></name><name><surname>Tsui</surname> <given-names>SK</given-names></name><name><surname>Xue</surname> <given-names>H</given-names></name><name><surname>Wong</surname> <given-names>JT</given-names></name><name><surname>Galver</surname> <given-names>LM</given-names></name><name><surname>Fan</surname> <given-names>JB</given-names></name><name><surname>Gunderson</surname> <given-names>K</given-names></name><name><surname>Murray</surname> <given-names>SS</given-names></name><name><surname>Oliphant</surname> <given-names>AR</given-names></name><name><surname>Chee</surname> <given-names>MS</given-names></name><name><surname>Montpetit</surname> <given-names>A</given-names></name><name><surname>Chagnon</surname> <given-names>F</given-names></name><name><surname>Ferretti</surname> <given-names>V</given-names></name><name><surname>Leboeuf</surname> <given-names>M</given-names></name><name><surname>Olivier</surname> <given-names>JF</given-names></name><name><surname>Phillips</surname> <given-names>MS</given-names></name><name><surname>Roumy</surname> <given-names>S</given-names></name><name><surname>Sallée</surname> <given-names>C</given-names></name><name><surname>Verner</surname> <given-names>A</given-names></name><name><surname>Hudson</surname> <given-names>TJ</given-names></name><name><surname>Kwok</surname> <given-names>PY</given-names></name><name><surname>Cai</surname> <given-names>D</given-names></name><name><surname>Koboldt</surname> <given-names>DC</given-names></name><name><surname>Miller</surname> <given-names>RD</given-names></name><name><surname>Pawlikowska</surname> <given-names>L</given-names></name><name><surname>Taillon-Miller</surname> <given-names>P</given-names></name><name><surname>Xiao</surname> <given-names>M</given-names></name><name><surname>Tsui</surname> <given-names>LC</given-names></name><name><surname>Mak</surname> <given-names>W</given-names></name><name><surname>Song</surname> <given-names>YQ</given-names></name><name><surname>Tam</surname> <given-names>PK</given-names></name><name><surname>Nakamura</surname> <given-names>Y</given-names></name><name><surname>Kawaguchi</surname> <given-names>T</given-names></name><name><surname>Kitamoto</surname> <given-names>T</given-names></name><name><surname>Morizono</surname> <given-names>T</given-names></name><name><surname>Nagashima</surname> <given-names>A</given-names></name><name><surname>Ohnishi</surname> <given-names>Y</given-names></name><name><surname>Sekine</surname> <given-names>A</given-names></name><name><surname>Tanaka</surname> <given-names>T</given-names></name><name><surname>Tsunoda</surname> <given-names>T</given-names></name><name><surname>Deloukas</surname> <given-names>P</given-names></name><name><surname>Bird</surname> <given-names>CP</given-names></name><name><surname>Delgado</surname> <given-names>M</given-names></name><name><surname>Dermitzakis</surname> <given-names>ET</given-names></name><name><surname>Gwilliam</surname> <given-names>R</given-names></name><name><surname>Hunt</surname> <given-names>S</given-names></name><name><surname>Morrison</surname> <given-names>J</given-names></name><name><surname>Powell</surname> <given-names>D</given-names></name><name><surname>Stranger</surname> <given-names>BE</given-names></name><name><surname>Whittaker</surname> <given-names>P</given-names></name><name><surname>Bentley</surname> <given-names>DR</given-names></name><name><surname>Daly</surname> <given-names>MJ</given-names></name><name><surname>de Bakker</surname> <given-names>PI</given-names></name><name><surname>Barrett</surname> <given-names>J</given-names></name><name><surname>Chretien</surname> <given-names>YR</given-names></name><name><surname>Maller</surname> <given-names>J</given-names></name><name><surname>McCarroll</surname> <given-names>S</given-names></name><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Pe'er</surname> <given-names>I</given-names></name><name><surname>Price</surname> <given-names>A</given-names></name><name><surname>Purcell</surname> <given-names>S</given-names></name><name><surname>Richter</surname> <given-names>DJ</given-names></name><name><surname>Sabeti</surname> <given-names>P</given-names></name><name><surname>Saxena</surname> <given-names>R</given-names></name><name><surname>Schaffner</surname> <given-names>SF</given-names></name><name><surname>Sham</surname> <given-names>PC</given-names></name><name><surname>Varilly</surname> <given-names>P</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Stein</surname> <given-names>LD</given-names></name><name><surname>Krishnan</surname> <given-names>L</given-names></name><name><surname>Smith</surname> <given-names>AV</given-names></name><name><surname>Tello-Ruiz</surname> <given-names>MK</given-names></name><name><surname>Thorisson</surname> <given-names>GA</given-names></name><name><surname>Chakravarti</surname> <given-names>A</given-names></name><name><surname>Chen</surname> <given-names>PE</given-names></name><name><surname>Cutler</surname> <given-names>DJ</given-names></name><name><surname>Kashuk</surname> <given-names>CS</given-names></name><name><surname>Lin</surname> <given-names>S</given-names></name><name><surname>Abecasis</surname> <given-names>GR</given-names></name><name><surname>Guan</surname> <given-names>W</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Munro</surname> <given-names>HM</given-names></name><name><surname>Qin</surname> <given-names>ZS</given-names></name><name><surname>Thomas</surname> <given-names>DJ</given-names></name><name><surname>McVean</surname> <given-names>G</given-names></name><name><surname>Auton</surname> <given-names>A</given-names></name><name><surname>Bottolo</surname> <given-names>L</given-names></name><name><surname>Cardin</surname> <given-names>N</given-names></name><name><surname>Eyheramendy</surname> <given-names>S</given-names></name><name><surname>Freeman</surname> <given-names>C</given-names></name><name><surname>Marchini</surname> <given-names>J</given-names></name><name><surname>Myers</surname> <given-names>S</given-names></name><name><surname>Spencer</surname> <given-names>C</given-names></name><name><surname>Stephens</surname> <given-names>M</given-names></name><name><surname>Donnelly</surname> <given-names>P</given-names></name><name><surname>Cardon</surname> <given-names>LR</given-names></name><name><surname>Clarke</surname> <given-names>G</given-names></name><name><surname>Evans</surname> <given-names>DM</given-names></name><name><surname>Morris</surname> <given-names>AP</given-names></name><name><surname>Weir</surname> <given-names>BS</given-names></name><name><surname>Tsunoda</surname> <given-names>T</given-names></name><name><surname>Mullikin</surname> <given-names>JC</given-names></name><name><surname>Sherry</surname> <given-names>ST</given-names></name><name><surname>Feolo</surname> <given-names>M</given-names></name><name><surname>Skol</surname> <given-names>A</given-names></name><name><surname>Zhang</surname> <given-names>H</given-names></name><name><surname>Zeng</surname> <given-names>C</given-names></name><name><surname>Zhao</surname> <given-names>H</given-names></name><name><surname>Matsuda</surname> <given-names>I</given-names></name><name><surname>Fukushima</surname> <given-names>Y</given-names></name><name><surname>Macer</surname> <given-names>DR</given-names></name><name><surname>Suda</surname> <given-names>E</given-names></name><name><surname>Rotimi</surname> <given-names>CN</given-names></name><name><surname>Adebamowo</surname> <given-names>CA</given-names></name><name><surname>Ajayi</surname> <given-names>I</given-names></name><name><surname>Aniagwu</surname> <given-names>T</given-names></name><name><surname>Marshall</surname> <given-names>PA</given-names></name><name><surname>Nkwodimmah</surname> <given-names>C</given-names></name><name><surname>Royal</surname> <given-names>CD</given-names></name><name><surname>Leppert</surname> <given-names>MF</given-names></name><name><surname>Dixon</surname> <given-names>M</given-names></name><name><surname>Peiffer</surname> <given-names>A</given-names></name><name><surname>Qiu</surname> <given-names>R</given-names></name><name><surname>Kent</surname> <given-names>A</given-names></name><name><surname>Kato</surname> <given-names>K</given-names></name><name><surname>Niikawa</surname> <given-names>N</given-names></name><name><surname>Adewole</surname> <given-names>IF</given-names></name><name><surname>Knoppers</surname> <given-names>BM</given-names></name><name><surname>Foster</surname> <given-names>MW</given-names></name><name><surname>Clayton</surname> <given-names>EW</given-names></name><name><surname>Watkin</surname> <given-names>J</given-names></name><name><surname>Gibbs</surname> <given-names>RA</given-names></name><name><surname>Belmont</surname> <given-names>JW</given-names></name><name><surname>Muzny</surname> <given-names>D</given-names></name><name><surname>Nazareth</surname> <given-names>L</given-names></name><name><surname>Sodergren</surname> <given-names>E</given-names></name><name><surname>Weinstock</surname> <given-names>GM</given-names></name><name><surname>Wheeler</surname> <given-names>DA</given-names></name><name><surname>Yakub</surname> <given-names>I</given-names></name><name><surname>Gabriel</surname> <given-names>SB</given-names></name><name><surname>Onofrio</surname> <given-names>RC</given-names></name><name><surname>Richter</surname> <given-names>DJ</given-names></name><name><surname>Ziaugra</surname> <given-names>L</given-names></name><name><surname>Birren</surname> <given-names>BW</given-names></name><name><surname>Daly</surname> <given-names>MJ</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Wilson</surname> <given-names>RK</given-names></name><name><surname>Fulton</surname> <given-names>LL</given-names></name><name><surname>Rogers</surname> <given-names>J</given-names></name><name><surname>Burton</surname> <given-names>J</given-names></name><name><surname>Carter</surname> <given-names>NP</given-names></name><name><surname>Clee</surname> <given-names>CM</given-names></name><name><surname>Griffiths</surname> <given-names>M</given-names></name><name><surname>Jones</surname> <given-names>MC</given-names></name><name><surname>McLay</surname> <given-names>K</given-names></name><name><surname>Plumb</surname> <given-names>RW</given-names></name><name><surname>Ross</surname> <given-names>MT</given-names></name><name><surname>Sims</surname> <given-names>SK</given-names></name><name><surname>Willey</surname> <given-names>DL</given-names></name><name><surname>Chen</surname> <given-names>Z</given-names></name><name><surname>Han</surname> <given-names>H</given-names></name><name><surname>Kang</surname> <given-names>L</given-names></name><name><surname>Godbout</surname> <given-names>M</given-names></name><name><surname>Wallenburg</surname> <given-names>JC</given-names></name><name><surname>L'Archevêque</surname> <given-names>P</given-names></name><name><surname>Bellemare</surname> <given-names>G</given-names></name><name><surname>Saeki</surname> <given-names>K</given-names></name><name><surname>Wang</surname> <given-names>H</given-names></name><name><surname>An</surname> <given-names>D</given-names></name><name><surname>Fu</surname> <given-names>H</given-names></name><name><surname>Li</surname> <given-names>Q</given-names></name><name><surname>Wang</surname> <given-names>Z</given-names></name><name><surname>Wang</surname> <given-names>R</given-names></name><name><surname>Holden</surname> <given-names>AL</given-names></name><name><surname>Brooks</surname> <given-names>LD</given-names></name><name><surname>McEwen</surname> <given-names>JE</given-names></name><name><surname>Guyer</surname> <given-names>MS</given-names></name><name><surname>Wang</surname> <given-names>VO</given-names></name><name><surname>Peterson</surname> <given-names>JL</given-names></name><name><surname>Shi</surname> <given-names>M</given-names></name><name><surname>Spiegel</surname> <given-names>J</given-names></name><name><surname>Sung</surname> <given-names>LM</given-names></name><name><surname>Zacharia</surname> <given-names>LF</given-names></name><name><surname>Collins</surname> <given-names>FS</given-names></name><name><surname>Kennedy</surname> <given-names>K</given-names></name><name><surname>Jamieson</surname> <given-names>R</given-names></name><name><surname>Stewart</surname> <given-names>J</given-names></name><collab>International HapMap Consortium</collab></person-group><year iso-8601-date="2007">2007</year><article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title><source>Nature</source><volume>449</volume><fpage>851</fpage><lpage>861</lpage><pub-id pub-id-type="doi">10.1038/nature06258</pub-id><pub-id pub-id-type="pmid">17943122</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greshake</surname> <given-names>B</given-names></name><name><surname>Bayer</surname> <given-names>PE</given-names></name><name><surname>Rausch</surname> <given-names>H</given-names></name><name><surname>Reda</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>openSNP--a crowdsourced web resource for personal genomics</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e89204</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0089204</pub-id><pub-id pub-id-type="pmid">24647222</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greytak</surname> <given-names>EM</given-names></name><name><surname>Kaye</surname> <given-names>DH</given-names></name><name><surname>Budowle</surname> <given-names>B</given-names></name><name><surname>Moore</surname> <given-names>C</given-names></name><name><surname>Armentrout</surname> <given-names>SL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Privacy and genetic genealogy data</article-title><source>Science</source><volume>361</volume><elocation-id>857</elocation-id><pub-id pub-id-type="doi">10.1126/science.aav0330</pub-id><pub-id pub-id-type="pmid">30166479</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gusev</surname> <given-names>A</given-names></name><name><surname>Lowe</surname> <given-names>JK</given-names></name><name><surname>Stoffel</surname> <given-names>M</given-names></name><name><surname>Daly</surname> <given-names>MJ</given-names></name><name><surname>Altshuler</surname> <given-names>D</given-names></name><name><surname>Breslow</surname> <given-names>JL</given-names></name><name><surname>Friedman</surname> <given-names>JM</given-names></name><name><surname>Pe'er</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Whole population, genome-wide mapping of hidden relatedness</article-title><source>Genome Research</source><volume>19</volume><fpage>318</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1101/gr.081398.108</pub-id><pub-id pub-id-type="pmid">18971310</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gymrek</surname> <given-names>M</given-names></name><name><surname>McGuire</surname> <given-names>AL</given-names></name><name><surname>Golan</surname> <given-names>D</given-names></name><name><surname>Halperin</surname> <given-names>E</given-names></name><name><surname>Erlich</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Identifying personal genomes by surname inference</article-title><source>Science</source><volume>339</volume><fpage>321</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1126/science.1229566</pub-id><pub-id pub-id-type="pmid">23329047</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname> <given-names>E</given-names></name><name><surname>Carbonetto</surname> <given-names>P</given-names></name><name><surname>Curtis</surname> <given-names>RE</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Granka</surname> <given-names>JM</given-names></name><name><surname>Byrnes</surname> <given-names>J</given-names></name><name><surname>Noto</surname> <given-names>K</given-names></name><name><surname>Kermany</surname> <given-names>AR</given-names></name><name><surname>Myres</surname> <given-names>NM</given-names></name><name><surname>Barber</surname> <given-names>MJ</given-names></name><name><surname>Rand</surname> <given-names>KA</given-names></name><name><surname>Song</surname> <given-names>S</given-names></name><name><surname>Roman</surname> <given-names>T</given-names></name><name><surname>Battat</surname> <given-names>E</given-names></name><name><surname>Elyashiv</surname> <given-names>E</given-names></name><name><surname>Guturu</surname> <given-names>H</given-names></name><name><surname>Hong</surname> <given-names>EL</given-names></name><name><surname>Chahine</surname> <given-names>KG</given-names></name><name><surname>Ball</surname> <given-names>CA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Clustering of 770,000 genomes reveals post-colonial population structure of north america</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14238</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14238</pub-id><pub-id pub-id-type="pmid">28169989</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname> <given-names>D</given-names></name><name><surname>Furlotte</surname> <given-names>NA</given-names></name><name><surname>Hormozdiari</surname> <given-names>F</given-names></name><name><surname>Joo</surname> <given-names>JW</given-names></name><name><surname>Wadia</surname> <given-names>A</given-names></name><name><surname>Ostrovsky</surname> <given-names>R</given-names></name><name><surname>Sahai</surname> <given-names>A</given-names></name><name><surname>Eskin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Identifying genetic relatives without compromising privacy</article-title><source>Genome Research</source><volume>24</volume><fpage>664</fpage><lpage>672</lpage><pub-id pub-id-type="doi">10.1101/gr.153346.112</pub-id><pub-id pub-id-type="pmid">24614977</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henn</surname> <given-names>BM</given-names></name><name><surname>Hon</surname> <given-names>L</given-names></name><name><surname>Macpherson</surname> <given-names>JM</given-names></name><name><surname>Eriksson</surname> <given-names>N</given-names></name><name><surname>Saxonov</surname> <given-names>S</given-names></name><name><surname>Pe'er</surname> <given-names>I</given-names></name><name><surname>Mountain</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cryptic distant relatives are common in both isolated and cosmopolitan genetic samples</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e34267</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0034267</pub-id><pub-id pub-id-type="pmid">22509285</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hogarth</surname> <given-names>S</given-names></name><name><surname>Javitt</surname> <given-names>G</given-names></name><name><surname>Melzer</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The current landscape for direct-to-consumer genetic testing: legal, ethical, and policy issues</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>9</volume><fpage>161</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1146/annurev.genom.9.081307.164319</pub-id><pub-id pub-id-type="pmid">18767961</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hogarth</surname> <given-names>S</given-names></name><name><surname>Saukko</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A market in the making: the past, present and future of direct-to-consumer genomics</article-title><source>New Genetics and Society</source><volume>36</volume><fpage>197</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1080/14636778.2017.1354692</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homer</surname> <given-names>N</given-names></name><name><surname>Szelinger</surname> <given-names>S</given-names></name><name><surname>Redman</surname> <given-names>M</given-names></name><name><surname>Duggan</surname> <given-names>D</given-names></name><name><surname>Tembe</surname> <given-names>W</given-names></name><name><surname>Muehling</surname> <given-names>J</given-names></name><name><surname>Pearson</surname> <given-names>JV</given-names></name><name><surname>Stephan</surname> <given-names>DA</given-names></name><name><surname>Nelson</surname> <given-names>SF</given-names></name><name><surname>Craig</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Resolving individuals contributing trace amounts of DNA to highly complex mixtures using high-density SNP genotyping microarrays</article-title><source>PLOS Genetics</source><volume>4</volume><elocation-id>e1000167</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000167</pub-id><pub-id pub-id-type="pmid">18769715</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="patent"><person-group person-group-type="inventor"><name><surname>Hon</surname> <given-names>L</given-names></name><name><surname>Saxonov</surname> <given-names>S</given-names></name><name><surname>Naughton</surname> <given-names>BT</given-names></name><name><surname>Mountain</surname> <given-names>JL</given-names></name><name><surname>Wojcicki</surname> <given-names>A</given-names></name><name><surname>Avey</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Finding relatives in a database</article-title><source>United States Patent</source><patent country="United States">8463554</patent><ext-link ext-link-type="uri" xlink:href="http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO1&amp;Sect2=HITOFF&amp;p=1&amp;u=/netahtml/PTO/srchnum.html&amp;r=1&amp;f=G&amp;l=50&amp;d=PALL&amp;s1=8463554.PN">http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO1&amp;Sect2=HITOFF&amp;p=1&amp;u=/netahtml/PTO/srchnum.html&amp;r=1&amp;f=G&amp;l=50&amp;d=PALL&amp;s1=8463554.PN</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>L</given-names></name><name><surname>Bercovici</surname> <given-names>S</given-names></name><name><surname>Rodriguez</surname> <given-names>JM</given-names></name><name><surname>Batzoglou</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>An effective filter for IBD detection in large data sets</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e92713</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0092713</pub-id><pub-id pub-id-type="pmid">24667521</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huff</surname> <given-names>CD</given-names></name><name><surname>Witherspoon</surname> <given-names>DJ</given-names></name><name><surname>Simonson</surname> <given-names>TS</given-names></name><name><surname>Xing</surname> <given-names>J</given-names></name><name><surname>Watkins</surname> <given-names>WS</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Tuohy</surname> <given-names>TM</given-names></name><name><surname>Neklason</surname> <given-names>DW</given-names></name><name><surname>Burt</surname> <given-names>RW</given-names></name><name><surname>Guthery</surname> <given-names>SL</given-names></name><name><surname>Woodward</surname> <given-names>SR</given-names></name><name><surname>Jorde</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Maximum-likelihood estimation of recent shared ancestry (ERSA)</article-title><source>Genome Research</source><volume>21</volume><fpage>768</fpage><lpage>774</lpage><pub-id pub-id-type="doi">10.1101/gr.115972.110</pub-id><pub-id pub-id-type="pmid">21324875</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Humbert</surname> <given-names>M</given-names></name><name><surname>Ayday</surname> <given-names>E</given-names></name><name><surname>Hubaux</surname> <given-names>J-P</given-names></name><name><surname>Telenti</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Addressing the concerns of the lacks family: quantification of kin genomic privacy</article-title><conf-name>Proceedings of the 2013 ACM SIGSAC Conference on Computer &amp; Communications Security</conf-name><fpage>1141</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1145/2508859.2516707</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humbert</surname> <given-names>M</given-names></name><name><surname>Huguenin</surname> <given-names>K</given-names></name><name><surname>Hugonot</surname> <given-names>J</given-names></name><name><surname>Ayday</surname> <given-names>E</given-names></name><name><surname>Hubaux</surname> <given-names>J-P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>De-anonymizing genomic databases using phenotypic traits</article-title><source>Proceedings on Privacy Enhancing Technologies</source><volume>2015</volume><fpage>99</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1515/popets-2015-0020</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Im</surname> <given-names>HK</given-names></name><name><surname>Gamazon</surname> <given-names>ER</given-names></name><name><surname>Nicolae</surname> <given-names>DL</given-names></name><name><surname>Cox</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>On sharing quantitative trait gwas results in an era of multiple-omics data and the limits of genomic privacy</article-title><source>American Journal of Human Genetics</source><volume>90</volume><fpage>591</fpage><lpage>598</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2012.02.008</pub-id><pub-id pub-id-type="pmid">22463877</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennett</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Using genetic genealogy databases in missing persons cases and to develop suspect leads in violent crimes</article-title><source>Forensic Science International</source><volume>301</volume><fpage>107</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1016/j.forsciint.2019.05.016</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kere</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Human population genetics: lessons from Finland</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>2</volume><fpage>103</fpage><lpage>128</lpage><pub-id pub-id-type="doi">10.1146/annurev.genom.2.1.103</pub-id><pub-id pub-id-type="pmid">11701645</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname> <given-names>R</given-names></name><name><surname>Mittelman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Consumer genomics will change your life, whether you get tested or not</article-title><source>Genome Biology</source><volume>19</volume><elocation-id>120</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-018-1506-1</pub-id><pub-id pub-id-type="pmid">30124172</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>J</given-names></name><name><surname>Edge</surname> <given-names>MD</given-names></name><name><surname>Algee-Hewitt</surname> <given-names>BFB</given-names></name><name><surname>Li</surname> <given-names>JZ</given-names></name><name><surname>Rosenberg</surname> <given-names>NA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Statistical detection of relatives typed with disjoint forensic and biomedical loci</article-title><source>Cell</source><volume>175</volume><fpage>848</fpage><lpage>858</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.09.008</pub-id><pub-id pub-id-type="pmid">30318150</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Larkin</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Cystic fibrosis: a case study in genetic privacy</article-title><source>The DNA Geek</source><ext-link ext-link-type="uri" xlink:href="https://thednageek.com/cystic-fibrosis-a-case-study-in-genetic-privacy/">https://thednageek.com/cystic-fibrosis-a-case-study-in-genetic-privacy/</ext-link><date-in-citation iso-8601-date="2019-07-01">July 1, 2019</date-in-citation></element-citation></ref><ref id="bib48"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Larkin</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Database sizes—September 2018 update</article-title><source>The DNA Geek</source><ext-link ext-link-type="uri" xlink:href="https://thednageek.com/database-sizes-september-2018-update/">https://thednageek.com/database-sizes-september-2018-update/</ext-link><date-in-citation iso-8601-date="2019-07-01">July 1, 2019</date-in-citation></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname> <given-names>M</given-names></name><name><surname>Huber</surname> <given-names>W</given-names></name><name><surname>Pagès</surname> <given-names>H</given-names></name><name><surname>Aboyoun</surname> <given-names>P</given-names></name><name><surname>Carlson</surname> <given-names>M</given-names></name><name><surname>Gentleman</surname> <given-names>R</given-names></name><name><surname>Morgan</surname> <given-names>MT</given-names></name><name><surname>Carey</surname> <given-names>VJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Software for computing and annotating genomic ranges</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003118</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id><pub-id pub-id-type="pmid">23950696</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title><source>Bioinformatics</source><volume>27</volume><fpage>2987</fpage><lpage>2993</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id><pub-id pub-id-type="pmid">21903627</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loh</surname> <given-names>PR</given-names></name><name><surname>Palamara</surname> <given-names>PF</given-names></name><name><surname>Price</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fast and accurate long-range phasing in a UK biobank cohort</article-title><source>Nature Genetics</source><volume>48</volume><fpage>811</fpage><lpage>816</lpage><pub-id pub-id-type="doi">10.1038/ng.3571</pub-id><pub-id pub-id-type="pmid">27270109</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McQuillan</surname> <given-names>R</given-names></name><name><surname>Leutenegger</surname> <given-names>AL</given-names></name><name><surname>Abdel-Rahman</surname> <given-names>R</given-names></name><name><surname>Franklin</surname> <given-names>CS</given-names></name><name><surname>Pericic</surname> <given-names>M</given-names></name><name><surname>Barac-Lauc</surname> <given-names>L</given-names></name><name><surname>Smolej-Narancic</surname> <given-names>N</given-names></name><name><surname>Janicijevic</surname> <given-names>B</given-names></name><name><surname>Polasek</surname> <given-names>O</given-names></name><name><surname>Tenesa</surname> <given-names>A</given-names></name><name><surname>Macleod</surname> <given-names>AK</given-names></name><name><surname>Farrington</surname> <given-names>SM</given-names></name><name><surname>Rudan</surname> <given-names>P</given-names></name><name><surname>Hayward</surname> <given-names>C</given-names></name><name><surname>Vitart</surname> <given-names>V</given-names></name><name><surname>Rudan</surname> <given-names>I</given-names></name><name><surname>Wild</surname> <given-names>SH</given-names></name><name><surname>Dunlop</surname> <given-names>MG</given-names></name><name><surname>Wright</surname> <given-names>AF</given-names></name><name><surname>Campbell</surname> <given-names>H</given-names></name><name><surname>Wilson</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Runs of homozygosity in European populations</article-title><source>The American Journal of Human Genetics</source><volume>83</volume><fpage>359</fpage><lpage>372</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2008.08.007</pub-id><pub-id pub-id-type="pmid">18760389</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naveed</surname> <given-names>M</given-names></name><name><surname>Ayday</surname> <given-names>E</given-names></name><name><surname>Clayton</surname> <given-names>EW</given-names></name><name><surname>Fellay</surname> <given-names>J</given-names></name><name><surname>Gunter</surname> <given-names>CA</given-names></name><name><surname>Hubaux</surname> <given-names>J-P</given-names></name><name><surname>Malin</surname> <given-names>BA</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Privacy in the genomic era</article-title><source>ACM Computing Surveys</source><volume>48</volume><fpage>1</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1145/2767007</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ney</surname> <given-names>PM</given-names></name><name><surname>Ceze</surname> <given-names>L</given-names></name><name><surname>Kohno</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Computer security risks of distant Rela<italic>tive Matching in Consumer Genetic Databases CoRR</italic></article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1810.02895">https://arxiv.org/abs/1810.02895</ext-link></element-citation></ref><ref id="bib55"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Ney</surname> <given-names>P</given-names></name><name><surname>Ceze</surname> <given-names>L</given-names></name><name><surname>Kohno</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Genotype extraction and false relative attacks: Security Risks to Third-Party Genetic Genealogy Services Beyond Identity Inference</article-title><source>Network and Distributed System Security Symposium (NDSS)</source><ext-link ext-link-type="uri" xlink:href="https://dnasec.cs.washington.edu/genetic-genealogy/ney_ndss.pdf">https://dnasec.cs.washington.edu/genetic-genealogy/ney_ndss.pdf</ext-link></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nyholt</surname> <given-names>DR</given-names></name><name><surname>Yu</surname> <given-names>CE</given-names></name><name><surname>Visscher</surname> <given-names>PM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>On Jim Watson's APOE status: genetic information is hard to hide</article-title><source>European Journal of Human Genetics</source><volume>17</volume><fpage>147</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1038/ejhg.2008.198</pub-id><pub-id pub-id-type="pmid">18941475</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palamara</surname> <given-names>PF</given-names></name><name><surname>Lencz</surname> <given-names>T</given-names></name><name><surname>Darvasi</surname> <given-names>A</given-names></name><name><surname>Pe'er</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Length distributions of identity by descent reveal fine-scale demographic history</article-title><source>The American Journal of Human Genetics</source><volume>91</volume><fpage>809</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2012.08.030</pub-id><pub-id pub-id-type="pmid">23103233</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panoutsopoulou</surname> <given-names>K</given-names></name><name><surname>Hatzikotoulas</surname> <given-names>K</given-names></name><name><surname>Xifara</surname> <given-names>DK</given-names></name><name><surname>Colonna</surname> <given-names>V</given-names></name><name><surname>Farmaki</surname> <given-names>AE</given-names></name><name><surname>Ritchie</surname> <given-names>GR</given-names></name><name><surname>Southam</surname> <given-names>L</given-names></name><name><surname>Gilly</surname> <given-names>A</given-names></name><name><surname>Tachmazidou</surname> <given-names>I</given-names></name><name><surname>Fatumo</surname> <given-names>S</given-names></name><name><surname>Matchan</surname> <given-names>A</given-names></name><name><surname>Rayner</surname> <given-names>NW</given-names></name><name><surname>Ntalla</surname> <given-names>I</given-names></name><name><surname>Mezzavilla</surname> <given-names>M</given-names></name><name><surname>Chen</surname> <given-names>Y</given-names></name><name><surname>Kiagiadaki</surname> <given-names>C</given-names></name><name><surname>Zengini</surname> <given-names>E</given-names></name><name><surname>Mamakou</surname> <given-names>V</given-names></name><name><surname>Athanasiadis</surname> <given-names>A</given-names></name><name><surname>Giannakopoulou</surname> <given-names>M</given-names></name><name><surname>Kariakli</surname> <given-names>VE</given-names></name><name><surname>Nsubuga</surname> <given-names>RN</given-names></name><name><surname>Karabarinde</surname> <given-names>A</given-names></name><name><surname>Sandhu</surname> <given-names>M</given-names></name><name><surname>McVean</surname> <given-names>G</given-names></name><name><surname>Tyler-Smith</surname> <given-names>C</given-names></name><name><surname>Tsafantakis</surname> <given-names>E</given-names></name><name><surname>Karaleftheri</surname> <given-names>M</given-names></name><name><surname>Xue</surname> <given-names>Y</given-names></name><name><surname>Dedoussis</surname> <given-names>G</given-names></name><name><surname>Zeggini</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Genetic characterization of greek population isolates reveals strong genetic drift at Missense and trait-associated variants</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>5345</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms6345</pub-id><pub-id pub-id-type="pmid">25373335</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname> <given-names>N</given-names></name><name><surname>Moorjani</surname> <given-names>P</given-names></name><name><surname>Luo</surname> <given-names>Y</given-names></name><name><surname>Mallick</surname> <given-names>S</given-names></name><name><surname>Rohland</surname> <given-names>N</given-names></name><name><surname>Zhan</surname> <given-names>Y</given-names></name><name><surname>Genschoreck</surname> <given-names>T</given-names></name><name><surname>Webster</surname> <given-names>T</given-names></name><name><surname>Reich</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Ancient admixture in human history</article-title><source>Genetics</source><volume>192</volume><fpage>1065</fpage><lpage>1093</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.145037</pub-id><pub-id pub-id-type="pmid">22960212</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pemberton</surname> <given-names>TJ</given-names></name><name><surname>Absher</surname> <given-names>D</given-names></name><name><surname>Feldman</surname> <given-names>MW</given-names></name><name><surname>Myers</surname> <given-names>RM</given-names></name><name><surname>Rosenberg</surname> <given-names>NA</given-names></name><name><surname>Li</surname> <given-names>JZ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Genomic patterns of homozygosity in worldwide human populations</article-title><source>The American Journal of Human Genetics</source><volume>91</volume><fpage>275</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2012.06.014</pub-id><pub-id pub-id-type="pmid">22883143</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname> <given-names>AL</given-names></name><name><surname>Patterson</surname> <given-names>NJ</given-names></name><name><surname>Plenge</surname> <given-names>RM</given-names></name><name><surname>Weinblatt</surname> <given-names>ME</given-names></name><name><surname>Shadick</surname> <given-names>NA</given-names></name><name><surname>Reich</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title><source>Nature Genetics</source><volume>38</volume><fpage>904</fpage><lpage>909</lpage><pub-id pub-id-type="doi">10.1038/ng1847</pub-id><pub-id pub-id-type="pmid">16862161</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Purcell</surname> <given-names>S</given-names></name><name><surname>Neale</surname> <given-names>B</given-names></name><name><surname>Todd-Brown</surname> <given-names>K</given-names></name><name><surname>Thomas</surname> <given-names>L</given-names></name><name><surname>Ferreira</surname> <given-names>MAR</given-names></name><name><surname>Bender</surname> <given-names>D</given-names></name><name><surname>Maller</surname> <given-names>J</given-names></name><name><surname>Sklar</surname> <given-names>P</given-names></name><name><surname>de Bakker</surname> <given-names>PIW</given-names></name><name><surname>Daly</surname> <given-names>MJ</given-names></name><name><surname>Sham</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>PLINK: a tool set for Whole-Genome association and Population-Based linkage analyses</article-title><source>The American Journal of Human Genetics</source><volume>81</volume><fpage>559</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1086/519795</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="software"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group><year iso-8601-date="2013">2013</year><data-title>R: a language and environment for statistical computing</data-title><publisher-loc>Vienna, Austria</publisher-loc><publisher-name>R Foundation for Statistical Computing</publisher-name><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/">http://www.R-project.org/</ext-link></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ralph</surname> <given-names>P</given-names></name><name><surname>Coop</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The geography of recent genetic ancestry across Europe</article-title><source>PLOS Biology</source><volume>11</volume><elocation-id>e1001555</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001555</pub-id><pub-id pub-id-type="pmid">23667324</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ram</surname> <given-names>N</given-names></name><name><surname>Guerrini</surname> <given-names>CJ</given-names></name><name><surname>McGuire</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Genealogy databases and the future of criminal investigation</article-title><source>Science</source><volume>360</volume><fpage>1078</fpage><lpage>1079</lpage><pub-id pub-id-type="doi">10.1126/science.aau1083</pub-id><pub-id pub-id-type="pmid">29880677</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramstetter</surname> <given-names>MD</given-names></name><name><surname>Dyer</surname> <given-names>TD</given-names></name><name><surname>Lehman</surname> <given-names>DM</given-names></name><name><surname>Curran</surname> <given-names>JE</given-names></name><name><surname>Duggirala</surname> <given-names>R</given-names></name><name><surname>Blangero</surname> <given-names>J</given-names></name><name><surname>Mezey</surname> <given-names>JG</given-names></name><name><surname>Williams</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Benchmarking relatedness inference methods with Genome-Wide data from thousands of relatives</article-title><source>Genetics</source><volume>207</volume><fpage>75</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1534/genetics.117.1122</pub-id><pub-id pub-id-type="pmid">28739658</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramstetter</surname> <given-names>MD</given-names></name><name><surname>Shenoy</surname> <given-names>SA</given-names></name><name><surname>Dyer</surname> <given-names>TD</given-names></name><name><surname>Lehman</surname> <given-names>DM</given-names></name><name><surname>Curran</surname> <given-names>JE</given-names></name><name><surname>Duggirala</surname> <given-names>R</given-names></name><name><surname>Blangero</surname> <given-names>J</given-names></name><name><surname>Mezey</surname> <given-names>JG</given-names></name><name><surname>Williams</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inferring Identical-by-Descent sharing of sample ancestors promotes High-Resolution relative detection</article-title><source>The American Journal of Human Genetics</source><volume>103</volume><fpage>30</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2018.05.008</pub-id><pub-id pub-id-type="pmid">29937093</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Regalado</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><source>More Than 26 Million People Have Taken an at-Home Ancestry Test</source><publisher-name>MIT Technology Review</publisher-name></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohlfs</surname> <given-names>RV</given-names></name><name><surname>Fullerton</surname> <given-names>SM</given-names></name><name><surname>Weir</surname> <given-names>BS</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Familial identification: population structure and relationship distinguishability</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1002469</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002469</pub-id><pub-id pub-id-type="pmid">22346758</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scudder</surname> <given-names>N</given-names></name><name><surname>McNevin</surname> <given-names>D</given-names></name><name><surname>Kelty</surname> <given-names>SF</given-names></name><name><surname>Funk</surname> <given-names>C</given-names></name><name><surname>Walsh</surname> <given-names>SJ</given-names></name><name><surname>Robertson</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Policy and regulatory implications of the new frontier of forensic genomics: direct-to-consumer genetic data and genealogy records</article-title><source>Current Issues in Criminal Justice</source><volume>31</volume><fpage>194</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1080/10345329.2018.1560588</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname> <given-names>S</given-names></name><name><surname>Yuan</surname> <given-names>N</given-names></name><name><surname>Yang</surname> <given-names>M</given-names></name><name><surname>Du</surname> <given-names>Z</given-names></name><name><surname>Wang</surname> <given-names>J</given-names></name><name><surname>Sheng</surname> <given-names>X</given-names></name><name><surname>Wu</surname> <given-names>J</given-names></name><name><surname>Xiao</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Comprehensive assessment of genotype imputation performance</article-title><source>Human Heredity</source><volume>83</volume><fpage>107</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1159/000489758</pub-id><pub-id pub-id-type="pmid">30669139</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shringarpure</surname> <given-names>SS</given-names></name><name><surname>Bustamante</surname> <given-names>CD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Privacy risks from genomic Data-Sharing beacons</article-title><source>The American Journal of Human Genetics</source><volume>97</volume><fpage>631</fpage><lpage>646</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.09.010</pub-id><pub-id pub-id-type="pmid">26522470</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Staples</surname> <given-names>J</given-names></name><name><surname>Witherspoon</surname> <given-names>DJ</given-names></name><name><surname>Jorde</surname> <given-names>LB</given-names></name><name><surname>Nickerson</surname> <given-names>DA</given-names></name><name><surname>Below</surname> <given-names>JE</given-names></name><name><surname>Huff</surname> <given-names>CD</given-names></name><collab>University of Washington Center for Mendelian Genomics</collab></person-group><year iso-8601-date="2016">2016</year><article-title>PADRE: pedigree-aware Distant-Relationship estimation</article-title><source>The American Journal of Human Genetics</source><volume>99</volume><fpage>154</fpage><lpage>162</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2016.05.020</pub-id><pub-id pub-id-type="pmid">27374771</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Syndercombe Court</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Forensic genealogy: some serious concerns</article-title><source>Forensic Science International: Genetics</source><volume>36</volume><fpage>203</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1016/j.fsigen.2018.07.011</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thompson</surname> <given-names>EA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Identity by descent: variation in meiosis, across genomes, and in populations</article-title><source>Genetics</source><volume>194</volume><fpage>301</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.148825</pub-id><pub-id pub-id-type="pmid">23733848</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname> <given-names>Y</given-names></name><name><surname>Yang</surname> <given-names>Z</given-names></name><name><surname>Wang</surname> <given-names>C</given-names></name><name><surname>Boutell</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Breaking google recaptcha v2</article-title><source>J. Comput. Sci. Coll</source><volume>34</volume><fpage>126</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.17223/2226308X/11/30</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>Detailed rationale for proposed countermeasures</title><boxed-text><p>Here, we detail the rationale and possible advantages and disadvantages of the countermeasures listed in <xref ref-type="table" rid="table2">Table 2</xref>.</p><list list-type="order"><list-item><p>Require uploaded files to include cryptographic signatures identifying their source. This recommendation was initially made by <xref ref-type="bibr" rid="bib24">Erlich et al. (2018)</xref>. Under this suggestion, DTC genetics services would cryptographically sign the genetic data files they provide to users. Upload services might then check for a signature from an approved DTC service on each uploaded dataset, blocking datasets from upload otherwise. An alternative procedure that would accomplish the same goal would be for the DTC entities to exchange data directly at the user’s request (<xref ref-type="bibr" rid="bib54">Ney et al., 2018</xref>). Such a procedure would allow upload services to know the source of the files they analyze and to disallow uploaded datasets produced by non-approved entities and user-modified datasets. All the methods we describe require the upload of multiple genetic datasets. As such, requiring cryptographic signatures would force the adversary to have multiple biological samples analyzed by a DTC service in order to implement any of our procedures, and IBS probing and IBS baiting would require synthetic samples, which are much harder to produce than fake datasets. Another benefit of this approach is that it would protect research participants against being reidentified using DTC genetic genealogy services (<xref ref-type="bibr" rid="bib24">Erlich et al., 2018</xref>). A disadvantage of this strategy is that it requires the cooperation of several distinct DTC services.</p></list-item><list-item><p>Restrict reporting of IBS to long segments. Reporting short IBS segments increases the typical coverage of IBS tiling (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and IBS probing (<xref ref-type="fig" rid="fig3">Figure 3</xref>), as well as the efficiency of IBS baiting. Very short blocks may be of little practical utility for genetic genealogy (<xref ref-type="bibr" rid="bib39">Huff et al., 2011</xref>). Reporting only segments longer than 8 cM would substantially limit IBS tiling attacks. A partially effective variant of this strategy is to report short segments only for pairs of people who share at least one long segment (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). One disadvantage is that short segments, though less reliably inferred than longer segments, may still be of interest to genealogists.</p></list-item><list-item><p>Do not report locations of IBS segments. Another tactic for preventing IBS tiling is not to report chromosomal locations at all. If chromosomal locations are not reported, IBS tiling as we have described it becomes impossible.</p></list-item><list-item><p>Block uploads of genomes with excessive homozygosity. IBS tiling is especially informative if genotypes that are homozygous for phased haplotypes are uploaded, so blocking genomes with excessive homozygosity presents a barrier to IBS tiling attacks. However, runs of homozygosity occur naturally (<xref ref-type="bibr" rid="bib60">Pemberton et al., 2012</xref>), and allowing for naturally occurring patterns of homozygosity would leave a loophole for an adversary who could upload many genotypes, using including homozygous regions and using only those for tiling.</p></list-item><list-item><p>Report only a small number of putative relatives per uploaded kit. Reporting only the closest relatives (say the 50 - 100 closest relatives) of an uploaded kit would decrease the efficiency of all the methods we describe here. Only a small number of people could have their privacy compromised by each upload. This countermeasure comes with costs to genealogists, who may want to explore as many matches as possible in order to build family trees.</p></list-item><list-item><p>Disallow arbitrary matching between kits. Some services allow searches for IBS between any pair of individuals in the database. Allowing such searches makes all potential IBS attacks easier. This countermeasure might hamper the investigations of genealogists exploring complex hypotheses about relatedness.</p></list-item><list-item><p>Block uploads of publicly available genomes. There are now thousands of genomes available for public download, and these publicly available genomes can be used for IBS tiling. Genetic genealogy databases could include publicly available genomes (potentially without allowing them to be returned as IBS matches for typical users) and flag accounts that upload them. This strategy would go some distance toward blocking IBS tiling, but it could be thwarted in several ways, for example by uploading genetic datasets produced by splicing together haplotypes from publicly available genomes.</p></list-item><list-item><p>Block uploads with evidence of IBS-inert segments. IBS-inert segments—that is false genetic segments designed to be unlikely to be IBS with anyone in the database—are key to IBS probing. Some methods for constructing IBS-inert segments are easy to identify, but others may not be. If a database is large enough, genomes with IBS-inert segments could be identified by looking for genomes that have much less apparent IBS with other database members than might be expected.</p></list-item><list-item><p>Block uploads with long runs of heterozygosity. Long runs of heterozygosity do not arise naturally but are key to the IBS baiting approaches we describe here. Blocking genomes with long runs of heterozygosity—or alternatively, blocking genomes that have much more apparent IBS with a range of other database members than expected—would hamper IBS baiting. However, this countermeasure might be hard to apply to a small-scale IBS baiting attack, where only one or a few short runs of heterozygosity might be necessary. In our sample, the longest run of heterozygosity (in terms of number of SNPs) consisted of 38 SNPs and spanned .06 cM. This suggests that filtering out long runs of heterozygosity might be a promising strategy, though identifying a specific procedure would require more careful consideration of variation in non-European populations and of the composition of commercial SNP chips (including SNP density and allele frequencies).</p></list-item><list-item><p>Use phase-aware methods for IBS detection. Although calling IBS by looking for long segments without incompatible homozygous genotypes scales well to large datasets, such methods are easy to trick, allowing IBS baiting approaches. In addition to allowing IBS estimation methods that are harder to trick, faked samples may stand out as unusual during the process of phasing, raising more opportunities for quality-control checks.</p></list-item></list></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51810.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Nordborg</surname><given-names>Magnus</given-names></name><role>Reviewing Editor</role><aff><institution>Austrian Academy of Sciences</institution><country>Austria</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Williams</surname><given-names>Amy L</given-names></name><role>Reviewer</role><aff><institution>Cornell University</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Carmi</surname><given-names>Shai</given-names> </name><role>Reviewer</role><aff><institution>The Hebrew University of Jerusalem</institution><country>Israel</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>The manuscript shows that genetic databases, like other databases, are vulnerable to being (ab)used in a manner not foreseen by their owners. The presented scenarios are very realistic and I sincerely hope that this article will spur both genetic service firms and politics into action.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Attacks on genetic privacy via uploads to genealogical databases&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by Magnus Nordborg as the Reviewing Editor and Mark McCarthy as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Amy L Williams (Reviewer #1); Shai Carmi (Reviewer #2). The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Direct-to-consumer genetics services are increasingly popular for genetic genealogy, with millions of customers as of 2019. Several DTC genealogy services allow users to upload their own genetic data in order to search for genetic relatives. This paper demonstrates that such services can also be exploited to reveal much about the genome of individuals in the database, without their consent, and with potentially adversarial consequences.</p><p>Essential revisions:</p><p>A major concern was whether you intend this paper as a hypothetical discussion, or as a real-world demonstration. The latter would require real-world examples. Either way, it would be necessary to try to specify the conditions under which this work. For example, your IBD baiting method depends sensitively on the algorithms used by the provider. Thus, at a minimum, we would like to see a general discussion of the limitations of these exploits, and of the parameters that effect their efficacy.</p><p>Needless to say, you should also discuss the recent work of Ney et al., which you are aware of.</p><p><italic>Reviewer #1:</italic></p><p>Edge and Coop outline several means of inferring genotypes of individuals in genetic databases that allow users – specifically an attacker – to upload genetic data. There are three such attacks: (1) IBS tiling, wherein an attacker utilizes inferred IBS regions to N (known) samples to reconstruct the genotypes of others in the database in a genome-wide fashion. (2) IBS probing, with the aim of inferring genotypes at a specific locus (for example, the APOE locus). And (3) IBS baiting, with a more systematic form of probing that, given multiple uploads, may be able to collect enough genotypes to allow imputation of a person's common variants genome-wide.</p><p>The paper is of broad interest given the robust interest in direct-to-consumer genetic testing and the advent of long-range familial searches by law enforcement. The authors have responsibly handled their discoveries, notifying the various companies that host databases vulnerable to these attacks.</p><p>Before it can be published a few technical topics that should be addressed are:</p><p>1) To perform IBS baiting effectively, the (unphased) IBS detector would need to break segments at opposite homozygous genotypes. However, in practice most such detectors would likely be tolerant to errors, and therefore may not break the segments in the fashion the text assumes. This seems like it may pose a serious issue to such an attack, and this merits more careful consideration.</p><p>2) The Supplementary Figure 4 legend says, &quot;All other arguments were kept at their default values. Calling IBS without respect to genotype phase returns many IBS segments, but less can be learned about each segment via tiling than if haplotype phase is respected.&quot; Note that services that I'm aware of do not provide phase to the users, nor allow users to upload phased data. (Please say if this is not the case.) Given this, it's hard to make use of the potential benefits of phased data. In general, this issue merits a more prominent mention – the fact that, if phase were known, the amount of information learned by an attacker is greater, and that (unless services give this information), it's hard to envision how an attacker could put this into practice.</p><p>3) &quot;(We consider some alternative IBS reporting procedures in the supplement.)&quot; Is this about the supplementary figures? If so, perhaps cite them. I wasn't sure if there was text that I missed?</p><p>4) Optionally, the Discussion may wish to expand on the proposals that inhibit genealogical research, which end users may prefer not to have implemented. Points 2, 4, and 5 (since inferring other relatives' relationships can be useful) fall in this category.</p><p><italic>Reviewer #2:</italic></p><p>Conflict of interest:</p><p>The authors have shared the manuscript with me a few weeks ago. I have discussed my thoughts with the authors and they have revised their manuscript according to some of my comments, acknowledging me at the end of the paper. The review below is a slightly edited and expanded version of the remaining comments.</p><p>General assessment:</p><p>Edge and Coop describe a method for breaching privacy of genomes deposited in genetic genealogy matching services. The key idea is that a genetic match between a (known) uploaded genome and a target genome reveals some DNA sequence of the target. This can be exploited to recover large proportions of the target's genome. This is a novel and innovative approach. The manuscript is very interesting and thought provoking and the results are important. The analysis is overall sound (but see the points below). I am certain that the results will have major implications on genetic genealogy, genetic privacy, and beyond.</p><p>1) A result I find intriguing is the high proportion of the genome that can be covered by IBS tiling, which is comparable only to what was previously seen in founder populations. I suggest the following. (All the requested data should be already available to the authors or require very quick experiments.)</p><p>a) Show a breakdown of the coverage by ethnicity (at least for the main ethnicities), to make the results a bit more comparable to previous studies.</p><p>b) Further emphasize the message that segments need not be IBD (identity-by-descent) to allow privacy breaching – rather, IBS (identity-by-state) is good enough. This explains to some extent why the proportions of genome covered are so high, even though these are (mostly) not founder populations.</p><p>c) I think the results of Figure 2—figure supplement 3 are important, and should perhaps be reported as the main results. The reason is that when running Germline in haploid mode with no errors allowed, we are guaranteed no mismatches between the target and the (known) uploaded genome. In other words, we have an exact match to at least one haplotype of the target. (The authors can even improve performance easily by using a diploid mode but allowing no errors. Germline would still require a perfect match, but would allow phasing errors if they happen between blocks.) If the authors choose not to change the order of figures, I would recommend to at least report the mismatch rate between the haplotypes that were found to be matching by RefinedIBD in the main analysis (Figure 2).</p><p>d) Regarding Supplementary Figure 4, I think this figure might be somewhat misleading. The problem with the approach taken to generate that figure (if I'm not mistaken) is that Germline will not try to match any sites where either the target or the uploaded genome are heterozygous. Thus, the coverage is likely inflated – there could be entire &quot;covered&quot; segments that provide very little information on the target. At the very least, the uploaded genome should be made artificially homozygous, so that we are guaranteed to have information on the homozygous genotypes of the target.</p><p>2) It will be important to evaluate the IBS tiling method against a very simple &quot;null&quot;, in which each allele is predicted to be the major (more frequent) allele. In other words, the outcome would be not the proportion of the genome covered, but the proportion of alleles of the target correctly inferred, and this outcome should be compared between IBS tiling and just using the major allele. While this experiment may take a little time (but I believe no more than a few days), I believe it is essential, because otherwise it is difficult to evaluate the success of the proposed method.</p><p>3) I am not confident whether these very elegant results form a practical and immediate risk of privacy, or whether the paper is more of a proof of concept. The biggest problem is with IBS baiting. The success of this approach relies on an IBD detection algorithm that is very simple minded. It is not clear to me whether any of the companies is actually using such an algorithm. But more generally, the authors did not demonstrate an actual recovery of genomic material from a genetic genealogy service using any of their methods. Of course, they would not want, and should not, violate the terms and conditions of any company. But I think that if using research genomes (such as 1000 Genomes) or their own genomes, and limiting the experiment in duration and scale, this would be legitimate. Or the authors could even explicitly ask the companies' managements for permission.</p><p>This is not to say that the article is not worthwhile without such experiments. On the contrary, the paper describes a very novel approach, and it would be extremely important and urgent that the proposed techniques become known to all stakeholders in personal genomics, both from the industry and from the academia, as well as the actual participants. Also, additional experiments may take too much time or be outside the scope of the present paper.</p><p>But as happens frequently with this kind of papers, once they are published, the media and the general public cannot get to the bottom of such subtle nuances (even if authors do their very best). I expect the paper will be very widely covered, and with some likelihood, it could develop into a total media circus and trigger panic. I think that would be an unfortunate consequence, unless there is a real, tangible risk of privacy breaching. If the risk is more theoretical in nature, it will be important to say so explicitly (and possibly drop the part about the letters to the representatives of the companies, which is only going to amplify the drama).</p><p><italic>Reviewer #3:</italic></p><p>Edge and Coop describe a battery of methods that seek to recover parts of a personal genome through segment matching queries in a direct-to-consumer database that facilitates uploads. Specifically, the authors describe methods for tiling the hacked genome with matched segments, probing it for the genotype at a particular locus, or baiting it to match contrived genomes, designed to recover the genotype at a particular site.</p><p>The paper is technically sound. Methodologically, it puts together ideas that had been floated, and actually evaluates them rigorously. In the context of the genetic privacy field, this constitutes and advancement.</p><p>1) This reviewer believes that genetic privacy as a whole is overblown. The impacts of violating it are not substantial, and accepting such work in broadly read venues panders to irrational fears thus does science a disservice. While I don't fault the authors for pushing their work to a visible journal, making this more of a comment to the editor, I would nevertheless welcome the authors' rebuttal. Specifically, I would challenge the statements in the last paragraph of the Discussion regarding trait-predictability of traits. These are upper-bounded by the prediction accuracy implied by SNP heritability (accuracy which is markedly lower than the SNP heritability itself). More practically, the likely improvement in prediction does not mean convergence of prediction even to that bound. Worse, given the non-genetic data trace of individuals today, with more precious predictive value, genetic privacy is a distraction. An example ad absurdum, every street camera recovers my height better than my genome would.</p><p>2) The paper is somewhat thin in results (basically, Figures 2 and 3). In particular, Section 2.3 is falsely appearing under Results, whereas it only describes a method, without even applying it. This defeats the entire purpose of the manuscript, of actually demonstrating the attacks and quantifying their effectiveness. One quantitative question relevant to (defending against) the baiting attack has to do with feasibility of assembling all-het segments from naturally-occurring human haplotypes of chip SNPs. There are back-of-an-envelope reasons to assume those would not be long enough for the described attack, but actual data would be reassuring and consistent with the nature of contributions of this manuscript.</p><p>3) Relatedly, I am specifically concerned regarding the baiting security loophole being practical, as the authors' description of IBS baiting relies on a straw man IBS detector that they construct to have that weakness. As the authors point out, many actual detectors would not willy-nilly extend each segment till conflicting homozygous on both ends, or require some information content to seed a match between segments. Baiting may still be possible, but likely more complicated and potentially impractical.</p><p>4) The results reported are all w.r.t. the general European population. It is important to report the (different) results for other continental ancestries, and, on the other hand, in bottleneck populations.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51810.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>A major concern was whether you intend this paper as a hypothetical discussion, or as a real-world demonstration. The latter would require real-world examples. Either way, it would be necessary to try to specify the conditions under which this work. For example, your IBD baiting method depends sensitively on the algorithms used by the provider. Thus, at a minimum, we would like to see a general discussion of the limitations of these exploits, and of the parameters that effect their efficacy.</p></disp-quote><p>The reviewers’ comments in this area focus on IBS baiting. We have clarified that IBS baiting is possible in GEDmatch (as of Nov and Dec 2019) in two ways: (1) Section VII of Ney et al., which became public shortly after we submitted, executes an attack essentially equivalent to IBS baiting in section VII, and (2) We have performed IBS baiting in a small set of fake genetic datasets that we uploaded to GEDmatch in research mode. (These uploads do not violate GEDmatch’s terms and were determined not to be human subjects research by our university IRB. We also confirmed our plan with GEDmatch before initiating uploads).</p><p>We have also expanded the discussion of the circumstances that would make the attacks harder or easier, clarifying the implications with respect to the various existing genealogy services.</p><disp-quote content-type="editor-comment"><p>Needless to say, you should also discuss the recent work of Ney et al., which you are aware of.</p></disp-quote><p>Yes, we have added discussion of Ney et al., which dovetails well with our results, at various relevant points. We mention this in the manuscript, but we want to state clearly here that the work of Ney et al. was entirely independent of ours; we were unaware of their work until after our manuscript was submitted to <italic>eLife</italic> and bioRxiv. Ney et al. described an exploit on the images provided by GEDmatch’s 1-to-1 search feature. We pointed out that these images were a major security weakness to GEDmatch in our July 24<sup>th</sup> email to them (all our emails to GEDmatch are now posted on the paper’s GitHub repository), but we did not pursue them further. The other exploit discussed by Ney et al. operates on the same principles as our IBS baiting procedure (described in their section VII).</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>[…] The paper is of broad interest given the robust interest in direct-to-consumer genetic testing and the advent of long-range familial searches by law enforcement. The authors have responsibly handled their discoveries, notifying the various companies that host databases vulnerable to these attacks.</p><p>Before it can be published a few technical topics that should be addressed are:</p><p>1) To perform IBS baiting effectively, the (unphased) IBS detector would need to break segments at opposite homozygous genotypes. However, in practice most such detectors would likely be tolerant to errors, and therefore may not break the segments in the fashion the text assumes. This seems like it may pose a serious issue to such an attack, and this merits more careful consideration.</p></disp-quote><p>We agree that this is an important issue for planning a method of attack. On the basis of our exploration of GEDmatch’s features, we have always believed that it is susceptible to an IBD baiting attack. The flexibility of their 1-to-1 interface allows users to effectively force IBS blocks to be broken by single mismatches, as the user gets to choose the tolerance to errors, by specifying the number of matching SNPs before a second mismatch is allowed. Indeed the video that GEDmatch points users to demonstrates how to vary the tool’s parameters to allow single mismatches to be ignored (https://www.youtube.com/watch?v=7J2TGtcOYMs&amp;feature=youtu.be). We had initially not gone ahead with the demonstration on GEDmatch as we had wanted to avoid getting into detailed explorations of specific databases, and we initially also did not want to single out the only non-commercial database for a demonstration of an attack.</p><p>The Ney et al. paper (https://dnasec.cs.washington.edu/genetic-genealogy/ney_ndss.pdf) independently arrived at an attack that is essentially equivalent to IBS baiting as we describe it (with the modification of adding an additional file that reveals whether the site is missing in the target) and showed that it works in GEDmatch. The attack is described in section VII of their paper.</p><p>We have now demonstrated that IBS bating works in GEDmatch. We first found this in late November, and we confirmed that the methods still work as of December 15th, after the acquisition of GEDmatch by Verogen. We have described these in depth in sections 2.3.3 and 4.4. We note that in response to our and Ney et al.’s initial emails GEDmatch had put in place a number of counter-measures to try and block IBS-baiting style attacks, notably blocks on long runs of heterozygosity. However, it only took a few trial uploads to work out the rough parameters of these checks, and to design baiting kits that could circumvent their checks. GEDmatch has also put in place recaptcha on their 1-to-1 tool page to block bots, this may block simple bot attacks to access large numbers of genotypes.</p><p>We have currently chosen not to publicly release the code to simulate our GEDmatch baits, to make it slightly less trivial to perform the hack. The code is very simple. We are happy to reconsider this decision if the editor or reviewers feel that the code is needed.</p><p>We have also added a bit more general discussion on this issue in the IBS baiting section. The key point is that the attacker needs to design a set of uploads where changes in called IBS (or lack of change in called IBS) with a target will reveal the target’s genotype at a known site. If the adversary can identify the algorithm, it may often be possible to design a strategy that reveals many genotypes, albeit perhaps not all of them, and perhaps requiring more uploaded datasets. To illustrate this, we have added a short discussion of what one might do if the database allows one incompatible homozygote within any called IBD segment.</p><disp-quote content-type="editor-comment"><p>2) The Supplementary Figure 4 legend says, &quot;All other arguments were kept at their default values. Calling IBS without respect to genotype phase returns many IBS segments, but less can be learned about each segment via tiling than if haplotype phase is respected.&quot; Note that services that I'm aware of do not provide phase to the users, nor allow users to upload phased data. (Please say if this is not the case.) Given this, it's hard to make use of the potential benefits of phased data. In general, this issue merits a more prominent mention – the fact that, if phase were known, the amount of information learned by an attacker is greater, and that (unless services give this information), it's hard to envision how an attacker could put this into practice.</p></disp-quote><p>(We have deleted the former Supplementary Figure 4 in response to reviewer 2’s) comments, but here is a response to the rest of the comment): We agree that a service that provides phasing information and allows phased uploads would be easier to exploit, and that most of the services currently do not, which we have clarified. (GEDmatch actually does seem to allow phased matches to be shown---there is a color on their one-to-one match pictures intended to show a phased match---but we do not believe they are implemented in much generality. Since they’re there, though, we’ve avoided saying that none of the services used phased inputs.) We also have emphasized that one way around this concern is to upload homozygous genotypes, and we have emphasized that Figure 2—figure supplement 3 is a projection of the success one might obtain by doing so (since phase errors break IBS segments in Germline’s haploid mode). Filters can be set up to prevent uploads with unrealistic amounts of homozygosity, but an adversary could upload genomes with homozygous runs in key places that are not homozygous everywhere. Because long runs of homozygosity appear naturally, it may be difficult to filter out datasets with enough homozygous material to be useful for IBS tiling.</p><disp-quote content-type="editor-comment"><p>3) &quot;(We consider some alternative IBS reporting procedures in the supplement.)&quot; Is this about the supplementary figures? If so, perhaps cite them. I wasn't sure if there was text that I missed?</p></disp-quote><p>Yes, we meant the supplementary figures and should have been clearer about that. We have deleted this line from the Discussion and clarified the referencing of the supplementary figures in the Results section.</p><disp-quote content-type="editor-comment"><p>4) Optionally, the Discussion may wish to expand on the proposals that inhibit genealogical research, which end users may prefer not to have implemented. Points 2, 4, and 5 (since inferring other relatives' relationships can be useful) fall in this category.</p></disp-quote><p>Yes, we have added some short notes about the potential costs to legitimate genealogical pursuits of these countermeasures. (In response to a comment from reviewer 3, we have moved the detailed discussion of these points to the Appendix.)</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…] Edge and Coop describe a method for breaching privacy of genomes deposited in genetic genealogy matching services. The key idea is that a genetic match between a (known) uploaded genome and a target genome reveals some DNA sequence of the target. This can be exploited to recover large proportions of the target's genome. This is a novel and innovative approach. The manuscript is very interesting and thought provoking and the results are important. The analysis is overall sound (but see the points below). I am certain that the results will have major implications on genetic genealogy, genetic privacy, and beyond.</p><p>1) A result I find intriguing is the high proportion of the genome that can be covered by IBS tiling, which is comparable only to what was previously seen in founder populations. I suggest the following. (All the requested data should be already available to the authors or require very quick experiments.)</p><p>a) Show a breakdown of the coverage by ethnicity (at least for the main ethnicities), to make the results a bit more comparable to previous studies.</p></disp-quote><p>We have added a supplementary figure (Figure 2—figure supplement 4) showing coverage for four EUR subgroups in 1000 Genomes, namely FIN (Finnish), IBS (Iberian in Spain), GBR (British), and TSI (Tuscany). We chose these four subgroups of the combined dataset because they are all large enough subsets to get decent estimates, they are reasonably clearly localized geographically, and they are of approximately equal size. As might be expected, the Finnish sample shows higher coverage by IBS tiling than other groups. We have added some comments about variation among groups in the success of IBD tiling to the Discussion.</p><disp-quote content-type="editor-comment"><p>b) Further emphasize the message that segments need not be IBD (identity-by-descent) to allow privacy breaching – rather, IBS (identity-by-state) is good enough. This explains to some extent why the proportions of genome covered are so high, even though these are (mostly) not founder populations.</p></disp-quote><p>Thank you. We have emphasized this point by adding these sentences to section 2.1: “True IBD segments reveal more than mere IBS segments about shared genotypes because untyped variants (including rare variants) within an IBD segment are likely to be shared. At the same time, mere IBS is sufficient to infer sharing for SNPs that are genotyped within the segment.”</p><disp-quote content-type="editor-comment"><p>c) I think the results of Figure 2—figure supplement 3 are important, and should perhaps be reported as the main results. The reason is that when running Germline in haploid mode with no errors allowed, we are guaranteed no mismatches between the target and the (known) uploaded genome. In other words, we have an exact match to at least one haplotype of the target. (The authors can even improve performance easily by using a diploid mode but allowing no errors. Germline would still require a perfect match, but would allow phasing errors if they happen between blocks.) If the authors choose not to change the order of figures, I would recommend to at least report the mismatch rate between the haplotypes that were found to be matching by RefinedIBD in the main analysis (Figure 2).</p></disp-quote><p>We agree with this concern but have chosen to retain the figure order. The main reason is that during revision, we realized we had misread GEDmatch’s minimum cM threshold, which is in fact 0.1cM and not 1cM. Because of this, we wanted to add results for 0.1cM, but Germline’s options do not allow the user to search for such short IBS segments (perhaps reasonably for most applications), and so we stuck with refinedIBD for the main text. Still, we have added comments to the main text to emphasize the point raised by the reviewer and point readers to Figure 2—figure supplement 3.</p><disp-quote content-type="editor-comment"><p>d) Regarding Supplementary Figure 4, I think this figure might be somewhat misleading. The problem with the approach taken to generate that figure (if I'm not mistaken) is that Germline will not try to match any sites where either the target or the uploaded genome are heterozygous. Thus, the coverage is likely inflated – there could be entire &quot;covered&quot; segments that provide very little information on the target. At the very least, the uploaded genome should be made artificially homozygous, so that we are guaranteed to have information on the homozygous genotypes of the target.</p></disp-quote><p>We agree that the kind of coverage tracked by the former Supplementary Figure 4 is not very informative about the target for the reasons stated---a tile only reveals that the target is unlikely to have a homozygote opposite to the comparison within the region. We have removed it for now, though reviewer 1 appeared to find the figure informative, and we are open to reintroducing it with extra emphasis in the caption on the limited information gained from tiles in this case.</p><disp-quote content-type="editor-comment"><p>2) It will be important to evaluate the IBS tiling method against a very simple &quot;null&quot;, in which each allele is predicted to be the major (more frequent) allele. In other words, the outcome would be not the proportion of the genome covered, but the proportion of alleles of the target correctly inferred, and this outcome should be compared between IBS tiling and just using the major allele. While this experiment may take a little time (but I believe no more than a few days), I believe it is essential, because otherwise it is difficult to evaluate the success of the proposed method.</p></disp-quote><p>We have added a supplementary figure that addresses this concern (Figure 2—figure supplement 5). We are not 100% sure of the alternative hypothesis being proposed and have not included a hypothesis test. (Does the alternative hypothesis allow prediction of the major allele outside IBS tiles? It seems to us that would be the most natural comparison.) But the figure supplement shows the median proportion of total alleles covered and the median proportion of minor alleles covered (minor alleles are ~19% of the total). The figure supplement suggests that there is a slight bias for IBS tiles to be in regions of lower SNP density and in regions with lower heterozygosity. However, the biases are relatively small, so, for example, with a 1cM threshold and all 872 samples included, IBS tiles cover a median of 52% of the minor alleles (as opposed to 57% of the total length in base pairs). Though we do not give these numbers in text, one can calculate easily from the figure legend that a guess of major alleles everywhere gives an average ~81% of alleles guessed accurately (the average major allele frequency), whereas tiling plus a guess of major alleles outside of the tiles gives ~91% accuracy for the median person (all the major alleles plus about half the minor alleles), an increase that is sure to be significant with the many loci considered.</p><disp-quote content-type="editor-comment"><p>3) I am not confident whether these very elegant results form a practical and immediate risk of privacy, or whether the paper is more of a proof of concept. The biggest problem is with IBS baiting. The success of this approach relies on an IBD detection algorithm that is very simple minded. It is not clear to me whether any of the companies is actually using such an algorithm. But more generally, the authors did not demonstrate an actual recovery of genomic material from a genetic genealogy service using any of their methods. Of course, they would not want, and should not, violate the terms and conditions of any company. But I think that if using research genomes (such as 1000 Genomes) or their own genomes, and limiting the experiment in duration and scale, this would be legitimate. Or the authors could even explicitly ask the companies' managements for permission.</p><p>This is not to say that the article is not worthwhile without such experiments. On the contrary, the paper describes a very novel approach, and it would be extremely important and urgent that the proposed techniques become known to all stakeholders in personal genomics, both from the industry and from the academia, as well as the actual participants. Also, additional experiments may take too much time or be outside the scope of the present paper.</p><p>But as happens frequently with this kind of papers, once they are published, the media and the general public cannot get to the bottom of such subtle nuances (even if authors do their very best). I expect the paper will be very widely covered, and with some likelihood, it could develop into a total media circus and trigger panic. I think that would be an unfortunate consequence, unless there is a real, tangible risk of privacy breaching. If the risk is more theoretical in nature, it will be important to say so explicitly (and possibly drop the part about the letters to the representatives of the companies, which is only going to amplify the drama).</p></disp-quote><p>We thank reviewer 2 for this thoughtful comment. We have made several changes to address it. First, we note that section VII of the Ney paper already shows that IBS baiting has recently been possible in GEDmatch.</p><p>As discussed in the response to reviewer 1 we have now implemented a demonstration of IBS baiting against GEDmatch, and we present the results in sections 2.3.3 and 4.4. We have also added more discussion on the specific risks at the services listed in Table 1. Our general view is that the risks are substantial at GEDmatch and much lower (but still likely nonzero) at the other services.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>[…] 1) This reviewer believes that genetic privacy as a whole is overblown. The impacts of violating it are not substantial, and accepting such work in broadly read venues panders to irrational fears thus does science a disservice. While I don't fault the authors for pushing their work to a visible journal, making this more of a comment to the editor, I would nevertheless welcome the authors' rebuttal. Specifically, I would challenge the statements in the last paragraph of the Discussion regarding trait-predictability of traits. These are upper-bounded by the prediction accuracy implied by SNP heritability (accuracy which is markedly lower than the SNP heritability itself). More practically, the likely improvement in prediction does not mean convergence of prediction even to that bound. Worse, given the non-genetic data trace of individuals today, with more precious predictive value, genetic privacy is a distraction. An example ad absurdum, every street camera recovers my height better than my genome would.</p></disp-quote><p>We agree with many of the points raised here and have expanded the paragraph mentioned to emphasize the points of agreement. In particular, we agree that for many complex traits, prediction may be bounded at fairly low accuracy, even as sample sizes and models improve, and we have dropped the sentence noted by the reviewer. We also agree that there are many other threats to privacy, such as street cameras and many kinds of traces of our behavior online. These threats are much more revealing about many aspects our lives than genetics (and doubtless this will remain true into the future). At the same time, one does not need to adopt a strong version of genetic exceptionalism to be concerned about a new form of data being leaked. As geneticists we view it as important to highlight issues with genetic data.</p><p>These databases are growing rapidly and have garnered a lot of public attention, both through advertising by companies and news stories following the Golden State Killer. The fact that the genetic data of over a million people, notably through GEDmatch, may have been open to an adversarial attack does concern us and seems worthy of public attention. One reason for choosing <italic>eLife</italic> as a venue for the article is that we wanted the article to be fully open access so that the large communities of genetic genealogists could discuss the final version of paper (and freely reuse figures etc.).</p><p>Genetic data privacy and sharing are evolving rapidly, and if no clear thinking on policy emerges, it will be too late to reverse decisions that have been made by default. The potential risks from genetic data breaches extend beyond the targeted person, at least to the target’s relatives. Further, others have also noted that there are potential national security issues arising from genetic data breaches (e.g. identification of covert operatives), and that people whose genetic information is compromised might be vulnerable to cyberattacks (e.g. an attacker might generate a genetic profile for a false relative to gain a person’s trust).</p><p>It may well be that in the long run, “genetic privacy” is not the right framing for these issues, and that we may need to move to a framework of ownership of genetic data, allowed uses of genetic data, and harms done by misuse. Still, we believe that making the potential risks clear as quickly as possible is a useful contribution to the public discussion.</p><disp-quote content-type="editor-comment"><p>2) The paper is somewhat thin in results (basically, Figures 2 and 3). In particular, Section 2.3 is falsely appearing under Results, whereas it only describes a method, without even applying it. This defeats the entire purpose of the manuscript, of actually demonstrating the attacks and quantifying their effectiveness. One quantitative question relevant to (defending against) the baiting attack has to do with feasibility of assembling all-het segments from naturally-occurring human haplotypes of chip SNPs. There are back-of-an-envelope reasons to assume those would not be long enough for the described attack, but actual data would be reassuring and consistent with the nature of contributions of this manuscript.</p></disp-quote><p>In response to this and the other reviewer comments, we have added an application of IBS baiting in GEDmatch, similar to the analysis of Ney et al. section VII (which was performed independently and without our knowledge).</p><p>We have also added the following text after identifying the longest run of heterozygosity (in terms of # of SNPs) in our dataset: “In our sample, the longest run of heterozygosity (in terms of number of SNPs) consisted of 38 SNPs and spanned. 06 cM. This suggests that filtering out long runs of heterozygosity might be a promising strategy, though identifying a specific procedure would require more careful consideration of variation in non-European populations and of the composition of commercial SNP chips (including SNP density and allele frequencies).”</p><disp-quote content-type="editor-comment"><p>3) Relatedly, I am specifically concerned regarding the baiting security loophole being practical, as the authors' description of IBS baiting relies on a straw man IBS detector that they construct to have that weakness. As the authors point out, many actual detectors would not willy-nilly extend each segment till conflicting homozygous on both ends, or require some information content to seed a match between segments. Baiting may still be possible, but likely more complicated and potentially impractical.</p></disp-quote><p>We agree that the IBS detector we consider is simplistic, but as mentioned above, IBS baiting does work in GEDmatch, indicating that the IBS detection scheme we describe is not far off of the actual method used in a major database. In response to this comment and one of reviewer 1’s comments, we have added some text on how one might respond to slightly more sophisticated IBS callers in section 2.3.1. It seems to us that there will be some potential to violate privacy using a baiting-like procedure in any database that uses phase-unaware IBS detection and does not take steps to filter out fake profiles. It may become impractical at some point, but it is better to make it effectively impossible by using phase-aware IBS detection.</p><disp-quote content-type="editor-comment"><p>4) The results reported are all w.r.t. the general European population. It is important to report the (different) results for other continental ancestries, and, on the other hand, in bottleneck populations.</p></disp-quote><p>We have added some discussion of the differences among some of the European subgroups (see also the new supplementary figure, Figure 2—figure supplement 4), which allows some extrapolation to patterns that will affect other continental groups. We have chosen to focus on European populations in part because major genetic genealogy databases seem to consist largely of people of European ancestries. We have added the following paragraph to the Discussion:</p><p>“Our IBS tiling and IBS probing results focus on users of European ancestries, in part because most users of DTC genetic genealogy services appear to have substantial European ancestries. […] Finally, we show in Figure 2—figure supplement 4 that in our sample, Finnish samples are more vulnerable to IBS tiling than other populations, which is likely due to Finns tracing substantial ancestry to a founder population that experienced a bottleneck 100 generations ago (Kere, 2001). Members of other groups with similar demographic histories are likely to be at elevated risk of IBS tiling and IBS probing as well.”</p></body></sub-article></article>