<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">52757</article-id><article-id pub-id-type="doi">10.7554/eLife.52757</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Patterned perturbation of inhibition can reveal the dynamical structure of neural processing</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-160996"><name><surname>Sadeh</surname><given-names>Sadra</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8159-5461</contrib-id><email>s.sadeh@imperial.ac.uk</email><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-17772"><name><surname>Clopath</surname><given-names>Claudia</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4507-8648</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution>Bioengineering Department, Imperial College London</institution><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Palmer</surname><given-names>Stephanie</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Senior Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>19</day><month>02</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e52757</elocation-id><history><date date-type="received" iso-8601-date="2019-10-15"><day>15</day><month>10</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-02-19"><day>19</day><month>02</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Sadeh and Clopath</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Sadeh and Clopath</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-52757-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.56234"/><abstract><p>Perturbation of neuronal activity is key to understanding the brain’s functional properties, however, intervention studies typically perturb neurons in a nonspecific manner. Recent optogenetics techniques have enabled patterned perturbations, in which specific patterns of activity can be invoked in identified target neurons to reveal more specific cortical function. Here, we argue that patterned perturbation of neurons is in fact necessary to reveal the specific dynamics of inhibitory stabilization, emerging in cortical networks with strong excitatory and inhibitory functional subnetworks, as recently reported in mouse visual cortex. We propose a specific perturbative signature of these networks and investigate how this can be measured under different experimental conditions. Functionally, rapid spontaneous transitions between selective ensembles of neurons emerge in such networks, consistent with experimental results. Our study outlines the dynamical and functional properties of feature-specific inhibitory-stabilized networks, and suggests experimental protocols that can be used to detect them in the intact cortex.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>specific connectivity</kwd><kwd>inhibitory-stabilised networks</kwd><kwd>patterned perturbation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/N013956/1</award-id><principal-award-recipient><name><surname>Clopath</surname><given-names>Claudia</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/N019008/1</award-id><principal-award-recipient><name><surname>Clopath</surname><given-names>Claudia</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome</institution></institution-wrap></funding-source><award-id>200790/Z/16/Z</award-id><principal-award-recipient><name><surname>Clopath</surname><given-names>Claudia</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><award-id>564408</award-id><principal-award-recipient><name><surname>Clopath</surname><given-names>Claudia</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000266</institution-id><institution>Engineering and Physical Sciences Research Council</institution></institution-wrap></funding-source><award-id>EP/R035806/1</award-id><principal-award-recipient><name><surname>Clopath</surname><given-names>Claudia</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Neuronal networks with strong functional specificity of connections between excitatory and inhibitory neurons show specific dynamics of inhibitory stabilization, accompanied with rapid spontaneous activity transitions between highly selective functional states.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Our understanding of sensory processing in the cortex is moving beyond simple stimulus-response analysis of single cells, and the role of networks of neurons is becoming increasingly more important in this process. Such network effects are, however, difficult to study by recording single cells in isolation or even by measuring the activity of populations of neurons, if our interaction with the circuitry is only observational. A more promising approach is to record and perturb the activity of neuronal populations at the same time. However, theory and computational modelling are needed to guide such endeavours, due to the complexity of the high-dimensional space in which experiments can be performed.</p><p>Experimentally, optical stimulation of neurons has emerged in recent years as a powerful technique to perturb neuronal activity in order to study brain function and dysfunction (<xref ref-type="bibr" rid="bib6">Boyden et al., 2005</xref>; <xref ref-type="bibr" rid="bib18">Fenno et al., 2011</xref>; <xref ref-type="bibr" rid="bib61">Yizhar et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Boyden, 2015</xref>). Optogenetic perturbations have provided us with an effective means to interrogate neuronal connectivity and dynamics in action. Despite these advances, typical perturbation paradigms are still mainly limited to simple profiles of activation or deactivation, hindering a more precise stimulation of neuronal activity which would be necessary to study specific brain functions. Although increasing number of perturbation studies are targeting specific subgroups of excitatory or inhibitory neurons with genetic markers, within each subpopulation still nonspecific perturbation patterns (either in terms of their spatiotemporal profile or functional features) are primarily used to interrogate the circuitry (<xref ref-type="bibr" rid="bib4">Atallah et al., 2012</xref>; <xref ref-type="bibr" rid="bib32">Lien and Scanziani, 2013</xref>; <xref ref-type="bibr" rid="bib43">Pfeffer et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Reinhold et al., 2015</xref>; <xref ref-type="bibr" rid="bib25">Kato et al., 2017</xref>). However, recent advances in optogenetics are making a closed-loop, all-optical interrogation of neuronal circuitry, where neuronal activity can be measured and perturbed simultaneously by optical tools, more achievable (<xref ref-type="bibr" rid="bib17">Emiliani et al., 2015</xref>; <xref ref-type="bibr" rid="bib46">Ronzitti et al., 2017</xref>; <xref ref-type="bibr" rid="bib62">Zhang et al., 2018</xref>), hence paving the way for more specific, patterned perturbations. Several recent studies have in fact used such patterned perturbations to study cortical function with more precision, for example by recording neurons involved in specific tasks (e.g. natural visual processing or memory tasks) and reactivating them in order to instigate or suppress the relevant behaviour (<xref ref-type="bibr" rid="bib11">Chernov et al., 2018</xref>; <xref ref-type="bibr" rid="bib10">Carrillo-Reid et al., 2019</xref>; <xref ref-type="bibr" rid="bib39">Marshel et al., 2019</xref>; <xref ref-type="bibr" rid="bib50">Russell, 2019</xref>; <xref ref-type="bibr" rid="bib55">Tran et al., 2019</xref>).</p><p>Optogenetic techniques have particularly been exploited to cast light on the regime of operation of cortical networks, especially regarding the role of feedforward versus recurrent pathways. A purely feedforward regime of information processing relies on the transmission of information between layers, while a recurrent regime adds an extra level of processing within each layer. The actual architecture of the neocortex seems to favour the latter, as the recurrent connections outnumber the feedforward inputs (<xref ref-type="bibr" rid="bib42">Peters and Payne, 1993</xref>). Strong recurrent connections between principal cells can enable them to perform many useful computations (such as signal amplification, denoising and pattern completion), but this can also lead to runaway excitation and hence unstable dynamics in the brain. It has therefore been suggested that neocortical networks operate in an inhibition-stabilized regime (inhibitory-stabilized networks, or ISNs), where the high gain of cortical recurrent excitation is stabilized, or balanced, by a potent recurrent inhibition (<xref ref-type="bibr" rid="bib57">van Vreeswijk and Sompolinsky, 1996</xref>; <xref ref-type="bibr" rid="bib58">van Vreeswijk and Sompolinsky, 1998</xref>; <xref ref-type="bibr" rid="bib56">Tsodyks et al., 1997</xref>; <xref ref-type="bibr" rid="bib41">Ozeki et al., 2009</xref>). In other words, under ISN regimes of activity, cortical networks would not be stable without inhibition and therefore undergo runaway activity.</p><p>The long-lasting question about whether cortical networks operate as inhibitory-stabilized networks has been reconsidered in the wake of new optogenetic techniques. It has been probed by measuring the presence or absence of paradoxical responses of inhibitory neurons upon perturbation (<xref ref-type="bibr" rid="bib56">Tsodyks et al., 1997</xref>; <xref ref-type="bibr" rid="bib41">Ozeki et al., 2009</xref>). If the network is primarily feedforward driven, increasing the input to inhibitory neurons should lead to an intuitive increase in their responses. On the other hand, in ISNs, dominated by strong recurrent interaction of excitation and inhibition, increasing the input to inhibitory neurons <italic>decreases</italic> their activity, in a non-intuitive direction (hence ‘the paradoxical effect’). Intuitively, this is because, due to the strong recurrence, increasing the input to inhibitory neurons increases inhibition to excitatory neurons, which in turn leads to an overall decrease in the drive to inhibitory neurons. Although earlier studies failed to report the presence of such paradoxical effects in mouse visual cortex (<xref ref-type="bibr" rid="bib4">Atallah et al., 2012</xref>), more recent optogenetics experiments were able to observe them in the visual cortex of awake mice (<xref ref-type="bibr" rid="bib1">Adesnik et al., 2012</xref>) as well as in auditory, somatosensory, and motor cortices (<xref ref-type="bibr" rid="bib25">Kato et al., 2017</xref>; <xref ref-type="bibr" rid="bib54">Sanzeni, 2019</xref>); but see <xref ref-type="bibr" rid="bib38">Mahrach et al., 2020</xref>).</p><p>The conflicting results in different experiments could partly be related to simplifications in the studies of ISNs. Like optogenetic manipulations, ISN properties too have mainly been studied for simplified scenarios, both experimentally and theoretically. For example, the original theoretical model of ISNs reduced the populations of excitatory and inhibitory neurons to single nodes in the analysis (<xref ref-type="bibr" rid="bib56">Tsodyks et al., 1997</xref>). New modelling studies have started to account for more biological realism, for example by studying the effect of including multiple subtypes of inhibitory neurons (<xref ref-type="bibr" rid="bib33">Litwin-Kumar et al., 2016</xref>) or nonlinear neuronal transfer functions (<xref ref-type="bibr" rid="bib3">Ahmadian et al., 2013</xref>; <xref ref-type="bibr" rid="bib48">Rubin et al., 2015</xref>; <xref ref-type="bibr" rid="bib23">Hennequin et al., 2018</xref>). Another extension of the original model to include more biological details (<xref ref-type="bibr" rid="bib53">Sadeh et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Gleeson et al., 2019</xref>) concluded that observation of the paradoxical effect may depend on the size of perturbation of the inhibitory population; a result which was in fact corroborated by subsequent experimental studies (<xref ref-type="bibr" rid="bib31">Li et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Sanzeni, 2019</xref>). Further theoretical and experimental exploration of ISNs can, therefore, reveal new insights about the dynamical and functional properties of cortical networks.</p><p>An important aspect that has remained understudied in the study of ISNs is the functional specificity of connections, as reported in cortical networks. For instance, a highly specific connectivity between excitatory neurons has recently been reported in mouse visual cortex, whereby neurons with similar functional properties (e.g., in terms of their receptive fields) are strongly connected (<xref ref-type="bibr" rid="bib27">Ko et al., 2011</xref>; <xref ref-type="bibr" rid="bib28">Ko et al., 2013</xref>; <xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>; <xref ref-type="bibr" rid="bib30">Lee et al., 2016</xref>). Simulation of networks with experimentally recorded weights of specific connections within the excitatory subnetwork, however, suggests that large-scale networks with such connectivity profiles would be unstable (<xref ref-type="bibr" rid="bib63">Znamenskiy et al., 2018</xref>). This raises the question of which mechanisms are recruited by the cortex to stabilize the unstable dynamics of functional subnetworks. One possibility is that, similar to the balancing of the nonspecific dynamics by recurrent inhibition, the specific dimension of the excitatory connectivity is also balanced by a matching specific inhibition, therefore forming subnetworks of excitatory and inhibitory neurons, all coding for similar visual features. A recent study has in fact found evidence for the presence of such functionally specific excitatory-inhibitory (E→I and I→E) connectivity in visual networks of rodents (<xref ref-type="bibr" rid="bib63">Znamenskiy et al., 2018</xref>), suggesting that E-I subnetworks may also exist in addition to excitatory subnetworks.</p><p>The possibility of specific inhibitory feedback balancing highly specific and potentially unstable excitatory subnetworks adds another dimension to inhibitory stabilization in cortical networks. We therefore aimed to study such ‘functionally specific ISNs’ (or specific ISNs in short) here, and to characterize the dynamical signatures and functional properties arising in these networks. We found that, across model networks at multiple scales and with different degrees of biological realism, specific ISNs can be identified by a ‘specific paradoxical effect’. That is, by exciting only the inhibitory neurons within a subnetwork where all neurons respond to similar stimuli, the activity of the inhibitory neurons in the subnetwork decreases. Moreover, the inhibitory neurons that receive more perturbation (more excitation) decrease their activity more. This dynamical fingerprint would only be observed if the network is probed with patterned perturbations aligned with functional properties of neurons (i.e., perturbations are delivered within a subnetwork rather than distributed across subnetworks). Moreover, this dynamical regime was concomitant with the emergence of spontaneous transitions between selective neuronal activity patterns, a feature that has been reported experimentally in different species (<xref ref-type="bibr" rid="bib26">Kenet et al., 2003</xref>; <xref ref-type="bibr" rid="bib40">Miller et al., 2014</xref>). Our study thus highlights the importance of patterned perturbation in probing the operating regime of cortex and its dynamical and functional properties.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Optogenetic perturbation to detect inhibitory stabilized networks</title><p>Networks with high excitatory connectivity which are balanced by a strong inhibitory feedback are called inhibitory stabilized networks (ISNs). The strong recurrent interaction between excitation and inhibition in these networks manifests itself in a dynamical signature, which is the paradoxical change in the activity of inhibitory neurons upon their perturbation (<xref ref-type="bibr" rid="bib56">Tsodyks et al., 1997</xref>). That is, if the input to inhibitory neurons are increased, the activity of inhibitory neurons is <italic>decreased</italic>, in a paradoxical manner. ISNs –and their associated paradoxical effects– have mainly been studied for simple connectivity profiles, by assuming a uniform connectivity between excitatory and inhibitory subpopulations. Recent experimental studies, on the other hand, have revealed a highly specific connectivity profile between excitatory neurons (<xref ref-type="bibr" rid="bib27">Ko et al., 2011</xref>; <xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>), which is likely to be balanced by a specific inhibitory feedback (<xref ref-type="bibr" rid="bib63">Znamenskiy et al., 2018</xref>). However, the precise effect of such specific connectivity (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) on dynamic responses of ISNs remains understudied, both theoretically and experimentally.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Random and patterned perturbation of inhibition to asses inhibitory stabilized networks.</title><p>(<bold>A</bold>) Schematic of network with specific EI connectivity. (<bold>B</bold>) Optogenetic perturbation of inhibition can either be non-specific (independent of preferred features of the perturbed inhibitory neurons) or patterned (specifically addressing inhibitory neurons with similar feature selectivity). (<bold>C</bold>) Non-specific perturbation only reveals the average paradoxical effect in an ISN (black circle), by revealing that the average activity of perturbed inhibitory neurons is changing in the opposite direction of perturbations. In non-ISNs (gray circle), perturbations and response changes have the same sign. (<bold>D</bold>) Patterned perturbation of specific ISNs reveals specific paradoxical effects, where inhibitory neurons with more (negative) perturbations show more (positive) response changes. The negative correlation of perturbations and response changes is indicated by the dashed line with a negative slope. The mean activity of inhibitory neurons (filled orange circle) still shows the non-specific paradoxical effect, similar to (<bold>C</bold>). The specific paradoxical effect is, however, reflected in the slope of the pattern, and cannot be distinguished by the mean activity. (<bold>E</bold>) Expected patterns for the response changes of inhibitory neurons versus their perturbations under four scenarios: non-specific or specific perturbation of non-specific of specific ISNs. Similar to (<bold>D</bold>), open circles denote the response change of individual inhibitory neurons upon perturbation, the filled circle is the average across those neurons, and the dashed line indicates the slope of correlation. While all combinations show non-specific paradoxical effect (reflected in the similar behaviour of the mean response), only specific perturbation of specific ISNs reveal the specific paradoxical effect (reflected in the negative slope of the line).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Paradoxical effects of perturbing inhibition in ISNs and specific ISNs.</title><p>(<bold>A</bold>) Effect of perturbing the inhibitory population in networks with weak coupling of excitatory and inhibitory populations (non-ISNs). Here, increasing the activity of inhibitory neurons (demonstrated by the shift in the I nullcline from the solid blue line to the dashed one) leads to a new fixed point with higher inhibitory and lower excitatory activity, in the expected direction. (<bold>B</bold>) In networks with strong coupling of excitation and inhibition, increasing the input to inhibition leads to a new fixed point with lower activity of both excitation and inhibition. Perturbation of inhibition, therefore, changes the activity of the inhibitory population in a paradoxical direction. (<bold>C</bold>) In specific ISNs, patterned stimulation of the network can change the fixed point (in the specific direction; ‘specific fixed point’) either in ISN or non-ISN fashion, depending on the alignment of the perturbation pattern with the specific eigenmode of the network. Perturbation patterns aligned with the specific eigenmode (magenta) change the specific fixed point in the ISN direction (similar to (B)), hence leading to the specific paradoxical effect. Perturbation patterns orthogonal to the specific eigenmode (purple) change the specific fixed point in the non-ISN direction (similar to (A)), hence failing to reveal the specific paradoxical effect.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig1-figsupp1-v2.tif"/></fig></fig-group><p>Experimental optogenetics paradigms typically perturb inhibitory neurons randomly and uniformly to probe the presence of ISN networks (‘non-specific’ perturbation; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). This is performed by, for example, reducing the input to many inhibitory neurons expressing channelrhodopsins and measuring the change in the activity of the perturbed inhibitory population (<xref ref-type="bibr" rid="bib4">Atallah et al., 2012</xref>) or the change in the input to pyramidal cells (<xref ref-type="bibr" rid="bib2">Adesnik, 2017</xref>). If the average change is in the opposite direction of perturbation, that is an overall increase in the activity when reducing the input (<xref ref-type="bibr" rid="bib2">Adesnik, 2017</xref>; <xref ref-type="bibr" rid="bib25">Kato et al., 2017</xref>), the effect of perturbation is called paradoxical, which is the signature of ISN regimes of activity (<xref ref-type="bibr" rid="bib56">Tsodyks et al., 1997</xref>; <xref ref-type="fig" rid="fig1">Figure 1B,C</xref>; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A,B</xref>).</p><p>An alternative way to experimentally perturb inhibitory neurons is to increase or decrease their activity according to a specific pattern (specific or ‘patterned’ perturbation) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Consider a simplified scenario where neurons are grouped into subnetworks responding preferentially to a one-dimensional feature like orientation of edges. Patterned perturbations are now delivered such that neurons within a specific subnetwork (e.g. the subnetwork best responding to 90°) are perturbed the most, while neurons belonging to other subnetworks are perturbed based on their functional distance in the feature space (i.e. the subnetwork best responding to 0° receives the least perturbation, as it has the highest distance in preferred orientation) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>).</p><p>If inhibitory stabilization is specific to subnetworks, that is the excessive excitatory activity within each subnetwork is balanced by a matching specific inhibition, specific ISNs will emerge (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>). In contrast to uniform (or non-specific) ISNs, non-specific perturbation is not enough to detect specific ISNs; instead, patterned perturbation (as described above) is needed. The specific ISN is observed, if there is an anticorrelation between the perturbation of inhibitory neurons and their response change (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). We refer to this as the ‘specific paradoxical effect’, which distinguishes specific ISNs from both non-ISNs and non-specific ISNs (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Note that this signature would not be revealed by the average activity of the perturbed inhibitory population, as in both non-specific and specific ISNs, the mean activity of perturbed inhibitory neurons shows the paradoxical effect (c.f. <xref ref-type="fig" rid="fig1">Figure 1C,D</xref>). The specific paradoxical effect, in contrast, manifests itself in the second-order relation of the input perturbation and output activity (i.e. the negative slope), and only if the pattern of perturbation is aligned with functionally specific connectivity of the network (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>).</p><p>Four possible scenarios are thus conceivable out of the interaction of nonspecific/specific perturbations and nonspecific/specific ISNs (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Only in one of them, namely specific perturbations of specific ISNs, the negative slope would be expected. In all other combinations, the extra perturbations around the mean change the response of inhibitory neurons in the same direction. That is, if an inhibitory neuron is perturbed more than the mean perturbation, it would obtain an extra response change more than the mean value; and vice versa. This is because the vector of residual perturbations around the mean is not aligned with the feature-specific dynamics of the network (in non-specific perturbations), or simply because the network lacks such feature-specific dynamics (in non-specific ISNs). The result is a <italic>positive</italic> slope: although the mean response changes still show the non-specific paradoxical effect, the differential response changes around the mean behave in the same direction as differential perturbations.</p></sec><sec id="s2-2"><title>Specific perturbation to detect feature-specific inhibitory stabilization</title><p>To study how specific ISNs behave under different patterns of perturbations, we first simulated large-scale rate-based networks of excitatory and inhibitory neurons (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Neurons were assigned initial preferred orientations and the weight matrix was constructed such that pairs of neurons (E-to-E, E-to-I, I-to-E and I-to-I) with similar preferred orientations were more strongly connected to each other (see Materials and methods). Under both paradigms of perturbation (perturbations independent of neuron’s preferred orientation or in accordance to it; <xref ref-type="fig" rid="fig1">Figure 1B</xref>), the average activity of the network showed the conventional paradoxical effect. That is, negative perturbations of inhibitory neurons (induced by <italic>decreasing</italic> the input to them) <italic>increased</italic> the activity of both inhibitory and excitatory populations, on average (<xref ref-type="fig" rid="fig2">Figure 2A</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Patterned perturbation of inhibition is necessary to reveal specific inhibitory stabilization.</title><p>(<bold>A</bold>) Activity of individual excitatory (magenta) and inhibitory (blue) neurons, and their average activity (black), in the baseline state and during perturbation (from T = 300 to 700) applied by reducing the input to inhibitory neurons (see Materials and methods). Perturbations are induced either non-specifically (upper) or in a patterned manner (lower), where the decrease in the input is proportional to the preferred orientation of respective inhibitory neurons (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Both modes of optogenetic perturbations lead to the non-specific paradoxical effect, as reducing the input to inhibitory neurons paradoxically increases their average activity. (<bold>B</bold>) Average activity of individual excitatory and inhibitory neurons during baseline (black dots) and perturbed states as a function of their preferred orientations. The amount of perturbation of the input to each inhibitory neuron is plotted on the right side (orange) for comparison. The non-specific perturbation is the same pattern as the specific perturbation but randomized over neurons. (<bold>C</bold>) Response change as a result of perturbation (calculated as the difference in the average activity of neurons in the perturbed states compared to the baseline) for inhibitory neurons as a function of their input perturbation. This is shown for specific EI networks in response to nonspecific perturbation (upper) and patterned perturbations (lower). Solid red lines show the best fitted regression line to the data points, with the slope of the line indicted on top (red). The dashed line in (upper) illustrates how a non-ISN would have behaved under a similar perturbation (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Lack of specific paradoxical effect in networks without specific EI connectivity.</title><p>(<bold>A-C</bold>) Similar plots as in <xref ref-type="fig" rid="fig2">Figure 2A-C</xref>, respectively, for neuronal networks without feature-specific EI connectivity. Here, both nonspecific and patterned perturbation fail to yield a specific paradoxical effect (as quantified by lack of negative slopes in <bold>C</bold>), consistent with lack of specific ISNs in networks without specific connectivity. Note that the nonspecific paradoxical effect is still present, as reflected in the increase in the average activity of inhibitory neurons despite negative perturbations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Non-paradoxical effect in non-ISN networks.</title><p>(<bold>A,B</bold>) Similar plots as <xref ref-type="fig" rid="fig2">Figure 2A,C</xref>, respectively, for a network operating in a non-ISN regime of activity.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Specific paradoxical effect with positive perturbations.</title><p>(<bold>A,B</bold>) Similar to <xref ref-type="fig" rid="fig2">Figure 2B,C</xref>, respectively, for positive patterned perturbations. The pattern of perturbation of inhibitory neurons is the same but reversed in sign. (<bold>C,D</bold>) Similar as (A,B) for a 10 times smaller perturbation size. The slope of the best fitted regression line is denoted on the top (red) in each case. (<bold>E,F</bold>) The slope of the best fitted lines to response changes versus input perturbations, for positive (E) and negative (F) perturbations of different size.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Patterned perturbation of inhibitory neurons in networks with fewer inhibitory neurons and broader inhibitory connectivity.</title><p>(<bold>A</bold>) Response change versus input perturbations (similar to <xref ref-type="fig" rid="fig2">Figure 2C</xref>), in a network with fewer inhibitory neurons. The network is the same as in <xref ref-type="fig" rid="fig2">Figure 2</xref>, but it has <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:math></inline-formula> inhibitory and <inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>800</mml:mn></mml:math></inline-formula> excitatory neurons, and <inline-formula><mml:math id="inf3"><mml:msub><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf4"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.15</mml:mn></mml:math></inline-formula>. Upper: Patterned perturbation; Lower: Randomized patterns over neurons. (<bold>B</bold>) Same as (A) for the network with broader inhibitory connectivity. The network is the same as <xref ref-type="fig" rid="fig2">Figure 2</xref>, but the specificity of all weights other than EE connections has reduced by 20% (i.e., <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:math></inline-formula>), and <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.015</mml:mn></mml:math></inline-formula>. (<bold>C</bold>) Same as (A), for a network with fewer inhibitory neurons and broader connectivity of inhibition. Differing parameters from <xref ref-type="fig" rid="fig2">Figure 2</xref> are the following: <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>800</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf12"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0.03</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:math></inline-formula>. Red lines denote the best fitted regression lines to the data in each case, with the slope of the regression indicated in red.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 5.</label><caption><title>Patterned perturbation of inhibitory neurons in networks with heterogeneous specificity of excitatory and inhibitory connections.</title><p>(<bold>A</bold>) Left: Distribution of connection specificity (m) of synapses in the network. Instead of a single value (e.g. m = 1 in <xref ref-type="fig" rid="fig2">Figure 2</xref>), connection specificity is now drawn from a uniform distribution between 0 (non-specific) to 1 (highly specific). Right: The weight matrix of the EE subnetwork generated with connection specificity as shown on the left. Neurons are sorted according to their initial preferred orientations. (<bold>B</bold>) Average activity of neurons in the network during baseline and perturbed states (c.f. <xref ref-type="fig" rid="fig2">Figure 2</xref>) as a function of their initial preferred orientation. Conventions are the same as <xref ref-type="fig" rid="fig2">Figure 2B</xref>. (<bold>C</bold>) Average response change of neurons versus their input perturbations for patterned perturbations (as in (B)) (upper) and a randomized version of the input perturbations (lower). Conventions similar to <xref ref-type="fig" rid="fig2">Figure 2C</xref>. Red lines denote the best fitted regression lines to the data, with the slope of the regression indicated in red.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-figsupp5-v2.tif"/></fig><fig id="fig2s6" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 6.</label><caption><title>Feature-specific paradoxical effects in networks with nonlinear transfer functions.</title><p>(<bold>A</bold>) Response change as a function of input perturbation of inhibitory neurons in rate-based networks with nonlinear transfer function (see Materials and methods). The power of expansive nonlinearity of the transfer function is specified by n, with n = 1 recapitulating the same dynamics as in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Other conventions are the same as <xref ref-type="fig" rid="fig2">Figure 2C</xref>. Note different scales of y-axes. (<bold>B</bold>) Left: Sample activity of excitatory and inhibitory neurons before, during and after patterned perturbation, for n = 4 (similar to <xref ref-type="fig" rid="fig2">Figure 2A</xref>). Right: Average activity of individual excitatory and inhibitory neurons during baseline state and during perturbation, as a function of their initial preferred orientation. Conventions the same as <xref ref-type="fig" rid="fig2">Figure 2B</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-figsupp6-v2.tif"/></fig><fig id="fig2s7" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 7.</label><caption><title>Feature-specific paradoxical effects in networks with partial perturbation of inhibition.</title><p>(<bold>A–C</bold>) Response change as a function of input perturbations for perturbed inhibitory neurons under patterned perturbations (similar to <xref ref-type="fig" rid="fig2">Figure 2C</xref>). Different fraction of inhibitory neurons are perturbed in (<bold>A</bold>): 30%, (<bold>B</bold>): 50% and (<bold>C</bold>): 70%. Other parameters and conventions are otherwise the same as <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>D</bold>) The slope of regression line fitted to the data (red lines in (<bold>A-C</bold>), with the slope denoted with the numbers in red) for different fractions of patterned perturbation. More than 50% of the inhibitory population should be perturbed to observe the specific paradoxical effect (assayed by the negative slope of the regression).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig2-figsupp7-v2.tif"/></fig></fig-group><p>The difference between the two types of perturbation, however, became evident when the response changes were plotted in terms of the feature-selectivity of neurons (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Nonspecific perturbations increased the activity of inhibitory neurons without any obvious pattern in terms of their preferred orientations (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). In contrast, patterned perturbations invoked inverse patterns of response changes, such that inhibitory neurons with larger (more negative) perturbations showed higher <italic>increase</italic> in their activity (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, lower). This ‘feature-specific paradoxical effect’ was clearly evident in the negative correlation between the response change of inhibitory neurons and their input perturbations (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, lower), and could be quantified by the negative slope of the regression line fitted to the data points (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). We used this metric in the rest of the study to quantify the presence of feature-specific ISNs.</p><p>The negative slope was missing for the nonspecific pattern of perturbation (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, upper), which was a pattern generated by randomizing the specific pattern (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, upper). This indicates that the precise feature-specific pattern of perturbation is crucial to reveal the specific paradoxical effect. The specific ISN behaviour was also not observed in networks without feature-specific EI connectivity during either non-specific or patterned perturbations, despite the presence of the non-specific paradoxical effect (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). As expected (<xref ref-type="fig" rid="fig1">Figure 1E</xref>), the slope was positive, since in the absence of specific paradoxical effects, inhibitory neurons show higher relative responses for the differential perturbations around the mean level. Since the mean level is nevertheless showing the nonspecific paradoxical effect, this positive slope leads to a counterintuitive observation that inhibitory neurons with no perturbations show some positive response changes (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, upper).</p><p>Note that, while the nonspecific paradoxical effect is reflected in the mean population behaviour of the network (i.e., in the average response change and the average perturbation of inhibitory population), the specific paradoxical effect can be inferred from the second-order statistics. That is, the slope of the relationship between the input perturbations and output response changes across inhibitory neurons should be considered, rather than their population average values. In all three conditions discussed above (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, upper and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>), the mean activity of the inhibitory population shows the conventional, nonspecific paradoxical effect. For comparison, such a nonspecific paradoxical effect would be absent in non-ISN networks, as their inhibition shows average response changes in the same direction as input perturbations (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, and dashed line in <xref ref-type="fig" rid="fig2">Figure 2C</xref>, upper). Lack of an inverse second-order relationship (negative slope) is, however, present in all these four conditions (specific ISNs with randomized patterns (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), nonspecific ISNs in response to patterned or randomized perturbations (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>), and non-ISNs (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>)) because none of them shows the second-order paradoxical effects. We therefore concluded that networks with feature-specific EI connectivity can show specific paradoxical effects in response to patterned perturbations, but nonspecific perturbations fail to uncover such effects even in specific ISNs.</p></sec><sec id="s2-3"><title>Positive versus negative perturbations of inhibitory neurons</title><p>We <italic>decreased</italic> the input to inhibitory neurons in our perturbations, because neurons in strongly connected excitatory-inhibitory networks (similar to those found in the cortex) typically operate at low firing rates. As a result, the paradoxical effect would be observed better if perturbations lead to <italic>increases</italic> in activity of inhibitory neurons to avoid the ‘floor effect’, which would be possible by <italic>decreasing</italic> the input to inhibitory neurons. To demonstrate this, we probed the presence of the specific paradoxical effect with positive patterned perturbations. We used the same patterns of perturbations, but instead of decreasing the input to inhibitory neurons (negative perturbation) we increased the input (positive perturbation). Positive perturbations with similar size revealed a weak specific paradoxical effect and negative slope (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3A,B</xref>). However, decreasing the size of perturbation by 10 times led to strong negative slopes (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3C,D</xref>), due to less rectification of network activity. Systematic analysis of the slope of the response changes versus input perturbations revealed that smaller perturbations in fact revealed higher negative slopes (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3E</xref>). Negative perturbations, in contrast, always revealed the specific paradoxical effect with strong negative slopes, independent of the strength of perturbation (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3F</xref>). We, therefore, concluded that, although the specific paradoxical effect can be revealed by small positive perturbations, negative patterned perturbations are better poised for probing specific ISNs.</p></sec><sec id="s2-4"><title>Networks with more biologically realistic inhibition</title><p>We used equal numbers of excitatory and inhibitory neurons with similar tuning properties in our simulations, but it is known that there are fewer inhibitory neurons (than excitatory neurons) in real cortical networks (<xref ref-type="bibr" rid="bib8">Braitenberg and Schüz, 1998</xref>). Moreover, experimental studies suggest broader tuning of inhibitory neurons than excitatory ones (<xref ref-type="bibr" rid="bib37">Ma et al., 2010</xref>; <xref ref-type="bibr" rid="bib5">Bock et al., 2011</xref>). We therefore asked if our main results also hold in networks with such biologically realistic architectures. To address this issue, we first simulated networks with fewer inhibitory neurons, matching the fraction of excitation/inhibition (80% E, 20% I) as reported in the neocortex (<xref ref-type="bibr" rid="bib8">Braitenberg and Schüz, 1998</xref>). To account for the decrease in the overall level of inhibition resulting from the decrease in their number, we increased the average weight of inhibition by a similar factor (4 times stronger), consistent with stronger weights reported for inhibition (<xref ref-type="bibr" rid="bib24">Hofer et al., 2011</xref>). As before, feature-specific paradoxical effect was also observed in such networks, but only when patterned perturbation of inhibition was delivered (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4A</xref>).</p><p>We next addressed broader tuning of inhibition. This can either affect the input to neurons (broader input to inhibitory neurons than excitatory ones) or the specificity of connections (more specificity of excitatory compared to inhibitory connections). Different inputs to different neuron types do not change our results, as patterned perturbation is only delivered to inhibitory neurons; this would be an issue if both subtypes were subject to perturbations or external stimuli. We therefore investigated the effect of broader connectivity of inhibitory neurons. To simulate this, we allowed for a broader connectivity of I→E, I→I and E→I connections compared to E→E weights. Moreover, we recalibrated the weights such that the network still has dynamic stability despite the decrease in specific inhibition. For stable networks with broader inhibitory connectivity, we obtained similar feature-specific paradoxical effects in response to patterned perturbations (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4B</xref>). We also combined the two conditions in a third set of simulations, where the network had both fewer inhibitory neurons <italic>and</italic> broader inhibitory connectivity, and obtained similar results (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4C</xref>). Therefore, fewer inhibitory neurons and broader tuning or connectivity of inhibition would not compromise the presence of feature-specific paradoxical effects, as long as the specific neuronal dynamics remain stable.</p></sec><sec id="s2-5"><title>Networks with heterogeneous specificity of excitatory and inhibitory connections</title><p>We so far considered EI connectivity profiles where all synaptic connections had the same tuning width. However, balanced states and ISN dynamics can be achieved with different profiles of E and I connections. Under such heterogenous connectivity profiles, the relationship between the specific activity dynamics and connectivity might be less clear, as the heterogeneity adds ‘noise’ which may weaken the specific effect of patterned perturbations. We therefore studied whether specific paradoxical effects can also be observed in neuronal networks with heterogenous specificity of E and I connections (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>). To this end, we modified the specificity of synaptic connections to have a random value between 0 (non-specific) and 1 (highly specific) (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5A</xref>). Simulation results showed that patterned perturbations of inhibition induced the same inverse pattern of activity on inhibitory and excitatory neurons, but with a more noisy behaviour (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5B</xref>). This reflected itself in a more spread in the distribution of response changes versus input perturbations; however, the overall trend remained the same and manifested itself in the negative slope for patterned perturbations, but not for randomized input patterns (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5C</xref>). The heterogeneity of synaptic connections can, therefore, add more scatter to the manifestation of the specific paradoxical effect, but seems unlikely to mask it in the average slope of the perturbation curve.</p></sec><sec id="s2-6"><title>Networks with nonlinear dynamics</title><p>As we considered a threshold-linear nonlinearity in our rate-based model, it is possible that our main results were derived mostly in the linear regime of dynamics. More complicated nonlinearities can create interactions amongst the eigenmodes and hence may mitigate the specific paradoxical effects. Specifically, in inhibitory-stabilized networks with supra-linear transfer functions, the dynamic range is divided into non-ISN and ISN regions by a transition from the sub-linear to supra-linear dynamics (<xref ref-type="bibr" rid="bib3">Ahmadian et al., 2013</xref>; <xref ref-type="bibr" rid="bib48">Rubin et al., 2015</xref>). We therefore extended our model to study how such nonlinear dynamics might affect our results. We investigated the effect of response nonlinearity on our results by simulating rate-based networks with difference expansive nonlinearities (similar to <xref ref-type="bibr" rid="bib3">Ahmadian et al., 2013</xref>) (see Materials and methods). We changed the power of nonlinearity from n = 1 (corresponding to our previous networks, for example in <xref ref-type="fig" rid="fig2">Figure 2</xref>) to higher powers.</p><p>We observed similar feature-specific paradoxical effects in nonlinear networks with different powers of nonlinearity (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6A</xref>). The expansive nonlinearity in fact seems to amplify the specific paradoxical effect, as inhibitory neurons with more negative perturbations show more positive response changes in networks with higher exponents. This effect was concomitant with a higher activation of excitation in networks with higher exponents, which necessitates a more potent specific inhibition in turn (<xref ref-type="fig" rid="fig2s6">Figure 2—figure supplement 6B</xref>). Expansive nonlinearity of neuronal transfer function therefore seems to amplify the specific mode in such networks, and as a result the feature-specific paradoxical effects, as long as the dynamics remain stable. In fact, networks with too large nonlinearity (n = 5) showed signatures of such instability in terms of pathological oscillations of excitation and inhibition (not shown). We also tested our results with smaller size of perturbations (up to 10 fold smaller) and found that feature-specific paradoxical effects could still be observed in all nonlinear networks (not shown). Thus, the main signature of feature-specific paradoxical effect can also be observed in networks with nonlinear transfer functions.</p></sec><sec id="s2-7"><title>Partial perturbation of inhibition</title><p>Previous experimental (<xref ref-type="bibr" rid="bib31">Li et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Sanzeni, 2019</xref>) and theoretical (<xref ref-type="bibr" rid="bib53">Sadeh et al., 2017</xref>) studies have shown that the fraction of inhibitory neurons perturbed is important to reveal the (non-specific) paradoxical effects in ISNs. We therefore asked whether similar dependence on the proportion of perturbed inhibitory neurons also plays a role in revealing specific paradoxical effects in feature-specific ISNs. Patterned perturbations based on a small fraction of inhibitory neurons in fact failed to reveal any specific paradoxical effect (<xref ref-type="fig" rid="fig2s7">Figure 2—figure supplement 7A</xref>). When the patterned perturbation was delivered to half of the inhibitory population the positive regression slope disappeared, but still no sign of feature-specific paradoxical effect (as assayed by a significant negative slope) was present (<xref ref-type="fig" rid="fig2s7">Figure 2—figure supplement 7B</xref>). We found that patterned perturbations based on a large fraction of inhibitory population was indeed needed to reveal the feature-specific paradoxical effect, as shown by the negative slope in the example perturbation (70%) (<xref ref-type="fig" rid="fig2s7">Figure 2—figure supplement 7C</xref>), and characterized for a larger parameter space (<xref ref-type="fig" rid="fig2s7">Figure 2—figure supplement 7D</xref>). We therefore conclude that similar dependence of the paradoxical effect on the fraction of perturbed inhibitory population would be expected also in the case of feature-specific paradoxical effect. However, patterned perturbations can be tuned to be delivered more specifically or more broadly (with non-specific perturbations reflecting one end of the spectrum). It might, therefore, be possible to optimize the experimental protocols, and need a smaller fraction of perturbed inhibition, if partial patterned perturbations are targeted to the most functionally similar units.</p></sec><sec id="s2-8"><title>Perturbations based on receptive field similarity to reveal specific inhibitory stabilization</title><p>Realistic neurons in visual cortex do not only respond to a single one-dimensional feature like preferred orientation, and the specific connectivity between them is not only a function of their preferred orientation (<xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>). Instead, correlations between two-dimensional visual receptive field (RF) of neurons have been reported to be a good predictor of the connection probability and the strength of weights (<xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>). We therefore asked whether specific ISN behaviour can be observed in specific EI networks with more realistic RFs and connectivity profiles, resembling cortical networks. To answer this question, we simulated a more realistic version of our model networks, where neurons had Gabor-like RFs (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), and the specific connectivity between them was modulated by their respective RF correlations (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; Materials and methods), as suggested by experimental recordings (<xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Patterned perturbation of inhibition based on receptive field similarity is necessary to reveal specific inhibitory stabilization.</title><p>(<bold>A</bold>) Sample neuronal RFs for excitatory (magenta) and inhibitory (blue) neurons and schematics of connectivity between neuronal pairs. (<bold>B</bold>) Upper: Distribution of RF similarity of all neuronal pairs in the network, as quantified by pairwise correlations of RFs. Lower: Weights of connections between neurons as a function of their RF similarity. (<bold>C1</bold>) Activity of excitatory and inhibitory neurons in response to patterned perturbation along the 1D dimension of orientation (similar to <xref ref-type="fig" rid="fig2">Figure 2A</xref>). (<bold>C2</bold>) The average activity of neurons during baseline and perturbed states, along with the profile of inhibitory perturbation, as a function of the preferred orientation of neurons (similar to <xref ref-type="fig" rid="fig2">Figure 2B</xref>). (<bold>D1,D2</bold>) Similar to (C1,C2) for patterned perturbation along RF similarity (see Materials and methods). The average activity of neurons in (<bold>D2</bold>) is plotted against the RF similarity of respective neurons to a reference inhibitory cell. (<bold>E</bold>) Response change of individual inhibitory neurons as a result of perturbation versus their respective input perturbations, along with the best fitted regression line (red), similar to (<bold>C</bold>). Patterned perturbation along the 1d feature of orientation does not reveal a negative slope, although it yields a nonspecific paradoxical effect (average increase of inhibition as a result of negative perturbations). (<bold>F</bold>) Patterned perturbation along RF similarity (with regard to a reference cell) shows the specific paradoxical effect (negative slope). (<bold>G</bold>) Same pattern of perturbation as in (F) but randomized over inhibitory neurons, does not lead to a specific paradoxical effect (lack of negative slope).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Spectral analysis of specific perturbations.</title><p>(<bold>A</bold>) Connectivity matrix of the excitatory subpopulation (E-to-E) in a network with feature-specific connectivity based on a one-dimensional feature (preferred orientation, PO), as in <xref ref-type="fig" rid="fig2">Figure 2</xref>. (<bold>B</bold>) Connectivity matrix of excitatory neurons based on RF similarity (similar to networks in <xref ref-type="fig" rid="fig3">Figure 3</xref>). Neurons are sorted according to their preferred orientations (PO) in both (A) and (B). (<bold>C</bold>) Spectrum of weight matrix in (B), when specific connectivity is only preserved within excitatory (EE) subnetwork. Connectivity between other connection subtypes (E-to-I, I-to-E, and I-to-I) is replaced with the mean value of the respective subpopulation. The eigenvalue marked in red thus reveals the most unstable eigenmode resulting from <italic>specific</italic> E-to-E connectivity. (<bold>D</bold>) Structure of the first specific eigenmode of E-to-E (i.e., the eigenvector corresponding to the eigenvalue marked in red in (C)) versus different features of excitatory neurons: their preferred orientation (Pref. orient.) in left and RF similarity of neurons to a reference neuron in the network on right. Correlation coefficient (CC) between the specific eigenvector and neuronal features are indicated in red in each case. Red lines show the best fitted regression line to the data. (<bold>E</bold>) Distribution of the absolute value of the correlation coefficient (|CC|) between the specific eigenvector and the vector of RF similarity of neurons to different excitatory neurons in the network. (<bold>F,G</bold>) Similar to (<bold>D,E</bold>) for another specific eigenvector (the third unstable eigenvalue marked in blue in (<bold>C</bold>)).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig3-figsupp1-v2.tif"/></fig></fig-group><p>To assess whether specific paradoxical effects are present in the network, we perturbed the input to inhibitory neurons following two protocols: (1) along the 1D dimension of preferred orientation of neurons (similar to <xref ref-type="fig" rid="fig1">Figure 1</xref>) (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), and (2) along the dimension of RF similarity (with regards to a reference neuron, see Materials and methods) (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). The uniform paradoxical effect was present in both perturbations (<xref ref-type="fig" rid="fig3">Figure 3C1,D1</xref>). However, the specific paradoxical effect was absent for 1D perturbations (<xref ref-type="fig" rid="fig3">Figure 3C2</xref>) and was only evident in the perturbations along the RF similarity (<xref ref-type="fig" rid="fig3">Figure 3D2</xref>). This difference could be quantified by the slope of the regression lines fitted to response change versus input perturbation (<xref ref-type="fig" rid="fig3">Figure 3E,F</xref>). As a control, randomizing (over inhibitory neurons) the same perturbation protocol as in <xref ref-type="fig" rid="fig3">Figure 3D</xref> did not lead to the specific paradoxical effect and hence did not reveal specific ISNs (<xref ref-type="fig" rid="fig3">Figure 3G</xref>). These results suggest that, for realistic neuronal networks, perturbation of the inhibitory population based on their RF similarity might be necessary to reveal specific ISNs, and the reduction of RF properties to 1D features like orientation may not be conclusive in uncovering the specific paradoxical effect.</p></sec><sec id="s2-9"><title>Spectral analysis of feature-specific perturbations</title><p>Although the perturbation of the network along the 1D dimension of preferred orientation was a <italic>specific</italic> perturbation, it did not lead to a specific paradoxical effect, and hence failed to reveal the specific ISN nature of the network. To understand why and how this happened, we resorted to theoretical analysis of the network connectivity (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The network connectivity based on RF similarity does not show a strong specific modulation along the dimension of preferred orientation, compared to networks with 1D feature-specific connectivity (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A,B</xref>). This is due to the fact that neurons with 2d RFs are tuned to multiple features, therefore, even if a pair of neurons are highly similar in their preferred orientation, they might still be different in other respects (e.g. preferred phase or spatial frequency). As a result, feature-specific connectivity based on full RF similarity would be diluted when projected over individual 1D dimensions. Hence, delivering optogenetics perturbations along 1D features might not be strong enough to activate the actual specific mode(s) of the network that would result from its specific connectivity.</p><p>To uncover the specific eigenmode of the network along which the perturbations would result in the specific paradoxical effect, we preserved the E-to-E connections as specific as before while randomizing the rest of the connection weights (E-to-I, I-to-E and I-to-I). This procedure preserves the unstable specific excitatory eigenmode of the network, while ensuring that inhibition is strong enough to suppress the unstable nonspecific excitatory mode (this would have otherwise masked the specific E-to-E eigenmodes). The largest, unstable eigenmodes of the connectivity matrix would now be specifically associated with the <italic>specific</italic> modes.</p><p>By focusing on the largest eigenvalue in the spectrum of the weight matrix (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1C</xref>) we can now reveal the structure of the specific eigenmode. We found that the corresponding eigenvector had high correlations along the dimension of RF similarity. This is shown for one example cell as reference in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1D</xref>, and for all excitatory cells as different reference RFs in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1E</xref>. In contrast, such a high correlation was not observed when sorting neurons according to their preferred orientation (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1D</xref>). Similar results were obtained when a smaller, but still unstable specific eigenvector was analysed (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1F,G</xref>). These results show that the specific eigenmodes of the weight matrices based on RF similarity of neurons with multiple features may not have strong projections over their individual features. Patterned perturbation protocols based on a single feature like orientation might, therefore, not recruit the specific eigenmode of the network effectively and hence fail to reveal specific paradoxical effects even in the presence of feature-specific ISNs.</p></sec><sec id="s2-10"><title>Perturbation patterns based on response similarity to reveal specific ISN</title><p>Mapping the RF of inhibitory neurons might be difficult in practice to guide the optogenetics perturbation, especially given that a large population of inhibitory neurons should be imaged and perturbed to reveal specific ISNs. However, experimental studies have shown that both RF similarity and response similarity (namely, how similarly they respond to similar stimuli) are good predictors of the specificity of connections (<xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>). We, therefore, explored the possibility that response similarity of neurons, rather than their RF similarity, could be used as a proxy for specific connectivity to guide the patterned perturbation (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Patterned perturbation of specific ISNs according to response similarity.</title><p>(<bold>A</bold>) Left: RF similarity (quantified as pairwise RF correlation) of responsive inhibitory neurons in the network. Right: Response similarity of same inhibitory neurons, calculated as correlation of activity in response to a sequence of stimuli, composed of RFs with similar statistics as the neuronal RFs (see Materials and methods). Responsive units are identified as neurons with average activity more than the 20th percentile of the population and sorted according to their preferred orientation (PO sorted). (<bold>B</bold>) Marginal distribution of response similarity of all neuronal pairs in (A). (<bold>C</bold>) Response correlation of the neuronal pairs versus their RF correlation. (<bold>D</bold>) Response change of inhibitory neurons versus their input perturbation, when patterned perturbation is applied according to response similarity with regard to an example reference inhibitory cell. Red line shows the best fitted regression line and the slope is denoted in red. (<bold>E</bold>) The slope of the fitted regression line to the data points (as in (D)) for different inhibitory neurons used as the reference. Only significant regression lines (p-value&lt;0.05) have been included. Negative slopes denote specific paradoxical effects. (<bold>F</bold>) Fraction of inhibitory neurons that would reveal a specific paradoxical effect (significant negative slope; red) or not (significant positive slope; black), if used as reference for delivering patterned perturbations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Patterned perturbation of specific ISNs according to response similarity when full-field gratings are used as stimuli.</title><p>(<bold>A</bold>) Example stimuli used to probe the response similarity of inhibitory neurons. Full-field gratings with different orientation, but with a fixed spatial frequency (0.04 cpd), are interleaved with gray images, to measure the activity of neuronal networks. (<bold>B</bold>) Response correlation of neuronal pairs obtained from the responses to stimuli in (A) versus their RF correlations. (<bold>C</bold>) Left: Distribution of inhibitory neurons that would elicit significant negative regression slopes (specific paradoxical effect) or significant positive slopes, if the patterned perturbation is delivered according to response similarity with regard to them (similar to <xref ref-type="fig" rid="fig4">Figure 4E</xref>, but when stimuli as in (A) are used to probe neuronal responses). Right: Fraction of reference inhibitory neurons with specific paradoxical effects or normal. (<bold>D-F</bold>) Similar to (<bold>A-C</bold>) when stimuli with different orientations and a wide range of spatial frequencies (examples shown in (<bold>D</bold>)) are used to probe the neuronal responses and response similarities guiding patterned perturbations. Same as in <xref ref-type="fig" rid="fig4">Figure 4</xref>, all results are shown for responsive inhibitory neurons, identified as neurons with average activity of more than the 20th percentile of the population.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Feature-specific paradoxical effects obtained by perturbing inhibitory neurons based on their response similarity to natural images.</title><p>(<bold>A</bold>) Example natural images used to probe the response similarity of inhibitory neurons. (<bold>B</bold>) Distribution of response similarity of responsive inhibitory neurons, when the network is stimulated with natural images (see Materials and methods). (<bold>C</bold>) Response similarity versus RF similarity. (<bold>D</bold>) Distribution of patterned perturbations based on reference inhibitory neurons leading to a significant negative slope (specific paradoxical effect; red) or not (significant positive slope; black). (<bold>E</bold>) Fraction of patterned perturbations (based on response similarity to reference inhibitory cells) leading to paradoxical effect or not. Other conventions are the same as <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig4-figsupp2-v2.tif"/></fig></fig-group><p>We stimulated the activity of the network in response to visual stimuli with the same statistics as the ensemble of neuronal RFs (see Materials and methods). The similarity of neuronal responses was then quantified by the correlation of activity traces in response to the entire stimulus set. Overall, neuronal pairs with more RF similarity showed more response similarity, although the match was not perfect (<xref ref-type="fig" rid="fig4">Figure 4A–C</xref>). However, when we perturbed the inhibitory network in a patterned manner based on response similarity, we observed the specific paradoxical effect (an example is shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref>). Here, inhibitory neurons with more response similarity (rather than RF similarity as in <xref ref-type="fig" rid="fig3">Figure 3D</xref>) to a reference cell received more negative perturbations (i.e., <italic>decreased</italic> external input), and inhibitory neurons with more negative perturbations in fact showed <italic>increased</italic> activity in a paradoxical manner.</p><p>We repeated this procedure for all inhibitory neurons as reference cells and calculated the slope of the regression line (as described above), as a metric for the presence or absence of specific paradoxical effects. Patterned perturbations based on response similarity to a majority of reference inhibitory cells revealed specific paradoxical effect (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). We quantified this in terms of the fraction of the inhibitory neurons that would yield the specific paradoxical effect, if the patterned perturbation is based on response similarity of the population in reference to them, and found that perturbations based on &gt;80% of inhibitory neurons as the reference cell in fact lead to a specific paradoxical effect (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). We, therefore, concluded that it is possible to use response similarity, rather than RF similarity of inhibitory neurons, as a way to deliver patterned inhibition in order to detect specific ISNs.</p><p>Interestingly, we found that when full-field oriented gratings were used as visual stimuli, patterned perturbations based on response similarity were not as effective in inducing the specific paradoxical effect (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). We used gratings of either fixed spatial frequency (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>) or gratings with a range of spatial frequencies (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1D</xref>) to stimulate the network and then calculated the response similarity of neuronal pairs from their responses to the entire stimulus set (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B,E</xref>). When using grating stimuli with a fixed spatial frequency, most of the reference inhibitory cells used to guide the patterned perturbation of inhibition did not reveal a specific paradoxical effect (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>). The fraction of reference cells leading to the specific paradoxical effect was somewhat higher for gratings with a wide range of spatial frequencies (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1F</xref>), but still lower than stimuli with the same statistics as the RFs (c.f. <xref ref-type="fig" rid="fig4">Figure 4F</xref>).</p><p>The reason why such stimuli are not as effective could be due to strong co-activation of cells with similar preferred orientations. Response correlations resulting from such full-field gratings are overemphasizing the oriented feature of RFs rather than other features, while the specific connectivity (and hence the specific dynamics of the network) is in fact governed by multiple features of RFs. The pattern of perturbation based on such response similarity thus resembles specific perturbations based on 1D features described before (c.f. <xref ref-type="fig" rid="fig3">Figure 3</xref>), and hence similar arguments in terms of weaker projection of the specific eigenmode over individual features (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) might be responsible here too for the failure of such patterned perturbations to invoke the specific paradoxical effect. These results suggest that the choice of stimuli to probe response similarity would be important in designing optogenetic experiments to reveal specific ISNs, with stimuli matching the statistics of RFs having higher statistical power. To test this hypothesis more directly, we used natural images (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>) as stimuli to probe the response correlation of neurons in the network (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2B,C</xref>). We found that patterned perturbations based on such response similarity led to specific paradoxical effects for a majority of reference inhibitory cells (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2D,E</xref>). We therefore conclude that naturalistic stimuli, which contain multiple visual features like neuronal RFs, would provide the best protocol to assay response correlations needed for patterned perturbations.</p></sec><sec id="s2-11"><title>Specific inhibitory stabilization in spiking networks</title><p>So far, we have established that large-scale networks of rate-based model neurons with highly specific EI connectivity behave as feature-specific ISNs, and that this property can be revealed by specific paradoxical effects in response to proper patterns of perturbation. Rate-based models are useful theoretical tools to approximate the average activity of more realistic neuronal networks, and they are especially suited to describe the collective dynamics of such networks (<xref ref-type="bibr" rid="bib14">Destexhe and Sejnowski, 2009</xref>). However, biological neurons communicate with spikes, and spiking networks are known to show richer and more complex activity dynamics (<xref ref-type="bibr" rid="bib9">Brunel, 2000</xref>). Direction demonstration of the presence of specific ISNs, and the associated specific paradoxical effect in them, thus remains to be provided in spiking networks.</p><p>To this end, we extended our previous models to simulate large-scale networks of spiking neurons with specific EI connectivity (<xref ref-type="fig" rid="fig5">Figure 5</xref>; see Materials and methods). We simulated a spiking version of our model (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), where patterned perturbation was delivered by reducing the baseline input to inhibitory neurons according to their similarity profile. The model showed both uniform and specific paradoxical effects in the average firing rates of neurons (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). The specific paradoxical effect could be quantified by the negative slope of rate changes versus input perturbations (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). We also tested whether our results hold in spiking networks with fewer inhibitory neurons and found that this is indeed the case (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). These results corroborate that specific paradoxical effects can also be revealed in more realistic spiking networks with specific EI connectivity, if patterned perturbation is delivered to probe that.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Spiking networks with specific EI connectivity show specific inhibitory stabilization.</title><p>(<bold>A</bold>) Sample raster plot of spiking activity of excitatory (red) and inhibitory (blue) neurons in the baseline states (gray) and during patterned perturbation (orange). The network has all-to-all connectivity and connection weights are modulated as a function of the preferred orientation of neurons (see Materials and methods). (<bold>B</bold>) Average activity of excitatory and inhibitory neurons during the baseline and perturbed states, across 10 repetitions of the simulation in (A). Input perturbation of inhibitory neurons is shown on the right for comparison. (<bold>C</bold>) Average response change of inhibitory neurons versus their input perturbation. The red line shows the best fitted regression line to the data points.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Specific inhibitory stabilization in spiking networks with fewer inhibitory neurons.</title><p>(<bold>A-C</bold>) Same as <xref ref-type="fig" rid="fig5">Figure 5A-C</xref>, respectively, for a network with 20% inhibitory and 80% excitatory neurons (<inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>500</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:math></inline-formula>). E-to-E connection probability is 25%, while other connections (E-to-I, I-to-E, I-to-I) are all-to-all as before. Other parameters and conventions are the same as <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig5-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-12"><title>Spontaneous transitions between selective patterns of neural activity</title><p>Recent work in mouse visual cortex has suggested that spontaneous activity is not random. Instead, distinct subpopulations of neurons are active together in the absence of direct visual stimulation (<xref ref-type="bibr" rid="bib40">Miller et al., 2014</xref>). These spontaneously emerging neuronal activity patterns are, however, similar to those arising during evoked states (<xref ref-type="bibr" rid="bib40">Miller et al., 2014</xref>). Similar observations had been reported before in other species with structured visual maps (<xref ref-type="bibr" rid="bib26">Kenet et al., 2003</xref>). It is, therefore, not clear which structural or connectivity motifs leads to such intrinsically generated patterns of activity. We next asked if such specific dynamics of spontaneous activity can emerge in networks with highly specific EI connectivity, and whether specific ISNs show similarity between their spontaneous and evoked activity. To study this, we simulated our spiking network models with different levels of connection specificity and probed the network responses to spontaneous and evoked activity (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Spontaneous activity was emulated by providing unspecific input to all neurons independent of their respective selectivity (i.e., their initial preferred orientations here). Evoked activity, in contrast, was measured in response to tuned inputs with different degrees of specificity (quantified by the fraction of the tuned component of the input to its unspecific part; see Materials and methods).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Spontaneous transition between selective states during spontaneous activity in specific EI networks.</title><p>(<bold>A</bold>) Sample raster plots of spontaneous spiking activity of excitatory and inhibitory neurons for network with nonspecific EI connectivity. Neurons are sorted according to their preferred orientation (from 0 to 180 degrees). Population preferred orientation (pop. PO, black) and population orientation selectivity index (pop. OSI, red) are shown at the bottom, for the activity of the excitatory population rendered in bins of 10 ms (Materials and methods). Only bins in which at least five excitatory neurons are active are included in the analysis. (<bold>B</bold>) Same as (A) for the spontaneous activity of networks with specific EI connectivity (Specific connectivity: 100%, corresponding to m = 1; see Materials and methods). Neurons show clustered activity around different preferred orientations, in the absence of a tuned external input with a specific orientation. The transition between highly selective states with different neuronal patterns (clustering of activity around different POs) is highlighted for two example regions (shaded). Note population activity patterns with different pop. POs and high pop. OSI in the vicinity of each other. (<bold>C,D</bold>) Same as (A,B), respectively, for evoked activity. During evoked activity, stimulus with a specific orientation (90°) is shown, conveying tuned input (Specific input: 100%) to neurons according to their preferred orientations. See Materials and methods for details.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Time scale of transitions between selective states during spontaneous activity.</title><p>(<bold>A</bold>) Pattern correlations of excitatory neurons as a function of the time interval between each pair of patterns. For each pair of highly selective excitatory population patterns (defined as pop. OSI &gt; 0.5), the correlation coefficient between the population activity and the time interval between their occurrence is calculated (black dots). Average pattern correlations are calculated for different pairs of population activity patterns at a given time interval (red). Right: A zoomed in version to show shorter time scales of pattern correlations. Parameters of connectivity are the same as <xref ref-type="fig" rid="fig6">Figure 6B</xref> (m<sub>EE</sub> = m<sub>EI</sub> = m<sub>IE</sub>=m<sub>II</sub> = 1). J = 1 and simulation time is 5s. Other parameters are the same as <xref ref-type="fig" rid="fig6">Figure 6</xref>. (<bold>B</bold>) Same as (<bold>A</bold>), but for a network connectivity with sharper EE connectivity than the rest: m<sub>EE</sub> = 1, m<sub>EI</sub> = m<sub>IE</sub> = m<sub>II</sub>=0.5.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig6-figsupp1-v2.tif"/></fig></fig-group><p>Networks without specific EI connectivity showed uniform activity patterns in the spontaneous state (<xref ref-type="fig" rid="fig6">Figure 6A</xref>) and highly selective responses even to weakly tuned inputs in the evoked state (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). In contrast, networks with specific EI connectivity showed fast transitions between highly selective states (as quantified by the selectivity of population responses; see Materials and methods) (<xref ref-type="fig" rid="fig6">Figure 6C</xref>), while preserving their selectivity in response to weakly tuned inputs in the evoked state (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). The fast time scale of spontaneous transitions can be characterized by calculating the correlations between selective patterns of the excitatory population as a function of the time interval between their occurrences (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Networks with balanced specific EI connections, where the specificity of EE connections was matched by the specificity of other connections, showed a very fast fall off of pattern correlations (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1A</xref>). In contrast, networks with broader inhibition exhibited very long time scales of pattern correlations (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1B</xref>). These results demonstrate that, although networks with highly specific excitatory connectivity can show selective spontaneous activity, fast transitions between these selective states only appear in networks that are balanced in EI connection specificity.</p><p>These different behaviours were better illustrated by plotting the distribution of the preferred orientations (PO) of temporary population responses for each of the four examples (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). Transitions between highly selective population responses would translate to a wide range of population POs with high selectivity (quantified by the orientation selectivity index, OSI, of the population). Nonspecific networks in the spontaneous activity showed a wide range of population POs, but highly selective population responses were rare, indicating that non-specific networks predominantly remain in the same, non-specific state. In contrast, specific networks showed spontaneous population responses with a wide range of POs and high OSIs at the same time (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, upper), consistent with spontaneous transitions between highly selective ensembles. Both networks, however, showed population responses with POs close to the stimulus orientation (90° here) when stimulated with weakly tuned inputs (<xref ref-type="fig" rid="fig7">Figure 7A</xref>, lower), although the specific network still showed more variability in the preferred orientation of the population activity. This variability is reminiscent of recurrently generated noise in clustered networks, which is suppressed by stimulus presentation (<xref ref-type="bibr" rid="bib34">Litwin-Kumar and Doiron, 2012</xref>).</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Quantification of spontaneous transition in networks with nonspecific and specific EI connections.</title><p>(<bold>A</bold>) Distribution of population POs derived from the four raster plots shown in <xref ref-type="fig" rid="fig6">Figure 6</xref>, for all the data (black) and for highly selective (orange) moments of population activity (pop. OSI &gt; 0.5). (<bold>B</bold>) The spontaneous transition (ST) index (Materials and methods) for all four combinations of spontaneous (Spont.) and evoked activity of networks with nonspecific (NS) or specific (SC) EI connectivity. Red bars show the mean and std of shuffled data for each case (see Materials and methods for details). (<bold>C</bold>) ST index for responses of networks with different degrees of specific connectivity (Spec. Conn.) and in response to inputs with different levels of specificity (Spec. Inp.). All results in this figure are obtained from similar networks as in <xref ref-type="fig" rid="fig5">Figures 5</xref> and <xref ref-type="fig" rid="fig6">6</xref>, but with longer simulation times (10s).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig7-v2.tif"/></fig><p>To quantify transitions between selective states, we developed a spontaneous transition (ST) index which combines both aspects of transition (showing a wide range of population POs) and selectivity (showing highly selective population responses) into a single metric (see Materials and methods). Higher ST values indicate higher frequency of visiting different and selective states, while low values indicate either lack of transition or transition between nonspecific states of neural activity. The ST index was very high for spontaneous responses of networks with specific EI connectivity but remained low for all other combinations (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). Development of the ST index to quantify spontaneous transition in each network allowed us to explore the parameter space more systematically. We simulated spiking networks with various degrees of specific connectivity in response to inputs with different levels of tuning and calculated the ST index for each network. The result revealed a landscape where selective spontaneous transitions are observed for networks with highly specific EI connectivity. The spontaneous transitions are, however, quenched in response to tuned inputs carrying stimulus information in the evoked state (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). We therefore conclude that spiking networks with highly specific EI connectivity can show rapid transitions between selective states during spontaneous activity, and this is consistent with their selective stimulus-evoked responses to tuned inputs.</p><p>To directly test whether there is a relationship between the dynamical signature of specific ISNs (namely, the feature-specific paradoxical effect) and spontaneous transitions between selective states, we quantified both in spiking networks with different degrees of specific connectivity (<xref ref-type="fig" rid="fig8">Figure 8</xref>). In each network, we calculated the ST index in the spontaneous activity and the slope of the inhibitory response changes as a function of patterned perturbations (sample networks for low, medium and high specific connectivity in <xref ref-type="fig" rid="fig8">Figure 8A,B</xref>). Comparing the ST index with the slope for different networks revealed that there is indeed a correlation between negative slopes (i.e., feature-specific paradoxical effect) and higher spontaneous transitions (<xref ref-type="fig" rid="fig8">Figure 8C,D</xref>). Transition to feature-specific ISNs was in fact correlated with a rapid jump in the ST index from low values (<xref ref-type="fig" rid="fig8">Figure 8D</xref>), indicating a change in the regime of activity. These results show that emergence of spontaneous transitions between selective states and the presence of specific paradoxical effects (as a dynamical signature of feature-specific inhibitory stabilization) are concomitant effects in networks with specific EI connectivity.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Correlation between specific paradoxical effects and spontaneous transitions between selective states.</title><p>(<bold>A</bold>) Sample raster plots of spiking activity from networks with different degree of specific EI connectivity (m = 0, 10, 100%, respectively). Networks and conventions are otherwise similar to <xref ref-type="fig" rid="fig6">Figure 6</xref>. (<bold>B</bold>) Normalized response change of inhibitory neurons as a function of the normalized change in their input due to patterned perturbations. Response changes (Resp. change) and input perturbations (Inp. perturb.) are normalized to the average firing rate and the average input in the baseline state, respectively. The network is simulated for 5s in the baseline state, and another 5s during patterned perturbation. Numbers in red denote the slope of the best fitted regression line to the data (red line). The procedure and conventions are otherwise similar to <xref ref-type="fig" rid="fig5">Figure 5C</xref>. (<bold>C</bold>) The ST index (as in <xref ref-type="fig" rid="fig7">Figure 7</xref>) as a function of the slope of perturbations for different networks (back dots). The mean and std of the ST index for shuffled activity (100 repetitions) are shown for comparison (grey). (<bold>D</bold>) The bootstrapped ST index for networks with negative (specific paradoxical effect) and positive (normal) slopes of perturbations. (<bold>E</bold>) Bootstrapped ST index and the normalized specific ISN effect (Spec. ISN) in networks as a function of feature-specific connectivity (m). Spec. ISN for each network is calculated by normalizing the slope of the perturbation by slope in the network with the maximum specific connectivity (m = 100%).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-52757-fig8-v2.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>By simulating computational models at different levels of realism, and through theoretical analysis of such networks, we showed here that specific inhibitory stabilized networks (specific ISNs, where unstable specific excitatory connectivity is balanced by specific inhibition) can show ‘specific paradoxical effects’. We further showed that, to reveal such specific ISNs, patterned perturbation of inhibition is needed. Our study thus extends classical inhibitory-stabilized networks, where only the uniform paradoxical effect was studied in response to nonspecific perturbations of inhibition. Our results suggest that specific ISNs show specific paradoxical effects <italic>in addition</italic> to the uniform paradoxical effect, provided they are probed by the proper patterns of perturbation, which would effectively stimulate the specific dynamics of the network. Absent such patterned perturbation, they would behave the same as nonspecific ISNs and hence their specific inhibitory stabilization would remain undetected.</p><p>Operation of cortical networks in specific ISN regimes adds another dimension to the computational capacity of the brain. It argues for the presence of specific directions of amplification of the feedforward input by the cortical dynamics, which is stabilized by a precisely tuned inhibition along the same direction. Our study suggests that, if such specific computational dimensions existed or emerged in cortical networks, they would be manifested by the specific paradoxical effects in response to patterned perturbations. While the classic paradoxical effect is observed by perturbing and measuring the average activity of inhibitory neurons in a non-specific manner (e.g. <italic>increased</italic> average activity when the perturbation <italic>decreases</italic> the average input), the specific paradoxical effect is observed in the relation between the residual input and output response of inhibitory neurons around the mean. We provided a quantitative metric for measuring this specific paradoxical effect, by evaluating the slope of the regression line fitted to response changes as a function of input perturbations (e.g., <xref ref-type="fig" rid="fig2">Figure 2C</xref>). Note that, as such, the measure would be robust to different rate changes that might be induced for neurons with different firing rates (e.g., cells with high firing rates will have their absolute rate decreased more than a cell firing sparsely in response to external inhibitory current injection). Such a dependence would not change the sign of the slope, which is important to infer the specific paradoxical effect.</p><p>In reality, it is difficult to measure connectivity for every individual circuit before optogenetically perturbing it. We therefore used feature or RF specificity as a proxy for connection weights, since it has been shown to be a good predictor of connectivity (<xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>). Our results, however, indicated that perturbation patterns based on one-dimensional features of neurons, for example their orientation selectivity, might not be proper protocols to probe specific ISNs as they would not effectively recruit the specific dynamics of the network. Considering the full RF similarity induced a better and more effective way of unravelling specific ISNs, and our spectral analysis revealed the underlying difference between the two perturbation protocols. Based on these results, we predict that experimental protocols relying on a single one-dimensional feature to deliver patterned perturbations may not be as potent to reveal specific ISNs, compared to patterned perturbations based on full RF similarity.</p><p>Receptive field mapping can, however, be equally costly, especially given that large-scale networks of inhibitory neurons need to be imaged and perturbed to see the specific ISN effects. We therefore explored the alternative possibility of using response similarity (assayed by how similarly neurons respond to an ensemble of stimuli) to deliver patterned perturbations, since response similarity has also been suggested as a good predictor of network connectivity (<xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>). Patterned perturbation based on response similarity would be possible by all-optical techniques which enable reading and writing the neuronal activity at the same time (<xref ref-type="bibr" rid="bib17">Emiliani et al., 2015</xref>; <xref ref-type="bibr" rid="bib62">Zhang et al., 2018</xref>). Our results revealed that specific paradoxical effects can be induced with such perturbation protocols, but the choice of the ensemble of stimuli used to probe the network responses could be crucial. Stimuli with statistics similar to RFs were more powerful in revealing specific ISNs, while wide-field gratings with fixed or diverse spatial frequencies did not prove to be as effective. While we generated stimuli with the same statistics as neuronal RFs in our simulations, we expect that natural images lead to the same results. Based on these results, we therefore suggest that the most effective and feasible protocol to detect specific ISNs would be to perturb the neuronal networks based on their response similarity in response to natural images, with read/write optogenetics tools.</p><p>In order to reveal the specific paradoxical effect, patterned perturbations can be induced by either decreasing or increasing the input to inhibitory neurons (positive or negative perturbations, respectively). Negative perturbations, however, were proven to be more powerful in our study (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). This is due to the fact that the ‘floor effect’ limits positive perturbations: in sparsely active networks (like the visual cortex), potent activation of inhibitory neurons can lead to strong rectification of the network activity. Such intensity-dependent optogenetics effects were in fact implicated as a source of conflict in the results of previous studies on the functional role of different subtypes of inhibitory neurons (<xref ref-type="bibr" rid="bib29">Lee et al., 2012</xref>; <xref ref-type="bibr" rid="bib60">Wilson et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">El-Boustani et al., 2014</xref>). If excitatory neurons are already active at very low rates due to balance of excitation and inhibition, strong positive perturbations of inhibition would lead to silencing of the network, which can obscure the paradoxical effect by decreasing the ‘effective’ size of the network involved in excitatory-inhibitory interaction. Decreasing the input to inhibitory neurons, on the other hand, increases the activity of excitatory neurons arbitrarily. Although the specific paradoxical effect can in principle be revealed with infinitesimally small positive perturbations, in realistic experimental conditions with significant measurement noise, such small perturbations would decrease the signal-to-raise ratio, hence limiting the statistical power to infer the presence of the negative slope of response changes versus input perturbations. Our results thus suggest that experimental protocols relying on negative patterned perturbations would be more powerful to reveal specific ISNs.</p><p>Another experimental constraint for probing the presence of specific ISNs in the cortex is related to the span of recording fields. As patterned perturbations are delivered with regard to functional properties of neurons (e.g. their visual RFs), the more similar the neurons are, the more difficult it becomes to assess the slope of their response changes to input perturbations. Therefore, if the window of imaging is too small and/or perturbations are delivered too locally, the visual RFs might become too similar, which would limit the range of input perturbations based on RF dissimilarity (x-axis in <xref ref-type="fig" rid="fig2">Figure 2C</xref>). This, in turn, impedes the assessment of the specific paradoxical effect, by limiting the statistical power of measurements to infer a significant negative slope. Wide-field perturbation/imaging is, therefore, necessary to obtain enough heterogeneity in RFs of inhibitory neurons needed for such assessment.</p><p>Our study here has also important implications for neuronal connectivity in the cortex. We argued that networks with strong specific excitatory connections, as reported in the visual cortex of rodents (<xref ref-type="bibr" rid="bib28">Ko et al., 2013</xref>; <xref ref-type="bibr" rid="bib13">Cossell et al., 2015</xref>), would be unstable in the absence of specific inhibitory stabilization. Although recent experimental findings (<xref ref-type="bibr" rid="bib63">Znamenskiy et al., 2018</xref>) have corroborated this possibility, assessing the presence or absence of specific ISNs in the cortex can be considered as a crucial experiment to investigate the functional specificity of inhibitory connectivity. This may, in turn, shed light on the long-lasting debate over the tuning of inhibitory neurons and the specificity of their connections (<xref ref-type="bibr" rid="bib36">Liu et al., 2011</xref>; <xref ref-type="bibr" rid="bib60">Wilson et al., 2012</xref>; <xref ref-type="bibr" rid="bib49">Runyan and Sur, 2013</xref>). Our results thus offer detailed predictions regarding the observation of specific inhibitory stabilization in cortical networks with specific EI connectivity, while highlighting important constraints on the design of experimental protocols to effectively probe them.</p><p>To unravel their dynamical and functional properties, cortical circuits have so far been mainly probed by simple perturbation protocols. Even when optogenetic perturbations are delivered specifically to certain neuronal subtypes, for example parvalbumin positive (PV+) or somatostatin-positive (SOM+) inhibitory cells, they typically stimulate the whole, or a random fraction of the population nonspecifically. Recent advances in optogenetic techniques are enabling us - at an unprecedented pace - to design perturbation protocols where a specific pattern (e.g. a specific sequence or spatiotemporal pattern of activity) is invoked in identified neurons (<xref ref-type="bibr" rid="bib17">Emiliani et al., 2015</xref>; <xref ref-type="bibr" rid="bib46">Ronzitti et al., 2017</xref>; <xref ref-type="bibr" rid="bib11">Chernov et al., 2018</xref>; <xref ref-type="bibr" rid="bib62">Zhang et al., 2018</xref>; <xref ref-type="bibr" rid="bib10">Carrillo-Reid et al., 2019</xref>; <xref ref-type="bibr" rid="bib39">Marshel et al., 2019</xref>; <xref ref-type="bibr" rid="bib50">Russell, 2019</xref>; <xref ref-type="bibr" rid="bib55">Tran et al., 2019</xref>). Our study here proposes that such technological advances are indeed necessary to reveal fundamental principles of cortical computation. Our results in fact suggest a further level of specificity (amplitude) as a prerequisite of patterned perturbation, since not only specific neurons should be perturbed to reveal specific ISNs, but different levels of perturbation (according to specific patterns) should be delivered to achieve effective recruitment of the specific mode. Such amplitude-specific patterns of perturbation, with different levels of perturbation at identified neurons, might be instrumental in effective interrogation of cortical networks during healthy and unhealthy function (e.g. in detecting specific epileptic modes of activity).</p><p>Patterned perturbations can also shed light on the controversy over the nature of the paradoxical effects. While the observation of paradoxical effects in several studies and across different cortices (<xref ref-type="bibr" rid="bib2">Adesnik, 2017</xref>; <xref ref-type="bibr" rid="bib25">Kato et al., 2017</xref>; <xref ref-type="bibr" rid="bib31">Li et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Sanzeni, 2019</xref>) has been mainly attributed to ISN dynamics, one needs to rule out the possibility of disinhibition underlying this effect, given the complex connectivity of multiple subtypes of inhibitory neurons (<xref ref-type="bibr" rid="bib43">Pfeffer et al., 2013</xref>). A recent study has in fact suggested that cortical circuits can exhibit paradoxical effects because of disinhibitory loops rather than inhibition-stabilization mechanisms (<xref ref-type="bibr" rid="bib38">Mahrach et al., 2020</xref>). Patterned perturbations of the type we have proposed in this work has the potential to distinguish between these two possibilities, for the following reason. By assuming a degree of specific connectivity between pyramidal cells (PC) and PV+ interneurons (<xref ref-type="bibr" rid="bib63">Znamenskiy et al., 2018</xref>), specific inhibitory perturbations delivered to PV+ neurons would reveal the feature-specific ISN dynamics arising within PC-PV circuitry. Disinhibition, namely inhibition of PV+ interneurons by SOM+ interneurons, can only arise from PC→SOM→PV stream (<xref ref-type="bibr" rid="bib43">Pfeffer et al., 2013</xref>). For disinhibition to be feature-specific, we need to have similar levels of specific connectivity not only between PC→SOM, but also SOM→PV connections. Although SOM+ cells have been reported to have higher orientation selectivity than PV+ neurons (<xref ref-type="bibr" rid="bib37">Ma et al., 2010</xref>), they are known to be involved in larger scales of spatial integration, as opposed to local processing of PV+ cells (<xref ref-type="bibr" rid="bib1">Adesnik et al., 2012</xref>; <xref ref-type="bibr" rid="bib16">El-Boustani and Sur, 2014</xref>). It is, therefore, likely that they have larger RFs and mediating feature-specific surround suppression, more than being involved in local processing of visual information, that shapes the type of specific connectivity we explored here. One way of testing this experimentally would be to change the spatial extent of patterned perturbations from local to global and assay the paradoxical effect. This should shed light on whether a disinhibitory mechanism governed by SOM+ neurons is involved in the paradoxical effect. However, mapping the feature-specific connectivity of SOM+ cells with pyramidal cells would ultimately be needed to constrain the computational models for the role of different subtypes of inhibition in feature-specific ISNs.</p><p>Our study of specific ISNs revealed different functional properties of these networks. We found that networks with strong specific EI connectivity can undergo spontaneous transitions between highly selective ensembles, reminiscent of what has recently been observed in mouse visual cortex (<xref ref-type="bibr" rid="bib40">Miller et al., 2014</xref>), and similar to what had previously been reported in other species with structured cortical maps (<xref ref-type="bibr" rid="bib26">Kenet et al., 2003</xref>). Our modelling results showed that such fast spontaneous transitions only happen in specific networks and in the absence of tuned input to neurons. Note that, in comparison, classical attractor networks show very slow dynamics (<xref ref-type="bibr" rid="bib20">Goldberg et al., 2004</xref>), and networks with only EE specific connectivity were incapable of reproducing such fast time scales of transition (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib52">Sadeh et al., 2015b</xref>). This would, in turn, render such models in their simple form inconsistent with the finding that sensory-evoked activity decays rapidly in recurrent circuits after silencing the feedforward input in visual cortex (<xref ref-type="bibr" rid="bib44">Reinhold et al., 2015</xref>). Specific ISNs, on the other hand, are equipped with a mechanism for such fast transitions due to specific EI balance (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>) and, therefore, highly specific EE connectivity in these networks can be consistent with the experimentally reported time scales.</p><p>Rapid transitions between specific states, without being trapped in each attractor for long, can give the network the capacity of revisiting the functional subnetworks spontaneously. This can endow the network with intrinsic mechanism to reactivate the learned states to avoid forgetting, in the absence of specific stimulation, and it might be important for plasticity, such that reactivation during the evoked state does not lead to unlearning (<xref ref-type="bibr" rid="bib35">Litwin-Kumar and Doiron, 2014</xref>). It can also provide a template of most likely stimulus states, thus leading to a more efficient representation of the environment and more parsimonious responses to external stimuli. Other functional benefits of specific ISNs can be in line with the computational advantages envisaged for conventional ISNs, like selective amplification, noise rejection and pattern completion. The specific ISN regime may enable the network to perform these computations specifically along the ‘right’ dynamics. In fact, the emergence of specific connectivity in developing visual cortex is correlated with an increase in the reliability of responses (<xref ref-type="bibr" rid="bib28">Ko et al., 2013</xref>). Future studies are needed to investigate the contribution of different motifs of connectivity, including specific EI interaction, to this process.</p><p>It is also interesting to speculate on the possible mechanisms underlying the emergence of feature-specific ISNs. To obtain feature-specific connectivity of inhibition which specifically balances excitatory subnetworks, detailed balance as opposed to general balance is needed (<xref ref-type="bibr" rid="bib21">Hennequin et al., 2014</xref>; <xref ref-type="bibr" rid="bib22">Hennequin et al., 2017</xref>). One possibility to achieve such detailed balance is via inhibitory plasticity mechanisms, as suggested for instance by plasticity of I-to-E synapses (<xref ref-type="bibr" rid="bib59">Vogels et al., 2011</xref>). This is in fact consistent with the specificity of I-to-E weights reported in the visual cortex (<xref ref-type="bibr" rid="bib63">Znamenskiy et al., 2018</xref>). However, E-to-I synapses have also been reported to have a significant level of specificity (<xref ref-type="bibr" rid="bib63">Znamenskiy et al., 2018</xref>). A large-scale model of visual processing in balanced networks equipped with a voltage- and spike-dependent plasticity rule (<xref ref-type="bibr" rid="bib12">Clopath et al., 2010</xref>) reported the emergence of a bidirectional specificity of E-I connections (<xref ref-type="bibr" rid="bib51">Sadeh et al., 2015a</xref>). In future studies, it would be interesting to selectivity perturb different connectivity motifs (E-to-I and I-to-E) and plasticity mechanisms and explore the role of each in the emergence of feature-specific ISNs.</p><p>In summary, our study of networks with strong and specific excitatory-inhibitory connectivity reveals new dynamical and functional properties arising from specific inhibitory stabilization. Our results suggest that specific ISNs not only show the classical paradoxical effect, reflected in the average activity of the population, but also manifest specific paradoxical effects, which is represented in the pattern of response change of inhibitory neurons in response to external perturbations. To reveal the specific paradoxical effect, however, patterned perturbations aligned with the specific mode of inhibitory stabilization in the network is necessary.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Network modelling</title><sec id="s4-1-1"><title>Rate-based simulations</title><p>We simulated networks of rate-based neurons with dynamics described as:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>τ</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the vectors of firing rates of <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> excitatory (E) and <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> inhibitory (I) neurons, respectively. <inline-formula><mml:math id="inf20"><mml:mi>W</mml:mi></mml:math></inline-formula> is the matrix of connection weights, including connections between E-to-E (<inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), E-to-I (<inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), I-to-E (<inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and I-to-I (<inline-formula><mml:math id="inf24"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) neurons. <inline-formula><mml:math id="inf25"><mml:mi>s</mml:mi></mml:math></inline-formula> is the external input, with <inline-formula><mml:math id="inf26"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denoting inputs to E and I neurons, respectively. <inline-formula><mml:math id="inf28"><mml:mi>τ</mml:mi></mml:math></inline-formula> is the effective time constant of the network, with a default value of <inline-formula><mml:math id="inf29"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mn>10</mml:mn></mml:math></inline-formula> in our simulations. <inline-formula><mml:math id="inf30"><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> denotes half-wave rectification. We used forward Euler method to solve for the firing rates of neurons.</p><p>To simulate networks with expansive nonlinearity, we solved a more generalized dynamics, described by <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mi>d</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, where n determines the power of nonlinearity.</p></sec><sec id="s4-1-2"><title>Spiking network simulations</title><p>Spiking networks were modelled by simulating the equations describing the membrane potential dynamics of leaky integrate-and-fire neurons:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the membrane potential of a neuron, and <inline-formula><mml:math id="inf33"><mml:msub><mml:mrow><mml:mi mathvariant="normal">τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>C</mml:mi></mml:math></inline-formula> is the time constant of integration of the membrane potential, where <inline-formula><mml:math id="inf34"><mml:mi>R</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf35"><mml:mi>C</mml:mi></mml:math></inline-formula> are the membrane resistance and capacitance, respectively. Spiking mechanism is implemented as follows: when the membrane potential reaches a voltage threshold, <inline-formula><mml:math id="inf36"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn> <mml:mi/><mml:mi>m</mml:mi><mml:mi>V</mml:mi></mml:math></inline-formula>, a spike is elicited and the membrane potential is reset to the reset voltage, <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. We used exact integration method (<xref ref-type="bibr" rid="bib47">Rotter and Diesmann, 1999</xref>) to solve for the membrane potential and spiking activity of neurons.</p><p>The momentary input to the neuron is described by <inline-formula><mml:math id="inf38"><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo> <mml:mi/><mml:mo>=</mml:mo> <mml:mi/><mml:mi>R</mml:mi> <mml:mi/><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, which arises from incoming spikes to the neuron and comprises two components: external input from feedforward and background sources (reflecting stimulus-induced input and input from non-local sources, respectively), and internally generated input from recurrent activity. Once a spike is emitted in a presynaptic source, an instantaneous change in the membrane potential of all postsynaptic sources is emulated in the next simulation time step, by the value of <inline-formula><mml:math id="inf39"><mml:mi>J</mml:mi></mml:math></inline-formula> mV. Note that <inline-formula><mml:math id="inf40"><mml:mi>J</mml:mi></mml:math></inline-formula> is already expressed in units of volts and not current, and hence describes the effect of <inline-formula><mml:math id="inf41"><mml:mi>R</mml:mi><mml:mi>I</mml:mi></mml:math></inline-formula> simultaneously. The total input at time <inline-formula><mml:math id="inf42"><mml:mi>t</mml:mi></mml:math></inline-formula> for a postsynaptic neuron <inline-formula><mml:math id="inf43"><mml:mi>i</mml:mi></mml:math></inline-formula> can therefore be written as <inline-formula><mml:math id="inf44"><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo> <mml:mi/><mml:mo>=</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow> <mml:mi/><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> denotes the presence (1) or absence (0) of spike in all presynaptic sources (including external input or input from presynaptic neurons in the recurrent network), and <inline-formula><mml:math id="inf46"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> describes the weight of connection (in mV) from the <inline-formula><mml:math id="inf47"><mml:mi>j</mml:mi></mml:math></inline-formula>-th presynaptic source.</p></sec><sec id="s4-1-3"><title>Neuronal receptive fields</title><p>The identity and stimulus preference of neurons is assigned in two ways:</p><list list-type="order"><list-item><p>Based on 1D preferred features (preferred orientation as in <xref ref-type="fig" rid="fig2">Figure 2</xref>), where neurons are assigned a random initial preferred orientation between <inline-formula><mml:math id="inf48"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>.</p></list-item><list-item><p>Based on 2D visual receptive fields (RFs, as in <xref ref-type="fig" rid="fig3">Figure 3</xref>), which are assigned by generating a population of 2D Gabor fields with the following parameters:</p></list-item></list><p><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msup><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mfrac><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>λ</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>x</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mi>y</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mi>y</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf49"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mi>y</mml:mi></mml:math></inline-formula> specify the position on the 2D visual field, and <inline-formula><mml:math id="inf51"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the preferred orientation of the RF. The standard deviation <inline-formula><mml:math id="inf52"><mml:mi>σ</mml:mi></mml:math></inline-formula> determines the size and <inline-formula><mml:math id="inf53"><mml:mi>γ</mml:mi></mml:math></inline-formula> controls the aspect ratio of the receptive field, the parameter <inline-formula><mml:math id="inf54"><mml:mi>λ</mml:mi></mml:math></inline-formula> determines the wavelength (with <inline-formula><mml:math id="inf55"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:math></inline-formula> determining the spatial frequency, <inline-formula><mml:math id="inf56"><mml:mi>ω</mml:mi></mml:math></inline-formula>), and <inline-formula><mml:math id="inf57"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> is the spatial phase of the field.</p><p>Default parameters are chosen as follows: <inline-formula><mml:math id="inf58"><mml:mi>θ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> are drawn randomly from a uniform distribution between <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf61"><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf62"><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, spatial frequency (<inline-formula><mml:math id="inf63"><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:math></inline-formula>) is drawn from a gamma distribution with shape parameter 2 and scale parameter 0.04. RFs are instantiated in a <inline-formula><mml:math id="inf64"><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:math></inline-formula> field, where <inline-formula><mml:math id="inf65"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:math></inline-formula> specifies the extent of the visual field in each direction in degrees. The resolution of the instantiated fields was 4 pixels per degree (ppd). Each RF was centreed at a specific position, <inline-formula><mml:math id="inf66"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, which was close to the centre of the field, (0, 0), but with some random variation, <inline-formula><mml:math id="inf67"><mml:mo>(</mml:mo><mml:mi>δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, which were in turn drawn randomly from [−1.25, 1.25] degrees.</p></sec><sec id="s4-1-4"><title>Network connectivity</title><p>Network connectivity is implemented similarly in rate-based and spiking networks, with the entry of the weight matrix <inline-formula><mml:math id="inf68"><mml:mi>W</mml:mi></mml:math></inline-formula> corresponding to presynaptic neuron <inline-formula><mml:math id="inf69"><mml:mi>j</mml:mi></mml:math></inline-formula> and postsynaptic neuron <inline-formula><mml:math id="inf70"><mml:mi>i</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf71"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) denoting the strength of connections in both. This quantity is in arbitrary units for rate-based networks, and it is expressed in mV for spiking networks. In both networks, all neurons are connected to each other (all-to-all connectivity) and the specific connectivity is obtained by modulating the connection weights based on the similarity of pre- and postsynaptic neurons. The similarity of neuronal pairs is defined based on their RF type:</p><p>For neurons with RFs based on 1D features (e.g. orientation selective neurons in <xref ref-type="fig" rid="fig2">Figure 2</xref>), the weight matrix is constructed as 1D feature-specific (e.g. orientation-specific) connectivity. Connection weights between neurons <inline-formula><mml:math id="inf72"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:mi>j</mml:mi></mml:math></inline-formula> are modulated according to the difference of their preferred orientation as the following:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>J</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf74"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the preferred orientation in radians, and <inline-formula><mml:math id="inf75"><mml:mi>m</mml:mi></mml:math></inline-formula> specifies the degree of specific connectivity (ranging from 0%, for nonspecific, to 100%, for maximum specific connectivity). To add randomness, each weight is multiplied by <inline-formula><mml:math id="inf76"><mml:mi>ζ</mml:mi></mml:math></inline-formula>, which is a random number between 0 and 2. Note that this procedure does not change the mean weights, while randomly amplifying or attenuating the deterministic weights between 0 to 100%.</p><p>For neurons with 2D visual RFs (e.g. as in <xref ref-type="fig" rid="fig3">Figure 3</xref>), the specific connectivity was constructed based on RF similarity of neuronal pairs. Connection weights between neuronal pairs are modulated as a function of their respective RF correlations according to:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>J</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.1</mml:mn><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf77"><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the pairwise correlation coefficient of visual RFs of neurons <inline-formula><mml:math id="inf78"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf80"><mml:mi>m</mml:mi></mml:math></inline-formula> denotes the degree of specific connectivity as before, and <inline-formula><mml:math id="inf81"><mml:mi>η</mml:mi></mml:math></inline-formula> determines the sharpness of the exponential dependence of weights on RF correlations (see e.g. <xref ref-type="fig" rid="fig3">Figure 3B</xref> with <inline-formula><mml:math id="inf82"><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>).</p></sec><sec id="s4-1-5"><title>Network stimulation and perturbation</title><p>During baseline state, all neurons in the networks received similar levels of input from external sources. This was emulated as a constant input with some random variation for rate-based models or a sequence of spikes generated from a Poisson process with a fixed rate for spiking simulations. Upon perturbation, the input to inhibitory neurons was <italic>reduced</italic>, either by decreasing the input (in rate-based simulations) or decreasing the rate of incoming spikes (in spike-based models) to inhibitory neurons. Perturbations were either performed randomly, by ignoring the identity of inhibitory neurons and decreasing the input to them with a random value generated from a uniform distribution, or according to a pattern respecting neuronal identity (e.g. as in <xref ref-type="fig" rid="fig2">Figure 2B</xref>, lower). To control for the distribution of perturbations, we also randomized the same pattern over neurons, and used it as a randomized control for perturbations (c.f. <xref ref-type="fig" rid="fig2">Figure 2B</xref>, upper).</p><p>Patterned perturbations according to 1D feature selectivity (e.g. in <xref ref-type="fig" rid="fig2">Figure 2</xref>) was delivered by changing the baseline input to inhibitory neurons with respect to their orientation selectivity:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf83"><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the vector of perturbation of inhibitory neurons, <inline-formula><mml:math id="inf84"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the vector of preferred orientation of inhibitory neurons, and <inline-formula><mml:math id="inf85"><mml:mi>γ</mml:mi></mml:math></inline-formula> denotes the size of perturbation. For networks containing neurons with 2D RFs (e.g. in <xref ref-type="fig" rid="fig3">Figure 3</xref>), patterned perturbation was delivered with regard to RF similarity of inhibitory neurons to a reference inhibitory neuron, <inline-formula><mml:math id="inf86"><mml:mi>k</mml:mi></mml:math></inline-formula>, as follows:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf87"><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the vector of RF correlation of inhibitory neurons to the reference cell, and <inline-formula><mml:math id="inf88"><mml:mi>γ</mml:mi></mml:math></inline-formula> denotes the size of perturbation as before. We also delivered patterned perturbations based on response similarity for these networks (<xref ref-type="fig" rid="fig4">Figure 4</xref>), where <inline-formula><mml:math id="inf89"><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was replaced by the response correlation of neurons in response to a sequence of stimuli, as described below.</p><p>To probe response similarity or neurons in the network, we simulated the networks (as in <xref ref-type="fig" rid="fig4">Figure 4</xref>, and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) with four different stimulus sets. First, stimuli were generated following the same procedure used to generate 2D Gabor fields for neuronal RFs, with the same parameters as described above. Therefore, RFs and stimuli had the same statistics although they were obviously different. Two other sets of stimuli consisted of full-field gratings (examples shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) with different orientations and spatial phases, both randomly drawn from the range <inline-formula><mml:math id="inf90"><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:math></inline-formula>. One set has a fixed spatial frequency of <inline-formula><mml:math id="inf91"><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:math></inline-formula>, while the other had a wide range of spatial frequencies matching the distribution of spatial frequencies of RFs. The fourth set of stimuli consisted of natural images, which were taken from the McGill calibrated image database (<ext-link ext-link-type="uri" xlink:href="http://tabby.vision.mcgill.ca">http://tabby.vision.mcgill.ca</ext-link>). The central part of each image was chosen, with the same size (in pixels) as RFs (that is, the central 200x200 pixels).</p><p>For each stimulus type, a sequence of 200 stimuli was presented to the network. Upon presentation of each stimulus (for 200 ms), the external input to each neuron was modulated by the correlation of its RF with the stimulus field, according to <inline-formula><mml:math id="inf92"><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">β</mml:mi><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <inline-formula><mml:math id="inf93"><mml:msubsup><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes the correlation of the i-th stimulus field with the j-th RF, and <inline-formula><mml:math id="inf94"><mml:mi mathvariant="normal">β</mml:mi></mml:math></inline-formula> specifies the depth of modulation. The activity trace of neurons in response to the full sequence of stimuli was then correlated with each other to generate a measure of response similarity. The parameters of <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> were chosen to be <inline-formula><mml:math id="inf95"><mml:mi mathvariant="normal">γ</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mn>0.25</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf96"><mml:mi mathvariant="normal">κ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> for all four stimulus types. <inline-formula><mml:math id="inf97"><mml:mi mathvariant="normal">β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> for full-field gratings and natural images (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>), but we chose a smaller value for RF-like stimuli (<inline-formula><mml:math id="inf98"><mml:mi mathvariant="normal">β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>), as they had higher correlations with RFs on average (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>Other parameters of network simulations are provided in <xref ref-type="table" rid="table1">Table 1</xref> and <xref ref-type="table" rid="table2">Table 2</xref>, for rate-based and spiking networks, respectively.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Parameters of rate-based networks.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Description</th><th valign="top">Type</th><th valign="top">Symbol</th><th valign="top"><xref ref-type="fig" rid="fig2">Figure 2</xref></th><th valign="top"><xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref></th><th valign="top"><xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref></th><th valign="top"><xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig4">4</xref></th></tr></thead><tbody><tr><td rowspan="2" valign="top">Number of neurons</td><td valign="top">E</td><td><inline-formula><mml:math id="inf99"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">400</td><td valign="top">400</td><td valign="top">400</td><td valign="top">400</td></tr><tr><td valign="top"> I</td><td><inline-formula><mml:math id="inf100"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">400</td><td valign="top">400</td><td valign="top">400</td><td valign="top">400</td></tr><tr><td valign="top">Time constant</td><td valign="top">E and I</td><td valign="top"/><td valign="top">10</td><td valign="top">10</td><td valign="top">10</td><td valign="top">10</td></tr><tr><td rowspan="4" valign="top">Synaptic weight</td><td valign="top">E→E</td><td><inline-formula><mml:math id="inf101"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">0.05</td><td valign="top">0.001</td><td valign="top">0.05</td><td valign="top">0.05</td></tr><tr><td valign="top"> E→I</td><td><inline-formula><mml:math id="inf102"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">0.05</td><td valign="top">0.001</td><td valign="top">0.05</td><td valign="top">0.05</td></tr><tr><td valign="top"> I→E</td><td><inline-formula><mml:math id="inf103"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">−0.075</td><td valign="top">−0.0015</td><td valign="top">−0.075</td><td valign="top">−0.075</td></tr><tr><td valign="top"> I→I</td><td><inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">−0.075</td><td valign="top">−0.0015</td><td valign="top">−0.075</td><td valign="top">−0.075</td></tr><tr><td valign="top">Synaptic specificity</td><td valign="top">E→E</td><td><inline-formula><mml:math id="inf105"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">1</td><td valign="top">0</td><td valign="top">0.5</td></tr><tr><td valign="top"/><td valign="top">E→I</td><td><inline-formula><mml:math id="inf106"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">1</td><td valign="top">0</td><td valign="top">0.5</td></tr><tr><td valign="top"/><td valign="top">I→E</td><td><inline-formula><mml:math id="inf107"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">1</td><td valign="top">0</td><td valign="top">0.5</td></tr><tr><td valign="top"/><td valign="top">I→I</td><td><inline-formula><mml:math id="inf108"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">1</td><td valign="top">0</td><td valign="top">0.5</td></tr><tr><td valign="top">Specificity exponent</td><td valign="top"/><td valign="top">η</td><td valign="top">-</td><td valign="top">-</td><td valign="top">-</td><td valign="top">2</td></tr></tbody></table></table-wrap><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Parameters of spiking networks.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Description</th><th valign="top">Type</th><th valign="top">Symbol</th><th valign="top"><xref ref-type="fig" rid="fig5">Figure 5</xref></th><th valign="top"><xref ref-type="fig" rid="fig6">Figures 6</xref>–<xref ref-type="fig" rid="fig8">8</xref></th></tr></thead><tbody><tr><td rowspan="2" valign="top">Number of neurons</td><td valign="top">E</td><td><inline-formula><mml:math id="inf109"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">500</td><td valign="top">500</td></tr><tr><td valign="top">I</td><td><inline-formula><mml:math id="inf110"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">500</td><td valign="top">500</td></tr><tr><td valign="top">Membrane time constant</td><td valign="top">E and I</td><td valign="top"><inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (ms)</td><td valign="top">20</td><td valign="top">20</td></tr><tr><td valign="top">Threshold voltage</td><td valign="top">E and I</td><td valign="top"><inline-formula><mml:math id="inf112"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mV)</td><td valign="top">20</td><td valign="top">20</td></tr><tr><td valign="top">Reset voltage</td><td valign="top">E and I</td><td valign="top"><inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (mV)</td><td valign="top">0</td><td valign="top">0</td></tr><tr><td rowspan="4" valign="top">Synaptic weight</td><td valign="top">E→E</td><td valign="top"><inline-formula><mml:math id="inf114"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mV)</td><td valign="top">2</td><td valign="top">2</td></tr><tr><td valign="top"> E→I</td><td valign="top"><inline-formula><mml:math id="inf115"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mV)</td><td valign="top">2</td><td valign="top">2</td></tr><tr><td valign="top"> I→E</td><td valign="top"><inline-formula><mml:math id="inf116"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mV)</td><td valign="top">-4</td><td valign="top">-4</td></tr><tr><td valign="top"> I→I</td><td valign="top"><inline-formula><mml:math id="inf117"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mV)</td><td valign="top">-4</td><td valign="top">-4</td></tr><tr><td valign="top">Synaptic specificity</td><td valign="top">E→E</td><td><inline-formula><mml:math id="inf118"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">[0 … 1]</td></tr><tr><td valign="top"/><td valign="top">E→I</td><td><inline-formula><mml:math id="inf119"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">[0 … 1]</td></tr><tr><td valign="top"/><td valign="top">I→E</td><td><inline-formula><mml:math id="inf120"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">[0 … 1]</td></tr><tr><td valign="top"/><td valign="top">I→I</td><td><inline-formula><mml:math id="inf121"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">1</td><td valign="top">[0 … 1]</td></tr></tbody></table></table-wrap></sec></sec><sec id="s4-2"><title>Data analysis</title><p>To quantify the specific paradoxical effect (e.g., as in <xref ref-type="fig" rid="fig2">Figure 2C</xref>), we fitted lines to response changes (obtained as the difference of the average activity during perturbation and baseline states, after discarding the initial transient period) versus respective input perturbations. The slope and the significance of the best fitted linear regression was used, with significantly negative slopes denoting specific paradoxical effects.</p><p>Preferred orientation (PO) and orientation selectivity index (OSI) of population responses in <xref ref-type="fig" rid="fig6">Figure 6</xref> was calculated by first computing the circular mean of the population activity in each time window as<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the preferred orientation (in radians) of neuron j. <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the average activity of the neuron, which is calculated from the number of spikes emitted within a specific time window (10 ms in <xref ref-type="fig" rid="fig6">Figures 6</xref>–<xref ref-type="fig" rid="fig8">8</xref>). Only windows with a minimum number of active neurons (5 neurons emitting at least one spike for <xref ref-type="fig" rid="fig6">Figures 6</xref>–<xref ref-type="fig" rid="fig8">8</xref>) are included in the analysis. Population PO (pop. PO) is calculated as the angle of the resultant, <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>arg</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the length of it, <inline-formula><mml:math id="inf125"><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula>, returns the population OSI (pop. OSI) (<xref ref-type="bibr" rid="bib45">Ringach et al., 2002</xref>).</p><p>To quantify the transitions of population activity between different states, we developed a spontaneous transition (ST) index. This was calculated from histograms of population POs with high population OSI (OSI&gt;0.5), <inline-formula><mml:math id="inf126"><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. The histogram was obtained in the range from 0 to <inline-formula><mml:math id="inf127"><mml:mi>π</mml:mi></mml:math></inline-formula>, with bin sizes <inline-formula><mml:math id="inf128"><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:mn>24</mml:mn></mml:math></inline-formula> (as shown in <xref ref-type="fig" rid="fig7">Figure 7A</xref>). The OSI of <inline-formula><mml:math id="inf129"><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> was, in turn, used to quantify the spread of specific states seen by the population activity:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:munder><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The higher the <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the more selective the distribution of highly selective population POs, meaning that population activity is concentrated around specific orientations. On the other hand, lower values of <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> imply that the distribution is less selective and hence wider specific states (preferred orientations) are visited by the population activity. We therefore used <inline-formula><mml:math id="inf132"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>H</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> as a measure of switch between a wide range of specific states. We further multiplied that measure with the average population OSI (&lt;pop. OSI&gt;) to quantify how selective the visited states were on average, and defined the ST index as:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>H</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi mathvariant="italic">p</mml:mi><mml:mi mathvariant="italic">o</mml:mi><mml:mi mathvariant="italic">p</mml:mi><mml:mo mathvariant="italic">.</mml:mo><mml:mtext mathvariant="italic"> </mml:mtext><mml:mi mathvariant="italic">O</mml:mi><mml:mi mathvariant="italic">S</mml:mi><mml:mi mathvariant="italic">I</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To evaluate how our results are affected by random transitions of the population activity and different levels of noise, we calculated a bootstrapped STI. For the bootstrap analysis, we shuffled the vector of activity of each neuron in time, and the ST index was recalculated for the shuffled population activity. This procedure was repeated for 100 times to obtain the mean and std of the shuffled estimate (plotted in red in <xref ref-type="fig" rid="fig7">Figure 7B</xref>). The bootstrapped measure of spontaneous transitions (bootstrapped STI; <xref ref-type="fig" rid="fig8">Figure 8</xref>) was calculated by subtracting the mean of the STI distribution obtained from the shuffled procedure, as the random baseline.</p></sec><sec id="s4-3"><title>Theoretical analysis</title><p>We start by analysing the dynamics of excitatory and inhibitory activity as described in <xref ref-type="disp-formula" rid="equ1">Equation 1.</xref></p><p>Solving for the stationary state solution of the responses we have:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The activity of inhibitory neurons can thus be expressed in terms of the inputs as:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="false">⇒</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="false">⇒</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf133"><mml:mi>I</mml:mi></mml:math></inline-formula> is the identity matrix. If we perturb the input to inhibitory neurons alone, the output change in the activity of inhibitory neurons can be calculated as:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mi/><mml:mo>=</mml:mo> <mml:mi/><mml:mo>[</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mi/><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi/><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub> <mml:mi/><mml:mo>-</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi/><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>Let us consider a simplified condition where excitatory and inhibitory populations have the same size, and the outgoing excitatory connections (to both E and I neurons; E→E and E→I) have a similar profile (which we refer to as W). Moreover, we assume that inhibitory outgoing connections have the same profile, up to an inhibition dominance factor of -g (that is, it can be expressed as -gW). <xref ref-type="disp-formula" rid="equ14">Equation 14</xref> can now be expressed in terms of W and g as:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mi>W</mml:mi><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mi>W</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi/><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula></p><p>Nonspecific/uniform patterns of perturbation to probe the presence of (nonspecific) inhibitory stabilized networks can now be described as a situation where the vector of inhibitory perturbation, <inline-formula><mml:math id="inf134"><mml:mi>δ</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, has more or less similar entries for all inhibitory neurons and, hence, perturbs the uniform mode of the network. Specific patterns of perturbation, in contrast, corresponds to the scenario where the pattern of perturbation is aligned with the specific eigenvector, <inline-formula><mml:math id="inf135"><mml:msup><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, of the network, corresponding to the eigenvalue, <inline-formula><mml:math id="inf136"><mml:mi>λ</mml:mi></mml:math></inline-formula>, of the weight matrix W:<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mi>W</mml:mi> <mml:mi/><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup> <mml:mi/><mml:mo>=</mml:mo><mml:mi mathvariant="normal">λ</mml:mi> <mml:mi/><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>*</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>For a one-dimensional ring network with specific connectivity according to a 1D feature of neuronal pairs (e.g. the difference of their preferred orientations), this specific mode entails a pattern of perturbation with stronger perturbation of neurons with similar preferred orientations. For networks of neurons with 2D receptive fields, where the weights of connections are modulated by RF similarity (assayed by RF correlations in our simulations), the specific mode can be described in a multi-feature space. To effectively perturb it in a 1D space, we can stimulate it by perturbing neurons in proportion to their RF correlation with a reference neuron.</p><p>Assuming such a specific mode exists in networks with feature-specific connectivity, <xref ref-type="disp-formula" rid="equ15 equ16">Equations 15,16</xref> can be combined to write:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>W</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>g</mml:mi><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>W</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="false">⇒</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>g</mml:mi><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>λ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="false">⇒</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf137"><mml:mi>λ</mml:mi></mml:math></inline-formula> specifies the strength of the specific mode, arising from feature-specific connectivity, in the network. In feature-specific ISNs, the feature-specific connectivity between excitatory neurons, in the absence of specific inhibition to balance it, is unstable. This translates to <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p><inline-formula><mml:math id="inf139"><mml:mi>g</mml:mi></mml:math></inline-formula> denotes the level of inhibition-dominance along the specific mode: <inline-formula><mml:math id="inf140"><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> indicates the perfect balance; <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> leads to unstable dynamics along the specific mode; and <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> ensures a surplus of inhibition to keep the specific excitation in check by a dominant specific inhibition.</p><p>Networks with specific ISN properties can therefore be described, mathematically, by <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>We can therefore express <inline-formula><mml:math id="inf145"><mml:mi>λ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf146"><mml:mi>g</mml:mi></mml:math></inline-formula> by<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>β</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>and rewrite the vector of changes in inhibitory activity in response to specific perturbations as:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf147"><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula> analytically describes the slope of the line fitted to response changes versus input perturbations in our numerical simulations (e.g. as in <xref ref-type="fig" rid="fig2">Figures 2</xref>, <xref ref-type="fig" rid="fig4">4</xref>, <xref ref-type="fig" rid="fig5">5</xref> and <xref ref-type="fig" rid="fig8">8</xref>). Since <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, this slope will be negative in specific ISNs. This means that perturbation of inhibitory neurons aligned with specific eigenvectors of the weight matrix changes the activity of inhibitory neurons in the <italic>opposite direction</italic>:<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>∝</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank NA Cayco-Gajic and DR Muir for comments on the manuscript. Code for reproducing main simulations and results are available from ModelDB (<ext-link ext-link-type="uri" xlink:href="http://modeldb.yale.edu/259620">http://modeldb.yale.edu/259620</ext-link>).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Methodology, Performing simulations, Writing the manuscript</p></fn><fn fn-type="con" id="con2"><p>Supervision, Funding acquisition, Conceptualization, Writing the manuscript</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-52757-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adesnik</surname> <given-names>H</given-names></name><name><surname>Bruns</surname> <given-names>W</given-names></name><name><surname>Taniguchi</surname> <given-names>H</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A neural circuit for spatial summation in visual cortex</article-title><source>Nature</source><volume>490</volume><fpage>226</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1038/nature11526</pub-id><pub-id pub-id-type="pmid">23060193</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adesnik</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Synaptic mechanisms of feature coding in the visual cortex of awake mice</article-title><source>Neuron</source><volume>95</volume><fpage>1147</fpage><lpage>1159</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.08.014</pub-id><pub-id pub-id-type="pmid">28858618</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmadian</surname> <given-names>Y</given-names></name><name><surname>Rubin</surname> <given-names>DB</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Analysis of the stabilized supralinear network</article-title><source>Neural Computation</source><volume>25</volume><fpage>1994</fpage><lpage>2037</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00472</pub-id><pub-id pub-id-type="pmid">23663149</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Atallah</surname> <given-names>BV</given-names></name><name><surname>Bruns</surname> <given-names>W</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Parvalbumin-expressing interneurons linearly transform cortical responses to visual stimuli</article-title><source>Neuron</source><volume>73</volume><fpage>159</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.12.013</pub-id><pub-id pub-id-type="pmid">22243754</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bock</surname> <given-names>DD</given-names></name><name><surname>Lee</surname> <given-names>WC</given-names></name><name><surname>Kerlin</surname> <given-names>AM</given-names></name><name><surname>Andermann</surname> <given-names>ML</given-names></name><name><surname>Hood</surname> <given-names>G</given-names></name><name><surname>Wetzel</surname> <given-names>AW</given-names></name><name><surname>Yurgenson</surname> <given-names>S</given-names></name><name><surname>Soucy</surname> <given-names>ER</given-names></name><name><surname>Kim</surname> <given-names>HS</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Network anatomy and in vivo physiology of visual cortical neurons</article-title><source>Nature</source><volume>471</volume><fpage>177</fpage><lpage>182</lpage><pub-id pub-id-type="doi">10.1038/nature09802</pub-id><pub-id pub-id-type="pmid">21390124</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name><name><surname>Bamberg</surname> <given-names>E</given-names></name><name><surname>Nagel</surname> <given-names>G</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Millisecond-timescale, genetically targeted optical control of neural activity</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>1263</fpage><lpage>1268</lpage><pub-id pub-id-type="doi">10.1038/nn1525</pub-id><pub-id pub-id-type="pmid">16116447</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyden</surname> <given-names>ES</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Optogenetics and the future of neuroscience</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>1200</fpage><lpage>1201</lpage><pub-id pub-id-type="doi">10.1038/nn.4094</pub-id><pub-id pub-id-type="pmid">26308980</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Braitenberg</surname> <given-names>V</given-names></name><name><surname>Schüz</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><chapter-title>Science</chapter-title><source>Cortex: Statistics and Geometry of Neuronal Connectivity</source><publisher-name>Springer</publisher-name><pub-id pub-id-type="doi">10.1007/978-3-662-03733-1</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Dynamics of sparsely connected networks of excitatory and inhibitory spiking neurons</article-title><source>Journal of Computational Neuroscience</source><volume>8</volume><fpage>183</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1023/a:1008925309027</pub-id><pub-id pub-id-type="pmid">10809012</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carrillo-Reid</surname> <given-names>L</given-names></name><name><surname>Han</surname> <given-names>S</given-names></name><name><surname>Yang</surname> <given-names>W</given-names></name><name><surname>Akrouh</surname> <given-names>A</given-names></name><name><surname>Yuste</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Controlling visually guided behavior by holographic recalling of cortical ensembles</article-title><source>Cell</source><volume>178</volume><fpage>447</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.045</pub-id><pub-id pub-id-type="pmid">31257030</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chernov</surname> <given-names>MM</given-names></name><name><surname>Friedman</surname> <given-names>RM</given-names></name><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Stoner</surname> <given-names>GR</given-names></name><name><surname>Roe</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Functionally specific optogenetic modulation in primate visual cortex</article-title><source>PNAS</source><volume>115</volume><fpage>10505</fpage><lpage>10510</lpage><pub-id pub-id-type="doi">10.1073/pnas.1802018115</pub-id><pub-id pub-id-type="pmid">30257948</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Büsing</surname> <given-names>L</given-names></name><name><surname>Vasilaki</surname> <given-names>E</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Connectivity reflects coding: a model of voltage-based STDP with homeostasis</article-title><source>Nature Neuroscience</source><volume>13</volume><fpage>344</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1038/nn.2479</pub-id><pub-id pub-id-type="pmid">20098420</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cossell</surname> <given-names>L</given-names></name><name><surname>Iacaruso</surname> <given-names>MF</given-names></name><name><surname>Muir</surname> <given-names>DR</given-names></name><name><surname>Houlton</surname> <given-names>R</given-names></name><name><surname>Sader</surname> <given-names>EN</given-names></name><name><surname>Ko</surname> <given-names>H</given-names></name><name><surname>Hofer</surname> <given-names>SB</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Functional organization of excitatory synaptic strength in primary visual cortex</article-title><source>Nature</source><volume>518</volume><fpage>399</fpage><lpage>403</lpage><pub-id pub-id-type="doi">10.1038/nature14182</pub-id><pub-id pub-id-type="pmid">25652823</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Destexhe</surname> <given-names>A</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The Wilson-Cowan model, 36 years later</article-title><source>Biological Cybernetics</source><volume>101</volume><fpage>1</fpage><lpage>2</lpage><pub-id pub-id-type="doi">10.1007/s00422-009-0328-3</pub-id><pub-id pub-id-type="pmid">19662434</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El-Boustani</surname> <given-names>S</given-names></name><name><surname>Wilson</surname> <given-names>NR</given-names></name><name><surname>Runyan</surname> <given-names>CA</given-names></name><name><surname>Sur</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>El-Boustani et al. reply</article-title><source>Nature</source><volume>508</volume><fpage>E3</fpage><lpage>E4</lpage><pub-id pub-id-type="doi">10.1038/nature13130</pub-id><pub-id pub-id-type="pmid">24695315</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El-Boustani</surname> <given-names>S</given-names></name><name><surname>Sur</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Response-dependent dynamics of cell-specific inhibition in cortical networks in vivo</article-title><source>Nature</source><volume>5</volume><elocation-id>5689</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms6689</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emiliani</surname> <given-names>V</given-names></name><name><surname>Cohen</surname> <given-names>AE</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>All-Optical interrogation of neural circuits</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>13917</fpage><lpage>13926</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2916-15.2015</pub-id><pub-id pub-id-type="pmid">26468193</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fenno</surname> <given-names>L</given-names></name><name><surname>Yizhar</surname> <given-names>O</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The development and application of optogenetics</article-title><source>Annual Review of Neuroscience</source><volume>34</volume><fpage>389</fpage><lpage>412</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-061010-113817</pub-id><pub-id pub-id-type="pmid">21692661</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gleeson</surname> <given-names>P</given-names></name><name><surname>Cantarelli</surname> <given-names>M</given-names></name><name><surname>Marin</surname> <given-names>B</given-names></name><name><surname>Quintana</surname> <given-names>A</given-names></name><name><surname>Earnshaw</surname> <given-names>M</given-names></name><name><surname>Sadeh</surname> <given-names>S</given-names></name><name><surname>Piasini</surname> <given-names>E</given-names></name><name><surname>Birgiolas</surname> <given-names>J</given-names></name><name><surname>Cannon</surname> <given-names>RC</given-names></name><name><surname>Cayco-Gajic</surname> <given-names>NA</given-names></name><name><surname>Crook</surname> <given-names>S</given-names></name><name><surname>Davison</surname> <given-names>AP</given-names></name><name><surname>Dura-Bernal</surname> <given-names>S</given-names></name><name><surname>Ecker</surname> <given-names>A</given-names></name><name><surname>Hines</surname> <given-names>ML</given-names></name><name><surname>Idili</surname> <given-names>G</given-names></name><name><surname>Lanore</surname> <given-names>F</given-names></name><name><surname>Larson</surname> <given-names>SD</given-names></name><name><surname>Lytton</surname> <given-names>WW</given-names></name><name><surname>Majumdar</surname> <given-names>A</given-names></name><name><surname>McDougal</surname> <given-names>RA</given-names></name><name><surname>Sivagnanam</surname> <given-names>S</given-names></name><name><surname>Solinas</surname> <given-names>S</given-names></name><name><surname>Stanislovas</surname> <given-names>R</given-names></name><name><surname>van Albada</surname> <given-names>SJ</given-names></name><name><surname>van Geit</surname> <given-names>W</given-names></name><name><surname>Silver</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Open source brain: a collaborative resource for visualizing, analyzing, simulating, and developing standardized models of neurons and circuits</article-title><source>Neuron</source><volume>103</volume><fpage>395</fpage><lpage>411</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.05.019</pub-id><pub-id pub-id-type="pmid">31201122</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldberg</surname> <given-names>JA</given-names></name><name><surname>Rokni</surname> <given-names>U</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Patterns of ongoing activity and the functional architecture of the primary visual cortex</article-title><source>Neuron</source><volume>42</volume><fpage>489</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(04)00197-7</pub-id><pub-id pub-id-type="pmid">15134644</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennequin</surname> <given-names>G</given-names></name><name><surname>Vogels</surname> <given-names>TP</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Optimal control of transient dynamics in balanced networks supports generation of complex movements</article-title><source>Neuron</source><volume>82</volume><fpage>1394</fpage><lpage>1406</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.04.045</pub-id><pub-id pub-id-type="pmid">24945778</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennequin</surname> <given-names>G</given-names></name><name><surname>Agnes</surname> <given-names>EJ</given-names></name><name><surname>Vogels</surname> <given-names>TP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inhibitory plasticity: balance, control, and codependence</article-title><source>Annual Review of Neuroscience</source><volume>40</volume><fpage>557</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-072116-031005</pub-id><pub-id pub-id-type="pmid">28598717</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennequin</surname> <given-names>G</given-names></name><name><surname>Ahmadian</surname> <given-names>Y</given-names></name><name><surname>Rubin</surname> <given-names>DB</given-names></name><name><surname>Lengyel</surname> <given-names>M</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The dynamical regime of sensory cortex: stable dynamics around a single Stimulus-Tuned attractor account for patterns of noise variability</article-title><source>Neuron</source><volume>98</volume><fpage>846</fpage><lpage>860</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.04.017</pub-id><pub-id pub-id-type="pmid">29772203</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hofer</surname> <given-names>SB</given-names></name><name><surname>Ko</surname> <given-names>H</given-names></name><name><surname>Pichler</surname> <given-names>B</given-names></name><name><surname>Vogelstein</surname> <given-names>J</given-names></name><name><surname>Ros</surname> <given-names>H</given-names></name><name><surname>Zeng</surname> <given-names>H</given-names></name><name><surname>Lein</surname> <given-names>E</given-names></name><name><surname>Lesica</surname> <given-names>NA</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Differential connectivity and response dynamics of excitatory and inhibitory neurons in visual cortex</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1045</fpage><lpage>1052</lpage><pub-id pub-id-type="doi">10.1038/nn.2876</pub-id><pub-id pub-id-type="pmid">21765421</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname> <given-names>HK</given-names></name><name><surname>Asinof</surname> <given-names>SK</given-names></name><name><surname>Isaacson</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Network-Level control of frequency tuning in auditory cortex</article-title><source>Neuron</source><volume>95</volume><fpage>412</fpage><lpage>423</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.06.019</pub-id><pub-id pub-id-type="pmid">28689982</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kenet</surname> <given-names>T</given-names></name><name><surname>Bibitchkov</surname> <given-names>D</given-names></name><name><surname>Tsodyks</surname> <given-names>M</given-names></name><name><surname>Grinvald</surname> <given-names>A</given-names></name><name><surname>Arieli</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Spontaneously emerging cortical representations of visual attributes</article-title><source>Nature</source><volume>425</volume><fpage>954</fpage><lpage>956</lpage><pub-id pub-id-type="doi">10.1038/nature02078</pub-id><pub-id pub-id-type="pmid">14586468</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ko</surname> <given-names>H</given-names></name><name><surname>Hofer</surname> <given-names>SB</given-names></name><name><surname>Pichler</surname> <given-names>B</given-names></name><name><surname>Buchanan</surname> <given-names>KA</given-names></name><name><surname>Sjöström</surname> <given-names>PJ</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Functional specificity of local synaptic connections in neocortical networks</article-title><source>Nature</source><volume>473</volume><fpage>87</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1038/nature09880</pub-id><pub-id pub-id-type="pmid">21478872</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ko</surname> <given-names>H</given-names></name><name><surname>Cossell</surname> <given-names>L</given-names></name><name><surname>Baragli</surname> <given-names>C</given-names></name><name><surname>Antolik</surname> <given-names>J</given-names></name><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Hofer</surname> <given-names>SB</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The emergence of functional microcircuits in visual cortex</article-title><source>Nature</source><volume>496</volume><fpage>96</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1038/nature12015</pub-id><pub-id pub-id-type="pmid">23552948</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>SH</given-names></name><name><surname>Kwan</surname> <given-names>AC</given-names></name><name><surname>Zhang</surname> <given-names>S</given-names></name><name><surname>Phoumthipphavong</surname> <given-names>V</given-names></name><name><surname>Flannery</surname> <given-names>JG</given-names></name><name><surname>Masmanidis</surname> <given-names>SC</given-names></name><name><surname>Taniguchi</surname> <given-names>H</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Zhang</surname> <given-names>F</given-names></name><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name><name><surname>Dan</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Activation of specific interneurons improves V1 feature selectivity and visual perception</article-title><source>Nature</source><volume>488</volume><fpage>379</fpage><lpage>383</lpage><pub-id pub-id-type="doi">10.1038/nature11312</pub-id><pub-id pub-id-type="pmid">22878719</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname> <given-names>WC</given-names></name><name><surname>Bonin</surname> <given-names>V</given-names></name><name><surname>Reed</surname> <given-names>M</given-names></name><name><surname>Graham</surname> <given-names>BJ</given-names></name><name><surname>Hood</surname> <given-names>G</given-names></name><name><surname>Glattfelder</surname> <given-names>K</given-names></name><name><surname>Reid</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Anatomy and function of an excitatory network in the visual cortex</article-title><source>Nature</source><volume>532</volume><fpage>370</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1038/nature17192</pub-id><pub-id pub-id-type="pmid">27018655</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>N</given-names></name><name><surname>Chen</surname> <given-names>S</given-names></name><name><surname>Guo</surname> <given-names>ZV</given-names></name><name><surname>Chen</surname> <given-names>H</given-names></name><name><surname>Huo</surname> <given-names>Y</given-names></name><name><surname>Inagaki</surname> <given-names>HK</given-names></name><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Davis</surname> <given-names>C</given-names></name><name><surname>Hansel</surname> <given-names>D</given-names></name><name><surname>Guo</surname> <given-names>C</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatiotemporal constraints on optogenetic inactivation in cortical circuits</article-title><source>eLife</source><volume>8</volume><elocation-id>e48622</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.48622</pub-id><pub-id pub-id-type="pmid">31736463</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lien</surname> <given-names>AD</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Tuned thalamic excitation is amplified by visual cortical circuits</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1315</fpage><lpage>1323</lpage><pub-id pub-id-type="doi">10.1038/nn.3488</pub-id><pub-id pub-id-type="pmid">23933748</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname> <given-names>A</given-names></name><name><surname>Rosenbaum</surname> <given-names>R</given-names></name><name><surname>Doiron</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Inhibitory stabilization and visual coding in cortical circuits with multiple interneuron subtypes</article-title><source>Journal of Neurophysiology</source><volume>115</volume><fpage>1399</fpage><lpage>1409</lpage><pub-id pub-id-type="doi">10.1152/jn.00732.2015</pub-id><pub-id pub-id-type="pmid">26740531</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname> <given-names>A</given-names></name><name><surname>Doiron</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Slow dynamics and high variability in balanced cortical networks with clustered connections</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1498</fpage><lpage>1505</lpage><pub-id pub-id-type="doi">10.1038/nn.3220</pub-id><pub-id pub-id-type="pmid">23001062</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Litwin-Kumar</surname> <given-names>A</given-names></name><name><surname>Doiron</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Formation and maintenance of neuronal assemblies through synaptic plasticity</article-title><source>Nature Communications</source><volume>5</volume><elocation-id>5319</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms6319</pub-id><pub-id pub-id-type="pmid">25395015</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>BH</given-names></name><name><surname>Li</surname> <given-names>YT</given-names></name><name><surname>Ma</surname> <given-names>WP</given-names></name><name><surname>Pan</surname> <given-names>CJ</given-names></name><name><surname>Zhang</surname> <given-names>LI</given-names></name><name><surname>Tao</surname> <given-names>HW</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Broad inhibition sharpens orientation selectivity by expanding input dynamic range in mouse simple cells</article-title><source>Neuron</source><volume>71</volume><fpage>542</fpage><lpage>554</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.06.017</pub-id><pub-id pub-id-type="pmid">21835349</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname> <given-names>WP</given-names></name><name><surname>Liu</surname> <given-names>BH</given-names></name><name><surname>Li</surname> <given-names>YT</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Zhang</surname> <given-names>LI</given-names></name><name><surname>Tao</surname> <given-names>HW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Visual representations by cortical somatostatin inhibitory neurons--selective but with weak and delayed responses</article-title><source>The Journal of Neuroscience</source><volume>30</volume><fpage>14371</fpage><lpage>14379</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3248-10.2010</pub-id><pub-id pub-id-type="pmid">20980594</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mahrach</surname> <given-names>A</given-names></name><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Li</surname> <given-names>N</given-names></name><name><surname>van Vreeswijk</surname> <given-names>C</given-names></name><name><surname>Hansel</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Mechanisms underlying the response of mouse cortical networks to optogenetic manipulation</article-title><source>eLife</source><volume>9</volume><elocation-id>e49967</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.49967</pub-id><pub-id pub-id-type="pmid">31951197</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marshel</surname> <given-names>JH</given-names></name><name><surname>Kim</surname> <given-names>YS</given-names></name><name><surname>Machado</surname> <given-names>TA</given-names></name><name><surname>Quirin</surname> <given-names>S</given-names></name><name><surname>Benson</surname> <given-names>B</given-names></name><name><surname>Kadmon</surname> <given-names>J</given-names></name><name><surname>Raja</surname> <given-names>C</given-names></name><name><surname>Chibukhchyan</surname> <given-names>A</given-names></name><name><surname>Ramakrishnan</surname> <given-names>C</given-names></name><name><surname>Inoue</surname> <given-names>M</given-names></name><name><surname>Shane</surname> <given-names>JC</given-names></name><name><surname>McKnight</surname> <given-names>DJ</given-names></name><name><surname>Yoshizawa</surname> <given-names>S</given-names></name><name><surname>Kato</surname> <given-names>HE</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cortical layer-specific critical dynamics triggering perception</article-title><source>Science</source><volume>365</volume><elocation-id>eaaw5202</elocation-id><pub-id pub-id-type="doi">10.1126/science.aaw5202</pub-id><pub-id pub-id-type="pmid">31320556</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname> <given-names>JE</given-names></name><name><surname>Ayzenshtat</surname> <given-names>I</given-names></name><name><surname>Carrillo-Reid</surname> <given-names>L</given-names></name><name><surname>Yuste</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Visual stimuli recruit intrinsically generated cortical ensembles</article-title><source>PNAS</source><volume>111</volume><fpage>E4053</fpage><lpage>E4061</lpage><pub-id pub-id-type="doi">10.1073/pnas.1406077111</pub-id><pub-id pub-id-type="pmid">25201983</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozeki</surname> <given-names>H</given-names></name><name><surname>Finn</surname> <given-names>IM</given-names></name><name><surname>Schaffer</surname> <given-names>ES</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name><name><surname>Ferster</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Inhibitory stabilization of the cortical network underlies visual surround suppression</article-title><source>Neuron</source><volume>62</volume><fpage>578</fpage><lpage>592</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.03.028</pub-id><pub-id pub-id-type="pmid">19477158</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peters</surname> <given-names>A</given-names></name><name><surname>Payne</surname> <given-names>BR</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Numerical relationships between geniculocortical afferents and pyramidal cell modules in cat primary visual cortex</article-title><source>Cerebral Cortex</source><volume>3</volume><fpage>69</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1093/cercor/3.1.69</pub-id><pub-id pub-id-type="pmid">8439740</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeffer</surname> <given-names>CK</given-names></name><name><surname>Xue</surname> <given-names>M</given-names></name><name><surname>He</surname> <given-names>M</given-names></name><name><surname>Huang</surname> <given-names>ZJ</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inhibition of inhibition in visual cortex: the logic of connections between molecularly distinct interneurons</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1068</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1038/nn.3446</pub-id><pub-id pub-id-type="pmid">23817549</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinhold</surname> <given-names>K</given-names></name><name><surname>Lien</surname> <given-names>AD</given-names></name><name><surname>Scanziani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Distinct recurrent versus afferent dynamics in cortical visual processing</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>1789</fpage><lpage>1797</lpage><pub-id pub-id-type="doi">10.1038/nn.4153</pub-id><pub-id pub-id-type="pmid">26502263</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ringach</surname> <given-names>DL</given-names></name><name><surname>Shapley</surname> <given-names>RM</given-names></name><name><surname>Hawken</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Orientation selectivity in macaque V1: diversity and laminar dependence</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>5639</fpage><lpage>5651</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.22-13-05639.2002</pub-id><pub-id pub-id-type="pmid">12097515</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ronzitti</surname> <given-names>E</given-names></name><name><surname>Ventalon</surname> <given-names>C</given-names></name><name><surname>Canepari</surname> <given-names>M</given-names></name><name><surname>Forget</surname> <given-names>BC</given-names></name><name><surname>Papagiakoumou</surname> <given-names>E</given-names></name><name><surname>Emiliani</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Recent advances in patterned photostimulation for optogenetics</article-title><source>Journal of Optics</source><volume>19</volume><elocation-id>113001</elocation-id><pub-id pub-id-type="doi">10.1088/2040-8986/aa8299</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rotter</surname> <given-names>S</given-names></name><name><surname>Diesmann</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Exact digital simulation of time-invariant linear systems with applications to neuronal modeling</article-title><source>Biological Cybernetics</source><volume>81</volume><fpage>381</fpage><lpage>402</lpage><pub-id pub-id-type="doi">10.1007/s004220050570</pub-id><pub-id pub-id-type="pmid">10592015</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname> <given-names>DB</given-names></name><name><surname>Van Hooser</surname> <given-names>SD</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The stabilized supralinear network: a unifying circuit motif underlying multi-input integration in sensory cortex</article-title><source>Neuron</source><volume>85</volume><fpage>402</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.12.026</pub-id><pub-id pub-id-type="pmid">25611511</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Runyan</surname> <given-names>CA</given-names></name><name><surname>Sur</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Response selectivity is correlated to dendritic structure in parvalbumin-expressing inhibitory neurons in visual cortex</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>11724</fpage><lpage>11733</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2196-12.2013</pub-id><pub-id pub-id-type="pmid">23843539</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Russell</surname> <given-names>LE</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The influence of visual cortex on perception is modulated by behavioural state</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/706010</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadeh</surname> <given-names>S</given-names></name><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Rotter</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015a</year><article-title>Emergence of functional specificity in balanced networks with synaptic plasticity</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004307</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004307</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadeh</surname> <given-names>S</given-names></name><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Rotter</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015b</year><article-title>Processing of feature selectivity in cortical networks with specific connectivity</article-title><source>PLOS ONE</source><volume>10</volume><elocation-id>e0127547</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0127547</pub-id><pub-id pub-id-type="pmid">26083363</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sadeh</surname> <given-names>S</given-names></name><name><surname>Silver</surname> <given-names>RA</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name><name><surname>Muir</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Assessing the role of inhibition in stabilizing neocortical networks requires Large-Scale perturbation of the inhibitory population</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>12050</fpage><lpage>12067</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0963-17.2017</pub-id><pub-id pub-id-type="pmid">29074575</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sanzeni</surname> <given-names>AH</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>‘Inhibition stabilization is a widespread property of cortical networks’</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/656710</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tran</surname> <given-names>MM</given-names></name><name><surname>Prince</surname> <given-names>LY</given-names></name><name><surname>Richards</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>‘Neocortical inhibitory interneuron subtypes display distinct responses to synchrony and rate of inputs’</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/671248</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname> <given-names>MV</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Sejnowski</surname> <given-names>TJ</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Paradoxical effects of external modulation of inhibitory interneurons</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>4382</fpage><lpage>4388</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-11-04382.1997</pub-id><pub-id pub-id-type="pmid">9151754</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vreeswijk</surname> <given-names>C</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title><source>Science</source><volume>274</volume><fpage>1724</fpage><lpage>1726</lpage><pub-id pub-id-type="doi">10.1126/science.274.5293.1724</pub-id><pub-id pub-id-type="pmid">8939866</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vreeswijk</surname> <given-names>C</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Chaotic balanced state in a model of cortical circuits</article-title><source>Neural Computation</source><volume>10</volume><fpage>1321</fpage><lpage>1371</lpage><pub-id pub-id-type="doi">10.1162/089976698300017214</pub-id><pub-id pub-id-type="pmid">9698348</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vogels</surname> <given-names>TP</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name><name><surname>Zenke</surname> <given-names>F</given-names></name><name><surname>Clopath</surname> <given-names>C</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Inhibitory plasticity balances excitation and inhibition in sensory pathways and memory networks</article-title><source>Science</source><volume>334</volume><fpage>1569</fpage><lpage>1573</lpage><pub-id pub-id-type="doi">10.1126/science.1211095</pub-id><pub-id pub-id-type="pmid">22075724</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>NR</given-names></name><name><surname>Runyan</surname> <given-names>CA</given-names></name><name><surname>Wang</surname> <given-names>FL</given-names></name><name><surname>Sur</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Division and subtraction by distinct cortical inhibitory networks in vivo</article-title><source>Nature</source><volume>488</volume><fpage>343</fpage><lpage>348</lpage><pub-id pub-id-type="doi">10.1038/nature11347</pub-id><pub-id pub-id-type="pmid">22878717</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yizhar</surname> <given-names>O</given-names></name><name><surname>Fenno</surname> <given-names>LE</given-names></name><name><surname>Davidson</surname> <given-names>TJ</given-names></name><name><surname>Mogri</surname> <given-names>M</given-names></name><name><surname>Deisseroth</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Optogenetics in neural systems</article-title><source>Neuron</source><volume>71</volume><fpage>9</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.06.004</pub-id><pub-id pub-id-type="pmid">21745635</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>Z</given-names></name><name><surname>Russell</surname> <given-names>LE</given-names></name><name><surname>Packer</surname> <given-names>AM</given-names></name><name><surname>Gauld</surname> <given-names>OM</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Closed-loop all-optical interrogation of neural circuits in vivo</article-title><source>Nature Methods</source><volume>15</volume><fpage>1037</fpage><lpage>1040</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0183-z</pub-id><pub-id pub-id-type="pmid">30420686</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Znamenskiy</surname> <given-names>P</given-names></name><name><surname>Kim</surname> <given-names>MH</given-names></name><name><surname>Muir</surname> <given-names>DR</given-names></name><name><surname>Iacaruso</surname> <given-names>MF</given-names></name><name><surname>Iacaruso</surname> <given-names>SB</given-names></name><name><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>‘Functional selectivity and specific connectivity of inhibitory neurons in primary visual cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/294835</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.52757.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Palmer</surname><given-names>Stephanie</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>New imaging and genetic techniques have created an opportunity to peer inside the brain's &quot;black box&quot;. At the same time, current theory work in neuroscience has suggested that the brain operates in a particular dynamical regime that supports flexible and reliable computation. This manuscript suggests new experimental protocols that connect these tools with these theories to probe the hidden processing dynamics at play in the vertebrate brain. It is a thorough and detailed modeling study that will have a broad impact on how new experiments are planned and interpreted.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Patterned perturbation of inhibition is necessary to detect feature-specific inhibitory stabilization&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Michael Frank as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This paper addresses how perturbation of neuronal activity can act as a probe to identify the dynamic properties of neuronal networks. The work focuses on &quot;inhibition-stabilized networks (ISNs)&quot; in which strong recurrent inhibition is required to stabilize strong recurrent excitation, and increased input to inhibitory neurons decrease both excitatory and inhibitory activities, called &quot;the paradoxical effect.&quot; This manuscript investigates the response of inhibitory stabilized networks (ISNs) to &quot;non-specific&quot; and &quot;patterned&quot; perturbations of inhibitory cells in ISNs with feature-specific and non-specific connectivity rules. It aims to make explicit, experimentally testable predictions about such ISNs. The authors methodically demonstrate how such networks behave depending on the specificity of both the connections and perturbations to the network. Namely, they predict that inhibitory neurons will decrease their activity in response to patterned stimulation of inhibitory neurons when that perturbation aligns with neuronal receptive fields. They also show that ISNs with specific kinds of connectivity transition rapidly between different selectivity states. In general, the work is important and would potentially be of broad interest to both experimental and theoretically-minded readers.</p><p>Essential revisions, primarily computational:</p><p>While the theoretical investigation of the properties of ISNs that can guide the design of perturbation experiments is exciting and timely, the authors made several simplifying assumptions of network architectures and dynamics. Thus, the validity of the main results must be checked in more general and more biologically relevant settings:</p><p>1) Tuning widths, population sizes, connectivity: Request for more simulations:</p><p>As outlined above, this paper is attempting to make very clear connections to feasible experiments, which is fantastic to see. But, in general, we feel that the experiments reported in the manuscript build on top of each other before sufficiently establishing the generality and validity of the basic findings, and as a result, the same set of questionable model-assumptions are used throughout the paper. Specifically, equal numbers of excitatory and inhibitory cells with similar tuning properties are used in all simulations, but (1) It is known that there are fewer inhibitory neurons than excitatory neurons in real neural networks, (2) There are numerous papers that suggest, instead, broad tuning of inhibitory neurons. We would like to be convinced that the main conclusions will be supported by experiments using networks with biologically realistic architectures. Before exploring things like spiking networks, the authors should present results on more realistic inhibitory motifs with fewer inhibitory cells and broader inhibitory tuning.</p><p>The authors considered EI connectivity where all synaptic connectivity has the same tuning width. This seems too stringent as balanced states and ISN dynamics can be achieved with different spatial profiles of E and I connections. In that case, the relationship between the specific activity eigenmodes and connectivity or response similarity is less clear. Also, as pointed out in Figure 6—figure supplement 1B, the dynamic properties of ISNs are changed when E and I connectivities have different tuning widths.</p><p>2) Expanding to non-linear dynamics:</p><p>The main conclusion was derived mostly in the linear dynamics – the authors considered only a threshold-nonlinearity in the rate models and similarly in spiking networks as the f-I curve in I&amp;F neurons is quite linear. Nonlinearities create interactions amongst the eigenmodes and may mitigate the &quot;specific paradoxical effects.&quot; Also, in recently proposed networks with a supralinear transfer function, the dynamic range is divided into non-ISN and ISN regions by a &quot;breakpoint&quot; (Rubin et al., 2015). More simulations are needed to address how nonlinear dynamics might affect the conclusions of this work.</p><p>3) Exploration of stimuli that are the best perturbative probes of dynamics</p><p>The authors explore whether it is possible to design patterned perturbations based on stimulus response (a great thing to do!) and they report that some stimuli are not ideal for such experiments. Why not explore this further? If the goal is to make explicit experimental predictions, the authors should do a more detailed analysis of which stimuli would uncover the pattern of optical perturbation needed, and make that very clear to the reader.</p><p>Essential revisions, primarily textual:</p><p>1) Clarity of goals:</p><p>What are the actual goals of this paper? The way it is written, the central goal is to determine how optogenetic experiments could &quot;reveal&quot; specific ISNs (which is a slightly unclear goal in and of itself). But, then, what is the purpose of the final findings on transitions in selectivity states? On discussion does it become clear that the point of this paper is to more broadly determine what experiments could be done to test for the presence of ISNs with connection specificity in the brain. Both the perturbation results and the state transition results are effectively providing an experimental signature of such networks. But, this is not very clear as it stands. Moreover, once one realizes that the goal is to guide experiments (which is a great goal!), a host of other issues become apparent, as discussed in the following points.</p><p>2) Clarity for experimentalists:</p><p>Overall, we suspect that the paper would not be very easy to follow for an experimental neuroscientist. There is a great deal of jargon used throughout the paper, starting with the use of the term ISN in the fourth paragraph of the Introduction, without defining it for the reader. Other examples are references to eigenmode, selectivity state transitions, etc. This is all fine for computational readers, but given the goals of this paper, it would need a significant re-write to be interpretable for experimentalists. More broadly, the manuscript's clarity could be greatly enhanced, even for computational readers. For example, the authors write, &quot;While uniform or non-specific perturbation was enough to reveal uniform ISNs, patterned perturbation as described above is necessary to reveal specific ISNs.&quot; What is meant by &quot;reveal uniform/specific ISNs&quot;? Do you mean &quot;distinguish a specific ISN from a non-specific ISN&quot;? Or something else? Throughout the paper, the language is confusing at times.</p><p>3) Additional Discussion sections:</p><p>Please discuss past ideas about 'detailed balance', i.e. Hennequin Vogels Gerstner 2012, Hennequin et al., 2014, Hennequin et al., 2017, and the inhibitory plasticity mechanism in Vogels et al., 2011.</p><p>Also, recent theoretical work suggested cortical circuits exhibit paradoxical effects because of disinhibitory loops rather than inhibition-stabilization mechanisms (Mahrach et al., BioRxiv 2019). This questions whether perturbations can reveal the dynamic properties in these complex, yet more biologically plausible networks. Please discuss the perturbation methods that can differentiate two prominent types of paradoxical effect mechanisms: disinhibitory loops vs. ISNs, and under which conditions similar conclusions as detailed in this paper can be derived.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.52757.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions, primarily computational:</p><p>While the theoretical investigation of the properties of ISNs that can guide the design of perturbation experiments is exciting and timely, the authors made several simplifying assumptions of network architectures and dynamics. Thus, the validity of the main results must be checked in more general and more biologically relevant settings:</p><p>1) Tuning widths, population sizes, connectivity: Request for more simulations:</p><p>As outlined above, this paper is attempting to make very clear connections to feasible experiments, which is fantastic to see. But, in general, we feel that the experiments reported in the manuscript build on top of each other before sufficiently establishing the generality and validity of the basic findings, and as a result, the same set of questionable model-assumptions are used throughout the paper. Specifically, equal numbers of excitatory and inhibitory cells with similar tuning properties are used in all simulations, but (1) It is known that there are fewer inhibitory neurons than excitatory neurons in real neural networks, (2) There are numerous papers that suggest, instead, broad tuning of inhibitory neurons. We would like to be convinced that the main conclusions will be supported by experiments using networks with biologically realistic architectures. Before exploring things like spiking networks, the authors should present results on more realistic inhibitory motifs with fewer inhibitory cells and broader inhibitory tuning.</p></disp-quote><p>The reviewers are absolutely right that we need to show the specific paradoxical effect under more biologically realistic conditions, in terms of (1) the fraction of inhibitory/excitatory neurons and (2) broader tuning of inhibition.</p><p>To address the first issue, we simulated the model in Figure 2 with 20% inhibitory and 80% excitatory neurons, matching the fraction reported in the neocortex (Braitenberg and Schüz, 1998). To account for the decrease in the overall level of inhibition resulting from this decrease in the number, we increased the average weight of inhibition by a similar factor (4 times stronger), consistent with stronger weights reported for inhibition in the cortex (Hofer et al., 2011). Similar results were obtained for these networks, as shown in new Figure 2—figure supplement 4A.</p><p>We addressed the second issue by modifying the connectivity matrix between excitatory and inhibitory subpopulations. (Note that the broader tuning of inhibitory neurons does not matter in terms of the input, as we do not stimulate the network in response to external stimuli; the only inputs to inhibitory neurons are the patterned perturbations.) We allowed for a broader connectivity of I→E, I→I and E→I connections compared to E→E weights (by reducing m in the respective connections). We also decreased the weights such that the network still has spectral stability despite the decrease in specific inhibition. For stable networks with broader inhibitory connectivity, we obtained the same results, as shown in Figure 2—figure supplement 4B.</p><p>We combined the two conditions in another model, where the network had both fewer inhibitory neurons and broader inhibitory connectivity, and obtained similar results (Figure 2—figure supplement 4C).</p><p>We also tested whether our results hold in spiking networks with fewer inhibitory neurons and found that this is indeed the case (Figure 5—figure supplement 1). These results show that networks with fewer inhibitory neurons behave similarly in terms of their response to patterned perturbation of inhibition, as long as the weight of inhibition is strong enough to compensate for the smaller number of inhibitory neurons. Moreover, broad inhibitory connectivity is consistent with feature-specific ISNs, as long as the broadness does not compromise the stability of the network (i.e., the specific eigenmode of the spectrum does not become unstable due to lack of enough inhibition in that direction). We therefore concluded that our results also hold in networks with more biologically realistic properties of inhibitory neurons and their connectivity.</p><p>We added these results, figures and discussions to the revised manuscript.</p><disp-quote content-type="editor-comment"><p>The authors considered EI connectivity where all synaptic connectivity has the same tuning width. This seems too stringent as balanced states and ISN dynamics can be achieved with different spatial profiles of E and I connections. In that case, the relationship between the specific activity eigenmodes and connectivity or response similarity is less clear. Also, as pointed out in Figure 6—figure supplement 1B, the dynamic properties of ISNs are changed when E and I connectivities have different tuning widths.</p></disp-quote><p>To address this, we simulated networks with heterogeneous specificity of excitatory and inhibitory connections (Figure 2—figure supplement 5). We found that, although such a heterogeneous connectivity adds more noise to the observed pattern of response changes as a function of neuronal features, the specific paradoxical effect can still be statistically inferred from patterned perturbations (Figure 2—figure supplement 5C). Therefore, different profiles of E and I connections in terms of their functional specificity do not compromise the detection of specific ISNs.</p><disp-quote content-type="editor-comment"><p>2) Expanding to non-linear dynamics:</p><p>The main conclusion was derived mostly in the linear dynamics – the authors considered only a threshold-nonlinearity in the rate models and similarly in spiking networks as the f-I curve in I&amp;F neurons is quite linear. Nonlinearities create interactions amongst the eigenmodes and may mitigate the &quot;specific paradoxical effects.&quot; Also, in recently proposed networks with a supralinear transfer function, the dynamic range is divided into non-ISN and ISN regions by a &quot;breakpoint&quot; (Rubin et al., 2015). More simulations are needed to address how nonlinear dynamics might affect the conclusions of this work.</p></disp-quote><p>We investigated the effect of response nonlinearity on our results by simulating rate-based networks with the following dynamics (same as in Ahmadian et al., 2013; Equation 2.3):</p><p>τdr/dt=-r+([Wr+s]_+)^n</p><p>where n determines the exponent of expansive nonlinearity (reported between 2 to 5 in experiments). Note that our previous results (obtained for threshold linear transfer functions) correspond to a special case with n = 1.</p><p>We assayed feature-specific paradoxical effects in networks with different values of n (1 to 4) and observed similar trends with all nonlinearities (Figure 2—figure supplement 6A). The expansive nonlinearity in fact seems to amplify the “specific paradoxical effect”, as inhibitory neurons with more negative perturbations show more positive response changes in networks with higher exponents. This is consistent with higher activation of excitation in networks with a higher exponent, and seems to reflect the fact that sharper nonlinearity amplifies the specific mode more in such networks (Figure 2—figure supplement 6B), which makes them more susceptible to nonlinearity (in fact, a network with n=5 showed signatures of such instability in terms of pathological oscillations; now shown). Thus, the main effect of nonlinear transfer functions seems to be exacerbating the specific eigenmode, and hence the specific paradoxical effect, as long as it does not compromise the stability. We also tested our results with smaller size of perturbations (up to 10 fold smaller) and found that feature-specific paradoxical effects could be observed in all nonlinear networks (not shown).</p><disp-quote content-type="editor-comment"><p>3) Exploration of stimuli that are the best perturbative probes of dynamics</p><p>The authors explore whether it is possible to design patterned perturbations based on stimulus response (a great thing to do!) and they report that some stimuli are not ideal for such experiments. Why not explore this further? If the goal is to make explicit experimental predictions, the authors should do a more detailed analysis of which stimuli would uncover the pattern of optical perturbation needed, and make that very clear to the reader.</p></disp-quote><p>To address this highly relevant issue, we used naturalistic stimuli to probe the response correlations of neurons. We presented 200 natural images to the network and calculated the response correlation of neurons based on their responses to the ensemble of stimuli. We then repeated the patterned perturbations based on such response correlations of inhibitory neurons (with regard to different reference cells), and found that such naturalistic stimuli are indeed good candidates to reveal the feature-specific paradoxical effects (Figure 4—figure supplement 2). We added these results to the updated manuscript and discussed its consequences for experiments.</p><disp-quote content-type="editor-comment"><p>Essential revisions, primarily textual:</p><p>1) Clarity of goals:</p><p>What are the actual goals of this paper? The way it is written, the central goal is to determine how optogenetic experiments could &quot;reveal&quot; specific ISNs (which is a slightly unclear goal in and of itself). But, then, what is the purpose of the final findings on transitions in selectivity states? On discussion does it become clear that the point of this paper is to more broadly determine what experiments could be done to test for the presence of ISNs with connection specificity in the brain. Both the perturbation results and the state transition results are effectively providing an experimental signature of such networks. But, this is not very clear as it stands. Moreover, once one realizes that the goal is to guide experiments (which is a great goal!), a host of other issues become apparent, as discussed in the following points.</p></disp-quote><p>We rewrote the Introduction to clarify these points and relate our results better to experiments, also tried to make the language more transparent and accessible (see comments below).</p><disp-quote content-type="editor-comment"><p>2) Clarity for experimentalists:</p><p>Overall, we suspect that the paper would not be very easy to follow for an experimental neuroscientist. There is a great deal of jargon used throughout the paper, starting with the use of the term ISN in the fourth paragraph of the Introduction, without defining it for the reader. Other examples are references to eigenmode, selectivity state transitions, etc. This is all fine for computational readers, but given the goals of this paper, it would need a significant re-write to be interpretable for experimentalists. More broadly, the manuscript's clarity could be greatly enhanced, even for computational readers. For example the authors write, &quot;While uniform or non-specific perturbation was enough to reveal uniform ISNs, patterned perturbation as described above is necessary to reveal specific ISNs.&quot; What is meant by &quot;reveal uniform/specific ISNs&quot;? Do you mean &quot;distinguish a specific ISN from a non-specific ISN&quot;? Or something else? Throughout the paper, the language is confusing at times.</p></disp-quote><p>We hope that we have now addressed the issues raised above in the revised manuscript: we specifically corrected the points mentioned above, and, more generally, revised the manuscript to avoid jargon as much as possible, and to explain it when needed. We tried to relate our findings better and more clearly to the experiments. Moreover, we made the technical and computational language more precise and less confusing whenever needed.</p><disp-quote content-type="editor-comment"><p>3) Additional Discussion sections:</p><p>Please discuss past ideas about 'detailed balance', i.e. Hennequin Vogels Gerstner 2012, Hennequin et al., 2014, Hennequin et al., 2017, and the inhibitory plasticity mechanism in Vogels et al., 2011.</p></disp-quote><p>That’s a great suggestion. We discussed that in the Discussion section.</p><disp-quote content-type="editor-comment"><p>Also, recent theoretical work suggested cortical circuits exhibit paradoxical effects because of disinhibitory loops rather than inhibition-stabilization mechanisms (Mahrach et al., BioRxiv 2019). This questions whether perturbations can reveal the dynamic properties in these complex, yet more biologically plausible networks. Please discuss the perturbation methods that can differentiate two prominent types of paradoxical effect mechanisms: disinhibitory loops vs. ISNs, and under which conditions similar conclusions as detailed in this paper can be derived.</p></disp-quote><p>We also added this to the Discussion section.</p></body></sub-article></article>