<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">21792</article-id><article-id pub-id-type="doi">10.7554/eLife.21792</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Multivariate cross-frequency coupling via generalized eigendecomposition</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-35454"><name><surname>Cohen</surname><given-names>Michael X</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1879-3593</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Donders Center for Neuroscience, Radboud University Nijmegen Medical Centre, Radboud University</institution>, <addr-line><named-content content-type="city">Nijmegen</named-content></addr-line>, <country>Netherlands</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Davachi</surname><given-names>Lila</given-names></name><role>Reviewing editor</role><aff id="aff2"><institution>New York University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>mikexcohen@gmail.com</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>24</day><month>01</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e21792</elocation-id><history><date date-type="received"><day>23</day><month>09</month><year>2016</year></date><date date-type="accepted"><day>08</day><month>01</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Cohen et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Cohen et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-21792-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.21792.001</object-id><p>This paper presents a new framework for analyzing cross-frequency coupling in multichannel electrophysiological recordings. The generalized eigendecomposition-based cross-frequency coupling framework (gedCFC) is inspired by source-separation algorithms combined with dynamics of mesoscopic neurophysiological processes. It is unaffected by factors that confound traditional CFC methods—such as non-stationarities, non-sinusoidality, and non-uniform phase angle distributions—attractive properties considering that brain activity is neither stationary nor perfectly sinusoidal. The gedCFC framework opens new opportunities for conceptualizing CFC as network interactions with diverse spatial/topographical distributions. Five specific methods within the gedCFC framework are detailed, these are validated in simulated data and applied in several empirical datasets. gedCFC accurately recovers physiologically plausible CFC patterns embedded in noise that causes traditional CFC methods to perform poorly. The paper also demonstrates that spike-field coherence in multichannel local field potential data can be analyzed using the gedCFC framework, which provides significant advantages over traditional spike-field coherence analyses. Null-hypothesis testing is also discussed.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.001">http://dx.doi.org/10.7554/eLife.21792.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>cross-frequency coupling</kwd><kwd>neural oscillations</kwd><kwd>dimensionality reduction</kwd><kwd>spike-field coherence</kwd><kwd>source separation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Human</kwd><kwd>Mouse</kwd><kwd>Rat</kwd><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>ERC-StG 638589</award-id><principal-award-recipient><name><surname>Cohen</surname><given-names>Michael X</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel methodological framework for cross-frequency coupling and spike-field coherence in multichannel (LFP, EEG, MEG) electrophysiology data reveals new manifestations of coupling dynamics.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Cross-frequency coupling (CFC) refers to the phenomenon in which dynamics across two or more frequency bands are related. CFC has been reported in many cortical and subcortical brain regions in multiple species, and has inspired computational models and theories (<xref ref-type="bibr" rid="bib6">Canolty and Knight, 2010</xref>; <xref ref-type="bibr" rid="bib20">Fell and Axmacher, 2011</xref>; <xref ref-type="bibr" rid="bib39">Lisman and Jensen, 2013</xref>). A core idea that permeates CFC theories is that the phase of a slower brain rhythm coordinates a temporal sequence of faster processes that represent specific items in memory or in sensory space. There are several manifestations of CFC (<xref ref-type="bibr" rid="bib6">Canolty and Knight, 2010</xref>; <xref ref-type="bibr" rid="bib31">Hyafil et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Jensen et al., 2007</xref>; <xref ref-type="bibr" rid="bib34">Jirsa and Müller, 2013</xref>), and the most widely used CFC analysis methods involve the application of Euler’s formula, phase synchronization, or distribution analyses, with the goal of determining whether high-frequency power values are non-uniformly distributed over low-frequency phase (<xref ref-type="bibr" rid="bib61">Tort et al., 2010</xref>).</p><p>Nevertheless, the standard corpus of CFC measures is increasingly criticized, with valid concerns about spurious or biased CFC estimates resulting from non-stationarities, sharp transients, non-uniform phase distributions, and other issues (<xref ref-type="bibr" rid="bib1">Aru et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Kramer et al., 2008</xref>; <xref ref-type="bibr" rid="bib40">Lozano-Soldevilla et al., 2016</xref>; <xref ref-type="bibr" rid="bib64">van Driel et al., 2015</xref>). These potential biases are not fatal flaws, and in some cases can be alleviated by using alternative methods, shuffling-based permutation testing, or debiasing terms (<xref ref-type="bibr" rid="bib10">Cohen, 2014</xref>; <xref ref-type="bibr" rid="bib51">Pittman-Polletta et al., 2014</xref>; <xref ref-type="bibr" rid="bib64">van Driel et al., 2015</xref>; <xref ref-type="bibr" rid="bib68">Voytek et al., 2013</xref>). However, these concerns limit the ubiquitous applicability of standard CFC measures.</p><p>The source of these potential biases comes from violating the assumption that brain oscillations are sinusoidal with a stable frequency. This assumption stems from the use of sinusoidal narrowband filters, such as Morlet wavelets or narrow FIR filters. On the other hand, it is increasingly becoming clear that neural oscillations are not always sinusoidal (<xref ref-type="bibr" rid="bib35">Jones, 2016</xref>; <xref ref-type="bibr" rid="bib43">Mazaheri and Jensen, 2008</xref>). The non-sinusoidal waveform shape of neural oscillations may provide important insights into underlying biophysical processes, and yet, for CFC analyses, the non-sinusoidal waveform shapes are potential confounds that must be avoided or corrected. Therefore, analysis methods that do not assume sinusoidality are important 1) for methodological reasons to examine CFC in a wider range of datasets and 2) for theoretical reasons to facilitate discovery of CFC regardless of waveform shape (or explicitly incorporating waveform shape), which is an important step towards uncovering the neurobiological origins and functional significances of neural oscillations.</p><p>Multichannel recordings provide new opportunities for the discovery of physiologically interpretable patterns of CFC. For example, theories of CFC suggest that the low-frequency rhythm regulates the timing of different networks (<xref ref-type="bibr" rid="bib39">Lisman and Jensen, 2013</xref>), implying that the neural circuits that produce the low- and high-frequency rhythms should have different electrical projections onto multielectrode recordings. Furthermore, because volume conduction carries activity from a single neuroelectric source to multiple electrodes, incorporating weighted averages from multiple electrodes can boost signal-to-noise ratio and help in isolating patterns of activity (<xref ref-type="bibr" rid="bib50">Parra et al., 2005</xref>), including in CFC analyses (<xref ref-type="bibr" rid="bib5">Canolty et al., 2012</xref>; <xref ref-type="bibr" rid="bib55">Soto et al., 2016</xref>). This is particularly relevant for noninvasive recordings, in which high-frequency activity can have low power and can be contaminated by muscle artifacts. Finally, multichannel recordings allow the application of advanced matrix analysis methods, including dimensionality-reduction and source separation algorithms, which can identify spatiotemporal patterns of activity that might be difficult to uncover when considering activity from a single electrode at a time (<xref ref-type="bibr" rid="bib25">Grootswagers et al., 2016</xref>; <xref ref-type="bibr" rid="bib47">Orekhova et al., 2011</xref>).</p><p>The purpose of this paper is to present a new hypothesis-driven framework for conceptualizing and quantifying CFC in multichannel datasets. This framework is based on using generalized eigendecomposition (GED) of multichannel covariance matrices, and is therefore termed generalized eigendecomposition-based cross-frequency coupling (gedCFC). The backbone of gedCFC for source separation and dimensionality reduction is grounded in decades of mathematics and problem-solving in engineering, with applications in neuroscience (<xref ref-type="bibr" rid="bib50">Parra et al., 2005</xref>; <xref ref-type="bibr" rid="bib57">Särelä and Valpola, 2005</xref>). This paper will show that gedCFC has several advantages over the commonly used CFC methods, including increasing signal-to-noise characteristics and avoiding confounds of non-sinusoidal oscillations. Perhaps the most important advantages, however, are its potential for use in hypothesis-driven network discovery and its increased flexibility and robustness for uncovering CFC patterns in nonstationary multichannel data.</p><p>Five specific methods are derived from this framework (a brief overview is provided in <xref ref-type="table" rid="tbl1">Table 1</xref> for reference), with each method designed for different assumptions about underlying neural processes and different analysis goals. Each method is validated in simulated data, and proof-of-principle applications are shown in empirical data recorded in humans (EEG, MEG, ECoG) and in rodents (LFP and spike-LFP). Furthermore, it is also demonstrated that spike-field coherence in multichannel datasets can be conceptualized as a special case of CFC, permitting the application of gedCFC in this context. Advantages, assumptions, and limitations underlying the different methods are discussed, along with suggestions for practical aspects of data analysis and inferential statistics.<table-wrap id="tbl1" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.002</object-id><label>Table 1.</label><caption><p>Overview of methods.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.002">http://dx.doi.org/10.7554/eLife.21792.002</ext-link></p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top"/><th valign="top"><p>Description</p></th><th valign="top"><p>Analysis goal</p></th><th valign="top"><p>Key assumption</p></th></tr></thead><tbody><tr><td><p>Method 1</p></td><td><p><bold>S</bold> defined by peri-LF-peak; <bold>R</bold> defined by all data</p></td><td><p>Identify a single phase-amplitude coupled network</p></td><td><p>One HF network with power proportional to LF phase</p></td></tr><tr><td><p>Method 2</p></td><td><p><bold>S</bold> defined by peri-LF-peak; <bold>R</bold> defined by peri-LF-trough</p></td><td><p>Identify two networks that alternate according to LF phase.</p></td><td><p>Two different HF networks that have power peaks at different LF phases</p></td></tr><tr><td><p>Method 3</p></td><td><p>LF activity bias-filters sphered data</p></td><td><p>Use (possibly nonstationary) LF waveform shape to identify a HF component.</p></td><td><p>Well-defined LF waveform</p></td></tr><tr><td><p>Method 4</p></td><td><p>Delay-embedded matrix, <bold>S</bold> and <bold>R</bold> defined as in Methods 1 or 2</p></td><td><p>Empirically determine a CFC-related spatiotemporal filter</p></td><td><p>Appropriate delay-embedded order</p></td></tr><tr><td><p>Method 5</p></td><td><p>Similar to Method 4 but data are taken peri-action potential</p></td><td><p>Empirically determine a spatiotemporal LFP filter surrounding action potentials</p></td><td><p>Sufficient delay-embedding order; one peri-spike network</p></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><italic>Notes</italic>. LF = low frequency; HF = high frequency. All methods make the assumption that the spatiotemporal characteristics of the HF activity are stable over repeated time windows from which covariance matrices are computed.</p></fn></table-wrap-foot></table-wrap></p><sec id="s1-1"><title>Generalized eigendecomposition</title><p>This paper describes the gedCFC framework in a manner that is approachable to scientists with diverse backgrounds; deeper mathematical discussions that justify using GED to optimize linear spatiotemporal filters according to user-specified objectives are presented in many other publications (<xref ref-type="bibr" rid="bib3">Blankertz et al., 2008</xref>; <xref ref-type="bibr" rid="bib15">de Cheveigné and Parra, 2014</xref>; <xref ref-type="bibr" rid="bib45">Nikulin et al., 2011</xref>; <xref ref-type="bibr" rid="bib50">Parra et al., 2005</xref>; <xref ref-type="bibr" rid="bib60">Tomé, 2006</xref>).</p><p>The goal of gedCFC is to create a component, formed from a weighted sum of all electrodes, that optimizes the ratio between user-specified minimization and maximization criteria. For example, a component might maximize the difference between high-frequency activity that appears during peaks of a low-frequency oscillation, versus high-frequency activity that is unrelated to the low-frequency oscillation. This component is created through a matrix decomposition procedure called eigendecomposition.</p><p>Eigendecomposition (also called eigenvalue or eigenvector decomposition) involves finding certain vectors that are associated with square matrices. The basic eigenvalue equation is <bold>Sw</bold> = <bold>w</bold>λ, where <bold>S</bold> is a square matrix, <bold>w</bold> is a vector, and λ is a single number called an eigenvalue. This equation means that multiplying the eigenvector <bold>w</bold> by matrix <bold>S</bold> has the same effect as multiplying <bold>w</bold> by a single number λ. In other words, matrix <bold>S</bold> does not change the direction of <bold>w</bold>, <bold>S</bold> merely stretches or shrinks it. If <bold>S</bold> is a channel-by-channel covariance matrix formed by multiplying the M-by-N (channels by time points) data matrix by its transpose, then the eigenvector <bold>w</bold> points in the direction of maximal covariance. The full set of eigenvectors produces matrix <bold>W</bold> (with corresponding eigenvalues in the diagonal matrix <bold>Λ</bold>) that spans the space of <bold>S</bold> using basis vectors that each account for maximal variance in <bold>S</bold> while selected to be pairwise orthogonal. This is known as a principal components analysis.</p><p>The eigenvalue equation is generalized to two square matrices <bold>R</bold> and <bold>S</bold>, as <bold>SW</bold> = <bold>RWΛ</bold>. This equation can be more intuitively understood by moving <bold>R</bold> to the left side via multiplication of its inverse: (<bold>R<sup>−1</sup>S</bold>)<bold>W</bold> = <bold>WΛ. R<sup>−1</sup>S</bold> is the matrix analog of <bold>S</bold> divided by <bold>R</bold> (think of ⅔ as being equivalent to 3<sup>−1</sup>× 2). If <bold>S</bold> is a covariance matrix of a ‘signal’ dataset and <bold>R</bold> is a covariance matrix of a ‘reference’ dataset, then GED can be understood to produce eigenvectors that identify directions of maximal power ratio (highest gain) in the matrix product <bold>R<sup>−1</sup>S</bold>, in other words, directions that best differentiate matrices <bold>S</bold> from <bold>R</bold>. The columns of <bold>W</bold> are called spatial filters (spatiotemporal filters for delay-embedded matrices) or unmixing coefficients, and the column with the largest associated eigenvalue is the one that maximally differentiates the two matrices. The filters can be applied to the data to compute components, and they can be visualized by inspecting the columns of <bold>W<sup>−T</sup></bold>, which is also called the forward model of the filter or the activation pattern (<xref ref-type="bibr" rid="bib27">Haufe et al., 2014</xref>).</p><p>gedCFC identifies multichannel CFC-related networks by contrasting covariance matrices computed from to-be-maximized data features (matrix <bold>S</bold>) against to-be-minimized data features (matrix <bold>R</bold>). The two covariance matrices should be similar enough to suppress CFC-unrelated activity, while being different enough to isolate the neural networks that exhibit CFC. For example, one could identify a theta-band (~6 Hz) rhythm and then compute matrix <bold>S</bold> from peri-peak data and matrix <bold>R</bold> from peri-trough data; the GED of <bold>S</bold> and <bold>R</bold> would reveal a component that maximally differentiates peak-related from trough-related activity, which is a manifestation of network-level phase-amplitude coupling.</p><p>The spatial filter comprises values for each electrode that are used to compute a weighted sum of activity from all electrodes. The resulting time series is the gedCFC component. Note that although defining the spatial filter involves two covariance matrices that might be computed from discrete time windows, the gedCFC component is a &quot;continuous&quot; signal to which time-domain, frequency-domain, or time-frequency domain analyses can be applied.</p><p>In addition to being able to specify both maximization and minimization criteria, another important distinction between GED of two covariance matrices and eigendecomposition of one matrix is that eigenvectors are selected to form an orthogonal set only when the matrix <bold>S</bold> is symmetric. Although both <bold>S</bold> and <bold>R</bold> are symmetric covariance matrices, <bold>R<sup>−1</sup>S</bold> is generally not symmetric. In other words, the eigenvectors are independent but not orthogonal. This is an important advantage over principal components analysis, which often performs poorly when used as a source separation method (<xref ref-type="bibr" rid="bib18">Delorme et al., 2012</xref>) (see also <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p></sec><sec id="s1-2"><title>Using GED to identify the low-frequency rhythm</title><p>The GED framework is not limited to CFC; it is also recommended that GED is used to define a spatial filter that maximizes power at the lower frequency (<xref ref-type="bibr" rid="bib3">Blankertz et al., 2008</xref>; <xref ref-type="bibr" rid="bib45">Nikulin et al., 2011</xref>; <xref ref-type="bibr" rid="bib49">Parra and Sajda, 2003</xref>; <xref ref-type="bibr" rid="bib57">Särelä and Valpola, 2005</xref>). There are several ways to define the <bold>S</bold> and <bold>R</bold> covariance matrices (see <xref ref-type="bibr" rid="bib11">Cohen, 2016</xref>, for comparisons); the approach taken here is to compute <bold>S</bold> from narrow-band filtered data and <bold>R</bold> from the broadband data (<xref ref-type="bibr" rid="bib14">de Cheveigné and Arzounian, 2015</xref>). The eigenvector with the largest eigenvalue is taken as a spatial filter optimized for activity in that frequency band. The advantages of GED for source separation of narrowband activity include increased signal-to-noise ratio, more accurate recovery of source time course dynamics, and eliminated necessity of electrode selection.</p><p>The MATLAB code used to simulate data and to implement the five methods presented here are available online (mikexcohen.com/data). Readers are encouraged to reproduce the findings, modify the code to evaluate success and failure scenarios, and adapt and extend the code to specific data analysis applications.</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Method 1: gedCFC on trough-locked covariance vs. entire time series covariance</title><p>Method 1 is designed for a situation in which the activity of one network fluctuates as a function of the phase of a lower-frequency network. To implement Method 1, a component (or single electrode) from which to compute the lower-frequency rhythm is first defined and then the troughs are identified (or peaks, or rising slopes, or any theoretically relevant phase position). The <bold>S</bold> covariance matrix is computed from data surrounding each trough, and the <bold>R</bold> covariance matrix is computed from the entire time series. <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> provides a graphical overview of Method 1.</p><p>Simulated EEG data to illustrate this method were constructed by generating activity in three dipoles in occipital cortex: one to provide a theta rhythm, and two to provide gamma oscillations. The topographical projections of these dipoles were overlapping but not identical (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). The theta rhythm (peak frequency of 6 Hz) contained amplitude and frequency non-stationarities, one gamma dipole had a peak frequency at 40 Hz and an amplitude modulated by theta phase, and the other gamma dipole had a peak frequency at 50 Hz and an amplitude that was modulated independently of theta phase. This second dipole served as a ‘distractor’ to test whether it would produce an artifact. These dipole time series, along with random correlated 1/f noise at 2,001 additional brain dipoles, were projected to 64 scalp EEG channels (see Materials and methods for additional details about simulations).<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.003</object-id><label>Figure 1.</label><caption><title>gedCFC Method 1 applied to simulated data.</title><p>Data were generated in three dipoles in the brain and projected to the scalp (top row of (<bold>A</bold>)) along with correlated 1/f noise at 2,001 other dipoles. The theta component (~6 Hz) was recovered by GED (bottom row of (<bold>A</bold>)). The 40 Hz component was recovered using gedCFC on broadband data. (B) shows the power spectrum of the theta and theta-trough components (<bold>B1</bold>), the strength of CFC (<bold>B2</bold>), and illustrative time courses (<bold>B3</bold>). The blue line in (<bold>B2</bold>) corresponds to a van der Pol oscillator (vdP), which causes spurious high-frequency CFC in traditional analyses. (<bold>C1</bold>) shows the power spectrum of electrode POz, which is the spatial maximum of the EEG data power. Note that the 50 Hz gamma (γ2) has larger power than the 40 Hz (γ1). (<bold>C2</bold>) illustrates that traditional phase-amplitude coupling with permutation testing (PACz) applied to channel POz failed to recover the simulated CFC patterns. (<bold>C3</bold>) shows the poor reconstruction of the dynamics when using data from POz (compare with (<bold>B3</bold>)).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.003">http://dx.doi.org/10.7554/eLife.21792.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig1-v1"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21792.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Two-dimensional example of using generalized eigendecomposition (GED) to separate sources.</title><p>Two data streams were created (red and blue dots). Principal components analysis (PCA) rotated the entire data set, while GED separated the two components. This was done using the equation = <bold>RWΛ</bold>, where <bold>S</bold> and <bold>R</bold> were covariance matrices from the red and blue data streams. This illustration is modeled after <xref ref-type="fig" rid="fig6">Figure 6</xref> of <xref ref-type="bibr" rid="bib3">Blankertz et al. (2008)</xref>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.004">http://dx.doi.org/10.7554/eLife.21792.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig1-figsupp1-v1"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21792.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Graphical overview of Method 1.</title><p>A low-frequency component is identified (‘Theta comp.’), and covariance matrices are computed on the basis of the multichannel data surrounding each trough, and using all data (respectively, <bold>S</bold> and <bold>R</bold> matrices). A generalized eigendecomposition of these matrices provides a set of eigenvectors (matrix <bold>W</bold>). The eigenvector with the largest eigenvalue (diagonal of matrix <bold>Λ</bold>) is used as weights to combine data from all channels linearly, which produces the component that best differentiates trough-related from non-trough-related activity.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.005">http://dx.doi.org/10.7554/eLife.21792.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig1-figsupp2-v1"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21792.006</object-id><label>Figure 1—figure supplement 3.</label><caption><title>This figure is similar to <xref ref-type="fig" rid="fig1">Figure 1</xref>, except that the gamma modulation was simulated in a collection of electrodes instead of in a dipole projected to the scalp.</title><p>This shows that gedCFC makes no assumptions regarding spatial smoothness or autocorrelation. The electrodes with black/white circles show where the gamma bursts were simulated, and the electrode with the white star shows the electrode selected for analyses in (<bold>C</bold>).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.006">http://dx.doi.org/10.7554/eLife.21792.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig1-figsupp3-v1"/></fig></fig-group></p><p>GED was used to extract a component that maximized power in the theta band. The forward model of the filter closely matched the dipole projection (<xref ref-type="fig" rid="fig1">Figure 1a</xref>), indicating accurate reconstruction of the source activity. The <bold>S</bold> covariance matrix was formed using broadband data from ¼ of a theta-frequency cycle surrounding each theta trough (⅛ of a cycle before and ⅛ after the trough), and the <bold>R</bold> covariance matrix was formed using the entire broadband time series. The MATLAB code used to obtain the weights is <monospace>[V,D]=eig(covTrough, covTot)</monospace>. The eigenvector in matrix V with the largest eigenvalue (diagonals of matrix D) is the spatial filter that can be used to obtain the ‘trough component'. This component is a weighted sum of all electrodes that maximally differentiates activity during theta troughs from activity during all theta phases.</p><p>Method 1 accurately reconstructed both the topographical map and the relationship between gamma power and theta phase (<xref ref-type="fig" rid="fig1">Figure 1</xref>). It is noteworthy that the channel data were not bandpass filtered; the 40 Hz gamma component was identified because of the separability of the covariance matrices. It is also noteworthy that the 50 Hz gamma component had twice the power of the 40 Hz gamma component (<xref ref-type="fig" rid="fig1">Figure 1b</xref>) and yet was fully suppressed by the spatial filter. This occurred because its dynamics were uncorrelated with theta phase, meaning that activity from the 50 Hz dipole contributed equally to both <bold>S</bold> and <bold>R</bold> covariance matrices.</p><p>CFC strength can be quantified in a number of ways. One approach is to apply narrowband temporal filters to the theta-trough component and to compute the average peak minus trough amplitude differences. This procedure revealed a maximum at 40 Hz and smaller peaks at 40 ± 6 Hz, corresponding to the nonstationarities induced from the theta rhythmicity of the 40 Hz amplitude modulations (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). Other quantitative methods, including computing time-frequency power spectra surrounding troughs, R<sup>2</sup> fits between the low-frequency time series and the CFC component power time series, and phase synchronization between the two components, will be illustrated in later sections. Time courses of the reconstructed theta component and power time series of the theta-trough component revealed strong co-rhythmicity, as was constructed in the simulation (<xref ref-type="fig" rid="fig1">Figure 1b</xref>).</p><p>A traditional phase-amplitude coupling analysis based on Euler’s formula from POz (the electrode with maximum power) failed to capture the simulated pattern of CFC due to low signal-to-noise characteristics of the simulation. Furthermore, the identical temporal filters applied to electrode POz showed little suggestion of CFC (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). Together, these results show that even in simple simulations, gedCFC can accurately identify weak patterns of CFC in noisy data while traditional CFC methods can produce uninspiring results.</p><p>To demonstrate that gedCFC is robust to topographical distribution, this simulation was repeated by having several different electrodes (not dipoles projected to electrodes) that formed a network of theta phase-coupled gamma oscillators. The neurophysiological interpretation of this simulation is that a single theta generator regulates the timing of a spatially distributed synchronous gamma-oscillating network. The results remained robust, as seen in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>. Although this is a useful demonstration, it is not a surprising finding, considering that gedCFC makes no assumptions about topographical characteristics or spatial smoothing.</p><p>Non-sinusoidal oscillations produce spurious phase-amplitude coupling, either due to non-uniform distribution of phase angles or to fast derivatives causing high-frequency spikes at certain phases (<xref ref-type="bibr" rid="bib37">Kramer et al., 2008</xref>; <xref ref-type="bibr" rid="bib64">van Driel et al., 2015</xref>). Therefore, this simulation was repeated, replacing the theta sine wave with repeated Gaussians or van der Pol oscillators at theta frequency (these two waveforms are known to produce spurious phase-amplitude coupling). gedCFC was completely robust to these non-sinusoidal time series, in that (1) the simulated pattern of CFC was accurately recovered regardless of non-stationarities or a non-sinusoidal shape of the lower frequency rhythm, and (2) when gamma oscillations were not amplitude-modulated by the lower frequency rhythm, no spurious CFC was identified. The latter is illustrated in <xref ref-type="fig" rid="fig1">Figure 1b</xref>, and additional simulations are shown in the online MATLAB code.</p><p>As a proof-of-principle application, Method 1 was applied to resting-state MEG data taken from the Human Connectome Project (<xref ref-type="bibr" rid="bib66">Van Essen et al., 2013</xref>). The first step was to identify an alpha component by comparing covariance matrices from data filtered in the alpha range (peak 11 Hz; FWHM 5 Hz; these parameters were selected on the basis of visual inspection of power spectra from posterior sensors). There were several physiologically plausible alpha components, as expected on the basis of previous work (<xref ref-type="bibr" rid="bib26">Haegens et al., 2014</xref>; <xref ref-type="bibr" rid="bib63">van der Meij et al., 2016</xref>; <xref ref-type="bibr" rid="bib69">Walsh, 1958</xref>). The alpha component with the largest eigenvalue was selected for subsequent analyses; it is possible that additional cross-frequency coupling dynamics could emerge when examining other alpha components. A covariance matrix of broadband data was constructed around alpha peaks (only peaks corresponding to &gt;1 standard deviation above the mean alpha peak amplitudes were included; this limits the analysis to periods of high alpha power) and compared against the broadband covariance from the entire resting period. The three gedCFC components with the largest eigenvalues were selected for analysis and visualization. Results show that, in this dataset, bursts of broadband and high-frequency activity were time-locked to alpha phase, ranging up to 150 Hz for components 2 and 3 (<xref ref-type="fig" rid="fig2">Figure 2</xref>), which appears consistent with previous reports (<xref ref-type="bibr" rid="bib48">Osipova et al., 2008</xref>). Note that the different topographies of the alpha and alpha-peak components rule out the possibility that the cross-frequency coupling resulted from an artifact of the non-sinusoidal shape of alpha.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.007</object-id><label>Figure 2.</label><caption><title>Method 1 applied to empirical MEG resting-state data.</title><p>An alpha component was computed using GED; its topographical projection and power spectrum are shown in (<bold>A1</bold>) and (<bold>A2</bold>). Covariance matrices from broadband data surrounding high-power alpha peaks were computed, and were entered into gedCFC using a covariance matrix from the broadband signal from the entire time series as reference. The first three components (topographical projections and projections onto the cortical surface in (<bold>B1</bold>)) along with their time-frequency power spectra locked to alpha peaks (<bold>B2</bold>) are shown.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.007">http://dx.doi.org/10.7554/eLife.21792.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig2-v1"/></fig></p><p>The primary assumptions of Method 1 are that there is only one high-frequency network of interest, and that its spatiotemporal characteristics (and therefore its covariance matrix) are consistent across each trough. The lower-frequency rhythm is assumed to be sufficiently rhythmic to be able to identify peaks and troughs, although frequency stationarity is not required; it would be valid to use, for example, empirical mode decomposition (a time-frequency decomposition method that can estimate non-sinusoidal oscillations) to obtain the lower-frequency rhythm. The primary limitation of Method 1 is that it is valid only when the single-network assumption is valid.</p></sec><sec id="s2-2"><title>Method 2: gedCFC on covariances of peri-peak vs. peri-trough</title><p>Method 2 is an extension of Method 1, and is designed for a situation in which a low-frequency rhythm regulates the timing of <italic>two different</italic> networks that are activated at distinct low-frequency phases. This might be the case, for example, if theta phase controls the timing of different populations of neurons that represent different items held in memory (<xref ref-type="bibr" rid="bib29">Heusser et al., 2016</xref>; <xref ref-type="bibr" rid="bib71">Zheng et al., 2016</xref>).</p><p>The implementation is similar to that of Method 1, except that the two covariance matrices are formed from data around the trough and around the peak (or any other two phase regions). The MATLAB code is <monospace>[V,D]=eig(covTrough, covPeak)</monospace>. The eigenvector in matrix V with the largest eigenvalue (diagonals of matrix D) is the spatial filter used to obtain the ‘trough component,’ while the eigenvector with the smallest eigenvalue is the spatial filter used to obtain the ‘peak component.’ <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> provides a graphical overview of Method 2.</p><p>EEG data were simulated as for Method 1, except that activity from one dipole had a peak frequency at 40 Hz and an amplitude modulated by theta phase, while activity from the second dipole had a peak frequency at 45 Hz and an amplitude modulated by the inverse of theta phase. However, different frequencies are not necessary, and the two dipoles could oscillate at the same frequency. The key to their separability is topographical projections that produce differentiable covariance matrices, and different amplitude time courses with respect to the lower-frequency phase.</p><p>gedCFC recovered the cross-frequency dynamics of the network, accurately identifying the topographical distributions, frequency ranges, and time courses (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Time-frequency power spectra time-locked to the theta troughs and peaks accurately captured the simulated dynamics. Note that this result emerged despite the absence of visually prominent gamma peaks in the channel power spectra. In other words, consistent spatiotemporal patterns that allow component extraction and CFC identification do not necessarily require visually compelling spectral peaks, as has been suggested by <xref ref-type="bibr" rid="bib1">Aru et al. (2015)</xref>; (see <xref ref-type="bibr" rid="bib28">He et al. (2010)</xref>for another counter-example). This is because the power spectrum computed over an extended period of time can fail to reveal oscillatory activity that is temporally brief or that contains frequency non-stationarities.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.008</object-id><label>Figure 3.</label><caption><title>Method 2 applied to simulated data.</title><p>Gamma power (40 and 45 Hz) in two brain dipoles was modulated by a theta wave from a third dipole. Activity from these three dipoles was projected, along with correlated 1/f noise from 2,001 other dipoles, to 64 scalp EEG channels (top row of (<bold>A</bold>) shows the signal-dipole projections). gedCFC was able to recover these three components ((<bold>A</bold>), bottom row) by comparing broadband covariance matrices between theta peaks and troughs. (<bold>B</bold>) shows the time-frequency power spectra of the components time series time-locked to theta peaks and theta troughs. (<bold>C</bold>) shows power spectra of the three component time series. For comparison, the power spectrum from POz (the channel with maximum power) is shown. (<bold>D</bold>) shows CFC modulation defined as the average peak-trough distances per frequency. (<bold>E</bold>) shows a 2 s snippet of data from the theta component and the power time courses from the theta-peak and theta-trough components. The lower panel shows data from POz bandpass filtered around theta, 40 Hz, and 45 Hz. Note that the continuous gamma power time series closely matched the theta wave from which they were simulated, although the covariance matrices were taken only from peaks and troughs.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.008">http://dx.doi.org/10.7554/eLife.21792.008</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig3-v1"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21792.009</object-id><label>Figure 3—figure supplement 1.</label><caption><title>This figure shows a graphical overview of Method 2.</title><p>It is similar to Method 1 (see <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) except that the <bold>R</bold> matrix is computed from data surrounding low-frequency peaks instead of the entire time series.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.009">http://dx.doi.org/10.7554/eLife.21792.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig3-figsupp1-v1"/></fig></fig-group></p><p>The standard phase-amplitude coupling measure relying on Euler’s formula failed to identify the pattern of cross-frequency coupling. The difficulty in this case was the source-level mixing in combination with weak gamma power relative to the noise spectrum. This simulation therefore also demonstrates how gedCFC can increase signal-to-noise characteristics, which is particularly important for non-invasilve measurements such as EEG.</p><p>As a proof-of-principle illustration, Method 2 was applied to human EEG data taken from a previously published study (<xref ref-type="bibr" rid="bib9">Cohen and van Gaal, 2013</xref>), in which we reported that theta-alpha phase-amplitude coupling was modulated by error adaptation. In the present re-analysis, GED was applied to define a spatial filter that maximized theta-band power (peak 4 Hz, FWHM 4 Hz, based on the empirical peak theta frequency from channel FCz), which was then used to identify theta peaks and troughs. Next, the 64-channel data were filtered in the alpha band (peak 10.5 Hz, FWHM 4 Hz, based on the empirical alpha peak frequency from channel POz), and covariance matrices were computed using data surrounding ¼ of a theta cycle centered on peaks and troughs of the theta component (data were bandpass filtered here because of <italic>a priori</italic> hypotheses about theta-alpha coupling). The two components with the largest and smallest eigenvalues were selected as spatial filters. The power of those components was computed as a function of 30 theta phase bins, and the distributions are shown in <xref ref-type="fig" rid="fig4">Figure 4c</xref>. The relationship between alpha power and theta phase bin was shuffled 1,000 times to produce a null-hypothesis distribution. The 95% range of this distribution is shown as a gray patch in <xref ref-type="fig" rid="fig4">Figure 4c</xref>. Data values outside this range can be considered unlikely to occur by chance. Additional possibilities for statistical evaluation include fitting a sine wave to the alpha power distribution, or performing a test against a null hypothesis of a uniform distribution (e.g., a Kolmogorov-Smirnov test).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.010</object-id><label>Figure 4.</label><caption><title>Illustration of Method 2 applied to real EEG data.</title><p>The human volunteer (one subject selected from <xref ref-type="bibr" rid="bib9">Cohen and van Gaal (2013)</xref>) performed a speeded reaction time task in which response errors frequently occurred. (<bold>A</bold>) shows topographical projections of the three components (theta power, theta trough, theta peak). (<bold>B</bold>) shows power time courses relative to stimulus onset (time = 0) from those components, separately for correct and error trials (power was extracted via the filter-Hilbert method). (<bold>C</bold>) shows how alpha power in the two alpha components fluctuated as a function of theta phase. Note that gedCFC was based on data from all trials pooled; the two experiment conditions were separated only when plotting. The gray bars in (<bold>C</bold>) show 95% confidence intervals based on 1,000 permutations in which the assignment between theta phase and alpha power was shuffled.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.010">http://dx.doi.org/10.7554/eLife.21792.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig4-v1"/></fig></p><p>The main assumption underlying Method 2 is that the neural populations activated during peaks and troughs of the low-frequency rhythm produce field potential fluctuations that have separable projections onto multichannel recordings. Other assumptions are similar to those of Method 1: consistent spatiotemporal characteristics of each network, and a lower frequency dynamic that is rhythmic enough to be able to define peaks and troughs.</p><p>The main limitation of Method 2 is that the assumption of topographically separable networks according to different low-frequency phases is critical. If Method 2 were applied to a single network that varies only in amplitude according to lower-frequency phase, it would produce two identical (plus noise) covariance matrices. gedCFC would then return uninterpretable results (Method 1 would be appropriate in this case).</p></sec><sec id="s2-3"><title>Method 3: low-frequency waveform shape as a bias filter on sphered data</title><p>Methods 1 and 2 are robust to low-frequency non-sinusoidal oscillations precisely because the waveform shape is ignored, except to identify specific time points for time-locking the covariance matrices. On the other hand, very different waveform shapes could produce peaks at the same times. Given that waveform shape is the result of biophysical processes, one may wish to incorporate the lower-frequency waveform shape into the analysis. In this case, Methods 1 and 2 are inappropriate. Therefore, the goal of Method 3 is to use the lower-frequency time series as a continuous regressor without necessitating <italic>a priori</italic> specification of the relevant phase regions.</p><p>In Method 3, a low-frequency time series is used as a ‘bias filter’ that is applied to the multichannel data in order to determine the linear combination of electrodes that best matches the bias filter. The multichannel data are first sphered (i.e. whitened; after sphering, the covariance matrix is diagonal, meaning that inter-channel covariances are zero), which allows the filter to highlight only the spatiotemporal patterns that covary with the bias filter without influence from endogenous oscillatory activity.</p><p>The mechanics of Method 3 closely follow the ‘joint decorrelation’ method presented in <xref ref-type="bibr" rid="bib15">de Cheveigné and Parra (2014)</xref>. A brief overview is provided here and depicted in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>; interested readers are directed to the 2014 paper for more details. The first step is to extract the time series of a low-frequency component, as was done in Methods 1 and 2, to be used as a bias filter. The next step is to narrowband filter the multichannel data and extract the amplitude envelope (e.g., from filter-Hilbert or from Morlet wavelet convolution). This is an important step: the goal is to identify <italic>power</italic> fluctuations that vary according to the lower-frequency phase; therefore, it is the high-frequency power time series, not the bandpass filtered signal, that is of primary interest. The next step is to sphere the multichannel power fluctuations, which is implemented by scaling their eigenvalues. If the channels-by-time power time series data <bold>X</bold> has eigenvectors and eigenvalues <bold>V</bold> and <bold>D</bold>, then the sphered data are defined as <bold>Y</bold>=<bold>X<sup>T</sup>VD<sup>-½</sup></bold>, where <bold><sup>T</sup></bold> indicates the matrix transpose and <bold><sup>-½</sup></bold> indicates the square root of the matrix inverse. Next, the bias filter is expanded into a Toeplitz matrix (<bold>B</bold>) that left-multiplies the data as <bold>BY</bold>. The eigendecomposition of the covariance matrix of <bold>BY</bold> provides a new set of eigenvectors <bold>W</bold>, which are used to rotate the original eigenspace of the data as <bold>VD<sup>-½</sup>W</bold>. The spatial filter with the largest eigenvalue is applied to the non-sphered narrow-band multichannel power time series data to obtain the component. This procedure is repeated over a range of higher frequencies, using the same <bold>B</bold> matrix for all frequencies.</p><p>Data for Method 3 were simulated like those for Method 1. <xref ref-type="fig" rid="fig5">Figure 5</xref> shows the fit of the filtered component to the simulated dipole gamma power time series (R<sup>2</sup>). Fits were equivalently good (up to 5) when using correlations and phase synchronization measures, and were poor (&lt;0.1) when using data from the gamma-maximum electrode instead of the component. The theta peak-locked power spectra from the component showed a precise spectral-temporal localization consistent with how the data were simulated.<fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.011</object-id><label>Figure 5.</label><caption><title>Results from simulation for Method 3.</title><p>Data were simulated in the same dipoles used in Method 1. (<bold>A</bold>) shows an example of the dipole time series, illustrating the theta wave and the gamma modulation (scaled for visibility). Power time series were extracted from all channels, and the low-frequency time series was used as a bias filter against the multichannel power time series matrix. (<bold>B</bold>) shows the power spectrum from channel POz (left panel). Note the absence of a prominent 45 Hz peak. The right panel shows the power spectrum of the 45 Hz power time series from the gedCFC component. The peak at 6 Hz reflects the modulation of 45 Hz power by the theta rhythm. (<bold>C</bold>) shows the fit (correlation or phase synchronization) between the gedCFC component per frequency and the simulated power time series. For comparison, the correlation result was also performed at channel POz. The right panel shows the time-frequency power spectrum locked to theta peaks.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.011">http://dx.doi.org/10.7554/eLife.21792.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig5-v1"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21792.012</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Graphical overview of the procedure for applying joint decorrelation adapted to Method 3.</title><p>(1) The bias filter is a low-frequency dynamic to be used as the time series ‘seed’ for identifying CFC. It is expanded to a matrix using the Toeplitz operation. (2) The analytic envelope from each data channel is extracted and mean-centered to form a new data matrix, <bold>X</bold>. (3) The data are sphered to remove intrinsic covariance patterns, forming a new data matrix <bold>Y</bold>; sphering turns the covariance matrix into a diagonal matrix. (4) The bias filter multiplies <bold>Y</bold>, which computes the dot product between temporally shifted versions of the bias filter and the sphered data. (5) The covariance matrix of <bold>BY</bold> has eigenvectors <bold>W</bold> that rotate the eigenspace of <bold>X</bold> (its eigenvectors are in <bold>V</bold> and eigenvalues are in <bold>D</bold>) as matrix <bold>F</bold>. The largest-valued eigenvector in <bold>F</bold> defines the multivariate component that best matches the bias filter.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.012">http://dx.doi.org/10.7554/eLife.21792.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig5-figsupp1-v1"/></fig></fig-group></p><p>Empirical data for a proof-of-principle demonstration were taken from recordings in a human epilepsy patient. Eleven channels were simultaneously recorded, ten along the medial temporal lobe axis (including the amygdala and hippocampus, locally-average reference) and one from surface channel Cz (on the vertex on the scalp, referenced to mastoids). Low-frequency midline cortical activity (peak frequency 4 Hz, FWHM 3 Hz) was extracted from Cz and was used as the bias filter in the Toeplitz matrix <bold>B</bold>. To reduce computational load and increase signal-to-noise characteristics, the continuous data were cut into 50 equally sized epochs of 4 s each, and the covariance matrix of <bold>BY</bold> was computed separately per epoch and then averaged together.</p><p>The gedCFC was applied iteratively using power time series from the medial temporal lobe in 70 frequencies, ranging from 10 to 120 Hz. CFC was quantified using R<sup>2</sup> fit between the component power time series and the Cz low-frequency rhythm, and as phase synchronization (which ignores the amplitude fluctuations). <xref ref-type="fig" rid="fig6">Figure 6a</xref> reveals a peak in this coupling at around 65 Hz. Inspection of time-frequency power spectra time-locked to theta peaks (<xref ref-type="fig" rid="fig6">Figure 6b</xref>) indicates that high-frequency power built up prior to the Cz theta peak. This component was more strongly driven by anterior channels (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). Statistical evaluation of the coupling-by-frequency analysis was implemented by shifting the low-frequency time series by a random amount relative to the power time series, and by recomputing the correlation and phase synchronization coupling measures. This procedure was repeated 1,000 times to generate a null hypothesis distribution. The 99% values of these distributions are shown as dotted lines in <xref ref-type="fig" rid="fig6">Figure 6a</xref>.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.013</object-id><label>Figure 6.</label><caption><title>Method 3 applied to empirical data from a human epilepsy patient, with ten channels in the medial temporal lobe (MTL) and Cz, a scalp electrode that measures midline frontal activity.</title><p>Covariance matrices of MTL channels were created locked to peaks from Cz filtered at 4 Hz. (<bold>A</bold>) shows the coupling strengths, measured both as correlations (r) and as phase synchronization (ps) over a range of frequencies (notch-filtered data at 50 Hz and 100 Hz are omitted). Correlation values were squared to avoid sign issues, and phase synchronization values were squared for comparability. The dotted lines indicate the 99% confidence intervals based on 1,000 permuted shufflings. (<bold>B</bold>) shows the time-frequency power spectrum of the MTL component time-locked to Cz theta peaks. The right plot shows the time course of activity averaged around 65 Hz (frequencies selected based on visual inspection of (<bold>A</bold>). (<bold>C</bold>) illustrates the component weighting across the ten MTL electrodes from two neighboring frequencies (see black and gray filled squares in (<bold>A</bold>); smaller numbers are anterior).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.013">http://dx.doi.org/10.7554/eLife.21792.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig6-v1"/></fig></p><p>Interactions between the medial temporal lobe (and hippocampus in particular) and prefrontal cortex are widely implicated in memory formation (<xref ref-type="bibr" rid="bib52">Preston and Eichenbaum, 2013</xref>). A multivariate technique like gedCFC might be useful in providing insights into how different hippocampal-prefrontal networks are involved in different aspects of memory (<xref ref-type="bibr" rid="bib54">Shin and Jadhav, 2016</xref>). Incorporating the waveform shape into the filter might also prove insightful considering that rat hippocampal theta is non-sinusoidal (<xref ref-type="bibr" rid="bib2">Belluscio et al., 2012</xref>).</p><p>The key assumption of Method 3 is that the lower-frequency waveform shape is important (as opposed to being used simply to identify peaks and troughs). The main limitation is that this method relies crucially on proper specification of the bias filter. The bias filter could be misspecified if its spatial and spectral characteristics are not known or are suboptimally estimated. Thus, Method 3 should be used only when there is a strong <italic>a priori</italic> motivation to justify using an appropriate bias filter.</p></sec><sec id="s2-4"><title>Method 4: gedCFC using time-delay embedded matrices</title><p>In Methods 1–3, the higher-frequency components are computed using covariance matrices, but their temporal and spectral characteristics are computed using sinusoid-based filters, which impose sinusoidality and temporal symmetry on the results, particularly when using narrowband filters. Therefore, the purpose of Method 4 is to empirically compute the higher-frequency waveform shape, as well as its spatial distribution, directly from the data, without relying on narrowband filters. This allows the identification of CFC-related activity that is not necessarily sinusoidal or even rhythmic. And if the activity is sinusoidal, the spatiotemporal filter will empirically identify the sinusoidality without the confound of using a sinusoidal filter.</p><p>Method 4 is accomplished through time-delay embedding, which means that additional rows are added to the data matrix, which correspond to time-shifted versions of the channel time series. For example, a first-order time-delay embedded matrix of 64 electrodes would have 128 rows; the first 64 rows are taken from the 64 electrodes and time points 1 to end-1, while the next 64 rows are taken from the same 64 electrodes and time points two to end. Importantly, because GED doesn’t ‘know’ that the data come from time-delayed versions of the same electrodes, the weights assigned to time-delayed rows act as temporal weights from which a temporal filter is empirically computed (<xref ref-type="bibr" rid="bib17">de Cheveigné, 2010</xref>). For example, a filter that finds the temporal derivative would have weights of 1 and −1 for the original and time-delayed rows. In practice, more than one delay embedding is useful. Time-delay embedding was developed in dynamical systems analysis, and has been successfully applied to psychometric and neural data (<xref ref-type="bibr" rid="bib4">Brunton et al., 2016</xref>; <xref ref-type="bibr" rid="bib16">de Cheveigné and Simon, 2007</xref>; <xref ref-type="bibr" rid="bib38">Lainscsek and Sejnowski, 2015</xref>; <xref ref-type="bibr" rid="bib59">Tome et al., 2004</xref>; <xref ref-type="bibr" rid="bib67">von Oertzen and Boker, 2010</xref>). After creating this time-delay embedded data matrix, Method 4 proceeds similarly as Method 1: two covariance matrices are computed, one from data surrounding troughs and one from the entire time series, and GED is applied to those two matrices. The eigenvector with the largest eigenvalue is a spatiotemporal filter of size 1 ×MN, where M is the number of channels and N is the number of embeddings. To interpret this filter, its forward model can be reshaped to M×N and visualized as a time-by-channels matrix.</p><p>The number and spacing of delay embeds are parameters of the time-delay-embedded matrix. If one wishes to use the Fourier transform to determine the filter’s frequency characteristics, the delays should be linear (that is, embedding 1, 2, 3, 4, instead of 1, 2, 4, 8), and the number of delay embeds determines the frequency resolution. Here, a 60<sup>th</sup> order matrix was used, meaning the data matrix contains 3,840 rows (60 embeddings times 64 channels). At 1,024 Hz, this provided a frequency resolution of 17 Hz, which was then zero-padded to a frequency resolution of 2 Hz. There are other methods to determine the embedding dimension (<xref ref-type="bibr" rid="bib7">Cao, 1997</xref>; <xref ref-type="bibr" rid="bib42">Maus and Sprott, 2011</xref>); it is beyond the scope of this paper to include an exhaustive discussion of these methods.</p><p>Data were simulated by adding a burst of 75 Hz activity to one dipole at each trough of theta from another dipole (<xref ref-type="fig" rid="fig7">Figure 7a</xref>), then adding 1/f noise and projecting to 64 EEG electrodes. The gamma power bursts were time-locked to the troughs, but the phase of the gamma burst varied randomly across bursts, thus producing a non-phase-locked (i.e., ‘induced’) response. A high-pass temporal filter (lower edge 20 Hz) was applied to the data to prevent the component from simply reflecting the shape of the lower-frequency time series around the peak.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.014</object-id><label>Figure 7.</label><caption><title>Method 4 applied to simulated EEG data.</title><p>Bursts of 75 Hz gamma in one dipole were locked to theta troughs in a different dipole (<bold>A</bold>). Activity in these two dipoles, along with a ‘distractor’ gamma signal at 50 Hz and correlated 1/f noise at all other dipoles, was projected to scalp EEG channels. (<bold>B</bold>) shows the dipole projections and their reconstructions from gedCFC on delay-embedded matrices. (<bold>C</bold>) shows the trough-locked average (TLA) over time for all electrodes (electrodes are sorted according to spatial location, with anterior electrodes on top and posterior electrodes on the bottom) on the left and the spatiotemporal component (STC) extracted via gedCFC on the right. (<bold>D</bold>) shows the time series of the filter kernel from electrode POz (left), the filter kernel power spectrum (middle), and the power spectrum of POz activity (right; note the absence of a pronounced peak at 75 Hz). Even with only minimal noise, the non-phase-locked nature of the gamma burst prevented the TLA from revealing any meaningful relationship (phase-locking does not affect the single-trial covariance matrices). Amplitudes are normalized to facilitate direct comparisons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.014">http://dx.doi.org/10.7554/eLife.21792.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig7-v1"/></fig></p><p><xref ref-type="fig" rid="fig7">Figure 7</xref> shows that the theta and gamma components were accurately recovered. This result can be compared with the GED results to the trough-triggered averages (this is an event-related potential, where the ‘event’ is the trough), which failed to detect the simulated cross-frequency coupling. This occurred even without adding noise to the data, and is attributable to the non-phase-locked nature of the gamma bursts. Note that, as with previous simulations, the gamma bursts were generally too small and transient to be visually detected in the channel power spectrum, even at the electrode with the maximal theta-trough-component projection (<xref ref-type="fig" rid="fig7">Figure 7D</xref>).</p><p>Method 4 was applied to empirical data taken from the rat hippocampus (data downloaded from crcns.org; <xref ref-type="bibr" rid="bib19">Diba and Buzsáki, 2008</xref>; <xref ref-type="bibr" rid="bib44">Mizuseki et al., 2013</xref>; dataset ec013.156). A theta component was obtained by comparing covariance matrices between 8 Hz and the average of 4 Hz and 12 Hz (a broadband reference was not used because it was dominated by theta). As with the simulation, the data were high-pass filtered at 20 Hz to prevent the largest components from reflecting theta phase. Peri-peak covariance matrices were computed, and compared against the total covariance. The eigenvector with the largest eigenvalue identified a component with a spectral peak in the gamma band that had a similar spatial projection onto all channels (<xref ref-type="fig" rid="fig8">Figure 8</xref>). By contrast, the peak-locked average had a complex waveform shape without a clear spectral concentration.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.015</object-id><label>Figure 8.</label><caption><title>Illustration of Method 4 applied to empirical data from rodent hippocampus.</title><p>GED was used to identify a theta component (peak frequency 8 Hz), and peak times were identified. (<bold>A</bold>) illustrates the peak-triggered LFP trace over 32 channels (high-pass filtered at 20 Hz), and the forward model of the first gedCFC component. (<bold>B</bold>) illustrates the peak-locked average and the component model, averaged over all channels, in the time domain (left panel) and in the frequency domain (right panel). Amplitudes were scaled and y-axis-shifted for comparability.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.015">http://dx.doi.org/10.7554/eLife.21792.015</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig8-v1"/></fig></p><p>As implemented here, Method 4 assumes a single network that varies according to low-frequency phase. The method could be adapted to identify two networks, as with Method 2. Parameterizing the matrix is also important, as insufficient delay embeds will reduce the temporal precision and frequency resolution.</p><p>The primary limitation is that working with delay-embedded matrices requires sufficient computing resources. For example, two minutes of 256 channels at 1 kHz and a 40-fold embedding would produce a matrix of size 10,240-by-120,000. Matrix operations can be slow and can produce numerical inaccuracies. Two potential solutions are to temporally downsample the data or to use a data-reduction technique, such as principal components analysis, to reduce the data, to 40 dimensions for example., makng it possible to perform analyses in the 40-dimensional subspace.</p></sec><sec id="s2-5"><title>Method 5: gedCFC for spike-field coherence</title><p>Spike-field coherence refers to local field potential (LFP) correlates of single-cell spiking. It is often quantified either through spike-triggered averages, in which the LFP traces are averaged around each spike (similar to an event-related potential, where the event is the spike), or through phase-clustering-based methods, in which the phase angles are extracted from frequency-specific analytic time series (e.g., from complex wavelet convolution).</p><p>Although spike-field coherence is not typically conceptualized as a manifestation of CFC, in the gedCFC framework, spike-field coherence is simply a special case in which multichannel data are time-locked to the action potential instead of to a low-frequency trough. In this sense, any of the methods presented above (or combinations thereof) can be adapted to work for multichannel spike-field coherence. In this section, an adaptation of Method 4 is demonstrated. Method 4 is highlighted here because it allows unconstrained empirical discovery of asymmetric spike-related LFP activity; it can be used, for example, if the LFP waveform shape differs before and after the spike.</p><p>Simulated data were modeled after a 16-channel linear probe that is often used to study laminar dynamics in the cortex. Spikes were generated at random times, and bursts of 70 Hz gamma were centered on each spike, with a ‘rugged’ laminar profile (similar to that in <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>, which illustrates that gedCFC makes no assumptions about spatial smoothness) (<xref ref-type="fig" rid="fig9">Figure 9a</xref>). In addition, a 75 Hz gamma rhythm that was uncorrelated with spike timing was added as a ‘distractor.’ Random 1/f noise was also added.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.016</object-id><label>Figure 9.</label><caption><title>Use of the gedCFC framework for detecting spike-field coherence in multichannel data.</title><p>LFPs were simulated in 16 channels, modeled after a silicon probe often used to measure cortical laminar activity. Forty random spike times were generated, and complex spatiotemporal patterns were time-locked to each spike time. (<bold>A</bold>) illustrates the basic pattern, which was phase-randomized on each spike. (<bold>B</bold>) illustrates a few single-spike LFP traces from one channel, and the spike-triggered average over time and space (compare with the template in (<bold>A</bold>)). (<bold>C</bold>) shows the forward model from the largest gedCFC component reshaped to a 2D matrix. (<bold>D</bold>) shows the power spectrum of the component and the spike-triggered average (power spectra averaged across channels).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.016">http://dx.doi.org/10.7554/eLife.21792.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig9-v1"/></fig></p><p>As expected, Method 5 recovered the simulated spatiotemporal LFP pattern (<xref ref-type="fig" rid="fig9">Figure 9c–d</xref>). With few spikes (N = 40), only a small amount of noise will prevent the spike-triggered average from revealing the true effect. Even when no noise was added, the spike-triggered average failed to capture the true effect if the gamma burst was time-locked but not phase-locked to the spike.</p><p>Method 5 was applied to an empirical dataset from recordings of rat medial prefrontal cortex and hippocampus (data downloaded from CRCNS.org; <xref ref-type="bibr" rid="bib21">Fujisawa et al., 2008</xref>, <xref ref-type="bibr" rid="bib22">2015</xref>; dataset EE.042). Data were recorded from 64 channels in the medial prefrontal cortex and 32 channels in the hippocampus. Spiking data were taken from a single neuron in the prefrontal cortex. The first several components appeared to capture a spike artifact in the LFP (<xref ref-type="fig" rid="fig10">Figure 10a</xref>). Two later components were selected on the basis of visual inspection. Neither component appeared to suffer from spike artifacts, and both revealed rhythmic LFP dynamics surrounding the spike with phase offsets between the prefrontal and hippocampal electrodes. Temporal and spectral plots of the filter forward model, as well as the spike-triggered average component time series (<xref ref-type="fig" rid="fig10">Figure 10b</xref>), revealed that these two spike-field networks had different characteristic frequencies and temporal dynamics. Note the temporal asymmetries (before vs. after the spike) and nonstationarities in the component time series; these are readily visible because no filters were applied that would artificially impose sinusoidality or acausality on the data; instead, the filter kernel was empirically estimated on the basis of broadband data.<fig-group><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.21792.017</object-id><label>Figure 10.</label><caption><title>Method 5 applied to rodent hippocampal-prefrontal single-cell and LFP recordings.</title><p>(<bold>A</bold>) shows the spike-triggered average across all channels (MFC = medial frontal cortex; Hip. = hippocampus). (<bold>B</bold>) illustrates the forward models of several gedCFC components. The first few components captured the spike artifact, as shown in (<bold>B1</bold>). Later components reflected different aspects of physiological activity, two of which are illustrated here ((<bold>B2</bold>) and (<bold>B3</bold>)). The power spectra of the spike-triggered average and the two physiological components are shown in (<bold>C</bold>) (the component spectra have the same y-axis scale; the spike-triggered average was scaled down for comparability; STC = spatiotemporal component). (<bold>D</bold>) shows the spike-triggered average of the two components (shifted on the y-axis for comparability). Note that the components are temporally asymmetric and nonsinusoidal; their waveform shapes are defined empirically without imposition of a sinusoidal filter.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.017">http://dx.doi.org/10.7554/eLife.21792.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig10-v1"/></fig><fig id="fig10s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21792.018</object-id><label>Figure 10—figure supplement 1.</label><caption><title>This figure shows another possible application of the gedCFC framework for multivariate spike-field coherence, using the same dataset as used in <xref ref-type="fig" rid="fig10">Figure 10</xref>.</title><p>Action potentials from a single neuron (different from the one used in <xref ref-type="fig" rid="fig10">Figure 10</xref>) in the prefrontal cortex were categorized as ‘singlets’ (no action potentials 100 ms earlier or 100 ms later; N = 58) or as ‘train-starters’ (no action potentials 100 ms earlier, and at least one action potential within 20 ms after; N = 151). LFP covariance matrices were then formed around these two action potential categories and compared using Method 2. The component with the largest and smallest eigenvalues were extracted and treated as ‘singlet’ and ‘train-starter’ components. This figure shows the time courses of those components relative to the spikes, as well as the spike-triggered average LFP traces (STA). The ‘train-starter’ component was dominated by hippocampal activity. The jagged appearance of the weights is consistent with the electrode layout, which had eight electrodes per shank and four shanks.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21792.018">http://dx.doi.org/10.7554/eLife.21792.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-21792-fig10-figsupp1-v1"/></fig></fig-group></p><p>Components that capture spike artifacts can be identified by visual inspection or by examining the power spectrum of the filter forward model: artifacts have higher energy in a broad high-frequency range relative to lower frequencies, whereas true effects should have higher energy below ~200 Hz compared to above. Non-artifact components can be individually selected on the basis of prespecified criteria such as frequency band, or can be summarized using principal components analysis.</p><p><xref ref-type="fig" rid="fig10">Figure 10</xref> shows one example of how to apply the gedCFC framework to investigate multichannel spike-field coherence. There are several other possibilities. One could identify the spike artifact components and reconstruct the data with the artifact removed (<xref ref-type="bibr" rid="bib17">de Cheveigné, 2010</xref>) in order to apply traditional spike-field coherence analyses. Another possibility is to adapt Method 2 to identify LFP components corresponding to different temporal patterns of spiking, such as singlets vs. trains of action potentials. An example of this approach is presented in <xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>.</p></sec><sec id="s2-6"><title>Over-fitting and null-hypothesis testing</title><p>Components analyses that are guided by minimization or maximization criteria (such as GED) entail a risk of overfitting. Essentially, one is searching through a high-dimensional space for a particular feature; even in pure noise, the components will identify some pattern that best fits the criteria. There are at least three appropriate statistical methods for evaluating the results of gedCFC.</p><p>One approach is to compare the resulting components against a null-hypothesis distribution. This null-hypothesis distribution can be derived by applying the method but using randomly selecting time points to be ‘troughs’ (the total number of randomized ‘troughs’ should be the same as the number of real troughs). When repeated, for example 1,000 times with different sets of random ‘troughs,’ the spatiotemporal characteristics, including time courses and power spectra, of the true components can be compared against the empirical null hypothesis distribution. This procedure follows the non-parametric permutation framework that is widely used in neuroimaging and electrophysiology (<xref ref-type="bibr" rid="bib10">Cohen, 2014</xref>; <xref ref-type="bibr" rid="bib41">Maris and Oostenveld, 2007</xref>). A difficulty with this approach is that the resulting components may capture the low-frequency component. One could apply a high-pass filter or ignore any coupling close to the frequency used to extract the low-frequency component.</p><p>A second approach is to apply gedCFC to data pooled across all experiment conditions, and then to apply statistical comparisons of component time series or power spectra across different conditions. In this case, although the component-fitting procedure itself may include overfitting, differences across conditions are not biased because the filter was defined orthogonal to condition differences. A related approach is to apply the method to a range of frequencies and then to test whether the coupling strength at different frequencies is statistically significant, as illustrated in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p><p>A third approach is to compute the gedCFC filter from independent data and then apply the filter to the experimental data. Independent data could be drawn from different trials from the main experiment (as in cross-validation) or from an independent dataset such as a localizer. In the case of cross-validation, confidence intervals can be computed.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>There is spatiotemporal structure in the mesoscale electrical activity of the brain, which reflects the dynamic interactions within and across populations of neurons. Because this spatiotemporally structured activity is larger than that which can be recorded by a single electrode, single-electrode analyses will miss or underestimate these patterns. Therefore, as the number of simultaneous electrodes used in neural recordings increases (<xref ref-type="bibr" rid="bib56">Stevenson and Kording, 2011</xref>), so does the need to consider methods for extracting the neural patterns that underlie those recordings. Component-extraction and dimensionality-reduction methods have proven useful in neuroscience, both in terms of managing large-scale data sets and in terms of providing insights into neural mechanics that are difficult to obtain only from visualizing topographical maps (<xref ref-type="bibr" rid="bib12">Cunningham and Yu, 2014</xref>; <xref ref-type="bibr" rid="bib46">Onton et al., 2006</xref>).</p><sec id="s3-1"><title>Cross-frequency coupling in neural time series data</title><p>CFC is a fascinating observation that has garnered interest amongst empiricists, modelers, theoreticians, and mathematicians. It has also been the subject of considerable debate, as there seems to be a growing number of publications criticizing CFC methods (<xref ref-type="bibr" rid="bib1">Aru et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Hyafil, 2015</xref>; <xref ref-type="bibr" rid="bib40">Lozano-Soldevilla et al., 2016</xref>). Many of these methodological concerns affect only one framework for analyzing CFC using individual electrodes via narrow bandpass filtering and applying Euler’s formula, phase synchronization, or other distribution analyses. These methods provide accurate results under the assumption of uniform phase angle distribution; CFC biases result from violations of this assumption (<xref ref-type="bibr" rid="bib64">van Driel et al., 2015</xref>). The framework introduced here evades several of these problems. This new framework does not invalidate or antiquate existing CFC measures; traditional CFC methods are well-suited for situations in which the lower and higher frequency dynamics are sinusoidal and are produced by neural circuits that have the same spatial projections to multichannel recordings.</p><p>The advantages of gedCFC go beyond evading potential biases in traditional CFC measures. This multivariate framework allows detection of diverse spatiotemporal manifestations of CFC, some of which may be difficult to detect with other methods. The inspiration for this framework came from considering the physics of M/EEG and LFP field propagation, by theoretical predictions that the low-frequency rhythm should regulate anatomically diverse neural populations, and by developments in spatial filtering methods used in source separation and dimensionality reduction analyses.</p></sec><sec id="s3-2"><title>Advantages of gedCFC</title><p>Several specific advantages were highlighted in the Results subsections; a few general remarks are made here. One advantage of the gedCFC framework is that there are no assumptions about underlying generative models that may have produced the data (other than the plausible assumption that electromagnetic fields propagate simultaneously and linearly to multiple channels). It is not necessary to assume Gaussian or Poisson processes for example, nor is it necessary to employ complicated statistical or biophysical models. Instead, the components are extracted directly from the empirical data.</p><p>A second advantage is flexibility. From the single equation <bold>SW=RWΛ</bold>, five applications were derived. By carefully selecting parameters, frequency ranges, experiment conditions, time windows, and so on, this framework is easily extended and tailored to specific hypotheses. One should be cognizant that components-based and dimensionality-reduction-based analyses will perform well when there are clean data and when the researcher has clear and physiologically motivated objectives (<xref ref-type="bibr" rid="bib65">van Ede and Maris, 2016</xref>). Excessively noisy data or poorly specified analysis goals (i.e., from poorly specific hypotheses) may produce misleading or uninterpretable results.</p><p>A third advantage is increased signal-to-noise characteristics (and therefore, increased sensitivity to detecting CFC), which come from analyzing a weighted combination of data from all electrodes instead of a single electrode. The key is to create those weights appropriately and in an hypothesis-driven manner. The presence of a visually robust peak in the FFT-derived power spectrum is not a hard constraint on the success of gedCFC (as illustrated in <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig5">5</xref>). An oscillation may exist in a data set and yet have a small peak in a static power spectrum due to non-stationarities in power and phase characteristics.</p><p>A fourth advantage is computation time. Many traditional CFC analyses can be prohibitively time-consuming. gedCFC is fast because software programs like MATLAB use efficient libraries for estimating eigenvalues. On most computers and for most covariance matrices, the MATLAB eig function takes a few milliseconds. The exception is Method 4, which can be processor-intensive for very large matrices (the Results section provided a few suggestions for improving computation time, including temporal downsampling and dimensionality reduction). Bandpass filtering, when used, is also fast, and the narrowband filter used here involves only one FFT and one IFFT.</p></sec><sec id="s3-3"><title>Limitations of gedCFC</title><p>Specific limitations were discussed in each Results subsection; a few additional remarks are made here. First, sign-flipping of components produces uncertainty of peak vs. trough in the low-frequency component. The signing strategy used here is discussed in the Materials and methods section. Relatedly, bursts of high-frequency activity might be locked to the rising slope or falling slope of the low-frequency rhythm instead of the peak or trough (<xref ref-type="bibr" rid="bib23">Fujisawa and Buzsáki, 2011</xref>). Careful data examination and <italic>a priori</italic> theoretical guidance should be used to determine the appropriate phase values for time-locking.</p><p>A second limitation is that the component with the largest eigenvalue is not necessarily the only theoretically relevant component (as illustrated in <xref ref-type="fig" rid="fig10">Figure 10</xref>, the largest eigenvalued component may contain artifacts). It is possible that the first few components define a subspace of physiological CFC dynamics. In other words, a single component does not necessarily correspond to a single brain dynamic (<xref ref-type="bibr" rid="bib15">de Cheveigné and Parra, 2014</xref>). It is advisable to inspect several components for physiological interpretability and modulation by experimental conditions, as was done in <xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig10">10</xref>.</p><p>Third, the gedCFC framework is designed for two covariance matrices. To identify more than two networks, one could iteratively apply, for example, Method 1 to six different phase bins. The six spatial filters could be applied the data to reconstruct six different component time courses. This approach is valid if there really are six distinct networks; otherwise, the same spatial filter might be recreated multiple times, with apparent differences attributable to over-fitting noise.</p><p>Finally, gedCFC should not be treated as a ‘black-box’ analysis procedure in which results are interpreted without careful inspection of the data, analysis procedures, and parameters. Misleading or uninterpretable results can occur if excessively noisy data or inappropriate parameters are applied. Instead, gedCFC is best conceptualized as an analysis strategy that mixes physiologically inspired hypothesis testing (e.g., when defining the lower-frequency dynamic) with blind network discovery. The discovery aspect stems from not needing to specify which topographical regions or frequency bands will manifest CFC.</p></sec><sec id="s3-4"><title>Nonstationarities and condition differences</title><p>The intrinsic nonstationarities of the brain can be problematic for analyses that rely on stationarity over long periods of time, and are also problematic for traditional CFC analyses. Sinusoidal stationarity is not assumed in the gedCFC framework. gedCFC is also not affected by phase lags across different electrodes, as long as the lags are consistent. The core assumption is that the neural patterns maintain a consistent spatiotemporal signature, for example, that each trough-locked covariance matrix is a representative sample. If narrowband filtering is applied to the higher-frequency activity, then an additional assumption is that the activity can be reasonably approximated by sinusoidal basis functions (this is generally a reasonable assumption at the scale of hundreds of ms).</p><p>Task-related experiments often have multiple conditions. This leads to the decision to compute covariance matrices separately for each condition, or from condition-pooled data to which the spatial filter is then applied to each condition separately. If the covariance structure is expected to be qualitatively different across conditions, separate covariance matrices should be preferred. On the other hand, if the network structure is expected to be the same and only the strength of the modulations are expected to vary, it is preferable to pool data across all conditions when computing the GED.</p><p>The quality of gedCFC components is related to the quality of the covariance matrices, and a sufficient amount of clean data ensures high-quality covariance matrices. Determining the quality of a covariance matrix can be difficult. One metric is the condition number, which is the ratio between the largest and smallest singular values of the matrix. However, there is no hard threshold for considering a matrix to be ill-conditioned, and GED can be successfully applied to singular matrices (which have a condition number of infinity). When working with a small amount of data, using alternative methods of estimating covariance, such as shrinkage estimators, may be helpful (<xref ref-type="bibr" rid="bib13">Daniels and Kass, 2001</xref>).</p></sec><sec id="s3-5"><title>gedCFC for spike-field coherence provides new insights and avoids potential artifacts</title><p>One of the main confounds in spike-field coherence analyses is that the brief large-amplitude spike can cause an artifact in the low-pass filtered LFP (<xref ref-type="bibr" rid="bib53">Ray, 2015</xref>; <xref ref-type="bibr" rid="bib70">Zanos et al., 2011</xref>). This is a well-known phenomenon in signal processing that is often called an edge artifact.</p><p>Spike-field coherence here was investigated by adapting Method 4 (<xref ref-type="fig" rid="fig9">Figures 9</xref> and <xref ref-type="fig" rid="fig10">10</xref>) to give rise to Method 5 (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>), but other situations might call for different approaches. For example, Method 2 could be further adapted to identify multivariate components that differentiate spike-field coherence patterns between two cognitive or behavioral states (e.g., attend vs. ignore, or rest vs. run). A primary advantage of using gedCFC for spike-field coherence is that traditional spike-field coherence analyses can detect only phase-locked activity; gedCFC will additionally detect non-phase-locked responses, such as a spike-locked burst of non-phase-locked gamma.</p></sec><sec id="s3-6"><title>Further advances</title><p>GED is a powerful technique, but it is not the only source-separation method. Many other components-based and dimensionality-reduction-based methods exist, including iterative and nonlinear algorithms (<xref ref-type="bibr" rid="bib36">Jutten and Karhunen, 2004</xref>). For example, phase-amplitude coupling can be identified using parallel factor analysis or tensor decomposition (<xref ref-type="bibr" rid="bib62">van der Meij et al., 2012</xref>). A primary difference between gedCFC and such techniques is that gedCFC is a hypothesis-driven approach, whereas other techniques are blind decomposition methods that are well-suited for exploratory analyses. Another important advantage of gedCFC is that it is straight-forward both conceptually and in implementation, and therefore it will facilitate analyses for researchers with diverse backgrounds and expertise in mathematics and programming. Furthermore, linear methods tend to produce robust and easily interpretable results (<xref ref-type="bibr" rid="bib50">Parra et al., 2005</xref>). Nonetheless, the goal of this paper was not to argue that gedCFC is the only source-separation algorithm applicable to CFC. Instead, the goal was to highlight the significant insights into the neural mechanisms and the implications of CFC that can be gained by expanding the repertoire of data analyses, as well as theoretical conceptualizations, from a single-electrode-sinusoid-based framework to a multivariate-components-based framework.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Simulated EEG data</title><p>Simulated EEG data were created by generating time series in 2,004 dipoles in the brain according to different assumptions of CFC dynamics as described in the Results, and then projecting those activities to virtual scalp electrodes. Random data were generated by taking the inverse Fourier transform of random complex numbers sampled from a uniform distribution. A 1/f shape was imposed by tapering the spectrum by a sigmoidal curve and then concatenating a mirrored version of the tapered spectrum to produce the negative frequencies. This procedure was done separately for each voxel, thereby producing 2,004 uncorrelated dipoles.</p><p>Next, cross-voxel correlations were imposed across all dipoles by creating a random dipole-to-dipole correlation matrix with a maximum correlation of .8, and computing the new data as <bold>Y = X<sup>T</sup>VD<sup>½</sup></bold>, where <bold>V</bold> and <bold>D</bold> are matrices of eigenvectors and eigenvalues of the correlation matrix, <bold><sup>½</sup></bold> indicates the square root, and <bold>X</bold> is the data matrix. Finally, time series data from selected dipoles were replaced with sinusoid-like time series in the theta or gamma bands, as described in the Results section.</p><p>Dipole locations were based on a standard MRI brain. The forward model to project three cardinal directions at each dipole location to the scalp EEG channels was created using algorithms developed by openmeeg (<xref ref-type="bibr" rid="bib24">Gramfort et al., 2010</xref>) and implemented in the Brainstorm toolbox in MATLAB (<xref ref-type="bibr" rid="bib58">Tadel et al., 2011</xref>). MATLAB code to generate the simulations, and to apply all five methods, can be found online (mikexcohen.com/data).</p></sec><sec id="s4-2"><title>Empirical datasets</title><p>The following text is copied verbatim from the Human Connectome Project, as requested: MEG data in <xref ref-type="fig" rid="fig2">Figure 2</xref> ‘were provided by the Human Connectome Project, WU-Minn Consortium (Principal Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH Institutes and Centers that support the NIH Blueprint for Neuroscience Research; and by the McDonnell Center for Systems Neuroscience at Washington University.’ The dataset used here was resting-state data from subject 104012_MEG, session 3.</p><p>EEG data in <xref ref-type="fig" rid="fig4">Figure 4</xref> were from a single subject randomly selected from Cohen and van Gaal (<xref ref-type="bibr" rid="bib9">Cohen and van Gaal, 2013</xref>). The human intracranial EEG data in <xref ref-type="fig" rid="fig6">Figure 6</xref> were taken from 200 s of resting-state data recorded in a patient with epilepsy, who had electrodes implanted as part of presurgical mapping. Data were acquired from the Department of Epileptology at the University Hospital of Bonn, and informed consent was acquired for the recording.</p><p>Rodent LFP and single-unit recording data were downloaded from crcns.org. The appropriate references and dataset identifiers are cited in the Results section.</p></sec><sec id="s4-3"><title>Visualizing gedCFC components</title><p>The topographical projections of the components were obtained from columns of the inverse of the transpose of the eigenvectors matrix (<xref ref-type="bibr" rid="bib27">Haufe et al., 2014</xref>). For the MEG data, projections to the brain were computed using a procedure described in <xref ref-type="bibr" rid="bib30">Hild and Nagarajan (2007</xref>), and adapted by <xref ref-type="bibr" rid="bib8">Cohen and Gulbinaite, 2016</xref>. The forward model for this subject was computed using the Brainstorm toolbox. Brain voxels with values lower than the median value across all 15,002 voxels were not colored.</p></sec><sec id="s4-4"><title>Sign-flipping of components</title><p>One issue that arises in eigenvector-based components analysis is that the sign of a vector is often not meaningful — the eigenvector points along a dimension, and stretching, compressing, or flipping the sign of the vector does not change the dimension. When extracting power, the sign of the time-domain signal is irrelevant. For topographical projections, the sign also doesn’t matter, although for visual clarity, the sign was adjusted so that the electrode with the largest magnitude was forced to be positive (this is a common procedure in principal components analysis).</p><p>However, identifying ‘peaks’ vs. ‘troughs’ clearly requires the correct sign. The solution used here was to correlate the low-frequency GED-based component with the bandpass filtered data at the electrode with the maximal topographical projection. If the correlation coefficient had a negative sign, the sign of the low-frequency component was flipped. This solution is not guaranteed to produce the correct answer, particularly with noisy data. If the interpretation of ‘peak’ vs. ‘trough’ is crucial, it is advisable to run gedCFC separately for peaks and for troughs.</p></sec><sec id="s4-5"><title>Narrowband temporal filtering</title><p>Temporal filtering was done by circular convolution. The Fourier transform of the data was computed using the MATLAB function fft, and was pointwise multiplied by a frequency-domain Gaussian, defined as <italic>exp(−0.5[x/s]<sup>2</sup>)</italic>, where <italic>exp</italic> indicates the natural exponential, <italic>x</italic> is a vector of frequencies shifted such that the desired peak frequency of the filter corresponds to 0, and <italic>s</italic> is <italic>σ(2π−1)/(4π)</italic>, where <italic>σ</italic> is the full width at half maximum of the filter, specified in Hz. This filter is advantageous over equivalently narrow FIR or IIR filters because it contains fewer parameters and has no sharp edges in the frequency domain, and therefore does not require careful inspection of the filter kernel’s temporal and spectral response profiles. The inverse Fourier transform was then applied to the tapered frequency domain signal to get back to the time domain. When power time series were required, the Hilbert transform was applied and its magnitude was taken. MATLAB code to implement this filter is provided with the online code.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The author declares that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>MXC, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article, Contributed unpublished essential data or reagents</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following previously published datasets were used:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="https://crcns.org/data-sets/hc/hc-3/about-hc-3" source-id-type="uri"><collab>Mizuseki K</collab><x>,</x> <collab>Sirota A</collab><x>,</x> <collab>Pastalkova E</collab><x>,</x> <collab>Diba K</collab><x>,</x> <collab>Buzsáki G</collab><x>,</x> <year>2016</year><x>,</x><source>hc-3</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="https://crcns.org/data-sets/hc/hc-3/about-hc-3">https://crcns.org/data-sets/hc/hc-3/about-hc-3</ext-link><x>,</x> <comment>Publicly available at CRCNS - Collaborative Research in Computational Neuroscience</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro2" source-id="https://crcns.org/data-sets/pfc/pfc-2/about-pfc-2" source-id-type="uri"><collab>Fujisawa S</collab><x>,</x> <collab>Amarasingham A</collab><x>,</x> <collab>Harrison MT</collab><x>,</x> <collab>Peyrache A</collab><x>,</x> <collab>Buzsáki G</collab><x>,</x> <year>2016</year> <x>,</x><source>pfc-2</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="https://crcns.org/data-sets/pfc/pfc-2/about-pfc-2">https://crcns.org/data-sets/pfc/pfc-2/about-pfc-2</ext-link><x>,</x> <comment>Publicly available at CRCNS - Collaborative Research in Computational Neuroscience</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro3" source-id="https://db.humanconnectome.org/app/action/DisplayItemAction/search_value/ConnectomeDB_E10375/search_element/xnat:megSessionData/search_field/xnat:megSessionData.ID/" source-id-type="uri"><collab>Essen DV</collab><x>,</x> <collab>Ugurbil K</collab><x>,</x> <year>2016</year><x>,</x><source>MEG resting-state</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="https://db.humanconnectome.org/app/action/DisplayItemAction/search_value/ConnectomeDB_E10375/search_element/xnat:megSessionData/search_field/xnat:megSessionData.ID/">https://db.humanconnectome.org/app/action/DisplayItemAction/search_value/ConnectomeDB_E10375/search_element/xnat:megSessionData/search_field/xnat:megSessionData.ID/</ext-link><x>,</x> <comment>Publicly available at Human Connectome (http://www.humanconnectome.org/about/project/resting-MEG.html)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aru</surname><given-names>J</given-names></name><name><surname>Aru</surname><given-names>J</given-names></name><name><surname>Priesemann</surname><given-names>V</given-names></name><name><surname>Wibral</surname><given-names>M</given-names></name><name><surname>Lana</surname><given-names>L</given-names></name><name><surname>Pipa</surname><given-names>G</given-names></name><name><surname>Singer</surname><given-names>W</given-names></name><name><surname>Vicente</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Untangling cross-frequency coupling in neuroscience</article-title><source>Current Opinion in Neurobiology</source><volume>31</volume><fpage>51</fpage><lpage>61</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.08.002</pub-id><pub-id pub-id-type="pmid">25212583</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Belluscio</surname><given-names>MA</given-names></name><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Schmidt</surname><given-names>R</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cross-frequency phase-phase coupling between θ and γ oscillations in the hippocampus</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>423</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4122-11.2012</pub-id><pub-id pub-id-type="pmid">22238079</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blankertz</surname><given-names>B</given-names></name><name><surname>Tomioka</surname><given-names>R</given-names></name><name><surname>Lemm</surname><given-names>S</given-names></name><name><surname>Kawanabe</surname><given-names>M</given-names></name><name><surname>Muller</surname><given-names>K-robert</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Optimizing spatial filters for Robust EEG Single-Trial analysis</article-title><source>IEEE Signal Processing Magazine</source><volume>25</volume><fpage>41</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1109/MSP.2008.4408441</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunton</surname><given-names>BW</given-names></name><name><surname>Johnson</surname><given-names>LA</given-names></name><name><surname>Ojemann</surname><given-names>JG</given-names></name><name><surname>Kutz</surname><given-names>JN</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Extracting spatial-temporal coherent patterns in large-scale neural recordings using dynamic mode decomposition</article-title><source>Journal of Neuroscience Methods</source><volume>258</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2015.10.010</pub-id><pub-id pub-id-type="pmid">26529367</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canolty</surname><given-names>RT</given-names></name><name><surname>Cadieu</surname><given-names>CF</given-names></name><name><surname>Koepsell</surname><given-names>K</given-names></name><name><surname>Knight</surname><given-names>RT</given-names></name><name><surname>Carmena</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Multivariate phase-amplitude cross-frequency coupling in neurophysiological signals</article-title><source>IEEE Transactions on Biomedical Engineering</source><volume>59</volume><fpage>8</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1109/TBME.2011.2172439</pub-id><pub-id pub-id-type="pmid">22020662</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canolty</surname><given-names>RT</given-names></name><name><surname>Knight</surname><given-names>RT</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The functional role of cross-frequency coupling</article-title><source>Trends in Cognitive Sciences</source><volume>14</volume><fpage>506</fpage><lpage>515</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2010.09.001</pub-id><pub-id pub-id-type="pmid">20932795</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Practical method for determining the minimum embedding dimension of a scalar time series</article-title><source>Physica D: Nonlinear Phenomena</source><volume>110</volume><fpage>43</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1016/S0167-2789(97)00118-8</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>MX</given-names></name><name><surname>Gulbinaite</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Rhythmic entrainment source separation: Optimizing analyses of neural responses to rhythmic sensory stimulation</article-title><source>NeuroImage</source><volume>147</volume><fpage>43</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.11.036</pub-id><pub-id pub-id-type="pmid">27916666</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>MX</given-names></name><name><surname>van Gaal</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dynamic interactions between large-scale brain networks predict behavioral adaptation after perceptual errors</article-title><source>Cerebral Cortex</source><volume>23</volume><fpage>1061</fpage><lpage>1072</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhs069</pub-id><pub-id pub-id-type="pmid">22514250</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>MX</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>Analyzing Neural Time Series Data: Theory and Practice</source><publisher-loc>Cambridge, Massachusetts</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>MX</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Comparison of linear spatial filters for identifying oscillatory activity in multichannel data</article-title><source>Journal of Neuroscience Methods</source><volume>278</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2016.12.016</pub-id><pub-id pub-id-type="pmid">28034726</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dimensionality reduction for large-scale neural recordings</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1500</fpage><lpage>1509</lpage><pub-id pub-id-type="doi">10.1038/nn.3776</pub-id><pub-id pub-id-type="pmid">25151264</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daniels</surname><given-names>MJ</given-names></name><name><surname>Kass</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Shrinkage estimators for covariance matrices</article-title><source>Biometrics</source><volume>57</volume><fpage>1173</fpage><lpage>1184</lpage><pub-id pub-id-type="doi">10.1111/j.0006-341X.2001.01173.x</pub-id><pub-id pub-id-type="pmid">11764258</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Cheveigné</surname><given-names>A</given-names></name><name><surname>Arzounian</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Scanning for oscillations</article-title><source>Journal of Neural Engineering</source><volume>12</volume><elocation-id>066020</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/12/6/066020</pub-id><pub-id pub-id-type="pmid">26501393</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Cheveigné</surname><given-names>A</given-names></name><name><surname>Parra</surname><given-names>LC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Joint decorrelation, a versatile tool for multichannel data analysis</article-title><source>NeuroImage</source><volume>98</volume><fpage>487</fpage><lpage>505</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.05.068</pub-id><pub-id pub-id-type="pmid">24990357</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Cheveigné</surname><given-names>A</given-names></name><name><surname>Simon</surname><given-names>JZ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Denoising based on time-shift PCA</article-title><source>Journal of Neuroscience Methods</source><volume>165</volume><fpage>297</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2007.06.003</pub-id><pub-id pub-id-type="pmid">17624443</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Cheveigné</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Time-shift denoising source separation</article-title><source>Journal of Neuroscience Methods</source><volume>189</volume><fpage>113</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2010.03.002</pub-id><pub-id pub-id-type="pmid">20298717</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delorme</surname><given-names>A</given-names></name><name><surname>Palmer</surname><given-names>J</given-names></name><name><surname>Onton</surname><given-names>J</given-names></name><name><surname>Oostenveld</surname><given-names>R</given-names></name><name><surname>Makeig</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Independent EEG sources are dipolar</article-title><source>PLoS One</source><volume>7</volume><elocation-id>e30135</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0030135</pub-id><pub-id pub-id-type="pmid">22355308</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diba</surname><given-names>K</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hippocampal network dynamics constrain the time lag between pyramidal cells across modified environments</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>13448</fpage><lpage>13456</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3824-08.2008</pub-id><pub-id pub-id-type="pmid">19074018</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fell</surname><given-names>J</given-names></name><name><surname>Axmacher</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The role of phase synchronization in memory processes</article-title><source>Nature Reviews Neuroscience</source><volume>12</volume><fpage>105</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1038/nrn2979</pub-id><pub-id pub-id-type="pmid">21248789</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujisawa</surname><given-names>S</given-names></name><name><surname>Amarasingham</surname><given-names>A</given-names></name><name><surname>Harrison</surname><given-names>MT</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Behavior-dependent short-term assembly dynamics in the medial prefrontal cortex</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>823</fpage><lpage>833</lpage><pub-id pub-id-type="doi">10.1038/nn.2134</pub-id><pub-id pub-id-type="pmid">18516033</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Fujisawa</surname><given-names>S</given-names></name><name><surname>Amarasingham</surname><given-names>A</given-names></name><name><surname>Harrison</surname><given-names>MT</given-names></name><name><surname>Peyrache</surname><given-names>A</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>Simultaneous Electrophysiological Recordings of Ensembles of Isolated Neurons in Rat Medial Prefrontal Cortex and Intermediate CA1 Area of the Hippocampus During a Working Memory Task</data-title><source>Collaborative Research in Computational Neuroscience</source></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujisawa</surname><given-names>S</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A 4 Hz oscillation adaptively synchronizes prefrontal, VTA, and hippocampal activities</article-title><source>Neuron</source><volume>72</volume><fpage>153</fpage><lpage>165</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.08.018</pub-id><pub-id pub-id-type="pmid">21982376</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Papadopoulo</surname><given-names>T</given-names></name><name><surname>Olivi</surname><given-names>E</given-names></name><name><surname>Clerc</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>OpenMEEG: opensource software for quasistatic bioelectromagnetics</article-title><source>BioMedical Engineering OnLine</source><volume>9</volume><elocation-id>45</elocation-id><pub-id pub-id-type="doi">10.1186/1475-925X-9-45</pub-id><pub-id pub-id-type="pmid">20819204</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grootswagers</surname><given-names>T</given-names></name><name><surname>Wardle</surname><given-names>SG</given-names></name><name><surname>Carlson</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Decoding Dynamic Brain Patterns from Evoked Responses: A Tutorial on Multivariate Pattern Analysis Applied to Time Series Neuroimaging Data</article-title><source>Journal of Cognitive Neuroscience</source><volume>57</volume><fpage>1</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1162/jocn_a_01068</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haegens</surname><given-names>S</given-names></name><name><surname>Cousijn</surname><given-names>H</given-names></name><name><surname>Wallis</surname><given-names>G</given-names></name><name><surname>Harrison</surname><given-names>PJ</given-names></name><name><surname>Nobre</surname><given-names>AC</given-names></name><name><surname>Saskia</surname><given-names>H</given-names></name><name><surname>Helena</surname><given-names>C</given-names></name><name><surname>George</surname><given-names>W</given-names></name><name><surname>Nobre</surname><given-names>AC</given-names></name><name><surname>Nobre</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Inter- and intra-individual variability in alpha peak frequency</article-title><source>NeuroImage</source><volume>92</volume><fpage>46</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.01.049</pub-id><pub-id pub-id-type="pmid">24508648</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haufe</surname><given-names>S</given-names></name><name><surname>Meinecke</surname><given-names>F</given-names></name><name><surname>Görgen</surname><given-names>K</given-names></name><name><surname>Dähne</surname><given-names>S</given-names></name><name><surname>Haynes</surname><given-names>JD</given-names></name><name><surname>Blankertz</surname><given-names>B</given-names></name><name><surname>Bießmann</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>On the interpretation of weight vectors of linear models in multivariate neuroimaging</article-title><source>NeuroImage</source><volume>87</volume><fpage>96</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.10.067</pub-id><pub-id pub-id-type="pmid">24239590</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>BJ</given-names></name><name><surname>Zempel</surname><given-names>JM</given-names></name><name><surname>Snyder</surname><given-names>AZ</given-names></name><name><surname>Raichle</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The temporal structures and functional significance of scale-free brain activity</article-title><source>Neuron</source><volume>66</volume><fpage>353</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.04.020</pub-id><pub-id pub-id-type="pmid">20471349</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heusser</surname><given-names>AC</given-names></name><name><surname>Poeppel</surname><given-names>D</given-names></name><name><surname>Ezzyat</surname><given-names>Y</given-names></name><name><surname>Davachi</surname><given-names>L</given-names></name><name><surname>David</surname><given-names>P</given-names></name><name><surname>Youssef</surname><given-names>E</given-names></name><name><surname>Lila</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Episodic sequence memory is supported by a theta-gamma phase code</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>1374</fpage><lpage>1380</lpage><pub-id pub-id-type="doi">10.1038/nn.4374</pub-id><pub-id pub-id-type="pmid">27571010</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Hild</surname><given-names>KE</given-names></name><name><surname>Nagarajan</surname><given-names>SS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Source localization of EEG/MEG Data by Correlating Columns of ICA Solution with Lead Field Matrix</article-title><conf-name>2007 IEEE International Conference On Acoustics Speech and Signal Processing - ICASSP’ 07</conf-name><pub-id pub-id-type="doi">10.1109/icassp.2007.367285</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyafil</surname><given-names>A</given-names></name><name><surname>Giraud</surname><given-names>AL</given-names></name><name><surname>Fontolan</surname><given-names>L</given-names></name><name><surname>Gutkin</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neural Cross-Frequency coupling: Connecting architectures, Mechanisms, and Functions</article-title><source>Trends in Neurosciences</source><volume>38</volume><fpage>725</fpage><lpage>740</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2015.09.001</pub-id><pub-id pub-id-type="pmid">26549886</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyafil</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Misidentifications of specific forms of cross-frequency coupling: three warnings</article-title><source>Frontiers in Neuroscience</source><volume>9</volume><elocation-id>370</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2015.00370</pub-id><pub-id pub-id-type="pmid">26500488</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>O</given-names></name><name><surname>Colgin</surname><given-names>LL</given-names></name><name><surname>Ole</surname><given-names>J</given-names></name><name><surname>Colgin</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Cross-frequency coupling between neuronal oscillations</article-title><source>Trends in Cognitive Sciences</source><volume>11</volume><fpage>267</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2007.05.003</pub-id><pub-id pub-id-type="pmid">17548233</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jirsa</surname><given-names>V</given-names></name><name><surname>Müller</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cross-frequency coupling in real and virtual brain networks</article-title><source>Frontiers in Computational Neuroscience</source><volume>7</volume><elocation-id>78</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2013.00078</pub-id><pub-id pub-id-type="pmid">23840188</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>When brain rhythms aren't 'rhythmic': implication for their mechanisms and meaning</article-title><source>Current Opinion in Neurobiology</source><volume>40</volume><fpage>72</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.06.010</pub-id><pub-id pub-id-type="pmid">27400290</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jutten</surname><given-names>C</given-names></name><name><surname>Karhunen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Advances in blind source separation (BSS) and independent component analysis (ICA) for nonlinear mixtures</article-title><source>International Journal of Neural Systems</source><volume>14</volume><fpage>267</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1142/S012906570400208X</pub-id><pub-id pub-id-type="pmid">15593377</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kramer</surname><given-names>MA</given-names></name><name><surname>Tort</surname><given-names>AB</given-names></name><name><surname>Kopell</surname><given-names>NJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Sharp edge artifacts and spurious coupling in EEG frequency comodulation measures</article-title><source>Journal of Neuroscience Methods</source><volume>170</volume><fpage>352</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2008.01.020</pub-id><pub-id pub-id-type="pmid">18328571</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lainscsek</surname><given-names>C</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Delay differential analysis of time series</article-title><source>Neural Computation</source><volume>27</volume><fpage>594</fpage><lpage>614</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00706</pub-id><pub-id pub-id-type="pmid">25602777</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lisman</surname><given-names>JE</given-names></name><name><surname>Jensen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The θ-γ neural code</article-title><source>Neuron</source><volume>77</volume><fpage>1002</fpage><lpage>1016</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.03.007</pub-id><pub-id pub-id-type="pmid">23522038</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lozano-Soldevilla</surname><given-names>D</given-names></name><name><surname>Ter Huurne</surname><given-names>N</given-names></name><name><surname>Oostenveld</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neuronal oscillations with non-sinusoidal morphology produce spurious phase-to-amplitude coupling and directionality</article-title><source>Frontiers in Computational Neuroscience</source><volume>10</volume><elocation-id>87</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2016.00087</pub-id><pub-id pub-id-type="pmid">27597822</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maris</surname><given-names>E</given-names></name><name><surname>Oostenveld</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Nonparametric statistical testing of EEG- and MEG-data</article-title><source>Journal of Neuroscience Methods</source><volume>164</volume><fpage>177</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2007.03.024</pub-id><pub-id pub-id-type="pmid">17517438</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maus</surname><given-names>A</given-names></name><name><surname>Sprott</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Neural network method for determining embedding dimension of a time series</article-title><source>Communications in Nonlinear Science and Numerical Simulation</source><volume>16</volume><fpage>3294</fpage><lpage>3302</lpage><pub-id pub-id-type="doi">10.1016/j.cnsns.2010.10.030</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazaheri</surname><given-names>A</given-names></name><name><surname>Jensen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Asymmetric amplitude modulations of brain oscillations generate slow evoked responses</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>7781</fpage><lpage>7787</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1631-08.2008</pub-id><pub-id pub-id-type="pmid">18667610</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Mizuseki</surname><given-names>K</given-names></name><name><surname>Sirota</surname><given-names>A</given-names></name><name><surname>Pastalkova</surname><given-names>E</given-names></name><name><surname>Diba</surname><given-names>K</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><data-title>Multiple single unit recordings from different rat hippocampal and entorhinal regions while the animals were performing multiple behavioral tasks</data-title><source>Collaborative Research in Computational Neuroscience</source></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nikulin</surname><given-names>VV</given-names></name><name><surname>Nolte</surname><given-names>G</given-names></name><name><surname>Curio</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A novel method for reliable and fast extraction of neuronal EEG/MEG oscillations on the basis of spatio-spectral decomposition</article-title><source>NeuroImage</source><volume>55</volume><fpage>1528</fpage><lpage>1535</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.01.057</pub-id><pub-id pub-id-type="pmid">21276858</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Onton</surname><given-names>J</given-names></name><name><surname>Westerfield</surname><given-names>M</given-names></name><name><surname>Townsend</surname><given-names>J</given-names></name><name><surname>Makeig</surname><given-names>S</given-names></name><name><surname>Julie</surname><given-names>O</given-names></name><name><surname>Marissa</surname><given-names>W</given-names></name><name><surname>Jeanne</surname><given-names>T</given-names></name><name><surname>Scott</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Imaging human EEG dynamics using independent component analysis</article-title><source>Neuroscience &amp; Biobehavioral Reviews</source><volume>30</volume><fpage>808</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1016/j.neubiorev.2006.06.007</pub-id><pub-id pub-id-type="pmid">16904745</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orekhova</surname><given-names>EV</given-names></name><name><surname>Elam</surname><given-names>M</given-names></name><name><surname>Orekhov</surname><given-names>VY</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Unraveling superimposed EEG rhythms with multi-dimensional decomposition</article-title><source>Journal of Neuroscience Methods</source><volume>195</volume><fpage>47</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2010.11.010</pub-id><pub-id pub-id-type="pmid">21115046</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Osipova</surname><given-names>D</given-names></name><name><surname>Hermes</surname><given-names>D</given-names></name><name><surname>Jensen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Gamma power is phase-locked to posterior alpha activity</article-title><source>PLoS One</source><volume>3</volume><elocation-id>e3990</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0003990</pub-id><pub-id pub-id-type="pmid">19098986</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parra</surname><given-names>L</given-names></name><name><surname>Sajda</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Blind source separation via generalized eigenvalue decomposition</article-title><source>Journal of Machine Learning Research</source><volume>4</volume><fpage>1261</fpage><lpage>1269</lpage></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parra</surname><given-names>LC</given-names></name><name><surname>Spence</surname><given-names>CD</given-names></name><name><surname>Gerson</surname><given-names>AD</given-names></name><name><surname>Sajda</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Recipes for the linear analysis of EEG</article-title><source>NeuroImage</source><volume>28</volume><fpage>326</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2005.05.032</pub-id><pub-id pub-id-type="pmid">16084117</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pittman-Polletta</surname><given-names>B</given-names></name><name><surname>Hsieh</surname><given-names>WH</given-names></name><name><surname>Kaur</surname><given-names>S</given-names></name><name><surname>Lo</surname><given-names>MT</given-names></name><name><surname>Hu</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Detecting phase-amplitude coupling with high frequency resolution using adaptive decompositions</article-title><source>Journal of Neuroscience Methods</source><volume>226</volume><fpage>15</fpage><lpage>32</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2014.01.006</pub-id><pub-id pub-id-type="pmid">24452055</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Preston</surname><given-names>AR</given-names></name><name><surname>Eichenbaum</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Interplay of hippocampus and prefrontal cortex in memory</article-title><source>Current Biology</source><volume>23</volume><fpage>R764</fpage><lpage>R773</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.05.041</pub-id><pub-id pub-id-type="pmid">24028960</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ray</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Challenges in the quantification and interpretation of spike-LFP relationships</article-title><source>Current Opinion in Neurobiology</source><volume>31</volume><fpage>111</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.09.004</pub-id><pub-id pub-id-type="pmid">25282542</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>JD</given-names></name><name><surname>Jadhav</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multiple modes of hippocampal-prefrontal interactions in memory-guided behavior</article-title><source>Current Opinion in Neurobiology</source><volume>40</volume><fpage>161</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.07.015</pub-id><pub-id pub-id-type="pmid">27543753</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soto</surname><given-names>JL</given-names></name><name><surname>Lachaux</surname><given-names>JP</given-names></name><name><surname>Baillet</surname><given-names>S</given-names></name><name><surname>Jerbi</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A multivariate method for estimating cross-frequency neuronal interactions and correcting linear mixing in MEG data, using canonical correlations</article-title><source>Journal of Neuroscience Methods</source><volume>271</volume><fpage>169</fpage><lpage>181</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2016.07.017</pub-id><pub-id pub-id-type="pmid">27468679</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevenson</surname><given-names>IH</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>How advances in neural recording affect data analysis</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>139</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1038/nn.2731</pub-id><pub-id pub-id-type="pmid">21270781</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Särelä</surname> <given-names>J</given-names></name><name><surname>Valpola</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Denoising source separation</article-title><source>Journal of Machine Learning Research</source><volume>6</volume><fpage>233</fpage><lpage>272</lpage></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tadel</surname><given-names>F</given-names></name><name><surname>Baillet</surname><given-names>S</given-names></name><name><surname>Mosher</surname><given-names>JC</given-names></name><name><surname>Pantazis</surname><given-names>D</given-names></name><name><surname>Leahy</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Brainstorm: a user-friendly application for MEG/EEG analysis</article-title><source>Computational Intelligence and Neuroscience</source><volume>2011</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1155/2011/879716</pub-id><pub-id pub-id-type="pmid">21584256</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Tome</surname><given-names>AM</given-names></name><name><surname>Teixeira</surname><given-names>AR</given-names></name><name><surname>Lang</surname><given-names>EW</given-names></name><name><surname>Stadlthanner</surname><given-names>K</given-names></name><name><surname>Rocha</surname><given-names>AP</given-names></name><name><surname>Almeida</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Blind source separation using time-delayed signals</article-title><conf-name>IEEE International Joint Conference on Neural Networks (IJCNN)</conf-name><publisher-name>Proceedings of international conferences</publisher-name><fpage>2187</fpage><lpage>2191</lpage></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tomé</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The generalized eigendecomposition approach to the blind source separation problem</article-title><source>Digital Signal Processing</source><volume>16</volume><fpage>288</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1016/j.dsp.2005.06.002</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tort</surname><given-names>AB</given-names></name><name><surname>Komorowski</surname><given-names>R</given-names></name><name><surname>Eichenbaum</surname><given-names>H</given-names></name><name><surname>Kopell</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Measuring phase-amplitude coupling between neuronal oscillations of different frequencies</article-title><source>Journal of Neurophysiology</source><volume>104</volume><fpage>1195</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1152/jn.00106.2010</pub-id><pub-id pub-id-type="pmid">20463205</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Meij</surname><given-names>R</given-names></name><name><surname>Kahana</surname><given-names>M</given-names></name><name><surname>Maris</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Phase-amplitude coupling in human electrocorticography is spatially distributed and phase diverse</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>111</fpage><lpage>123</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4816-11.2012</pub-id><pub-id pub-id-type="pmid">22219274</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Meij</surname><given-names>R</given-names></name><name><surname>van Ede</surname><given-names>F</given-names></name><name><surname>Maris</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Rhythmic components in extracranial brain signals reveal multifaceted task modulation of overlapping neuronal activity</article-title><source>PLoS One</source><volume>11</volume><elocation-id>e0154881</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0154881</pub-id><pub-id pub-id-type="pmid">27336159</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Driel</surname><given-names>J</given-names></name><name><surname>Cox</surname><given-names>R</given-names></name><name><surname>Cohen</surname><given-names>MX</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Phase-clustering bias in phase-amplitude cross-frequency coupling and its removal</article-title><source>Journal of Neuroscience Methods</source><volume>254</volume><fpage>60</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2015.07.014</pub-id><pub-id pub-id-type="pmid">26231622</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Ede</surname><given-names>F</given-names></name><name><surname>Maris</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Physiological plausibility can increase reproducibility in cognitive neuroscience</article-title><source>Trends in Cognitive Sciences</source><volume>20</volume><fpage>567</fpage><lpage>569</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2016.05.006</pub-id><pub-id pub-id-type="pmid">27233147</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Essen</surname><given-names>DC</given-names></name><name><surname>Smith</surname><given-names>SM</given-names></name><name><surname>Barch</surname><given-names>DM</given-names></name><name><surname>Behrens</surname><given-names>TE</given-names></name><name><surname>Yacoub</surname><given-names>E</given-names></name><name><surname>Ugurbil</surname><given-names>K</given-names></name><name><surname>Consortium</surname><given-names>WU-MHCP</given-names></name><collab>WU-Minn HCP Consortium</collab></person-group><year iso-8601-date="2013">2013</year><article-title>The WU-Minn human connectome project: an overview</article-title><source>NeuroImage</source><volume>80</volume><fpage>62</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.05.041</pub-id><pub-id pub-id-type="pmid">23684880</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von Oertzen</surname><given-names>T</given-names></name><name><surname>Boker</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Time delay embedding increases estimation precision of models of intraindividual variability</article-title><source>Psychometrika</source><volume>75</volume><fpage>158</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1007/s11336-009-9137-9</pub-id><pub-id pub-id-type="pmid">23335820</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voytek</surname><given-names>B</given-names></name><name><surname>D'Esposito</surname><given-names>M</given-names></name><name><surname>Crone</surname><given-names>N</given-names></name><name><surname>Knight</surname><given-names>RT</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A method for event-related phase/amplitude coupling</article-title><source>NeuroImage</source><volume>64</volume><fpage>416</fpage><lpage>424</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.09.023</pub-id><pub-id pub-id-type="pmid">22986076</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walsh</surname><given-names>EG</given-names></name></person-group><year iso-8601-date="1958">1958</year><article-title>Autonomy of alpha rhythm generators studied by multiple channel cross-correlation</article-title><source>Electroencephalography and Clinical Neurophysiology</source><volume>10</volume><fpage>121</fpage><lpage>130</lpage><pub-id pub-id-type="doi">10.1016/0013-4694(58)90109-3</pub-id><pub-id pub-id-type="pmid">13512224</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zanos</surname><given-names>TP</given-names></name><name><surname>Mineault</surname><given-names>PJ</given-names></name><name><surname>Pack</surname><given-names>CC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Removal of spurious correlations between spikes and local field potentials</article-title><source>Journal of Neurophysiology</source><volume>105</volume><fpage>474</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1152/jn.00642.2010</pub-id><pub-id pub-id-type="pmid">21068271</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>C</given-names></name><name><surname>Bieri</surname><given-names>KW</given-names></name><name><surname>Hsiao</surname><given-names>YT</given-names></name><name><surname>Colgin</surname><given-names>LL</given-names></name><name><surname>Chenguang</surname><given-names>Z</given-names></name><name><surname>Yi-Tse</surname><given-names>H</given-names></name><name><surname>Colgin</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatial sequence coding differs during slow and fast Gamma Rhythms in the Hippocampus</article-title><source>Neuron</source><volume>89</volume><fpage>398</fpage><lpage>408</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.12.005</pub-id><pub-id pub-id-type="pmid">26774162</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.21792.025</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Davachi</surname><given-names>Lila</given-names></name><role>Reviewing editor</role><aff id="aff3"><institution>New York University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Multivariate cross-frequency coupling via generalized eigendecomposition&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and David Van Essen as the Senior Editor. The following individual involved in review of your submission has agreed to reveal his identity: Christopher J Honey (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>The paper nicely addresses an alternative method to measuring cross-frequency coupling, namely using a multivariate-components-based framework. The paper notes a number of challenges for existing analytic approaches and proposes and examines a new analytic framework named generalized eigendecomposition CFC (gedCFC).</p><p>The reviewers all agreed that the basics of the paper are novel, important and sound. However, they also all agreed that the paper was in need of an extensive rewriting coupled with some additional analyses to bring this to a level appropriate for <italic>eLife</italic> readership. Although we typically at <italic>eLife</italic> will provide a condensed list of essential revisions, in this case, I am appending the actual reviews below because they all nicely describe the needed changes.</p><p><italic>Reviewer #1:</italic> </p><p>This paper reports results of various methods of applying generalized eigendecomposition to perform cross-frequency correlation analysis. The discussion in the Introduction seems to be too cursory to be of much benefit to those not already familiar with the idea, so depending on the purpose and target audience, some elaboration may be warranted.</p><p>There seems to be an error in the statement of the equation: SW = LRW (where L stands for Λ) – I think SW = RWL is meant.</p><p>I would humbly suggest giving an intuitive illustrative example in the Introduction to demonstrate the &quot;maximization and minimization&quot; effect referred to, perhaps using the Rayleigh coefficient framework.</p><p>The Discussion seems to be somewhat lacking in structure. It may be helpful to move some of the discussion in the corresponding Methods sections to the general Discussion section. The identification of different methods is interesting, but it would be nice to have a prior list of &quot;general CFC contexts&quot; in the Introduction, in which one would like to apply the GED framework, perhaps with simple examples of each case, then the methods description referring to the corresponding contexts, focusing on detailed description of the simulation/data used and method employed, followed by a more general discussion in the Discussion section.</p><p>I believe the paper could benefit from a quantitative report of the resulting covariances obtained with the covariance matrices, e.g. the theta and gamma template vectors with each of the two covariance matrices used in the method, as well as the generalized eigenvalue. And it would be of use to know the relative power in the high and low frequency bands used in the simulations, with some corresponding discussion of minimal relative power necessary e.g. gamma, to obtain interpretable results, and the applicability of the required power levels assumptions to real data, e.g. EEG.</p><p>The paper is likely to be useful for specialists working in the area, but if a wider audience is intended, a more generous introductory section and structured Discussion section would be helpful.</p><p><italic>Reviewer #2:</italic> </p><p>The goal of this paper is &quot;to highlight that significant insights into the neural mechanisms and implications of CFC can be gained by expanding the repertoire of data analyses, as well as theoretical conceptualizations, from a single-electrode-sinusoid-based framework to a multivariate-components-based framework.&quot; The author notes a number of challenges for existing CFC approaches include non-stationarities and sharp transients in signal, non-uniform phase distributions, and the fact that CFC sources and targets are spatially distributed and potentially overlapping. To address these challenges they propose a new analytic framework named generalized eigendecomposition CFC (gedCFC). Although the method proposed is very promising, the manuscript reads more like a proof of principle than a convincing demonstration. This is not because the framework is flawed, but because the range of applications discussed (5 different settings) leads to a lack of focus, and so the strengths and weaknesses of the framework are not clearly enough tested and reported within each setting.</p><p>1) The paper describes five methods for characterizing changes in spatiotemporal properties of brain data, using a common linear algebraic formalism. On the one hand, the range of methods is valuable because CFC measures are applied in a range of contexts to address a range of hypotheses. However, this also means that manuscript lacks conceptual unity and focus. For example, it is not entirely clear which of the 5 methods are solutions to which of the problems (e.g. non-stationarities, sharp transients, non-uniform phase distributions, etc.) with existing CFC methods. I would recommend:i) try to group the 5 methods into clusters with a common purpose (for example Methods 1 and 2 could be grouped), rather than simply using numeric labels;ii) assign names to the different approaches;iii) create a table which summarizes, for each method, the kind of hypothesis it is best suited for testing, which problems it solves, and which problems it does not solve;iv) for each of the claims above concerning the problems solved by gedCFC, please design a test that specifically demonstrates that claim. The manuscript already includes valuable demonstration examples that do perform this function, but it is not always explicitly specified which facet of gedCFC they are meant to test.</p><p>More generally, I found that the readability of the manuscript decreased from Method 3 onward, as more complex methods were introduced. In method 4 delay-coordinate embedding is introduced, just in passing, but this is a complicated and rich area of research. The investigation of how to choose the correct parametrization (e.g. number of time delays) in Method 4 could be a paper of its own. So, again, it is nice to see how the gedCFC framework can be applied, but the range of uses also limits the manuscript's depth and clarity.</p><p>2) Why compare gedCFC against methods, such as PACz, which are (according to the citations in the introduction) known to be flawed? The manuscript would be more compelling if gedCFC was compared against state-of-the-art methods (some of which are mentioned in the Introduction) and/or against the most successful of the methods reviewed in Tort et al. (2010, J Neurophys). In addition, when existing methods fail, it would help to specify precisely why they are failing. For example, it could be that gedCFC has, effectively, greater statistical power when applied to multi-channel data due to pooling of information across multiple electrodes, but it was unclear to me whether this was the core reason for its advantage over PACz.</p><p>3) &quot;This alleviates the feature of principle components analysis that makes it suboptimal for brain data: components are forced to be orthogonal but neural dynamics (certainly at the meso- to macroscopic scale of LFP and EEG) are not orthogonal.&quot;</p><p>It seems unlikely to me that this undesirable feature of PCA – the fact that, e.g., the second eigenvector's direction is constrained by the direction of the first eigenvector – is truly absent from the gedCFC framework. Generally, there is a distinction drawn between (i) dimensionality reduction methods, such as PCA, which rotate data so that it can be compactly re-expressed; and (ii) source separation methods, such as ICA, which aim to identify statistically distinct generators within a mixed signal. Although in many cases PCA does approximate the function of source separation, this is not its goal, and the orthogonality assumption is a testament to the fact that compact expression is prioritized over source separation.</p><p>My (admittedly intuitive) impression is that the gedCFC framework is closer to a dimensionality reduction method than to a source separation method. Specifically, even though the components in gedCFC are not, in general, constrained to be orthogonal, this does not imply that (e.g.) the direction of the eigenvector of second-largest eigenvalue is unaffected by the direction of the eigenvector whose eigenvalue is largest. Consider the special case in which R^(-1)S is indeed symmetric: in this case, the eigenvectors are again constrained to be orthogonal and the well-known PCA problems return. So, should we expect PCA-like difficulties whenever R^(-1)S is near-symmetric? What is our guarantee that these issues do not arise even when R^(-1)S is far from symmetric?</p><p>The manuscript already presents some examples of cases where gedCFC successfully extracts signals from a mixture, but in these cases the mixed signals have different frequencies, so the filtering operations may be doing much of the work. To demonstrate that gedCFC really does not run into the interpretational difficulties seen with PCA, I recommend setting up a situation in which multiple signals (say 3) with similar spatial profiles, similar frequencies, and overlapping functional response profiles, are mixed – a case in which PCA should fail – and then show that gedCFC does not suffer from similar problems.</p><p>4) Because the model works by comparing a reference covariance to a target covariance, it assumes a binary transition between two modes. But how well would the model perform if the underlying generative process is actually changing continuously? For example if the generative model of gamma power is something like probability(gamma burst) ~ phase(theta), then a method that assumes a continuous variation as a function of phase will have far greater statistical power than a method which simply contrasts peak and off-peak data? Now, Method 3 may present an answer this &quot;binary assumption&quot; issue, because a continuous time-varying signal is convolved and included the model. But in this case, does not one not re-encounter the problem of non-stationarity and sharp transients, because now the estimation of the low-frequency envelope matrix, B, could be affected by these factors? Similar to the point I made in (<xref ref-type="bibr" rid="bib1">1</xref>) above, I would like to see a more careful discussion of the strengths and weaknesses of each method, so that the manuscript explicitly describes for each method, which of the common challenges for CFC are overcome, and which are not overcome.</p><p>5) The paper would be more practically useful if it provided a slightly more thorough treatment of at least one of the statistical methods for testing components, and noted briefly any problems that may arise in this setting.</p><p><italic>Reviewer #3:</italic></p><p>This paper describes a novel technique to calculate cross-frequency coupling using generalized eigenvalue decomposition. The technique is novel and has several significant advantages that have currently not been clearly addressed, such as its independence of selecting electrodes and not assuming a sinusoidal shape. Moreover, the technique can be used in several ways (5 methods are described in the paper). The paper is well written; as I was reading it and wrote down questions, a subsequent section would often already provide an answer. Overall, I think the paper is of high quality and I only have a few comments that can be easily addressed.</p><p>1) It is not quite clear to me whether the method assumes that multiple electrodes have the exact same phase for an underlying rhythm. For example, if the method were to be used to analyze LFP recordings across motor cortex, with traveling β oscillations, where there is a shift in phase across electrodes, how would that reflect upon component waves?</p><p>2) It is said that the quality of gedCFC components is related to the quality of the covariance matrices, and a sufficient amount of clean data ensures high-quality covariance matrices. Can this be quantified: is there a way to compute from one of the data sets used in the paper how the amount of data used relates to the quality of the gedCFC components?</p><p>3) In method 3 example recordings from a human epilepsy patient are used with recordings of the medial temporal lobe and electrode Cz. Why would there be any coupling in these data? How does referencing affect the method? More anterior temporal lobe channels are also closer the face with potential muscle artifacts, which may not even be removed with bipolar referencing.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.21792.026</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>[…] Reviewer #1:</italic> </p><p><italic>This paper reports results of various methods of applying generalized eigendecomposition to perform cross-frequency correlation analysis. The discussion in the Introduction seems to be too cursory to be of much benefit to those not already familiar with the idea, so depending on the purpose and target audience, some elaboration may be warranted.</italic> </p><p><italic>There seems to be an error in the statement of the equation: SW = LRW (where L stands for Λ) – I think SW = RWL is meant.</italic> </p><p>Indeed, that was a typo (copied from the initial introduction of a single eigenvalue). Thanks for catching that.</p><p><italic>I would humbly suggest giving an intuitive illustrative example in the Introduction to demonstrate the &quot;maximization and minimization&quot; effect referred to, perhaps using the Rayleigh coefficient framework.</italic> </p><p>I agree that an intuitive example would be useful. However, I would guess that anyone who is familiar with the Rayleigh quotient would also understand GED. I’ve opted for a visual example presented in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, (inspired by <xref ref-type="fig" rid="fig6">Figure 6</xref> in Blankertz et al., 2008) that I hope is more intuitive to readers without a strong mathematical background.</p><p>Furthermore, I added several new supplemental figures that provide graphical illustrations of the methods.</p><p><italic>The Discussion seems to be somewhat lacking in structure. It may be helpful to move some of the discussion in the corresponding Methods sections to the general Discussion section. The identification of different methods is interesting, but it would be nice to have a prior list of &quot;general CFC contexts&quot; in the Introduction, in which one would like to apply the GED framework, perhaps with simple examples of each case, then the methods description referring to the corresponding contexts, focusing on detailed description of the simulation/data used and method employed, followed by a more general discussion in the Discussion section.</italic> </p><p>I have tried to improve the readability and organization of the manuscript, including more discussions of the assumptions and goals of each specific method. The Discussion section is now more focused, and several method-specific points have been incorporated into the relevant Results section. Furthermore, the revision includes a table that summarizes the key goals and assumptions of each method.</p><p><italic>I believe the paper could benefit from a quantitative report of the resulting covariances obtained with the covariance matrices, e.g. the theta and gamma template vectors with each of the two covariance matrices used in the method, as well as the generalized eigenvalue.</italic> </p><p>I’m afraid I don’t completely understand this request. The covariance matrices themselves are not terribly insightful and they are dependent on the location of the simulated dipole, which is arbitrary and not relevant for the method. If the reviewer was referring to the use of GED to obtain within-frequency components (e.g., the theta component to extract theta phase), then this is a validated method in neuroscience, and I have added additional references in the subsection “Using GED to identify the low-frequency rhythm” for interested readers. If the reviewer is referring to assessing the quality of a covariance matrix, this is now discussed in the last paragraph of the subsection “Nonstationarities and condition differences”. If I have misunderstood this comment, then I apologize and ask the reviewer to clarify.</p><p><italic>And it would be of use to know the relative power in the high and low frequency bands used in the simulations, with some corresponding discussion of minimal relative power necessary e.g. gamma, to obtain interpretable results, and the applicability of the required power levels assumptions to real data, e.g. EEG.</italic> </p><p>The relative power between high and low frequency bands is not important; indeed, they are not directly compared. Instead, it is only the covariance matrices within a frequency band from different time periods that are compared (or, in other cases, relative to the broadband power). For example, in the simulations shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>, the gamma peak is present but weaker than the “distractor” (non-coupled) gamma; in the simulations shown in <xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig5">5</xref>, the gamma peaks are hardly visible in the power spectrum. This is now discussed in the Results section among other places.</p><p><italic>The paper is likely to be useful for specialists working in the area, but if a wider audience is intended, a more generous introductory section and structured Discussion section would be helpful.</italic> </p><p>I hope the reviewer agrees that the revised version is more approachable. I welcome any additional specific suggestions for improvement.</p><p><italic>Reviewer #2:</italic> </p><p><italic>The goal of this paper is &quot;to highlight that significant insights into the neural mechanisms and implications of CFC can be gained by expanding the repertoire of data analyses, as well as theoretical conceptualizations, from a single-electrode-sinusoid-based framework to a multivariate-components-based framework.&quot; The author notes a number of challenges for existing CFC approaches include non-stationarities and sharp transients in signal, non-uniform phase distributions, and the fact that CFC sources and targets are spatially distributed and potentially overlapping. To address these challenges they propose a new analytic framework named generalized eigendecomposition CFC (gedCFC). Although the method proposed is very promising, the manuscript reads more like a proof of principle than a convincing demonstration. This is not because the framework is flawed, but because the range of applications discussed (5 different settings) leads to a lack of focus, and so the strengths and weaknesses of the framework are not clearly enough tested and reported within each setting.</italic> </p><p>Thank you for your evaluation and for your many comments. I agree with this assessment, but I would not consider it to be a weakness. The intention was not to propose a single method with a single set of parameters; instead, the goal was to provide the CFC field with an alternative perspective for thinking about and analyzing CFC in multichannel data. The specific implementation of the gedCFC framework should be left to the researcher, depending on the data and goals of the analysis. I agree that a paper presenting only one method would be more focused as a piece of written literature, but it would also be less useful as a scientific contribution.</p><p>Furthermore, because the different methods are generally similar to each other, I do not think it is necessary to provide a full complement of testing for each method; this was the reason for setting up the different simulations in different ways. I have tried to make the consistency across methods more apparent in the revised version.</p><p>As detailed below, many aspects of the revision have been clarified and tightened. I hope the reviewer agrees.</p><p><italic>1) The paper describes five methods for characterizing changes in spatiotemporal properties of brain data, using a common linear algebraic formalism. On the one hand, the range of methods is valuable because CFC measures are applied in a range of contexts to address a range of hypotheses. However, this also means that manuscript lacks conceptual unity and focus. For example, it is not entirely clear which of the 5 methods are solutions to which of the problems (e.g. non-stationarities, sharp transients, non-uniform phase distributions, etc.) with existing CFC methods. I would recommend:i) try to group the 5 methods into clusters with a common purpose (for example Methods 1 and 2 could be grouped), rather than simply using numeric labels;ii) assign names to the different approaches;iii) create a table which summarizes, for each method, the kind of hypothesis it is best suited for testing, which problems it solves, and which problems it does not solve;iv) for each of the claims above concerning the problems solved by gedCFC, please design a test that specifically demonstrates that claim. The manuscript already includes valuable demonstration examples that do perform this function, but it is not always explicitly specified which facet of gedCFC they are meant to test.</italic> </p><p>Thank you for these suggestions. The summary table is a great idea, and is included in the revised version. I decided against explicit grouping of methods, as they do not clearly group together in a parsimonious way. The text now discusses better how the different Methods are related to each other. I also decided against giving each method a name, as the names would either be (<xref ref-type="bibr" rid="bib1">1</xref>) as long as their descriptions or (<xref ref-type="bibr" rid="bib2">2</xref>) difficult to remember.</p><p>I appreciate that the reviewer feels the paper “lacks conceptual unity”; however, the goal here is not to present a simple literary work, but instead to present a group of related data analysis techniques, linked by a single mathematical and conceptual framework, that will benefit the electrophysiology community. Readers will be able to determine the most appropriate method for their data and hypotheses, rather than relying on (and, typically, being disappointed by) one particular black-box algorithm that may or may not be appropriate for their data.</p><p>The revision is more explicit about the underlying assumptions and limitations of each method, including extra text at the beginning and end of each of the subsections that introduce each method.</p><p>It is not really the case that there is a one-to-one mapping between a CFC problem and a gedCFC method. All of the methods address the limitations faced by standard CFC analyses. But the purpose of gedCFC is not simply that it addresses limitations of existing methods; it is a totally new technique for measuring CFC. Therefore, it is not so simple as writing “method A has problem X, and gedCFC-method-Y resolves it.” That would be analogous to saying that the primary purpose of EEG is that fMRI has poor temporal resolution.</p><p><italic>More generally, I found that the readability of the manuscript decreased from Method 3 onward, as more complex methods were introduced. In method 4 delay-coordinate embedding is introduced, just in passing, but this is a complicated and rich area of research. The investigation of how to choose the correct parametrization (e.g. number of time delays) in Method 4 could be a paper of its own. So, again, it is nice to see how the gedCFC framework can be applied, but the range of uses also limits the manuscript's depth and clarity.</italic> </p><p>Indeed, parameterization of delay-embedded matrices is a non-trivial problem. But without making this paper a full-length book, it is not possible to go into great detail about each method. I appreciate that this necessarily requires sacrificing some focus, but as written above, the goal here was to present a framework, not a black-box recipe for a specific analysis.</p><p>I have tried to make the paper more readable. However, I believe it simply will necessarily be the case that people will need some background in signal processing and matrix analysis to be able to apply the analyses described here.</p><p>More concretely, the revision includes more approachable introductions to each method, and pictorial overviews of the mechanics of each method.</p><p><italic>2) Why compare gedCFC against methods, such as PACz, which are (according to the citations in the introduction) known to be flawed? The manuscript would be more compelling if gedCFC was compared against state-of-the-art methods (some of which are mentioned in the Introduction) and/or against the most successful of the methods reviewed in Tort et al. (2010, J Neurophys). In addition, when existing methods fail, it would help to specify precisely why they are failing. For example, it could be that gedCFC has, effectively, greater statistical power when applied to multi-channel data due to pooling of information across multiple electrodes, but it was unclear to me whether this was the core reason for its advantage over PACz.</italic> </p><p>PACz is a standard and widely used measure of CFC, probably the most commonly used method. It has its limitations, but I would not consider it to be “flawed.” Instead, it can overestimate or underestimate true PAC in the case of non-sinusoidal oscillations, depending on the nature of the non-stationarities (this is detailed in van Driel et al., 2014, J Neuro Methods). PACz will produce the same results as the distribution analysis described in Tort et al. 2010 when power has a monopolar distribution over low-frequency phase (this is what is observed empirically) and when the lower frequency phase angles are uniformly distributed.</p><p>The reviewer is correct that the increased SNR of gedCFC is partly due to the weighted average of electrodes. However, the primary benefit is the robustness to nonstationarities in the low-frequency and the high-frequency dynamics, which are the primary sources of bias in PACz, as described in the manuscript. These points are now detailed in the paper.</p><p><italic>3) &quot;This alleviates the feature of principle components analysis that makes it suboptimal for brain data: components are forced to be orthogonal but neural dynamics (certainly at the meso- to macroscopic scale of LFP and EEG) are not orthogonal.&quot;</italic> </p><p><italic>It seems unlikely to me that this undesirable feature of PCA – the fact that, e.g., the second eigenvector's direction is constrained by the direction of the first eigenvector – is truly absent from the gedCFC framework. Generally, there is a distinction drawn between (i) dimensionality reduction methods, such as PCA, which rotate data so that it can be compactly re-expressed; and (ii) source separation methods, such as ICA, which aim to identify statistically distinct generators within a mixed signal. Although in many cases PCA does approximate the function of source separation, this is not its goal, and the orthogonality assumption is a testament to the fact that compact expression is prioritized over source separation.</italic> </p><p><italic>My (admittedly intuitive) impression is that the gedCFC framework is closer to a dimensionality reduction method than to a source separation method. Specifically, even though the components in gedCFC are not, in general, constrained to be orthogonal, this does not imply that (e.g.) the direction of the eigenvector of second-largest eigenvalue is unaffected by the direction of the eigenvector whose eigenvalue is largest. Consider the special case in which R^(-1)S is indeed symmetric: in this case, the eigenvectors are again constrained to be orthogonal and the well-known PCA problems return. So, should we expect PCA-like difficulties whenever R^(-1)S is near-symmetric? What is our guarantee that these issues do not arise even when R^(-1)S is far from symmetric?</italic> </p><p><italic>The manuscript already presents some examples of cases where gedCFC successfully extracts signals from a mixture, but in these cases the mixed signals have different frequencies, so the filtering operations may be doing much of the work. To demonstrate that gedCFC really does not run into the interpretational difficulties seen with PCA, I recommend setting up a situation in which multiple signals (say 3) with similar spatial profiles, similar frequencies, and overlapping functional response profiles, are mixed – a case in which PCA should fail – and then show that gedCFC does not suffer from similar problems.</italic> </p><p>GED is often referred to as a source separation method, both in the EEG (e.g., Parra 2003) and in the mathematics and engineering literatures (e.g., Tomé 2006). It is also, as the reviewer suggests, referred to as a dimensionality reduction method, although source separation is also dimensionality reduction (the reverse, of course, is not true).</p><p>Although the paper provides only a theoretical remark about the superiority of GED over PCA, this has been empirically demonstrated in several papers in neuroscience, a few of which are now cited in the text. Given the many instances in the literature showing the superiority of GED over PCA for source separation, and given that PCA does not fit into the gedCFC framework, and that the purpose here is to provide a method for CFC and PCA is not a method for CFC, it seems redundant and beyond the scope of this paper to provide another formal demonstration of GED vs. PCA for source separation. PCA was mentioned only to introduce readers to GED, because in my experience, most electrophysiologists are familiar with PCA and this provides an easy scaffold for understanding GED. I believe the new <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> also helps clarify the improvement of GED over PCA for source separation.</p><p>Furthermore, I’m not sure I follow the reviewer’s suggestion: If three signals have the same spatial and spectral profiles and overlapping functional response profiles, then it would seem to me that these are actually reflecting a single functional source. gedCFC is not a dipole-localization technique; in fact, it works entirely indifferently to spatial configuration (as illustrated in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). The term “source” has varied interpretations in neuroscience; components analyses refer to statistical sources, as opposed to anatomical sources (the two sometimes overlap but often do not).</p><p>As for temporal filtering, the reviewer’s point about temporal filtering taking care of the separation is not correct. For one thing, many of the analyses reported here did not involve any temporal filtering to obtain the CFC components. Secondly, no spurious CFC was identified for strong gamma components that were in the data but not locked to the low-frequency rhythm.</p><p>Regarding the symmetry: It is difficult to imagine a situation in which R<sup>-1</sup>S will just happen to be symmetric. Symmetric matrices are very rare, and basically only occur by specific construction (multiplying a matrix by its transpose). Even multiplying a symmetric matrix with the identity matrix that has a single off-diagonal element replaced by .1 will produce a non-symmetric matrix. Furthermore, the law (it is mathematically required; it is not an assumption) that a symmetric matrix has orthogonal eigenvectors simply states that if the eigenvalues are different, the eigenvectors are orthogonal (if there are repeated eigenvalues, the vectors need not be orthogonal, but most algorithms select them to be orthogonal); there is nothing in the math about vectors approaching orthogonality as a matrix approaches symmetry.</p><p>Finally, regarding the point about the direction of the second vector being constrained by the direction of the first vector, this is true, but it is also true for ICA and any other source separation method, in the sense that two eigenvectors cannot point in exactly the same direction (analogously, two ICs cannot be exactly the same). For eigendecomposition, any two distinct eigenvalues will produce different eigenvectors. Therefore, any one eigenvector will constrain the direction of any other eigenvector in the senses that (<xref ref-type="bibr" rid="bib1">1</xref>) their angles are nonzero for distinct eigenvalues and (<xref ref-type="bibr" rid="bib2">2</xref>) they are orthogonal for symmetric matrices. Even for reduced-rank matrices that lack a full spectrum of eigenvalues, the uncertainty about in-plane eigenvectors affects only the smaller components that are not considered in gedCFC.</p><p>I’m not sure what to do about this comment. It is beyond the scope of this paper to provide a lengthy discussion about linear algebra concepts (readers can find such information elsewhere). I hope the supplemental figure illustrating GED in a 2D example is informative.</p><p><italic>4) Because the model works by comparing a reference covariance to a target covariance, it assumes a binary transition between two modes. But how well would the model perform if the underlying generative process is actually changing continuously? For example if the generative model of gamma power is something like probability(gamma burst) ~ phase(theta), then a method that assumes a continuous variation as a function of phase will have far greater statistical power than a method which simply contrasts peak and off-peak data? Now, Method 3 may present an answer this &quot;binary assumption&quot; issue, because a continuous time-varying signal is convolved and included the model. But in this case, does not one not re-encounter the problem of non-stationarity and sharp transients, because now the estimation of the low-frequency envelope matrix, B, could be affected by these factors? Similar to the point I made in (<xref ref-type="bibr" rid="bib1">1</xref>) above, I would like to see a more careful discussion of the strengths and weaknesses of each method, so that the manuscript explicitly describes for each method, which of the common challenges for CFC are overcome, and which are not overcome.</italic> </p><p>We should distinguish between two different stages of analysis: (<xref ref-type="bibr" rid="bib1">1</xref>) designing the spatial filter; (<xref ref-type="bibr" rid="bib2">2</xref>) using the spatial filter to extract a component that is then used for analysis. Only the first stage involves a binary discretization; the second stage provides a continuous measure of activity.</p><p>In fact, the situation the reviewer describes (gamma power varying continuously as a function of theta phase) is exactly what was implemented in the simulations for Methods 1 and 2. As shown in <xref ref-type="fig" rid="fig1">Figures 1B</xref> and <xref ref-type="fig" rid="fig3">3E</xref>, the methods work quite well at recovering continuous gamma power as a function of continuous theta phase, even though the spatial filter was defined only using two covariance matrices taken from discrete time windows. As long as the spatial structure of the network remains the same, the method will work. In this sense, the reviewer is not correct that the discretization is a weakness. This distinction is now clarified on “Generalized eigendecomposition” and in <xref ref-type="fig" rid="fig3">Figure 3</xref> legend.</p><p>With regards to the final point, the revised version now more clearly states the assumptions, advantages, goals, and limitations of each method. This information is listed at the start and end of each subsection of the Results.</p><p><italic>5) The paper would be more practically useful if it provided a slightly more thorough treatment of at least one of the statistical methods for testing components, and noted briefly any problems that may arise in this setting.</italic> </p><p>Statistical evaluations are now presented in two figures, and the section about statistical evaluation is expanded.</p><p><italic>Reviewer #3:</italic></p><p><italic>This paper describes a novel technique to calculate cross-frequency coupling using generalized eigenvalue decomposition. The technique is novel and has several significant advantages that have currently not been clearly addressed, such as its independence of selecting electrodes and not assuming a sinusoidal shape. Moreover, the technique can be used in several ways (5 methods are described in the paper). The paper is well written; as I was reading it and wrote down questions, a subsequent section would often already provide an answer. Overall, I think the paper is of high quality and I only have a few comments that can be easily addressed.</italic> </p><p><italic>1) It is not quite clear to me whether the method assumes that multiple electrodes have the exact same phase for an underlying rhythm. For example, if the method were to be used to analyze LFP recordings across motor cortex, with traveling β oscillations, where there is a shift in phase across electrodes, how would that reflect upon component waves?</italic> </p><p>As long as the phase lags are consistent over repeated epochs, they are not detrimental to the analysis. This is now in the first paragraph of the subsection “Nonstationarities and condition differences”. Method 4 would reveal phase lags as delays in the filter time series for different channels, e.g., a slanted bar in <xref ref-type="fig" rid="fig7">Figure 7c</xref>. I have seen this in other datasets, but not in the data shown here.</p><p><italic>2) It is said that the quality of gedCFC components is related to the quality of the covariance matrices, and a sufficient amount of clean data ensures high-quality covariance matrices. Can this be quantified: is there a way to compute from one of the data sets used in the paper how the amount of data used relates to the quality of the gedCFC components?</italic> </p><p>This is an important point, and it was too ambiguous in the original submission. Unfortunately, there are no formal criteria for what makes a covariance matrix good enough for eigendecomposition. This is an important issue and it is now discussed in more detail in the paper (subsection “Nonstationarities and condition differences”, third paragraph).</p><p><italic>3) In method 3 example recordings from a human epilepsy patient are used with recordings of the medial temporal lobe and electrode Cz. Why would there be any coupling in these data? How does referencing affect the method? More anterior temporal lobe channels are also closer the face with potential muscle artifacts, which may not even be removed with bipolar referencing.</italic> </p><p>There is considerable evidence for the role of hippocampal-prefrontal interactions in memory consolidation and retrieval. This has been studied in rodents using electrophysiology and lesions, and in humans using invasive electrophysiology, MEG, and fMRI. A popular review paper is now cited in the last paragraph of the subsection “Method 3: Low-frequency waveform shape as a bias filter on sphered data”.</p><p>The hippocampal electrode was locally referenced to its average while Cz was referenced to linked mastoids. Intracranial sources, particularly with local referencing, are not affected by facial muscles. Nonetheless, this N=1 dataset was included as proof-of-principle illustration in empirical data; strong claims about brain function are not made based on these data.</p></body></sub-article></article>