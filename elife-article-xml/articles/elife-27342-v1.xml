<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">27342</article-id><article-id pub-id-type="doi">10.7554/eLife.27342</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A spiral attractor network drives rhythmic locomotion</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-84932"><name><surname>Bruno</surname><given-names>Angela M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="par-4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">†</xref></contrib><contrib contrib-type="author" corresp="yes" id="author-84934"><name><surname>Frost</surname><given-names>William N</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-59115"><name><surname>Humphries</surname><given-names>Mark D</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1906-2581</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Neuroscience</institution>, <institution>The Chicago Medical School, Rosalind Franklin University of Medicine and Science</institution>, <addr-line><named-content content-type="city">Illinois</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Cell Biology and Anatomy</institution>, <institution>The Chicago Medical School, Rosalind Franklin University of Medicine and Science</institution>, <addr-line><named-content content-type="city">Illinois</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Faculty of Biology, Medicine, and Health</institution>, <institution>University of Manchester</institution>, <addr-line><named-content content-type="city">Manchester</named-content></addr-line>, <country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ramirez</surname><given-names>Jan-Marino</given-names></name><role>Reviewing editor</role><aff><institution>Seattle Children's Research Institute and University of Washington</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>william.frost@rosalindfranklin.edu</email> (WNF);</corresp><corresp id="cor2"><email>mark.humphries@manchester.ac.uk</email> (MDH)</corresp><fn fn-type="present-address" id="pa1"><label>†</label><p>Division of Biology and Biological Engineering, California Institute of Technology, Pasadena, California</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>07</day><month>08</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e27342</elocation-id><history><date date-type="received"><day>30</day><month>03</month><year>2017</year></date><date date-type="accepted"><day>11</day><month>07</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Bruno et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Bruno et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-27342-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.27342.001</object-id><p>The joint activity of neural populations is high dimensional and complex. One strategy for reaching a tractable understanding of circuit function is to seek the simplest dynamical system that can account for the population activity. By imaging <italic>Aplysia</italic>’s pedal ganglion during fictive locomotion, here we show that its population-wide activity arises from a low-dimensional spiral attractor. Evoking locomotion moved the population into a low-dimensional, periodic, decaying orbit - a spiral - in which it behaved as a true attractor, converging to the same orbit when evoked, and returning to that orbit after transient perturbation. We found the same attractor in every preparation, and could predict motor output directly from its orbit, yet individual neurons’ participation changed across consecutive locomotion bouts. From these results, we propose that only the low-dimensional dynamics for movement control, and not the high-dimensional population activity, are consistent within and between nervous systems.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.001">http://dx.doi.org/10.7554/eLife.27342.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.27342.002</object-id><title>eLife digest</title><p>In all animals, neurons in the brain work together to generate movement. From a slug’s ability to crawl, to your ability to move your hand, movement is dependent on hundreds or thousands of neurons being active at the same time. Rhythmic movements such as crawling or swimming show this clearly: groups of neurons fire together and remain silent together in a repeating sequence, producing waves of muscle contraction. But do we need to understand the activity of each of the hundreds or thousands of individual neurons to know how they generate these movements?</p><p>Bruno et al. argue that we do not, and propose instead that brain circuits that generate movement show a few set patterns of activity. By recording the activity of a population of neurons, we can identify the pattern of activity that generates a particular movement. To illustrate this point, Bruno et al. examined the network of neurons that drives the rhythmic crawling movement of the sea slug <italic>Aplysia</italic>.</p><p>The results show that the network of neurons seems to contain many different patterns of activity during crawling. Yet collectively these different patterns are reflections of a simpler hidden system, a spiral of ever-decreasing, oscillating activity. This pattern is referred to as a spiral attractor because whenever the network is activated, the overall pattern of activity is always pulled into this spiral regardless of its starting point. The same applies whenever the network is disturbed. The key thing to note, however, is that individual neurons within the network do not show the same activity each time the network is active. This means that only the spiral attractor itself, and not the contribution of the individual neurons, is constant every time the sea slug crawls.</p><p>What do we need to know to understand the brain? The results presented by Bruno et al. suggests that identifying the hidden systems that underlie seemingly complex and varying neural activity is the key to understanding how brains generate movement. This may also be true for how brains form memories, make decisions, and give rise to sight, hearing and touch.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.002">http://dx.doi.org/10.7554/eLife.27342.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>Aplysia californica</kwd><kwd>locomotion</kwd><kwd>population dynamics</kwd><kwd>attractors</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id><institution>Medical Research Council</institution></institution-wrap></funding-source><award-id>MR/J008648/1</award-id><principal-award-recipient><name><surname>Humphries</surname><given-names>Mark D</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01NS060921</award-id><principal-award-recipient><name><surname>Frost</surname><given-names>William N</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1257923</award-id><principal-award-recipient><name><surname>Frost</surname><given-names>William N</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>F31NS079036</award-id><principal-award-recipient><name><surname>Bruno</surname><given-names>Angela M</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The neural population of the Aplysia's pedal ganglion are a low-dimensional spiral attractor, and the parameters of the attractor directly define the properties of the Aplysia's escape locomotion behaviour.</meta-value></custom-meta><custom-meta><meta-name>eLife Digest</meta-name><meta-value>2.5</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The increasing availability of large scale recordings of brain networks at single neuron resolution provides an unprecedented opportunity to discover underlying principles of motor control. However, such long-sought data sets are revealing a new challenge - the joint activity of large neural populations is both complex and high dimensional (<xref ref-type="bibr" rid="bib1">Ahrens et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Cunningham and Yu, 2014</xref>; <xref ref-type="bibr" rid="bib74">Yuste, 2015</xref>). Population recordings have as many dimensions as neurons, and each neuron’s activity can have a complex form. What strategies can we use to expose the hoped-for simplifying principles operating beneath the turbulent surface of real-world brain activity? One route is dimension reduction (<xref ref-type="bibr" rid="bib6">Briggman et al., 2006</xref>; <xref ref-type="bibr" rid="bib18">Cunningham and Yu, 2014</xref>; <xref ref-type="bibr" rid="bib42">Kobak et al., 2016</xref>), which focuses on identifying the components of activity that co-vary across the members of a neural population, shifting the focus from the high dimensional recorded data to a low-dimensional representation of the population.</p><p>Such low-dimensional signals within joint population activity have been described in neural circuits for sensory encoding (<xref ref-type="bibr" rid="bib58">Mazor and Laurent, 2005</xref>; <xref ref-type="bibr" rid="bib2">Bartho et al., 2009</xref>), decision-making (<xref ref-type="bibr" rid="bib5">Briggman et al., 2005</xref>; <xref ref-type="bibr" rid="bib25">Harvey et al., 2012</xref>; <xref ref-type="bibr" rid="bib49">Mante et al., 2013</xref>), navigation (<xref ref-type="bibr" rid="bib67">Seelig and Jayaraman, 2015</xref>; <xref ref-type="bibr" rid="bib64">Peyrache et al., 2015</xref>), and movement (<xref ref-type="bibr" rid="bib47">Levi et al., 2005</xref>; <xref ref-type="bibr" rid="bib1">Ahrens et al., 2012</xref>; <xref ref-type="bibr" rid="bib38">Kato et al., 2015</xref>). Implicit in such dimension reduction approaches is the hypothesis that the high-dimensional population activity being recorded, while highly heterogenous, is derived from a simpler, consistent low-dimensional system (<xref ref-type="bibr" rid="bib9">Brody et al., 2003</xref>; <xref ref-type="bibr" rid="bib16">Churchland et al., 2010</xref>; <xref ref-type="bibr" rid="bib38">Kato et al., 2015</xref>; <xref ref-type="bibr" rid="bib60">Miller, 2016</xref>). We sought to directly test this hypothesis by identifying the simplest dynamical system that can account for high dimensional population activity.</p><p>A useful model to address these questions is the neural control of movement. Movement arises from the mass action of neuron populations (<xref ref-type="bibr" rid="bib22">Georgopoulos et al., 1986</xref>; <xref ref-type="bibr" rid="bib23">Getting, 1989</xref>; <xref ref-type="bibr" rid="bib1">Ahrens et al., 2012</xref>; <xref ref-type="bibr" rid="bib65">Portugues et al., 2014</xref>; <xref ref-type="bibr" rid="bib74">Yuste, 2015</xref>; <xref ref-type="bibr" rid="bib63">Petersen and Berg, 2016</xref>). While individual neuron activity can correlate with specific aspects of movement (<xref ref-type="bibr" rid="bib15">Chestek et al., 2007</xref>; <xref ref-type="bibr" rid="bib26">Hatsopoulos et al., 2007</xref>; <xref ref-type="bibr" rid="bib16">Churchland et al., 2010</xref>, <xref ref-type="bibr" rid="bib17">2012</xref>), the embedded low dimensional signals in population recordings (<xref ref-type="bibr" rid="bib5">Briggman et al., 2005</xref>; <xref ref-type="bibr" rid="bib47">Levi et al., 2005</xref>; <xref ref-type="bibr" rid="bib38">Kato et al., 2015</xref>) and the intermittent participation of individual neurons across repeated movements in both vertebrates (<xref ref-type="bibr" rid="bib13">Carmena et al., 2005</xref>; <xref ref-type="bibr" rid="bib32">Huber et al., 2012</xref>) and invertebrates (<xref ref-type="bibr" rid="bib29">Hill et al., 2010</xref>, <xref ref-type="bibr" rid="bib31">2015</xref>) together suggest that only the collective population activity, and not specifics of single neuron firing, are key to movement control. If so, then finding the underlying dynamical system will be necessary for a parsimonious theory of the neural control of movement (<xref ref-type="bibr" rid="bib8">Briggman and Kristan, 2008</xref>).</p><p>In order to identify the simplest dynamical system underlying population activity in movement control, we imaged large populations at single-neuron, single-spike resolution in the pedal ganglion of <italic>Aplysia</italic> during fictive locomotion (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). The pedal ganglion presents an ideal target for testing hypotheses of movement control as it contains the pattern generator (<xref ref-type="bibr" rid="bib35">Jahan-Parwar and Fredman, 1979</xref>, <xref ref-type="bibr" rid="bib36">1980</xref>), motorneurons (<xref ref-type="bibr" rid="bib28">Hening et al., 1979</xref>; <xref ref-type="bibr" rid="bib21">Fredman and Jahan-Parwar, 1980</xref>) and modulatory neurons (<xref ref-type="bibr" rid="bib24">Hall and Lloyd, 1990</xref>; <xref ref-type="bibr" rid="bib59">McPherson and Blankenship, 1992</xref>) underlying locomotion. Moreover, its fictive locomotion is sustained for minutes, ideal for robustly characterising population dynamics. Using this model system, here we find its low-dimensional, underlying dynamical system, test if the low-dimensional signal encodes movement variables, and determine the contribution of single neurons to the low-dimensional dynamics.<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.003</object-id><label>Figure 1.</label><caption><title>Population dynamics during fictive locomotion.</title><p>(<bold>A</bold>) Voltage-sensitive dye recording of the pedal ganglion (Pd) network in an isolated central nervous system preparation (top) using a photodiode array (blue hexagon). The array covered the dorsal surface of the ganglion (bottom). Ce: cerebral ganglion; Pl: pleural ganglion; Pd9/10: pedal nerve 9/10. (<bold>B</bold>) Stimulus protocol. Three escape locomotion bouts were evoked in each preparation by stimulation of tail nerve Pd9. Parameters are given for the stimulus pulse train. (<bold>C</bold>) Example population recording. Raster plot of 160 neurons before and after Pd9 nerve stimulation. Neurons are grouped into ensembles of similarly-patterned firing, and ordered by ensemble type (colors) - see Materials and methods. (<bold>D</bold>) Power spectra of each population’s spike-trains, post-stimulation (grey: mean spectrum of each bout; black: mean over all bouts). (<bold>E</bold>) Network firing rate over time (grey: every bout; black: mean; red bar: stimulation duration. Bins: 1 s). (<bold>F</bold>) Terminology and schematic illustration of the necessary conditions for identifying a periodic attractor (or ‘cyclical’ attractor). Left: to characterise the dynamics of a <inline-formula><mml:math id="inf1"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional system, we use the joint activity of its <inline-formula><mml:math id="inf2"><mml:mi>N</mml:mi></mml:math></inline-formula> units at each time-point <inline-formula><mml:math id="inf3"><mml:mi>t</mml:mi></mml:math></inline-formula> – illustrated here for <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> units. The set of joint activity points in time order defines the system’s trajectory (black line). Right: the three conditions for identifying a periodic attractor. In each panel, the line indicates the trajectory of the joint activity of all units in the dynamical system, starting from the solid dot. The manifold of a dynamical system is the space containing all possible trajectories of the unperturbed system – for periodic systems, we consider the manifold to contain all periodic parts of the trajectories (grey shading). In (condition 3), the dashed line indicates where the normal trajectory of the system would have been if not for the perturbation (red line). See <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for a dynamical model illustrating these conditions.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.003">http://dx.doi.org/10.7554/eLife.27342.003</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig1-v1"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Necessary and sufficient conditions of a periodic attractor.</title><p>Here we demonstrate the essential properties of a periodic attractor network. (<bold>A</bold>) Top: a simple neuronal implementation of a periodic attractor network using three mutually inhibitory neurons. Bottom: model neurons are not endogenous oscillators - if uncoupled, they do not oscillate in response to constant input. The oscillatory activity we show here is an emergent property of the model network. (<bold>B</bold>) The underlying periodic attractor is revealed by the recurrence of the neurons’ joint activity. Top: given sustained input, the three neurons rapidly settle into an alternating oscillatory rhythm. Bottom: projection of the three neurons’ firing rates onto the first two principal components (PCs). Starting from time zero (black dot), the joint activity of the network rapidly converges to a recurrent trajectory, where each corner of the triangle - extending into the short diagonal line - corresponds to the maximum rate of one neuron. The space containing the repeated trajectory is the attractor’s manifold. (<bold>C</bold>) Convergence to the manifold from different initial conditions. From three different initial conditions for the neurons (coloured dots), each corresponding joint activity converges to the attractor manifold. (<bold>D</bold>) Transient perturbations cause a divergence and return to the attractor’s manifold. Top: A brief increase in input to one neuron (black bar) perturbs the ongoing oscillation, which is rapidly recovered. Bottom: in the PC projection, the initial recurrent trajectory (in black) is moved away from the manifold by the perturbation (red); removing the perturbing input rapidly moves the joint activity back to the manifold (blue). (<bold>E</bold>) Sustained perturbations move the network to a new attractor. Top: A sustained change in input (black bar) causes one neuron (purple) to become silent and the others to change their oscillation pattern. Bottom: in the PC projection, the perturbation causes the joint activity of the network to move from the initial stable manifold (black) to a new stable manifold (blue: note this is a repeating line). (<bold>F</bold>) Decaying input causes a spiral. Top: linearly decaying input to all neurons changes the amplitude, but not the frequency of the oscillatory activity. Bottom: in the PC projection, this decay is shown by the spiral of the joint activity’s trajectory to the stable point at (0,0) – which corresponds to no activity.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.004">http://dx.doi.org/10.7554/eLife.27342.004</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig1-figsupp1-v1"/></fig></fig-group></p><p>We show that evoking fictive locomotion caused heterogenous population spiking activity, but under which always lay a low-dimensional, slowly decaying periodic orbit. This periodic trajectory met the convergence and perturbation criteria for an attractor. Crucially, we identify the attractor as a stable, decaying spiral in every preparation. We decoded motorneuron activity directly from the low-dimensional orbit, showing that it directly encodes the relevant variables for movement. Yet we found that individual neurons varied their participation in the attractor between bouts of locomotion. Consequently, only the low-dimensional signal and not the high-dimensional population activity was consistent within and between nervous systems. These findings strongly constrain the possible implementations of the pattern generator for crawling in <italic>Aplysia</italic>; and by quantifying the attractor they make possible future testing of how short- and long-term learning change properties of that attractor. Collectively, these results provide experimental support for the long-standing idea that neural population activity is a high-dimensional emergent property of a simpler, low-dimensional dynamical system.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We sequentially evoked three bouts of fictive locomotion in each of 10 isolated central nervous system preparations (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Each bout of locomotion was evoked by short stimulation of the tail nerve P9, mimicking a sensory stimulus to the tail that elicits the escape locomotion response (<xref ref-type="bibr" rid="bib28">Hening et al., 1979</xref>); in intact animals, a strong tail stimulus typically elicits a two-part escape behavior consisting of several cycles of a vigorous arching gallop, followed by several minutes of a more sedate rhythmic crawl (<xref ref-type="bibr" rid="bib35">Jahan-Parwar and Fredman, 1979</xref>; <xref ref-type="bibr" rid="bib20">Flinn et al., 2001</xref>). We imaged the dorsal pedal ganglion 30 s before through to 90 s after the evoking stimulus, aiming to capture the population dynamics initiating and driving the initial gallop before the transition to the crawl. Recorded populations from the pedal ganglion comprised 120–180 neurons each, representing <inline-formula><mml:math id="inf5"><mml:mo>≈</mml:mo></mml:math></inline-formula>10% of the network in each recording. The population recordings captured rich, varied single neuron dynamics within the ganglion’s network following the stimulus (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). A dominant, slow (<inline-formula><mml:math id="inf6"><mml:mrow><mml:mi/><mml:mo>≤</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> Hz) oscillation in neural firing (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) is consistent with the periodic activity necessary to generate rhythmic locomotion. But the variety of single neuron dynamics (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>) (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) and the slowly decaying population firing rate (<xref ref-type="fig" rid="fig1">Figure 1F</xref>) post-stimulus hint at a more complex underlying dynamical system driving locomotion than a simple, consistent oscillator.</p><p>Seeking the simplest dynamical system to account for these data, we first show here that the joint activity of the population meets the necessary conditions for a periodic attractor (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). We identified these as: (1) applying a driving force causes the system’s activity to fall onto a stable, periodic orbit; (2) repeatedly driving the system causes convergence of its activity to the same orbit; and (3) the system should return to the periodic orbit after the end of transient perturbation. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> demonstrates these conditions in a dynamical model of a neural periodic attractor.</p><sec id="s2-1"><title>Joint population activity forms a low-dimensional periodic orbit</title><p>We first established that under the heterogenous population activity evoked by the tail-nerve stimulation there was a low dimensional periodic trajectory, consistent with there being a periodic attractor in the pedal ganglion. Projections of a population’s joint activity into three dimensions typically showed that stimulation caused a strong deviation from the spontaneous state, which then settled into repeated loops (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Capturing a significant proportion (80%) of the population variance generally required 4–8 embedding dimensions (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), representing a dimension reduction by more than a factor of 10 compared to the number of neurons. Thus, throughout our analysis, we projected each evoked program into the number of embedding dimensions needed to capture at least 80% of the variance in population activity (4–8 dimensions: inset of <xref ref-type="fig" rid="fig2">Figure 2B</xref>). However, we cannot directly visualise this space; therefore we could not tell by visual inspection if the low-dimensional trajectory repeatedly returned to the same position, and so was truly periodic.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.005</object-id><label>Figure 2.</label><caption><title>Population dynamics form a low-dimensional periodic orbit.</title><p>(<bold>A</bold>) Projection of one evoked population response into three embedding dimensions, given by its first three principal components (PCs). Dots: start of recording (black) and stimulation (pink); spontaneous activity is shown in grey. Smoothed with 2 s boxcar window. (<bold>B</bold>) Proportion of population variance explained by each additional embedding dimension, for every evoked population response (<inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>; light-to-dark grey scale indicates stimulations 1 to 3 of a preparation). We chose a threshold of 80% variance (red line) to approximately capture the main dimensions: beyond this, small gains in explained variance required exponentially-increasing numbers of dimensions. Inset: Histogram of the number of PCs needed to explain 80% variance in every recorded population response. (<bold>C</bold>) Quantifying population dynamics using recurrence. Population activity at some time <inline-formula><mml:math id="inf8"><mml:mi>t</mml:mi></mml:math></inline-formula> is a point in <inline-formula><mml:math id="inf9"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional space (black circle), following some trajectory (line and open circles); that point <italic>recurs</italic> if activity at a later time <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> passes within some small threshold distance <inline-formula><mml:math id="inf11"><mml:mi>θ</mml:mi></mml:math></inline-formula>. The time <inline-formula><mml:math id="inf12"><mml:mi>n</mml:mi></mml:math></inline-formula> is the recurrence time of point <inline-formula><mml:math id="inf13"><mml:mi>t</mml:mi></mml:math></inline-formula>. (<bold>D</bold>) Recurrence plot of the population response in panel A. White squares are recurrence times, where the low-dimensional dynamics at two different times passed within distance <inline-formula><mml:math id="inf14"><mml:mi>θ</mml:mi></mml:math></inline-formula>. We defined <inline-formula><mml:math id="inf15"><mml:mi>θ</mml:mi></mml:math></inline-formula> as a percentile of all distances between points; here we use 10%. Stimulation caused the population’s activity to recur with a regular period. Projection used 4 PCs. (<bold>E</bold>) Histograms of all recurrence times in each population response (threshold: 10%), ordered top-to-bottom by height of normalised peak value. Vertical line indicates the minimum time we used for defining the largest peak as the dominant period for that population response. Right: density of time-points that were recurrent, and density of recurrence points with times in the dominant period. (<bold>F</bold>) Periodic orbit of each evoked population response, estimated as the mean recurrence time from the dominant period.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.005">http://dx.doi.org/10.7554/eLife.27342.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig2-v1"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.006</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Range of dynamics in the evoked locomotion programs.</title><p>Here we quantify the complexity of the dynamics in each evoked program using the structure of the recurrence plots (five example plots are shown). Each white dot is a pair of time-points at which the low-dimensional trajectory recurred. A diagonal line indicates a contiguous period of recurrence of the population dynamics. We thus quantified the complexity of each program by the duration of the longest diagonal line (measuring the predictability of the system) and by the proportion of recurrent points falling in long (<inline-formula><mml:math id="inf16"><mml:mo>&gt;</mml:mo></mml:math></inline-formula>5 s) diagonal lines (measuring the cleanness of the system’s dynamics). We plot the joint distribution of these two quantities here, one point per program; colours indicate programs from the same preparation. These show how the range of dynamics captured by our dataset stretches from quasi-noise (bottom left), though stuttering/pausing oscillations (top left), to continuous oscillation (right). Despite this heterogeneity, almost all evoked programs revealed the same underlying dynamical system (<xref ref-type="fig" rid="fig2">Figures 2</xref>–<xref ref-type="fig" rid="fig4">4</xref>, main text).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.006">http://dx.doi.org/10.7554/eLife.27342.006</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig2-figsupp1-v1"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.007</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Robustness of the periodic orbits.</title><p>Here we show that the periodic orbits, defined by recurrence, are robust to the choice of threshold for defining ‘close’. We defined the threshold as a percentile of all distances between all points in the post-stimulation trajectory. We show here the effects of choosing a threshold of 10% (<bold>A</bold>), 5% (<bold>B</bold>), and 2% (<bold>C</bold>). Left column: histograms of all recurrence times in each program, ordered top-to-bottom by height of normalised peak value. Vertical line indicates the minimum time we used for defining the largest peak as the dominant period for that program. Middle column: density of time-points that were recurrent, and density of recurrence points with times in the dominant period. Right column: Periodic orbit of each program, estimated as the mean recurrence time from the dominant period. We use a threshold of 10% in the main text as it allows a denser sampling of potential trajectory points that are noisy realisations of the underlying attractor.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.007">http://dx.doi.org/10.7554/eLife.27342.007</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig2-figsupp2-v1"/></fig></fig-group></p><p>To determine whether population activity in higher dimensions reached a stable periodic orbit, we made use of the idea of recurrence (<xref ref-type="bibr" rid="bib45">Lathrop and Kostelich, 1989</xref>; <xref ref-type="bibr" rid="bib55">Marwan et al., 2007</xref>). For each time-point in the low-dimensional trajectory of the population’s activity, we check if the trajectory passes close to the same point in the future (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). If so, then the current time-point <italic>recurs</italic>, indicating that the joint activity of the population revisits the same state at least once. The time between the current time-point and when it recurs gives us the period of recurrence. A strongly periodic system would thus be revealed by its population’s trajectory having many recurrent points with similar recurrence periods; random or chaotic dynamics, by contrast, would not show a single clustered recurrence period.</p><p>Plotting recurrent time-points showed that the evoked low-dimensional population activity typically recurred with a regular period (example in <xref ref-type="fig" rid="fig2">Figure 2D</xref>). We found strongly periodic recurrence on the scale of 10–15 s in many but not all of the 30 evoked population responses (<xref ref-type="fig" rid="fig2">Figure 2E,F</xref>). This reflected the range of stimulation responses from strongly periodic activity across the population to noisy, stuttering, irregular activity (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Nonetheless, despite this heterogeneity across stimulus responses, the activity of almost all populations was dominated by a single periodic orbit (<xref ref-type="fig" rid="fig2">Figure 2E</xref>), robust to the choice of threshold for defining recurrence (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p></sec><sec id="s2-2"><title>Joint population activity meets the conditions for a periodic attractor</title><p>The trajectory of a periodic dynamical system remains within a circumscribed region of space – the manifold – that is defined by all the possible states of that system. (We schematically illustrate a manifold by the grey shading in <xref ref-type="fig" rid="fig1">Figure 1F</xref> (condition 2), and demonstrate the manifold of our model periodic attractor network in panel C of <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). If the population responses of the pedal ganglion are from an underlying periodic attractor, then the population’s joint activity should rapidly reach and stay on its manifold when evoked; reach the same manifold every time it is evoked; and return to the manifold when perturbed (these three conditions are schematically illustrated in <xref ref-type="fig" rid="fig1">Figure 1F</xref>; see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> for the corresponding examples from the dynamical model).</p><p>We found that almost all evoked population responses quickly reached a state of high recurrence, within one oscillation period (<xref ref-type="fig" rid="fig3">Figure 3A</xref>), and were thereafter dominated by recurrence, indicating they quickly reached and stayed on the manifold.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.008</object-id><label>Figure 3.</label><caption><title>Low dimensional population dynamics meet the conditions for a periodic attractor.</title><p>(<bold>A</bold>) Distribution of the time the population dynamics took to coalesce onto the attractor from the stimulation onset, and the subsequent stability of the attractor (measured by the proportion of recurrent points). Colours indicate evoked responses from the same preparation. The coalescence time is the mid-point of the first 5 s sliding window in which at least 90% of the points on the population trajectory recurred in the future. (<bold>B</bold>) Projection of three sequential population responses from one preparation onto the same embedding dimensions. Dots are time of stimulus offset. (<bold>C</bold>) Sequential population responses fall onto the same manifold. Dots indicate distances between pairs of population responses in the same preparation; color indicates preparation. Control distances are from random projections of each population response onto the same embedding dimensions - using the same time-series, but shuffling the assignment of time series to neurons. This shows how much of the manifold agreement is due to the choice of embedding dimensions alone. The two pairs below the diagonal are for response pairs (1,2) and (1,3) in preparation 4; this correctly identified the unique presence of apparent chaos in response 1 (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). (<bold>D</bold>) Distances between pairs of population responses from the same preparation in three states: the end of spontaneous activity (at stimulus onset); between stimulation onset and coalescence (the maximum distance between the pair); and after both had coalesced (both reaching the putative attractor manifold; data from panel C). (<bold>E</bold>) Example neuron activity similarity matrices for consecutively evoked population responses. Neurons are ordered according to their total similarity in stimulation 2. (<bold>F</bold>) Correlation between pairs of neuron similarity matrices (Data) compared to the expected correlation between pairs of matrices with the same total similarity per neuron (Control). Values below the diagonal indicate conserved pairwise correlations between pairs of population responses within the same preparation. The two pairs on the diagonal are response pairs (1,3) and (2,3) in preparation 7; this correctly identified the unique presence of a random walk in response 3 (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). (<bold>G</bold>) Spontaneous divergence from the trajectory. For one population response, here we plot the density of recurrence points (top) and the mean recurrence delay in 5 s sliding windows. Coalescence time: grey line. The sustained ‘divergent’ period of low recurrence (grey shading) shows the population spontaneously diverged from its ongoing trajectory, before returning. Black dot: pre-divergence window (panel I). (<bold>H</bold>) Breakdown of spontaneous perturbations across all population responses. Returned: population activity became stably recurrent after the perturbation. (<bold>I</bold>) Returning to the same manifold. For each of the 17 ‘Returned’ perturbations in panel H, the proportion of the recurrent points in the pre-divergence window that recurred after the divergent period, indicating a return to the same manifold or to a different manifold.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.008">http://dx.doi.org/10.7554/eLife.27342.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig3-v1"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.009</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Convergence and non-convergence to the same manifold.</title><p>(<bold>A</bold>) Robustness of convergence to the same manifold. Here we repeat the analysis of <xref ref-type="fig" rid="fig3">Figure 3A</xref>, but using different low-dimensional projections. In the main text <xref ref-type="fig" rid="fig2">Figures 2</xref>–<xref ref-type="fig" rid="fig4">4</xref>, we analyse low-dimensional projections of each individual program; the comparison of distances between sequentially evoked programs was then done by projecting all three programs onto the axes of the first program. Here we derive a common set of axes, by first applying PCA to the concatenated time-series of the three programs. We then project each program onto those common axes, before computing distances between data and control (random projection) pairs of programs (dots). We obtain the same results: sequentially-evoked programs converge to the same manifold. (<bold>B</bold>) Apparent chaotic motion in the non-convergent program. Here we show the recurrence plot for program 1 of preparation 4, the only program that was further from the other programs in the same preparation than random projections. We see that this program seemed to reach an apparently chaotic attractor about 45 s after stimulation: quasi-periodic activity, with no regular structure. (<bold>C</bold>) Apparent random-walk in the non-correlated program. Here we show the recurrence plot for program 3 of preparation 7, the only program that did not recapitulate the pair-wise correlations of neural activity of the other programs in the same preparation. We see that this program had no clear periodic activity, but seemingly random periods of locally-similar activity, consistent with a dynamical system undergoing a random walk.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.009">http://dx.doi.org/10.7554/eLife.27342.009</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig3-figsupp1-v1"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.010</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Spontaneous perturbations of ongoing programs.</title><p>We plot here examples of each type of spontaneous perturbation we observed, visualised using the recurrence plot (top), and the raster plot of population activity (bottom) sorted into detected ensembles. (<bold>A</bold>) Spontaneous perturbation away from the periodic attractor. Blue line indicates the final 5 s window with more than 50% recurrence, long before the end of the recording. (<bold>B</bold>) Spontaneous perturbation returning to the same manifold of the periodic attractor. The orange lines indicates the point of maximum divergence from the manifold. The recurrence plot shows that same trajectory was recovered thereafter (white patches in upper right corner), visible as the return of the phasically firing ensembles (raster plot). (<bold>C</bold>) Spontaneous perturbation moving to a new periodic attractor. The recurrent trajectory up to 30 s post-stimulus did not recur thereafter (black region in upper right of the recurrence plot), but was replaced with a new recurrent trajectory. The raster plot shows this was an apparent transition in the oscillation period, and/or firing pattern of the ensembles.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.010">http://dx.doi.org/10.7554/eLife.27342.010</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig3-figsupp2-v1"/></fig></fig-group></p><p>But does each population response from the same preparation reach the same manifold? The key problem in analysing any putative attractor from experimental data is identifying when the experimentally-measured dynamics are or are not on the attractor’s manifold, whether due to perturbations of the system or noise in the measurements. Moreover, we cannot directly compare time-series between evoked responses because, as just demonstrated, each response may reach the manifold at different times (see also panel C in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Thus the set of recurrent time-points allowed us to identify when the joint population activity was most likely on the attractor’s manifold, and then to make comparisons between population responses.</p><p>To determine if sequentially-evoked responses from the same preparation reached the same manifold, we projected all 3 population responses into the same set of embedding dimensions, using only the recurrent points (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows these results are robust to other projections). Falling on the same manifold would mean that every recurrent point in one population response’s trajectory would also appear in both the others’ trajectories, if noiseless. Consequently, the maximum distance between any randomly chosen recurrent point in population response A and the closest recurrent point in population response B should be small. We defined small here as being shorter than the expected distance between a recurrent point in A and the closest point on a random projection of the activity in the same embedding dimensions. Despite the inherent noise and limited duration of the recordings, this is exactly what we found: pairs of evoked population responses from the same preparation fell close to each other throughout (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), well in excess of the expected agreement between random projections of the data onto the same embedding dimensions.</p><p>We also checked that this convergence to the same manifold came from different initial conditions. The initiating stimulation is a rough kick to the system – indeed a fictive locomotion bout can be initiated with a variety of stimulation parameters (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>) – applied to ongoing spontaneous activity. Together, the stimulation and the state of spontaneous activity when it is applied should give different initial conditions from which the attractor manifold is reached. We found that the stimulation caused population responses within the same preparation to diverge far more than in either the spontaneous activity or after coalescing to the manifold (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Thus, a wide range of initial driven dynamics in the pedal ganglion population converged onto the same manifold.</p><p>Previous studies have used the consistency of pairwise correlations between neurons across conditions as indirect evidence for the convergence of population activity to an underlying attractor (<xref ref-type="bibr" rid="bib73">Yoon et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Peyrache et al., 2015</xref>). The intuition here is that neurons whose activity contributes to the same portion of the manifold will have simultaneous spiking, and so their activity will correlate across repeated visits of the population’s activity to the same part of the manifold. To check this, we computed the pairwise similarity between all neurons within an evoked population response (<xref ref-type="fig" rid="fig3">Figure 3E</xref>), then correlated these similarity matrices between responses from the same preparation. We found that pair-wise similarity is indeed well-preserved across population responses in the same preparation (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). This also shows that the apparent convergence to the same manifold is not an artefact of our choice of low-dimensional projection.</p><p>In many population responses, we noticed spontaneous perturbations of the low-dimensional dynamics away from the trajectory (examples in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), indicated by sudden falls in the density of recurrent points (<xref ref-type="fig" rid="fig3">Figure 3G</xref>). That is, perturbations could be detected by runs of contiguous points on the population trajectory that were not recurrent. As each spontaneous perturbation was a cessation of recurrence in a trajectory accounting for 80% of the co-variation between neurons, each was a population-wide alteration of neuron activity (see example rasters in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). In most cases (90%), the population dynamics returned to a recurrent state after the spontaneous perturbation (<xref ref-type="fig" rid="fig3">Figure 3H</xref>; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, panel B), consistent with the pertubation being caused by a transient effect on the population The two perturbations that did not return to a recurrent state were consistent with the end of the evoked fictive locomotion and a return to spontaneous activity (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, panel A). Of those that returned, all but three clearly returned to the same manifold (<xref ref-type="fig" rid="fig3">Figure 3I</xref>); for those three, the spontaneous perturbation appeared sufficient to move the population dynamics into a different periodic attractor (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>, panel C). Potentially, these are the known transitions from the escape gallop to normal crawling (<xref ref-type="bibr" rid="bib20">Flinn et al., 2001</xref>). The low dimensional dynamics of the pedal ganglion thus meet the stability, manifold convergence, and perturbation criteria of a periodic attractor network.</p></sec><sec id="s2-3"><title>Heterogenous population activity arises from a common attractor</title><p>While these results show the existence of a periodic orbit on an attractor in the evoked population responses, they cannot address whether these arise from the same putative attractor within and, crucially, between animals. To determine if there is a common underlying attractor despite the heterogeneity in spiking patterns across the population responses (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>), we introduced a statistical approach to quantifying the low-dimensional trajectory. We first fitted a linear model of the local dynamics around each time point in the low-dimensional projection (see Materials and methods). For each <inline-formula><mml:math id="inf17"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional point <inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in this projection, we fitted the <inline-formula><mml:math id="inf19"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional model <inline-formula><mml:math id="inf20"><mml:mrow><mml:mover accent="true"><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐀</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> to the trajectory forwards and backwards in time from point <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In this model, the change in the trajectory over time <inline-formula><mml:math id="inf22"><mml:mover accent="true"><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> in the neighbourhood of point <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is determined by the values of the <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> matrix <inline-formula><mml:math id="inf25"><mml:mi mathvariant="bold">𝐀</mml:mi></mml:math></inline-formula>. The maximum eigenvalue of <inline-formula><mml:math id="inf26"><mml:mi>A</mml:mi></mml:math></inline-formula> thus tells us whether the trajectory around point <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is predominantly expanding or contracting in the <inline-formula><mml:math id="inf28"><mml:mi>N</mml:mi></mml:math></inline-formula>-dimensional projection, and whether or not it is rotating (<xref ref-type="bibr" rid="bib69">Strogatz, 1994</xref>).</p><p>By fitting the linear model to each point on the trajectory we obtained time-series of the maximum eigenvalues, describing the local dynamics at each point along the trajectory. The time-series of eigenvalues typically showed long periods of similar magnitude eigenvalues, corresponding to the recurrent points (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Consequently, by then averaging over the eigenvalues obtained only for recurrent points, we could potentially capture the dynamics of the underlying attractor. Doing so, we found that the evoked population responses had highly clustered maximum eigenvalues (<xref ref-type="fig" rid="fig4">Figure 4B,C</xref>), and thus highly similar underlying dynamics despite the apparent heterogeneity of spike-train patterns between them. The dominance of negative complex eigenvalues implies the pedal ganglion network implements a contracting periodic orbit - it is a stable spiral attractor (<xref ref-type="fig" rid="fig4">Figure 4D</xref>).<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.011</object-id><label>Figure 4.</label><caption><title>The pedal ganglion contains a spiral attractor.</title><p>(<bold>A</bold>) Example time-series from one population response of the real (top) and imaginary (bottom) component of the maximum eigenvalue for the local linear model. Points are averages over a 5 s sliding window. Red bar indicates stimulus duration. (<bold>B</bold>) Dominant dynamics for each evoked population response. Dots and lines give means <inline-formula><mml:math id="inf29"><mml:mo>±</mml:mo></mml:math></inline-formula>2 s.e.m. of the real and imaginary components of the maximum eigenvalues for the local linear model. Colours indicate responses from the same preparation. Black dot gives the mean over all population responses. Grey shaded regions approximately divide the plane of eigenvalue components into regions of qualitatively different dynamics: fixed point attractor; stable spiral (bottom-right schematic); unstable spiral (top-right schematic). (<bold>C</bold>) As panel B, converted to estimates of orbital period and rate of contraction. (Note that higher imaginary eigenvalues equate to faster orbital periods, so the ordering of population responses is flipped on the x-axis compared to panel B). (<bold>D</bold>) A preparation with a visible spiral attractor in a three-dimensional projection. Each line is one of the three evoked population responses, colour-coded by time-elapsed since stimulation (grey circle). The periodicity of the evoked response is the number of loops in the elapsed time; loop magnitude corresponds to the magnitude of population activity. The approximate dominant axis of the spiral’s contraction is indicated. Bottom: corresponding raster plot of one evoked response. Neurons are clustered into ensembles, and colour-coded by the change in ensemble firing rate to show the dominance of decreasing rates corresponding to the contracting loop in the projection. (<bold>E</bold>) As panel D, but for a preparation with simultaneously visible dominant spiral and minor expansion of the low-dimensional trajectory. The expansion corresponds to the small population of neurons with increasing rates.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.011">http://dx.doi.org/10.7554/eLife.27342.011</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig4-v1"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.012</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Further properties of the spiral attractor.</title><p>(<bold>A</bold>) Other eigenvalues. We plot here the mean real eigenvalue for all unique dimensions. (We plot each dimension that has a unique real eigenvalue, indicating a possible change in whether the magnitude of the trajectory is contracting or expanding: complex eigenvalues come in conjugate pairs of dimensions, so each pair only defines one unique dimension). Dimensions are arranged in decreasing order of explained variance. Almost all population responses contained solely contracting trajectories in all dimensions, corresponding to a dominant decrease in neuron firing rates. A few population responses contained low-variance dimensions in which the trajectory was expanding, corresponding to a fraction of neurons with increasing firing rates (as illustrated in <xref ref-type="fig" rid="fig4">Figure 4E</xref>). Lines are colour-coded by preparation; one line per population response. (<bold>B</bold>) Proportion of local trajectories that were dominated by rotation in each preparation. This is measured as the proportion of either the top two eigenvalues of the local linear models that were complex: by looking at the top two dimensions, we accounted for some evoked responses in which the dominance of contraction-only (real eigenvalue) and contraction-and-rotation (complex eigenvalue) dynamics alternated betwen the top two dimensions over time. Population responses were dominated by rotation throughout.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.012">http://dx.doi.org/10.7554/eLife.27342.012</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig4-figsupp1-v1"/></fig></fig-group></p><p>In most population responses, the low-dimensional trajectory had negative, complex eigenvalues in all embedding dimensions, meaning that the spiral attractor completely characterised the population dynamics (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Intriguingly, a few population responses had a positive real eigenvalue in one low-variance dimension (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), implying a simultaneous minor expansion of the population trajectory. This corresponded to the appearance of a small sub-set of neurons with increasing firing rates (<xref ref-type="fig" rid="fig4">Figure 4E</xref>).</p><p>The identification of a stable spiral makes a clear prediction for what should and should not change over time in the dynamics of the population. The negative complex eigenvalues mean that the magnitude of the orbit decays over time, corresponding to the decreasing population spike rate in most evoked responses (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). However, a stable spiral indicates only a decrease in magnitude; it does not mean the orbital period is also slowing. Consequently, the presence of a stable spiral attractor predicts that the magnitude and period of the orbit are dissociable properties in the pedal ganglion network.</p><p>We checked this prediction using the linear model. The linear model estimated a mean orbital period of around 10 s (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), consistent with the directly-derived estimate from the recurrent points (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). This indicated the linear model was correctly capturing the local dynamics of each program. But our linear model also gave us a time-series of estimates of the local orbital period (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), which we could use to check whether the orbital period was changing during each evoked response. We found that the population responses included all possible changes in periodic orbit: slowing, speeding up, and not changing (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). As predicted there was no relationship between the contraction of the periodic orbit and its change in period (<xref ref-type="fig" rid="fig5">Figure 5C</xref>).<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.013</object-id><label>Figure 5.</label><caption><title>The spiral attractor dissociates changes in oscillation period and firing rate.</title><p>(<bold>A</bold>) Example of a change in the local estimate of the periodic orbit over a population response; here, slowing over time (<inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>57</mml:mn></mml:mrow></mml:math></inline-formula> points are each averages over a 5 s sliding window; <inline-formula><mml:math id="inf31"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is weighted Spearman’s rank correlation - see Materials and methods; <inline-formula><mml:math id="inf32"><mml:mi>P</mml:mi></mml:math></inline-formula> from a permutation test). Changes in the periodic orbit were assessed only after coalescence to the manifold (grey line). (<bold>B</bold>) Histogram of correlations between time elapsed and local estimate of the periodic orbit for each population response (positive: slowing; negative: speeding up). Red bars correspond to population responses with <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> (permutation test). Number of local estimates ranged between 31 and 72 per population response. (<bold>C</bold>) Relationship between the change in periodic orbit over time and the rate of contraction for each population response (Pearson’s R; <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula> responses).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.013">http://dx.doi.org/10.7554/eLife.27342.013</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig5-v1"/></fig></p></sec><sec id="s2-4"><title>The locomotion motor program can be decoded from the low-dimensional orbit</title><p>Collectively, these periodic, decaying dynamics are ethologically consistent with locomotion that comprises a repeated sequence of movements that decays in intensity over time (<xref ref-type="bibr" rid="bib35">Jahan-Parwar and Fredman, 1979</xref>; <xref ref-type="bibr" rid="bib20">Flinn et al., 2001</xref>; <xref ref-type="bibr" rid="bib53">Marinesco et al., 2004</xref>). If this putative low-dimensional periodic attractor is the ‘motor program’ for locomotion, then we should be able to decode the locomotion muscle commands from its trajectory. In 3 of the 10 preparations we were able to simultaneously record activity from the P10 nerve that projects to the neck muscles (<xref ref-type="bibr" rid="bib72">Xin et al., 1996</xref>) for all three evoked population responses. The spiking of axons in this nerve should correspond to the specific neck contraction portion of the cyclical escape locomotion. We thus sought to decode the spiking of P10 directly from the low-dimensional population trajectory (<xref ref-type="fig" rid="fig6">Figure 6A</xref>).<fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.014</object-id><label>Figure 6.</label><caption><title>Motor output can be decoded directly from the low-dimensional trajectory of population activity.</title><p>(<bold>A</bold>) An example two-dimensional projection of one population’s response trajectory, color-coded by simultaneous P10 firing rate. In this example pair of dimensions, we can see nerve P10 firing is phase-aligned to the periodic trajectory of population activity. (<bold>B</bold>) Example fit and forecast by the statistical decoding model for P10 firing rate. Grey bar indicates stimulation time. (<bold>C</bold>) For the same example P10 data, the quality of the forecast in the 10 s after each fitted 40 s sliding window. Match between the model forecast and P10 data was quantified by the fits to both the change (R: correlation coefficient) and the scale (MAE: median absolute error) of activity over the forecast window. (<bold>D</bold>) Summary of model forecasts for all nine population responses with P10 activity (main panel). Dots and lines show means <inline-formula><mml:math id="inf35"><mml:mo>±</mml:mo></mml:math></inline-formula>2 s.e.m. over all forecast windows (<inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>173</mml:mn></mml:mrow></mml:math></inline-formula>). Three examples from the extremes of the forecast quality are shown, each using the fitted model to the first 40 s window to forecast the entire remaining P10 time-series. The bottom right example is from a recording in which the population response apparently shutdown half-way through. Inset, lower left: summary of model fits in the training windows; conventions as per main panel.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.014">http://dx.doi.org/10.7554/eLife.27342.014</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig6-v1"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.015</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Ruling out P10 motorneurons in the recorded population.</title><p>We aimed to decode the spiking activity of the motorneuron axons in the P10 nerve directly from the low-dimensional trajectory of population activity in the pedal ganglion. If any P10 motorneurons had been captured in our population recording, these could have made a disproportionate contribution to the decoding. We thus first sought to detect them, and remove them if necessary. We reasoned that any putative P10 motorneuron should have close to a 1:1 locking between its spikes in the population activity recordings and corresponding spikes in the P10 nerve recording (panel <bold>A</bold> shows two example P10 unit recordings); in other words <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Moreover, we expect a putative P10 motorneuron to show <inline-formula><mml:math id="inf38"><mml:mo>∼</mml:mo></mml:math></inline-formula>1:1 locking consistently across all three programs from the same preparation. For each neuron in each recorded program with simultaneous P10 activity, we computed <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> separately for a range of delays (0 to 25 ms) between neuron and P10 spikes, allowing for <inline-formula><mml:math id="inf40"><mml:mrow><mml:mo>±</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>ms jitter at each delay. We plot the maximum probability for each neuron in programs 1 and 2 (<bold>B</bold>), and programs 1 and 3 (<bold>C</bold>); symbol size is proportional to the mean number of spikes for that neuron in the two programs (as few spikes would indicate an unlikely motorneuron). Colours indicate neurons from the three different preparations. We see that no neuron in our dataset comes close to <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> at any delay, and there are no neurons with consistently high locking between programs. We concluded that there are no P10 motorneurons in our population recordings.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.015">http://dx.doi.org/10.7554/eLife.27342.015</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig6-figsupp1-v1"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.016</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Increasing the dimensionality of state-space did not improve the P10 decoding model.</title><p>Here we show the effects of increasing the embedding dimensions for the population activity before using the decoding model for P10 activity. We used enough dimensions to capture at least 90% of the variance; we used 80% in the main text. (<bold>A</bold>) Comparison of the number of embedding dimensions needed to explain 80% and 90% variance for the nine recordings with simultaneous P10 activity. A 10% increase in variance needed at least double the number of dimensions. (<bold>B</bold>) Example fit and forecast by the statistical decoding model for P10 firing rate, when using enough embedding dimensions to capture 90% variance. Grey bar indicates stimulation time. (<bold>C</bold>) Summary of model forecasts for all nine population responses with P10 activity, when using enough embedding dimensions to capture 90% variance. Dots and lines show means <inline-formula><mml:math id="inf42"><mml:mo>±</mml:mo></mml:math></inline-formula>2 s.e.m. over all forecast windows (<inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>173</mml:mn></mml:mrow></mml:math></inline-formula>). MAE: median absolute error (error in scale) of forecast; R<sup>2</sup>: variance explained of forecast. (<bold>D</bold>) Comparison of the mean MAE in forecasting P10 activity when using embedding dimensions explaining 80% and 90% variance. Increasing the number of dimensions did not systematically lower the error in forecasting the scale of the P10 activity. (<bold>E</bold>) Comparison of the mean R<sup>2</sup> in forecasting P10 activity when using embedding dimensions explaining 80% and 90% variance. Increasing the number of dimensions did not systematically improve the forecasting of the variance of the P10 activity.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.016">http://dx.doi.org/10.7554/eLife.27342.016</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig6-figsupp2-v1"/></fig></fig-group></p><p>We first confirmed that each recorded neural population did not appear to contain any motorneurons with axons in P10, which could make the decoding potentially trivial (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). To then decode P10 activity, we used a statistical model that predicts the firing rate of nerve P10 at each time point, by weighting and summing the recent history (up to 100 ms) of the trajectory in the low dimensional space, and using a non-linearity to convert this weighted sum into a firing rate. We controlled for over-fitting using cross-validation forecasting: we fit the model to a 40 s window of trajectory data, and predicted the next 10 s of P10 activity (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). By sliding the window over the data, we could assess the quality of the forecast over the entire recording (<xref ref-type="fig" rid="fig6">Figure 6C</xref>).</p><p>The model could accurately fit and forecast P10 activity from the low-dimensional trajectory in all nine population responses (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). Emphasising the quality of the model, in <xref ref-type="fig" rid="fig6">Figure 6D</xref> we plot example forecasts of the entire P10 recording based on fitting only to the first 40 s window, each example taken from the extremes we obtained for the fit-quality metrics. Notably, in one recording the population response shutdown half-way through; yet despite the model being fit only to the 40 s window containing strong oscillations, it correctly forecasts the collapse of P10 activity, and its slight rise in firing rate thereafter. Thus, the low dimensional trajectory of the periodic attractor appears to directly encode muscle commands for movement.</p><p>To confirm this, we asked whether the encoding – as represented by the P10 activity – was truly low-dimensional. The successful decoding of future P10 activity was achieved despite needing only 3–5 embedding dimensions to account for 80% variance in the population activity for these nine recordings (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Increasing the number of embedding dimensions to account for 90% variance, at least doubling the number of embedding dimensions, did not improve the forecasts of P10 activity (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). These results suggest that the low dimensional population trajectory is sufficient to encode the locomotion muscle commands.</p></sec><sec id="s2-5"><title>Variable neuron participation in stable motor programs</title><p>If the low-dimensional trajectory described by the joint activity of the population just is the motor program for locomotion, then how crucial to this program are the firing of individual neurons (<xref ref-type="bibr" rid="bib40">Katz et al., 2004</xref>; <xref ref-type="bibr" rid="bib13">Carmena et al., 2005</xref>; <xref ref-type="bibr" rid="bib30">Hill et al., 2012</xref>; <xref ref-type="bibr" rid="bib32">Huber et al., 2012</xref>; <xref ref-type="bibr" rid="bib14">Carroll and Ramirez, 2013</xref>; <xref ref-type="bibr" rid="bib31">Hill et al., 2015</xref>)? Having quantified the motor program as the low-dimensional activity trajectory, we could uniquely ask how much each neuron participated in each evoked program. We quantified each neuron’s <italic>participation</italic> as the absolute sum of its weights on the principal axes (eigenvectors): large total weights indicate a dominant contribution to the low-dimensional trajectory, and small weights indicate little contribution. So quantified, participation is a contextual measure, giving the contribution to the population trajectory of both a neuron’s firing rate and its synchrony with other neurons, relative to the rate and synchrony of all other neurons in the population (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>).</p><p>Every population response had a long-tailed distribution of participation (<xref ref-type="fig" rid="fig7">Figure 7A</xref>), indicating that a minority of neurons dominated the dynamics of any given response. Nonetheless, these neurons were not fixed: many with high participation in one population response showed low participation in another (<xref ref-type="fig" rid="fig7">Figure 7B,C</xref>). To rule out noise effects on the variability of participation (for example, due to the finite duration of recording), we fitted a noise model to the change in participation separately for each preparation (<xref ref-type="fig" rid="fig7">Figure 7D,E</xref>). Every preparation’s pedal ganglion contained neurons whose change in participation between responses well-exceeded that predicted by the noise model (<xref ref-type="fig" rid="fig7">Figure 7F</xref>). Consequently, the contribution of single neurons was consistently and strongly variable between population responses in the same preparation.<fig-group><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.017</object-id><label>Figure 7.</label><caption><title>Single neuron participation varies within and between evoked locomotion bouts.</title><p>(<bold>A</bold>) Distributions of single neuron participation per evoked population response. We plot the distribution of participation for all neurons in a population (grey line), expressed as a percentage of the maximum participation in that population’s response. Black line gives the mean over all 30 population responses. (<bold>B</bold>) Change in participation between evoked locomotion bouts. Each dot plots one neuron’s maximum participation over all three evoked population responses, against its maximum change in participation between consecutive responses (<inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1131</mml:mn></mml:mrow></mml:math></inline-formula> neurons). (<bold>C</bold>) Two example neurons with variable participation between responses, from two different preparations. (<bold>D</bold>) Distribution of the change in participation between responses for one preparation. (<bold>E</bold>) Detecting strongly variable neurons. Gaussian fit (red) to the distribution of change in participation (black) from panel D. Neurons beyond thresholds (grey lines) of mean <inline-formula><mml:math id="inf45"><mml:mrow><mml:mo>±</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>SD of the fitted model were identified as strongly variable. (<bold>F</bold>) Proportion of identified strongly variable neurons per preparation. (<bold>G</bold>) Distance between pairs of population responses as a function of the total change in neuron participation between them. Each dot is a pair of responses from one preparation; the distance between them is given as a proportion of the mean distance between each response and a random projection (<inline-formula><mml:math id="inf46"><mml:mrow><mml:mi/><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>: closer than random projections), allowing comparison between preparations (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Black dots are excluded outliers, corresponding to the pairs containing response 1 in preparation 4 with apparent chaotic activity (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). (<bold>H</bold>) Distance between pairs of population responses as a function of the distance between the distributions of participation (panel A). Conventions as for panel G.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.017">http://dx.doi.org/10.7554/eLife.27342.017</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig7-v1"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.018</object-id><label>Figure 7—figure supplement 1.</label><caption><title>Participation captures both rate and synchrony effects.</title><p>We illustrate here that the participation of each neuron in the low-dimensional trajectory contains contributions from both its firing rate and its synchrony with other neurons. Hence changes to its participation correspond to changes in rate and/or synchrony. Note that as the participation quantifies each neuron’s contribution to multiple dominant patterns of activity co-variation in the population, so we expect only approximate correlations with the cruder, independent measures of rate and synchrony used here. (<bold>A</bold>) Example correlation between the evoked firing rates and participation scores of all neurons in one evoked population response. Participation is expressed as a percentage of the maximum score; the firing rate is calculated using all spikes from the offset of the stimulus to the end of the recording, and thus cannot capture contributions due to the decay or increase of rates. (<bold>B</bold>) Histogram of firing rate and participation correlations across all 30 programs. Firing rate explains on average (R<sup>2</sup>, red line) 50% of the variation in participation within an evoked response. (<bold>C</bold>) Example correlation between the change in firing rates and the change in participation scores across one pair of evoked responses in the same preparation. One circle per neuron; red circles indicate neurons labelled as strongly variant for this preparation (though not necessarily across this pair of responses). (<bold>D</bold>) Histogram of the correlations between change in rate and participation across all 30 pairs of programs (pairs [1,2], [1,3], and [2,3] within each preparation). Firing rate changes explain on average 23% of the variation in the change of participation (R<sup>2</sup>, red line). (<bold>E-H</bold>) As A-D, for synchrony and changes in synchrony. The synchrony of each neuron is calculated as the total absolute correlation of that neuron with all other neurons, given by its corresponding column of the pairwise correlation matrix between all spike-density functions after stimulus offset.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.018">http://dx.doi.org/10.7554/eLife.27342.018</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig7-figsupp1-v1"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.27342.019</object-id><label>Figure 7—figure supplement 2.</label><caption><title>Testing for an invariant central pattern generator.</title><p>Here we test the possibility that hidden within the variation between programs is a small, invariant core of neurons that may form a classic central pattern generator. We do this by first determining the type of dynamical ensemble to which each neuron was assigned (tonic, oscillator, burster, or pauser: see <xref ref-type="fig" rid="fig1">Figure 1C</xref>, main text), in order to find phasically-firing neurons expected of a pattern generator. (<bold>A</bold>) The proportion of neurons consistently assigned to the same type of dynamical ensemble across all three population responses. One circle per preparation. The inconsistent classification across programs is congruent with the wide variation in participation. Only the oscillator class of ensembles contained at least one consistently assigned neuron in all ten preparations, and so were candidates for containing an invariant core of neurons. (<bold>B</bold>) Scatter plot of participation against the maximum change in participation, restricted to neurons consistently assigned to the oscillator type of ensemble. One circle per neuron; colours indicate preparation. The same correlation between participation and variation as for the entire dataset is observed, with no clear evidence of an invariant group of strongly participating neurons across the preparations (as would be indicated by neurons falling in the lower right quadrant). (<bold>C</bold>) The top 10% of consistent oscillator neurons by participation, and their corresponding maximum change in participation. Each circle plots the median across the top 10% for that preparation. Even restricted to just the top 10%, most preparations showed high variation in participation amongst the oscillator neurons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.019">http://dx.doi.org/10.7554/eLife.27342.019</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig7-figsupp2-v1"/></fig></fig-group></p><p>We also tested for the possibility that hidden within the variation between programs is a small core of neurons that are strongly participating, yet invariant across programs. Such a core of phasically active neurons may, for example, form the basis of a classical central pattern generator. However, in our observed portion of the ganglion we found no evidence for a core of strongly participating, invariant, and phasically active neurons across the preparations (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>).</p><p>These data show that a neuron’s role within the locomotion motor program is not fixed, but leave open the question of whether single neuron variability causes variation in the program itself. In our analysis, variation between sequentially-evoked population responses is quantified by the distance between their low-dimensional projections (as in <xref ref-type="fig" rid="fig3">Figure 3C</xref>). We found that the distance between a pair of population responses did not correlate with either the total change in neuron participation between the two responses (<xref ref-type="fig" rid="fig7">Figure 7G</xref>) or the distance between their participation distributions (<xref ref-type="fig" rid="fig7">Figure 7H</xref>). The execution of the motor program is thus robust to the participation of individual neurons.</p></sec><sec id="s2-6"><title>Participation maps identify potential locations of the pattern generator network</title><p>To get some insight into the physical substrate of the attractor, we plotted maps of the participation of each neuron in each preparation. We found that neurons with strong participation across the three evoked population responses were robustly located in the caudo-lateral quadrant of the ganglion (<xref ref-type="fig" rid="fig8">Figure 8A,B</xref>). Maps of the right ganglion also indicated strong participation in the rostro-medial quadrant; due to the low numbers of maps for each side, it is unclear whether this is a true asymmetry of the ganglia or simply reflects sampling variation. Neurons with highly variable participation between population responses (<xref ref-type="fig" rid="fig8">Figure 8C,D</xref>) were similarly found in the caudo-lateral quadrants of both ganglia. Strongly participating neurons were thus confined to specific regions of the pedal ganglion’s network.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.27342.020</object-id><label>Figure 8.</label><caption><title>Mapping of participation in the attractor across the ganglion network.</title><p>Here we plot neuron location with respect to the photodiode array (yellow hexagon). Each plot pools neurons from preparations of the left (<inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> preparations) or right (<inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) ganglia. <bold>A,B</bold> Maps of maximum participation across the three evoked population responses for left (<bold>A</bold>) and right (<bold>B</bold>) ganglion recordings. The area of each marker is proportional to the neuron’s maximum participation. Neurons are colour coded (light orange to dark red) by the quintile of their participation across all preparations. <bold>C,D</bold> As for panels (A,B), but plotting the range of participation across the three evoked population responses.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.27342.020">http://dx.doi.org/10.7554/eLife.27342.020</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-27342-fig8-v1"/></fig></p><p>These data are consistent with a network-level distribution of the attractor, with a particularly strong contribution from the caudo-lateral quadrant. Encouragingly, from a different data-set we previously described this region as containing neural ensembles that generated a cyclical packet of neural activity, which moved in phase with activity from the neck-projecting P10 nerve (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>). Consequently, both those data and our new data support our hypothesis that the pattern generator for locomotion is predominantly located in the caudo-lateral network.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Locomotion networks provide a tractable basis for testing theories of neural dynamics (<xref ref-type="bibr" rid="bib48">Lewis and Kristan, 1998</xref>; <xref ref-type="bibr" rid="bib5">Briggman et al., 2005</xref>; <xref ref-type="bibr" rid="bib47">Levi et al., 2005</xref>; <xref ref-type="bibr" rid="bib7">Briggman and Kristan, 2006</xref>; <xref ref-type="bibr" rid="bib3">Berg et al., 2007</xref>; <xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>; <xref ref-type="bibr" rid="bib63">Petersen and Berg, 2016</xref>), as they couple complex dynamics with clearly defined outputs. We took advantage of this to comprehensively test the idea that high-dimensional population activity arises from an underlying low-dimensional dynamical system: to determine what dynamical system accounts for the population activity, whether its low-dimensional signal encodes movement, and how single neuron activity relates to that signal. We showed here that <italic>Aplysia</italic>’s pedal ganglion contains a spiral attractor, that the low-dimensional signal it generates directly encodes muscle commands, and yet individual neurons vary in their participation in the attractor.</p><sec id="s3-1"><title>A consistent low-dimensional spiral attractor</title><p>Testing the idea that high-dimensional population activity contains a low-dimensional signal has only been possible in the last decade or so, due to the necessary combination of large-scale multi-neuron recording and dimension reduction approaches (<xref ref-type="bibr" rid="bib10">Brown et al., 2004</xref>; <xref ref-type="bibr" rid="bib6">Briggman et al., 2006</xref>; <xref ref-type="bibr" rid="bib18">Cunningham and Yu, 2014</xref>; <xref ref-type="bibr" rid="bib42">Kobak et al., 2016</xref>). Landmark studies have used this combination to project high-dimensional population activity into a more tractable low-dimensional space. In this space, studies have shown how activity trajectories are different between swimming and crawling (<xref ref-type="bibr" rid="bib5">Briggman et al., 2005</xref>); distinguish olfactory (<xref ref-type="bibr" rid="bib58">Mazor and Laurent, 2005</xref>), auditory (<xref ref-type="bibr" rid="bib2">Bartho et al., 2009</xref>), and visual (<xref ref-type="bibr" rid="bib49">Mante et al., 2013</xref>) stimuli; and distinguish upcoming binary choices (<xref ref-type="bibr" rid="bib25">Harvey et al., 2012</xref>). Here we have gone a step further than previous studies by not only observing such low-dimensional signals, but explicitly testing for the first time the type of dynamical system that gives rise to the low-dimensional trajectories and its consistency between animals.</p><p>Across all 30 evoked population responses examined here, there was a remarkable heterogeneity of spike-train patterns, from visually evident widespread oscillations to noisy, stuttering oscillations in a minority of neurons (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Yet our analysis shows that underpinning this heterogeneity is the same dynamical system: a low-dimensional, decaying, periodic orbit. We found a remarkably consistent periodicity and rate of orbital decay across evoked responses within a preparation and between preparations. The stability of these dynamics, and the convergence of population activity to the same manifold, are all consistent with the expected behaviour of a true attractor. Our data thus suggest that only the low-dimensional system and not the high-dimensional population activity are consistent within and between nervous systems.</p><p>We advance the hypothesis that the properties of the spiral attractor fully determine the parameters of the escape gallop: its frequency, physical distance per cycle, and duration. In this hypothesis, the orbital period of the attractor determines the period of the rhythmic gallop – the sequential activity of the neurons in each orbit thus driving the sequential contraction of the muscles driving the escape gallop (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>). Further, the amplitude of the orbital period, corresponding to the spike rate of the neural population, could determine the strength of muscle contraction during the escape gallop, allowing control of the physical distance covered by each arching movement. Finally, the contraction rate of the attractor determines the duration of the escape: the faster the contraction rate, the shorter the escape gallop’s duration. The variation of these attractor properties between animals then determines the natural variability in the escape gallop. It follows that changes to parameters of the escape gallop caused by neuromodulation should correlate with changes to the orbital period and/or contraction rate of the attractor. For example, the reported increase in gallop duration by systemic injection of serotonin (<xref ref-type="bibr" rid="bib53">Marinesco et al., 2004</xref>) should correlate with a decreased contraction rate of the attractor. Future work could test this hypothesis by determining the effects of neuromodulators on the spiral attractor’s properties and correlating those with read-outs of the escape gallop.</p><p>Treating a neural circuit as a realisation of a dynamical system takes the emphasis away from the details of individual neurons - their neurotransmitters, their ion channel repertoire - and places it instead on their collective action. This allows us to take a Marr-ian perspective (<xref ref-type="bibr" rid="bib54">Marr, 1982</xref>), which neatly separates the computational, algorithmic, and implementation levels of movement control. The computational problem here is of how to generate rhythmic locomotion for a finite duration; the algorithmic solution is a decaying periodic attractor - a spiral; and the implementation of that attractor is the particular configuration of neurons in the pedal ganglion - one of many possible implementations (<xref ref-type="bibr" rid="bib41">Kleinfeld and Sompolinsky, 1988</xref>; <xref ref-type="bibr" rid="bib62">Pasemann, 1995</xref>; <xref ref-type="bibr" rid="bib19">Eliasmith, 2005</xref>; <xref ref-type="bibr" rid="bib66">Rokni and Sompolinsky, 2012</xref>). Indeed, a spiral attractor is potentially a general solution to the problem of how to generate a finite rhythmic behaviour.</p></sec><sec id="s3-2"><title>Insights and challenges of variable neuron participation</title><p>We saw the separation of these levels most clearly in the variable participation of the individual neurons between evoked bouts of fictive locomotion. The projection of the pedal ganglion network’s joint activity into a low dimensional space captured the locomotion motor program independently of any single neuron’s activity. Even the most strongly participating neurons in a given population response could more than halve their participation in other evoked responses. These results suggest that the pedal ganglion’s pattern generator is not driven by neurons that are endogenous oscillators, as they would be expected to participate equally in every response. Rather, this variation supports the hypothesis that the periodic activity is an emergent property of the network.</p><p>The adaptive function of having variably participating neurons is unknown. One possibility is that, by not relying on any core set of neurons to generate rhythmic activity, the pedal ganglion’s ability to generate locomotion is robust to the loss of neurons. A related possibility is that there is ‘sloppiness’ (<xref ref-type="bibr" rid="bib61">Panas et al., 2015</xref>) in the pedal ganglion network, such that there are many possible configurations of neurons and their connections able to realise the spiral attractor that drives locomotion (<xref ref-type="bibr" rid="bib52">Marder et al., 2015</xref>). Such sloppiness allows for a far more compact specification of the developmental program than needing to genetically specify the type and wiring configuration of each specific neuron.</p><p>The wide variation of single neuron participation between evoked bouts of fictive locomotion also raises new challenges for theories of neural network attractors (<xref ref-type="bibr" rid="bib51">Marder and Taylor, 2011</xref>). While a variety of models present solutions for self-sustaining periodic activity in a network of neurons (<xref ref-type="bibr" rid="bib41">Kleinfeld and Sompolinsky, 1988</xref>; <xref ref-type="bibr" rid="bib19">Eliasmith, 2005</xref>; <xref ref-type="bibr" rid="bib66">Rokni and Sompolinsky, 2012</xref>), it is unclear if they can account for the variable participation of single neurons. A further challenge is that while the variable participation of individual neurons does not affect the underlying program, clearly it takes a collective change in single neuron activity to transition between behaviours - as, for example, in the transition from galloping to crawling in <italic>Aplysia</italic>. What controls these transitions, and how they are realised by the population dynamics, is yet to be explored either experimentally or theoretically.</p></sec><sec id="s3-3"><title>Possible implementations of rhythmic locomotion by the pedal ganglion network</title><p>Our results nonetheless argue against a number of hypotheses for the implementation of rhythmic locomotion by the pedal ganglion. As noted above, such single neuron variability between sequential locomotion bouts argues against the generation of rhythmic activity by one or more independent neurons that are endogenous oscillators. Our results also argue against the existence of many stable periodic states in this network (<xref ref-type="bibr" rid="bib62">Pasemann, 1995</xref>). Such meta-stability would manifest as changes in periodicity following perturbation. Our results show that spontaneous divergences from the attractor overwhelmingly returned to the same attractor.</p><p>How then might the pedal ganglion network implement a spiral attractor? Our data were collected from an isolated central nervous system preparation, in which the modulatory influence of neurons outside the pedal ganglion cannot be discounted (<xref ref-type="bibr" rid="bib37">Jing et al., 2008</xref>). Nonetheless, as the pedal ganglion contains the central pattern generator for locomotion (<xref ref-type="bibr" rid="bib36">Jahan-Parwar and Fredman, 1980</xref>), we can suggest how that generator is realised. Our results here support the hypothesis that the periodic activity is an emergent property of the ganglion’s network. We know the pedal ganglion contains a mix of interneurons and motorneurons (<xref ref-type="bibr" rid="bib21">Fredman and Jahan-Parwar, 1980</xref>), and that the motorneurons are not synaptically coupled (<xref ref-type="bibr" rid="bib28">Hening et al., 1979</xref>), suggesting they read-out (and potentially feedback to) the dynamics of an interneuron network. An hypothesis consistent with our results here is that the ganglion contains a recurrent network of excitatory interneurons, centred on the caudo-lateral quadrant, which feed-forward to groups of motorneurons (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>). This recurrent network embodies the attractor, in that stimulation of the network causes a self-sustained packet of activity to sweep around it (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>). We see this as the periodic trajectory of joint population activity (cf <xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p></sec><sec id="s3-4"><title>Multiple periodic attractors and multi-functional circuits</title><p>Our data further suggest that the pedal ganglion network supports at least two stable states, the spontaneous activity and the stable-spiral attractor. Reaching the stable-spiral attractor from the spontaneous activity required long-duration, high-voltage pedal nerve stimulation (<xref ref-type="fig" rid="fig1">Figure 1</xref>; <xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>). In dynamical systems terms, this suggests that the spontaneous state’s basin of attraction is large: most perturbations return to that state, and it takes a large perturbation to move into a different basin of attraction.</p><p>Multiple co-existing periodic attractors in a single network is also a challenge for current theories. While point attractor networks, such as Hopfield networks, can have vast number of stable states defined by different arrangements of the equilibrium activity of their neurons (<xref ref-type="bibr" rid="bib60">Miller, 2016</xref>), a stable periodic attractor network typically has only two stable states: silence and periodic activity. The co-existence of stable spontaneous and periodic states in the same network suggests that something must reconfigure the network to sustain periodic activity (<xref ref-type="bibr" rid="bib12">Calin-Jageman et al., 2007</xref>); otherwise, irrespective of the stimulation, the network would always return to the spontaneous state. One possibility in the pedal ganglion is that serotonin alters the effective connections between neurons: escape galloping is both dramatically extended by systemic injection of serotonin alongside tail stimulation (<xref ref-type="bibr" rid="bib53">Marinesco et al., 2004</xref>), and evoked by stimulating serotonergic command neurons CC9/CC10 in the cerebral ganglion (<xref ref-type="bibr" rid="bib37">Jing et al., 2008</xref>). Future experimental work should thus test the stability of the spontaneous state, and test how manipulating serotonin affects reaching and sustaining the stable-spiral attractor.</p><p>There are potentially more stable states within the pedal ganglion’s network. The long-lasting crawl that follows the escape gallop is slower and omits the periodic arching of the body (<xref ref-type="bibr" rid="bib20">Flinn et al., 2001</xref>). We saw three perturbations of the attractor activity that were suggestive of a transition to a different, slower periodic orbit (e.g. panel C in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), consistent with a transition from galloping to crawling. Such crawling is also the animal’s normal mode of exploration (<xref ref-type="bibr" rid="bib46">Leonard and Lukowiak, 1986</xref>), and so the ‘crawling’ attractor must be reachable from the spontaneous state too. <italic>Aplysia</italic>’s exploratory head-wave, moving its head side-to-side presumably to allow its tentacles and other head sensory organs to sample the environment (<xref ref-type="bibr" rid="bib46">Leonard and Lukowiak, 1986</xref>), is also controlled by motorneurons in the pedal ganglion (<xref ref-type="bibr" rid="bib44">Kuenzi and Carew, 1994</xref>). Previous studies of the <italic>Aplysia</italic>’s abdominal ganglion (<xref ref-type="bibr" rid="bib71">Wu et al., 1994</xref>), the leech segmental ganglion (<xref ref-type="bibr" rid="bib7">Briggman and Kristan, 2006</xref>), and the crustacean stomatogastric ganglion (reviewed in <xref ref-type="bibr" rid="bib50">Marder and Bucher, 2007</xref>) have described multi-functional networks in which the same neurons are active in different motor behaviours. Our work here is consistent with the hypothesis that such multi-function is due to the neurons participating in different attractors realised by same network (<xref ref-type="bibr" rid="bib8">Briggman and Kristan, 2008</xref>). Further work is needed to map the pedal ganglion network’s dynamics to the full range of <italic>Aplysia</italic> motor behaviour.</p></sec><sec id="s3-5"><title>Outlook</title><p>Finding and quantifying the attractor required new analytical approaches. We introduce here the idea of using recurrence analysis to solve two problems: how to identify periodic activity in a high-dimensional space; and how to identify when the recorded system is and is not on the manifold of the attractor. By extracting the times when the population activity is on the manifold, we could then quantify and characterise the attractor, including identifying transient perturbations, and estimating changes in orbital period. Crucially, these manifold-times let us further introduce the idea of using linear models as a statistical estimator, to identify the type of attractor, and compare the detected attractor’s parameters within and between preparations. Our analysis approach thus offers a road-map for further understanding the dynamics of neural populations.</p><p>There is rich potential for understanding spontaneous, evoked or learning-induced changes in the dynamics of populations for movement control. The dynamics of movement control populations transition between states either spontaneously or driven by external input (<xref ref-type="bibr" rid="bib5">Briggman et al., 2005</xref>; <xref ref-type="bibr" rid="bib47">Levi et al., 2005</xref>). Our recurrence approach allows both the detection of transitions away from the current state (<xref ref-type="fig" rid="fig3">Figure 3</xref>) and the characterisation of the attractor in the new state. For learning, taking an attractor-view allows us to distinguish three distinct ways that short (<xref ref-type="bibr" rid="bib68">Stopfer and Carew, 1988</xref>; <xref ref-type="bibr" rid="bib39">Katz et al., 1994</xref>; <xref ref-type="bibr" rid="bib31">Hill et al., 2015</xref>) or long-term (<xref ref-type="bibr" rid="bib27">Hawkins et al., 2006</xref>) plasticity could change the underlying attractor: by changing the shape of the manifold; by changing the rate of movement of the low-dimensional signal on the manifold; or by changing the read-out of the manifold by downstream targets. Such insights may contribute to the grand challenge of systems neuroscience, that of finding simplifying principles for neural systems in the face of overwhelming complexity (<xref ref-type="bibr" rid="bib43">Koch, 2012</xref>; <xref ref-type="bibr" rid="bib74">Yuste, 2015</xref>).</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Data and code availability</title><p>Bandpassed optical data, spike-sorted data, and available P10 nerve recordings are hosted on CRCNS.org at: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6080/K0SN074B">http://dx.doi.org/10.6080/K0SN074B</ext-link></p><p>All research code is available under a MIT License from (<xref ref-type="bibr" rid="bib34">Humphries, 2017</xref>): <ext-link ext-link-type="uri" xlink:href="https://github.com/mdhumphries/AplysiaAttractorAnalysis">https://github.com/mdhumphries/AplysiaAttractorAnalysis. </ext-link>A copy is archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/AplysiaAttractorAnalysis">https://github.com/elifesciences-publications/AplysiaAttractorAnalysis.</ext-link></p></sec><sec id="s4-2"><title>Imaging</title><p>Full details of the <italic>Aplysia californica</italic> preparation are given in <xref ref-type="bibr" rid="bib11">Bruno et al. (2015)</xref>. Briefly, the cerebral, pleural and pedal ganglia were dissected out, pinned to the bottom of a chamber, and maintained at <inline-formula><mml:math id="inf49"><mml:mrow><mml:mn>15</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mn>17</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>C. Imaging of neural activity used the fast voltage sensitive absorbance dye RH-155 (Anaspec), and a 464-element photodiode array (NeuroPDA-III, RedShirtImaging) sampled at 1600 Hz. Optical data from the 464 elements were bandpass filtered in Neuroplex (5 Hz high pass and 100 Hz low pass Butterworth filters), and then spike-sorted with independent component analysis in MATLAB to yield single neuron action potential traces (the independent components), as detailed in (<xref ref-type="bibr" rid="bib29">Hill et al., 2010</xref>). Rhythmic locomotion motor programs were elicited using 8V 5 ms monophasic pulses delivered at 20 Hz for 2.5 s via suction electrode to pedal nerve 9. A separate suction electrode was attached to pedal nerve 10 to continuously monitor the locomotion rhythm (<xref ref-type="bibr" rid="bib72">Xin et al., 1996</xref>). Evoked activity could last for many minutes; our system allowed us to capture a maximum of <inline-formula><mml:math id="inf50"><mml:mo>≈</mml:mo></mml:math></inline-formula>125 s, divided between 30 s of spontaneous activity and 95 s of evoked activity. The stimulation protocol (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) used short (15 min) and long (60 min) intervals between stimulations, as the original design also sought effects of sensitisation.</p></sec><sec id="s4-3"><title>Spike-train analysis</title><p>Power spectra were computed using multi-taper spectra routines from the Chronux toolbox (<xref ref-type="bibr" rid="bib4">Bokil et al., 2010</xref>). We computed the power spectrum of each neuron’s spike-train post-stimulation, and plot means over all spectra within a recorded population, and the mean over all mean spectra. We computed the spike-density function <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for each neuron by convolving each spike at time <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> with a Gaussian <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi><mml:mo>:</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo fence="true" maxsize="1.2em" minsize="1.2em" stretchy="true" symmetric="true">/</mml:mo></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, evaluated over some finite window between <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf55"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>(see <xref ref-type="bibr" rid="bib70">Szucs, 1998</xref>). We set the window to be <inline-formula><mml:math id="inf56"><mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>⁢</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and evaluated the convolution using a time-step of 10 ms. We defined the standard deviation <inline-formula><mml:math id="inf57"><mml:mi>σ</mml:mi></mml:math></inline-formula> of the Gaussian by the median inter-spike interval of the population: <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msqrt><mml:mn>12</mml:mn></mml:msqrt></mml:mrow></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="bibr" rid="bib33">Humphries, 2011</xref>).</p><p>To visualise the entire population’s spiking activity (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), we cluster neurons by the similarity of their firing patterns using our modular deconstruction toolbox (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>). Different dynamical types of ensembles were identified by the properties of their autocorrelograms: tonic, oscillator, burster, or pauser - see (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>) for details. We also assigned each neuron in the ensemble the same dynamical label, which we use in the analysis of <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>. To demonstrate the firing rate change of each ensemble (<xref ref-type="fig" rid="fig4">Figure 4</xref>), we first counted the number of spikes emitted by that ensemble in 20 s windows, advanced in 5 s steps from the onset of stimulation. We then correlated (Pearson’s <inline-formula><mml:math id="inf59"><mml:mi>R</mml:mi></mml:math></inline-formula>) the time of each window against its spike count: ensembles were classified as decreasing rate if <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mo>−</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, and increasing if <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>R</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-4"><title>Model network</title><p>We used a three-neuron network to demonstrate the dynamical properties of a periodic attractor as realised by neurons (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Each neuron’s membrane dynamics were given by <inline-formula><mml:math id="inf62"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with adaptation dynamics <inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and output firing rate <inline-formula><mml:math id="inf64"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Weights <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> give the strength of inhibitory connections between the neurons, each of which receives a driving input <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. This model, due to Matsuoka (<xref ref-type="bibr" rid="bib56">Matsuoka, 1985</xref>, <xref ref-type="bibr" rid="bib57">1987</xref>), generates self-sustained oscillation of network firing rates given constant scalar inputs <inline-formula><mml:math id="inf67"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>, despite each neuron not being an endogenous oscillator: consequently the oscillations are an emergent property of the network. The time constants of membrane <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> and adaptation <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> dynamics, together with the strength of adaptation <inline-formula><mml:math id="inf70"><mml:mi>γ</mml:mi></mml:math></inline-formula>, determine the periodicity of the oscillations (<xref ref-type="bibr" rid="bib56">Matsuoka, 1985</xref>, <xref ref-type="bibr" rid="bib57">1987</xref>). Here we use <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.025</mml:mn></mml:mrow></mml:math></inline-formula> s, <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> s, and <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>; input was <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> throughout except where noted.</p></sec><sec id="s4-5"><title>Recurrence analysis</title><p>Low dimensional projections of the joint population activity were obtained for each program using standard principal components analysis, applied to the covariance matrix of the spike-density functions. The <inline-formula><mml:math id="inf75"><mml:mi>d</mml:mi></mml:math></inline-formula> leading eigenvectors <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of the covariance matrix define the <inline-formula><mml:math id="inf77"><mml:mi>d</mml:mi></mml:math></inline-formula> principal dimensions, and the <inline-formula><mml:math id="inf78"><mml:mi>d</mml:mi></mml:math></inline-formula> corresponding eigenvalues are proportional to the variance accounted for by each dimension. The projection (the ‘principal component’) onto each of the chosen dimensions is given by <inline-formula><mml:math id="inf79"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where the sum is taken over all <inline-formula><mml:math id="inf80"><mml:mi>n</mml:mi></mml:math></inline-formula> neurons in the analyzed population.</p><p>We used recurrence analysis (<xref ref-type="bibr" rid="bib45">Lathrop and Kostelich, 1989</xref>; <xref ref-type="bibr" rid="bib55">Marwan et al., 2007</xref>) to determine if the low-dimensional projection contained a stable periodic orbit. To do so, we checked if the low-dimensional projection <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <inline-formula><mml:math id="inf82"><mml:mi>t</mml:mi></mml:math></inline-formula> recurred at some time <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula> in the future. Recurrence was defined as the first point <inline-formula><mml:math id="inf84"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that was less than some Euclidean distance <inline-formula><mml:math id="inf85"><mml:mi>θ</mml:mi></mml:math></inline-formula> from <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The recurrence time of point <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is thus <inline-formula><mml:math id="inf88"><mml:mi>δ</mml:mi></mml:math></inline-formula>s. Contiguous regions of the projection’s trajectory from <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that remained within distance <inline-formula><mml:math id="inf90"><mml:mi>θ</mml:mi></mml:math></inline-formula> were excluded. Threshold <inline-formula><mml:math id="inf91"><mml:mi>θ</mml:mi></mml:math></inline-formula> was chosen based on the distribution of all distances between time-points, so that it was scaled to the activity levels in that particular program. Throughout we use the 10% value of that distribution as <inline-formula><mml:math id="inf92"><mml:mi>θ</mml:mi></mml:math></inline-formula> for robustness to noise; similar periodicity of recurrence was maintained at all tested thresholds from 2% upwards (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>We checked every time-point <inline-formula><mml:math id="inf93"><mml:mi>t</mml:mi></mml:math></inline-formula> between 5 s after stimulation until 10 s before the end of the recording (around 7770 points per program), determining whether it was or was not recurrent. We then constructed a histogram of the recurrence times using 1 s bins to detect periodic orbits (<xref ref-type="fig" rid="fig2">Figure 2E</xref>): a large peak in the histogram indicates a high frequency of the same delay between recurrent points, and thus a periodic orbit in the system. All delays less than 5 s were excluded to eliminate quasi-periodic activity due to noise in otherwise contiguous trajectories. Peaks were then defined as contiguous parts of the histogram between empty bins, and which contained more than 100 recurrent points. Programs had between one and four such periodic orbits. The peak containing the greatest number of recurrent points was considered the dominant periodic orbit of the program; the majority of programs had more than 50% of their recurrent points in this peak (blue-scale vectors in <xref ref-type="fig" rid="fig2">Figure 2E</xref>). The mean orbit period of the program was then estimated from the mean value of all recurrence times in that peak.</p><p>We measured the attractor’s stability as the percentage of all points that were in periodic orbits. Evolving dynamics of each program were analysed using 5 s sliding windows, advanced in steps of 1 s. We defined the ‘coalescence’ time of the attractor as the mid-point of the first window in which at least 90% of the points on the trajectory were recurrent.</p></sec><sec id="s4-6"><title>Testing convergence to the same manifold</title><p>To determine if sequentially-evoked programs had the same manifold, we determined how closely the trajectories of each pair of programs overlapped in the low-dimensional space. We first projected all three programs from one preparation onto the principal axes of the first program, to define a common low-dimensional space. For each pair of programs <inline-formula><mml:math id="inf94"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in this projection, we then computed the Haussdorf distance between their two sets of recurrent points, as this metric is suited to handling tests of closeness between irregularly shaped sets of points. Given the Euclidean distances <inline-formula><mml:math id="inf95"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> from all recurrent points in <inline-formula><mml:math id="inf96"><mml:mi>A</mml:mi></mml:math></inline-formula> to those in <inline-formula><mml:math id="inf97"><mml:mi>B</mml:mi></mml:math></inline-formula>, and vice-versa <inline-formula><mml:math id="inf98"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, this is the maximum minimum distance needed to travel from a point in one program to a point in the other (namely <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). To understand if the resulting distances were close, we shuffled the assignment of time-series to neurons, then projected onto the same axes giving shuffled programs <inline-formula><mml:math id="inf100"><mml:msup><mml:mi>A</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf101"><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. These give the trajectories in the low-dimensional space determined by just the firing patterns of neurons. We then computed the shuffled Haussdorf distance <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>). The shuffling was repeated 100 times. Mean <inline-formula><mml:math id="inf103"><mml:mo>±</mml:mo></mml:math></inline-formula> 2SEM of the shuffled distances are plotted in (<xref ref-type="fig" rid="fig3">Figure 3C</xref>); the error bars are too small to see.</p><p>To check the robustness of the convergence to the same manifold, we repeated this analysis starting from a common set of principal axes for the three programs, obtained using principal component analysis of their concatenated spike-density functions. We plot the results of this analysis in panel A of <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p><p>As a further robustness control, we sought evidence of the manifold convergence independent of any low-dimensional projection. We made use of the idea that if neurons are part of sequential programs on a single manifold, then the firing of pairs of neurons should have a similar time-dependence between programs (<xref ref-type="bibr" rid="bib73">Yoon et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Peyrache et al., 2015</xref>). For each pair of programs <inline-formula><mml:math id="inf104"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from the same preparation, we computed the similarity matrix <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> between the spike-density functions of all neuron pairs in <inline-formula><mml:math id="inf106"><mml:mi>A</mml:mi></mml:math></inline-formula>, and similarly for <inline-formula><mml:math id="inf107"><mml:mi>B</mml:mi></mml:math></inline-formula>, giving <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We then computed the correlation coefficient between <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>: if <inline-formula><mml:math id="inf111"><mml:mi>A</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf112"><mml:mi>B</mml:mi></mml:math></inline-formula> are on the same manifold, so their pairwise correlations should themselves be strongly correlated. As a control we computed a null model where each neuron has same total amount of similarity as in the data, but its pairwise similarity with each neuron is randomly distributed (<xref ref-type="bibr" rid="bib33">Humphries, 2011</xref>). The expected value of pairwise correlation between neurons <inline-formula><mml:math id="inf113"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:mi>j</mml:mi></mml:math></inline-formula> under this model is then <inline-formula><mml:math id="inf115"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf116"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) are the total similarities for neurons <inline-formula><mml:math id="inf117"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf118"><mml:mi>j</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf119"><mml:mi>T</mml:mi></mml:math></inline-formula> is the total similarity in the data matrix. For comparison, we correlated <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf121"><mml:mi>E</mml:mi></mml:math></inline-formula>, and plot these as the control correlations in <xref ref-type="fig" rid="fig3">Figure 3E</xref>.</p></sec><sec id="s4-7"><title>Testing return to the same manifold after perturbation</title><p>We detected divergences of the trajectory away from the putative manifold, indicating spontaneous perturbations of population dynamics. We first defined potential perturbations after coalescence as a contiguous set of 5 s windows when the density of recurrent points was below 90% and fell below 50% at least once. The window with the lowest recurrence density in this divergent period was labelled the divergent point. We removed all such divergent periods whose divergent point fell within two oscillation cycles of the end of the recording, to rule out a fall in recurrence due solely to the finite time horizon of the recording. For the remaining 19 divergent periods, we then determined if the population activity returned to a recurrent state after the divergent point; that is, whether the density of recurrence returned above 90% or not. The majority (17/19) did, indicating the perturbation returned to a manifold.</p><p>For those 17 that did, we then determined if the recurrent state post-divergence was the same manifold, or a different manifold. For it to be the same manifold after the spontaneous perturbation, then the trajectory before the perturbation should recur after the maximum divergence. To check this, we took the final window before the divergent period, and counted the proportion of its recurrent delays that were beyond the end of the divergent period, so indicating that the dynamics were in the same trajectory before and after the divergence. We plot this in <xref ref-type="fig" rid="fig3">Figure 3H</xref>.</p></sec><sec id="s4-8"><title>Statistical estimation of the attractor’s parameters</title><p>We introduce here a statistical approach to analysing the dynamics of low-dimensional projections of neural activity time-series obtained from experiments. We first fitted a linear model around each point on the low-dimensional trajectory to capture the local dynamics. For each point <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we took the time-series of points before and after <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that were contiguous in time and within <inline-formula><mml:math id="inf124"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> as its local neighbourhood; if less than 100 points met these criteria <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was discarded. We then fitted the dynamical model <inline-formula><mml:math id="inf126"><mml:mrow><mml:mover accent="true"><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> that described the local evolution of the low-dimensional projection <inline-formula><mml:math id="inf127"><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> by using linear regression to find the Jacobian matrix <inline-formula><mml:math id="inf128"><mml:mi>A</mml:mi></mml:math></inline-formula>; to do so, we used the selected local neighbourhood time-series as <inline-formula><mml:math id="inf129"><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, and their first-order difference as <inline-formula><mml:math id="inf130"><mml:mover accent="true"><mml:msup><mml:mi>P</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>. The maximum eigenvalue <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf132"><mml:mi>A</mml:mi></mml:math></inline-formula> indicates the dominant local dynamics (<xref ref-type="bibr" rid="bib69">Strogatz, 1994</xref>), whether contracting or expanding (sign of the real part <inline-formula><mml:math id="inf133"><mml:mi>a</mml:mi></mml:math></inline-formula> of the eigenvalue), and whether oscillating or not (existence of the complex part of the eigenvalue that is, <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>b</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). The other eigenvalues, corresponding to the <inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>d</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> remaining dimensions, indicate other less-dominant dynamics; usually these were consistent across all dimensions (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). We fitted <inline-formula><mml:math id="inf136"><mml:mi>A</mml:mi></mml:math></inline-formula> to every point <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> after the stimulation off-set, typically giving <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mn>5000</mml:mn></mml:mrow></mml:math></inline-formula> local estimates of dynamics from retained <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The dominant dynamics for the whole program were estimated by averaging over the real <inline-formula><mml:math id="inf140"><mml:mi>a</mml:mi></mml:math></inline-formula> and the complex <inline-formula><mml:math id="inf141"><mml:mi>b</mml:mi></mml:math></inline-formula> parts of the maximum eigenvalues of the models fitted to all recurrent points in the dominant periodic orbit. The linear model’s estimate of the orbit rotation period was estimated from the complex part as <inline-formula><mml:math id="inf142"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, with the sampling time-step <inline-formula><mml:math id="inf143"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> s here. The linear model’s estimate of the contraction rate is <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which we express as a percentage.</p></sec><sec id="s4-9"><title>Tracking changes in periodicity over a program</title><p>We tracked changes in the oscillation period by first averaging the recurrence time of all recurrent points in a 5 s sliding window. We then correlated the mean time with the time-point of the window to look for sustained changes in the mean period over time, considering only windows between coalescence and the final window with 90% recurrent points. We used a weighted version of Spearman’s rank to weight the correlation in favour of time windows in which the trajectory was most clearly on the periodic orbit, namely those with a high proportion of recurrent points and low variation in recurrence time. The weighted rank correlation is: given vectors <inline-formula><mml:math id="inf145"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf146"><mml:mi>y</mml:mi></mml:math></inline-formula> of data rankings, and a vector of weights <inline-formula><mml:math id="inf147"><mml:mi>w</mml:mi></mml:math></inline-formula>, compute the weighted mean <inline-formula><mml:math id="inf148"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf149"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and then the correlation <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></inline-formula>. We used the weight vector: <inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the standard deviation of recurrence times in window <inline-formula><mml:math id="inf153"><mml:mi>i</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the proportion of recurrent points in window <inline-formula><mml:math id="inf155"><mml:mi>i</mml:mi></mml:math></inline-formula>. P-values were obtained using a permutation test with 10000 permutations.</p></sec><sec id="s4-10"><title>Decoding motor output</title><p>We decoded P10 activity from the low-dimensional trajectory of population activity using a generalised linear model. We first ruled out that any simultaneously recorded neuron was a motorneuron with an axon in nerve P10, by checking if any neurons had a high ratio of locking between their emitted spikes and spikes occurring at short latency in the P10 recording. <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> shows that no neuron had a consistent, high ratio locking of its spikes with the P10 activity.</p><p>We convolved the spikes of the P10 recording with a Gaussian of the same width as the spike-density functions of the simultaneously recorded program, to estimate its continuous firing rate <inline-formula><mml:math id="inf156"><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula>. We fitted the model <inline-formula><mml:math id="inf157"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to determine the P10 firing rate as a function of the past history of the population activity trajectory. Using a generalised linear model here allows us to transform the arbitrary co-ordinates of the <inline-formula><mml:math id="inf158"><mml:mi>d</mml:mi></mml:math></inline-formula>-dimensional projection <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> into a strictly positive firing rate. Fitting used glmfit in MATLAB R2014. To cross-validate the model, we found the coefficients <inline-formula><mml:math id="inf160"><mml:mi>β</mml:mi></mml:math></inline-formula> using a 40 s window of data, then forecast the P10 firing rate <inline-formula><mml:math id="inf161"><mml:msubsup><mml:mi>f</mml:mi><mml:mn>10</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> using the next 10 s of population recording data as input to the model. Forecast error was measured as both the median absolute error and the correlation coefficient <inline-formula><mml:math id="inf162"><mml:mi>R</mml:mi></mml:math></inline-formula> between the actual and forecast P10 activity in the 10 s window. The fitting and forecasting were repeated using a 1 s step of the windows, until the final 40 s + 10 s pair of windows available in the recording.</p><p>We tested activity histories between 50 and 200 ms duration, with time-steps of 10 ms, so that the largest model for a given program had <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>d</mml:mi><mml:mo>×</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> coefficients. These short windows were chosen to rule out the contributions of other potential motorneurons in the population recording that would be phase offset from neck contraction (as 200 ms is 2% of the typical period). All results were robust to the choice of history duration, so we plot results using history durations that had the smallest median absolute error in forecasting for that program.</p></sec><sec id="s4-11"><title>Single neuron participation</title><p>We quantified each neuron’s participation in the low-dimensional projection as the L1-norm: the absolute sum of its weights on the principal axes (eigenvectors) for program <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mo>:</mml:mo><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>W</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where the sum is over the <inline-formula><mml:math id="inf165"><mml:mi>d</mml:mi></mml:math></inline-formula> principal axes, <inline-formula><mml:math id="inf166"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the neuron’s weight on the <inline-formula><mml:math id="inf167"><mml:mi>j</mml:mi></mml:math></inline-formula>th axis, and <inline-formula><mml:math id="inf168"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> is the axis’ corresponding eigenvalue. Within a program, participation for each neuron was normalised to the maximum participation in that program. To fit a noise model for the variability in participation between programs, we first computed the change in participation for each neuron between all pairs of programs in the same preparation. We then fit a Gaussian model for the noise, using an iterative maximum likelihood approach to identify the likely outliers; here the outliers are the participation changes that are inconsistent with stochastic noise. In this approach, we compute the mean and variance of the Gaussian from the data, eliminate the data-point furthest from the estimate of the mean, re-estimate the mean and variance, and compute the new log likelihood of the Gaussian model without that data-point. We iterate elimination, re-estimation, and likelihood computation until the likelihood decreases. The final model (mean and variance) found before the decrease is then the best-fit Gaussian model to the bulk of the data. Neurons whose maximum change in participation exceeded a threshold of the mean <inline-formula><mml:math id="inf169"><mml:mrow><mml:mo>±</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>SD of that best-fit model were then considered ‘strongly variable’ neurons.</p><p>We asked whether the variation in low-dimensional dynamics of sequentially-evoked programs was a consequence of the degree of variation in single neuron participation. Between a pair of consecutively evoked programs, we quantified the variation in their low dimensional dynamics as the Hausdorff distance between them, normalised by the mean distance between their random projections. This normalisation allowed us to put all programs on a single scale measuring the closeness relative to random projections, such that one indicates equivalence to a random projection, <inline-formula><mml:math id="inf170"><mml:mrow><mml:mi/><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> indicates closer than random projections, and <inline-formula><mml:math id="inf171"><mml:mrow><mml:mi/><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> indicates further apart then random projections. For a given pair of programs, we quantified the variability of individual neurons’ participation in two ways: by summing the change in participation of each neuron between the programs; and by computing the Hellinger distance between the two distributions of participation (one distribution per program).</p></sec><sec id="s4-12"><title>Participation maps</title><p>Each neuron’s (x,y) location on the plane of the photodiode array could be estimated from the weight matrix from the independent component analysis of the original 464 photodiode time-series; see (<xref ref-type="bibr" rid="bib11">Bruno et al., 2015</xref>) for full details. We were able to reconstruct locations for all neurons in 8 of the 10 recorded preparations; for the other two preparations, partial corruption of the original spike-sorting analysis data prevented reconstructions of some neuron locations in one; for the other, we could not determine on what side it was recorded. We merged all left or right ganglion recordings on to a common template of the photodiode array. The marker sizes and colour codes for each neuron were proportional to the normalised maximum participation of that neuron (<xref ref-type="fig" rid="fig8">Figure 8A,C</xref>) and to the range of normalised maximum participation across the three programs (<xref ref-type="fig" rid="fig8">Figure 8B,D</xref>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank R Petersen and B Mensh for comments on drafts, A Singh for suggesting the Hausdorff distance, and J Wang for technical assistance. MDH was supported by a Medical Research Council Senior non-Clinical Fellowship. WF was supported by NIH R01NS060921 and NSF 1257923. AB was supported by NIH F31NS079036.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>AMB, Conceptualization, Data curation, Investigation, Methodology, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>WNF, Conceptualization, Supervision, Funding acquisition, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>MDH, Conceptualization, Software, Formal analysis, Visualization, Methodology, Writing—original draft</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following dataset was generated:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://dx.doi.org/10.6080/K0SN074B" source-id-type="uri"><collab>Angela M Bruno</collab><x>,</x> <collab>William N Frost</collab><x>,</x> <year>2017</year><x>,</x><source>apl-1: Voltage sensitive dye recording of multiple bouts of escape locomotion in the pedal ganglion of Aplysia californica</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.6080/K0SN074B">http://dx.doi.org/10.6080/K0SN074B</ext-link><x>,</x> <comment>Publicly available from Collaborative Research in Computational Neuroscience (accession no. K0SN074B)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Li</surname><given-names>JM</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name><name><surname>Robson</surname><given-names>DN</given-names></name><name><surname>Schier</surname><given-names>AF</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name><name><surname>Portugues</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Brain-wide neuronal dynamics during motor adaptation in zebrafish</article-title><source>Nature</source><volume>485</volume><fpage>471</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.1038/nature11057</pub-id><pub-id pub-id-type="pmid">22622571</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartho</surname><given-names>P</given-names></name><name><surname>Curto</surname><given-names>C</given-names></name><name><surname>Luczak</surname><given-names>A</given-names></name><name><surname>Marguet</surname><given-names>SL</given-names></name><name><surname>Harris</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Population coding of tone stimuli in auditory cortex: dynamic rate vector analysis</article-title><source>European Journal of Neuroscience</source><volume>30</volume><fpage>1767</fpage><lpage>1778</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2009.06954.x</pub-id><pub-id pub-id-type="pmid">19840110</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>RW</given-names></name><name><surname>Alaburda</surname><given-names>A</given-names></name><name><surname>Hounsgaard</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Balanced inhibition and excitation drive spike activity in spinal half-centers</article-title><source>Science</source><volume>315</volume><fpage>390</fpage><lpage>393</lpage><pub-id pub-id-type="doi">10.1126/science.1134960</pub-id><pub-id pub-id-type="pmid">17234950</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bokil</surname><given-names>H</given-names></name><name><surname>Andrews</surname><given-names>P</given-names></name><name><surname>Kulkarni</surname><given-names>JE</given-names></name><name><surname>Mehta</surname><given-names>S</given-names></name><name><surname>Mitra</surname><given-names>PP</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Chronux: a platform for analyzing neural signals</article-title><source>Journal of Neuroscience Methods</source><volume>192</volume><fpage>146</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2010.06.020</pub-id><pub-id pub-id-type="pmid">20637804</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Abarbanel</surname><given-names>HD</given-names></name><name><surname>Kristan</surname><given-names>WB</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Optical imaging of neuronal populations during decision-making</article-title><source>Science</source><volume>307</volume><fpage>896</fpage><lpage>901</lpage><pub-id pub-id-type="doi">10.1126/science.1103736</pub-id><pub-id pub-id-type="pmid">15705844</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Abarbanel</surname><given-names>HD</given-names></name><name><surname>Kristan</surname><given-names>WB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>From crawling to cognition: analyzing the dynamical interactions among populations of neurons</article-title><source>Current Opinion in Neurobiology</source><volume>16</volume><fpage>135</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2006.03.014</pub-id><pub-id pub-id-type="pmid">16564165</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Kristan</surname><given-names>WB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Imaging dedicated and multifunctional neural circuits generating distinct behaviors</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>10925</fpage><lpage>10933</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3265-06.2006</pub-id><pub-id pub-id-type="pmid">17050731</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Briggman</surname><given-names>KL</given-names></name><name><surname>Kristan</surname><given-names>WB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Multifunctional pattern-generating circuits</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><fpage>271</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.31.060407.125552</pub-id><pub-id pub-id-type="pmid">18558856</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brody</surname><given-names>CD</given-names></name><name><surname>Romo</surname><given-names>R</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Basic mechanisms for graded persistent activity: discrete attractors, continuous attractors, and dynamic representations</article-title><source>Current Opinion in Neurobiology</source><volume>13</volume><fpage>204</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1016/S0959-4388(03)00050-3</pub-id><pub-id pub-id-type="pmid">12744975</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>EN</given-names></name><name><surname>Kass</surname><given-names>RE</given-names></name><name><surname>Mitra</surname><given-names>PP</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Multiple neural spike train data analysis: state-of-the-art and future challenges</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>456</fpage><lpage>461</lpage><pub-id pub-id-type="doi">10.1038/nn1228</pub-id><pub-id pub-id-type="pmid">15114358</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bruno</surname><given-names>AM</given-names></name><name><surname>Frost</surname><given-names>WN</given-names></name><name><surname>Humphries</surname><given-names>MD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Modular deconstruction reveals the dynamical and physical building blocks of a locomotion motor program</article-title><source>Neuron</source><volume>86</volume><fpage>304</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.005</pub-id><pub-id pub-id-type="pmid">25819612</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calin-Jageman</surname><given-names>RJ</given-names></name><name><surname>Tunstall</surname><given-names>MJ</given-names></name><name><surname>Mensh</surname><given-names>BD</given-names></name><name><surname>Katz</surname><given-names>PS</given-names></name><name><surname>Frost</surname><given-names>WN</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Parameter space analysis suggests multi-site plasticity contributes to motor pattern initiation in Tritonia</article-title><source>Journal of Neurophysiology</source><volume>98</volume><fpage>2382</fpage><lpage>2398</lpage><pub-id pub-id-type="doi">10.1152/jn.00572.2007</pub-id><pub-id pub-id-type="pmid">17652417</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carmena</surname><given-names>JM</given-names></name><name><surname>Lebedev</surname><given-names>MA</given-names></name><name><surname>Henriquez</surname><given-names>CS</given-names></name><name><surname>Nicolelis</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Stable ensemble performance with single-neuron variability during reaching movements in primates</article-title><source>Journal of Neuroscience</source><volume>25</volume><fpage>10712</fpage><lpage>10716</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2772-05.2005</pub-id><pub-id pub-id-type="pmid">16291944</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carroll</surname><given-names>MS</given-names></name><name><surname>Ramirez</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cycle-by-cycle assembly of respiratory network activity is dynamic and stochastic</article-title><source>Journal of Neurophysiology</source><volume>109</volume><fpage>296</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1152/jn.00830.2011</pub-id><pub-id pub-id-type="pmid">22993257</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chestek</surname><given-names>CA</given-names></name><name><surname>Batista</surname><given-names>AP</given-names></name><name><surname>Santhanam</surname><given-names>G</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name><name><surname>Afshar</surname><given-names>A</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Gilja</surname><given-names>V</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Single-neuron stability during repeated reaching in macaque premotor cortex</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>10742</fpage><lpage>10750</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0959-07.2007</pub-id><pub-id pub-id-type="pmid">17913908</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cortical preparatory activity: representation of movement or first cog in a dynamical machine?</article-title><source>Neuron</source><volume>68</volume><fpage>387</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.09.015</pub-id><pub-id pub-id-type="pmid">21040842</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Churchland</surname><given-names>MM</given-names></name><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Kaufman</surname><given-names>MT</given-names></name><name><surname>Foster</surname><given-names>JD</given-names></name><name><surname>Nuyujukian</surname><given-names>P</given-names></name><name><surname>Ryu</surname><given-names>SI</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural population dynamics during reaching</article-title><source>Nature</source><volume>487</volume><fpage>51</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1038/nature11129</pub-id><pub-id pub-id-type="pmid">22722855</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cunningham</surname><given-names>JP</given-names></name><name><surname>Yu</surname><given-names>BM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dimensionality reduction for large-scale neural recordings</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1500</fpage><lpage>1509</lpage><pub-id pub-id-type="doi">10.1038/nn.3776</pub-id><pub-id pub-id-type="pmid">25151264</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eliasmith</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A unified approach to building and controlling spiking attractor networks</article-title><source>Neural Computation</source><volume>17</volume><fpage>1276</fpage><lpage>1314</lpage><pub-id pub-id-type="doi">10.1162/0899766053630332</pub-id><pub-id pub-id-type="pmid">15901399</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flinn</surname><given-names>JM</given-names></name><name><surname>Gochman</surname><given-names>P</given-names></name><name><surname>Wanschura</surname><given-names>P</given-names></name><name><surname>Chandhoke</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The effect of dopamine receptor blockade on motor behavior in Aplysia californica</article-title><source>Pharmacology Biochemistry and Behavior</source><volume>69</volume><fpage>425</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1016/S0091-3057(01)00562-7</pub-id><pub-id pub-id-type="pmid">11509200</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fredman</surname><given-names>SM</given-names></name><name><surname>Jahan-Parwar</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Role of pedal ganglia motor neurons in pedal wave generation in Aplysia</article-title><source>Brain Research Bulletin</source><volume>5</volume><fpage>179</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.1016/0361-9230(80)90191-4</pub-id><pub-id pub-id-type="pmid">7378857</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Georgopoulos</surname><given-names>AP</given-names></name><name><surname>Schwartz</surname><given-names>AB</given-names></name><name><surname>Kettner</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Neuronal population coding of movement direction</article-title><source>Science</source><volume>233</volume><fpage>1416</fpage><lpage>1419</lpage><pub-id pub-id-type="doi">10.1126/science.3749885</pub-id><pub-id pub-id-type="pmid">3749885</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Getting</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Emerging principles governing the operation of neural networks</article-title><source>Annual Review of Neuroscience</source><volume>12</volume><fpage>185</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1146/annurev.ne.12.030189.001153</pub-id><pub-id pub-id-type="pmid">2648949</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>JD</given-names></name><name><surname>Lloyd</surname><given-names>PE</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Involvement of pedal peptide in locomotion in Aplysia: modulation of foot muscle contractions</article-title><source>Journal of Neurobiology</source><volume>21</volume><fpage>858</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1002/neu.480210604</pub-id><pub-id pub-id-type="pmid">2077102</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey</surname><given-names>CD</given-names></name><name><surname>Coen</surname><given-names>P</given-names></name><name><surname>Tank</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Choice-specific sequences in parietal cortex during a virtual-navigation decision task</article-title><source>Nature</source><volume>484</volume><fpage>62</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1038/nature10918</pub-id><pub-id pub-id-type="pmid">22419153</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hatsopoulos</surname><given-names>NG</given-names></name><name><surname>Xu</surname><given-names>Q</given-names></name><name><surname>Amit</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Encoding of movement fragments in the motor cortex</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>5105</fpage><lpage>5114</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3570-06.2007</pub-id><pub-id pub-id-type="pmid">17494696</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawkins</surname><given-names>RD</given-names></name><name><surname>Clark</surname><given-names>GA</given-names></name><name><surname>Kandel</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Operant conditioning of gill withdrawal in Aplysia</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>2443</fpage><lpage>2448</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3294-05.2006</pub-id><pub-id pub-id-type="pmid">16510722</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hening</surname><given-names>WA</given-names></name><name><surname>Walters</surname><given-names>ET</given-names></name><name><surname>Carew</surname><given-names>TJ</given-names></name><name><surname>Kandel</surname><given-names>ER</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Motorneuronal control of locomotion in Aplysia</article-title><source>Brain Research</source><volume>179</volume><fpage>231</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(79)90441-4</pub-id><pub-id pub-id-type="pmid">509237</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname><given-names>ES</given-names></name><name><surname>Moore-Kochlacs</surname><given-names>C</given-names></name><name><surname>Vasireddi</surname><given-names>SK</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name><name><surname>Frost</surname><given-names>WN</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Validation of independent component analysis for rapid spike sorting of optical recording data</article-title><source>Journal of Neurophysiology</source><volume>104</volume><fpage>3721</fpage><lpage>3731</lpage><pub-id pub-id-type="doi">10.1152/jn.00691.2010</pub-id><pub-id pub-id-type="pmid">20861441</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname><given-names>ES</given-names></name><name><surname>Vasireddi</surname><given-names>SK</given-names></name><name><surname>Bruno</surname><given-names>AM</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Frost</surname><given-names>WN</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Variable neuronal participation in stereotypic motor programs</article-title><source>PLoS One</source><volume>7</volume><elocation-id>e40579</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0040579</pub-id><pub-id pub-id-type="pmid">22815768</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hill</surname><given-names>ES</given-names></name><name><surname>Vasireddi</surname><given-names>SK</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Bruno</surname><given-names>AM</given-names></name><name><surname>Frost</surname><given-names>WN</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Memory formation in Tritonia via recruitment of variably committed neurons</article-title><source>Current Biology</source><volume>25</volume><fpage>2879</fpage><lpage>2888</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.09.033</pub-id><pub-id pub-id-type="pmid">26549261</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>D</given-names></name><name><surname>Gutnisky</surname><given-names>DA</given-names></name><name><surname>Peron</surname><given-names>S</given-names></name><name><surname>O'Connor</surname><given-names>DH</given-names></name><name><surname>Wiegert</surname><given-names>JS</given-names></name><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Oertner</surname><given-names>TG</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name><name><surname>Svoboda</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Multiple dynamic representations in the motor cortex during sensorimotor learning</article-title><source>Nature</source><volume>484</volume><fpage>473</fpage><lpage>478</lpage><pub-id pub-id-type="doi">10.1038/nature11039</pub-id><pub-id pub-id-type="pmid">22538608</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>MD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spike-train communities: finding groups of similar spike trains</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>2321</fpage><lpage>2336</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2853-10.2011</pub-id><pub-id pub-id-type="pmid">21307268</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>MD</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>AplysiaAttractorAnalysis</data-title><source>Github</source><version>941b08dc5bc9958e74c59827cbdac131e225f3</version><uri xlink:href="https://github.com/mdhumphries/AplysiaAttractorAnalysis">https://github.com/mdhumphries/AplysiaAttractorAnalysis</uri></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahan-Parwar</surname><given-names>B</given-names></name><name><surname>Fredman</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Neural control of locomotion in Aplysia: role of the central ganglia</article-title><source>Behavioral and Neural Biology</source><volume>27</volume><fpage>39</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/S0163-1047(79)92744-4</pub-id><pub-id pub-id-type="pmid">496793</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jahan-Parwar</surname><given-names>B</given-names></name><name><surname>Fredman</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Motor program for pedal waves during Aplysia locomotion is generated in the pedal ganglia</article-title><source>Brain Research Bulletin</source><volume>5</volume><fpage>169</fpage><lpage>177</lpage><pub-id pub-id-type="doi">10.1016/0361-9230(80)90190-2</pub-id><pub-id pub-id-type="pmid">7378856</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jing</surname><given-names>J</given-names></name><name><surname>Vilim</surname><given-names>FS</given-names></name><name><surname>Cropper</surname><given-names>EC</given-names></name><name><surname>Weiss</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural analog of arousal: persistent conditional activation of a feeding modulator by serotonergic initiators of locomotion</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>12349</fpage><lpage>12361</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3855-08.2008</pub-id><pub-id pub-id-type="pmid">19020028</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kato</surname><given-names>S</given-names></name><name><surname>Kaplan</surname><given-names>HS</given-names></name><name><surname>Schrödel</surname><given-names>T</given-names></name><name><surname>Skora</surname><given-names>S</given-names></name><name><surname>Lindsay</surname><given-names>TH</given-names></name><name><surname>Yemini</surname><given-names>E</given-names></name><name><surname>Lockery</surname><given-names>S</given-names></name><name><surname>Zimmer</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Global brain dynamics embed the motor command sequence of Caenorhabditis elegans</article-title><source>Cell</source><volume>163</volume><fpage>656</fpage><lpage>669</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.09.034</pub-id><pub-id pub-id-type="pmid">26478179</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname><given-names>PS</given-names></name><name><surname>Getting</surname><given-names>PA</given-names></name><name><surname>Frost</surname><given-names>WN</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Dynamic neuromodulation of synaptic strength intrinsic to a central pattern generator circuit</article-title><source>Nature</source><volume>367</volume><fpage>729</fpage><lpage>731</lpage><pub-id pub-id-type="doi">10.1038/367729a0</pub-id><pub-id pub-id-type="pmid">8107867</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname><given-names>PS</given-names></name><name><surname>Sakurai</surname><given-names>A</given-names></name><name><surname>Clemens</surname><given-names>S</given-names></name><name><surname>Davis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Cycle period of a network oscillator is independent of membrane potential and spiking activity in individual central pattern generator neurons</article-title><source>Journal of Neurophysiology</source><volume>92</volume><fpage>1904</fpage><lpage>1917</lpage><pub-id pub-id-type="doi">10.1152/jn.00864.2003</pub-id><pub-id pub-id-type="pmid">15115787</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kleinfeld</surname><given-names>D</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Associative neural network model for the generation of temporal patterns. Theory and application to central pattern generators</article-title><source>Biophysical Journal</source><volume>54</volume><fpage>1039</fpage><lpage>1051</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(88)83041-8</pub-id><pub-id pub-id-type="pmid">3233265</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobak</surname><given-names>D</given-names></name><name><surname>Brendel</surname><given-names>W</given-names></name><name><surname>Constantinidis</surname><given-names>C</given-names></name><name><surname>Feierstein</surname><given-names>CE</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name><name><surname>Qi</surname><given-names>XL</given-names></name><name><surname>Romo</surname><given-names>R</given-names></name><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Machens</surname><given-names>CK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Demixed principal component analysis of neural population data</article-title><source>eLife</source><volume>5</volume><elocation-id>e10989</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10989</pub-id><pub-id pub-id-type="pmid">27067378</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koch</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Systems biology. modular biological complexity</article-title><source>Science</source><volume>337</volume><fpage>531</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1126/science.1218616</pub-id><pub-id pub-id-type="pmid">22859475</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuenzi</surname> <given-names>FM</given-names></name><name><surname>Carew</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Head waving in Aplysia californica. III. Interganglionic pathways underlying the coordination and control of searching movements</article-title><source>The Journal of Experimental Biology</source><volume>195</volume><fpage>75</fpage><lpage>90</lpage><pub-id pub-id-type="pmid">7964420</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lathrop</surname><given-names>DP</given-names></name><name><surname>Kostelich</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Characterization of an experimental strange attractor by periodic orbits</article-title><source>Physical Review A</source><volume>40</volume><fpage>4028</fpage><lpage>4031</lpage><pub-id pub-id-type="doi">10.1103/PhysRevA.40.4028</pub-id><pub-id pub-id-type="pmid">9902623</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leonard</surname><given-names>JL</given-names></name><name><surname>Lukowiak</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The behavior of Aplysia californica Cooper (Gastropoda; Opisthobranchia): I. Ethogram</article-title><source>Behaviour</source><volume>98</volume><fpage>320</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1163/156853986X01035</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levi</surname><given-names>R</given-names></name><name><surname>Varona</surname><given-names>P</given-names></name><name><surname>Arshavsky</surname><given-names>YI</given-names></name><name><surname>Rabinovich</surname><given-names>MI</given-names></name><name><surname>Selverston</surname><given-names>AI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The role of sensory network dynamics in generating a motor program</article-title><source>Journal of Neuroscience</source><volume>25</volume><fpage>9807</fpage><lpage>9815</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2249-05.2005</pub-id><pub-id pub-id-type="pmid">16237184</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>JE</given-names></name><name><surname>Kristan</surname><given-names>WB</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>A neuronal network for computing population vectors in the leech</article-title><source>Nature</source><volume>391</volume><fpage>76</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1038/34172</pub-id><pub-id pub-id-type="pmid">9422507</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mante</surname><given-names>V</given-names></name><name><surname>Sussillo</surname><given-names>D</given-names></name><name><surname>Shenoy</surname><given-names>KV</given-names></name><name><surname>Newsome</surname><given-names>WT</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Context-dependent computation by recurrent dynamics in prefrontal cortex</article-title><source>Nature</source><volume>503</volume><fpage>78</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1038/nature12742</pub-id><pub-id pub-id-type="pmid">24201281</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Understanding circuit dynamics using the stomatogastric nervous system of lobsters and crabs</article-title><source>Annual Review of Physiology</source><volume>69</volume><fpage>291</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1146/annurev.physiol.69.031905.161516</pub-id><pub-id pub-id-type="pmid">17009928</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Multiple models to capture the variability in biological neurons and networks</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>133</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1038/nn.2735</pub-id><pub-id pub-id-type="pmid">21270780</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name><name><surname>Goeritz</surname><given-names>ML</given-names></name><name><surname>Otopalik</surname><given-names>AG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Robust circuit rhythms in small circuits arise from variable circuit components and mechanisms</article-title><source>Current Opinion in Neurobiology</source><volume>31</volume><fpage>156</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.10.012</pub-id><pub-id pub-id-type="pmid">25460072</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marinesco</surname><given-names>S</given-names></name><name><surname>Wickremasinghe</surname><given-names>N</given-names></name><name><surname>Kolkman</surname><given-names>KE</given-names></name><name><surname>Carew</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Serotonergic modulation in Aplysia. II. Cellular and behavioral consequences of increased serotonergic tone</article-title><source>Journal of Neurophysiology</source><volume>92</volume><fpage>2487</fpage><lpage>2496</lpage><pub-id pub-id-type="doi">10.1152/jn.00210.2004</pub-id><pub-id pub-id-type="pmid">15140904</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marr</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1982">1982</year><source>Vision</source><publisher-loc>San Francisco</publisher-loc><publisher-name>W. H. Freeman</publisher-name></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marwan</surname><given-names>N</given-names></name><name><surname>Carmenromano</surname><given-names>M</given-names></name><name><surname>Thiel</surname><given-names>M</given-names></name><name><surname>Kurths</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Recurrence plots for the analysis of complex systems</article-title><source>Physics Reports</source><volume>438</volume><fpage>237</fpage><lpage>329</lpage><pub-id pub-id-type="doi">10.1016/j.physrep.2006.11.001</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsuoka</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Sustained oscillations generated by mutually inhibiting neurons with adaptation</article-title><source>Biological Cybernetics</source><volume>52</volume><fpage>367</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1007/BF00449593</pub-id><pub-id pub-id-type="pmid">2996634</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsuoka</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Mechanisms of frequency and pattern control in the neural rhythm generators</article-title><source>Biological Cybernetics</source><volume>56</volume><fpage>345</fpage><lpage>353</lpage><pub-id pub-id-type="doi">10.1007/BF00319514</pub-id><pub-id pub-id-type="pmid">3620533</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mazor</surname><given-names>O</given-names></name><name><surname>Laurent</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Transient dynamics versus fixed points in odor representations by locust antennal lobe projection neurons</article-title><source>Neuron</source><volume>48</volume><fpage>661</fpage><lpage>673</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.09.032</pub-id><pub-id pub-id-type="pmid">16301181</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McPherson</surname><given-names>DR</given-names></name><name><surname>Blankenship</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Neuronal modulation of foot and body-wall contractions in Aplysia californica</article-title><source>Journal of Neurophysiology</source><volume>67</volume><fpage>23</fpage><lpage>28</lpage><pub-id pub-id-type="pmid">1552321</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dynamical systems, attractors, and neural circuits</article-title><source>F1000Research</source><volume>5</volume><fpage>992</fpage><pub-id pub-id-type="doi">10.12688/f1000research.7698.1</pub-id><pub-id pub-id-type="pmid">27408709</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panas</surname><given-names>D</given-names></name><name><surname>Amin</surname><given-names>H</given-names></name><name><surname>Maccione</surname><given-names>A</given-names></name><name><surname>Muthmann</surname><given-names>O</given-names></name><name><surname>van Rossum</surname><given-names>M</given-names></name><name><surname>Berdondini</surname><given-names>L</given-names></name><name><surname>Hennig</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sloppiness in spontaneously active neuronal networks</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>8480</fpage><lpage>8492</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4421-14.2015</pub-id><pub-id pub-id-type="pmid">26041916</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pasemann</surname><given-names>F</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Characterization of periodic attractors in neural ring networks</article-title><source>Neural Networks</source><volume>8</volume><fpage>421</fpage><lpage>429</lpage><pub-id pub-id-type="doi">10.1016/0893-6080(94)00085-Z</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petersen</surname><given-names>PC</given-names></name><name><surname>Berg</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Lognormal firing rate distribution reveals prominent fluctuation-driven regime in spinal motor networks</article-title><source>eLife</source><volume>5</volume><elocation-id>e18805</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.18805</pub-id><pub-id pub-id-type="pmid">27782883</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peyrache</surname><given-names>A</given-names></name><name><surname>Lacroix</surname><given-names>MM</given-names></name><name><surname>Petersen</surname><given-names>PC</given-names></name><name><surname>Buzsáki</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Internally organized mechanisms of the head direction sense</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>569</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1038/nn.3968</pub-id><pub-id pub-id-type="pmid">25730672</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Portugues</surname><given-names>R</given-names></name><name><surname>Feierstein</surname><given-names>CE</given-names></name><name><surname>Engert</surname><given-names>F</given-names></name><name><surname>Orger</surname><given-names>MB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Whole-brain activity maps reveal stereotyped, distributed networks for visuomotor behavior</article-title><source>Neuron</source><volume>81</volume><fpage>1328</fpage><lpage>1343</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.01.019</pub-id><pub-id pub-id-type="pmid">24656252</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rokni</surname><given-names>U</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>How the brain generates movement</article-title><source>Neural Computation</source><volume>24</volume><fpage>289</fpage><lpage>331</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00223</pub-id><pub-id pub-id-type="pmid">22023199</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seelig</surname><given-names>JD</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neural dynamics for landmark orientation and angular path integration</article-title><source>Nature</source><volume>521</volume><fpage>186</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1038/nature14446</pub-id><pub-id pub-id-type="pmid">25971509</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stopfer</surname><given-names>M</given-names></name><name><surname>Carew</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Development of sensitization in the escape locomotion system in Aplysia</article-title><source>Journal of Neuroscience</source><volume>8</volume><fpage>223</fpage><lpage>230</lpage><pub-id pub-id-type="pmid">3339411</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Strogatz</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="1994">1994</year><source>Nonlinear Dynamics and Chaos</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Westview Press</publisher-name></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szucs</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Applications of the spike density function in analysis of neuronal firing patterns</article-title><source>Journal of Neuroscience Methods</source><volume>81</volume><fpage>159</fpage><lpage>167</lpage><pub-id pub-id-type="doi">10.1016/S0165-0270(98)00033-8</pub-id><pub-id pub-id-type="pmid">9696321</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>JY</given-names></name><name><surname>Cohen</surname><given-names>LB</given-names></name><name><surname>Falk</surname><given-names>CX</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Neuronal activity during different behaviors in Aplysia: a distributed organization?</article-title><source>Science</source><volume>263</volume><fpage>820</fpage><lpage>823</lpage><pub-id pub-id-type="doi">10.1126/science.8303300</pub-id><pub-id pub-id-type="pmid">8303300</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xin</surname><given-names>Y</given-names></name><name><surname>Weiss</surname><given-names>KR</given-names></name><name><surname>Kupfermann</surname><given-names>I</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>An identified interneuron contributes to aspects of six different behaviors in Aplysia</article-title><source>Journal of Neuroscience</source><volume>16</volume><fpage>5266</fpage><lpage>5279</lpage><pub-id pub-id-type="pmid">8756454</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname><given-names>K</given-names></name><name><surname>Buice</surname><given-names>MA</given-names></name><name><surname>Barry</surname><given-names>C</given-names></name><name><surname>Hayman</surname><given-names>R</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name><name><surname>Fiete</surname><given-names>IR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1077</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1038/nn.3450</pub-id><pub-id pub-id-type="pmid">23852111</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuste</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>From the neuron doctrine to neural networks</article-title><source>Nature Reviews Neuroscience</source><volume>16</volume><fpage>487</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1038/nrn3962</pub-id><pub-id pub-id-type="pmid">26152865</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.27342.023</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ramirez</surname><given-names>Jan-Marino</given-names></name><role>Reviewing editor</role><aff><institution>Seattle Children's Research Institute and University of Washington</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;A spiral attractor network drives rhythmic locomotion&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom, Jan-Marino Ramirez (Reviewer #1), is a member of our Board of Reviewing Editors and the evaluation has been overseen by Eve Marder as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Rune W Berg (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>The authors explore the population dynamics that controls fictive locomotion in the pedal ganglion network of <italic>Aplysia</italic>. The locomotor activity is a relatively simple escape response, which is elicited by a brief electrical stimulation to the tail nerve. The use of fast voltage sensitive dyes and optical imaging allows the authors to gain insights into the activity of individual neurons, while simultaneously recording the activity from 120-180 neurons, which represents approximately 10% of the entire ganglion population. This unique preparation is ideal to address fundamental questions in neuronal networks. In particular the question of how populations of neurons control behavior is difficult to address in larger networks, such as those of the mammalian nervous system.</p><p>The authors find that the population dynamics can best be described as an attractor dynamics (spiral attractor) with a low dimension, whereas the higher dimensional activity is variable from trial to trial as well as from animal to animal and therefore not attributed the same importance in the generation of the motor pattern. Interestingly, the authors found that the individual participation in the dynamics could change substantially from bout to bout, while the population dynamics was more stable. This is consistent with the property of mammalian networks in which single neurons show also large variability, while the output is rather regular (see e.g. Carroll and Ramirez, 2013).</p><p>There are several other important and interesting findings in this study. This small network investigation is simple enough to restrict the unknown variables yet rich enough to address interesting questions of neuronal network behind motor behavior. It is truly a rare and noteworthy study and the authors go through great efforts to analyze and interpret the complexity that even such a simple animal has. The paper is well written, but it would help to try to further simplify the language and better explain the terms used. The study is innovative as the authors provide tools for analysis, in particular the recurrence analysis. Thus, this study will undoubtedly inspire future investigation in attractor dynamics of neuronal networks.</p><p>Essential revisions:</p><p>1) The study is well written, but it needs to be adjusted to a more general readership. The method is innovative, but it needs to be better explained, in particular for a reader who is not familiar with the terminology used in this study. The authors should provide e.g. a better explanation in the text how eigenvalues for the population recordings were calculated.</p><p>2) We would be interested to hear some of your answers to the questions raised below. The authors could consider addressing these questions in the Discussion section, since the general readership might arrive at similar questions. But, we won't insist that the authors include each of the following issues in the text.</p><p>2a) Please comment: There seems to be only one attractor in the state space – or two if you count the spontaneous state, which seems rather trivial, as an attractor. Although this arrangement would provide robustness to the system and prevent unintended pathological activities, it seems to be contrary to the general notion of neuronal networks having multiple stable states – e.g. the classical Hopfield memory networks. Further, it was documented in an early report that (even) the neuronal network in the <italic>Aplysia</italic> abdominal ganglion could participate in at least 3 different behaviors, see</p><p>J-Y Wu, LB Cohen, CX Falk, &quot;Neuronal activity during different behaviors in <italic>Aplysia</italic>: a distributed organization?&quot; Science 263, 820-823, 1994</p><p>Is the pedal ganglion network not able to perform more motor behaviors or is it not possible to induce other behaviors experimentally? I know the authors make great effort to map the basin of attraction, but can you comment more on this issue of lack of multi-stability?</p><p>2b) Please comment: What is the role of the rest of the population in bringing back the dynamics to the attractor? I don't fully see to what extent the perturbation affects all the neurons, or only some. Could it be that the response to the perturbation (<xref ref-type="fig" rid="fig1">Figure 1F</xref>) and the decay back to the attractor is really the alignment of the recorded/perturbed neurons with the rest of the unperturbed population?</p><p>2c) Please comment: Discussion and other places: &quot;Testing the idea that high-dimensional population activity contains a low-dimensional signal […]&quot; How would the activity look if it were a high dimensional activity without a low dimensional signal, i.e. the contrary situation? Would it just be random chaotic spiking? Would it even be possible to have a rhythmic low dimensional motor output without having that same low-dimensional component in the neuronal population?</p><p>2d) Emergence. The authors discuss in a couple of places the interesting and profound issue:</p><p>&quot;These results suggest that the pedal ganglion's pattern generator is not driven by neurons that are endogenous oscillators, as they would be expected to participate equally in every response. Rather, this variation supports the hypothesis that the periodic activity is an emergent property of the network. &quot;</p><p>However, in their model the network oscillation frequency is set by the membrane time constant of the single neuron. This seems at odds with the notion that the rhythm is an emergent network phenomenon. Usually &quot;emergence&quot; is a property that cannot be identified on the single cell level. And if so, why is the network oscillation so robust and independent on the participation of individual neuron? Is the network oscillation frequency some sort of weighted average of the time constants of different cells? This is a very important issue and has caused considerable discussion e.g. in the field of mammalian respiration, and thus, it would be great to include your considerations in the discussion. We will further elaborate on your conclusion with regards to the emergent property below.</p><p>3) The authors use recurrence analysis, which is adapted from the analysis of dynamical systems, and they provide some evidence that population activity in the pedal ganglion fulfills some criteria of attractor dynamics: A) the cyclical periodic orbit is rapidly reached from a more diverse state during the initial stimulation. B) After spontaneous perturbations, the system recovers rapidly returning to the manifold. Moreover, C) they show that across the entire recorded neuronal population, individual neurons can change in the weight by which they contribute to the low dimensional state. Based on C), they conclude that the low dimensional dynamical system is an emergent property of the neuronal population and more robust / reproducible than the high dimensional neuronal population activity; in conclusion, a stable motor output is produced besides the variability seen in individual neurons.</p><p>The use of recurrence analysis for single cell resolution neuronal population data is innovative. While this manuscript will be interesting to a large community of neuroscientists, the manuscript needs some clarifications. Most importantly, C) is a very strong statement that really would change views of how population dynamics in the pedal ganglion work; however, C) is not sufficiently supported by the analysis provided and thus could be misleading. Additional analyses should be done to either revise or solidify this conclusion.</p><p>4) Along these lines: there might be an oscillatory sub-population of neurons, or even smaller CPG unit, that generates in a very robust and reproducible manner a recurrent and periodic pattern; this view is already somewhat supported in <xref ref-type="fig" rid="fig8">Figure 8</xref>. In addition, other pedal ganglion neurons contribute to a more complex overall population state by exhibiting more variable activity patterns, that might be transiently recruited to this recurrently active subpopulation. If this is the case, the main statement (C) does not hold and should be revised.</p><p>5) If the dataset in <xref ref-type="fig" rid="fig1">Figure 1C</xref> is representative, it is obvious that PCA will lead to at least two modes that describe a dominant periodic orbit. The authors should provide more direct quantification of what type of neurons have the most variable contributions and in which way. In their previous work, the authors devised a method to classify neuronal subpopulations as non-oscillators, oscillators, bursters, pausers (Bruno et al., 2015); see also <xref ref-type="fig" rid="fig1">Figure 1C</xref>. First, the authors should perform their analyses on these subpopulations separately; one might expect that the oscillatory neurons show much less variable contributions and that the variability comes from the other neuronal classes. Or is there even a very small set of highly non-variable neurons? In this case, one could argue that recurrence, periodicity and stable motor output generation is not an emergent property of the pedal ganglion but the robust output of a smaller subpopulation / CPG subunit.</p><p>6) PCA results, especially in the higher dimensions can be quite variable from dataset to dataset, or even within datasets, when performed on subsections. The authors use the eigenvectors to measure each neuron's contribution to the low dimensional signal. However, as they also state, this variability can come from variable signal amplitudes or variable synchrony. If signal amplitude is the main source of variability, I would argue that the main periodic (or recurrent) feature of these neurons is robust and preserved throughout the 3 programs in each recording; it just appears variable in the eigenvectors. So, the authors should show that the main source of variability is indeed variable synchrony.</p><p>7) An essential aspect of recurrence analysis described in Marwan et al., 2007 is the addition of time delay dimension to the data; here recurrent points are similar not only in their instantaneous distances but also in their time history. This step is not mentioned in the manuscript. Please provide an explanation why this was not needed for the analysis of their data.</p><p>8) Detailed information is lacking about how many PC dimensions were used in each analysis and dataset. Were always the top 4 dimensions used as described for <xref ref-type="fig" rid="fig2">Figure 2D</xref>, or always as many dimensions that explain 80% of variance? Was this the same for all analyses throughout the paper? This choice makes a difference in how to interpret the data. Please provide this detailed information.</p><p>9) Please discuss what the function of variability might be. For example, is the size principle described for the Aplyisa motor system, i.e. do variable recruitment patterns are functional for different loads on the motor apparatus? Etc.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.27342.024</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p> <italic>1) The study is well written, but it needs to be adjusted to a more general readership. The method is innovative, but it needs to be better explained, in particular for a reader who is not familiar with the terminology used in this study. The authors should provide e.g. a better explanation in the text how eigenvalues for the population recordings were calculated.</italic> </p><p>The accessibility of the reported work was always a concern for us, and prompted here by the referees we have made a number of changes to the text:</p><p>I) We revised the opening paragraph of the Introduction to motivate better the approach of looking at a low dimensional system for the general reader..</p><p>II) We have extended <xref ref-type="fig" rid="fig1">Figure 1F</xref> to include a further schematic and fuller definitions of the terminology used. In particular, we now illustrate and define &quot;trajectory&quot;; and illustrate and define &quot;manifold&quot;.</p><p>III) We have revised the opening paragraph in subsection “Joint population activity meets the conditions for a periodic attractor”, this now more clearly defines the expectations of a manifold for an attractor, and better motivates the analysis then done.</p><p>IV) We have added a paragraph of explanation to subsection “Heterogenous population activity arises from a common attractor” on how the local linear model was fit and how the eigenvalues were derived from it.</p><p>V) We have extended the Discussion (see responses below), and divided it into titled subsections, to better orient the reader.</p><p><italic>2) We would be interested to hear some of your answers to the questions raised below. The authors could consider addressing these questions in the Discussion section, since the general readership might arrive at similar questions. But, we won't insist that the authors include each of the following issues in the text.</italic> </p><p><italic>2a) Please comment: There seems to be only one attractor in the state space – or two if you count the spontaneous state, which seems rather trivial, as an attractor. Although this arrangement would provide robustness to the system and prevent unintended pathological activities, it seems to be contrary to the general notion of neuronal networks having multiple stable states – e.g. the classical Hopfield memory networks. Further, it was documented in an early report that (even) the neuronal network in the Aplysia abdominal ganglion could participate in at least 3 different behaviors, see</italic> </p><p> <italic>J-Y Wu, LB Cohen, CX Falk, &quot;Neuronal activity during different behaviors in Aplysia: a distributed organization?&quot; Science 263, 820-823, 1994</italic> </p><p> <italic>Is the pedal ganglion network not able to perform more motor behaviors or is it not possible to induce other behaviors experimentally? I know the authors make great effort to map the basin of attraction, but can you comment more on this issue of lack of multi-stability?</italic> </p><p>These are all excellent questions.</p><p>A periodic attractor network and a Hopfield-style point attractor network are very different beasts. A point attractor network's stable states are defined by the number of configurations of stable, unchanging activity amongst its neurons. In the simple networks of Hopfield, Amit, Grossberg and others, these configurations are exponential in the number of neurons, as different inputs recall a different configuration of neuron activity. By contrast, a periodic attractor network has a stable states defined by repeatedly changing activity amongst its neurons. An enumeration of its stable states is defined by the number of periodic trajectories that can arise given different inputs. This can be as low as 1, with the same periodic trajectory arising for any given input.</p><p>Separately, a periodic attractor network can of course support more than one stable periodic trajectory if some element of that network is changed (e.g. the strength of connections between neurons): thus multiple attractors can exist in the same physical network if the properties of that network can be modulated. Just as we suspect happens with serotonin in the pedal ganglion.</p><p>The pedal ganglion does indeed support more than one behavior. As we touched on in the manuscript, minimally it supports both the escape gallop and the normal crawl, which have different sequences of muscle contractions. We now mention that it may also drive the head-wave of <italic>Aplysia</italic>.</p><p>We have brought all the above points together in a new Discussion section titled &quot;Multiple periodic attractors and multifunctional circuits&quot;, including appropriate new references.</p><p><italic>2b) Please comment: What is the role of the rest of the population in bringing back the dynamics to the attractor? I don't fully see to what extent the perturbation affects all the neurons, or only some. Could it be that the response to the perturbation (<xref ref-type="fig" rid="fig1">Figure 1F</xref>) and the decay back to the attractor is really the alignment of the recorded/perturbed neurons with the rest of the unperturbed population?</italic> </p><p>The spontaneous perturbations we observed were the almost complete cessation of recurrence in a trajectory that accounted for at least 80% of the co-variation of the (observed) population activity. Consequently, the perturbations were population-wide, as illustrated in the three raster plots in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>. The return to the attractor is not necessarily caused by any other group of neurons, but is simply the response of the system to the cessation of a transient change to its input (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p>We have now commented on this in subsection “Joint population activity meets the conditions for a periodic attractor”.</p><p><italic>2c) Please comment: Discussion and other places: &quot;Testing the idea that high-dimensional population activity contains a low-dimensional signal…&quot; How would the activity look if it were a high dimensional activity without a low dimensional signal, i.e. the contrary situation? Would it just be random chaotic spiking? Would it even be possible to have a rhythmic low dimensional motor output without having that same low-dimensional component in the neuronal population?</italic> </p><p>High-dimensional activity without a corresponding low-dimensional signal can only arise with random, uncorrelated firing of each neuron. By contrast, chaotic spiking is not random: there is co-variation between neurons, but without any sustained periodicity (as in our example of putative chaotic spiking in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>). A chaotic system will thus also have a low-dimensional signal (it’s just that the low-dimensional signal has fractional dimensions for a chaotic system).</p><p>Any co-variation between neurons reduces the dimensionality of the space needed to describe the population. So the key questions are i) how low a number of dimensions is needed, to understand the redundancy in the population activity (here we see a factor of 10 reduction in the number of dimensions) and ii) how low is relevant to the behavior? We provide evidence that the very low number of dimensions is relevant through the use of the GLM decoder to reconstruct P10 activity from the low-dimensional trajectory.</p><p><italic>2d) Emergence. The authors discuss in a couple of places the interesting and profound issue:</italic> </p><p> <italic>&quot;These results suggest that the pedal ganglion's pattern generator is not driven by neurons that are endogenous oscillators, as they would be expected to participate equally in every response. Rather, this variation supports the hypothesis that the periodic activity is an emergent property of the network. &quot;</italic> </p><p> <italic>However, in their model the network oscillation frequency is set by the membrane time constant of the single neuron. This seems at odds with the notion that the rhythm is an emergent network phenomenon. Usually &quot;emergence&quot; is a property that cannot be identified on the single cell level. And if so, why is the network oscillation so robust and independent on the participation of individual neuron? Is the network oscillation frequency some sort of weighted average of the time constants of different cells? This is a very important issue and has caused considerable discussion e.g. in the field of mammalian respiration, and thus, it would be great to include your considerations in the discussion. We will further elaborate on your conclusion with regards to the emergent property below.</italic> </p><p>The fact that the time constants constrain the oscillation is not at odds with an emergent system. An emergent property of a system is one that the collection of units has that the individual units do not. But those properties are of course physically constrained by the physical properties of the units. The canonical example is flocking birds. The flock flies differently to an individual bird, with sudden changes of direction, massing and spreading. But the flock's behavior is constrained by physical properties of the bird species – its airspeed (limiting the flock’s velocity) and its wingspan (limiting its compression).</p><p>In our toy model attractor network, the single units are not oscillators. Given constant input, they transiently respond then adapt to a steady-state. The oscillation is a property of the network, not the units. But of course the possible frequencies of oscillation are constrained by time constant of and the delays between the neurons – for example, the longer the transmission delay between the connected neurons, so the lower is the upper limit of possible oscillation frequencies. Exactly what frequency emerges from the network thus depends heavily on the details of the network, with no universal answer. In a toy model like ours with just two homogenous time constant, then the oscillation frequency is determined by them in a straightforward way (largely by the time constant of adaptation). But even as soon as we move to model with heterogenous time constants and delays, the solution to the periodicity of the attractor becomes complex (see e.g. Nevado-Holgado, Terry &amp; Bogacz (2011) J Neurosci for solutions to periodic states in the very simple STN-GPe feedback loop within the basal ganglia).</p><p>Our model is illustrative of the main concepts in a periodic attractor network – as we note in the Discussion, current models cannot account for variation of neurons between executions of the attractor. We thus don’t know why networks are robust to variation.</p><p><xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref> now shows what happens with uncoupled neurons in our toy model. This illustrates emergence: without the network connections, there is no oscillation.</p><p><italic>3) The authors use recurrence analysis, which is adapted from the analysis of dynamical systems, and they provide some evidence that population activity in the pedal ganglion fulfills some criteria of attractor dynamics: A) the cyclical periodic orbit is rapidly reached from a more diverse state during the initial stimulation. B) After spontaneous perturbations, the system recovers rapidly returning to the manifold. Moreover, C) they show that across the entire recorded neuronal population, individual neurons can change in the weight by which they contribute to the low dimensional state. Based on C), they conclude that the low dimensional dynamical system is an emergent property of the neuronal population and more robust / reproducible than the high dimensional neuronal population activity; in conclusion, a stable motor output is produced besides the variability seen in individual neurons.</italic> </p><p> <italic>The use of recurrence analysis for single cell resolution neuronal population data is innovative. While this manuscript will be interesting to a large community of neuroscientists, the manuscript needs some clarifications. Most importantly, C) is a very strong statement that really would change views of how population dynamics in the pedal ganglion work; however, C) is not sufficiently supported by the analysis provided and thus could be misleading. Additional analyses should be done to either revise or solidify this conclusion.</italic> </p><p> <italic>4) Along these lines: there might be an oscillatory sub-population of neurons, or even smaller CPG unit, that generates in a very robust and reproducible manner a recurrent and periodic pattern; this view is already somewhat supported in <xref ref-type="fig" rid="fig8">Figure 8</xref>. In addition, other pedal ganglion neurons contribute to a more complex overall population state by exhibiting more variable activity patterns, that might be transiently recruited to this recurrently active subpopulation. If this is the case, the main statement (C) does not hold and should be revised.</italic> </p><p> <italic>5) If the dataset in <xref ref-type="fig" rid="fig1">Figure 1C</xref> is representative, it is obvious that PCA will lead to at least two modes that describe a dominant periodic orbit. The authors should provide more direct quantification of what type of neurons have the most variable contributions and in which way. In their previous work, the authors devised a method to classify neuronal subpopulations as non-oscillators, oscillators, bursters, pausers (Bruno et al., 2015); see also <xref ref-type="fig" rid="fig1">Figure 1C</xref>. First, the authors should perform their analyses on these subpopulations separately; one might expect that the oscillatory neurons show much less variable contributions and that the variability comes from the other neuronal classes. Or is there even a very small set of highly non-variable neurons? In this case, one could argue that recurrence, periodicity and stable motor output generation is not an emergent property of the pedal ganglion but the robust output of a smaller subpopulation / CPG subunit.</italic> </p><p>We have dealt with points 3) to 5) together, as they ultimately are all focused on the core question of evidence for emergence in the population activity. The referees have rightly asked whether there is evidence for a core group of stable, non-variable neurons in the population.</p><p>To an extent, we already had evidence against this idea. Such a core CPG population would be neurons that are phasically active, strongly participating in all population responses, and low in variation between population responses. <xref ref-type="fig" rid="fig7">Figure 7B</xref> already showed that there were very few such neurons, which would be expected to fall in the bottom half of the bottom right quadrant of that scatter plot, but where instead there is predominantly whitespace.</p><p>To further address this question, we have done the following:</p><p>1) We clustered every one of the 30 population responses into their constituent ensembles (as per our modular deconstruction approach in Bruno et al., 2015).</p><p>2) Each ensemble was then classified as oscillator, burster, tonic, or pauser according to the same auto-correlation approach as in Bruno et al., 2015.</p><p>3) Each neuron was then labelled with the class of its parent ensemble.</p><p>4) We determined how many neurons were consistently labelled across all three responses in the same preparation. We found that only a subset of the oscillator class was consistently labelled across all three responses in all ten preparations. This would be consistent with a small core of invariant phasically active neurons.</p><p>5) However, this consistent subset of oscillator neurons also showed the same wide variation in participation as the whole population. We could not identify even one neuron in some populations that was strongly participating and yet invariant.</p><p>These results are summarised in a new supplemental figure: <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>.</p><p>We added a paragraph to the main text (subsection “Variable neuron participation in stable motor programs”) reporting these results</p><p> <italic>6) PCA results, especially in the higher dimensions can be quite variable from dataset to dataset, or even within datasets, when performed on subsections. The authors use the eigenvectors to measure each neuron's contribution to the low dimensional signal. However, as they also state, this variability can come from variable signal amplitudes or variable synchrony. If signal amplitude is the main source of variability, I would argue that the main periodic (or recurrent) feature of these neurons is robust and preserved throughout the 3 programs in each recording; it just appears variable in the eigenvectors. So, the authors should show that the main source of variability is indeed variable synchrony.</italic> </p><p><xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> is now a more thorough quantification of participation. It shows that independently measured changes in rate and change in synchrony between responses can correlate with the change in participation, but need not do so. These results emphasise that participation is a contextual thing: the contributions to the eigenvectors of each neuron are relative to all other neurons' contributions. Moreover, participation quantifies change across multiple dimensions of co-variation in the population's activity. So correlating it with absolute and independent measures of rate or synchrony changes is only a crude guide to what is measured. Thus we used our participation index as a summary measure of the relative contribution to the population of each neuron.</p><p> <italic>7) An essential aspect of recurrence analysis described in Marwan et al., 2007 is the addition of time delay dimension to the data; here recurrent points are similar not only in their instantaneous distances but also in their time history. This step is not mentioned in the manuscript. Please provide an explanation why this was not needed for the analysis of their data.</italic> </p><p>We believe the referees comments here are in reference to Takens’ embedding theorem (Eq 9 in Marwan et al., 2007). This is a remarkable result for one-dimensional time-series (such as the output of a single neuron), which allows us to treat a 1D time-series as though it were a set of &gt;1 time-series. Namely, by constructed a high-dimensional space by adding as many dimensions as time-delay steps (t,t+1,…,t+tau), and then determining the dynamical system in that time-embedding space. However, here we already have &gt;&gt;1 time-series, and even after PCA we still have P &gt; 1 dimensions: so we simply check for recurrence in the natural dimensions of the system at hand (Eq 7 in Marwan et al., 2007), rather than constructing a time-embedding set of dimensions.</p><p> <italic>8) Detailed information is lacking about how many PC dimensions were used in each analysis and dataset. Were always the top 4 dimensions used as described for <xref ref-type="fig" rid="fig2">Figure 2D</xref>, or always as many dimensions that explain 80% of variance? Was this the same for all analyses throughout the paper? This choice makes a difference in how to interpret the data. Please provide this detailed information.</italic> </p><p>The referees are quite right that we omitted a single clear statement from the main text, and only implied that we used the number of dimensions needed to account for 80% variance throughout.</p><p>We now explicitly state: &quot;Thus, throughout our analysis, we projected each evoked program into the number of embedding dimensions needed to capture at least 80% of the variance in population activity&quot; (subsection “Joint population activity forms a low-dimensional periodic orbit”).</p><p> <italic>9) Please discuss what the function of variability might be. For example, is the size principle described for the Aplyisa motor system, i.e. do variable recruitment patterns are functional for different loads on the motor apparatus? Etc.</italic></p><p>We have collated our existing points on the role of variability into a Discussion section, subsection &quot;Insights and challenges of variable neuron participation&quot;, and extended our discussion of its potential functional roles. In particular, we now speculate that one potential role of variable participation is to build &quot;sloppiness&quot; into the system, such that there are many possible configurations of the network able to generate the spiral attractor.</p></body></sub-article></article>