<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">06397</article-id><article-id pub-id-type="doi">10.7554/eLife.06397</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Building accurate sequence-to-affinity models from high-throughput in vitro protein-DNA binding data using FeatureREDUCE</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-24344"><name><surname>Riley</surname><given-names>Todd R</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-24346"><name><surname>Lazarovici</surname><given-names>Allan</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-2200"><name><surname>Mann</surname><given-names>Richard S</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="par-3"/><xref ref-type="other" rid="par-4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-23944"><name><surname>Bussemaker</surname><given-names>Harmen J</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-4"/><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Biological Sciences</institution>, <institution>Columbia University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Systems Biology</institution>, <institution>Columbia University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Biology</institution>, <institution>University of Massachusetts Boston</institution>, <addr-line><named-content content-type="city">Boston</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Electrical Engineering</institution>, <institution>Columbia University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department of Biochemistry and Molecular Biophysics</institution>, <institution>Columbia University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Friedman</surname><given-names>Nir</given-names></name><role>Reviewing editor</role><aff id="aff6"><institution>The Hebrew University of Jerusalem</institution>, <country>Israel</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>hjb2004@columbia.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>23</day><month>12</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e06397</elocation-id><history><date date-type="received"><day>08</day><month>01</month><year>2015</year></date><date date-type="accepted"><day>20</day><month>12</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Riley et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Riley et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-06397-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.06397.001</object-id><p>Transcription factors are crucial regulators of gene expression. Accurate quantitative definition of their intrinsic DNA binding preferences is critical to understanding their biological function. High-throughput in vitro technology has recently been used to deeply probe the DNA binding specificity of hundreds of eukaryotic transcription factors, yet algorithms for analyzing such data have not yet fully matured. Here, we present a general framework (FeatureREDUCE) for building sequence-to-affinity models based on a biophysically interpretable and extensible model of protein-DNA interaction that can account for dependencies between nucleotides within the binding interface or multiple modes of binding. When training on protein binding microarray (PBM) data, we use robust regression and modeling of technology-specific biases to infer specificity models of unprecedented accuracy and precision. We provide quantitative validation of our results by comparing to gold-standard data when available.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.001">http://dx.doi.org/10.7554/eLife.06397.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.06397.002</object-id><title>eLife digest</title><p>Transcription is the process by which the information contained within DNA is copied to a short-lived molecule called RNA so that it can be transported to other areas of the cell for various purposes. Transcription factors are key components in this process. These proteins recognise and gather at specific sequences of DNA near genes, and then assist the enzymes that copy the information in the gene into a molecule of RNA. This means that transcription factors essentially control which genes are expressed, and when and where these genes are expressed.</p> <p>Recent technological advances have made it possible to identify where transcription factors can bind within DNA sequences. Yet, while a lot of data has been generated in this area, the computational tools needed to make sense of it have not kept pace.</p> <p>Now, Riley et al. have developed software called FeatureREDUCE that will allow researchers to build computer predictions of how strongly a transcription factor will interact with specific short sections of DNA sequence. The software can be applied to experimental data collected in so-called ‘protein binding microarray’ experiments. FeatureREDUCE can also be used to investigate questions in the field of transcription factor research that had previously remained unanswered. First, to what level of detail can data obtained from recent technological advances be understood? Second, can transcription factors bind to DNA in more than one way, and can data from protein binding microarrays be used to uncover this?</p> <p>Riley et al. show that FeatureREDUCE can produce accurate and interpretable clues about the biology behind how transcription factors recognize DNA sequences. This includes how mutations as small as a change to single DNA letter can affect recognition. The next step will be to use the software to make sense of the existing volume of experimental data regarding protein-DNA interactions and data that will be generated in future experiments.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.002">http://dx.doi.org/10.7554/eLife.06397.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>transcription factor</kwd><kwd>protein binding microarray technology</kwd><kwd>biophysical model</kwd><kwd>DNA binding specificity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id><institution>National Human Genome Research Institute</institution></institution-wrap></funding-source><award-id>R01HG003008</award-id><principal-award-recipient><name><surname>Bussemaker</surname><given-names>Harmen J</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005851</institution-id><institution>John Simon Guggenheim Memorial Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Bussemaker</surname><given-names>Harmen J</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R01GM058575</award-id><principal-award-recipient><name><surname>Mann</surname><given-names>Richard S</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000054</institution-id><institution>National Cancer Institute</institution></institution-wrap></funding-source><award-id>U54CA121852</award-id><principal-award-recipient><name><surname>Mann</surname><given-names>Richard S</given-names></name><name><surname>Bussemaker</surname><given-names>Harmen J</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A biophysically principled algorithm can build quantitative models of protein-DNA binding specificity of unprecedented accuracy from a leading type of high-throughput in vitro binding data.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Transcription factors (TFs) play a central role in the regulation of gene expression. To be able to understand and predict the behavior of the gene regulatory circuitry in any given organism, we need to know the in vivo DNA binding preferences of the TFs that its genome encodes. In recent years, a number of high-throughput in vitro technologies have been introduced that can provide such information (<xref ref-type="bibr" rid="bib9">Berger and Bulyk, 2009</xref>; <xref ref-type="bibr" rid="bib41">Warren et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Maerkl and Quake, 2007</xref>; <xref ref-type="bibr" rid="bib44">Zhao et al., 2009</xref>; <xref ref-type="bibr" rid="bib32">Slattery et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Berger et al., 2006</xref>). However, while the volume of the data generated using these assays dwarfs that of more traditional measurements of protein-DNA interaction strength, the available computational methodology for analyzing them has not fully matured (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>).</p><p>The number of base pairs that constitute the DNA 'footprint' within which base identity can influence binding affinity depends strongly on the three-dimensional structure of the DNA-binding domain (DBD) of the TF. In theory, as long as thermodynamic equilibrium can be assumed, sequence specificity is completely defined by a table containing the (relative) affinity with which the DBD binds to each possible oligonucleotide within the footprint. This tabular approach has been widely used to analyze Protein Binding Microarray (PBM) data (<xref ref-type="bibr" rid="bib9">Berger and Bulyk, 2009</xref>). It comes with significant challenges, however. First, the size of the oligomer table grows exponentially with footprint size, which in practice limits it to eight base pairs, shorter than the footprint of most TFs. Even for octamer tables, the number of affinity parameters to be estimated is on the same order as the number of PBM data points. This limits precision and necessitates the use of non-parametric methods (as opposed to parameterized biophysical methods), resulting in an associated loss of quantitative information.</p><p>A long-standing alternative has been to assume that each nucleotide position within the footprint contributes independently to the overall binding affinity. The most commonly used representation of sequence specificity that makes this independence assumption is the position weight matrix (PWM) (<xref ref-type="bibr" rid="bib6">Berg and von Hippel, 1987</xref>; <xref ref-type="bibr" rid="bib36">Stormo and Fields, 1998</xref>; <xref ref-type="bibr" rid="bib37">Stormo, 2000</xref>; <xref ref-type="bibr" rid="bib11">Djordjevic et al., 2003</xref>), which defines position-specific base frequencies. Algorithms for inferring the PWM coefficients traditionally aim to maximize its information content relative to a random background model (<xref ref-type="bibr" rid="bib22">Lawrence et al., 1993</xref>; <xref ref-type="bibr" rid="bib14">Frech et al., 1997</xref>; <xref ref-type="bibr" rid="bib4">Bailey, 1995</xref>; <xref ref-type="bibr" rid="bib30">Roth et al., 1998</xref>). In an alternative approach, sequence specificity is represented in terms of the relative affinity (or, equivalently, the difference, △△<italic>G</italic>, in binding free energy) associated with each possible point mutation of the optimal sequence (<xref ref-type="bibr" rid="bib34">Stormo and Yoshioka, 1991</xref>; <xref ref-type="bibr" rid="bib35">Stormo et al., 1993</xref>), and summarized in the form of a position-specific affinity matrix (PSAM) (<xref ref-type="bibr" rid="bib13">Foat et al., 2006</xref>; <xref ref-type="bibr" rid="bib10">Bussemaker et al., 2007</xref>). The difference in philosophy between the PWM and PSAM representations also leads to a different approach to estimating their coefficients. It is no longer the information content (i.e. the height of the letters in the standard sequence logo) that is being optimized, but rather the ability of the PSAM to quantitatively explain the variation in a measurable quantity in terms of variation in the nucleotide sequence associated with each quantity (for instance, the expression level of a gene in terms of its upstream promoter sequence). In the case of PBM data, the PSAM parameters are inferred by performing a nonlinear fit of a sequence-based model that predicts the signal intensity for each probe. The first implementations of this idea were the <italic>MatrixREDUCE</italic> (<xref ref-type="bibr" rid="bib13">Foat et al., 2006</xref>; <xref ref-type="bibr" rid="bib12">Foat et al., 2005</xref>) and <italic>PREGO</italic> (<xref ref-type="bibr" rid="bib38">Tanay, 2006</xref>) algorithms; a more recent extension is <italic>BEEML-PBM</italic> (<xref ref-type="bibr" rid="bib45">Zhao and Stormo, 2011</xref>).</p><p>Whether dependencies between nucleotide positions can be accurately estimated from PBM data and used to refine models of binding specificity remains an open question (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>; <xref ref-type="bibr" rid="bib45">Zhao and Stormo, 2011</xref>; <xref ref-type="bibr" rid="bib5">Benos et al., 2002</xref>). Furthermore, while the existence of alternative binding modes is now widely recognized, accurate quantification of their relative usage has not yet been attempted. To address these needs, we developed our <italic>FeatureREDUCE</italic> software. It provides a flexible framework for building sequence-to-affinity models from PBM data (<xref ref-type="fig" rid="fig1">Figure 1</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.06397.003</object-id><label>Figure 1.</label><caption><title>The FeatureREDUCE workflow for analyzing PBM intensities.</title><p>(<bold>1</bold>) A robust method is used to estimate relative affinities for each K-mer of a given length. The K-mer with the highest affinity is chosen as the seed. (<bold>2</bold>) Using the seed as a reference, robust linear regression is used to estimate the relative affinity parameters in each column of the position-specific affinity matrix (PSAM). (<bold>3</bold>) With the current affinity model, linear regression is used to estimate the positional bias profile across the probe. (<bold>4</bold>) An optional step uses nonlinear regression to solve for the free protein concentration. (<bold>5</bold>) Robust regression is used to estimate free energy contributions associated with higher-order sequence features such as dinucleotides. (<bold>6</bold>) Steps 2 through 5 are repeated until convergence. (<bold>7</bold>) The procedure results in a feature-specific affinity model (FSAM) that can be used to predict the relative affinity for any DNA sequence.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.003">http://dx.doi.org/10.7554/eLife.06397.003</ext-link></p></caption><graphic xlink:href="elife-06397-fig1-v2.tif"/></fig></p></sec><sec id="s2" sec-type="results|discussion"><title>Results and discussion</title><p><italic>FeatureREDUCE</italic> is based on an extensible biophysical model in which the binding free energy difference △△<italic>G</italic>(<italic>S</italic><sub>ref</sub>→<italic>S</italic>) between an arbitrary nucleotide sequence <italic>S</italic> and a reference sequence <italic>S</italic><sub>ref</sub> (usually taken as the highest-affinity sequence) is defined as a sum of parameters △△<italic>G<sub><italic>φ</italic></sub></italic> over all nucleotide sequence 'features' <italic>φ</italic> that distinguish <italic>S</italic> from <italic>S</italic><sub>ref</sub> (see Materials and methods). The full set of possible features in which <italic>S</italic> and <italic>S</italic><sub>ref</sub> differ includes all possible single-base substitutions by default, but can be supplemented with dinucleotides that model dependencies and/or insertions at specific positions within the binding site that model variation in binding mode. Such a feature-based approach has been used previously (<xref ref-type="bibr" rid="bib31">Sharon et al., 2008</xref>; <xref ref-type="bibr" rid="bib17">Gordân et al., 2013</xref>; <xref ref-type="bibr" rid="bib49">Zhou et al., 2015</xref>), but, as we will argue below, our approach to estimating the coefficients of the model is different and optimal.</p><p>The contribution of a binding site to the PBM intensity depends on its position within the probe, as was previously demonstrated by planting the same motif at different offsets (<xref ref-type="bibr" rid="bib7">Berger et al., 2006</xref>). This may preclude accurate model estimation unless it is dealt with explicitly. Moreover, whenever the TF binds near the free end of a probe, loss of contacts with the DNA backbone can reduce binding affinity. <italic>FeatureREDUCE</italic> captures such spatial bias by introducing an independent multiplicative correction factor for the ratio [TF]/K<sub>d</sub> at each offset within the probe (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). These coefficients are estimated from the PBM intensities in parallel with the △△<italic>G</italic> parameters (see Materials and methods). The positional bias profile inferred by <italic>FeatureREDUCE</italic> for the homo-dimer Cbf1p is shown in <xref ref-type="fig" rid="fig2">Figure 2b</xref>. It indicates that the magnitude of the contribution of an individual binding site to the PBM intensity can vary by an order of magnitude depending on its offset within the probe, and that there is preference for Cbf1p binding away from the substrate. For Pho4p, binding near the free end of the probe shows an opposite trend (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The fraction of the variance (R<sup>2</sup>) in PBM intensity explained by a 10-bp independent-nucleotide model increases dramatically, from 48% to 71%, after accounting for the positional bias. <italic>FeatureREDUCE</italic> can also detect any preference for monomeric TFs to bind in one of the two possible orientations on the dsDNA probes. For example, Zif268 exhibits a strong bias for binding to the negative strand over the positive strand (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Indeed, it is known that Zif268 requires non-specific contacts with the DNA backbone on the 5'-end of the motif (<xref ref-type="bibr" rid="bib7">Berger et al., 2006</xref>). <italic>BEEML-PBM</italic> (<xref ref-type="bibr" rid="bib45">Zhao and Stormo, 2011</xref>) also models positional biases along the probes, but it does not account for orientation preference, or for overhang binding at the free end of the probe.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.06397.004</object-id><label>Figure 2.</label><caption><title>Quantifying PBM-specific positional and orientational bias.</title><p>(<bold><bold>a</bold></bold>) Accounting for biases related to the position of the binding site within the probe. The effective protein concentration is lower closer to the substrate, presumably due to steric hindrance. Furthermore, binding near the free end of probe is associated with loss of contacts with the DNA backbone. (<bold><bold>b</bold></bold>) Positional bias profile for the homo-dimeric bHLH transcription factor Cbf1p, as inferred by a model fit to the PBM intensities. (<bold><bold>c</bold></bold>) Idem, for the monomeric zinc finger transcription factor Zif268. <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> shows how positional bias can be used as an indicator of data quality.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.004">http://dx.doi.org/10.7554/eLife.06397.004</ext-link></p></caption><graphic xlink:href="elife-06397-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06397.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Using positional bias profiles as an indicator of data quality.</title><p>(<bold><bold>a</bold></bold>) The positional bias profile for Cbf1p exhibits a strong preference for binding far from the substrate. The negative slope of the dashed red line is an indicator of high data quality. (<bold><bold>b</bold></bold>) The same plot for Pho4p. Here, the quality of the data is questionable. The sign of the slope from a linear regression over the range denoted by the solid red line is a useful data quality indicator.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.005">http://dx.doi.org/10.7554/eLife.06397.005</ext-link></p></caption><graphic xlink:href="elife-06397-fig2-figsupp1-v2.tif"/></fig></fig-group></p><p>The readout of base identity at different nucleotide positions is only approximately independent. Indeed, various studies have analyzed whether representations of sequence specificity that account for nucleotide dependencies are more accurate than those that do not (<xref ref-type="bibr" rid="bib31">Sharon et al., 2008</xref>; <xref ref-type="bibr" rid="bib2">Agius et al., 2010</xref>; <xref ref-type="bibr" rid="bib23">Lee et al., 2002</xref>; <xref ref-type="bibr" rid="bib33">Stormo et al., 1986</xref>; <xref ref-type="bibr" rid="bib47">Zhou and Liu, 2004</xref>). Controversy, however, remains about whether the additional parameters associated with such dependencies reflect structural mechanisms or technology-specific biases (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>). In the biophysical model that underlies <italic>FeatureREDUCE</italic>, we model dependencies by simply including additional DNA sequence features <italic>φ</italic> that define base identity at two (or more) nucleotide positions, and estimating the corresponding free energy parameters △△<italic>G<sub>φ</sub></italic> along with those for single nucleotides (see Materials and methods). The nucleotide dependencies discovered by <italic>FeatureREDUCE</italic> for Cbf1p are shown in <xref ref-type="fig" rid="fig3">Figure 3a</xref>. As expected for a model with additional parameters, accounting for dependencies significantly increased the fraction of the variance that could be explained when training on PBM intensities (R<sup>2</sup> improved from 71% to 96%). The real question, however, is how well the inferred model parameters perform on independent validation data.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.06397.006</object-id><label>Figure 3.</label><caption><title>Robust estimation of dependencies between nucleotide positions.</title><p>(<bold><bold>a</bold></bold>) Overview of the dependencies between pairs of neighboring nucleotides positions identified by <italic>FeatureREDUCE</italic> for homodimers of the basic helix-loop-helix (bHLH) factor Cbf1p. (<bold><bold>b</bold></bold>) Including dinucleotide dependencies in the sequence-to-affinity model, in combination with the use of robust regression, improves the ability to delineate Gene Ontology associations with Cbf1p targets predicted from the genome sequence. <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> shows the crucial importance of using robust inference methods for estimating the binding free energy correction terms associated with dinucleotide features. <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> shows the underlying cumulative distributions of yeast promoter affinities for 'sulfur compound metabolic process', the GO category with the most statistically significant association with Cbf1p.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.006">http://dx.doi.org/10.7554/eLife.06397.006</ext-link></p></caption><graphic xlink:href="elife-06397-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06397.007</object-id><label>Figure 3—figure supplement 1.</label><caption><title>The crucial importance of using robust inference methods for estimating the binding free energy correction terms associated with dinucleotide features.</title><p>Shown is comparison between relative affinities inferred by FeatureREDUCE from PBM data for the transcription factor Cbf1p (horizontal axis) and the gold-standard measurement of the same affinity obtained using MITOMI (vertical axis). When the independent-nucleotide model (PSAM) is augmented with nearest-neighbor dinucleotide dependencies (FSAM), the agreement with the gold standard improves significantly, as indicated by the root-mean-square error (RMSE) and corresponding 100,000-iteration permutation p-value of 2.7e-5. The lower plots show that using robust regression techniques is essential for capturing the effect of dinucleotide features.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.007">http://dx.doi.org/10.7554/eLife.06397.007</ext-link></p></caption><graphic xlink:href="elife-06397-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.06397.008</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Cumulative distributions of yeast promoter affinities for Cbf1 using four different affinity models and the GO category with the highest association p-value ('sulfur compound metabolic process').</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.008">http://dx.doi.org/10.7554/eLife.06397.008</ext-link></p></caption><graphic xlink:href="elife-06397-fig3-figsupp2-v2.tif"/></fig></fig-group></p><p>A unique aspect of <italic>FeatureREDUCE</italic> is the use of robust inference techniques (<xref ref-type="bibr" rid="bib18">Huber and Ronchetti, 2009</xref>), which, as it turns out, is crucial for obtaining accurate estimates of the various contributions to the binding free energy. To demonstrate this, we compared our results to measurements of binding affinity for Cbf1p obtained using the orginal version of the MITOMI technology (<xref ref-type="bibr" rid="bib25">Maerkl and Quake, 2007</xref>), which are in excellent (R<sup>2</sup> = 0.95) agreement with similar measurements obtained using surface plasmon resonance (<xref ref-type="bibr" rid="bib7">Berger et al., 2006</xref>; <xref ref-type="bibr" rid="bib39">Teh et al., 2007</xref>). We used these 'gold-standard' binding affinity measurements to assess the quality of the sequence-to-affinity models inferred from PBM data by <italic>FeatureREDUCE</italic>. When we fit a position-specific affinity matrix (PSAM) based model that ignores dependencies between nucleotides, the root-mean-square error (RMSE) between <italic>FeatureREDUCE</italic> model predictions and gold-standard MITOMI 1.0 measurements improved from 0.071 to 0.035 when standard least-squares fitting was replaced by robust iteratively re-weighted least-squares (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, left panels). When positional dependencies were added to the model (feature-specific affinity model; FSAM), it actually performed worse than the model assuming independence between nucleotides (position-specific affinity matrix; PSAM) when we used <italic>standard</italic> least-squares fitting, indicative of over-fitting to noise in the training data. When we used <italic>robust</italic> regression, however, the RMSE for the FSAM-based model was significantly better than for the PSAM-based model (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, right panels). These results indicate that dependencies within the binding interface indeed exist, and that they can be modeled incorrectly when non-robust regression techniques are used.</p><p>We also assessed the ability of our models to make predictions regarding in vivo TF function. First, we found that the inclusion of nucleotide dependencies when predicting aggregated yeast promoter affinities improves the ability to delineate Gene Ontology categories associated with regulation by Cbf1p (see Materials and methods), but again only when robust inference techniques are used (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; see also <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Second, to assess the extent to which we can quantitatively predict in vivo binding, we considered the degree of occupancy by Cbf1p at 955 potential genomic binding sites of type NNCACGTGNN (E-box) in yeast cells growing in rich media as measured by ChIP-seq (<xref ref-type="bibr" rid="bib48">Zhou and O'Shea, 2011</xref>). Using a simple thermodynamic equilibrium model with a single free protein concentration parameter to account for binding saturation in the ChIP-seq experiment, we found that by this in vivo measure, <italic>FeatureREDUCE</italic> performs well (RMSE = 0.075), and significantly better than <italic>BEEML-PBM</italic> (<xref ref-type="bibr" rid="bib45">Zhao and Stormo, 2011</xref>) (RMSE = 0.156); full data are shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.06397.009</object-id><label>Figure 4.</label><caption><title>ChIP-seq based validation of position-specific affinity matrix (PSAM) inferred for Cbf1p.</title><p>(<bold><bold>a</bold></bold>) Direct comparison between relative affinities for 10-mers inferred from PBM intensities by <italic>FeatureREDUCE</italic> and relative in vivo occupancy at 955 genomic locations of type NNCACGTGNN (E-box with flanks) as measured by ChIP-seq (<xref ref-type="bibr" rid="bib48">Zhou and O'Shea, 2011</xref>). Trimmed-mean (trim = 10%) ChIP-seq fold-enrichments were computed for all unique 10-mer sequences that occur at least three times in the genome. To account for saturation of higher-affinity binding sites, a basic equilibrium model (green curve) was fit with a single free-protein parameter. Red lines indicate the error between the observed and predicted relative ChIP enrichments. (<bold><bold>b</bold></bold>) The same plot for the <italic>BEEML-PBM</italic> algorithm (<xref ref-type="bibr" rid="bib45">Zhao and Stormo, 2011</xref>). The same equilibrium model (green curve) was fit, but the optimal free protein concentration parameter was much lower than in (<bold>a</bold>), so the saturation is not apparent in this case.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.009">http://dx.doi.org/10.7554/eLife.06397.009</ext-link></p></caption><graphic xlink:href="elife-06397-fig4-v2.tif"/></fig></p><p>The accuracy of <italic>FeatureREDUCE</italic> was demonstrated more broadly in a recent benchmark comparison between 26 different PBM data analysis algorithms (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>). This study employed two distinct performance metrics. The in vitro metric quantified the accuracy with which probe intensities were predicted in a test PBM experiment using a model trained on independent training data from a PBM experiment for the same TF but with a different probe design; this was done for 66 different TFs from various structural families. The in vivo metric used a non-parametric score to quantify accuracy in ranking sequences in terms of their local ChIP-seq enrichment, for nine different TFs. <italic>FeatureREDUCE</italic> emerged as the top-performing algorithm according to both criteria.</p><p>Weirauch <italic>et al.</italic> (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>) first assessed algorithm performance across a large dataset by using cross-validation between two different PBM designs. However, one of their surprising findings was that some algorithms generate models that perform well across different PBM designs but poorly when predicting in vivo binding, presumably due to over-fitting to PBM-specific biases. For example, the performance of one of the algorithms went from second-best in the PBM cross-validation test to worst in the ChIP-seq prediction test (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>). Likewise, an extension of BEEML-PBM that adds dinucleotide parameters (<xref ref-type="bibr" rid="bib46">Zhao et al., 2012</xref>) did not perform well on ChIP-seq data (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>), presumably because it does not employ robust inference techniques. We conclude that <italic>FeatureREDUCE</italic> is currently the <italic>only</italic> algorithm that succeeds in parameterizing dependencies within the binding site.</p><p>Another current debate in the field is whether or not PBM data can provide evidence of alternative DNA binding modes employed by the same TF (<xref ref-type="bibr" rid="bib45">Zhao and Stormo, 2011</xref>; <xref ref-type="bibr" rid="bib3">Badis et al., 2009</xref>; <xref ref-type="bibr" rid="bib26">Morris et al., 2011</xref>; <xref ref-type="bibr" rid="bib16">Gordân et al., 2011</xref>). Oligomeric TF complexes can often bind DNA using different relative orientations of and/or spacing between their subunits (<xref ref-type="bibr" rid="bib16">Gordân et al., 2011</xref>). The modeling framework employed by <italic>FeatureREDUCE</italic> provides a natural opportunity to perform forward selection of multiple binding modes, represented by distinct PSAMs, which can subsequently be combined into a single predictive model and refined in an iterative manner (see Materials and methods). We applied this procedure for the basic leucine zipper (bZIP) proteins Yap1p and Gcn4p. <italic>FeatureREDUCE</italic> accurately captures the known intrinsic differences in half-site preference of Yap1p (which prefers TTAC, typical for the C/EBP subfamily (<xref ref-type="bibr" rid="bib42">Warren et al., 2012</xref>); <xref ref-type="fig" rid="fig5">Figure 5a</xref>) and Gcn4p (which prefers TGAC, typical for the CREB subfamily; <xref ref-type="fig" rid="fig5">Figure 5b</xref>). It is well known that each protein, when binding DNA as a homo-dimer, can do so with or without a 1-bp overlap between the half-sites. What is unique about our approach is that the multi-PSAM model captures fold-differences in thermodynamic stability between the binding modes by estimating an overall relative affinity coefficient for the secondary PSAM. For instance, the binding affinity of Gcn4p for TGACGTCA is predicted to be 24% of that of TGASTCA (cf. <xref ref-type="fig" rid="fig5">Figure 5b</xref>). This is in good agreement with recent high-throughput measurements of Gcn4 binding constants for all 12-mers using HiTS-FLIP (<xref ref-type="bibr" rid="bib27">Nutiu et al., 2011</xref>), specifically, <italic>K</italic><sub>d</sub> = 65 <italic>nM</italic> and 15 <italic>nM</italic> for the respective sequences. In addition, while the accuracy of the dominant TGASTCA motif essentially does not change, the accuracy of the weaker TGACGTCA motif increases significantly when using our multi-PSAM model compared to the single-fit model (R<sup>2</sup> improved from 69% to 80% for sites with relative affinity &gt; 0.1). We note that the results of our analysis can be used in a straightforward manner to predict which binding mode is dominant for a particular DNA sequence.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.06397.010</object-id><label>Figure 5.</label><caption><title>Quantifying the differential usage of alternative binding modes.</title><p>The transcription factors Yap1p (<bold>a</bold>) and Gcn4p (<bold>b</bold>) can each bind in two distinct modes, in which the two half-sites respectively do (top) and do not (bottom) overlap. Not only is the sequence of preferred half-site different between the two factors, the preferred binding mode is different too, as indicated by the relative association constant (K<sub>a</sub>) inferred from the PBM data by <italic>FeatureREDUCE</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.06397.010">http://dx.doi.org/10.7554/eLife.06397.010</ext-link></p></caption><graphic xlink:href="elife-06397-fig5-v2.tif"/></fig></p><p>In conclusion, <italic>FeatureREDUCE</italic> analysis yields an accurate and interpretable biophysical affinity model that can provide detailed clues about the structural mechanisms that underlie protein-DNA recognition (<xref ref-type="bibr" rid="bib29">Roider et al., 2007</xref>; <xref ref-type="bibr" rid="bib21">Kinney et al., 2007</xref>), such as dependencies between nucleotide positions and the modulation of binding mode by variation in the underlying DNA sequence. Our algorithm allows one to make optimal use of the large volume of data that has been generated using microarray-based protein-nucleotide interaction profiling technology.</p></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><sec id="s3-1"><title>Equilibrium model for TF-DNA interaction</title><p>FeatureREDUCE builds upon the biophysical model for protein-DNA interaction on which Matrix-REDUCE (<xref ref-type="bibr" rid="bib13">Foat et al., 2006</xref>) is based. A transcription factor <italic>P</italic> binds to DNA sequence <italic>S</italic> to form a TF-DNA complex <italic>PS</italic>, with forward and backward rate constants <italic>k</italic><sub>on </sub>and <italic>k</italic><sub>off</sub>, respectively:</p><p><disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mi>P</mml:mi><mml:mo/><mml:mo>+</mml:mo><mml:mo/><mml:mi>S</mml:mi><mml:mo> </mml:mo><mml:munderover><mml:mo>⇄</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>off</mml:mi></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mi>on</mml:mi></mml:msub></mml:munderover><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:math></disp-formula></p><p>The affinity of P for <italic>S</italic> can be expressed in terms of an equilibrium association constant <italic>K<sub>a</sub>(S)</italic> or dissociation constant <italic>K<sub>d</sub>(S)</italic>:</p><p><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo/><mml:mo/><mml:mo>=</mml:mo><mml:mo/><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo/><mml:mo/><mml:mo>=</mml:mo><mml:mo/><mml:mo/><mml:mfrac><mml:msub><mml:mtext>k</mml:mtext><mml:mtext>on</mml:mtext></mml:msub><mml:mrow><mml:msub><mml:mtext>k</mml:mtext><mml:mtext>off</mml:mtext></mml:msub><mml:mtext/></mml:mrow></mml:mfrac><mml:mo/><mml:mo/><mml:mo>=</mml:mo><mml:mo/><mml:mo/><mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>S</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>The Gibbs free energy of binding per mole (relative to a 1M reference concentration) is given by ∆<italic>G</italic> = RT ln(K<sub>d</sub> /1M) is, where R is the universal gas constant and T the absolute temperature. The fractional occupancy, <italic>N(S</italic>), defined as the probability that <italic>S</italic> is bound by <italic>P</italic>, can be expressed as:</p><p><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext/><mml:mo>=</mml:mo><mml:mtext/><mml:mfrac><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>S</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext/><mml:mo>=</mml:mo><mml:mtext/><mml:mfrac><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mtext/><mml:mfrac><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mtext/></mml:mrow></mml:math></disp-formula></p><p>If we assume a low-concentration regime where <inline-formula><mml:math id="inf1"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>≪</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where no saturation occurs, the expression for the occupancy simplifies to:</p><p><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mo>≈</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext/></mml:math></disp-formula></p><p>Relative to a reference sequence <italic>S</italic><sub>ref</sub> (typically chosen to be the highest-affinity sequence), there will be multiplicative change in the affinity <italic>K</italic><sub>a</sub>, or, equivalently, an additive change ∆∆<italic>G</italic> in the free energy of binding, for any other sequence <italic>S</italic>:</p><p><disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mfrac><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mtext>ref</mml:mtext></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> = exp</mml:mtext><mml:mfenced><mml:mrow><mml:mtext>-</mml:mtext><mml:mfrac><mml:mrow><mml:mo>∆</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>where</p><p><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mo>∆</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>ref</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p></sec><sec id="s3-2"><title>Feature-based model of sequence specificity</title><p>FeatureREDUCE models the relative binding free energy for sequence <italic>S</italic> as a sum of parameters associated with the DNA sequence features <inline-formula><mml:math id="inf2"><mml:mi>φ</mml:mi><mml:mo>∈</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> that characterize <italic>S</italic>:</p><p><disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mo>∆</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>φ</mml:mi><mml:mo>∈</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mo>∆</mml:mo><mml:mo>∆</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>φ</mml:mi></mml:msub></mml:math></disp-formula></p><p>In this study, we considered both single-nucleotide features (e.g. <italic>φ</italic> = A<sub>1</sub>, denoting the presence of an A at position 1 within the binding site window) and adjacent-dinucleotide ones (e.g., <italic>φ </italic>= <italic>C</italic><sub>3</sub><italic>G</italic><sub>4</sub>, denoting the presence of a CpG dinucleotide starting at position 3). At a given position, exactly one of a set of 4 single-nucleotide features (A, C, G, or T) will be present in any particular sequence. We refer to such a set of mutually exclusive and jointly exhaustive features as a 'block'. Each sequence has exactly one feature from each block. A binding window of length <italic>L</italic> contains <italic>L</italic> mononucleotide blocks. There is a one-to-one correspondence between the (exponentiated) ∆∆<italic>G<sub>φ</sub>/RT</italic> values in a mononucleotide block and a column in a position-specific affinity matrix (PSAM). Together, the dinucleotide features constitute <italic>L </italic>− 1 dinucleotide blocks, each consisting of 16 features. Within each block, the 4 or 16 ∆∆<italic>G<sub>φ</sub></italic> values are only defined up to a common additive constant. The convention we use for mononucleotide blocks is that ∆∆<italic>G<sub>φ</sub> = 0</italic> for the feature that occurs in the reference sequence. For dinucleotide blocks, however, we use a different convention intended to minimize the number of ∆∆<italic>G<sub>φ</sub></italic> values that are significantly different from zero (see below for details).</p></sec><sec id="s3-3"><title>Modeling PBM intensity</title><p>The model on which MatrixREDUCE (<xref ref-type="bibr" rid="bib13">Foat et al., 2006</xref>) was based assumes that the measured fluorescence intensity <italic>y</italic>(<italic>S</italic>) for probe <italic>S</italic> is given by a sum over all possible ways in which the TF can bind to the probe (all possible offsets in either the forward or the reverse direction), which we will here refer to as partial 'views' <italic>S</italic><sub>v</sub> on the full probe sequence <italic>S</italic>:</p><p><disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>v</mml:mi></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext>ΔΔ</mml:mtext><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>In FeatureREDUCE, to account for positional and directional biases in the extent to which binding affinity in a particular view contributes to the probe intensity, we introduce coefficients γ<italic><sub>ν</sub></italic> that are shared across all probes:</p><p><disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>v</mml:mi></mml:munder><mml:msub><mml:mi>γ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext>ΔΔ</mml:mtext><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>We do not necessarily assume a low TF concentration (cf. <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>). Moreover, we include a term ∆∆<italic>G</italic><sub>ns</sub> that accounts for non-specific binding, which helps capture the DNA binding characteristics of the protein succinctly and has a positive effect on numerical convergence when estimating the model parameters. Together, this leads to the following model:</p><p><disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>ν</mml:mi></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mfenced><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext>ΔΔ</mml:mtext><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mtext>ΔΔ</mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mtext>ns</mml:mtext></mml:msub><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula></p></sec><sec id="s3-4"><title>Robust model parameter estimation</title><p>FeatureREDUCE estimates the parameters in <xref ref-type="disp-formula" rid="equ9">Equation 9</xref> using iteratively reweighted least squares (IRLS). This procedure down-weights data points that have high residuals compared to the fitted model. However, the weights depend on the residuals and the residuals depend on the weights. This dependency is broken by first choosing uniform initial weights, then iteratively refitting the model and re-calculating new residuals and weights, until convergence. IRLS prevents over-fitting and thereby allows for improved parameter estimation. FeatureREDUCE uses the 'rlm' function in the MASS package for R to perform the robust regression. We set the trimmed probes hyperparameter to 20%, as we previously found this value to be optimal during cross-validation on the DREAM5 dataset (<xref ref-type="bibr" rid="bib43">Weirauch, 2013</xref>). Repeated rounds of parameter re-estimation that cycle over feature 'blocks' are performed until convergence, first for mononucleotide blocks (resulting in a converged PSAM), and subsequently for dinucleotide blocks. Specifically, when estimating the free energy parameters for a given block <italic>B</italic>, the following model is fit:</p><p><disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>φ</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mi>φ</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>φ</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mo>∆</mml:mo><mml:mo>∆</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo>∆</mml:mo><mml:mo>∆</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>φ</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula></p><p>Here <italic>V</italic><sub><italic>φ</italic></sub>(<italic>S</italic>) denotes the subset of views on <italic>S </italic> that contain feature <italic>φ</italic>. Note that only the <italic>β<sub>φ</sub></italic> coefficients are treated as fit parameters here. The ∆∆<italic>G<sub>φ</sub></italic> values come from the previous iteration. However, they are re-estimated as:</p><p><disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mfrac><mml:mrow><mml:mtext>ΔΔ</mml:mtext><mml:msub><mml:mi>G</mml:mi><mml:mi>φ</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mtext>log</mml:mtext><mml:mfenced><mml:mfrac><mml:msub><mml:mi>β</mml:mi><mml:mi>φ</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mtext>PSAM</mml:mtext></mml:msub></mml:mfrac></mml:mfenced></mml:math></disp-formula></p><p>Here <italic>β</italic><sub>PSAM</sub> stands for the value of <italic>β</italic><sub>1</sub> in <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> when only mononucleotide features are fit. With this normalization, ∆∆<italic>G<sub>φ</sub></italic> is no longer equal to zero for dinucleotide features occurring in the reference sequence. However, most of the ∆∆<italic>G<sub>φ</sub></italic> values for dinucleotide features now tend to be close to zero, which is desirable. In each round, the spatial bias parameters <italic>γ</italic><sub>ν</sub> are also re-estimated using robust regression. After iteration and convergence over multiple such rounds, FeatureREDUCE fits the additional parameters in the non-linear model in <xref ref-type="disp-formula" rid="equ10">Equation 10</xref> using the Levenberg-Marquardt nonlinear least-squares algorithm.</p></sec><sec id="s3-5"><title>Seed discovery</title><p>Finding a good seed for the feature-based regression procedure is a crucial first step in our algorithm. To select the seed from the set of all oligomers of length <italic>K</italic>, we developed a dedicated robust iterative algorithm based on trimmed means designed to deal with the sparseness of the design matrix. We fit probe intensities as a weighted sum of the number of occurrences of each of the 4<italic><sup>K</sup></italic> oligomers:</p><p><disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>m</mml:mi></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here <italic>X</italic><sub>m</sub>(<italic>S</italic>) denotes the number of occurrences of oligomer <italic>m</italic> in sequence <italic>S</italic>. Regression coefficients <italic>β<sub>m</sub></italic> were initialized to a small value (10<sup>−4</sup>) representative of non-specific binding. Next, for each individual probe <italic>S</italic>, we determined the coefficient value <italic>β’<sub>m</sub>(S)</italic> that exactly predicts the intensity:</p><p><disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:msubsup><mml:mi>β</mml:mi><mml:mi>m</mml:mi><mml:mo>'</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>X</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mfenced close="]" open="["><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:msub><mml:mi>β</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:msub><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>We then computed the trimmed mean <inline-formula><mml:math id="inf3"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mi>m</mml:mi><mml:mo>'</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> (removing the top and bottom 15% values) of all <italic>β’<sub>m</sub>(S)</italic> values across all probes for which <italic>X<sub>m</sub></italic> &gt; 0. Finally, we updated the coefficient according to:</p><p><disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:msubsup><mml:mi>β</mml:mi><mml:mi>m</mml:mi><mml:mo>'</mml:mo></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>using a step size <italic>α</italic> = 0.1. This was done for all oligomers in parallel. After iteration and convergence, the oligomer with the highest regression coefficient value was chosen as the seed.</p></sec><sec id="s3-6"><title>Palindromic symmetry</title><p>This step in the algorithm starts by separately fitting and then comparing positive and negative strand PSAMs. If these are similar according to the L1-norm (within a small tolerance) then the motif is flagged as symmetric. The PSAM is then rebuilt using the highest-affinity symmetric seed. The symmetric version of the binding motif tends to be more accurate while using half the number of parameters.</p> </sec><sec id="s3-7"><title>Motif length</title><p>We determine the length of the binding site by adding columns to either side of the PSAM until the coefficient of determination (R<sup>2</sup>) decreases. An increase indicates that there are direct or indirect protein-DNA contacts being made at the additional positions, while a decrease indicates that we have increased the length of the motif past the effective range of specificity and inadvertently excluded valid binding sites at the end of the PBM probe.</p></sec><sec id="s3-8"><title>Testing for gene ontology association</title><p>Following (<xref ref-type="bibr" rid="bib40">Ward and Bussemaker, 2008</xref>), we first predict the total affinity of each gene’s upstream region, as a sum over a sliding window of binding affinities computed using our model. Next, all genes were ranked by this total promoter affinity and the Wilcoxon-Mann-Whitney rank-sum test was used to score association with each Gene Ontology category (<xref ref-type="bibr" rid="bib15">Gene Ontology and Consortium, 2015</xref>). P-values were corrected for multiple testing using a Bonferroni correction based on the total number of GO categories tested in parallel.</p></sec><sec id="s3-9"><title>Alternative binding modes</title><p>To infer multiple-binding models for a single TF, the following procedure was used: (i) Fit a single-binding-model using the standard algorithm. (ii) Fit additional binding-mode model(s) to the residuals of the previous model. (iii) Iteratively update each binding mode as a weighted mean between a newly fit model and the model from the previous iteration, until convergence. (iv) Perform a final multiple regression to determine the relative preference for (and statistical significance of) each binding mode.</p></sec><sec id="s3-10"><title>Motifs containing poly-G/C stretches</title><p>Stretches of four or more guanines affect the efficiency of PBM probe synthesis and were replaced by their reverse complement in some PBM designs (<xref ref-type="bibr" rid="bib8">Berger et al., 2008</xref>). Therefore, if the highest-affinity motif contains four or more consecutive cytosines, <italic>FeatureREDUCE</italic> uses only the positive strand to generate the biophysical model; conversely, if the highest-affinity motif contains a poly-G stretch, only the negative strand is used.</p></sec><sec id="s3-11"><title>Software availability</title><p><ext-link ext-link-type="uri" xlink:href="http://bussemakerlab.org/software/FeatureREDUCE/">http://bussemakerlab.org/software/FeatureREDUCE/</ext-link></p> </sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank the members of the Bussemaker and Mann labs for comments and feedback during the course of these studies. This work was supported by National Institute of Health grants R01HG003008 to HJB, GM058575 to RSM, F32GM087047 to MS, and F32GM099160 to NA, a John Simon Guggenheim Foundation Fellowship (HJB), and pilot funding from Columbia University’s Research Initiatives in Science and Engineering (RISE) program to HJB and RSM.</p></ack><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title> <fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>TRR, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn> <fn fn-type="con" id="con2"><p>AL, Conception and design, Analysis and interpretation of data</p></fn> <fn fn-type="con" id="con3"><p>RSM, Analysis and interpretation of data, Drafting or revising the article</p></fn> <fn fn-type="con" id="con4"><p>HJB, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn> </fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><sec id="s6" sec-type="datasets"><title>Major datasets</title> <p>The following previously published datasets were used:</p> <p><related-object content-type="generated-dataset" id="dataro1" source-id="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=400" source-id-type="uri"><collab>Bulyk ML</collab>, <collab>co-workers</collab><x>,</x> <year>2006</year><x>,</x><source>Transcription factor Zif268</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=400">http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=400</ext-link><x>,</x> <comment>Publicly available at the Uni Probe Database (Accession no: UP00400).</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro2" source-id="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE29506" source-id-type="uri"><collab>Zhou X</collab>, <collab>O'Shea E</collab><x>,</x> <year>2011</year><x>,</x><source>Integrated approaches reveal determinants of genome-wide binding and function of the transcription factor Pho4</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE29506">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE29506</ext-link><x>,</x> <comment>Publicly available at the Gene Expression Omnibus (Accession no: GSE29506).</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro3" source-id="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=397" source-id-type="uri"><collab>Bulyk ML</collab>, <collab>co-workers</collab><x>,</x> <year>2006</year><x>,</x><source>Transcription factor Cbf1</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=397">http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=397</ext-link><x>,</x> <comment>Publicly available at the Uni Probe Database (Accession no: UP00397).</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro4" source-id="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE29506" source-id-type="uri"><collab>Zhou X</collab>, <collab>O'Shea E</collab><x>,</x> <year>2011</year><x>,</x><source>Integrated approaches reveal determinants of genome-wide binding and function of the transcription factor Pho4</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE29506">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE29506</ext-link><x>,</x> <comment>Publicly available at the Gene Expression Omnibus (Accession no: GSE29506).</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro5" source-id="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM730520" source-id-type="uri"><collab>Zhou X</collab>, <collab>O'Shea E</collab><x>,</x> <year>2011</year><x>,</x><source>Pho2_ChIP_HighPi</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM730520">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSM730520</ext-link><x>,</x> <comment>Publicly available at the Gene Expression Omnibus (Accession no: GSM730520).</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro6" source-id="http://www.sciencemag.org/content/suppl/2007/01/09/315.5809.233.DC1/1131007s_database.zip" source-id-type="uri"><collab>Maerkl</collab>, <collab>Quake</collab><x>,</x> <year>2007</year><x>,</x><source>Cbf1 MITOMI data</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.sciencemag.org/content/suppl/2007/01/09/315.5809.233.DC1/1131007s_database.zip">http://www.sciencemag.org/content/suppl/2007/01/09/315.5809.233.DC1/1131007s_database.zip</ext-link><x>,</x> <comment>Publicly available at sciencemag.org</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro7" source-id="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=332" source-id-type="uri"><collab>Bulyk ML</collab>, <collab>co-workers</collab><x>,</x> <year>2009</year><x>,</x><source>Transcription factor Pho4</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=332">http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=332</ext-link><x>,</x> <comment>Publicly available at the Uni Probe Database (Accession no: UP00332).</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro8" source-id="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=327" source-id-type="uri"><collab>Bulyk ML</collab>, <collab>co-workers</collab><x>,</x> <year>2009</year><x>,</x><source>Transcription factor Yap1</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=327">http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=327</ext-link><x>,</x> <comment>Publicly available at the Uni Probe Database (Accession no: UP00327).</comment></related-object></p> <p><related-object content-type="generated-dataset" id="dataro9" source-id="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=285" source-id-type="uri"><collab>Bulyk ML</collab>, <collab>co-workers</collab><x>,</x> <year>2009</year><x>,</x><source>Transcription factor Gcn4</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=285">http://the_brain.bwh.harvard.edu/uniprobe/detailsDef.php?id=285</ext-link><x>,</x> <comment>Publicly available at the Uni Probe Database (Accession no: UP00285).</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abe</surname><given-names>N</given-names></name><name><surname>Dror</surname><given-names>I</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Slattery</surname><given-names>M</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name><name><surname>Rohs</surname><given-names>R</given-names></name><name><surname>Mann</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Deconvolving the recognition of DNA shape from sequence</article-title><source>Cell</source><volume>161</volume><fpage>307</fpage><lpage>318</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.02.008</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Agius</surname><given-names>P</given-names></name><name><surname>Arvey</surname><given-names>A</given-names></name><name><surname>Chang</surname><given-names>W</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name><name><surname>Leslie</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>High resolution models of transcription factor-DNA affinities improve in vitro and in vivo binding predictions</article-title><source>PLoS Computational Biology</source><volume>6</volume><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000916</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badis</surname><given-names>G</given-names></name><name><surname>Berger</surname><given-names>MF</given-names></name><name><surname>Philippakis</surname><given-names>AA</given-names></name><name><surname>Talukder</surname><given-names>S</given-names></name><name><surname>Gehrke</surname><given-names>AR</given-names></name><name><surname>Jaeger</surname><given-names>SA</given-names></name><name><surname>Chan</surname><given-names>ET</given-names></name><name><surname>Metzler</surname><given-names>G</given-names></name><name><surname>Vedenko</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Kuznetsov</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>CF</given-names></name><name><surname>Coburn</surname><given-names>D</given-names></name><name><surname>Newburger</surname><given-names>DE</given-names></name><name><surname>Morris</surname><given-names>Q</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Diversity and complexity in DNA recognition by transcription factors</article-title><source>Science </source><volume>324</volume><fpage>1720</fpage><lpage>1723</lpage><pub-id pub-id-type="doi">10.1126/science.1162327</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>TL</given-names></name><name><surname>Elkan</surname><given-names>C</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Unsupervised learning of multiple motifs in biopolymers using expectation maximization</article-title><source>Machine Learning</source><volume>21</volume><fpage>51</fpage><lpage>80</lpage><pub-id pub-id-type="doi">10.1007/BF00993379</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benos</surname><given-names>PV</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Additivity in protein-DNA interactions: how good an approximation is it?</article-title><source>Nucleic Acids Research</source><volume>30</volume><fpage>4442</fpage><lpage>4451</lpage><pub-id pub-id-type="doi">10.1093/nar/gkf578</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>OG</given-names></name><name><surname>von Hippel</surname><given-names>PH</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Selection of DNA binding sites by regulatory proteins. statistical-mechanical theory and application to operators and promoters</article-title><source>Journal of Molecular Biology</source><volume>193</volume><fpage>723</fpage><lpage>743</lpage><pub-id pub-id-type="doi">10.1016/0022-2836(87)90354-8</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>MF</given-names></name><name><surname>Philippakis</surname><given-names>AA</given-names></name><name><surname>Qureshi</surname><given-names>AM</given-names></name><name><surname>He</surname><given-names>FS</given-names></name><name><surname>Estep</surname><given-names>PW</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Compact, universal DNA microarrays to comprehensively determine transcription-factor binding site specificities</article-title><source>Nature Biotechnology</source><volume>24</volume><fpage>1429</fpage><lpage>1435</lpage><pub-id pub-id-type="doi">10.1038/nbt1246</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>MF</given-names></name><name><surname>Badis</surname><given-names>G</given-names></name><name><surname>Gehrke</surname><given-names>AR</given-names></name><name><surname>Talukder</surname><given-names>S</given-names></name><name><surname>Philippakis</surname><given-names>AA</given-names></name><name><surname>Peña-Castillo</surname><given-names>L</given-names></name><name><surname>Alleyne</surname><given-names>TM</given-names></name><name><surname>Mnaimneh</surname><given-names>S</given-names></name><name><surname>Botvinnik</surname><given-names>OB</given-names></name><name><surname>Chan</surname><given-names>ET</given-names></name><name><surname>Khalid</surname><given-names>F</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Newburger</surname><given-names>D</given-names></name><name><surname>Jaeger</surname><given-names>SA</given-names></name><name><surname>Morris</surname><given-names>QD</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Variation in homeodomain DNA binding revealed by high-resolution analysis of sequence preferences</article-title><source>Cell</source><volume>133</volume><fpage>1266</fpage><lpage>1276</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2008.05.024</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>MF</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Universal protein-binding microarrays for the comprehensive characterization of the DNA-binding specificities of transcription factors</article-title><source>Nature Protocols</source><volume>4</volume><fpage>393</fpage><lpage>411</lpage><pub-id pub-id-type="doi">10.1038/nprot.2008.195</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bussemaker</surname><given-names>HJ</given-names></name><name><surname>Foat</surname><given-names>BC</given-names></name><name><surname>Ward</surname><given-names>LD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Predictive modeling of genome-wide mRNA expression: from modules to molecules</article-title><source>Annual Review of Biophysics and Biomolecular Structure</source><volume>36</volume><fpage>329</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1146/annurev.biophys.36.040306.132725</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Djordjevic</surname><given-names>M</given-names></name><name><surname>Sengupta</surname><given-names>AM</given-names></name><name><surname>Shraiman</surname><given-names>BI</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A biophysical approach to transcription factor binding site discovery</article-title><source>Genome Research</source><volume>13</volume><fpage>2381</fpage><lpage>2390</lpage><pub-id pub-id-type="doi">10.1101/gr.1271603</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foat</surname><given-names>BC</given-names></name><name><surname>Houshmandi</surname><given-names>SS</given-names></name><name><surname>Olivas</surname><given-names>WM</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Profiling condition-specific, genome-wide regulation of mRNA stability in yeast</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>102</volume><fpage>17675</fpage><lpage>17680</lpage><pub-id pub-id-type="doi">10.1073/pnas.0503803102</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foat</surname><given-names>BC</given-names></name><name><surname>Morozov</surname><given-names>AV</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Statistical mechanical modeling of genome-wide transcription factor occupancy data by MatrixREDUCE</article-title><source>Bioinformatics</source><volume>22</volume><elocation-id>e141</elocation-id><lpage>e149</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl223</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frech</surname><given-names>K</given-names></name><name><surname>Quandt</surname><given-names>K</given-names></name><name><surname>Werner</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Software for the analysis of DNA sequence elements of transcription</article-title><source>Bioinformatics</source><volume>13</volume><fpage>89</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/13.1.89</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>The Gene Ontology Consortium</collab><name><surname>Gene Ontology</surname><given-names>C</given-names></name><name><surname>Consortium</surname><given-names>GO</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Gene ontology consortium: going forward</article-title><source>Nucleic Acids Research</source><volume>43</volume><fpage>D1049</fpage><lpage>D1056</lpage><pub-id pub-id-type="doi">10.1093/nar/gku1179</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordân</surname><given-names>R</given-names></name><name><surname>Murphy</surname><given-names>KF</given-names></name><name><surname>McCord</surname><given-names>RP</given-names></name><name><surname>Zhu</surname><given-names>C</given-names></name><name><surname>Vedenko</surname><given-names>A</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Curated collection of yeast transcription factor DNA binding specificity data reveals novel structural and gene regulatory insights</article-title><source>Genome Biology</source><volume>12</volume><fpage>R125</fpage><pub-id pub-id-type="doi">10.1186/gb-2011-12-12-r125</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordân</surname><given-names>R</given-names></name><name><surname>Shen</surname><given-names>N</given-names></name><name><surname>Dror</surname><given-names>I</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Horton</surname><given-names>J</given-names></name><name><surname>Rohs</surname><given-names>R</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genomic regions flanking e-box binding sites influence DNA binding specificity of bHLH transcription factors through DNA shape</article-title><source>Cell Reports</source><volume>3</volume><fpage>1093</fpage><lpage>1104</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.03.014</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Huber</surname><given-names>PJ</given-names></name><name><surname>Ronchetti</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><chapter-title><italic>Robust statistics</italic>. 2nd</chapter-title><source>Wiley Series in Probability and Statistics</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>Wiley. </publisher-name><fpage>354</fpage></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolma</surname><given-names>A</given-names></name><name><surname>Kivioja</surname><given-names>T</given-names></name><name><surname>Toivonen</surname><given-names>J</given-names></name><name><surname>Cheng</surname><given-names>L</given-names></name><name><surname>Wei</surname><given-names>G</given-names></name><name><surname>Enge</surname><given-names>M</given-names></name><name><surname>Taipale</surname><given-names>M</given-names></name><name><surname>Vaquerizas</surname><given-names>JM</given-names></name><name><surname>Yan</surname><given-names>J</given-names></name><name><surname>Sillanpaa</surname><given-names>MJ</given-names></name><name><surname>Bonke</surname><given-names>M</given-names></name><name><surname>Palin</surname><given-names>K</given-names></name><name><surname>Talukder</surname><given-names>S</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name><name><surname>Luscombe</surname><given-names>NM</given-names></name><name><surname>Ukkonen</surname><given-names>E</given-names></name><name><surname>Taipale</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Multiplexed massively parallel SELEX for characterization of human transcription factor binding specificities</article-title><source>Genome Research</source><volume>20</volume><fpage>861</fpage><lpage>873</lpage><pub-id pub-id-type="doi">10.1101/gr.100552.109</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolma</surname><given-names>A</given-names></name><name><surname>Yan</surname><given-names>J</given-names></name><name><surname>Whitington</surname><given-names>T</given-names></name><name><surname>Toivonen</surname><given-names>J</given-names></name><name><surname>Nitta</surname><given-names>KR</given-names></name><name><surname>Rastas</surname><given-names>P</given-names></name><name><surname>Morgunova</surname><given-names>E</given-names></name><name><surname>Enge</surname><given-names>M</given-names></name><name><surname>Taipale</surname><given-names>M</given-names></name><name><surname>Wei</surname><given-names>G</given-names></name><name><surname>Palin</surname><given-names>K</given-names></name><name><surname>Vaquerizas</surname><given-names>JM</given-names></name><name><surname>Vincentelli</surname><given-names>R</given-names></name><name><surname>Luscombe</surname><given-names>NM</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name><name><surname>Lemaire</surname><given-names>P</given-names></name><name><surname>Ukkonen</surname><given-names>E</given-names></name><name><surname>Kivioja</surname><given-names>T</given-names></name><name><surname>Taipale</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>DNA-binding specificities of human transcription factors</article-title><source>Cell</source><volume>152</volume><fpage>327</fpage><lpage>339</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2012.12.009</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinney</surname><given-names>JB</given-names></name><name><surname>Tkacik</surname><given-names>G</given-names></name><name><surname>Callan</surname><given-names>CG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Precise physical models of protein-DNA interaction from high-throughput data</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>104</volume><fpage>501</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1073/pnas.0609908104</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawrence</surname><given-names>C</given-names></name><name><surname>Altschul</surname><given-names>S</given-names></name><name><surname>Boguski</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Neuwald</surname><given-names>A</given-names></name><name><surname>Wootton</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Detecting subtle sequence signals: a gibbs sampling strategy for multiple alignment</article-title><source>Science</source><volume>262</volume><fpage>208</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1126/science.8211139</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>M-LT</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name><name><surname>Whitmore</surname><given-names>GA</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>A statistical model for investigating binding probabilities of DNA nucleotide sequences using microarrays</article-title><source>Biometrics</source><volume>58</volume><fpage>981</fpage><lpage>988</lpage><pub-id pub-id-type="doi">10.1111/j.0006-341X.2002.00981.x</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levine</surname><given-names>HA</given-names></name><name><surname>Nilsen-Hamilton</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A mathematical analysis of SELEX</article-title><source>Computational Biology and Chemistry</source><volume>31</volume><fpage>11</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1016/j.compbiolchem.2006.10.002</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maerkl</surname><given-names>SJ</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A systems approach to measuring the binding energy landscapes of transcription factors</article-title><source>Science</source><volume>315</volume><fpage>233</fpage><lpage>237</lpage><pub-id pub-id-type="doi">10.1126/science.1131007</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>Q</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Jury remains out on simple models of transcription factor specificity</article-title><source>Nature Biotechnology</source><volume>29</volume><fpage>483</fpage><lpage>484</lpage><pub-id pub-id-type="doi">10.1038/nbt.1892</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nutiu</surname><given-names>R</given-names></name><name><surname>Friedman</surname><given-names>RC</given-names></name><name><surname>Luo</surname><given-names>S</given-names></name><name><surname>Khrebtukova</surname><given-names>I</given-names></name><name><surname>Silva</surname><given-names>D</given-names></name><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Schroth</surname><given-names>GP</given-names></name><name><surname>Burge</surname><given-names>CB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Direct measurement of DNA affinity landscapes on a high-throughput sequencing instrument</article-title><source>Nature Biotechnology</source><volume>29</volume><fpage>659</fpage><lpage>664</lpage><pub-id pub-id-type="doi">10.1038/nbt.1882</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riley</surname><given-names>TR</given-names></name><name><surname>Slattery</surname><given-names>M</given-names></name><name><surname>Abe</surname><given-names>N</given-names></name><name><surname>Rastogi</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>D</given-names></name><name><surname>Mann</surname><given-names>RS</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>SELEX-seq: a method for characterizing the complete repertoire of binding site preferences for transcription factor complexes</article-title><source>Methods in Molecular Biology </source><volume>1196</volume><fpage>255</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1007/978-1-4939-1242-1_16</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roider</surname><given-names>HG</given-names></name><name><surname>Kanhere</surname><given-names>A</given-names></name><name><surname>Manke</surname><given-names>T</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Predicting transcription factor affinities to DNA from a biophysical model</article-title><source>Bioinformatics</source><volume>23</volume><fpage>134</fpage><lpage>141</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl565</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname><given-names>FP</given-names></name><name><surname>Hughes</surname><given-names>JD</given-names></name><name><surname>Estep</surname><given-names>PW</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Finding DNA regulatory motifs within unaligned noncoding sequences clustered by whole-genome mRNA quantitation</article-title><source>Nature Biotechnology</source><volume>16</volume><fpage>939</fpage><lpage>945</lpage><pub-id pub-id-type="doi">10.1038/nbt1098-939</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharon</surname><given-names>E</given-names></name><name><surname>Lubliner</surname><given-names>S</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name><name><surname>Stormo</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A feature-based approach to modeling protein–DNA interactions</article-title><source>PLoS Computational Biology</source><volume>4</volume><elocation-id>e1000154</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000154</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slattery</surname><given-names>M</given-names></name><name><surname>Riley</surname><given-names>T</given-names></name><name><surname>Liu</surname><given-names>P</given-names></name><name><surname>Abe</surname><given-names>N</given-names></name><name><surname>Gomez-Alcala</surname><given-names>P</given-names></name><name><surname>Dror</surname><given-names>I</given-names></name><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Rohs</surname><given-names>R</given-names></name><name><surname>Honig</surname><given-names>B</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name><name><surname>Mann</surname><given-names>RS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cofactor binding evokes latent differences in DNA binding specificity between hox proteins</article-title><source>Cell</source><volume>147</volume><fpage>1270</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.10.053</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Schneider</surname><given-names>TD</given-names></name><name><surname>Gold</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Quantitative analysis of the relationship between nucleotide sequence and functional activity</article-title><source>Nucleic Acids Research</source><volume>14</volume><fpage>6661</fpage><lpage>6679</lpage><pub-id pub-id-type="doi">10.1093/nar/14.16.6661</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Yoshioka</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Specificity of the mnt protein determined by binding to randomized operators</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>88</volume><fpage>5699</fpage><lpage>5703</lpage><pub-id pub-id-type="doi">10.1073/pnas.88.13.5699</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Strobl</surname><given-names>S</given-names></name><name><surname>Yoshioka</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Specificity of the mnt protein. independent effects of mutations at different positions in the operator</article-title><source>Journal of Molecular Biology</source><volume>229</volume><fpage>821</fpage><lpage>826</lpage><pub-id pub-id-type="doi">10.1006/jmbi.1993.1088</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name><name><surname>Fields</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Specificity, free energy and information content in protein–DNA interactions</article-title><source>Trends in Biochemical Sciences</source><volume>23</volume><fpage>109</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1016/S0968-0004(98)01187-6</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>DNA binding sites: representation and discovery</article-title><source>Bioinformatics</source><volume>16</volume><fpage>16</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/16.1.16</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanay</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Extensive low-affinity transcriptional interactions in the yeast genome</article-title><source>Genome Research</source><volume>16</volume><fpage>962</fpage><lpage>972</lpage><pub-id pub-id-type="doi">10.1101/gr.5113606</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teh</surname><given-names>HF</given-names></name><name><surname>Peh</surname><given-names>WYX</given-names></name><name><surname>Su</surname><given-names>X</given-names></name><name><surname>Thomsen</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Characterization of protein−DNA interactions using surface plasmon resonance spectroscopy with various assay schemes</article-title><source>Biochemistry</source><volume>46</volume><fpage>2127</fpage><lpage>2135</lpage><pub-id pub-id-type="doi">10.1021/bi061903t</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ward</surname><given-names>LD</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Predicting functional transcription factor binding through alignment-free and affinity-based analysis of orthologous promoter sequences</article-title><source>Bioinformatics</source><volume>24</volume><fpage>i165</fpage><lpage>i171</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btn154</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warren</surname><given-names>CL</given-names></name><name><surname>Kratochvil</surname><given-names>NCS</given-names></name><name><surname>Hauschild</surname><given-names>KE</given-names></name><name><surname>Foister</surname><given-names>S</given-names></name><name><surname>Brezinski</surname><given-names>ML</given-names></name><name><surname>Dervan</surname><given-names>PB</given-names></name><name><surname>Phillips</surname><given-names>GN</given-names></name><name><surname>Ansari</surname><given-names>AZ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Defining the sequence-recognition profile of DNA-binding molecules</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>103</volume><fpage>867</fpage><lpage>872</lpage><pub-id pub-id-type="doi">10.1073/pnas.0509843102</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warren</surname><given-names>CL</given-names></name><name><surname>Zhao</surname><given-names>J</given-names></name><name><surname>Glass</surname><given-names>K</given-names></name><name><surname>Rishi</surname><given-names>V</given-names></name><name><surname>Ansari</surname><given-names>AZ</given-names></name><name><surname>Vinson</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fabrication of duplex DNA microarrays incorporating methyl-5-cytosine</article-title><source>Lab Chip</source><volume>12</volume><fpage>376</fpage><lpage>380</lpage><pub-id pub-id-type="doi">10.1039/C1LC20698B</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weirauch</surname><given-names>MT</given-names></name><name><surname>Cote</surname><given-names>A</given-names></name><name><surname>Norel</surname><given-names>R</given-names></name><name><surname>Annala</surname><given-names>M</given-names></name><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Riley</surname><given-names>TR</given-names></name><name><surname>Saez-Rodriguez</surname><given-names>J</given-names></name><name><surname>Cokelaer</surname><given-names>T</given-names></name><name><surname>Vedenko</surname><given-names>A</given-names></name><name><surname>Talukder</surname><given-names>S</given-names></name><name><surname>Agius</surname><given-names>P</given-names></name><name><surname>Arvey</surname><given-names>A</given-names></name><name><surname>Bucher</surname><given-names>P</given-names></name><name><surname>Callan</surname><given-names>CG</given-names></name><name><surname>Chang</surname><given-names>CW</given-names></name><name><surname>Chen</surname><given-names>C-Y</given-names></name><name><surname>Chen</surname><given-names>Y-S</given-names></name><name><surname>Chu</surname><given-names>Y-W</given-names></name><name><surname>Grau</surname><given-names>J</given-names></name><name><surname>Grosse</surname><given-names>I</given-names></name><name><surname>Jagannathan</surname><given-names>V</given-names></name><name><surname>Keilwagen</surname><given-names>J</given-names></name><name><surname>Kiełbasa</surname><given-names>SM</given-names></name><name><surname>Kinney</surname><given-names>JB</given-names></name><name><surname>Klein</surname><given-names>H</given-names></name><name><surname>Kursa</surname><given-names>MB</given-names></name><name><surname>Lähdesmäki</surname><given-names>H</given-names></name><name><surname>Laurila</surname><given-names>K</given-names></name><name><surname>Lei</surname><given-names>C</given-names></name><name><surname>Leslie</surname><given-names>C</given-names></name><name><surname>Linhart</surname><given-names>C</given-names></name><name><surname>Murugan</surname><given-names>A</given-names></name><name><surname>Myšičková</surname><given-names>A</given-names></name><name><surname>Noble</surname><given-names>WS</given-names></name><name><surname>Nykter</surname><given-names>M</given-names></name><name><surname>Orenstein</surname><given-names>Y</given-names></name><name><surname>Posch</surname><given-names>S</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Rudnicki</surname><given-names>WR</given-names></name><name><surname>Schmid</surname><given-names>CD</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name><name><surname>Sung</surname><given-names>W-K</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name><name><surname>Morris</surname><given-names>QD</given-names></name><name><surname>Bulyk</surname><given-names>ML</given-names></name><name><surname>Stolovitzky</surname><given-names>G</given-names></name><name><surname>Hughes</surname><given-names>TR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evaluation of methods for modeling transcription factor sequence specificity</article-title><source>Nature Biotechnology</source><volume>31</volume><fpage>126</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1038/nbt.2486</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Granas</surname><given-names>D</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Inferring binding energies from selected binding sites</article-title><source>PLoS Computational Biology</source><volume>5</volume><elocation-id>e1000590</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000590</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Quantitative analysis demonstrates most transcription factors require only simple models of specificity</article-title><source>Nature Biotechnology</source><volume>29</volume><fpage>480</fpage><lpage>483</lpage><pub-id pub-id-type="doi">10.1038/nbt.1893</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>Y</given-names></name><name><surname>Ruan</surname><given-names>S</given-names></name><name><surname>Pandey</surname><given-names>M</given-names></name><name><surname>Stormo</surname><given-names>GD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Improved models for transcription factor binding site identification using nonindependent interactions</article-title><source>Genetics</source><volume>191</volume><fpage>781</fpage><lpage>790</lpage><pub-id pub-id-type="doi">10.1534/genetics.112.138685</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Q</given-names></name><name><surname>Liu</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Modeling within-motif dependence for transcription factor binding site predictions</article-title><source>Bioinformatics</source><volume>20</volume><fpage>909</fpage><lpage>916</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bth006</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>O'Shea</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Integrated approaches reveal determinants of genome-wide binding and function of the transcription factor Pho4</article-title><source>Molecular Cell</source><volume>42</volume><fpage>826</fpage><lpage>836</lpage><pub-id pub-id-type="doi">10.1016/j.molcel.2011.05.025</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>T</given-names></name><name><surname>Shen</surname><given-names>N</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Abe</surname><given-names>N</given-names></name><name><surname>Horton</surname><given-names>J</given-names></name><name><surname>Mann</surname><given-names>RS</given-names></name><name><surname>Bussemaker</surname><given-names>HJ</given-names></name><name><surname>Gordân</surname><given-names>R</given-names></name><name><surname>Rohs</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Quantitative modeling of transcription factor binding specificities using DNA shape</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>112</volume><fpage>4654</fpage><lpage>4659</lpage><pub-id pub-id-type="doi">10.1073/pnas.1422023112</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06397.029</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Friedman</surname><given-names>Nir</given-names></name><role>Reviewing editor</role><aff id="aff7"><institution>The Hebrew University of Jerusalem</institution>, <country>Israel</country></aff></contrib></contrib-group></front-stub> <body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled &quot;Building accurate sequence-to-affinity models from high-throughput in vitro protein-DNA binding data using FeatureREDUCE&quot; for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by Aviv Regev (Senior editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors.</p> <p>The Reviewing editor and the other reviewers discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission.</p> <p>The main concerns raised by the reviewers were:</p> <p>1) Lack of details about the methods, and in particular how dinucleotide interactions are incorporated and their impact on the quality of predictions, and the use of robust regression.</p> <p>2) More thorough and detailed evaluation of the performance of the method compared to others (the reviews provide specific suggestions).</p> <p><italic>Reviewer #1:</italic> </p> <p>During recent years there has been a wealth of information gathered about the DNA-binding specificity of proteins using microarrays and sequencing methods. A challenge posed by this data is how to generalize from experimental results to a model of the DNA-binding preferences (or affinities) of the protein. The authors describe a computational tool (FeatureREDUCE) for dealing with these challenges. They evaluate their tool on a few in vitro and in vivo datasets and compare it to recent state of the art tools.</p> <p>I agree with the authors’ description of a shift in the field from data-poor regime (where only a few binding sets per protein were known) to a data-rich regime where high-throughput methods assigning affinity/preference of the protein to thousands sequences. Yet, the methodology for representing these affinities has been lagging behind the experimental advances. I also agree with their goal of finding such a representation to generalize (i.e., extrapolate) from the results of PBMs (which list affinity value for all possible 8-mers).</p> <p>To the best of my understanding the new contributions here involve the following:</p> <p>1) The use of feature-based &quot;free-energy&quot; based method combined with specific robust estimation methods. These extend previous methods of the authors by using published methods.</p> <p>2) Estimating position-bias in PBM data in parallel to estimating sequence preferences.</p> <p>3) The use of Poisson regression for SELEX-seq data.</p> <p>The authors evaluate their claims by using existing datasets to evaluate the results of their method compared to few recent ones in the literature.</p> <p>I list comments on these aspects of the paper, especially the first, below. These describe what I view as major problems in the current manuscript, but I believe they are all addressable.</p> <p>The manuscript is, above all, a methods paper. It seems to be carefully designed method to solve a well-established and important problem and it definitely would be suitable for a specialized journal. For a wider audience, I would have expected a much more significant innovation that provided new and useful insights about the general computational problem and the underlying biological reality.</p> <p>Major concerns:</p> <p>The authors discuss at length the importance of their free-energy view of the problem. Frankly, the discussion relating free energy representation that defines a Gibbs distribution and probabilistic models (especially exponential models) has been hashed thoroughly in multiple venues and communities. In terms of representation, there is no difference between the representational powers of position-specific Affinity and position specific Probability matrix. I agree that affinities allow an elegant way to adjust the probability due to changes in protein concentration (if you believe the system is in equilibrium). However, this is a much more minute difference than the authors' presentation makes it seem. I would tone down the &quot;sale pitch&quot; on this view. It is a useful one to have (and has been discussed since early days, e.g., Berg and von Hippel, 1987), but it is not inherently superior.</p> <p>Similarly, the introduction of feature-based representations of free-energy differences (<inline-formula><mml:math id="inf4"><mml:mrow><mml:mtext>ΔΔ</mml:mtext></mml:mrow></mml:math></inline-formula>G) is mathematically similar or identical to previous methods (e.g., Sharon, Lubliner and Segal, 2008).</p> <p>There is a great discrepancy between the main text and figures and the Materials and methods regarding the use of features (one of the novelties of the current manuscript). The discussion in the Materials and methods mentions only position-specific mutation and do not mention any higher-order feature, which ones are searched, and how. From <xref ref-type="fig" rid="fig3">Figure 3 I</xref> assume these are strings of mutations. However, the way the method generates candidate features (all the ones I see in the figure involve pairs of adjacent positions) or search/decide among them is not specified.</p> <p>Another discrepancy between the main text and the Materials and methods is the issue of robust estimation. The authors view the use of robust estimation as one of their main contributions (reference in the Abstract, dedicated supplemental figures, etc.). Yet, the Methods are vague about the details. The main text provides a reference for a book about robust statistics, which while surely a useful text, is not helpful for the reader who attempts to understand what actually happens in the estimation procedure.</p> <p>Much of the evaluation of the method is based on its performance in a published comparison of many computational methods. It is surprising that one of the best performing methods in that comparison has been unpublished in the two years since the comparison was performed (the program has been available for download apparently).</p> <p>The evaluation carried out in this manuscript is limited for cases where there is external information to compare against. I found the evaluation of GO enrichment p-value of <xref ref-type="fig" rid="fig3">Figure 3</xref> as a very indirect (and inaccurate) indicator of quality (the difference between p-value of 10<sup>-8</sup> to 10<sup>-7</sup> are not that dramatic and can be driven by changes in the status of few genes). Similarly, the differences in RMSE in <xref ref-type="fig" rid="fig4">Figure 4</xref> are not convincing me that the model is substantially different or better. First of all, ChIP signal (enrichment over background) is often not a reliable quantitative signal. Second, it is unclear how differences in low affinity sequences change actual predictions made with these models. I would expect an evaluation to provide the reader with a sense as to when the precise details do matter. I suspect they do, but the current presentation is focused on various summaries that are not transparent nor reflect actual differences in predictions.</p> <p><italic>Reviewer #2:</italic> </p> <p>The manuscript describes FeatureREDUCE, a successor to the very successful MatrixREDUCE method for inferring TF binding preferences/(relative affinity) from in vitro binding data. FeatureREDUCE adds robust regression, dinucleotide affinity models, and various features specific for recent large-scale in vitro assays of TF binding (location models for PBMs, Poisson regression for sequencing-based approaches, etc.). Results are presented on a handful of TFs, so these examples simply illustrate the advantages of the new features rather than to extensively test them.</p> <p>Although it seems iterative, and the validation is limited, this is very important work. The software package would be immediately useful to a large group of researchers. Despite the abundance of work in this area, there's really nothing as comprehensive (and correct) as the described software available. BEEML and BEEML-PBM come close but the manuscript nicely illustrates the advantages of FeatureREDUCE. The fact that this software works well was already illustrated in a previous study (Weirauch et al.) and all the important conceptual and engineering advances over the past few years are implemented in this package. I think <italic>eLife</italic> would be a great spot for this manuscript to end up.</p> <p>A few things need to be fixed though. First, there are a number of missing details about the methodology that need to be filled in. Also, the manuscript is a little grandiose and needs to be toned down. Finally, and very importantly, the software needs to be open source and freely available. The value of this manuscript is the associated software; if that software isn't freely available, then there's no point in publishing this manuscript.</p> <p>Major concerns:</p> <p>1) It looks like in <xref ref-type="fig" rid="fig4">Figure 4</xref> that you didn't permit BEEML to fit a protein concentration parameter as well, so this isn't a fair comparison. To make it fair, you could i) not fit a protein concentration parameter for FeatureREDUCE or ii) fit one for BEEML. Actually, you should do both, just to be sure.</p> <p>2) Please provide more details in the &quot;Robust Regression&quot; about the MM-estimator. This technique will be new to most readers. How was it implemented? Are there any other free parameters besides the number of trimmed probes?</p> <p>3) From Equation 11, it looks like BiasREDUCE requires non-linear regression. If so, then <xref ref-type="fig" rid="fig1">Figure 1</xref> caption #3 is wrong.</p> <p>4) How do you go from a seed k-mer to an initial PSAM? Presumably, you can't start with any zeros in the PSAM or you will get zero partial derivatives.</p> <p>5) What is your tolerance for the L1-norm for the palindromes?</p> <p>6) You need to provide more details about the multi-PSAM mode and experiments. Do you fit an initial PSAM and then fit a second one to the residuals using the entire pipeline (starting with #1)? Do you then re-fit the first PSAM? How do you decide whether or not a second PSAM is necessary?</p> <p><italic>Reviewer #3:</italic> </p> <p>Riley and colleagues describe the development and application of a computational regression algorithm (FeatureREDUCE) to build more accurate affinity models from PBM or SELEX-seq datasets. This new method relies on iterative regression steps and the incorporation of dinucleotide dependencies to train improved affinity models for transcription factor binding. The utility of these affinity models is demonstrated on transcription factors with simple and complex binding modes.</p> <p>Overall, this computational approach appears to display improved performance over other existing methods for building affinity models, and consequently will be of value to the broader scientific community. However, the current manuscript does not describe for the end-user the type of models that are generated for use in other applications – in particular how weights for the dinucleotide dependencies in the FSAM can be represented and readily displayed for interpretation. One subset of dinucleotide dependencies is displayed in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, where surprisingly (if this reviewer is interpreting the data correctly) the strongest dinucleotide contributions to the model are substantial penalties against the consensus sequence. To this reviewer, this result is counter-intuitive, and deserves comment, as it does not mesh with a simplistic view of dinucleotide effects in protein-DNA recognition (e.g. a single amino acid simultaneously and synergistically contacting neighboring base pairs in the preferred binding site). Moreover, since the authors are claiming the demonstration of the existence of dinucleotide dependencies based on their analysis, which has been a contentious point in the field, further explanation is warranted.</p> <p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p> <p>Thank you for resubmitting your work entitled &quot;Building accurate sequence-to-affinity models from high-throughput in vitro protein-DNA binding data using FeatureREDUCE&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Aviv Regev (Senior editor), a Reviewing editor, and two reviewers.</p> <p>The authors responded to the issues raised. However, the reviewers’ opinion was that this response is too terse/unsatisfactory in places. We strongly recommend that the authors attempt to provide a clear understandable description of the methods, to the extent that someone with reasonable knowledge in the field but not in this project can understand what is being done in each step.</p> <p>Essential revisions:</p> <p>1) The software must be deposited to a public repository (GitHub or similar). Or at the very least, the open source version of FeatureREDUCE used in this manuscript should be made available through the supplement for this journal article. Published software should have an additional guarantee of availability though the journal and/or an outside authority like GitHub (or BitBucket, or similar; we do not wish to proscribe the channel for release).</p> <p>2) Clarify the methods description of discrimination from reference sequence. Reviewer comment (following the authors' response):</p> <p>Again, if this reviewer is interpreting the data correctly from <xref ref-type="fig" rid="fig3">Figure 3A</xref>, there is a penalty against CG dinucleotides at positions -1 and 1. (Likewise CA at -3,-2 and TG at 2,3) Based on the description in the Methods:</p> <p>&quot;FeatureREDUCE models the binding free energy for sequence S as a sum of coefficients associated with all the &quot;features&quot; that discriminate S from the reference sequence Sref (usually the DNA sequence with the highest affinity). In this study, we considered single-nucleotide features (&quot;A at position 1&quot;) and adjacent dinucleotide features (&quot;CG at positions 3 and 4&quot;).&quot;</p> <p>The authors describe the utilization of these features to discriminate S from Sref. The strongest (negative) dinucleotide features in <xref ref-type="fig" rid="fig3">Figure 3A</xref> are for dinucleotides that are in Sref, as presumably the highest affinity sequence is the reference sequence. Again, this reviewer may be missing some critical understanding of the algorithm, but based on the methods description the result does not fit with expectation. (Why would dinucleotide dependencies be discovered that apply to Sref?) Consequently, a more adequate description is required in the Materials and methods.</p> <p>3) “Feature-based modeling of intensities”. This paragraph is hard to make sense of, and uses too many ill-defined terms. Please include what the features are, the coefficient (what are &quot;columns of features&quot;?), and how are defined (as you did for position-specific case).</p> <p>4) The &quot;Seed detection&quot; paragraph is similarly obscure.</p> <p>5) Probe-position effects – what is α? Are the γ coefficients shared among all probes? When/how are they estimated?</p> <p>6) The authors use rlm (from MASS package) to estimate the &quot;parameters in <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>&quot;. Up to now the authors discussed coefficients (are these parameters?). As far as I can tell, these do not appear in a linear form in <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>. How do you resolve that?</p></body> </sub-article> <sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.06397.030</article-id><title-group><article-title>Author response</article-title></title-group></front-stub> <body><p>Reviewer #1:</p> <p><italic>The manuscript is, above all, a methods paper. It seems to be carefully designed method to solve a well-established and important problem and it definitely would be suitable for a specialized journal. For a wider audience, I would have expected a much more significant innovation that provided new and useful insights about the general computational problem and the underlying biological reality.</italic> </p> <p>The technical innovations presented here make it possible to do two things that were not possible before for the first time: (i) capturing dinucleotide dependencies in a way that holds up in cross-platform validation, (ii) quantify the relative importance of iple binding modes for the same transcription factor. Indeed, Reviewer #2 states that our work is important for the genomics community, and that <italic>eLife</italic> will be an excellent home for it.</p> <p><italic>The authors discuss at length the importance of their free-energy view of the problem. Frankly, the discussion relating free energy representation that defines a Gibbs distribution and probabilistic models (especially exponential models) has been hashed thoroughly in multiple venues and communities. In terms of representation, there is no difference between the representational powers of position-specific Affinity and position specific Probability matrix. I agree that affinities allow an elegant way to adjust the probability due to changes in protein concentration (if you believe the system is in equilibrium). However, this is a much more minute difference than the authors' presentation makes it seem. I would tone down the &quot;sale pitch&quot; on this view. It is a useful one to have (and has been discussed since early days, e.g., Berg and von Hippel, 1987), but it is not inherently superior.</italic> </p> <p>We thank the reviewer for their careful reading of the manuscript and the constructive feedback. We have revised the text to make clear that we do not claim a new representation of DNA binding specificity, but present an improved method for estimating the binding specificity parameters from high-throughput data.</p> <p>We agree that the affinity and probability representations of relative base preference can often be used equivalently, as only ratios between bases are physically meaningful. However, this equivalence only holds for the probability that a given protein molecule is bound by a DNA molecule of a particular sequence. Even in this case, as the reviewer notes, they are not exactly the same, as the probabilities can be compressed relative to the affinities due to saturation at higher free protein concentrations.</p> <p>Affinities always reflect the intrinsic binding preferences of the transcription factor. Base probabilities by contrast are always context dependent. This can lead to confusion and incorrect interpretation. For instance, when base probabilities are used to summarize aligned top-scoring sequences, the proportionality with affinity is lost. This is why we emphasize the difference. In fact, one could say that the essence of what FeatureREDUCE does is to first model DNA sequence probabilities in terms of TF-DNA affinities, and then put this model in reverse in order to infer the affinity parameters from the PBM data.</p> <p>Nevertheless, we agree with this reviewer that we could have described the similarities and differences with alternative approaches more clearly. Therefore, as you will see, we have thoroughly rewritten the relevant section in our Introduction.</p> <p><italic>Similarly, the introduction of feature-based representations of free-energy differences (</italic><inline-formula><mml:math id="inf5"><mml:mrow><mml:mtext>ΔΔ</mml:mtext></mml:mrow></mml:math></inline-formula> <italic>G) is mathematically similar or identical to previous methods (e.g., Sharon, Lubliner and Segal, 2008).</italic> </p> <p>We do agree that there is no essential difference between “energy” and “affinity” representations, as they are related by a simple log-transformation through the Boltzmann factor. We have clarified this in the text and added an additional reference (Gordon et al., 2013) to credit their early use of a feature-based representation of binding specificity.</p> <p><italic>There is a great discrepancy between the main text and figures and the Materials and methods regarding the use of features (one of the novelties of the current manuscript). The discussion in the Materials and methods mentions only position-specific mutation and do not mention any higher-order feature, which ones are searched, and how. From <xref ref-type="fig" rid="fig3">Figure 3 I</xref> assume these are strings of mutations. However, the way the method generates candidate features (all the ones I see in the figure involve pairs of adjacent positions) or search/decide among them is not specified.</italic> </p> <p>We agree, and thank the reviewer for bringing this to our attention. The Materials and methods now have a newly added section “Feature-based models of binding affinity” that describes in more detail how FeatureREDUCE defines dinucleotide features and estimates free energy coefficients for them.</p> <p><italic>Another discrepancy between the main text and the Methods is the issue of robust estimation. The authors view the use of robust estimation as one of their main contributions (reference in the Abstract, dedicated supplemental figures, etc.). Yet, the Materials and methods are vague about the details. The main text provides a reference for a book about robust statistics, which while surely a useful text, is not helpful for the reader who attempts to understand what actually happens in the estimation procedure.</italic> </p> <p>Again, we agree that this is a good idea, and have provided more detail in the Materials and methods section about the iteratively reweighted least-squares (IRLS) method for robust regression.</p> <p><italic>Much of the evaluation of the method is based on its performance in a published comparison of many computational methods. It is surprising that one of the best performing methods in that comparison has been unpublished in the two years since the comparison was performed (the program has been available for download apparently).</italic> </p> <p>We would like to emphasize that following up on the study by Weirauch et al. (2013) is only one aspect of our manuscript. We also demonstrate for the first time how the relative preference between multiple binding modes can be accurately modeled.</p> <p><italic>The evaluation carried out in this manuscript is limited for cases where there is external information to compare against. I found the evaluation of GO enrichment p-value of <xref ref-type="fig" rid="fig3">Figure 3</xref> as a very indirect (and inaccurate) indicator of quality (the difference between p-value of 10<sup>-8</sup> to 10<sup>-7</sup> are not that dramatic and can be driven by changes in the status of few genes). Similarly, the differences in RMSE in <xref ref-type="fig" rid="fig4">Figure 4</xref> are not convincing me that the model is substantially different or better. First of all, ChIP signal (enrichment over background) is often not a reliable quantitative signal. Second, it is unclear how differences in low affinity sequences change actual predictions made with these models. I would expect an evaluation to provide the reader with a sense as to when the precise details do matter. I suspect they do, but the current presentation is focused on various summaries that are not transparent nor reflect actual differences in predictions.</italic> </p> <p>Both the ChIP and GO analysis serve to show that the affinity models are useful as predictors of in vivo function of the TF. We agree with the reviewer that the in vivo ChIP enrichment signal in general can be highly complex, but the fact that we only use the ChIP enrichment values for Cbf1p at a few hundred predicted in vitro binding sites in the genome makes this problem less severe. The GO analysis admittedly is indirect, but it is an attempt to use the affinity model to predict target genes solely from promoter sequence. This analysis was inspired by a similar one performed by Maerkl &amp; Quake (2007) to validate their MITOMI 1.0 assay. Our affinity model is used to predict the affinity landscape across the entire upstream promoter region of each gene, integrating high and low affinity sites. As such, it puts strong demands on the affinity model. Nevertheless, not only do we find that genes in GO categories consistent with the known function of the TF tend to be associated with higher promoter affinities (and thus presumably more responsive to changes in the activity of the TF), but also that the trends regarding the benefits of robust regression and dinucleotides are in the same direction as when we validate more directly against in vitroMITOMI 1.0 data for the same TF (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). The GO and ChIP analyses are valuable complementary results in our opinion.</p> <p>To address the reviewer’s concern that it is not obvious that the improvement in RMSE when dinucleotide term are added to the model in <xref ref-type="fig" rid="fig4">Figure 4</xref> is statistically significant, we have added a permutation test that explicitly addresses this: we performed 100,000 iterations of randomly permuting the inferred dinucleotide corrections in <xref ref-type="fig" rid="fig4">Figure 4</xref> to show that the decrease in the RMSE by a third when including dinucleotide dependencies is indeed significant (p-value 2.7e-5). Also, this significant improvement in the affinity model is not due to just one or two binding sites. Rather, as seen by the red residual lines in <xref ref-type="fig" rid="fig4">Figure 4</xref>, most of the binding sites show an improvement in their predicted affinities when including the dinucleotide dependencies.</p> <p>We disagree with the assertion that our analysis is not transparent: we show all the data underlying our summary statistics, both for the ChIP (<xref ref-type="fig" rid="fig4">Figure 4</xref>) and the GO (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>) analysis. The GO scoring is done using a non-parametric distributional test (Wilcoxon-Mann-Whitney), and we do not classify genes as “target” or “non-target”, and therefore the sensitivity to small changes in the status of genes does not apply here. We have added a new section to the Methods that provides these details about the GO scoring. We now apply a Bonferroni correction to the p-values, and have updated Figure panel 3B accordingly.</p> <p>Reviewer #2:<italic>A few things need to be fixed though. First, there are a number of missing details about the methodology that need to be filled in. Also, the manuscript is a little grandiose and needs to be toned down. Finally, and very importantly, the software needs to be open source and freely available. The value of this manuscript is the associated software; if that software isn't freely available, then there's no point in publishing this manuscript. It would just be free advertising for Columbia University, or Bussemaker lab, or whoever. If that's the goal, then I suggest arXiv. Ideally, the software would be put in GitHub or some other archiving service. 'Available by contacting the authors' is no longer acceptable in this field.</italic> </p> <p>We thank the reviewer for acknowledging the relevance of our work. The missing details about the methods have been added, as described below and in response to the other reviewers. We have also toned down our manuscript where was warranted.</p> <p>Our software is already publicly available via our lab website. Anybody can register, and obtain it. Our reason for doing this, rather than posting it on a completely open repository such as GitHub, is that we would like to be able to email the users about future updates to the software. In response to the reviewer’s request that the software be open source, we now also include the Java source code along with the compiled classes. We have also added working examples (“demos”) for each type of analysis.</p> <p><italic>1) It looks like in <xref ref-type="fig" rid="fig4">Figure 4</xref> that you didn't permit BEEML to fit a protein concentration parameter as well, so this isn't a fair comparison. To make it fair, you could i) not fit a protein concentration parameter for FeatureREDUCE or ii) fit one for BEEML. Actually, you should do both, just to be sure.</italic> </p> <p>Although it may not be obvious, the same model with a free protein concentration parameter was fit for BEEML as for FeatureREDUCE. In the case of BEEML, the best fit was obtained with a much smaller value of this protein concentration parameter, which makes the green curve look linear. We have updated the caption to clarify this and dispel any doubts that the comparison was done fairly.</p> <p><italic>2) Please provide more details in the &quot;Robust Regression&quot; about the MM-estimator. This technique will be new to most readers. How was it implemented? Are there any other free parameters besides the number of trimmed probes?</italic> </p> <p>We have provided more detail in the Methods section about the iteratively reweighted least-squares (IRLS) method for robust regression. FeatureREDUCE uses the “rlm” function in the MASS package for R to perform the robust regression. There are no other free parameters besides the number of trimmed probes. See also our response to Reviewer #1.</p> <p><italic>3) From Equation 11, it looks like BiasREDUCE requires non-linear regression. If so, then <xref ref-type="fig" rid="fig1">Figure 1</xref> caption #3 is wrong.</italic> </p> <p>We believe the caption is correct. FeatureREDUCE solves Equation 11 by cycling through the steps in <xref ref-type="fig" rid="fig1">Figure 1</xref>. BiasREDUCE (step 3) does not fit the free-protein concentration and thus does not need to use non-linear regression. Only SaturationREDUCE (step 4) fits the free-protein concentration and uses non-linear regression.</p> <p><italic>4) How do you go from a seed k-mer to an initial PSAM? Presumably, you can't start with any zeros in the PSAM or you will get zero partial derivatives.</italic> </p> <p>This statement is not correct. The affinity for an entire binding site is a product over positions (or, more generally, features). Therefore, the partial derivative with respect to one of the model coefficients is a product over all other positions/features. Consequently, there is no reason for the derivative to be zero when the feature coefficient is zero (as would be the case for all three single-base features at any given position that are not in the seed).</p> <p><italic>5) What is your tolerance for the L1-norm for the palindromes?</italic> </p> <p>The tolerance is configurable. However, the default is (0.15 x motif length). The maximum L1-distance between the positive- and negative-strand PSAMs is (2 x motifLength). We have clarified this in the Materials and methods.</p> <p><italic>6) You need to provide more details about the multi-PSAM mode and experiments. Do you fit an initial PSAM and then fit a second one to the residuals using the entire pipeline (starting with #1)? Do you then re-fit the first PSAM? How do you decide whether or not a second PSAM is necessary?</italic> </p> <p>We now provide more detail in the Materials and methods section about the modeling of alternative binding modes. The FeatureREDUCE pipeline remains the same. However, at each step, each binding-mode model is fit to the residuals of the other models instead of the original binding data. The relative affinities between the different binding-mode models is used to determine the existence and magnitude of alternative binding.</p> <p>Reviewer #3:</p> <p><italic>Overall, this computational approach appears to display improved performance over other existing methods for building affinity models, and consequently will be of value to the broader scientific community. However, the current manuscript does not describe for the end-user the type of models that are generated for use in other applications – in particular how weights for the dinucleotide dependencies in the FSAM can be represented and readily displayed for interpretation. One subset of dinucleotide dependencies is displayed in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, where surprisingly (if this reviewer is interpreting the data correctly) the strongest dinucleotide contributions to the model are substantial penalties against the consensus sequence. To this reviewer, this result is counter-intuitive, and deserves comment, as it does not mesh with a simplistic view of dinucleotide effects in protein-DNA recognition (e.g. a single amino acid simultaneously and synergistically contacting neighboring base pairs in the preferred binding site). Moreover, since the authors are claiming the demonstration of the existence of dinucleotide dependencies based on their analysis, which has been a contentious point in the field, further explanation is warranted.</italic> </p> <p>We do not think there is anything counter-intuitive or unusual going on here, but it may require some explanation. We have therefore added some more explanation to the Materials and methods.</p> <p>The dinucleotide features cannot be seen in isolation from the single-nucleotide features. To be concrete, at the two central positions, –1 and +1, we see a very strong preference for C and G, respectively, at the single-nucleotide level. When we add up the free energy coefficients for sequences that have CG at the center, with two highly favorable mononucleotide contributions and a moderately unfavorable dinucleotide contribution, the net outcome is still a very strong preference for CG over all 15 other dinucleotides. In the present paper, we are agnostic about the structural mechanisms that underlie the value of the dinucleotide coefficients, but our results are not inconsistent with one amino acid simultaneously recognizing two base pairs, the example mentioned by the reviewer.</p> <p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p> <p><italic>Essential revisions: 1) The software must be deposited to a public repository (GitHub or similar). Or at the very least, the open source version of FeatureREDUCE used in this manuscript should be made available through the supplement for this journal article. This is not because we do not trust the authors. Rather, many things that can go wrong when authors are the only ones responsible for the availability of their published software. Published software should have an additional guarantee of availability though the journal and/or an outside authority like GitHub (or BitBucket, or similar; we do not wish to proscribe the channel for release).</italic></p> <p>We agree, and have created a public repository github.com/FeatureREDUCE/FeatureREDUCE/</p> <p><italic>2) Clarify the methods description of discrimination from reference sequence. Reviewer comment (following the authors' response):</italic> </p> <p><italic>Again, if this reviewer is interpreting the data correctly from <xref ref-type="fig" rid="fig3">Figure 3A</xref>, there is a penalty against CG dinucleotides at positions -1 and 1. (Likewise CA at -3,-2 and TG at 2,3) Based on the description in the Methods: &quot;FeatureREDUCE models the binding free energy for sequence S as a sum of coefficients associated with all the &quot;features&quot; that discriminate S from the reference sequence Sref (usually the DNA sequence with the highest affinity). In this study, we considered single-nucleotide features (&quot;A at position 1&quot;) and adjacent dinucleotide features (&quot;CG at positions 3 and 4&quot;).&quot; The authors describe the utilization of these features to discriminate S from Sref. The strongest (negative) dinucleotide features in <xref ref-type="fig" rid="fig3">Figure 3A</xref> are for dinucleotides that are in Sref, as presumably the highest affinity sequence is the reference sequence. Again, this reviewer may be missing some critical understanding of the algorithm, but based on the methods description the result does not fit with expectation. (Why would dinucleotide dependencies be discovered that apply to Sref?) Consequently, a more adequate description is required in the Methods.</italic> </p> <p>We agree that we did not describe how the ddG values for dinucleotide features shown in <xref ref-type="fig" rid="fig3">Figure 3A</xref> are normalized. For single-nucleotide features we use a standard normalization where ddG=0 for features in the optimal reference sequence. However, as we explain in detail in the revised Methods section, the normalization we use for dinucleotide features is quite different, hence the confusion on the part of the reviewer. We have also updated <xref ref-type="fig" rid="fig3">Figure 3A</xref> to make everything completely consistent with expectation: a newly added non-zero ddG value associated with the PSAM in <xref ref-type="fig" rid="fig3">Figure 3A</xref> now makes the sum over all features associated with the reference sequence equal to zero as expected. We are grateful to the reviewer for insisting on this point.</p> <p><italic>3) “Feature-based modeling of intensities”. This paragraph is hard to make sense of, and uses too many ill-defined terms. Please include what the features are, the coefficient (what are &quot;columns of features&quot;?), and how are defined (as you did for position-specific case).</italic> </p> <p>We agree, and have completely rewritten this part of the Methods section.</p> <p><italic>4) &quot;Seed detection&quot; paragraph is similarly obscure.</italic> </p> <p>Again we agree. We have expanded and completely rewritten this paragraph.</p> <p><italic>5) Probe-position effects – what is α? Are the γ coefficients shared among all probes? When/how are they estimated?</italic> </p> <p>We have clarified the definition of α. Indeed, the γ coefficients are shared between all probes. We have updated the Methods section to make this clear, and also improved the description of these coefficients are defined and estimated.</p> <p><italic>6) The authors use rlm (from MASS package) to estimate the &quot;parameters in <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>&quot;. Up to now the authors discussed coefficients (are these parameters?). As far as I can tell, these do not appear in a linear form in <xref ref-type="disp-formula" rid="equ11">Equation 11</xref>. How do you resolve that?</italic> </p> <p>Yes, a coefficient is a multiplicative parameter. In linear models, the parameters are therefore called coefficients. However, in nonlinear models the word parameter is more commonly used.</p> <p>We agree that the procedure for solving the old <xref ref-type="disp-formula" rid="equ11">Equation 11</xref> was not properly described, and have expanded the pertinent section in Materials and methods.</p></body> </sub-article> </article>