<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">33370</article-id><article-id pub-id-type="doi">10.7554/eLife.33370</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Short Report</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Large-scale two-photon imaging revealed super-sparse population codes in the V1 superficial layer of awake monkeys</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-100693"><name><surname>Tang</surname><given-names>Shiming</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0294-3259</contrib-id><email>tangshm@pku.edu.cn</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-105551"><name><surname>Zhang</surname><given-names>Yimeng</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2248-8951</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-105552"><name><surname>Li</surname><given-names>Zhihao</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-105553"><name><surname>Li</surname><given-names>Ming</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-105554"><name><surname>Liu</surname><given-names>Fang</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-105557"><name><surname>Jiang</surname><given-names>Hongfei</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-105556"><name><surname>Lee</surname><given-names>Tai Sing</given-names></name><email>tai@cnbc.cmu.edu</email><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">School of Life Sciences and Peking-Tsinghua Center for Life Sciences</institution><institution>Peking University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">IDG/McGovern Institute for Brain Research</institution><institution>Peking University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Key Laboratory of Machine Perception</institution><institution>Peking University</institution><addr-line><named-content content-type="city">Beijing</named-content></addr-line><country>China</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Center for the Neural Basis of Cognition</institution><institution>Carnegie Mellon University</institution><addr-line><named-content content-type="city">Pittsburgh</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">School of Computer Science</institution><institution>Carnegie Mellon University</institution><addr-line><named-content content-type="city">Pittsburgh</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-3105"><name><surname>Salinas</surname><given-names>Emilio</given-names></name><role>Reviewing Editor</role><aff id="aff6"><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>26</day><month>04</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e33370</elocation-id><history><date date-type="received" iso-8601-date="2018-01-24"><day>24</day><month>01</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2018-04-25"><day>25</day><month>04</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Tang et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Tang et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-33370-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.33370.001</object-id><p>One general principle of sensory information processing is that the brain must optimize efficiency by reducing the number of neurons that process the same information. The sparseness of the sensory representations in a population of neurons reflects the efficiency of the neural code. Here, we employ large-scale two-photon calcium imaging to examine the responses of a large population of neurons within the superficial layers of area V1 with single-cell resolution, while simultaneously presenting a large set of natural visual stimuli, to provide the first direct measure of the population sparseness in awake primates. The results show that only 0.5% of neurons respond strongly to any given natural image — indicating a ten-fold increase in the inferred sparseness over previous measurements. These population activities are nevertheless necessary and sufficient to discriminate visual stimuli with high accuracy, suggesting that the neural code in the primary visual cortex is both super-sparse and highly efficient.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>visual cortex</kwd><kwd>two-photon imaging</kwd><kwd>macaque</kwd><kwd>GCaMP5</kwd><kwd>Sparse coding</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>31730109</award-id><principal-award-recipient><name><surname>Tang</surname><given-names>Shiming</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>China Outstanding Young Researcher Award 30525016</award-id><principal-award-recipient><name><surname>Tang</surname><given-names>Shiming</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>National Basic Research Program of China</institution></institution-wrap></funding-source><award-id>2017YFA0105201</award-id><principal-award-recipient><name><surname>Tang</surname><given-names>Shiming</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007937</institution-id><institution>Peking University</institution></institution-wrap></funding-source><award-id>Project 985 grant</award-id><principal-award-recipient><name><surname>Tang</surname><given-names>Shiming</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution>Beijing Municipal Commission of Science and Technology</institution></institution-wrap></funding-source><award-id>Z151100000915070</award-id><principal-award-recipient><name><surname>Tang</surname><given-names>Shiming</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000052</institution-id><institution>NIH Office of the Director</institution></institution-wrap></funding-source><award-id>1R01EY022247</award-id><principal-award-recipient><name><surname>Lee</surname><given-names>Tai Sing</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>CISE 1320651</award-id><principal-award-recipient><name><surname>Lee</surname><given-names>Tai Sing</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100011039</institution-id><institution>Intelligence Advanced Research Projects Activity</institution></institution-wrap></funding-source><award-id>D16PC00007</award-id><principal-award-recipient><name><surname>Lee</surname><given-names>Tai Sing</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Two-photon imaging reveals super-sparse responses to natural images in primate V1, which carry sufficient information for discrimination of the input natural images with high accuracy.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The efficient-coding hypothesis is an important organizing principle of any sensory system (<xref ref-type="bibr" rid="bib2">Barlow, 1981</xref>; <xref ref-type="bibr" rid="bib11">Olshausen and Field, 1996</xref>). It predicts that neuronal population responses should be sparse, although the optimal level of sparseness depends on many factors. Most of the experimental evidence of sparse coding comes from the responses of individual neurons that were exposed to a large set of natural image stimuli, measured using single-unit recording techniques (<xref ref-type="bibr" rid="bib6">Haider et al., 2010</xref>; <xref ref-type="bibr" rid="bib8">Hromádka et al., 2008</xref>; <xref ref-type="bibr" rid="bib17">Rust and DiCarlo, 2012</xref>; <xref ref-type="bibr" rid="bib19">Vinje and Gallant, 2000</xref>). The sparseness of a neuron’s response to a large set of stimuli in these studies was used to infer the sparseness of the population responses. The first direct measurement of population response sparseness was performed with two-photon (2P) GCaMP6 signal imaging in rodents (<xref ref-type="bibr" rid="bib5">Froudarakis et al., 2014</xref>). One potential confound in this work, however, is that GCaMP6 responses are subject to saturation at neuronal firing rates above 60–80 Hz (<xref ref-type="bibr" rid="bib3">Chen et al., 2013</xref>; <xref ref-type="bibr" rid="bib5">Froudarakis et al., 2014</xref>), leading to the potential to under-estimate the sparseness measures that can capture the peakedness or sharpness of the population response distributions. Thus, direct and accurate measurement of the population sparseness of neuronal response, particularly in non-human primates, is required.</p><p>In this study, we provided the first direct measurement of population sparseness from V1 of awake macaques. We performed 2P imaging on a large population of neurons using the genetically encoded calcium indicator GCaMP5 (<xref ref-type="bibr" rid="bib1">Akerboom et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Denk et al., 1990</xref>), delivered with adeno-associated viruses (AAVs). We showed previously that GCaMP5 exhibits linear non-saturating responses across a wide range of firing rates (10–150 Hz) (<xref ref-type="bibr" rid="bib10">Li et al., 2017</xref>), allowing us to measure accurately the response sparseness of almost all of the neurons in layer two in V1 within a 850 µm x 850 µm field of view—the spatial scale of about one hypercolumn.</p></sec><sec id="s2" sec-type="results|discussion"><title>Results and discussion</title><p>Our 2P imaging of GCaMP5 recorded neuronal population calcium (Ca<sup>2+</sup>) responses to 2250 natural images in V1 layer two in two awake macaques (about 1000 neurons each). Each monkey performed a fixation task while stimuli were presented to the appropriate retinotopic position in the visual field. Each trial sequence consisted of: a blank screen presented for one second, followed by a visual stimulus for one second. Each activated cell’s region-of-interest (ROI) was defined as the compact region (&gt;25 pixels) in which brightness exceeded three standard deviations (stds) above baseline, for each individual differential image. The standard ratio of fluorescence change (Δ<italic>F/F0</italic>) of each of these regions of interest (ROIs) during stimulus presentation was calculated as the neuron’s response (see 'Materials and methods').</p><p>The receptive fields (RFs) of the neurons were characterized using oriented gratings and bars presented in various positions. The RF centers of the imaged neurons were located between 3<sup>o</sup> and 5<sup>o</sup> in eccentricity. In each trial, a stimulus of 4<sup>o</sup> x 4<sup>o</sup> in size was presented, randomly drawn from a set of 2250 natural image stimuli (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1c</xref>). The entire set of stimuli was repeated three times. These natural images evoked robust visual responses in the imaged neurons (<xref ref-type="fig" rid="fig1">Figure 1a,b</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1c</xref>).</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.33370.002</object-id><label>Figure 1.</label><caption><title>Population sparseness of neuronal responses of V1 layer two neurons to natural scenes.</title><p>(<bold>a, b</bold>) Calcium images of the neuronal population response to two different natural images (shown in the insets). Typically, only a few neurons, among the nearly 1000 neurons measured (1225 neurons for Monkey A or 982 neurons for Monkey B), responded strongly to a single patch of natural scenes. (<bold>c</bold>) The overall neuronal population responses to all 2250 natural images. Each cell was color-coded according to the response intensity to its optimal stimulus. (<bold>d, e</bold>) The distributions of neuronal population responses to the two natural images. Abscissa indicates the 1225 neurons that showed a significant response to natural images, in ranked order according to their responses to each image. Ordinate indicates Δ<italic>F/F0</italic>. (<bold>f, g</bold>) Frequency histograms showing the distributions of the number of stimuli (out of 2250) (y-axis) with different population sparseness, measured by the number of neurons activated strongly (x-axis). On average, fewer than 0.5% of the cells (6 cells out of 1225 for monkey A, and 4.1 cells out of 982 for monkey B) responded above half of their peak responses for any given image.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig1-v2"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33370.003</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Two-photon calcium imaging in awake macaque monitoring the neuronal activity in V1 layer 2 evoked by natural stimuli.</title><p>(<bold>a, b</bold>) Two-photon images of neurons expressing GCaMP5 at zoom 1X and 2X respectively. (<bold>c</bold>) Natural stimuli evoked robust neural activity that is probed by the calcium indicator GCaMP5.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig1-figsupp1-v2"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33370.004</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Two-photon images and neuronal responses in monkey B.</title><p>(<bold>a, b</bold>) An average two-photon image from monkey B at two levels of magnification. (<bold>c, d</bold>) Images showing different sparse strong neuronal responses to different natural stimuli.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig1-figsupp2-v2"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33370.005</object-id><label>Figure 1—figure supplement 3.</label><caption><title>The ROIs overlaid over a two-photon image of a 850 × 850 µm region under a 16X objective, showing that the ROIs extracted on the basis of activities were well matched to the cell bodies.</title></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig1-figsupp3-v2"/></fig></fig-group><p>We recorded data from 1225 neurons in monkey A and 982 neurons in monkey B, and found that only a few neurons in each monkey responded strongly to any given image (<xref ref-type="fig" rid="fig1">Figure 1a,b</xref>), though most of the neurons responded strongly to at least one of the images in the set (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). The rank-ordered distributions of the population responses were always sharply peaked (<xref ref-type="fig" rid="fig1">Figure 1d,e</xref>). On average, the percentage of neurons that responded above each’s half-maximum was 0.49% (6.0/1,225) for monkey A and and 0.42% (4.1/982) for monkey B (<xref ref-type="fig" rid="fig1">Figure 1f,g</xref>). This is a measure of population sparseness that can capture the peakedness of the population response distribution (see 'Materials and methods'). In other words, only about 0.5% of the cells responded <italic>strongly</italic> to each image, indicating a very high degree of sparseness in the strong population responses or a very sharp population response distribution.</p><p>We also examined each neuron’s stimulus specificity or life-time sparseness (<xref ref-type="bibr" rid="bib20">Willmore et al., 2011</xref>). Interestingly, we found that most cells responded strongly to only a small number of images in the whole stimulus set (<xref ref-type="fig" rid="fig2">Figure 2a,b</xref>). The preferred images for individual neurons often shared common features. For example, neuron 653 of monkey A was most excited when its receptive field (0.8<sup>o</sup> in diameter) covered the lower rim of the cat’s eye (indicated by the red dashed line in the inset in <xref ref-type="fig" rid="fig2">Figure 2b</xref>). The neuron’s preference for the specific curve feature was further confirmed by checking its selectivity to a variety of artificial patterns (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). Similarly, neuron 949 of Monkey A was selective to a different specific curvature embedded within the natural stimuli (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). A more systematic characterization of these cells using artificial stimulus patterns has been reported previously (<xref ref-type="bibr" rid="bib18">Tang et al., 2018</xref>), and this work showed that many of these neurons are highly selective to specific complex patterns. To measure the sharpness of each neuron’s stimulus tuning curve — its life-time response sparseness — we computed the percentage of the stimuli that excited each neuron to &gt;50% of the peak response found from the entire stimulus set. This population average was 0.49% (11/2,250) for Monkey A and 0.41% (9.3/2,250) for Monkey B (<xref ref-type="fig" rid="fig2">Figure 2e,f</xref>). This suggests that a high degree of stimulus specificity or life-time sparseness goes hand-in-hand with a heightened population sparseness.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.33370.006</object-id><label>Figure 2.</label><caption><title>Life-time sparseness in the neuronal responses of V1 layer two neurons to natural scenes.</title><p>(<bold>a, b</bold>) The response of one example cell (cell 653) to the entire set of natural scene stimuli, exhibiting a high level of stimulus specificity. (<bold>c, d</bold>) Another example cell (cell 949) also shows high stimulus specificity. (<bold>e, f</bold>) The distributions of the stimulus specificity of neurons, in terms of the half-height width of the stimulus tuning curves. Each cell would typically respond strongly to fewer than 0.5% of the natural images in our test set.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33370.007</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Reliability analysis of neuronal responses.</title><p>(<bold>a</bold>) The tuning curve of neuron #653’s responses (averaged across trials) to the 2250 stimuli. (<bold>b</bold>) The tuning curve computed from one random shuffle across all trials. (<bold>c</bold>) The ROC of original trials (red curve) against those of 99 shuffled trials (gray). The AUC of the original data is 0.999. The AUC of the example in (<bold>b</bold>), colored in blue, is 0.68. (<bold>d</bold>) The distribution of the AUC’s of all 1000 shuffled cases. The probability that the shuffled AUC can reach the raw data’s AUC is less than 0.001 (p&lt;0.001) for neuron #653.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig2-figsupp1-v2"/></fig></fig-group><p>To understand how much information was carried in the sparse ensemble of population activities, we evaluated how well the sparse neural responses allow a decoder to discriminate the 2250 stimuli (<xref ref-type="bibr" rid="bib13">Quian Quiroga and Panzeri, 2009</xref>; <xref ref-type="bibr" rid="bib5">Froudarakis et al., 2014</xref>). The entire population’s decoding accuracy was 54% for Monkey A and 38% for Monkey B, whereas the chance accuracy was 0.04% (1/2,250) (<xref ref-type="fig" rid="fig3">Figure 3a,b</xref>, horizontal dashed lines). These population decoding accuracies estimate the <italic>highest achievable decoding performance</italic> from the activities recorded for the full population, and serve as the upper limit of accuracy performance that can be achieved by decoders that are made from any subset of neurons in the population (<xref ref-type="fig" rid="fig3">Figure 3a,b</xref>, horizontal dashed lines).</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.33370.008</object-id><label>Figure 3.</label><caption><title>Image decoding performance as a function of the percentage of only the strongest responses used for (a) Monkey A and (b) Monkey B.</title><p>Y axes show the cross-validated decoding accuracy on the 2,250-way image classification task. Dash lines are the referential ‘achievable decoding performance’ in accuracy obtained using the original entire neural population responses; red lines (‘top only’ in key) show the decoding accuracies when different percentages of the top responses were kept and lower responses were removed (set to zero); blue lines (‘top excluded’ in legends) show the decoding accuracies when different percentages of top responses were removed (set to zero) and lower responses were kept. X axes show the percentage of top responses included (red curves) and excluded (blue curves). Check 'Materials and methods <italic>Decoding Analysis'</italic> for details. Gray vertical lines highlight the decoding accuracies including or excluding the top 0.5% responses. Since our classification task is a 2250-way one, the chance accuracy is 1/2,250, or about 0.4%.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.33370.009</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Image decoding performance as a function of the percentage of top-responding neurons selected to be included or excluded, using a threshold relative to the peak response of each neuron.</title><p>See 'Materials and methods' for details. Results were qualitatively similar to those shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-33370-fig3-figsupp1-v2"/></fig></fig-group><p>Now that we know the highest achievable decoding performance of the entire population, we can build on that idea to assess the contribution of strong sparse responses to the overall decoding accuracy. We zeroed all responses below the top 0.5% response threshold and built a new decoding model to discriminate the 2250 stimuli. Here, we assume that only the strong signals above the threshold would be conveyed to downstream neurons successfully. Remarkably, a decoding accuracy of 28% for monkey A and 21% for monkey B could be achieved with only the top 0.5% of the strongest signals included (<xref ref-type="fig" rid="fig3">Figure 3a,b</xref> vertical gray lines). This means that transmitting the top 0.5% of the strongest responses for each image was sufficient to realize 50% of the maximum achievable decoding performance for either monkey.</p><p>Conversely, we can assess the necessity of the top 0.5% of responses by repeating the decoding experiment after removing the strongest signals by setting them to 0, and keeping the remaining 99.5% of the signals intact. The blue curves in <xref ref-type="fig" rid="fig3">Figure 3a and b</xref> show the decoding performance with signals above a range of percentage threshold ‘removed’. The intersections of the blue curves with the gray lines indicate that the decoding performance dropped by 50% when the strongest 0.5% of the signals are removed. Thus, we showed that these strong and sparse signals contain the information necessary to realize half of the decoding performance.</p><p><xref ref-type="fig" rid="fig3">Figure 3a and b</xref> also provides a more complete picture of the decoding performance as a function of percentage threshold. Although the top 0.5% of the signals are both necessary and sufficient for realizing 50% of the performance, 99% of decoding performance is not reached until the top 40% (for monkey A) and top 30% (for monkey B) of the responses are included (saturation of the red curves). However, without the top 5% responses, the decoding performance drops to practically zero (blue curve). Thus, the strongest 5% of the responses are necessary for the achievement of full performance, but insufficient by themselves. In other words, the presence of other weaker signals in the population is required to achieve the full performance. The decoding results revealed that significant information contents are indeed carried by the superb sparse strong responses.</p><p>We note that, in the analyses described above, the selection of responses that were kept or removed was based on the absolute response magnitude of the cells, rather than on a normalized response magnitude for each cell as determined by its peak response. We made this decision because we assumed that downstream neurons may know where the signals come from, but it is not clear whether they can know (or remember from historical responses) the peak response magnitude of the neuron that is providing the signals. For better comparison with the population sparseness measure, we repeated the decoding experiment but this time chose the percentage threshold relative to the peak response of each individual neuron. The results were qualitatively similar, and showed that strong sparse responses still carry a disproportionate amount of information (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Quantitatively, the top 1.5% of the responses are now required to achieve 50% of the decoder’s highest achievable performance. This suggests that absolute response strengths may potentially convey more discriminable information to downstream neurons. The decrease in performance based on the top 0.5% of responses selected on the basis of a relative threshold (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, red curve) is understandable because the relative threshold will include some useless contribution from neurons that have weak peak responses and will exclude the more useful contribution of some neurons that have high peak responses, amplifying the effect of noises particularly when a small number of neurons were selected.</p><p>In conclusion, this study provides the first simultaneous recording of a large dense population of neurons in V1 at single-cell resolution in response to a large set of natural stimuli, using 2P imaging in awake macaque. Earlier studies had provided life-time sparseness measurements in rodents (<xref ref-type="bibr" rid="bib8">Hromádka et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Haider et al., 2010</xref>), non-human primates (<xref ref-type="bibr" rid="bib16">Rolls and Tovee, 1995</xref>; <xref ref-type="bibr" rid="bib19">Vinje and Gallant, 2000</xref>; <xref ref-type="bibr" rid="bib17">Rust and DiCarlo, 2012</xref>) and humans (<xref ref-type="bibr" rid="bib14">Quiroga et al., 2005</xref>), as well as population sparseness measurement in rodents (<xref ref-type="bibr" rid="bib5">Froudarakis et al., 2014</xref>), but our study provides the first direct measurement of sparseness of large-scale neuronal population responses, carried out in awake macaque monkeys and made possible by large-scale 2P imaging techniques. We found that a very small ensemble of neurons from V1’s superficial layer are activated at any one time in response to any given natural image. Using decoding analysis, we showed that the small ensembles of neural responses provide a surprisingly large amount of information to downstream neurons, providing for the discrimination of complex image patterns in natural scenes.</p><p>Earlier studies inferred population sparseness on the basis of measurements of life-time sparseness. For the first time, we have shown that direct measurements of population sparseness are indeed comparable to life-time sparseness measurements. However, the level of sparseness that we observed (0.5% at half maximal response) was considerably higher than that predicted by the earlier life-time estimates of sparseness, which were based on single unit recording in macaques (<xref ref-type="bibr" rid="bib17">Rust and DiCarlo, 2012</xref>). Studies on rodents have yielded a considerable range of estimates of sparseness that vary across measurement techniques (<xref ref-type="bibr" rid="bib6">Haider et al., 2010</xref>; <xref ref-type="bibr" rid="bib8">Hromádka et al., 2008</xref>; <xref ref-type="bibr" rid="bib5">Froudarakis et al., 2014</xref>). A single-unit study that used the cell-attached patch technique might have been the most accurate to date (<xref ref-type="bibr" rid="bib8">Hromádka et al., 2008</xref>), and it showed that neurons were mostly silent in the awake auditory cortex, inferring that less than 2% of the neuronal population showed ‘well-driven’ responses (&gt;20 Hz response frequency) to natural sounds. Our imaging shows that neurons in the superficial layers of V1 are densely packed and have small cell bodies. Thus, it may not be possible to obtain stable and well isolated single-unit signals over several hours using extracellular recording methods. Our study has reduced the biases inherent to previous extracellular recording studies — in neuronal sampling, in stimulus sampling, and in single-cell isolation — by invoking a response in virtually all of the neurons in a single field of view and in a particular layer by using a large set of natural stimuli.</p><p>The high degree of population sparseness that we observed is consistent with two recent conjectures from theoretical neuroscience. First, based on the metabolic costs of spiking, one group posits that fewer than 1% of the neurons should be substantially active concurrently in any brain area (<xref ref-type="bibr" rid="bib9">Lennie, 2003</xref>). Second, and more importantly, theoretical sparse-coding studies have suggested that because V1 neurons are at least 200 times more abundant than their thalamic input, V1 neurons could be quite specialized in their feature selectivity and thus highly sparse in their population responses (<xref ref-type="bibr" rid="bib12">Olshausen, 2013</xref>; <xref ref-type="bibr" rid="bib15">Rehn and Sommer, 2007</xref>). We have indeed observed this very finding using 2P imaging techniques in the V1 superficial layers (<xref ref-type="bibr" rid="bib18">Tang et al., 2018</xref>). These findings are reminiscent of the highly specific codes exhibited by neurons in the human medial temporal lobes (<xref ref-type="bibr" rid="bib14">Quiroga et al., 2005</xref>), suggesting that many V1 neurons might be akin to highly specific ‘grandmother neurons’, although they may encode information in the form of an extremely sparse population code. The observed high degree of population sparseness and life-time sparseness are also consistent with our earlier observation that V1 neurons in this layer were tuned to complex patterns with a great degree of specificity (<xref ref-type="bibr" rid="bib18">Tang et al., 2018</xref>, see also <xref ref-type="bibr" rid="bib7">Hegdé and Van Essen, 2007</xref>). These findings reveal the complexity and specificity of feature selectivity and the super-sparse neural representation within a V1 hypercolumn, providing new understanding of the neural codes in the macaque primary visual cortex.</p></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type (species) <break/>or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional information</th></tr></thead><tbody><tr><td>Strain, strain background (Macaque)</td><td>Rhesus monkeys</td><td>Beijing Prima Biotech Inc</td><td><ext-link ext-link-type="uri" xlink:href="http://www.primasbio.com/cn/Default">http://www.primasbio.com/cn/Default</ext-link></td><td><ext-link ext-link-type="uri" xlink:href="http://www.primasbio.com/cn/Default">http://www.primasbio.com/cn/Default</ext-link></td></tr><tr><td>Recombinant DNA reagent</td><td valign="bottom">AAV1.hSyn.GCaMP5G</td><td valign="bottom">Penn Vector Core</td><td>V5072MI-R</td><td/></tr><tr><td>Software, algorithm</td><td valign="bottom">Matab 7.12.0 (R2011a)</td><td valign="bottom">MathWorks</td><td valign="bottom">Matab 7.12.0 (R2011a)</td><td><ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/">https://www.mathworks.com</ext-link></td></tr><tr><td>Software, algorithm</td><td valign="bottom">Codes for the decoding analysis and image movement correction</td><td valign="bottom">This paper</td><td valign="bottom">Codes for the decoding analysis and image movement correction</td><td><ext-link ext-link-type="uri" xlink:href="https://github.com/leelabcnbc/sparse-coding-elife2018">https://github.com/leelabcnbc/sparse-coding-elife2018</ext-link> (copy archived at<ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/sparse-coding-elife2018">https://github.com/elifesciences-publications/sparse-coding-elife2018</ext-link>)</td></tr></tbody></table></table-wrap><p>All experimental protocols were approved by the Peking University Animal Care and Use Committee, and approved by the Peking University Animal Care and Use Committee (LSC-TangSM-5).</p><sec id="s3-1"><title>Subjects</title><p>The study used two adult rhesus monkeys (A and B), who were 4 and 5 years of age and weighed 5 and 7 kg, respectively (<xref ref-type="bibr" rid="bib10">Li et al., 2017</xref>). Two sequential surgeries were performed on each animal under general anesthesia and strictly sterile conditions. In the first surgery, a 16 mm hole was drilled in the skull over V1. The dura was opened to expose the cortex, into which 50–100 nl AAV1.hSynap.GCaMP5G.WPRE.SV40 (AV-1-PV2478, titer 2.37e13 (GC/ml), Penn Vector Core) was pressure-injected at a depth of ~500 μm. After AAV injection, the dura was sutured, the skull cap was placed back, and the scalp was sutured. Then the animal was returned to its cage for recovery. Antibiotic (Ceftriaxone sodium, Youcare Pharmaceutical Group Co. Ltd., China) was administered for one week. After 45 days, a second surgery was performed, in which three head-posts were implanted on each animal’s skull, two on the forehead and one on the back of the head. A T-shaped steel frame was connected to these head-posts for head stabilization during imaging. The skull and dura were later opened again to explore the cortex. A glass cover-slip (diameter 8 mm and thickness 0.17 mm) was glued to a titanium ring and gently pressed onto the cortical surface. A ring-shape GORE membrane (20 mm in outer diameter) was inserted under the dura. The titanium ring was glued to the dura and skull with dental acrylic to form an imaging chamber. The whole chamber (formed by thick dental acrylic) was covered by a steel shell to prevent breakage of the cover-slip when the animal was returned to the home cage.</p></sec><sec id="s3-2"><title>Behavioral task</title><p>During imaging, each monkey sat in a standard primate chair with head restraint and performed a fixation task, which involved fixating on a small white spot (0.1°) within a window of 1° for over 2 s to obtain a juice reward. Eye position was monitored with an infrared eye-tracking system (ISCAN, Inc.) at 120 Hz.</p></sec><sec id="s3-3"><title>Visual stimuli</title><p>Visual stimuli were generated using the ViSaGe system (Cambridge Research Systems) and displayed on a 17’ LCD monitor (Acer V173, 80 Hz refresh rate) positioned 45 cm from the animal’s eyes. Each stimulus was presented for 1 s after a 1 s blank within a fixation period of 2 s. We estimated the RF sizes and positions of the imaged neurons with small drifting gratings and bars presented at different locations. The RFs were estimated to be 0.2° to 0.8° in size with RF locations between 3° and 5° in eccentricity for both monkeys.</p><p>Drifting and oriented gratings were tested to examine the visual responses of imaged neurons (<xref ref-type="bibr" rid="bib10">Li et al., 2017</xref>). Small patches (0.8° in diameter) of gratings with 100% contrast square waves were presented to the center of RFs of imaged cells, with two spatial frequencies (4.0 and 8.0 cyc/deg) at two temporal frequencies (1 and 2 Hz), six orientations, and two directions (30° apart).</p><p>A natural stimulus set (NS) of 2,250 4° × 4° stimulus patches extracted from different natural scene photos was used to examine the neuronal responses to natural stimuli. The order of the stimuli was randomized in each session. These stimuli were tested on monkeys A and B, each with at least three repetitions.</p></sec><sec id="s3-4"><title>Eye movement control</title><p>We analyzed the distribution of eye-positions during stimulus ON periods. The monkeys’ fixation during stimulus presentation (from 1 to 2 s in the graph) was stable and accurate. The distribution of eye positions during stimulus presentation, with standard deviations smaller than 0.05°, was significantly smaller than the typical receptive field sizes (ranging from 0.2° to 0.8°) of neurons at 3–5° eccentricities. To examine whether the eye movement made a significant contribution to the distribution of neuronal population responses, we compared the standard deviations (stds) of eye position in different population response classes of neurons: (1) weak responses (Δ<italic>F/F0</italic> &lt;0.5), (2) sparse strong responses (one or two cells responded), (3) dense responses (more than ten cells responded). We found no statistically significant differences in the distribution of eye position data in these three classes (<xref ref-type="bibr" rid="bib18">Tang et al., 2018</xref>), indicating that the observed effects were not caused by movement differences. The ROC and decoding analysis (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>), demonstrating the reliability of the neural responses across trials, confirm that the sparse population responses were repeatedly evoked by stimuli, and not by random eye-movement jitters.</p></sec><sec id="s3-5"><title>Two-photon imaging</title><p>After a recovery period of 10 days after the second surgery, the animals were trained to maintain eye-fixation. Two-photon imaging was performed using a Prairie Ultima IV (In Vivo) 2P microscope (Bruker Nano, Inc., FMBU, formerly Prairie Technologies) powered by a Ti: Sapphire laser (Mai Tai eHP, Spectra Physics). The wavelength of the laser was set at 1000 nm. With a 16 × objective (0.8 N.A., Nikon), an area of 850 μm × 850 μm was imaged. A standard slow galvonometer scanner was used to obtain static images of cells with high resolution (1024 × 1024). The fast and resonant scan (up to 32 frames per second) was used to obtain images of neuron activity. The images were recorded at 8 frames per second by averaging each 4 frames. Infected cells of up to 700 μm in depth were imaged. We primarily focused on cells that were 160 μm to 180 μm deep, which included a high density of infected cells.</p></sec><sec id="s3-6"><title>Imaging data analysis</title><p>All data analyses were performed using customized Matlab software (The MathWorks, Natick, MA). The images from each session were first realigned to a template image (the average image of 1000 frames) using a normalized cross-correlation-based translation algorithm, this corrected the X-Y offset of images caused by the relative movements between the objective and the cortex (<xref ref-type="bibr" rid="bib10">Li et al., 2017</xref>).</p><p>The cell density was high in superficial V1, and many cell bodies were quite dim at rest. It was difficult to identify these cells directly by eye or by algorithm on the basis of their morphology as captured in static images. We therefore identified ROIs for cell bodies on the basis of their responses. The differential images (which were averaged frames of the ON stimulus period, from which we then subtracted the average of the stimulus OFF period, for each stimulus condition) were first filtered using low-pass and high-pass Gaussian filters (5 pixels and 50 pixels). Notably, these two filters were used solely for ROI identifications. In all further analyses, we used the raw data without any filtering. Connected subsets of pixels (&gt;25 pixels) with average pixel value greater than 3 stds in these differential images were identified as active neuronal ROIs. Note that these 3 stds empirical value was used only for deciding the ROIs of the activated cells, and was not used as a cutoff threshold for measuring neuronal responses (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>). The ratio of fluorescence change (Δ<italic>F/F0</italic>) of these ROIs was calculated for each activated cell. <italic>ΔF = F F0</italic>, where <italic>F0</italic> is the baseline activity during the blank screen prior to stimulus onset in each trial and <italic>F</italic> is fluorescence activity in the ROI during stimulus presentation in the trial. A neuropil-correction was performed with an index of 0.7 (<xref ref-type="bibr" rid="bib3">Chen et al., 2013</xref>).</p></sec><sec id="s3-7"><title>Sparseness measure</title><p>The sparseness measure is used to quantify the peakedness of the response distribution. There are several different definitions of sparseness and corresponding sparseness measures (<xref ref-type="bibr" rid="bib20">Willmore et al., 2011</xref>). One intuitive one for sparse codes, described by <xref ref-type="bibr" rid="bib20">Willmore et al., 2011</xref>, is that “the population response distribution that is elicited by each stimulus is peaked (exhibits population sparseness). A peaked distribution is one that contains many small (approximately zero) magnitude values and only a small number of large values. Thus, a neural code will have high population sparseness if only a small proportion of the neurons are strongly active at any given time.&quot; A measure consistent with this intuition is the percentage of neurons that responded strongly, above a certain threshold relative to their peak response. This measure has been used in other studies (<xref ref-type="bibr" rid="bib17">Rust and DiCarlo, 2012</xref>), typically with a half-peak response threshold.</p><p>The sparseness measures based on the calculation suggested by <xref ref-type="bibr" rid="bib16">Rolls and Tovee (1995</xref>) and by <xref ref-type="bibr" rid="bib19">Vinje and Gallant (2000</xref>) are popular for quantifying the sparseness of spiking data, but they are very sensitive to measurement noise and uncertain baselines because of nonlinearities and missing responses in the low spiking-rate range (&lt;10 Hz) in calcium imaging (<xref ref-type="bibr" rid="bib10">Li et al., 2017</xref>). The sparseness measure that we used in this study, which is based on the percentage of the cells or stimuli above the half-maximum of each neuron, is much less sensitive to low-level activities (iceberg effect) or baseline fluctuations in the calcium signal.</p></sec><sec id="s3-8"><title>Stability and reliability of the neuronal measurements</title><p>For each single neuron, we examined whether the sparse strong responses (Δ<italic>F/F0</italic> &gt;50% max) observed across the 2250 stimuli were reliable across trials by performing the following ROC analysis (<xref ref-type="bibr" rid="bib14">Quiroga et al., 2005</xref>). We set all the stimuli that produced mean responses greater than 50% of the observed maximum mean peak of the cell to be in the ON class, and all other stimuli to be in the OFF class. We computed the ROC for classifying the ON class against the OFF class based on the response of each single trial. If the responses above the half-maximum are stable across all trials, then the AUC (the area under the ROC curve) will be close to 1.0, because the ON and OFF classes are readily discriminable. The null hypothesis is that sparse strong responses will be spurious single-trial epileptic responses, and not repeatable across trials. To test this hypothesis, we shuffled all the responses against the stimulus labels, and recomputed the mean responses for all the stimuli across the trials. We performed 1000 shuffles. We found that most of the shuffled cases have much lower average peak responses because of the mismatch of the rigorous sparse responses across trials, suggesting that the sparse responses in the original data are reliable. To make an even stricter and more fair comparison with the original data on ROC terms, for each shuffle, we recomputed the maximum responses, and used the half of this mean maximum as the threshold to sort the stimuli into ON and OFF classes and repeated the ROC analysis to obtain the AUC for this shuffle. The probability of the null hypothesis is the percentage of the time that the AUCs of the 1000 shuffles reach the AUC of the original data. With this ROC analysis, we found &gt;96% neurons that adhered to the null hypothesis (p&lt;0.01) (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>).</p></sec><sec id="s3-9"><title>Decoding analysis</title><p>We used a nearest centroid classifier to discriminate the 2250 images on the basis of the population responses in each trial. As each image was tested three times, the nearest centroid classifier was trained on the basis of two trials for all images and tested on the hold-out trials. We repeated the procedure for each trial, performing 3-fold cross-validations.</p><p>For each monkey, we constructed neural response matrices (with dimension 2250 × 1225 for monkey A, and 2250 × 982 for monkey B) for three trials X<sup>(1)</sup>, X<sup>(2)</sup>, and X<sup>(3)</sup> that store the neural responses to all images in each trial as rows in its matrix. We trained and tested nearest-centroid classifiers via a three-fold cross-validation procedure across trials in a 2250-way image decoding task. Specifically, for trial t, during training, we computed the centroids of the other two trials C<sup>(t)</sup> (if t = 1, C<sup>(1)</sup>= (X<sup>(2)</sup> + X<sup>(3)</sup>)/2; if t = 2, C<sup>(2)</sup>= (X<sup>(1)</sup> + X<sup>(3)</sup>)/2, etc.) and stored C<sup>(t)</sup> in the classifier; during testing, given some row k of X<sup>(t)</sup>, which is the population neural response vector to image k in trial t, the (trained) classifier computed the Euclidean distances between row k of X<sup>(t)</sup> and every row of C<sup>(t)</sup>. The model outputted the index (1,2,…,2249,2250) of the row in C<sup>(t)</sup> that gives the smallest distance. The correct output is k and all other outputs are incorrect. The average decoding accuracy for this trial is defined as the percentage of correct outputs over all rows of X<sup>(t)</sup>. We repeated the above procedure for each trial and reported the average of three (average) decoding accuracies.</p><p>In our experiments, we first set the X<sup>(t)</sup>s defined above to be the original recorded neural responses and computed the decoding accuracies for both monkeys. We refer to the accuracies obtained from the original neural data as ‘achievable decoding accuracies’. Later, to evaluate the amount of information in the strong sparse portions of the neural data, we set X<sup>(t)</sup>s to be thresholded versions of the original data. We tried two classes of thresholding methods: ‘top only’ (red in <xref ref-type="fig" rid="fig3">Figure 3</xref>) and ‘top excluded’ (blue in <xref ref-type="fig" rid="fig3">Figure 3</xref>). In ‘top only’, we only kept the largest responses (p%) across images and trials in the thresholded version and set the smaller responses (100-p%) of the to be zero. In ‘top excluded’, which is complementary to ‘top only’, we set the largest responses (p%) to be zero and kept the smaller responses (100-p%). For both ‘top only’ and ‘top excluded’, we evaluated decoding accuracies at the following percentages (crosses in <xref ref-type="fig" rid="fig3">Figure 3</xref>): 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 30, 40, 50, 60, 70, 80, 90, and 99.</p><p>Given that the population sparseness was computed on the basis of the half-maximum of each individual neuron’s response, we also repeated the decoding experiment using a percentage threshold that is relative to each neuron’s peak response, rather than the absolute response threshold, to select the ‘top responding’ neurons to be included or excluded and reset the responses to be excluded in the data matrix to 0 accordingly for training and testing the decoder as before.</p></sec><sec id="s3-10"><title>Software available</title><p>The code used for the decoding analysis and image movement correction can be found in <ext-link ext-link-type="uri" xlink:href="https://github.com/leelabcnbc/sparse-coding-elife2018">https://github.com/leelabcnbc/sparse-coding-elife2018</ext-link> (<xref ref-type="bibr" rid="bib21">Zhang et al., 2018</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/sparse-coding-elife2018">https://github.com/elifesciences-publications/sparse-coding-elife2018</ext-link>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to many colleagues for their insightful discussion and generous help on this paper, and in particular to Stephen L Macknik, Susana Martinez-Conde and Shefali Umrania for editing the manuscript. We thank Wenbiao Gan for the early provision of AAV-GCaMP5; and Peking University Laboratory Animal Center for excellent animal care. We acknowledge the Janelia Farm program for providing the GCaMP5-G construct, specifically Loren L Looger, Jasper Akerboom, Douglas S Kim, and the Genetically Encoded Calcium Indicator (GECI) project at Janelia Farm Research Campus Howard Hughes Medical Institute.</p></ack><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Data curation, Investigation</p></fn><fn fn-type="con" id="con4"><p>Methodology</p></fn><fn fn-type="con" id="con5"><p>Methodology</p></fn><fn fn-type="con" id="con6"><p>Methodology</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Data curation, Funding acquisition, Investigation, Writing—original draft, Writing—review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: Animal experimentation: All procedures involving animals were in accordance with the Guide of Institutional Animal Care and Use Committee (IACUC) of Peking University Animals, and approved by the Peking University Animal Care and Use Committee (LSC-TangSM-5). All surgrey was performed under general anesthesia and strictly sterile conditions, and every effort was made to minimize suffering.</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.33370.010</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-33370-transrepform-v2.docx"/></supplementary-material><sec id="s6" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files. Source data files have been provided for Figures 1, 2 and 3.</p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akerboom</surname> <given-names>J</given-names></name><name><surname>Chen</surname> <given-names>TW</given-names></name><name><surname>Wardill</surname> <given-names>TJ</given-names></name><name><surname>Tian</surname> <given-names>L</given-names></name><name><surname>Marvin</surname> <given-names>JS</given-names></name><name><surname>Mutlu</surname> <given-names>S</given-names></name><name><surname>Calderón</surname> <given-names>NC</given-names></name><name><surname>Esposti</surname> <given-names>F</given-names></name><name><surname>Borghuis</surname> <given-names>BG</given-names></name><name><surname>Sun</surname> <given-names>XR</given-names></name><name><surname>Gordus</surname> <given-names>A</given-names></name><name><surname>Orger</surname> <given-names>MB</given-names></name><name><surname>Portugues</surname> <given-names>R</given-names></name><name><surname>Engert</surname> <given-names>F</given-names></name><name><surname>Macklin</surname> <given-names>JJ</given-names></name><name><surname>Filosa</surname> <given-names>A</given-names></name><name><surname>Aggarwal</surname> <given-names>A</given-names></name><name><surname>Kerr</surname> <given-names>RA</given-names></name><name><surname>Takagi</surname> <given-names>R</given-names></name><name><surname>Kracun</surname> <given-names>S</given-names></name><name><surname>Shigetomi</surname> <given-names>E</given-names></name><name><surname>Khakh</surname> <given-names>BS</given-names></name><name><surname>Baier</surname> <given-names>H</given-names></name><name><surname>Lagnado</surname> <given-names>L</given-names></name><name><surname>Wang</surname> <given-names>SS</given-names></name><name><surname>Bargmann</surname> <given-names>CI</given-names></name><name><surname>Kimmel</surname> <given-names>BE</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name><name><surname>Kim</surname> <given-names>DS</given-names></name><name><surname>Schreiter</surname> <given-names>ER</given-names></name><name><surname>Looger</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimization of a GCaMP calcium indicator for neural activity imaging</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>13819</fpage><lpage>13840</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2601-12.2012</pub-id><pub-id pub-id-type="pmid">23035093</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barlow</surname> <given-names>HB</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>The Ferrier Lecture, 1980: critical limiting factors in the design of the eye and visual cortex</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>212</volume><fpage>1</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1098/rspb.1981.0022</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>TW</given-names></name><name><surname>Wardill</surname> <given-names>TJ</given-names></name><name><surname>Sun</surname> <given-names>Y</given-names></name><name><surname>Pulver</surname> <given-names>SR</given-names></name><name><surname>Renninger</surname> <given-names>SL</given-names></name><name><surname>Baohan</surname> <given-names>A</given-names></name><name><surname>Schreiter</surname> <given-names>ER</given-names></name><name><surname>Kerr</surname> <given-names>RA</given-names></name><name><surname>Orger</surname> <given-names>MB</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name><name><surname>Looger</surname> <given-names>LL</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name><name><surname>Kim</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Ultrasensitive fluorescent proteins for imaging neuronal activity</article-title><source>Nature</source><volume>499</volume><fpage>295</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1038/nature12354</pub-id><pub-id pub-id-type="pmid">23868258</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Denk</surname> <given-names>W</given-names></name><name><surname>Strickler</surname> <given-names>JH</given-names></name><name><surname>Webb</surname> <given-names>WW</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Two-photon laser scanning fluorescence microscopy</article-title><source>Science</source><volume>248</volume><fpage>73</fpage><lpage>76</lpage><pub-id pub-id-type="doi">10.1126/science.2321027</pub-id><pub-id pub-id-type="pmid">2321027</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Froudarakis</surname> <given-names>E</given-names></name><name><surname>Berens</surname> <given-names>P</given-names></name><name><surname>Ecker</surname> <given-names>AS</given-names></name><name><surname>Cotton</surname> <given-names>RJ</given-names></name><name><surname>Sinz</surname> <given-names>FH</given-names></name><name><surname>Yatsenko</surname> <given-names>D</given-names></name><name><surname>Saggau</surname> <given-names>P</given-names></name><name><surname>Bethge</surname> <given-names>M</given-names></name><name><surname>Tolias</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Population code in mouse V1 facilitates readout of natural scenes through increased sparseness</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>851</fpage><lpage>857</lpage><pub-id pub-id-type="doi">10.1038/nn.3707</pub-id><pub-id pub-id-type="pmid">24747577</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haider</surname> <given-names>B</given-names></name><name><surname>Krause</surname> <given-names>MR</given-names></name><name><surname>Duque</surname> <given-names>A</given-names></name><name><surname>Yu</surname> <given-names>Y</given-names></name><name><surname>Touryan</surname> <given-names>J</given-names></name><name><surname>Mazer</surname> <given-names>JA</given-names></name><name><surname>McCormick</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Synaptic and network mechanisms of sparse and reliable visual cortical activity during nonclassical receptive field stimulation</article-title><source>Neuron</source><volume>65</volume><fpage>107</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.12.005</pub-id><pub-id pub-id-type="pmid">20152117</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hegdé</surname> <given-names>J</given-names></name><name><surname>Van Essen</surname> <given-names>DC</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A comparative study of shape representation in macaque visual areas v2 and v4</article-title><source>Cerebral Cortex</source><volume>17</volume><fpage>1100</fpage><lpage>1116</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhl020</pub-id><pub-id pub-id-type="pmid">16785255</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hromádka</surname> <given-names>T</given-names></name><name><surname>Deweese</surname> <given-names>MR</given-names></name><name><surname>Zador</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Sparse representation of sounds in the unanesthetized auditory cortex</article-title><source>PLoS Biology</source><volume>6</volume><elocation-id>e16</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.0060016</pub-id><pub-id pub-id-type="pmid">18232737</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lennie</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The cost of cortical computation</article-title><source>Current Biology</source><volume>13</volume><fpage>493</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1016/S0960-9822(03)00135-0</pub-id><pub-id pub-id-type="pmid">12646132</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>M</given-names></name><name><surname>Liu</surname> <given-names>F</given-names></name><name><surname>Jiang</surname> <given-names>H</given-names></name><name><surname>Lee</surname> <given-names>TS</given-names></name><name><surname>Tang</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Long-Term Two-Photon Imaging in Awake Macaque Monkey</article-title><source>Neuron</source><volume>93</volume><fpage>1049</fpage><lpage>1057</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.01.027</pub-id><pub-id pub-id-type="pmid">28215557</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olshausen</surname> <given-names>BA</given-names></name><name><surname>Field</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Emergence of simple-cell receptive field properties by learning a sparse code for natural images</article-title><source>Nature</source><volume>381</volume><fpage>607</fpage><lpage>609</lpage><pub-id pub-id-type="doi">10.1038/381607a0</pub-id><pub-id pub-id-type="pmid">8637596</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Olshausen</surname> <given-names>BA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Highly overcomplete sparse coding</article-title><conf-name>Proceedings of SPIE</conf-name><elocation-id>86510S</elocation-id><pub-id pub-id-type="doi">10.1117/12.2013504</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quian Quiroga</surname> <given-names>R</given-names></name><name><surname>Panzeri</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Extracting information from neuronal populations: information theory and decoding approaches</article-title><source>Nature Reviews Neuroscience</source><volume>10</volume><fpage>173</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1038/nrn2578</pub-id><pub-id pub-id-type="pmid">19229240</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quiroga</surname> <given-names>RQ</given-names></name><name><surname>Reddy</surname> <given-names>L</given-names></name><name><surname>Kreiman</surname> <given-names>G</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>Fried</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Invariant visual representation by single neurons in the human brain</article-title><source>Nature</source><volume>435</volume><elocation-id>1102</elocation-id><lpage>1107</lpage><pub-id pub-id-type="doi">10.1038/nature03687</pub-id><pub-id pub-id-type="pmid">15973409</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rehn</surname> <given-names>M</given-names></name><name><surname>Sommer</surname> <given-names>FT</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A network that uses few active neurones to code visual input predicts the diverse shapes of cortical receptive fields</article-title><source>Journal of Computational Neuroscience</source><volume>22</volume><fpage>135</fpage><lpage>146</lpage><pub-id pub-id-type="doi">10.1007/s10827-006-0003-9</pub-id><pub-id pub-id-type="pmid">17053994</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rolls</surname> <given-names>ET</given-names></name><name><surname>Tovee</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Sparseness of the neuronal representation of stimuli in the primate temporal visual cortex</article-title><source>Journal of Neurophysiology</source><volume>73</volume><fpage>713</fpage><lpage>726</lpage><pub-id pub-id-type="doi">10.1152/jn.1995.73.2.713</pub-id><pub-id pub-id-type="pmid">7760130</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rust</surname> <given-names>NC</given-names></name><name><surname>DiCarlo</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Balanced increases in selectivity and tolerance produce constant sparseness along the ventral visual stream</article-title><source>Journal of Neuroscience</source><volume>32</volume><fpage>10170</fpage><lpage>10182</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6125-11.2012</pub-id><pub-id pub-id-type="pmid">22836252</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>S</given-names></name><name><surname>Lee</surname> <given-names>TS</given-names></name><name><surname>Li</surname> <given-names>M</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Xu</surname> <given-names>Y</given-names></name><name><surname>Liu</surname> <given-names>F</given-names></name><name><surname>Teo</surname> <given-names>B</given-names></name><name><surname>Jiang</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Complex Pattern Selectivity in Macaque Primary Visual Cortex Revealed by Large-Scale Two-Photon Imaging</article-title><source>Current Biology</source><volume>28</volume><fpage>38</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.11.039</pub-id><pub-id pub-id-type="pmid">29249660</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vinje</surname> <given-names>WE</given-names></name><name><surname>Gallant</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Sparse coding and decorrelation in primary visual cortex during natural vision</article-title><source>Science</source><volume>287</volume><fpage>1273</fpage><lpage>1276</lpage><pub-id pub-id-type="doi">10.1126/science.287.5456.1273</pub-id><pub-id pub-id-type="pmid">10678835</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Willmore</surname> <given-names>BD</given-names></name><name><surname>Mazer</surname> <given-names>JA</given-names></name><name><surname>Gallant</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Sparse coding in striate and extrastriate visual cortex</article-title><source>Journal of Neurophysiology</source><volume>105</volume><fpage>2907</fpage><lpage>2919</lpage><pub-id pub-id-type="doi">10.1152/jn.00594.2010</pub-id><pub-id pub-id-type="pmid">21471391</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Tang</surname> <given-names>S</given-names></name><name><surname>Li</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>sparse-coding-elife2018</data-title><version designator="33b196c">33b196c</version><ext-link ext-link-type="uri" xlink:href="https://github.com/leelabcnbc/sparse-coding-elife2018">https://github.com/leelabcnbc/sparse-coding-elife2018</ext-link></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.33370.014</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Salinas</surname><given-names>Emilio</given-names></name><role>Reviewing Editor</role><aff id="aff7"><institution>Wake Forest School of Medicine</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Large-scale two-photon imaging revealed super-sparse population codes in V1 superficial layer of awake monkeys&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and David Van Essen as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Anna Wang (Reviewer #2); Stanley Klein (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>In this study, Tang and colleagues use two-photon calcium imaging in awake monkeys to investigate the sparseness of responses in V1. All reviewers were enthusiastic about the manuscript, noting that it was technically novel and conceptually important for delineating how V1 encodes the visual world. For instance, 5 important advances were pointed out: (1) No previous study has provided a direct data-based quantitative measure of sparseness in terms of number of cells in the population (&lt;0.5%). This finding demonstrates that very few cells, for a large number of stimulus types (from simple to complex), are needed to encode each stimulus. This is a conclusion that, due to limitations of sampling, could not be arrived at by existing single unit neurophysiology approaches. (2) The study presents a large number of different stimuli, both simple and complex, to a large dense population of single cells, all observed simultaneously in monkey cortex. This is an innovative way to track how all cells within a single locus of cortex respond under a large number of different conditions. (3) This study invites reconsideration of V1 as an area that encodes simple features of visual stimuli. (4) This study opens up new ideas about what a hypercolumn is. (5) Technically, this is a high quality, tour-de-force study of monkey visual cortex that few in the world can achieve.</p><p>The reviewers also pointed out several areas where the manuscript requires improvement, most notably (1) discussing the possibility that GCaMP is missing lower firing rate neurons; (2) improving the clarity and justification of the analysis methods, as well as possible alternate interpretations of current findings; (3) improving the discussion of why these findings are novel, and what are the implications for the role of V1 in visual processing, as well as for the meaning of a hypercolumn; and (5) making the figures more clear. Specific comments and suggestions follow.</p><p>Essential revisions:</p><p>1) Concerns about GCaMP5.</p><p>1a) The authors point to the linearity of GCaMP5 as an advantage of the current study. While this is correct for large enough firing rates, it fails to mention the significant iceberg effect of GCaMP5, which is clearly demonstrated in the authors previous work (only spike rates larger than 10Hz evoke detectable fluorescence changes). In the current paper, the iceberg effect is only acknowledged in passing in the Materials and methods section. This iceberg effect is a serious issue for the current study. This paper reports average firing rates between 15 and 30 Hz, which would suggest that a detection threshold of 10Hz for the calcium imaging indeed will result in an overestimation of sparseness by failing to detect weaker responses. Most of the chronic calcium indicators currently available (including GCaMP6) have this problem, so there is currently no suitable alternative. However, the shortcomings of the chosen indicator, and the resulting potential for overestimating sparseness, should be addressed much more clearly than is currently the case. In its current form the paper is misleading, because it does not acknowledge the confounds of the GCaMP nonlinearities on the sparseness measurements.</p><p>1b) One fix for this problem could be to include actual measurements of spike rates for a population of V1 neurons. While those data would suffer from sampling biases not present in the two-photon data, they would still be the strongest possible complement to this data set. Without spike data, it is basically impossible to assess how much of a problem the iceberg effect could be.</p><p>1c) Perhaps a sensitivity analysis could be performed to test different assumptions about the response distributions below the Ca signal threshold. For instance, what happens if each &quot;non-responsive&quot; neuron is assigned a random response between 0 and 10 spikes/s? How would the sparseness results change in that case? That type of statistical analysis could be useful to estimate or provide bounds to the error in the sparseness measurement caused by the iceberg effect.</p><p>1d) The statement that the linearity of GCaMP5 makes the sensor more suitable than GCaMP6 (which potentially saturates at higher rates) is incorrect. Determining sparseness across a population requires a determination of how many neurons are 'on' during a particular stimulus presentation, not accurate measurements of tuning functions. The same holds for determining the life-time sparseness of a neuron, which also only requires a determination of how many stimuli drive a neuron over a baseline level, not the precise tuning function.</p><p>2) Concerns about statistical/analysis methods</p><p>2a) Sparseness measures. The authors use the half-height bandwidth as a measure for sparseness. This choice is rather arbitrary and should be further justified. It would seem more plausible to count all stimuli that evoke responses that are significantly larger than the baseline. At a minimum, the authors should explore how their assessment of sparseness changes if the criterion threshold is changed (how many stimuli evoke responses that are 10%, 20% etc. of the maximum response). In general, any such measure is problematic because of the iceberg effect of GCaMP mentioned above. This also needs to be discussed more explicitly.</p><p>2b) Comparison to traditional sparseness measures. The authors assert that sparseness measures used previously (as the one by Rolls and Tovee) are not applicable here because they are sensitive to changes in baseline level. However, these previous studies used baseline subtracted firing rates to calculate sparseness. The sensitivity of the traditional measures to changes in baseline levels therefore requires further explanation.</p><p>2c) Decoding. The 2 analysis parts of the paper are somewhat disconnected. One emphasizes single cell selectivity, whereas the other emphasizes population sparseness. It might be useful to set up the idea that single cell selectivity does or does not predict population sparseness. It seems two concepts are correlated, but I could imagine that this need not be so.</p><p>The first part assesses sparseness by thresholding responses on a per neuron basis. The second part assesses decoding based on groups of neurons by thresholding the population. What happens to the decoding if the response matrix is computed with the thresholding of part 1 applied (i.e., setting all responses below the half maximum for a neuron to 0)?</p><p>Furthermore, the discussion of the decoding results should be improved. Currently, it seems to imply a rather arbitrary threshold of around 20% that is considered 'good decoding' (e.g., in the comparison of the decoding results from the top 0.5% – which are around 20-30%, and the decoding results from the bottom 0.5% – which are around 15%). Both are far from the chance level, so these statements need to be further justified.</p><p>Finally, the authors conclude that the comparison of decoding performance for top and bottom responses demonstrates that strong responses are both necessary and sufficient to transfer relevant information. This is incorrect. The sufficiency is indeed demonstrated (accepting the assertion that decoding performance above some threshold constitutes successful decoding). However, to demonstrate necessity, they would have to demonstrate that successful decoding always implies the occurrence of strong responses. This is not the same as demonstrating that weak responses do not allow 'successful' decoding.</p><p>2d) It would be interesting to compare the sparseness of responses evoked by natural images to that evoked by gratings (which in other studies have been shown to drive a large percentage of superficial V1 neurons). This would also allow a better assessment of how many neurons could potentially respond, further alleviating concerns about cell health or other properties of the imaging region (although this concern is largely addressed by the fact that most neurons respond to at least some of the images in the natural image set).</p><p>2e) A famous paper by Quiroga, Reddy, Kreiman, Koch and Fried (2005) illustrated extremely high sparsity in cells that responded to images of Jennifer Aniston and Halle Berry. I'm actually surprised that there was no mention in the present paper of that finding by Quiroga. Although a direct comparison may not be appropriate given the differences in areas, it may still be informative to ask whether the V1 cells have greater sparseness than the Jennifer Aniston cell.</p><p>Another reason for connecting to the Quiroga paper is that they also do ROC analyses, but their ROC curves look very different than those of the present paper (see point 5e below). The comparison may provide further evidence that the sparseness calculations, including the ROC calculations, were done properly.</p><p>3) Clarification of experimental methods employed.</p><p>3a) Cell count. The overall number of cells per imaging region is crucial for estimating sparseness. The ROI-definition procedure adopted by the authors appears reasonable and well justified. However, a few additional details would be useful:</p><p>- Additional images of identified cells so that the accuracy of the chosen approach can be assessed.</p><p>- How does the imaging region from monkey 2 look like?</p><p>- Which manual steps are involved in the procedure (presumably, somebody checks the identified ROIs)?</p><p>- Were all data collected on the same day? If not, how are data and cell counts combined across days? How many cells were stable across those days?</p><p>- How many of these cells are filled in versus have a ring-like label? This will help to assess how many of the included neurons are presumably healthy and should exhibit normal responses.</p><p>3b) Visual stimuli. Only the size of the stimuli are given. What are the other characteristics of the natural image set? Are they in color? Are they isoluminant with the background? What spatial frequencies and colors do they span? How different is their content? Are they part of one of the standard sets of natural images used in other studies?</p><p>The claim that single neurons respond to similar features of stimuli is not well supported and premature [“neuron 653 of monkey A was most excited when its receptive field (0.8o in diameter) covered the lower rim of the cat's 1 eye'. 'neuron 949 of Monkey A was found to be selective to an opposite curvature embedded in its preferred natural stimulus set”].</p><p>4) Points for further discussion/elaboration.</p><p>4a) The Discussion is focused on issues of sparseness. However, there are two issues that are also worth mentioning. First, this study thus provides a fresh view of what V1 is doing, one that shifts the emphasis from simple orientation selectivity to complex natural stimuli, and which gives novel perspective on how the brain encodes natural stimuli. And second, the results show that, within the span of a single hypercolumn, all stimuli presented could be largely decoded. This supports Hubel and Wiesel's original concept that a hypercolumn contains all the machinery to encode everything at a single point in space, except that the manner of encoding may be distinct from (or more complex than) the original concept of selection from amongst an array of systematically organized ocular dominance, orientation, and color columns.</p><p>4b) A very important item that should be made very clear is the last sentence of the Abstract where the authors correctly claim that this is the first paper that shows sparseness of neuronal population responses in V1 in primates. They need to point out that papers like Frouderakis et al. (2014) were in mice and papers like Quiroga, et al. (2005) were in humans but not in V1. The statement at the end of the tenth paragraph of the Results and Discussion needs to make that clear. It is such an important point that it needs to be pointed out in the Introduction and the Conclusion. Other researchers would then become aware of the power of two-photon imaging.</p><p>5) Clarification of data/analyses in the figures.</p><p>5a) I find Figure 1F and G vs. L and M description very confusing. I think this is the interpretation: For population sparseness, one expects the distribution to show that for most images only few cells respond. For single cell selectivity, one expects each cell to respond to only a few images. Somehow the description of these graphs seems garbled. [E.g. then for each picture only 0.5% of cells responded means: in Monkey A, for 250 pictures 1 cell responded; for ~200 pictures 6 cells responded; for 5 pictures 20 cells responded. Alternative interpretation of graph: 1 cell responded to 250 pictures; 6 cells responded to ~200 pictures; 20 cells responded to 5 pictures? I would not use 'half-height bandwidths'. Use 'number of cells'. Why is stimulus specificity called 'life-time sparseness'? F-G, L-M should be described better to distinguish what each is saying (single cell selectivity vs. population sparseness/redundancy). Maybe partly it is the terminology that is used.]</p><p>5b) Figure 1: Why are there points below zero in D and E?</p><p>5c) Figure 1: 'Cells 653 and 949 are colored red respectively.' Don't see this.</p><p>5d) Figure 2: 0.5% contributes 50% of information and 5% contributes to 80% of information, what are remaining cells doing?</p><p>5e) Figure 1—figure supplement 2: Item C shows ROC curves for 99 shuffled trials. The part that wasn't at all clear to me was why did you compare the results to a shuffled version of the results. And why did the shuffled data have such a high hit rate at zero false alarms. I would have thought that the shuffling would greatly reduce the hit rate. That is quite different from Quiroga's (2005) paper, which shows more normal curves with the false positive rate close to zero. If the authors are unable to use the Quiroga method then they should explain why, and why they end up with the very unusual shape for the ROC curves.</p><p>5f) Perhaps it would be helpful to the reader to have Figure 1 broken up into multiple figures. By doing that the figures would be larger with details more visible. One improvement that would be helpful for Figures1D, E would be to have the x-axis be a log axis so that the cell rank of the first 20 or so neurons would be more visible. I believe this is the plot that best demonstrates sparseness so it needs to be very clear.</p><p>I would suggest also spending substantially more effort clarifying F and F0 on which panels D and E are based. Another question is what is the role of noise for the one second intervals where the stimulus is shown? There is expected to be more noise in that interval than in the interval without the stimulus. How is that noise estimated?</p><p>5g) In connection with Figure 1—figure supplement 2 it would be useful to show A and B as histograms in addition to the way they are presently shown.</p><p>5h) I suspect Figure 2 is an important figure. However it wasn't at all clear to me how it was calculated. I did figure out that the small inset was a continuation of the large plot that stopped at 10%. I wonder of the inset could be removed if log axes were used for the x-axis and the data would go from say 0.1% to 100%. But more important is to clarify how the red and blue data were calculated.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.33370.015</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Concerns about GCaMP5.</p><p>1a) The authors point to the linearity of GCaMP5 as an advantage of the current study. While this is correct for large enough firing rates, it fails to mention the significant iceberg effect of GCaMP5, which is clearly demonstrated in the authors previous work (only spike rates larger than 10Hz evoke detectable fluorescence changes). In the current paper, the iceberg effect is only acknowledged in passing in the Materials and methods section. This iceberg effect is a serious issue for the current study. This paper reports average firing rates between 15 and 30 Hz, which would suggest that a detection threshold of 10Hz for the calcium imaging indeed will result in an overestimation of sparseness by failing to detect weaker responses. Most of the chronic calcium indicators currently available (including GCaMP6) have this problem, so there is currently no suitable alternative. However, the shortcomings of the chosen indicator, and the resulting potential for overestimating sparseness, should be addressed much more clearly than is currently the case. In its current form the paper is misleading, because it does not acknowledge the confounds of the GCaMP nonlinearities on the sparseness measurements.</p></disp-quote><p>The concerns about iceberg effect may have arisen due to the fact that we may not have sufficiently clarified the definition of sparseness we used. There are in fact several different definitions of sparseness rather than one. We used a definition of sparseness that is based on quantifying the peakedness of neuronal response distribution, which is robust and less sensitive to low level activities. The iceberg effect is not a serious problem in the sparseness measure (based on this definition we used) in this study.</p><p>1) Willmore, Mazer and Gallant, 2011 discussed four definitions of sparseness commonly used in the field. One we found intuitive is as follows: “a sparse code (is defined) as one in which the population response distribution elicited by each stimulus is peaked (we will refer to this as “population sparseness”). A peaked distribution is one that contains many small (or 0) values and a small number of <italic>large</italic> values. Thus a neural code will have high population sparseness if only a small proportion of neurons are <italic>strongly active</italic> at any given time”.</p><p>2) The half-height width of the ranked response distributions is a simple measure of the peakedness. A small half-height width of the ranked response distributions indicates “only a small proportion of neurons are strongly active at any given time”, Thus a half-height width of the ranked response distributions has provided a standard and comparable measure of sparseness (Rust and DiCarlo, 2012).</p><p>3) There are several different definitions of sparseness (and corresponding sparseness measures) rather than one. Actually, there is no simple perfect measure of sparseness. The popular sparseness measure suggested by Rolls and Tovee could not tell precisely the peakedness of a neuronal response distribution because multiple response distribution profiles can give the same sparseness index. For example, consider the following two neurons, one neuron has tens of strong peak responses and hundreds of very low responses (i.e. fat head but thin tail in its ranked response distribution), while the other neuron has only a few strong responses and hundreds of medium low responses (thin head but fat tail in the distribution). These two neurons have quite different response distributions, but could have same Rolls and Tovee’s sparseness measure. That means, when one study reports a low sparseness based on Rolls and Tovee’s measure, we will have no way of knowing whether this low sparseness comes from the dense peak responses (the fat heads) or medium weak responses (the fat tails). Similar issue is also true for the population sparseness measure.</p><p>4) The sparseness definition suggested by the reviewers – “a determination of how many neurons are 'on' (over baseline)” – has problems too. It would have treated the peaked strong responses and distributed weak responses equally, and thus could not characterize the peakedness of the response distribution. Probably because of these defects, a simply “on” definition of sparseness, as suggested, is not popularly used in this field.</p><p>5) Balancing all considerations, in this study, we used a half-height width of the ranked response distributions (which is the percentage of neurons exceed their half peak responses – for population sparseness, and the percentage of stimuli that makes a neuron fire more than half of its peak response – for life-time sparsity) to quantify the peakedness of response distribution. This measure is robust and less sensitive to variations in low-level activities (including the noises and nonlinearity in low firing range in calcium imaging). To make this issue more explicit, we add a statement in the text that this sparsity measure is not just indicating the percentage of neurons exhibit any statistical significant responses (probably a large fraction of neurons will show some weak responses, and given enough trials, the responses can be deemed significant), but the percentage of neurons exhibit strong response (above half their max firing rates). Half-height is used to decide whether a response is “strong” or not for computing sparseness. The half-height bandwidth of ranked response distribution has been used as a sparseness measure in other studies (Rust and DiCarlos), and is not an arbitrary measure we developed.</p><p>6) As explained above, the sparseness measure based on the half-height width of the ranked response distributions (the peakedness measure) concerns mostly the strong responses (mountains) but not on the distributed weak responses (valleys) or mean firing rates. Notably, a highly selective neuron with very strong responses to some optimal stimuli (which may exceed 150 Hz) will likely have very low average firing rate (even under 10 Hz). We have found, as reported in our Neuron paper, the firing rates below 10 Hz (~0.1 in dF/F0) could not linearly measured by GCaMP5. Missing these low level responses would surely under-estimate how many neurons would turn on, as the reviewer rightly pointed out. But, given the mountains of strong responses is far above that sea-level of 0.1, its half-height is also way above the sea-level, and the iceberg effect is quite minimal for the half-height bandwidths sparseness measure used in this study (see also discussion below 1c).</p><disp-quote content-type="editor-comment"><p>1b) One fix for this problem could be to include actual measurements of spike rates for a population of V1 neurons. While those data would suffer from sampling biases not present in the two-photon data, they would still be the strongest possible complement to this data set. Without spike data, it is basically impossible to assess how much of a problem the iceberg effect could be.</p></disp-quote><p>It is true that obtaining a distribution of spiking rates of a population of V1 neurons to the 2,250 stimuli would be a good comparison. However, this is not a simple task. First, as the reviewers pointed out, it is really hard to densely sample neurons with microelectrodes without bias. Second, the neurons in that layer are densely packed which would make isolation and cell-sorting difficult. Third, chronic multi-electrode recording of a particular superficial layer might not be stable enough to obtain the equivalent data. Given these factors, whatever comparative studies would likely not be conclusive. Furthermore, given the findings of our Neuron paper, and with a better clarification of our sparseness measure and its rationales, we feel such comparison is not completely necessary, particularly in view of the fact that our sparseness measure has been chosen precisely to mitigate the iceberg or sea-level effect that the reviewers were worried about.</p><disp-quote content-type="editor-comment"><p>1c) Perhaps a sensitivity analysis could be performed to test different assumptions about the response distributions below the Ca signal threshold. For instance, what happens if each &quot;non-responsive&quot; neuron is assigned a random response between 0 and 10 spikes/s? How would the sparseness results change in that case? That type of statistical analysis could be useful to estimate or provide bounds to the error in the sparseness measurement caused by the iceberg effect.</p></disp-quote><p>We have performed this test according to reviewers’ suggestion. We assigned each non-responsive neuron (with dF/F0 &lt; 0, also tested with dF/F0 &lt; 0.1) with random responses from 0 to 0.1 dF/F0 (roughly corresponding to 0 to 10 spikes/s). Exactly as discussed above, we found that the iceberg effect on sparseness measure is very small. In most cases, the half-height widths of ranked responses barely changed. In monkey A, the measured sparseness slightly increased from 0.49% to 0.50%. In monkey B, the measured sparseness did not change at all (0.41%).</p><disp-quote content-type="editor-comment"><p>1d) The statement that the linearity of GCaMP5 makes the sensor more suitable than GCaMP6 (which potentially saturates at higher rates) is incorrect. Determining sparseness across a population requires a determination of how many neurons are 'on' during a particular stimulus presentation, not accurate measurements of tuning functions. The same holds for determining the life-time sparseness of a neuron, which also only requires a determination of how many stimuli drive a neuron over a baseline level, not the precise tuning function.</p></disp-quote><p>We disagreed with the reviewers on this point. The reviewers might have missed a crucial aspect in the definition of sparsity, which does depend on the shape of the tuning curves. As mentioned above, we used an original definition of sparseness: “a neural code will have high population sparseness if only a small proportion of neurons are strongly active at any given time”. This definition is also applicable to life-time sparseness as well. We have stated that our sparseness measure is the percentage of <italic>strong</italic> response, not simply just any significant response. We will make sure this point clearer in the main text.</p><p>The advantage of GCaMP5 is that it catches all the peaks in responses even though it misses some low-level activities (below 10 Hz). GCaMP6s is more sensitive and tends to saturate above 60-80 Hz, and flattening many strong peaks into plateau, reducing sparseness measure, although it can capture more weak responses in the low-firing rate regime. Thus GCaMP5, not GCaMP6, is more appropriate for this study. However, if one’s definition of sparseness is simply the percentage of neurons would be turned on (regardless strength), then GCaMP6 would be more appropriate. But as discussed above, such a definition, while seems intuitive to general audience, does not characterize the peakedness of the response distribution, which is a critical aspect of the preferred definition of sparseness in the field (see Willmore et al., 2011).</p><disp-quote content-type="editor-comment"><p>2) Concerns about statistical/analysis methods</p><p>2a) Sparseness measures. The authors use the half-height bandwidth as a measure for sparseness. This choice is rather arbitrary and should be further justified. It would seem more plausible to count all stimuli that evoke responses that are significantly larger than the baseline. At a minimum, the authors should explore how their assessment of sparseness changes if the criterion threshold is changed (how many stimuli evoke responses that are 10%, 20% etc. of the maximum response). In general, any such measure is problematic because of the iceberg effect of GCaMP mentioned above. This also needs to be discussed more explicitly.</p></disp-quote><p>As discussed above (1a), we did not “count all stimuli that evoke responses that are significantly larger than the baseline” or “a determination of how many neurons are 'on' (over baseline)”, as a definition of sparseness because measures based on such definition treat the peaked strong responses and distributed weak responses equally and could not characterize the peakedness of the response distribution, which is a critical aspect of the commonly used sparseness definitions sparseness in the field (see Willmore et al., 2011).</p><p>Denser sampling of the bandwidths of the ranked response curve at various response height thresholds (such as 75%, 50%, 25% and so on) might provide a more comprehensive profile of the responses distributions, as shown in <xref ref-type="fig" rid="respfig1">Author response image 1</xref>. However, a half-height width of the ranked response distributions is commonly used for counting strong responses and quantifying the peakedness. A very low height threshold will not work in quantifying the peakedness. The sparseness measure based on the peakedness analysis is not sensitive to low level iceberg effect (see also the response in (1c)).</p><fig id="respfig1"><object-id pub-id-type="doi">10.7554/eLife.33370.012</object-id><label>Author response image 1.</label><caption><title>The proportions of stimuli those evoked strong responses above varying thresholds.</title></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-33370-resp-fig1-v2"/></fig><disp-quote content-type="editor-comment"><p>2b) Comparison to traditional sparseness measures. The authors assert that sparseness measures used previously (as the one by Rolls and Tovee) are not applicable here because they are sensitive to changes in baseline level. However, these previous studies used baseline subtracted firing rates to calculate sparseness. The sensitivity of the traditional measures to changes in baseline levels therefore requires further explanation.</p></disp-quote><p>Precisely, Rolls and Tovee’s measure requires the subtraction of a baseline. However, determination of a baseline precisely is difficult for Ca imaging signals. As we tested thousands of stimuli, a slight variation in our baseline estimate will yield a large variation in the estimate sparseness value, because of most of the responses are very weak, and there is the danger of iceberg effect, hence, we chose a measure that does not require a precise estimation of baseline and is more robust against the known insensitivity against signals below 10 Hz, as discussed above. We will make further clarification in the Materials and methods section.</p><disp-quote content-type="editor-comment"><p>2c) Decoding. The 2 analysis parts of the paper are somewhat disconnected. One emphasizes single cell selectivity, whereas the other emphasizes population sparseness. It might be useful to set up the idea that single cell selectivity does or does not predict population sparseness. It seems two concepts are correlated, but I could imagine that this need not be so.</p></disp-quote><p>Actually, the first analysis part includes both population sparseness (Figure 1) and stimulus selectivity (life-time sparseness) (Figure 2). A paper from Willmore, Mazer and Gallant, 2011 discussed the correlation between lifetime sparseness and population sparseness carefully. Simply, when the responses are distributed (like those in this study), these two sparseness measures will be quite close. The second part is about decoding. The main motivation for the decoding analysis is to examine the amount of information that is contained in the strong sparse responses.</p><disp-quote content-type="editor-comment"><p>The first part assesses sparseness by thresholding responses on a per neuron basis. The second part assesses decoding based on groups of neurons by thresholding the population. What happens to the decoding if the response matrix is computed with the thresholding of part 1 applied (i.e., setting all responses below the half maximum for a neuron to 0)?</p></disp-quote><p>This is a correct observation. We agreed that there is certain dissonance in using relative half-height threshold in charactering population sparseness in Part 1, and then using absolute threshold for doing decoding in Part 2. We have actually done both, but we feel that using absolute threshold makes it more clear that the strong response in the absolute sense is important, as there is no guarantee that a cell can necessarily attain its absolute peak responses among these 2,250 natural image set. While decoding with absolute response threshold makes more sense biologically, no one would accept absolute threshold for population sparseness estimate. In any case, we have now done both and the results are actually comparable. We now include the new result in (Figure 3—figure supplement 1) for comparison. Showing both is important because they make clear that the sparse strong responses are meaningful for decoding both in relative and in absolute sense. Absolute threshold might be even more important the relative threshold for the biological reasons we mentioned earlier: downstream neurons might mostly care about the strength of the strong and robust input signals, and might not remember the “peak response” of each of its sources.</p><disp-quote content-type="editor-comment"><p>Furthermore, the discussion of the decoding results should be improved. Currently, it seems to imply a rather arbitrary threshold of around 20% that is considered 'good decoding' (e.g., in the comparison of the decoding results from the top 0.5% – which are around 20-30%, and the decoding results from the bottom 0.5% – which are around 15%). Both are far from the chance level, so these statements need to be further justified.</p></disp-quote><p>Our intent was to show that the top 0.5% of the responses alone can achieve 50% of the achievable decoding performance (28%/54% for monkey A, 21%/38% for monkey B), and that removing the top 0.5% of the response drop the accuracy to less than 50% of the achievable performance (19/54 for monkey A and 10/38 for monkey B). We believe the reviewer might have misinterpreted the blue curve, at 0.5% (where it intersects with the gray line), the blue curve means the accuracy when the top 0.5% response is removed, <italic>not</italic> the accuracy when the bottom 0.5% response is used. These two curves are used to demonstrate “sufficiency” (red curve), and “necessity” (blue curve) of the top 0.5%.</p><disp-quote content-type="editor-comment"><p>Finally, the authors conclude that the comparison of decoding performance for top and bottom responses demonstrates that strong responses are both necessary and sufficient to transfer relevant information. This is incorrect. The sufficiency is indeed demonstrated (accepting the assertion that decoding performance above some threshold constitutes successful decoding). However, to demonstrate necessity, they would have to demonstrate that successful decoding always implies the occurrence of strong responses. This is not the same as demonstrating that weak responses do not allow 'successful' decoding.</p></disp-quote><p>This issue might arise from the reviewer’s misinterpretation of the blue curve (see above). The blue curve indicates that without the top 0.5% of the strong response, decoding performance drops below 50% of the achievable decoding accuracy. At some level, this demonstrates the “necessity” of the top 0.5% for achieving good decoding, because without them the rest 99.5% of the population responses can realize only (or slightly less than) 50% of the achievable performance. We hope that with a better clarification of the blue curve, we can resolve the confusion, and that the reviewer will see the “necessity” of the strong response. In fact, the bottom 90% of the responses alone perform extremely badly (close to chance – &lt;0.1%) (blue curve at 10% x-axis). On the other hand, in the presence of the strong response, the bottom 90% responses can contribute significantly, contributing over 20% of the achievable decoding performance (the red curve).</p><disp-quote content-type="editor-comment"><p>2d) It would be interesting to compare the sparseness of responses evoked by natural images to that evoked by gratings (which in other studies have been shown to drive a large percentage of superficial V1 neurons). This would also allow a better assessment of how many neurons could potentially respond, further alleviating concerns about cell health or other properties of the imaging region (although this concern is largely addressed by the fact that most neurons respond to at least some of the images in the natural image set).</p></disp-quote><p>Thanks for this suggestion. Actually, we have shown this result in our early paper (Neuron, 2017 and Current Biology, 2018). With a standard significance check (t-test or Anova), more than 90% cells did respond significantly to orientation gratings. But those responses were much weaker than the optimal strong responses elicited by natural images or complex shapes. That result could be logically and tightly connected with this study. But we are sorry that we could not add all those wonderful results into this paper anymore because of the limitation of publication policy.</p><disp-quote content-type="editor-comment"><p>2e) A famous paper by Quiroga, Reddy, Kreiman, Koch and Fried (2005) illustrated extremely high sparsity in cells that responded to images of Jennifer Aniston and Halle Berry. I'm actually surprised that there was no mention in the present paper of that finding by Quiroga. Although a direct comparison may not be appropriate given the differences in areas, it may still be informative to ask whether the V1 cells have greater sparseness than the Jennifer Aniston cell.</p></disp-quote><p>That is a very interesting point. In fact, we are aware of that paper, and cited the paper in the context of using similar ROC analysis to show that the sparse responses are not due to spurious chance occurrence. We also see the analogy as the reviewer, in the sense that both these MTC neurons and our V1 cells also exhibit similar high degree of stimulus specificity. But we feel it might be a bit too controversial to make a direct comparison. We now mention this potential connection in our Discussion/Conclusion paragraphs.</p><disp-quote content-type="editor-comment"><p>Another reason for connecting to the Quiroga paper is that they also do ROC analyses, but their ROC curves look very different than those of the present paper (see point 5e below). The comparison may provide further evidence that the sparseness calculations, including the ROC calculations, were done properly.</p></disp-quote><p>Please see the response in 5e below.</p><disp-quote content-type="editor-comment"><p>3) Clarification of experimental methods employed.</p><p>3a) Cell count. The overall number of cells per imaging region is crucial for estimating sparseness. The ROI-definition procedure adopted by the authors appears reasonable and well justified. However, a few additional details would be useful:</p><p>- Additional images of identified cells so that the accuracy of the chosen approach can be assessed.</p></disp-quote><p>We used the same algorithms to identify the neurons as reported in our previous work (Tang et al., 2017). All the cells with significant activities (over 3std) in differential images evoked by any stimuli could be identified automatically (ROIs). All the identified ROIs are shown in Figure 1C. We overlapped the ROIs to an image of the cells to show the ROIs extracted based on activities were well matched to cell bodies (Figure 1—figure supplement 3).</p><disp-quote content-type="editor-comment"><p>- How does the imaging region from monkey 2 look like?</p></disp-quote><p>We have added images from monkey 2 in new Figure 1—figure supplement 2.</p><disp-quote content-type="editor-comment"><p>- Which manual steps are involved in the procedure (presumably, somebody checks the identified ROIs)?</p></disp-quote><p>The ROI identification is automatic without manual operations.</p><disp-quote content-type="editor-comment"><p>- Were all data collected on the same day? If not, how are data and cell counts combined across days? How many cells were stable across those days?</p></disp-quote><p>Yes, all data were collected on the same day.</p><disp-quote content-type="editor-comment"><p>- How many of these cells are filled in versus have a ring-like label? This will help to assess how many of the included neurons are presumably healthy and should exhibit normal responses.</p></disp-quote><p>See Figure 1B, most of the cells (more the 95%) have ring-like label.</p><disp-quote content-type="editor-comment"><p>3b) Visual stimuli. Only the size of the stimuli are given. What are the other characteristics of the natural image set? Are they in color? Are they isoluminant with the background? What spatial frequencies and colors do they span? How different is their content? Are they part of one of the standard sets of natural images used in other studies?</p></disp-quote><p>Yes, they are in color (see the examples in Figure 1C, 1H and 1J). They are a large set of raw ‘natural images’. We did not modify them in color or contrast, as we tried to understand how the visual cortex works under natural conditions in this study. Those images are cropped from photos containing varying objects and scenes, with vary view distances, thus covered very large spatial frequencies and color ranges. Each stimulus is 4 x 4 degrees and hence 6-8 times larger than the receptive fields, which were placed at the center of the images.</p><disp-quote content-type="editor-comment"><p>The claim that single neurons respond to similar features of stimuli is not well supported and premature [“neuron 653 of monkey A was most excited when its receptive field (0.8o in diameter) covered the lower rim of the cat's 1 eye'. 'neuron 949 of Monkey A was found to be selective to an opposite curvature embedded in its preferred natural stimulus set”].</p></disp-quote><p>We have systematically investigated the pattern selectivity of V1 neurons in another study (monkey A of the two studies is actually the same, and many neurons overlap). We found most of the V1 superficial layer neurons exhibit high degree of selectivity to more complex and higher order patterns, such as corners, curvatures and radiating lines (Tang et al., 2018). Such selectivity could be the reason for the high degree of sparseness observed in this study. The two cells are just two typical examples for connecting the two studies. In the other study, each cell was tested with 9,500 patterns. The five patterns shown in Panel B and D of Figure 2 are just examples from the 9,500 tested patterns. More complete and detailed analysis of pattern selectivity of the neurons is presented in the other paper.</p><p>http://www.cell.com/current-biology/fulltext/S0960-9822(17)31521-X).</p><disp-quote content-type="editor-comment"><p>4) Points for further discussion/elaboration.</p><p>4a) The Discussion is focused on issues of sparseness. However, there are two issues that are also worth mentioning. First, this study thus provides a fresh view of what V1 is doing, one that shifts the emphasis from simple orientation selectivity to complex natural stimuli, and which gives novel perspective on how the brain encodes natural stimuli. And second, the results show that, within the span of a single hypercolumn, all stimuli presented could be largely decoded. This supports Hubel and Wiesel's original concept that a hypercolumn contains all the machinery to encode everything at a single point in space, except that the manner of encoding may be distinct from (or more complex than) the original concept of selection from amongst an array of systematically organized ocular dominance, orientation, and color columns.</p></disp-quote><p>Thanks for these suggestions! We have made the first point in our Current Biology paper (Tang, et al., 2018) with explicit evidence on the pattern selectivity of the neurons. Second point is an interesting suggestion. While we completely agree with the reviewers’ interpretation, we were afraid the evidence presented in this paper by itself is not sufficient to make this statement.</p><disp-quote content-type="editor-comment"><p>4b) A very important item that should be made very clear is the last sentence of the Abstract where the authors correctly claim that this is the first paper that shows sparseness of neuronal population responses in V1 in primates. They need to point out that papers like Frouderakis et al. (2014) were in mice and papers like Quiroga, et al. (2005) were in humans but not in V1. The statement at the end of the tenth paragraph of the Results and Discussion needs to make that clear. It is such an important point that it needs to be pointed out in the Introduction and the Conclusion. Other researchers would then become aware of the power of two-photon imaging.</p></disp-quote><p>Thanks for these suggestions! Actually, we already mentioned this in the Introduction. But now we added the following as the first sentence in the “Conclusion”:</p><p>“In conclusion, while earlier studies provided life-time sparseness measurements in rodents (Hromadka et al. 2008; Haider et al. 2010), non-human primates (Rolls and Tovee, 1995; Vinje and Gallant, 2000; rust and DiCarlo 2012) and human (Quiroga et al. 2005), and population sparseness measurement in rodents (Froudarakis et al. 2014), our study provided the first direct measurement of sparseness of large-scale neuronal population responses in awake macaque monkeys, made possible by large-scale two-photon imaging.”</p><disp-quote content-type="editor-comment"><p>5) Clarification of data/analyses in the figures.</p><p>5a) I find Figure 1F and G vs. L and M description very confusing. I think this is the interpretation: For population sparseness, one expects the distribution to show that for most images only few cells respond. For single cell selectivity, one expects each cell to respond to only a few images. Somehow the description of these graphs seems garbled. [E.g. then for each picture only 0.5% of cells responded means: in Monkey A, for 250 pictures 1 cell responded; for ~200 pictures 6 cells responded; for 5 pictures 20 cells responded. Alternative interpretation of graph: 1 cell responded to 250 pictures; 6 cells responded to ~200 pictures; 20 cells responded to 5 pictures?</p></disp-quote><p>The reviewer’s expectation is correct. “For population sparseness, one expects the distribution to show that for most images only few cells respond. For single cell selectivity, one expects each cell to respond to only a few images.” But the interpretation of the figure is wrong. We will try to make it clearer:</p><p>In such a frequency histogram graph, when there is a bar with height of 250 (Y-axis) at half-width of cells = 1 (x-axis), it means that there were 250 cases (pictures) with one picture activating only one cell strongly (among the 1225 cells in monkey A), i.e. 250 extremely sparse cases with only 1 cell responding to each picture.</p><p>We have also modified the captions of Figure 1G and G as follows: “(F and G) Frequency histograms showing the number of stimuli (out of 2250) (y-axis) that produce population responses with different population sparseness, measured in half-height bandwidth, i.e. the number of neurons activated strongly (x-axis). It shows that less than 0.5% of the cells (6 cells out of 1225 for monkey A, and 4.1 cells out of 982 for monkey B) responded above half of their peak responses for any given image on the average.”</p><disp-quote content-type="editor-comment"><p>I would not use 'half-height bandwidths'. Use 'number of cells'.</p></disp-quote><p>True. To minimize jargon, we changed half-height bandwidths to the percentage of the number of neurons or stimuli, which might be more explicit and easier to understand. We might still use half-height bandwidths at some places, because this is a standard expression in sparse code studies.</p><disp-quote content-type="editor-comment"><p>Why is stimulus specificity called 'life-time sparseness'? F-G, L-M should be described better to distinguish what each is saying (single cell selectivity vs. population sparseness/redundancy). Maybe partly it is the terminology that is used.]</p></disp-quote><p>Yes. We agree that life-time sparsity is a technical jargon in the field (Science 287: 1273- 1276, 2000; J Neurophysiol 105: 2907–2919, 2011). We equate it with stimulus specificity. However, the stimulus specificity might have the connotation that we know what stimulus feature the neuron is coding for. In sparse code study as those in Gallant’s or McCormick’s, the researchers often didn’t or couldn’t figure out the exact stimulus (which often include contextual surround) that give the neuron strong sparse response, hence they use the term life-time sparseness to indicate the neuron fire rarely to some specific stimulus, without claiming any knowledge of the neuron’s preferred stimulus.</p><disp-quote content-type="editor-comment"><p>5b) Figure 1: Why are there points below zero in D and E?</p></disp-quote><p>There are two possible reasons for the negative value in calcium imaging signal. First, some neurons may have spontaneous activities, and were depressed by some stimuli, which decreased the fluorescence signals (F &lt; F0). Second, measurement noises could also make some signals negative.</p><disp-quote content-type="editor-comment"><p>5c) Figure 1: 'Cells 653 and 949 are colored red respectively.' Don't see this.</p></disp-quote><p>Sorry about the error. We have deleted this sentence.</p><disp-quote content-type="editor-comment"><p>5d) Figure 2: 0.5% contributes 50% of information and 5% contributes to 80% of information, what are remaining cells doing?</p></disp-quote><p>The responses of 0.5%-5% of the cells contribute to encoding of a given image. The responses of another 0.5%-5% of the cells contribute to encoding another image. Every cell is useful, just for different stimuli. In a way, this is very similar to the case of Quiroga’s paper where one cell was coding Jennifer Aniston, while another cell coding the Halle Berry, and yet another cell coding Sydney opera house, and these three cells did not care about other objects or concepts.</p><disp-quote content-type="editor-comment"><p>5e) Figure 1—figure supplement 2: Item C shows ROC curves for 99 shuffled trials. The part that wasn't at all clear to me was why did you compare the results to a shuffled version of the results.</p></disp-quote><p>The logic is, if the strong responses (say &gt; half maximum for a neuron) in the raw data are random and spurious signals, then the curve of raw data will be comparable with those of shuffled version, and they will have similar ROC and AUC. On the other hand, if the strong responses for specific stimuli in raw data are reliable and repeatable across trials, the AUC will be significantly higher than those from shuffled data. The example shown in Figure 1—figure supplement 2, strongly against the hypothesis that the strong responses (three red data points in Figure 1—figure supplement 2A) came from random or spurious single trial epileptic responses.</p><disp-quote content-type="editor-comment"><p>And why did the shuffled data have such a high hit rate at zero false alarms. I would have thought that the shuffling would greatly reduce the hit rate. That is quite different from Quiroga's (2005) paper, which shows more normal curves with the false positive rate close to zero. If the authors are unable to use the Quiroga method then they should explain why, and why they end up with the very unusual shape for the ROC curves.</p></disp-quote><p>Yes, there are some key differences between Quiroga’s ROC analysis and ours. In Quiroga’s case, images from a certain individual or object formed the positive class, and images from others formed the negative; in our case, images with high enough (higher than half-maximum) mean responses form the positive class, and images with lower mean responses form the negative.</p><p>In Quiroga’s case, the set of positive images was <italic>fixed</italic> across all shuffles, and the authors tested whether the classification performance of a neuron for this <italic>fixed</italic> set of images against other images was by chance or not; in our case, the set of positive images <italic>varied</italic> across all shuffles, and we tested whether the classification performance of a neuron for high-<italic>mean</italic>-response images against others using <italic>per-trial</italic> responses was by chance or not. We cannot use Quiroga’s method for assigning positive and negative classes because our stimuli do not come from shared individuals or objects; because we changed the set of positive images for each shuffle, the ROC curves are biased to have high hit rates. Regardless of all differences, our ROC analysis is still valid, showing that the strong responses were <italic>not</italic> spurious or epileptic; otherwise, the shuffle operation would not change the AUC much.</p><p>To illustrate the point, let us imagine the following simplest case. Suppose a cell responding strongly to only one particular stimulus among 2,250, in every repeat and there are two repeats. There is then only one strong peak in the mean stimulus-tuning curve. The ROC curve will starts at (0, 1), with AUC (area under the curve) = 1. The shuffled version of the two trials will have two peaks (weaker but still significantly stronger than the rest) in the mean tuning curve. In this case, the ROC curve will start at (0, 0.5) with AUC near 0.75, as the hit rate is only 0.5 before any false positive appearing. When there are three repeats with one repeatable strong peak, the mean tuning curve of the shuffled case will have three peaks, as in our case, then the ROC will start at (0, 0.33) with AUCs around 0.667. This is because, as described above, the positive set of images is re-defined for the shuffled case (indicated by the blue spikes in Figure 2—figure supplement 1A), whereas the original positive set is indicated by the red spikes in Figure 2—figure supplement 1. In the real situation, as in the example shown in Figure 2—figure supplement 1, there are very strong peaks but also peaks close to the 0.5 max, the shuffled trials might contain some additional peaks due to noises or other low responses, making the ROC curve starting at (0, 0.33 – 0.4 range) and the AUC = 0.68 on average. When we increase the number of repeats, the starting point for the ROC will move toward (0, 0). In Quiroga’s case, the set of positive images was fixed, hence the ROC curves of shuffled responses start at (0, 0). That is the reason for the difference. In any case, the AUC of repeatable responses (across trials) will have significant higher AUC than that from shuffled trials, whereas spurious responses (unrepeatable across trials) will have similar AUC to that of the shuffled trials.</p><disp-quote content-type="editor-comment"><p>5f) Perhaps it would be helpful to the reader to have Figure 1 broken up into multiple figures. By doing that the figures would be larger with details more visible. One improvement that would be helpful for Figures1D, E would be to have the x-axis be a log axis so that the cell rank of the first 20 or so neurons would be more visible. I believe this is the plot that best demonstrates sparseness so it needs to be very clear.</p></disp-quote><p>Thanks for this constructive suggestion! We have separated Figure 1 into two figures. As for the suggestion of using log X for the neuronal response distribution plots (Figure 1D and E), as shown here, whilst using the log X allows easier visualization of the data, we feel it is not commonly used in the field for tuning curve, and might confuse some readers. We prefer to use the linear scale in the main text as it better convey the dramatic sharpness of the tuning curves and simplify the comparisons across studies.</p><fig id="respfig2"><object-id pub-id-type="doi">10.7554/eLife.33370.013</object-id><label>Author response image 2.</label><caption><title>The distribution of neuronal population responses with log X-axis.</title></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-33370-resp-fig2-v2"/></fig><disp-quote content-type="editor-comment"><p>I would suggest also spending substantially more effort clarifying F and F0 on which panels D and E are based. Another question is what is the role of noise for the one second intervals where the stimulus is shown? There is expected to be more noise in that interval than in the interval without the stimulus. How is that noise estimated?</p></disp-quote><p>We used a standard definition of F0, F and dF in this field. For each ROI, the F0 is the average fluorescence intensity during interval without the stimulus and F is average fluorescence intensity during interval with the stimulus. Yes, as shown in Figure 1I and K, the noises or variability of the signals in the interval with stimulus are larger than those in the interval without stimulus. That is consistent with situations in traditional electrophysiological studies.</p><disp-quote content-type="editor-comment"><p>5g) In connection with Figure 1—figure supplement 2 it would be useful to show A and B as histograms in addition to the way they are presently shown.</p></disp-quote><p>We have added histograms for top 3 responses for Figure 1—figure supplement 2A and B.</p><disp-quote content-type="editor-comment"><p>5h) I suspect Figure 2 is an important figure. However it wasn't at all clear to me how it was calculated. I did figure out that the small inset was a continuation of the large plot that stopped at 10%. I wonder of the inset could be removed if log axes were used for the x-axis and the data would go from say 0.1% to 100%. But more important is to clarify how the red and blue data were calculated.</p></disp-quote><p>We thank the reviewer for the advice. We have now improved the description in the main text. We thought about putting back the insets into the larger figures by using log axes; however, it was easier said than done as we found that to be messier overall.</p></body></sub-article></article>