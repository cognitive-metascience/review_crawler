<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">48494</article-id><article-id pub-id-type="doi">10.7554/eLife.48494</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Velocity coupling of grid cell modules enables stable embedding of a low dimensional variable in a high dimensional neural attractor</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-142978"><name><surname>Mosheiff</surname><given-names>Noga</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3649-4183</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-23501"><name><surname>Burak</surname><given-names>Yoram</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1198-8782</contrib-id><email>yoram.burak@elsc.huji.ac.il</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Racah Institute of Physics</institution><institution>Hebrew University</institution><addr-line><named-content content-type="city">Jerusalem</named-content></addr-line><country>Israel</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Edmond and Lily Safra Center for Brain Sciences</institution><institution>Hebrew University</institution><addr-line><named-content content-type="city">Jerusalem</named-content></addr-line><country>Israel</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Palmer</surname><given-names>Stephanie</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Senior Editor</role><aff><institution>University of Texas at Austin</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>30</day><month>08</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e48494</elocation-id><history><date date-type="received" iso-8601-date="2019-05-15"><day>15</day><month>05</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-08-29"><day>29</day><month>08</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Mosheiff and Burak</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Mosheiff and Burak</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-48494-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.48494.001</object-id><p>Grid cells in the medial entorhinal cortex (MEC) encode position using a distributed representation across multiple neural populations (modules), each possessing a distinct spatial scale. The modular structure of the representation confers the grid cell neural code with large capacity. Yet, the modularity poses significant challenges for the neural circuitry that maintains the representation, and updates it based on self motion. Small incompatible drifts in different modules, driven by noise, can rapidly lead to large, abrupt shifts in the represented position, resulting in catastrophic readout errors. Here, we propose a theoretical model of coupled modules. The coupling suppresses incompatible drifts, allowing for a stable embedding of a two-dimensional variable (position) in a higher dimensional neural attractor, while preserving the large capacity. We propose that coupling of this type may be implemented by recurrent synaptic connectivity within the MEC with a relatively simple and biologically plausible structure.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>neural networks</kwd><kwd>grid cells</kwd><kwd>entorhinal cortex</kwd><kwd>neural coding</kwd><kwd>neural attractors</kwd><kwd>short term memory</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Mouse</kwd><kwd>Rat</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003977</institution-id><institution>Israel Science Foundation</institution></institution-wrap></funding-source><award-id>1745/18</award-id><principal-award-recipient><name><surname>Burak</surname><given-names>Yoram</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003977</institution-id><institution>Israel Science Foundation</institution></institution-wrap></funding-source><award-id>1978/13</award-id><principal-award-recipient><name><surname>Burak</surname><given-names>Yoram</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000324</institution-id><institution>Gatsby Charitable Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Burak</surname><given-names>Yoram</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution>Dalia and Dan Maydan Fellowship</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Mosheiff</surname><given-names>Noga</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The neural representation of position in the medial entorhinal cortex may be stabilized by synaptic connectivity across modules, which enforces coherent updates in their states.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Much of the research on neural coding in the brain is focused on sensory representations, which are driven by external inputs that can be precisely controlled experimentally. In comparison, less is known about neural coding in deep brain structures, in which the dynamics reflect the outcome of internal computations. A notable exception is the hippocampal formation, where neural activity has been linked to high level cognitive variables such as an animal's estimate of its position within its environment (<xref ref-type="bibr" rid="bib43">O’Keefe and Nadel, 1978</xref>; <xref ref-type="bibr" rid="bib38">Moser et al., 2008</xref>; <xref ref-type="bibr" rid="bib56">Taube et al., 1990</xref>), or its estimate of elapsed time within a trial of a trained behavioral task (<xref ref-type="bibr" rid="bib34">Manns et al., 2007</xref>; <xref ref-type="bibr" rid="bib44">Pastalkova et al., 2008</xref>; <xref ref-type="bibr" rid="bib26">Itskov et al., 2011</xref>; <xref ref-type="bibr" rid="bib11">Eichenbaum, 2014</xref>).</p><p>Specifically, the representation of position by grid cells (<xref ref-type="bibr" rid="bib22">Hafting et al., 2005</xref>) in the medial entorhinal cortex (MEC) has led to new, unexpected insights on the neural coding of such quantities: even though position is a low dimensional variable, it is jointly encoded by several distinct populations of cells (modules: <xref ref-type="bibr" rid="bib54">Stensola et al., 2012</xref>), exhibiting periodic spatial responses with varying spatial scales. The spatial responses of all grid cells within a module are characterized by the same grid spacing and orientation, while differing from each other only by a rigid translation. The representation of position by each module is ambiguous, but taken together, the joint activity in several modules constitutes a highly efficient and unambiguous neural code (see <xref ref-type="bibr" rid="bib6">Burak, 2014</xref>). Due to its distributed organization, the grid cell code possesses a high dynamic range (ratio between the range of unambiguous representation and resolution; <xref ref-type="bibr" rid="bib6">Burak, 2014</xref>), greatly exceeding the performance of unimodal coding schemes such as the representation of position by place cells in the hippocampus (<xref ref-type="bibr" rid="bib12">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib53">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib36">Mathis et al., 2012b</xref>; <xref ref-type="bibr" rid="bib63">Wei et al., 2015</xref>; <xref ref-type="bibr" rid="bib39">Mosheiff et al., 2017</xref>).</p><p>Alongside the potential benefits arising from the combinatorial nature of the grid cell code, the distributed representation of position over several modules and spatial scales poses a mechanistic challenge to the underlying neural circuitry. The difficulty lies in the hypothesized role of the hippocampal formation, and specifically the MEC, in maintenance of short-term memory and idiothetic path integration, as opposed to pure representation. When grid cells update their activity, for example based on self motion, they must do so in a coordinated manner, in order for them to coherently represent a position in two-dimensional space, a variable of much lower dimensionality than the joint activity of all cells.</p><p>Neurons within a module maintain strict relationships in their joint activity (<xref ref-type="bibr" rid="bib66">Yoon et al., 2013</xref>). These relationships are maintained across environments (<xref ref-type="bibr" rid="bib15">Fyhn et al., 2007</xref>); under abrupt distortions of the environment (<xref ref-type="bibr" rid="bib3">Barry et al., 2007</xref>; <xref ref-type="bibr" rid="bib66">Yoon et al., 2013</xref>); in novel environments (<xref ref-type="bibr" rid="bib4">Barry et al., 2012</xref>; <xref ref-type="bibr" rid="bib66">Yoon et al., 2013</xref>), in which stable place fields are absent; during hippocampal inactivation (<xref ref-type="bibr" rid="bib2">Almog et al., 2019</xref>); under genetic perturbations that disrupt the spatial periodicity in the response of individual cells (<xref ref-type="bibr" rid="bib1">Allen et al., 2014</xref>); and in sleep (<xref ref-type="bibr" rid="bib58">Trettel et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Gardner et al., 2019</xref>). The rigidity of the correlation structure strongly suggests that the neural activity within a module is tightly coordinated by recurrent connectivity, consistent with attractor models of grid cell activity (<xref ref-type="bibr" rid="bib37">McNaughton et al., 2006</xref>; <xref ref-type="bibr" rid="bib14">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib21">Guanella et al., 2007</xref>; <xref ref-type="bibr" rid="bib7">Burak and Fiete, 2009</xref>), which propose that synaptic connectivity restricts the joint activity within a module to lie on a two-dimensional manifold. Additional support for attractor models has been recently obtained by imaging activity of multiple grid cells using calcium imaging in rats running on a virtual one-dimensional track (<xref ref-type="bibr" rid="bib24">Heys et al., 2014</xref>; <xref ref-type="bibr" rid="bib20">Gu et al., 2018</xref>). These studies revealed a relationship between position on the cortical sheet and the preferred firing locations of grid cells, as predicted by the variants of attractor models that rely on distance-dependent connectivity.</p><p>In contrast to the strong correlation in the activity of neurons within a module, much less is known about coupling of neurons that belong to different modules. A network of grid cells organized in <inline-formula><mml:math id="inf1"><mml:mi>m</mml:mi></mml:math></inline-formula> modules, each independently structured as a two-dimensional continuous attractor, possesses a <inline-formula><mml:math id="inf2"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> dimensional space of accessible steady states. Yet at any given time, continuous motion of the animal corresponds to a two-dimensional subspace of the possible local changes in the state of the <inline-formula><mml:math id="inf3"><mml:mi>m</mml:mi></mml:math></inline-formula> modules. Considering that noise may corrupt the representation of position in each module separately, the maintenance of a coherent representation of position across modules necessitates some form of coupling between them (<xref ref-type="bibr" rid="bib64">Welinder et al., 2008</xref>; <xref ref-type="bibr" rid="bib53">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib6">Burak, 2014</xref>). <xref ref-type="fig" rid="fig1">Figure 1A</xref> demonstrates the need for this coupling: incoherent drifts in the positions represented by different modules, accrued due to noise, can rapidly produce a joint representation of position that is incompatible with any position in the close vicinity of the animal (<xref ref-type="bibr" rid="bib12">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib64">Welinder et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib61">Vágó and Ujfalussy, 2018</xref>). The desired coupling across modules is more subtle than the one observed within a module: the coupling should restrict <italic>changes</italic> in the states of different modules to lie within the two-dimensional sub-space that corresponds to smooth movement of the animal within its local environment. However, to preserve the high dynamic range of the code, the coupling should not restrict the dimensionality of the accessible steady states.</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.48494.002</object-id><label>Figure 1.</label><caption><title>Velocity coupling: illu.</title><p>(<bold>A</bold>) Illustration of the detrimental consequences arising from uncoupled module drifts. Black dot: location of a static animal. Top panels: schematic representation of the decoded position from the neural activity in module 1 (left panel) and module 2 (middle panel) at time <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The shaded areas (cyan, purple) represent locations whose likelihood, given the neural activity, is high. Top right panel: overlay of the likelihood read out from module 1 and module 2. The maximal likelihood location, based on activity in both modules, coincides with the animal’s position. Bottom panels: decoded position based on the neural activity at time <inline-formula><mml:math id="inf5"><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>. Due to independent, noise-driven drifts in each module, activity in module 1 represents positions that are slightly shifted to the left (bottom left), and activity in module 2 represents position that are slightly shifted upward (middle). Even though the shifts are small, the joint activity in both modules (bottom right) now represents a new maximum likelihood location (yellow), far away from the true location (black). We refer to such events as catastrophic readout errors. (<bold>B</bold>) Representation of position along a one-dimensional axis (black line) by the rotation angles <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> of two meshing gears that rotate in a coordinated manner in response to motion. The angles <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, corresponding to each position, are shown along the blue and red lines. If the radii <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are incommensurate, a large range of positions can be unambiguously read out from the combination of the two angles. (<bold>C</bold>) An example of two phase coupled meshing gears that are fixed to each other, such that their angles <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf13"><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are always identical. Since <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, there is effectively only one encoded angle, and the range of unambiguous representation corresponds to a single rotation of the gears.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig1-v2.tif"/></fig><p>To further illustrate this point, it is instructive to consider an analogy of grid cell coding to the representation of a one-dimensional position by the rotation angles <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> of two meshing gears (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). We imagine that motion along the one-dimensional axis corresponds to coordinated rotation of the two gears (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, bottom). If the radii <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> of the two gears are incommensurate, a large distance is traversed before the two meshing gears come close to a previously visited state, thus allowing for a large range of positions to be unambiguously represented. However, it is crucial in this scheme that during continuous motion, the gears rotate in a coordinated manner: <inline-formula><mml:math id="inf19"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This relationship between the phase velocities <inline-formula><mml:math id="inf20"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf21"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> is enforced by the meshing cogs along the circumference of the two gears. In the absence of this mechanical constraint, small movement of one gear relative to the other can abruptly transport the represented position to a distant location, unrelated to the original position. Note that the absolute angles of the two meshing gears are not constrained: in fact, the large capacity of the representation relies on the fact that any combination of the two angles is accessible (compare panels B-C in <xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><p>Motivated by this analogy, we ask whether synaptic connectivity between grid cell modules can enforce a similar dynamic relationship between their states. Below, we identify a simple form of synaptic connectivity between grid cells that can implement this desired form of coupling. Next, we show that the recurrent connectivity confers the joint representation of position with resilience to two types of noise: First, noise in the velocity inputs projecting to different modules. These may differ in different modules, for example, due to synaptic noise. Second, noise arising from the stochastic dynamics of spiking neural activity within each module. The outcome is a continuous-attractor representation of position that achieves two goals: First, the representation is distributed across several modules with different spatial scales, allowing for combinatorial capacity by preserving the high dimensionality of the accessible steady states. Second, the neural circuitry that supports this representation is highly robust to noise when updating the representation based on self-motion, or while maintaining a persistent representation in short-term memory.</p><p>Alongside the recurrent connectivity, it is plausible that feedforward synaptic projections from the hippocampus to the entorhinal cortex play a role in shaping the grid cell response (<xref ref-type="bibr" rid="bib31">Kropff and Treves, 2008</xref>; <xref ref-type="bibr" rid="bib10">Dordek et al., 2016</xref>; <xref ref-type="bibr" rid="bib9">D'Albis and Kempter, 2017</xref>; <xref ref-type="bibr" rid="bib62">Weber and Sprekeler, 2018</xref>). Thus, hippocampal inputs may aid in coupling the states of different grid cell modules (<xref ref-type="bibr" rid="bib64">Welinder et al., 2008</xref>; <xref ref-type="bibr" rid="bib53">Sreenivasan and Fiete, 2011</xref>). In addition, sensory inputs that carry information about the animal’s position may contribute as well, through synaptic projections to the MEC from other cortical areas. However, there are situations in which these types of inputs to the MEC cannot ensure appropriate coordination between grid cells modules. First, under conditions in which sensory inputs are absent or weak, the brain must rely on idiothetic path integration in order to update its estimate of position. Second, in novel environments, and following global remapping in the hippocampus (<xref ref-type="bibr" rid="bib40">Muller and Kubie, 1987</xref>), it is highly unlikely that specific connections between place cells and grid cells, that couple the two spatial representations, are immediately established. Hence, coupling modules via hippocampal inputs would be ineffective in a novel environment. Thus, in this study, we focus on the ability of recurrent connectivity <italic>within</italic> the entorhinal cortex to maintain a coherent representation of position across grid-cell modules.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Theoretical framework</title><p>In laying out the principles underlying our proposed synaptic connectivity, we consider first a one dimensional analogue of the grid cell representation, inspired by the analogy to meshing gears discussed above: we imagine that an animal moves in one dimension, and neurons in each grid cell module <inline-formula><mml:math id="inf22"><mml:mi>μ</mml:mi></mml:math></inline-formula> jointly represent the modulus of position relative to the grid spacing <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>λ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> (for simplicity, from here on, we define the phases <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> such that they are in the range <inline-formula><mml:math id="inf25"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>):<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo> <mml:mtext>mod </mml:mtext><mml:mo>⁢</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We hypothesize that the joint dynamics of all grid cells within a module are restricted to lie in a one dimensional attractor, which we model as a ring attractor (<xref ref-type="bibr" rid="bib5">Ben-Yishai et al., 1995</xref>; <xref ref-type="bibr" rid="bib67">Zhang, 1996</xref>). More specifically, we consider the double-ring architecture (<xref ref-type="bibr" rid="bib65">Xie et al., 2002</xref>), which includes a mechanism for updates based on velocity inputs, and was proposed as a model for integration of angular velocity inputs by head direction cells in rodents. Recent discoveries in the <italic>Drosophila melanogaster</italic> central complex point to a representation of heading that is maintained by neural circuitry with close similarity to this architecture (<xref ref-type="bibr" rid="bib49">Seelig and Jayaraman, 2015</xref>; <xref ref-type="bibr" rid="bib59">Turner-Evans et al., 2017</xref>; <xref ref-type="bibr" rid="bib30">Kim et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Green et al., 2017</xref>). Attractor models of grid cells in the entorhinal cortex (<xref ref-type="bibr" rid="bib14">Fuhs and Touretzky, 2006</xref>; <xref ref-type="bibr" rid="bib7">Burak and Fiete, 2009</xref>) generalize the double-ring attractor model to motion in two dimensions.</p><p>Within the double-ring attractor model (<xref ref-type="bibr" rid="bib65">Xie et al., 2002</xref>), a module consists of two recurrently connected neural sub-populations, each comprising <inline-formula><mml:math id="inf26"><mml:mi>N</mml:mi></mml:math></inline-formula> neurons organized on a ring (left ring and right ring, <xref ref-type="fig" rid="fig2">Figure 2A</xref>). We denote by<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow></mml:math></disp-formula></p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.48494.003</object-id><label>Figure 2.</label><caption><title>Model architecture.</title><p>(<bold>A</bold>) Structure of a single module, consisting of a left ring (red) and a right ring (blue), in accordance with the double ring model (<xref ref-type="bibr" rid="bib65">Xie et al., 2002</xref>). The two rings receive external inputs proportional to velocity, with opposite polarities (purple). Synaptic weights project slightly anti-clockwise (red) and slightly clockwise (blue) from neurons in the left and right sub-populations. (<bold>B</bold>) Illustration of the firing rates of the right (blue) and left (red) sub-population during velocity integration. Both activity bumps are centered around the same phase. The right population is receiving stronger feed-forward input than the the left population, due to a positive velocity signal (<inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> in (<bold>A</bold>) and <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). Since the outgoing synaptic weights of the right sub-population project clockwise, the activity bump of both populations moves to the right. (<bold>C</bold>) True phase <inline-formula><mml:math id="inf28"><mml:mi>θ</mml:mi></mml:math></inline-formula> as a function of time (black) in response to an external velocity input, representing a simulated trajectory, and an estimation of this phase from the velocity approximation <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> (magenta). Note that <inline-formula><mml:math id="inf30"><mml:mi>θ</mml:mi></mml:math></inline-formula> is periodic with period 1, but for presentation clarity we unwrap <inline-formula><mml:math id="inf31"><mml:mi>θ</mml:mi></mml:math></inline-formula> to depict a continuous path along the real axis. (<bold>D</bold>) The coupling of drifts in two modules is achieved by providing the velocity approximation <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> as a velocity input to module 2 (and vice versa, not shown). Each module is modelled as a double ring attractor, as in (<bold>A</bold>). (<bold>E</bold>) Two coupled modules. The velocity input of each module has three contributions: The external velocity input (purple), the coupling of velocity from the other module (green), and the self coupling (orange).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig2-v2.tif"/></fig><p>the vector of synaptic activations, where <inline-formula><mml:math id="inf33"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf34"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> represent the synaptic activation of the right and left sub-populations respectively. The synaptic activation <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of neuron <inline-formula><mml:math id="inf36"><mml:mi>i</mml:mi></mml:math></inline-formula> follows the dynamics:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf37"><mml:mi>τ</mml:mi></mml:math></inline-formula> is the synaptic time constant, <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the firing rate of neuron <inline-formula><mml:math id="inf39"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf40"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> is a nonlinear transfer function, <inline-formula><mml:math id="inf41"><mml:mi>W</mml:mi></mml:math></inline-formula> is the connectivity matrix (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref>; <xref ref-type="disp-formula" rid="equ9">Equation 9</xref>), <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is a constant input, and <inline-formula><mml:math id="inf43"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf44"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>) is the velocity input to a neuron in the right (left) sub-population. Synaptic weights projecting from neurons in each ring are shifted clockwise (right) or anti-clockwise (left). When both sub-populations receive identical feed-forward inputs, activity in the network settles on a stationary bump of activity. However, selective activation of the right (left) sub-population via the feed-forward inputs, induces clockwise (anti-clockwise) motion of the activity bump at a phase velocity proportional to the velocity input <inline-formula><mml:math id="inf45"><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Hence, in a noise-free network, the position of the activity bump is an integral of the velocity input.</p><p>Our goal is to couple several such modules such that they will update their states in a coordinated manner in the presence of noisy inputs. It is essential to couple the modules based on their phase velocities <inline-formula><mml:math id="inf46"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> and not directly by their phases <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>, as we want to allow all phase combinations of the different modules to be possible steady states of the population neural dynamics. Our proposed coupling requires two ingredients: reading out the phase velocity of each module, and inducing corresponding phase velocities in the other modules. The double ring model already contains a mechanism for integration of velocity inputs, and therefore, our main challenge is in reading out the phases velocities.</p></sec><sec id="s2-2"><title>Simple neural readout of velocity</title><p>Our first goal is to read out the phase velocity of a single module in our system. It is possible to compute the phase velocity by projecting <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> on the eigenvector with zero eigenvalue of the dynamics (see Appendix 1 and <xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>). However, this projection cannot be evaluated linearly from the neural activity, since the projection coefficients depend on the location of the activity bump. Instead, we seek a simple estimate of the phase velocity that can be implemented in a neural circuit with relatively simple architecture in a biologically plausible manner.</p><p>Intuitively, in the described framework, most of the motion arises from the differences in activity between the right and left sub-populations <xref ref-type="fig" rid="fig2">Figure 2B</xref>. Therefore, this difference might be close to the phase velocity <inline-formula><mml:math id="inf48"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>. We find, indeed, that the difference between the synaptic activities of the right and left sub-populations,<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo rspace="4.2pt">(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>provides a good approximation for the phase velocity (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), where <inline-formula><mml:math id="inf49"><mml:mi>β</mml:mi></mml:math></inline-formula> is a proportionality factor. In Appendix 1 we show mathematically that <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>≈</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s2-3"><title>Coupling modules by synaptic connectivity</title><p>In order to couple the motion of different modules, we use the readout signal <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> of each module <inline-formula><mml:math id="inf52"><mml:mi>μ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) as a velocity input to all other modules (<xref ref-type="fig" rid="fig2">Figure 2D–E</xref>, green arrows). In addition, we include negative self coupling within each module using the same readout signal <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> (necessary, as shown below, in order to prevent instabilities that otherwise arise from the positive feedback generated by the inter-module couplings), <xref ref-type="fig" rid="fig2">Figure 2E</xref> (orange arrows).</p><p>Note that <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is a linear function of synaptic activities within the ring network, with coefficients that do not depend on the position of the activity bump. Thus, the coupling can be implemented by recurrent connectivity within the MEC, between modules and within a single module. The resulting synaptic connectivity between any two coupled modules is all-to-all in the sense that every neuron in one module is connected to every neuron in the other module, with synaptic weights whose magnitudes are uniform (see Materials and methods, <xref ref-type="disp-formula" rid="equ12">Equation 12</xref>). The sign of each synaptic weight depends only on the sub-population (left or right) of the pre- and post-synaptic neurons. This connectivity is completely symmetric to rotation in the two modules, thus preserving the ability to obtain a combinatorially large manifold of steady states in which activity bumps can be placed in any combination of positions.</p><p>To understand how the couplings influence the joint dynamics of the coupled modules, we analyze the response of a network, consisting of <inline-formula><mml:math id="inf55"><mml:mi>m</mml:mi></mml:math></inline-formula> coupled modules, to external velocity inputs, <inline-formula><mml:math id="inf56"><mml:mrow><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The position of the bump in each module can be represented by a phase <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>. We find that the dynamics of these phases are governed by the following set of coupled differential equations<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>∗</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf58"><mml:mi>C</mml:mi></mml:math></inline-formula> is an <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> matrix whose element <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the coupling strength from module <inline-formula><mml:math id="inf61"><mml:mi>ρ</mml:mi></mml:math></inline-formula> to module <inline-formula><mml:math id="inf62"><mml:mi>μ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>f</mml:mi><mml:mo>*</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the convolution of <inline-formula><mml:math id="inf64"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> with an exponential filter <inline-formula><mml:math id="inf65"><mml:mi>f</mml:mi></mml:math></inline-formula> with the synaptic time scale <inline-formula><mml:math id="inf66"><mml:mi>τ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ36">Equation 36</xref>), and <inline-formula><mml:math id="inf67"><mml:mi>α</mml:mi></mml:math></inline-formula> is a constant factor (see full derivation of <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> in Appendix 2). Thus, the phase of each module is updated in response to two signals: the external velocity input projecting into the module (first term in <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>), and the recent history of changes in the phases of the other modules, conveyed by the coupling signal (second term in <xref ref-type="disp-formula" rid="equ5">Equation 5</xref>).</p><p>Much of the system’s response to external velocity inputs can be understood by considering its dynamics under the assumption that the motion of the animal is sufficiently slow, such that the components of <inline-formula><mml:math id="inf68"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> vary slowly compared to the synaptic time constant. Under this assumption, we obtain from <xref ref-type="disp-formula" rid="equ5">Equation 5</xref><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mi>X</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>is the <italic>linear response tensor</italic>.</p><p>For simplicity, let us consider first only two coupled modules (each of them one dimensional), with identical self coupling strength <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> for both modules. The eigenvalues of <inline-formula><mml:math id="inf70"><mml:mi>X</mml:mi></mml:math></inline-formula>, denoted by <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3A–C</xref> and Appendix 2), indicate how strongly the coupled modules respond to velocity inputs that drive coordinated and relative motion, respectively. If <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> is small, the modules respond weakly to velocity inputs that attempt to update the phases in an uncoordinated manner. Thus, if <inline-formula><mml:math id="inf74"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> is much smaller than <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>, we expect the motion of the two modules to remain coordinated, even if the velocity inputs to the two modules differ.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.48494.004</object-id><label>Figure 3.</label><caption><title>Two coupled modules.</title><p>(<bold>A-B</bold>) Velocity response of the coupled system to velocity inputs that drive joint motion <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>. (<bold>A</bold>) or relative motion <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>(<bold>B</bold>) in two coupled modules, as a function of the coupling strengths. (<bold>C</bold>) <inline-formula><mml:math id="inf78"><mml:msub><mml:mi>X</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:math></inline-formula> is a function of one parameter that depends on the coupling strengths (<inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>). The magenta and black circles represent the parameters used in (<bold>F</bold>), and the corresponding value of <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>. (<bold>D</bold>) Simulated trajectory, whose derivative is injected as a velocity input only to module one in panels (<bold>E–F</bold>). (<bold>E</bold>) Response of two uncoupled modules (<inline-formula><mml:math id="inf82"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>): the position represented by module 1 tracks the velocity inputs, module 2 is unresponsive, and the updates in the two modules are not coordinated, as expected. (<bold>F</bold>) Same as (<bold>E</bold>) but the modules are coupled with coupling strengths: <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:mn>14.1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:mn>28.3</mml:mn></mml:mrow></mml:math></inline-formula>. The phases of both modules track the velocity inputs in a coordinated manner, with the desirable velocity ratio <inline-formula><mml:math id="inf86"><mml:mi>λ</mml:mi></mml:math></inline-formula>. The phase of module one is scaled by <inline-formula><mml:math id="inf87"><mml:mi>λ</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is shown) in order to simplify the comparison between modules.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig3-v2.tif"/></fig><p>We choose coupling parameters <inline-formula><mml:math id="inf89"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf90"><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> such that three requirements are fulfilled (see Appendix 2): First, the modules should respond significantly to inputs that drive coordinated motion (large <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3A,C</xref>). The response to such inputs should not be suppressed since the system must be able to update its state based on velocity inputs, to correctly represent the animal’s position in its environment. Second, the modules should respond very weakly to inputs that drive anti-correlated motion (small relative motion <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3B,C</xref>). The self negative coupling <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> enables us to achieve these two requirements while preserving stability (<xref ref-type="fig" rid="fig3">Figure 3A–C</xref> and Appendices 2-3). Our last requirement is the maintenance of a specific ratio between the module phase velocities, <inline-formula><mml:math id="inf95"><mml:mi>λ</mml:mi></mml:math></inline-formula>, that corresponds to the grid spacing ratio between successive modules (we set <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:math></inline-formula> for all modules; <xref ref-type="bibr" rid="bib54">Stensola et al., 2012</xref>).</p><p><xref ref-type="fig" rid="fig3">Figure 3E–F</xref> demonstrates the response of two modules to an external velocity input, representing an animal’s trajectory (shown in <xref ref-type="fig" rid="fig3">Figure 3D</xref>). The input is given only to module 1. In the the case of uncoupled modules (<inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), only module 1 follows the trajectory, as expected (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). In the case of coupled modules, both of the modules follow the trajectory quite accurately, with the desired phase velocity ratio <inline-formula><mml:math id="inf98"><mml:mi>λ</mml:mi></mml:math></inline-formula>. Hence, under these conditions, the two coupled modules shift in a coordinated manner, even if they receive incompatible velocity inputs. Next, we generalize these results to multiple modules, and to grid cells in two dimensions.</p></sec><sec id="s2-4"><title>Generalization to two dimensions and several modules</title><p>The coupling of modules, described so far, can be easily extended to grid cell responses in two dimensions. In accordance with grid cell responses in two-dimensional arenas, each module is structured as a two-dimensional attractor, whose state is determined by two periodic phases. Thus, the steady states of the attractor are arranged on a torus instead of a ring. To obtain this topology, we use a network architecture in which neurons are arranged on a parallelogram, corresponding to a unit cell of the hexagonal grid (in similarity to <xref ref-type="bibr" rid="bib21">Guanella et al., 2007</xref>). The synaptic connection between any two neurons depends on their distance on the parallelogram, defined using periodic boundary conditions (<xref ref-type="fig" rid="fig4">Figure 4A</xref> and Materials and methods). The position of the activity bump must be able to shift in response to a two-dimensional velocity input, in any direction in the plane. To implement this velocity response, each module contains four sub-populations (right, left, up, and down). The synaptic weights projecting from neurons in each sub-population are shifted in a corresponding direction within the neural population (<xref ref-type="bibr" rid="bib7">Burak and Fiete, 2009</xref>).</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.48494.005</object-id><label>Figure 4.</label><caption><title>Coupling of several modules in two dimensions.</title><p>(<bold>A</bold>) The neurons of each sub-population in the two dimensional case (right, left, up and down) are organized on a neuronal sheet in the shape of a parallelogram with periodic boundary conditions. (<bold>B</bold>) Simulated firing rate of a single grid cell from each module, as a function of position, evaluated during response of the network to a rat trajectory lasting 800 s (taken from <xref ref-type="bibr" rid="bib54">Stensola et al., 2012</xref>). (<bold>C</bold>) Measured rat trajectory over an interval of 20 s (<xref ref-type="bibr" rid="bib54">Stensola et al., 2012</xref>), whose derivative is injected as a velocity input to all modules in panels (<bold>D–E</bold>), with addition of uncorrelated noise in each module. (<bold>D</bold>) Response of three uncoupled modules. (<bold>E</bold>) Response of three coupled modules. The phases of the three modules approximately track the velocity inputs in both cases, but the coordination between phases of the three modules is more tight in (<bold>E</bold>). The phases of modules 1 and 2 are scaled by <inline-formula><mml:math id="inf99"><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf100"><mml:mi>λ</mml:mi></mml:math></inline-formula>, respectively, in order to simplify the comparison between modules (similar to <xref ref-type="fig" rid="fig3">Figure 3F</xref>). (<bold>F</bold>) Mean square displacement (MSD) between the scaled phases of any two modules over time. Responses of the three modules, as in (<bold>D–E</bold>), were simulated over a hundred realizations of noise. The mismatch between module trajectories in the coupled case (blue lines) is very small compare to the uncoupled case (red lines). The units of scaled phases are the same as in (<bold>D–E</bold>). The legend indicates which two module trajectories are compared. (<bold>G</bold>) Mean square error (MSE) of each module’s trajectory relative to the animal’s trajectory, computed from the same simulations presented in (<bold>F</bold>). To obtain each module’s trajectory in units of spatial location, the module’s phase was multiplied by its spacing. In the coupled case (blue), the slope of MSE is reduced by a factor of <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (the number of modules) compared to the uncoupled case (red), as the noise is averaged due to the coupling.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48494.006</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Disconnected module.</title><p>Three coupled modules as in <xref ref-type="fig" rid="fig4">Figure 4B,E</xref>, but module 1 is disconnected from the other modules, namely <inline-formula><mml:math id="inf102"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. All other parameters are identical to <xref ref-type="fig" rid="fig4">Figure 4B,E</xref>. (<bold>A</bold>) Firing rate of a single grid cell from each module. The spacing of all modules increases as expected (compare to <xref ref-type="fig" rid="fig4">Figure 4B</xref> and see <italic>Discussion</italic>). (<bold>B</bold>) Response of three modules. The scales of phases are not coordinated, thus the spacing ratios change as well. The velocity of phases in response to the same animal’s trajectory is much smaller (see scale of axes in panel B, in comparison to <xref ref-type="fig" rid="fig4">Figure 4E</xref>), which indicates larger spacings.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig4-figsupp1-v2.tif"/></fig></fig-group><p>In addition, we generalize our network to <inline-formula><mml:math id="inf103"><mml:mi>m</mml:mi></mml:math></inline-formula> grid cell modules. The coupling strengths <inline-formula><mml:math id="inf104"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> thus comprise <inline-formula><mml:math id="inf105"><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameters that we are free to adjust to fulfill a set of requirements, similar to those applied in the case <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Our most important goal is that the motion of all modules should be coordinated, even if the velocity inputs are not identical. To achieve this goal, we define a joint motion vector <inline-formula><mml:math id="inf107"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf108"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>ρ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the ratio of grid spacings of modules <inline-formula><mml:math id="inf109"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf110"><mml:mi>μ</mml:mi></mml:math></inline-formula>. We require that this vector is an eigenvector of the linear response tensor, and minimize the eigenvalues corresponding to all other eigenvectors. If we were able to obtain eigenvalues that precisely vanish, the response tensor would be a rank one matrix whose columns are all proportional to <inline-formula><mml:math id="inf111"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. Under this idealized outcome, any velocity input, regardless of its direction in the <inline-formula><mml:math id="inf112"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> dimensional input space would result in coordinated motion of the modules. However, the couplings <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that precisely achieve this goal diverge, in similarity to the two-module case (Appendix 2). Thus, we impose a constraint on the strength of the synaptic connections. Another constraint is that all eigenvalues of <inline-formula><mml:math id="inf114"><mml:mi>C</mml:mi></mml:math></inline-formula> must be smaller than unity. Otherwise, the system exhibits dynamic instability (Appendix 3). We optimize an appropriate target function under these constraints (Appendix 3).</p><p>For <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> the optimization results in the same solution of coupling parameters <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that we found previously. For <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, we find that there is considerable freedom in choosing combinations of <inline-formula><mml:math id="inf118"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that achieve satisfactory coupling (See Appendix 3). One principled way to reduce this freedom, is to require that there is connectivity only between successive modules. This choice is compatible with recent observations (<xref ref-type="bibr" rid="bib13">Fu et al., 2018</xref>) that excitatory synaptic connectivity within the MEC is relatively short ranged. In our numerical results, we use this assumption to constrain the structure of the connectivity matrix <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, but other choices that include broader connectivity between modules lead to similar coupling between the modules.</p><p>To demonstrate how our proposed coupling affects the response of the modules to velocity inputs, we simulate the described network in two dimensions, with and without coupling, and with three modules. The velocity input is a measured rat trajectory from <xref ref-type="bibr" rid="bib54">Stensola et al. (2012)</xref>, with the addition of white Gaussian noise, drawn independently in the three modules. In each module, we set the proportionality coefficient that tunes the modulation of activity by the velocity input (<inline-formula><mml:math id="inf120"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ21">Equation 21</xref>) to achieve the desired grid spacing, even in the absence of inter-module coupling. In the simulation, we assume that only velocity inputs are responsible for the update of the neural representation of position, thus mimicking a situation in which sensory cues, such as those arising from visual inputs and encounters with the walls (<xref ref-type="bibr" rid="bib23">Hardcastle et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Keinath et al., 2018</xref>), are absent. In a noise-free simulation, the single cell firing rates form a hexagonal grid pattern as a function of the animal’s location (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), as expected from the network structure, while the spacing ratio between modules is close to <inline-formula><mml:math id="inf121"><mml:mi>λ</mml:mi></mml:math></inline-formula>.</p><p>The trajectories of the 2d phases, in response to noisy velocity inputs, are shown, for each of the three modules, in <xref ref-type="fig" rid="fig4">Figure 4D</xref> (uncoupled modules) and <xref ref-type="fig" rid="fig4">Figure 4E</xref> (coupled modules). In both cases, the phases follow the animal’s trajectory (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) quite closely, but the phases are much more similar to each other, and to the original trajectory, in the coupled case. Since panels D-E show results only from a single simulation, we repeat the analysis for 100 realizations of the noise in the velocity inputs, to obtain statistical measures on the coupled vs. uncoupled dynamics. The coupling substantially reduces the mismatch accrued between the trajectories of the different modules, compared to the uncoupled case, <xref ref-type="fig" rid="fig4">Figure 4F</xref>. For comparison, <xref ref-type="fig" rid="fig4">Figure 4G</xref> shows the mismatch between module trajectories and the true trajectory. In the uncoupled case, all modules exhibit similar accumulation of error, which arises from their independent responses to the noise in the velocity inputs. In the coupled case, only the projection of the noise on the direction of joint motion contributes to the accumulation of errors, leading to a reduction by a factor of <inline-formula><mml:math id="inf122"><mml:mi>m</mml:mi></mml:math></inline-formula> (in our case 3) in the slope of the MSE curve.</p><p>The lack of deviations between the phase trajectories, seen in the coupled case (<xref ref-type="fig" rid="fig4">Figure 4E–F</xref>), is an essential difference between the dynamics of the coupled and uncoupled modules. As discussed in the <italic>Introduction</italic>, we expect this difference to strongly impact the stability of the grid cell code. In the following section, we substantiate this point.</p></sec><sec id="s2-5"><title>Consequences for spatial representation and readout</title><p>We next aim to validate our hypothesis that the coupling of modules stabilizes the grid cell code, and more specifically, prevents catastrophic errors that can be caused by uncoupled drift in the phases of different modules (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). We simulate the dynamics of our three module network with noisy velocity inputs based on a measured rat trajectory from <xref ref-type="bibr" rid="bib54">Stensola et al. (2012)</xref>, as in <xref ref-type="fig" rid="fig4">Figure 4</xref>. We then generate Poisson spikes from the instantaneous firing rates of the neurons, and read out the animal’s trajectory from the simulated spikes: we do so both for coupled modules (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) and for uncoupled modules (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). The readout is accomplished using a decoder that sums spikes from the recent history, with an exponentially decaying temporal kernel (see Materials and methods and <xref ref-type="bibr" rid="bib39">Mosheiff et al., 2017</xref>). In <xref ref-type="fig" rid="fig5">Figure 5</xref> the spikes are involved only in the readout process and not in the intrinsic dynamics of the neural network.</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.48494.007</object-id><label>Figure 5.</label><caption><title>Reilience of the spatial representation to noise in velocity inputs.</title><p>(<bold>A</bold>) Blue trace: measured rat trajectory over a 20 s interval (taken from <xref ref-type="bibr" rid="bib54">Stensola et al., 2012</xref>), used as a velocity input to three coupled modules. Red trace: readout of position, decoded from simulated Poisson spikes of the coupled system. The spikes are generated by a Poisson process from the instantaneous firing rates of all cells in the three modules (see Materials and methods). Top panel: the trajectory in the two-dimensional arena. Lower panels: <inline-formula><mml:math id="inf123"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf124"><mml:mi>y</mml:mi></mml:math></inline-formula> components of the trajectory as a function of time. The decoded position is continuous and similar to the input trajectory. (<bold>B</bold>) Same as (<bold>A</bold>), but in a network consisting of three uncoupled modules: all coupling strengths are set to zero. The decoded position is discontinuous in time, and often sharply deviates from the input trajectory. (<bold>C</bold>) Percentage of decoding success over time. We repeated the decoding of the animal’s trajectory, as in (<bold>A–B</bold>), over a hundred simulations with different realizations of the noise. A success at time <inline-formula><mml:math id="inf125"><mml:mi>t</mml:mi></mml:math></inline-formula> is defined as a trial that did not contain any discontinuity in the readout up to that time. The success percentage was computed by counting the number of trials without discontinuities at each time point. The coupled network maintains 100% success over time (blue), whereas the success percentage of the uncoupled network decreases significantly over time: many trials contain discontinuities after a few seconds, and almost all of them contain discontinuities after 20 s (red). (<bold>D</bold>) Mean square error (MSE) of the decoded trajectory, computed from the same simulations presented in (<bold>C</bold>), in the coupled (blue) and uncoupled (red) cases. Gray trace: MSE computed by random guessing of location. The vertical black dashed line in (<bold>C–D</bold>) represents the first time in which a discontinuity was observed in any of the trials of the uncoupled network. From this time point onward, the percentage of success of the uncoupled network descends, and the MSE sharply increases (note the logarithmic vertical scale).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48494.008</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Effect of the readout integration time scale.</title><p>Percentage of decoding success (<bold>A</bold>) and MSE (<bold>B</bold>) over time, in the coupled (blue) and uncoupled (red) networks, with varying time scales of temporal integration used in the decoding process. <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>. Effect of the number of modules and environment size. Percentage of decoding success (<bold>A,C,E,F,G</bold>) and MSE (<bold>B,D,H,I,J</bold>) as a function of time. (<bold>A-D</bold>) Varying number of modules (<inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf127"><mml:mn>4</mml:mn></mml:math></inline-formula>, or <inline-formula><mml:math id="inf128"><mml:mn>5</mml:mn></mml:math></inline-formula>), in the coupled (<bold>A–B</bold>) and uncoupled (<bold>C–D</bold>) networks. The coupling prevents the occurrence of readout discontinuities in all of these cases. Increase in the number of modules reduces the rate of these discontinuities even in the absence of coupling (<bold>C–D</bold>). (<bold>E-J</bold>) Decoding in arena of dimensions 2.5 × 2.5 m<sub>2</sub> (red), compared to the original arena (blue, 1.2 × 1.2 m<sub>2</sub>), without coupling and with different number of modules. The rate of readout discontinuities increases, and the MSE increases, in larger arenas.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.48494.009</object-id><label>Figure 5—figure supplement 2.</label><caption><title>Effect of the number of modules and environment size.</title><p>Percentage of decoding success (<bold>A,C,E,F,G</bold>) and MSE (<bold>B,D,H,I,J</bold>) as a function of time. (<bold>A-D</bold>) Varying number of modules (<inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf130"><mml:mn>4</mml:mn></mml:math></inline-formula>, or <inline-formula><mml:math id="inf131"><mml:mn>5</mml:mn></mml:math></inline-formula>), in the coupled (<bold>A–B</bold>) and uncoupled (<bold>C–D</bold>) networks. The coupling prevents the occurrence of readout discontinuities in all of these cases. Increase in the number of modules reduces the rate of these discontinuities even in the absence of coupling (<bold>C–D</bold>). (<bold>E-J</bold>) Decoding in arena of dimensions 2.5 × 2.5 m<sub>2</sub> (red), compared to the original arena (blue, 1.2 × 1.2 m<sub>2</sub>), without coupling and with different number of modules. The rate of readout discontinuities increases, and the MSE increases, in larger arenas.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig5-figsupp2-v2.tif"/></fig></fig-group><p>In the case of coupled modules the decoded trajectory is similar to the input (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), but due to the noise in the inputs, it gradually accrues an error relative to the true trajectory. Without coupling, the position read out from the network activity diverges sharply from the true trajectory (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). Moreover, the readout trajectory is often discontinuous in time, and thus cannot be a good approximation to any reasonable path of the animal. The discontinuity arises from uncorrelated drifts of the modules which, combined with the periodic nature of the grid pattern, cause catastrophic readout errors, much larger than the errors accrued in the phases of each module separately (<xref ref-type="fig" rid="fig1">Figure 1A</xref>).</p><p>In order to quantitatively substantiate the relationship between the large deviation of the decoded trajectory from the true trajectory and the occurrence of catastrophic readout errors, we repeat the decoding process a hundred times with and without coupling, for a 20s input trajectory. In all realizations with coupling, the readout is coordinated with the input trajectory (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, blue). In contrast, without coupling almost all realizations exhibit discontinuities within a time interval of 20s (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, red). The mean square error (MSE) of the decoder increases as a function of time in the coupled as well as the uncoupled systems (<xref ref-type="fig" rid="fig5">Figure 5D</xref>), as expected due to noise in the input (as the coupling and inputs are of velocity and not location, there is no correcting mechanism that can correct coordinated shifts in the phases of all the modules). However, a few seconds after the start of the simulation, the MSE grows sharply in the uncoupled system (dashed line in <xref ref-type="fig" rid="fig5">Figure 5D</xref>). The time at which this starts to happen coincides with the first appearance of discontinuities in the decoded position (compare <xref ref-type="fig" rid="fig5">Figure 5</xref> panels C and D). (Note that below this time the probability for occurrence of a readout discontinuity does not vanish, but can be inferred roughly to be small compared to 0.01 since we performed 100 simulations.) Thus, the dramatic reduction achieved by the coupling between modules arises primarily from the elimination of catastrophic readout errors. This conclusion is insensitive to the choice of the time scale of temporal integration used in the decoding process (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><p>Qualitatively similar conclusions, as demonstrated above, are obtained also when the number of modules <inline-formula><mml:math id="inf132"><mml:mi>m</mml:mi></mml:math></inline-formula> is increased (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). With larger <inline-formula><mml:math id="inf133"><mml:mi>m</mml:mi></mml:math></inline-formula>, the rate at which readout discontinuities occur in a given environment diminishes. Note, however, that additional modules enable unambiguous representation of larger environments (<xref ref-type="bibr" rid="bib12">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib35">Mathis et al., 2012a</xref>; <xref ref-type="bibr" rid="bib63">Wei et al., 2015</xref>; <xref ref-type="bibr" rid="bib61">Vágó and Ujfalussy, 2018</xref>), and that the rate of readout discontinuities increases with the size of the environment (red traces in <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2E–J</xref>).</p></sec><sec id="s2-6"><title>Intrinsic neural noise</title><p>Up to this point we presented a theory of several grid cell modules, coupled to each other by synaptic connectivity within the MEC, such that the coupling significantly suppresses incompatible drifts caused by noisy inputs to the system. Next, we wish to address another important source of noise, arising from the variability in the spiking of individual neurons within the grid cell network (<xref ref-type="bibr" rid="bib51">Softky and Koch, 1993</xref>; <xref ref-type="bibr" rid="bib50">Shadlen and Newsome, 1994</xref>; <xref ref-type="bibr" rid="bib7">Burak and Fiete, 2009</xref>). In similarity to noise in the inputs, stochasticity of the neurons participating in the attractor network drives errors that accumulate over time with diffusive dynamics (<xref ref-type="bibr" rid="bib7">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>). To model this process, we replace the firing rate of each neuron in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> by a Poisson spike train (see <xref ref-type="disp-formula" rid="equ22">Equation 22</xref>).</p><p>Since we designed our network to be resilient to noisy inputs, it is not obvious that the same architecture can also provide resilience to intrinsic noise. To address this question, we revisit first the simple case of two coupled modules in one dimension. In Appendix A.2 we show that the simple readout of velocity used to couple the modules (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), is a good approximation for the phase velocity driven by intrinsic neural noise, suggesting that the coupling introduced previously can help suppress uncoordinated drifts. To quantify the impact of coupling on coordination of the modules, we compute the diffusion tensor of their phases, using <xref ref-type="disp-formula" rid="equ25">Equation 25</xref> (the calculation is based on the theoretical framework laid out in <xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>; see specifically Eq. S24). In the uncoupled case, the diffusion tensor is isotropic as expected (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, blue line). When the modules are coupled, with the same coupling strengths as in <xref ref-type="fig" rid="fig3">Figure 3</xref>, the diffusion of the two modules is highly anisotropic (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). The first principal axis of the diffusion tensor (red ellipse in <xref ref-type="fig" rid="fig6">Figure 6A</xref>) closely matches the direction of coordinated motion (dashed line in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). The diffusion coefficient <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>D</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>, associated with motion in the orthogonal direction, is much smaller than the diffusion coefficient <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula>, associated with coordinated motion: <inline-formula><mml:math id="inf136"><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula> (compare Figures <xref ref-type="fig" rid="fig3">Figure 3C</xref> and <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Thus, the coupling strongly suppresses incompatible diffusion of the two modules.</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.48494.010</object-id><label>Figure 6.</label><caption><title>Reilience of the spatial representation to intrinsic neural stochasticity.</title><p>(<bold>A</bold>) Diffusion tensor of a Poisson spiking neural network, consisting of two modules in one dimension, computed using <xref ref-type="disp-formula" rid="equ25">Equation 25</xref>, and illustrated as an ellipse. Axes of the ellipse are aligned with the eigenvectors of the diffusion tensor, and the lengths of each axis represents the diffusion coefficient along the corresponding direction. Without coupling the diffusion tensor is isotropic (blue circle). When coupling the modules using the same coupling strengths as in <xref ref-type="fig" rid="fig3">Figure 3F</xref>, the diffusion tensor becomes highly anisotropic (red ellipse). The diffusion in this case is almost exclusively in the direction of the first principal component (major axis of the ellipse). This direction closely matches the direction of coordinated drift (<inline-formula><mml:math id="inf137"><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ55">Equation 55</xref>, dashed line). (<sc><bold>B-C</bold></sc>) same as <xref ref-type="fig" rid="fig5">Figure 5C–D</xref>, but for the internal noise case.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-fig6-v2.tif"/></fig><p>Next, we evaluate the consequences for representation and readout, arising from the suppression of incompatible diffusion arising from intrinsic neural noise. We repeat the simulation of three coupled modules in two dimensions, this time with stochastic (Poisson) neurons. Discontinuities in the decoded trajectory occur both in the uncoupled and coupled networks, but they are much more rare in the coupled network (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Accordingly, the readout MSE is reduced dramatically in the coupled network (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, note the logarithmic scale). Thus, the coupling is effective not only in stabilizing the neural representation in response to noisy inputs, but also with respect to internal stochasticity within the grid cell network.</p><p>In principle, one could seek coupling parameters such that diffusion would be suppressed in all directions. However, recall our first requirement from the section <italic>Coupling modules by synaptic connectivity</italic>, that the network must respond with sufficient gain to external inputs, to follow an animal’s trajectory. As we keep the joint response strong, we cannot reduce the joint diffusion simultaneously, and we are satisfied with coupling of the diffusive drift, without eliminating coordinated diffusion.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Previous works (<xref ref-type="bibr" rid="bib12">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib36">Mathis et al., 2012b</xref>; <xref ref-type="bibr" rid="bib63">Wei et al., 2015</xref>; <xref ref-type="bibr" rid="bib39">Mosheiff et al., 2017</xref>) have shown that grid cell activity, viewed as a neural code for position, achieves a high dynamic range due to the splitting of the representation across multiple modules. In this work, we addressed a key difficulty with this idea: the combinatorial nature of the representation, arising from the existence of multiple modules, leads to high vulnerability to noise. Small uncoordinated errors in the phases of the different modules can shift the represented position to a far away location. As a possible solution to this difficulty, we proposed a simple architecture of synaptic connectivity between grid cell modules, that can suppress incompatible drifts. The functional coupling between modules, arising from our proposed synaptic connectivity involves velocities, but is completely insensitive to their phases. Consequently, the coupling does not limit the combinations of possible phases of the different modules, and thus does not affect the capacity of the code.</p><p>Similar principles may apply to storage in working memory and coding of other continuous, low dimensional variables in the brain. Thus, the main contribution of our work from the theoretical perspective, is that it identifies a way to couple several low dimensional continuous attractors of dimension <inline-formula><mml:math id="inf138"><mml:mi>d</mml:mi></mml:math></inline-formula> (in the case of grid cells, <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>), to produce a persistent neural representation of a single, <inline-formula><mml:math id="inf140"><mml:mi>d</mml:mi></mml:math></inline-formula> dimensional variable with high dynamic range. The dynamics of the network are characterized by two seemingly contradictory features: first, the steady states of the system span a space of dimension <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf142"><mml:mi>m</mml:mi></mml:math></inline-formula> is the number of modules. Second, during maintenance and continuous update of the stored memory, the joint state of the modules is dynamically restricted to lie in a much smaller, <inline-formula><mml:math id="inf143"><mml:mi>d</mml:mi></mml:math></inline-formula>-dimensional subspace. This enables the continuous embedding of a <inline-formula><mml:math id="inf144"><mml:mi>d</mml:mi></mml:math></inline-formula> dimensional variable in the larger, <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> dimensional space, without allowing for noise to shift the state of the system outside the appropriate, <inline-formula><mml:math id="inf146"><mml:mi>d</mml:mi></mml:math></inline-formula> dimensional local subspace.</p><p>In the simulations of the coupled and uncoupled grid cell networks (<xref ref-type="fig" rid="fig5">Figure 5</xref>; <xref ref-type="fig" rid="fig6">Figure 6</xref>), our main goal was to demonstrate that with a reasonable choice of parameters, catastrophic readout errors are highly detrimental, and that the coupling mechanism greatly reduces the rate at which they occur. The rate of catastrophic readout errors, quantified in <xref ref-type="fig" rid="fig5">Figure 5C</xref> for specific choices of parameters, depends also on the noise sources, and on the probability that a set of shifted phases might match an alternative position in the environment. The latter quantity is influenced by the size of the environment, the number of modules, and the specific grid spacings and orientations (<xref ref-type="bibr" rid="bib12">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib64">Welinder et al., 2008</xref>; <xref ref-type="bibr" rid="bib7">Burak and Fiete, 2009</xref>; <xref ref-type="bibr" rid="bib53">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib6">Burak, 2014</xref>; <xref ref-type="bibr" rid="bib61">Vágó and Ujfalussy, 2018</xref>) (see also <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>).</p><p>The number of grid cell modules in the entorhinal cortices of rats and mice is unknown. So far there is direct evidence for the existence of four modules, but the number may be larger (<xref ref-type="bibr" rid="bib54">Stensola et al., 2012</xref>; <xref ref-type="bibr" rid="bib47">Rowland et al., 2016</xref>). A theoretical attempt to compare grid cell systems with different number of modules in terms of the rate of readout discontinuities, would require additional assumptions on the range of positions that are represented in each system: increasing the number of modules reduces the rate of readout discontinuities within the range of a given environment, but it offers the possibility to unambiguously represent larger environments (<xref ref-type="bibr" rid="bib12">Fiete et al., 2008</xref>; <xref ref-type="bibr" rid="bib35">Mathis et al., 2012a</xref>; <xref ref-type="bibr" rid="bib63">Wei et al., 2015</xref>; <xref ref-type="bibr" rid="bib61">Vágó and Ujfalussy, 2018</xref>), for which the error rate is higher <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2E–J</xref>. Furtheremore, the gain in capacity of the grid cell code, obtained with addition of modules, may be harnessed by the entorhinal-hippocampal system to generate unique representations of different environments (<xref ref-type="bibr" rid="bib15">Fyhn et al., 2007</xref>). Thus, incoherent phase errors may lead to confusion between different spatial maps, in addition to the confusion between two positions in any given environment. Accordingly, the rate of catastrophic readout errors may be influenced by the number of spatial maps represented in the brain.</p><p>Our proposed mechanism for coupling modules is complementary to another possible mechanism, of coupling grid cell modules through the reciprocal synaptic connectivity between the entorhinal cortex and the hippocampus (<xref ref-type="bibr" rid="bib64">Welinder et al., 2008</xref>; <xref ref-type="bibr" rid="bib53">Sreenivasan and Fiete, 2011</xref>; <xref ref-type="bibr" rid="bib6">Burak, 2014</xref>). Since biological systems often harness multiple mechanisms to achieve the same function, both mechanisms might act in parallel to stabilize the grid cell code against catastrophic readout errors. As discussed in the introduction, it is highly unlikely that coupling via the hippocampus could work in a novel environment, following global remapping. On the other hand, it is of particular importance for the brain to establish a geometric representation of position, aided by idiothetic path integration, under this scenario. Thus, the velocity coupling mechanism proposed in this work may play an especially important role in generating a cognitive map of a novel environment.</p><p>Inputs from cells within the MEC may play a role in stabilizing the grid cell representation, alongside inputs from the hippocampus or other areas. These may include inputs to grid cells from border cells (<xref ref-type="bibr" rid="bib52">Solstad et al., 2008</xref>) or object-vector cells (<xref ref-type="bibr" rid="bib25">Høydal et al., 2019</xref>). Experimentally, it has been demonstrated that phase resets occur in the grid cell representation upon encounters with enviornmental boundaries (<xref ref-type="bibr" rid="bib23">Hardcastle et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Keinath et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Ocko et al., 2018</xref>), and it has been argued theoretically that such resets can be implemented in attractor models of grid cells by inputs to grid cells from border cells (<xref ref-type="bibr" rid="bib23">Hardcastle et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Keinath et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Ocko et al., 2018</xref>; <xref ref-type="bibr" rid="bib45">Pollock et al., 2018</xref>). The origin of spatial specificity of border cells and object-vector cells is not yet identified, but since both types of cells are active even when an animal is not facing the features associated with their activation, their role in stabilizing the grid cell representation may be similar to the hypothesized role of place cell inputs in stabilizing the grid cell code, perhaps more so than the role of direct sensory inputs.</p><p>A model that involves synaptic coupling between modules, of a different architecture than the one considered here, has been recently proposed in <xref ref-type="bibr" rid="bib28">Kang and Balasubramanian (2019)</xref>. This model does not explore the consequences of noise on coding stability, and its primary goal is to explain the ratios between grid spacings, and the emergence of modularity (see also <xref ref-type="bibr" rid="bib60">Urdapilleta et al., 2017</xref>). Hence, <xref ref-type="bibr" rid="bib28">Kang and Balasubramanian (2019)</xref> address different questions from those studied in the present work. Nevertheless, it is plausible that the synaptic connectivity proposed by Kang and Balasubramanian stabilizes the dynamics against incompatible motion of the modules. An important difference between the network architecture explored in <xref ref-type="bibr" rid="bib28">Kang and Balasubramanian (2019)</xref> and the architecture explored here, is that we consider connectivity between modules which is all-to-all (every grid cell in one module projects to every grid cell in the other module), and is designed to be invariant to any static, relative shift in the module phases. Hence, all combinations of phases are steady states of the dynamics. In contrast, the synaptic connectivity considered in <xref ref-type="bibr" rid="bib28">Kang and Balasubramanian (2019)</xref> is spatially local. Consequently, it tends to produce interlocked patterns of activity in adjacent modules, with shared spatial periodicity, and preferred relative spatial phases. These properties of the activity patterns are expected to limit the representational capacity of the code. Here, we addressed a different computational goal, of stabilizing a distributed representation of position over multiple modules, without compromising the dynamic range of the neural coding scheme.</p><p>Our focus in this work was on the suppression of relative motion across modules, but noise in the inputs, or in the intrinsic activity within the network, drives also coordinated motion. It is possible to suppress the latter type of random motion by increasing the negative feedback in the system (<xref ref-type="fig" rid="fig3">Figure 3A,C</xref>). In choosing our optimization goal for the coupling parameters, we did not attempt to suppress coordinated drift for two reasons. First, coordinated drift is much less detrimental from the coding perspective than relative drifts, as discussed in the introduction. Second, suppressing the coordinated motion comes with an inevitable cost: a reduction in the gain of the system’s velocity response. Nevertheless, it is interesting to consider also the suppression of coordinated drift. Next, we briefly discuss the possible implementation of this goal.</p><p>For simplicity, consider a single one-dimensional module, structured as a ring attractor: in this situation, there is only coordinated motion. As in any continuous attractor network, stochasticity of neural activity within the network drives diffusive motion of the bump’s position. This diffusive motion gradually degrades the fidelity of the stored memory (<xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>). In the double ring architecture (<xref ref-type="bibr" rid="bib65">Xie et al., 2002</xref>), much of the drift arises from fluctuations in the difference of activity between the two sub-populations that drive left and right motion. Using the negative self-coupling of velocities, introduced in this work, it is possible to suppress these fluctuations to substantially reduce the noise-driven diffusion and stabilize the represented memory. It is interesting to compare this mechanism with another proposal (<xref ref-type="bibr" rid="bib33">Lim and Goldman, 2014</xref>) for stabilization of the memory stored in a single ring attractor, using negative derivative feedback (<xref ref-type="bibr" rid="bib32">Lim and Goldman, 2013</xref>). In (<xref ref-type="bibr" rid="bib33">Lim and Goldman, 2014</xref>) the stabilization slows down the dynamics of all neurons in the network, thereby slowing down the relaxation of any deformation in the shape of the activity bump – not only the position of the activity bump on the ring attractor. In contrast, within the architecture considered here, the unimodal shape of the activity bump is maintained, while the velocity feedback mechanism slows down only noise driven diffusion of its position. Thus, the velocity coupling mechanism identified in this work may be relevant to the stabilization of short-term memory in head directions cells of rodents (<xref ref-type="bibr" rid="bib57">Taube, 2007</xref>) and insects (<xref ref-type="bibr" rid="bib49">Seelig and Jayaraman, 2015</xref>), where there is no evidence for slowly decaying deformations in the shape of the activity bump.</p><sec id="s3-1"><title>Experimental predictions</title><p>The grid spacing of a single module is determined by the coefficient that tunes how strongly activity is modulated by velocity (<inline-formula><mml:math id="inf147"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ21">Equation 21</xref>): larger values of <inline-formula><mml:math id="inf148"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> lead to smaller grid spacing. Thus, in an uncoupled network the grid spacing ratios are determined by the coefficients <inline-formula><mml:math id="inf149"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>. However, in the network of coupled modules the spacing ratios are determined primarily by the inter-module coupling parameters. Each one of the coefficients <inline-formula><mml:math id="inf150"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> influences all the grid spacings, but has little effect on the spacing ratios. For example, even if the <inline-formula><mml:math id="inf151"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>s are identical in all modules, or if only one module receives a velocity input, all modules shift their states with a velocity ratio that matches the desired grid spacing ratio. An interesting prediction arises under a scenario in which one of the modules is disconnected from the others. This removes positive couplings from the other modules, but leaves the negative self coupling within the module intact. Hence, the disconnected module is expected to weaken its response to velocity inputs, and increase its grid spacing. Similarly, other grid spacings, of modules that were originally connected to the disconnected module, are expected to increase as well (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>The joint activity of grid cells can be expected to lie within a two-dimensional space when salient sensory cues are available to the animal, regardless of the existence of an inter-module coupling mechanism. The existence of a coupling mechanism must therefore be tested under conditions in which external sensory cues are weak (<xref ref-type="bibr" rid="bib6">Burak, 2014</xref>). It is instructive to compare this goal with what has been learned about population activity within a single module (<xref ref-type="bibr" rid="bib66">Yoon et al., 2013</xref>; <xref ref-type="bibr" rid="bib15">Fyhn et al., 2007</xref>; <xref ref-type="bibr" rid="bib1">Allen et al., 2014</xref>; <xref ref-type="bibr" rid="bib58">Trettel et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Gardner et al., 2019</xref>). In that context, simultaneous recordings from pairs of grid cells were highly informative, since grid cells from a single module exhibit strong correlations (or anti-correlations) in their joint spiking activity. The preservation of these correlations, under conditions in which the animal’s sense of position is disrupted, supports an interpretation that the correlations are maintained by recurrent connectivity within each module. In contrast, cells belonging to different modules are expected to fire together in some positions in space, and refrain from firing together in other parts of the environment. Averaged over motion in a large environment, cell pairs from different modules are expected to exhibit weak correlations in their activity, even if the updates of module phases are fully coordinated.</p><p>Analysis of spike correlations in grid cells from different modules (<xref ref-type="bibr" rid="bib58">Trettel et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Gardner et al., 2019</xref>) confirms this expectation. During free running, spike correlation functions of grid cells from different modules are much weaker than those observed within a module. Despite being weak, these correlations can be statistically significant. Their existence originates from the fact that in any specific environment, and especially in small enclosures, the firing fields of two grid cells with different spatial scales slightly favor correlated or uncorrelated firing, depending on the precise overlap between the spatial receptive fields of the two cells. During sleep, these weak correlations are significantly reduced (<xref ref-type="bibr" rid="bib58">Trettel et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Gardner et al., 2019</xref>). A possible interpretation of this result is that there is no coupling between modules during sleep. However, an alternative explanation is that the reduction in correlations reflects an increase in the repertoire of positions and environments represented in the sleep state: regions of joint firing and regions of disjoint firing are expected to average out more evenly under such circumstances, leading to weaker correlations.</p><p>In order to test for the existence of a velocity coupling mechanism, it is desirable to test for correlations in the updates of phases of different modules, instead of directly testing for correlations in their phases. This will require simultaneous recordings from multiple grid cells, of sufficient numbers that will enable reliable tracking of the module phases. Appropriate recordings are not yet available, but techniques that enable simultaneous monitoring of large neural populations of the MEC (<xref ref-type="bibr" rid="bib27">Jun et al., 2017</xref>; <xref ref-type="bibr" rid="bib20">Gu et al., 2018</xref>; <xref ref-type="bibr" rid="bib41">Obenhaus et al., 2018</xref>) are likely to enable their acquisition in the coming years. In similarity to the experiments that provided insights on the low dimensionality of activity within each module, it will be necessary to test for inter-module coupling under conditions in which the animal’s internal sense of position is not anchored to salient external cues.</p><p>Our model assumes that grid cells in the MEC are involved in idiothetic path integration, and harnesses ingredients from models of path integration in the grid cell system to generate the coupling between modules. It is widely hypothesized that grid cells are indeed involved in path integration (<xref ref-type="bibr" rid="bib22">Hafting et al., 2005</xref>; <xref ref-type="bibr" rid="bib37">McNaughton et al., 2006</xref>; <xref ref-type="bibr" rid="bib38">Moser et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Burak, 2014</xref>), but this involvement is not experimentally established (see, however, <xref ref-type="bibr" rid="bib18">Gil et al., 2018</xref>). Accordingly, a specific role of any particular cell type within the MEC in idiothetic path integration is not yet identified. A specific population of cells that may provide the substrate for the connectivity proposed in our model are the conjunctive cells observed mostly in layer III and deeper layers of the MEC (<xref ref-type="bibr" rid="bib48">Sargolini et al., 2006</xref>), which play a pivotal role in models of path integration in the grid cell system. We note that these cells are tuned to head direction more closely than heading (<xref ref-type="bibr" rid="bib46">Raudies et al., 2015</xref>), a difficulty that faces all models of path integration within the MEC. The resolution of this difficulty may involve computational elements within the entorhinal circuitry that have not yet been identified. Thus, future experimental findings concerned with the mechanisms underlying path integration may call for (and enable) corresponding refinements of our model.</p><p>Very little is known about synaptic connectivity between grid cells in the MEC, especially for cells belonging functionally to different modules. An important conclusion of our work is that synaptic connectivity between different modules may be beneficial for dynamically stabilizing the grid cell representation during path integration and memory maintenance. The specific form of connectivity that we identify is appealing for several reasons: first, it involves broad, relatively unstructured connectivity between grid cells, that depends only on their preferred heading preference. A second appealing feature of our proposed architecture is that it is sufficient to couple grid cells from modules with adjacent spacings, to achieve the desired stabilization of the grid cell representation. Since there is a relationship between grid spacing and position along the dorsal-ventral axis (<xref ref-type="bibr" rid="bib22">Hafting et al., 2005</xref>; <xref ref-type="bibr" rid="bib54">Stensola et al., 2012</xref>), all-to-all couplings between modules would require long-range connectivity within the MEC. Recent evidence (<xref ref-type="bibr" rid="bib13">Fu et al., 2018</xref>) hints that synaptic connections between excitatory cells in the MEC may be more limited in range, but of sufficient spatial extent to allow for coupling of adjacent modules.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Model and simulations details</title><p>The dynamics of the network are described by <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> (or by <xref ref-type="disp-formula" rid="equ22">Equation 22</xref> for the Poisson spiking neuron case). The synaptic time constant <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, the transfer function <inline-formula><mml:math id="inf153"><mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi>max</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf154"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. All simulations were done using the Euler method for integration, with a time step <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><sec id="s4-1-1"><title>One-dimensional module</title><p>In the one-dimensional simulations the synaptic activation vector (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) includes synapses of the right and left sub-populations, each comprising <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> neurons. Each neuron has a preferred phase <inline-formula><mml:math id="inf157"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, uniformly arranged on a ring. The connectivity matrix <inline-formula><mml:math id="inf158"><mml:mi>W</mml:mi></mml:math></inline-formula> is defined by<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mo>+</mml:mo></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mo>-</mml:mo></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>∓</mml:mo><mml:mi>φ</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo rspace="4.2pt">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf159"><mml:msup><mml:mi>W</mml:mi><mml:mo>±</mml:mo></mml:msup></mml:math></inline-formula> is a <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> matrix, <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>φ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf163"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf164"><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:math></inline-formula> is the minimal distance between two points <inline-formula><mml:math id="inf165"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with periodic boundary conditions on <inline-formula><mml:math id="inf166"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, namely<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext>mod 1</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext>mod 1</mml:mtext></mml:msub></mml:mrow><mml:mo rspace="4.2pt">}</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-1-2"><title>Coupled modules</title><p>Consider <inline-formula><mml:math id="inf167"><mml:mi>m</mml:mi></mml:math></inline-formula> coupled modules. The firing rate (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>) of neuron <inline-formula><mml:math id="inf168"><mml:mi>i</mml:mi></mml:math></inline-formula> from module <inline-formula><mml:math id="inf169"><mml:mi>μ</mml:mi></mml:math></inline-formula> is (<xref ref-type="fig" rid="fig2">Figure 2E</xref>):<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>±</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>ρ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf170"><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is the velocity estimation of module μ (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) , <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the coupling strength from module <inline-formula><mml:math id="inf172"><mml:mi>ρ</mml:mi></mml:math></inline-formula> to module μ (<inline-formula><mml:math id="inf173"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the self coupling strength of module μ), and the sign ± is equal to + (−) if the neuron <inline-formula><mml:math id="inf174"><mml:mi>i</mml:mi></mml:math></inline-formula> belongs to a right (left) sub-population. The proportionality factor <inline-formula><mml:math id="inf175"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is included to simplify the units of the coupling strengths <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Note that <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>a</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> does not depend on the parameter β. Thus, the choice of β is of no consequence for the dynamics, and this parameter is included only for the sake of derivation convenience.</p><p>The coupling between the modules can be interpreted as arising from synaptic connectivity. This can be seen by re-writing <xref ref-type="disp-formula" rid="equ11">Equation 11</xref> as:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the <inline-formula><mml:math id="inf178"><mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> coupling connectivity matrix is:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Thus, the synapses responsible for the coupling of any two neurons belonging to modules <inline-formula><mml:math id="inf179"><mml:mi>μ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf180"><mml:mi>ρ</mml:mi></mml:math></inline-formula> are of the same magnitude, <inline-formula><mml:math id="inf181"><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:math></inline-formula> , and their signs depend only on the sub-populations (left or right) of the pre- and post-synaptic neurons. In the case of <inline-formula><mml:math id="inf182"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, we use the coupling parameters: <inline-formula><mml:math id="inf183"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf184"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>14.14</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf185"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>28.3</mml:mn></mml:mrow></mml:math></inline-formula>. In the case of <inline-formula><mml:math id="inf186"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, we use the parameters: <inline-formula><mml:math id="inf187"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>14.14</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf189"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>21</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>23</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>9.4</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf190"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>32</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mn>28.3</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf191"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>13</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>31</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Additional details on the choice of coupling parameters are provided in Appendices 2 and 3.</p></sec><sec id="s4-1-3"><title>Two-dimensional modules</title><p>In two dimensions, each module contains four sub-populations, and the synaptic activation vector is:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>U</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>D</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Each sub-population contains <inline-formula><mml:math id="inf192"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mn>64</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> neurons, arranged on a parallelogram. The preferred phase of the <inline-formula><mml:math id="inf193"><mml:mi>i</mml:mi></mml:math></inline-formula>’th neuron in each sub-population is:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="center center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0.5</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf194"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf195"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are distributed uniformly in the interval <inline-formula><mml:math id="inf196"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The connectivity matrix is now:<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>R</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>U</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>R</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>U</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>R</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>U</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>R</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>L</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>U</mml:mi></mml:msup></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>∓</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mi>φ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>∓</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>φ</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>and<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo rspace="4.2pt">]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The distance measure <inline-formula><mml:math id="inf197"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:math></inline-formula> is defined using periodic boundary conditions on the parallelogram (see <xref ref-type="fig" rid="fig4">Figure 4A</xref>): <inline-formula><mml:math id="inf198"><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math></inline-formula> is the minimal distance between the two points <inline-formula><mml:math id="inf199"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf200"><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> on the torus that is created by gluing the opposite edges of the parallelogram defined by the vertices <inline-formula><mml:math id="inf201"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, compare with <xref ref-type="disp-formula" rid="equ10">Equation 10</xref>, used in the one-dimensional case).</p><p>The firing rate of neuron <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> {sub-population <italic>R</italic> or <italic>L</italic>} from module <inline-formula><mml:math id="inf203"><mml:mi>μ</mml:mi></mml:math></inline-formula> is:<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo rspace="4.2pt">(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Firing rates of neurons from the up and down sub-populations are obtained from <xref ref-type="disp-formula" rid="equ19">Equation 19</xref>-Equation 20 by replacing <inline-formula><mml:math id="inf204"><mml:mrow><mml:mi>x</mml:mi><mml:mo>→</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>, , <inline-formula><mml:math id="inf205"><mml:mrow><mml:mi>R</mml:mi><mml:mo>→</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>In each module, responses to horizontal and vertical velocity inputs are independent: the right and left sub-populations respond to the horizontal velocity inputs, and affect <inline-formula><mml:math id="inf207"><mml:msub><mml:mi>θ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>, while the up and down sub-populations respond to the vertical velocity inputs and affect <inline-formula><mml:math id="inf208"><mml:msub><mml:mi>θ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>. Hence, the two-dimensional response tensor separates into independent, horizontal and vertical components with the same structure as in the one-dimensional case. Since the linear response tensor (in each direction) is identical to that of the one-dimensional case, the coupling parameters are chosen in the same way in one and two dimensions.</p></sec><sec id="s4-1-4"><title>External velocity input</title><p>The external velocity input to module <inline-formula><mml:math id="inf209"><mml:mi>μ</mml:mi></mml:math></inline-formula> (in two dimensions) in <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> direction is (<xref ref-type="disp-formula" rid="equ19">Equation 19</xref>):<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="inf211"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is a proportionality factor that depends on the module, <inline-formula><mml:math id="inf212"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a the component of the animal’s velocity in the <inline-formula><mml:math id="inf213"><mml:mi>q</mml:mi></mml:math></inline-formula> direction, and <inline-formula><mml:math id="inf214"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a white noise process with <inline-formula><mml:math id="inf215"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. In <xref ref-type="fig" rid="fig4">Figure 4B</xref> and <xref ref-type="fig" rid="fig6">Figure 6B–C</xref> the external input is not noisy, so <inline-formula><mml:math id="inf216"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In <xref ref-type="fig" rid="fig4">Figure 4D–E</xref> and <xref ref-type="fig" rid="fig5">Figure 5</xref>, <inline-formula><mml:math id="inf217"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>0.02</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>In <xref ref-type="fig" rid="fig3">Figure 3E–F</xref> (one dimension) <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf219"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In the simulations of <xref ref-type="fig" rid="fig4">Figure 4</xref>; <xref ref-type="fig" rid="fig6">Figure 6</xref> (two dimensions) <inline-formula><mml:math id="inf220"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:math></inline-formula> , <inline-formula><mml:math id="inf221"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> , <inline-formula><mml:math id="inf222"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mn>0.06</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Thus, even without coupling of the modules, the spacing ratio <inline-formula><mml:math id="inf223"><mml:mi>λ</mml:mi></mml:math></inline-formula> is achieved by the ratios of the inputs strengths <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>γ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula>, and therefore, we can compare between the coupled and uncoupled phases and readout (<xref ref-type="fig" rid="fig4">Figure 4</xref>; <xref ref-type="fig" rid="fig6">Figure 6</xref>).</p></sec></sec><sec id="s4-2"><title>Spiking network</title><p>In the case of spiking Poisson neurons <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> is replaced by:<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>χ</mml:mi></mml:munder><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>χ</mml:mi></mml:msubsup></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>χ</mml:mi></mml:munder><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>χ</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>is the spike train of neuron <inline-formula><mml:math id="inf225"><mml:mi>i</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf226"><mml:msubsup><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>χ</mml:mi></mml:msubsup></mml:math></inline-formula> are the spike times. Each neuron <inline-formula><mml:math id="inf227"><mml:mi>i</mml:mi></mml:math></inline-formula> generates spikes sampled from a Poisson distribution with a firing rate <inline-formula><mml:math id="inf228"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, as defined in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> (<xref ref-type="bibr" rid="bib55">Stevens and Zador, 1996</xref>; <xref ref-type="bibr" rid="bib17">Gerstner and Kistler, 2002</xref>; <xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>).</p></sec><sec id="s4-3"><title>Decoding</title><p>Decoding of the animal’s trajectory, based on spike trains, is performed in <xref ref-type="fig" rid="fig5">Figure 5</xref>; <xref ref-type="fig" rid="fig6">Figure 6</xref> using a decoder that sums spikes from recent history with an exponential temporal kernel (<xref ref-type="bibr" rid="bib39">Mosheiff et al., 2017</xref>). In <xref ref-type="fig" rid="fig5">Figure 5</xref>, we simulate a spike train for each neuron (<xref ref-type="disp-formula" rid="equ23">Equation 23</xref>), sampled from an inhomogeneous Poisson process with a firing rate <inline-formula><mml:math id="inf229"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (note that the the network dynamics are deterministic and spikes are used only in the readout process). In <xref ref-type="fig" rid="fig6">Figure 6</xref>, the stochastic spike train is part of of the dynamics (<xref ref-type="disp-formula" rid="equ22">Equation 22</xref>). In both cases, the decoded location of the animal in time <inline-formula><mml:math id="inf230"><mml:mi>t</mml:mi></mml:math></inline-formula> is (Eqs. S10, S11 and S13 in <xref ref-type="bibr" rid="bib39">Mosheiff et al., 2017</xref>):<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:munder><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>χ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The summation is over all neurons. Here, <inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for all modules. The integral in <xref ref-type="disp-formula" rid="equ24">Equation 24</xref> yields an effective spike count of neuron <inline-formula><mml:math id="inf232"><mml:mi>i</mml:mi></mml:math></inline-formula>, weighted in time using a decaying exponential kernel, and <inline-formula><mml:math id="inf233"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the receptive field of neuron <inline-formula><mml:math id="inf234"><mml:mi>i</mml:mi></mml:math></inline-formula> at location <inline-formula><mml:math id="inf235"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, measured separately from the firing rate of each neuron in the steady state of the dynamics.</p></sec><sec id="s4-4"><title>Diffusion tensor</title><p>Consider a system of spiking Poisson neurons, and <inline-formula><mml:math id="inf236"><mml:mi>m</mml:mi></mml:math></inline-formula> one-dimensional modules. The internal noise introduces a diffusive drift. The network is now a single continuous attractor with dimension <inline-formula><mml:math id="inf237"><mml:mi>m</mml:mi></mml:math></inline-formula> (see Appendix 5). Hence, the diffusion tensor is a <inline-formula><mml:math id="inf238"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> matrix, that can be calculated using Eq. S24 in <xref ref-type="bibr" rid="bib8">Burak and Fiete (2012)</xref>, for the dynamics of the <inline-formula><mml:math id="inf239"><mml:mi>m</mml:mi></mml:math></inline-formula> dimensional attractor (<xref ref-type="disp-formula" rid="equ77">Equation 77</xref>, <xref ref-type="disp-formula" rid="equ78">Equation 78</xref> and <xref ref-type="disp-formula" rid="equ79">Equation 79</xref> in Appendix 5):<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where the summation is over all neurons, <inline-formula><mml:math id="inf240"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the firing rate of neuron <inline-formula><mml:math id="inf241"><mml:mi>i</mml:mi></mml:math></inline-formula> in the steady state of the system, and <inline-formula><mml:math id="inf242"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the left null eigenvector of the dynamics (<xref ref-type="disp-formula" rid="equ78">Equation 78</xref>) corresponding to a phase shift in the direction of module <inline-formula><mml:math id="inf243"><mml:mi>μ</mml:mi></mml:math></inline-formula> (calculated numerically).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>This research was supported by the Israel Science Foundation grant No. 1745/18 and (in part) by grant No. 1978/13. We acknowledge support from the Gatsby Charitable Foundation, and from the Dalia and Dan Maydan Fellowship (NM).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.48494.011</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-48494-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>This is a theoretical work. There are no data sets associated with it.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>Gil</surname> <given-names>M</given-names></name><name><surname>Resnik</surname> <given-names>E</given-names></name><name><surname>Toader</surname> <given-names>O</given-names></name><name><surname>Seeburg</surname> <given-names>P</given-names></name><name><surname>Monyer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Impaired path integration and grid cell spatial periodicity in mice lacking GluA1-containing AMPA receptors</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>6245</fpage><lpage>6259</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4330-13.2014</pub-id><pub-id pub-id-type="pmid">24790195</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Almog</surname> <given-names>N</given-names></name><name><surname>Tocker</surname> <given-names>G</given-names></name><name><surname>Bonnevie</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>E</given-names></name><name><surname>Moser</surname> <given-names>M-B</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>During hippocampal inactivation, grid cells maintain their synchrony, even when the grid pattern is lost</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/592006</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Jeffery</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Experience-dependent rescaling of entorhinal grids</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>682</fpage><lpage>684</lpage><pub-id pub-id-type="doi">10.1038/nn1905</pub-id><pub-id pub-id-type="pmid">17486102</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Ginzberg</surname> <given-names>LL</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Grid cell firing patterns signal environmental novelty by expansion</article-title><source>PNAS</source><volume>109</volume><fpage>17687</fpage><lpage>17692</lpage><pub-id pub-id-type="doi">10.1073/pnas.1209918109</pub-id><pub-id pub-id-type="pmid">23045662</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Yishai</surname> <given-names>R</given-names></name><name><surname>Bar-Or</surname> <given-names>RL</given-names></name><name><surname>Sompolinsky</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Theory of orientation tuning in visual cortex</article-title><source>PNAS</source><volume>92</volume><fpage>3844</fpage><lpage>3848</lpage><pub-id pub-id-type="doi">10.1073/pnas.92.9.3844</pub-id><pub-id pub-id-type="pmid">7731993</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Spatial coding and attractor dynamics of grid cells in the entorhinal cortex</article-title><source>Current Opinion in Neurobiology</source><volume>25</volume><fpage>169</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.01.013</pub-id><pub-id pub-id-type="pmid">24561907</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Accurate path integration in continuous attractor network models of grid cells</article-title><source>PLOS Computational Biology</source><volume>5</volume><elocation-id>e1000291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id><pub-id pub-id-type="pmid">19229307</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fundamental limits on persistent activity in networks of noisy neurons</article-title><source>PNAS</source><volume>109</volume><fpage>17645</fpage><lpage>17650</lpage><pub-id pub-id-type="doi">10.1073/pnas.1117386109</pub-id><pub-id pub-id-type="pmid">23047704</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Albis</surname> <given-names>T</given-names></name><name><surname>Kempter</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A single-cell spiking model for the origin of grid-cell patterns</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005782</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005782</pub-id><pub-id pub-id-type="pmid">28968386</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dordek</surname> <given-names>Y</given-names></name><name><surname>Soudry</surname> <given-names>D</given-names></name><name><surname>Meir</surname> <given-names>R</given-names></name><name><surname>Derdikman</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Extracting grid cell characteristics from place cell inputs using non-negative principal component analysis</article-title><source>eLife</source><volume>5</volume><elocation-id>e10094</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.10094</pub-id><pub-id pub-id-type="pmid">26952211</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eichenbaum</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Time cells in the Hippocampus: a new dimension for mapping memories</article-title><source>Nature Reviews Neuroscience</source><volume>15</volume><fpage>732</fpage><lpage>744</lpage><pub-id pub-id-type="doi">10.1038/nrn3827</pub-id><pub-id pub-id-type="pmid">25269553</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Brookings</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>What grid cells convey about rat location</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>6858</fpage><lpage>6871</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5684-07.2008</pub-id><pub-id pub-id-type="pmid">18596161</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fu</surname> <given-names>ML</given-names></name><name><surname>Zutshi</surname> <given-names>I</given-names></name><name><surname>Liu</surname> <given-names>S</given-names></name><name><surname>Leutgeb</surname> <given-names>JK</given-names></name><name><surname>Lim</surname> <given-names>BK</given-names></name><name><surname>Leutgeb</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><chapter-title>Layer specific characterization of local projections within the medial entorhinal cortex</chapter-title><source>Program No. 510.07. 2018 Neuroscience Meeting Planner</source><publisher-loc>San Diego</publisher-loc><publisher-name>Society for Neuroscience</publisher-name></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fuhs</surname> <given-names>MC</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>4266</fpage><lpage>4276</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4353-05.2006</pub-id><pub-id pub-id-type="pmid">16624947</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Hippocampal remapping and grid realignment in entorhinal cortex</article-title><source>Nature</source><volume>446</volume><fpage>190</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1038/nature05601</pub-id><pub-id pub-id-type="pmid">17322902</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname> <given-names>RJ</given-names></name><name><surname>Lu</surname> <given-names>L</given-names></name><name><surname>Wernle</surname> <given-names>T</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Correlation structure of grid cells is preserved during sleep</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>598</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0360-0</pub-id><pub-id pub-id-type="pmid">30911185</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Kistler</surname> <given-names>WM</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Spiking Neuron Models: Single Neurons, Populations, Plasticity</source><publisher-name>Cambridge university press</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gil</surname> <given-names>M</given-names></name><name><surname>Ancau</surname> <given-names>M</given-names></name><name><surname>Schlesiger</surname> <given-names>MI</given-names></name><name><surname>Neitz</surname> <given-names>A</given-names></name><name><surname>Allen</surname> <given-names>K</given-names></name><name><surname>De Marco</surname> <given-names>RJ</given-names></name><name><surname>Monyer</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Impaired path integration in mice with disrupted grid cell firing</article-title><source>Nature Neuroscience</source><volume>21</volume><fpage>81</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.1038/s41593-017-0039-3</pub-id><pub-id pub-id-type="pmid">29230055</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname> <given-names>J</given-names></name><name><surname>Adachi</surname> <given-names>A</given-names></name><name><surname>Shah</surname> <given-names>KK</given-names></name><name><surname>Hirokawa</surname> <given-names>JD</given-names></name><name><surname>Magani</surname> <given-names>PS</given-names></name><name><surname>Maimon</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A neural circuit architecture for angular integration in <italic>Drosophila</italic></article-title><source>Nature</source><volume>546</volume><fpage>101</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1038/nature22343</pub-id><pub-id pub-id-type="pmid">28538731</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gu</surname> <given-names>Y</given-names></name><name><surname>Lewallen</surname> <given-names>S</given-names></name><name><surname>Kinkhabwala</surname> <given-names>AA</given-names></name><name><surname>Domnisoru</surname> <given-names>C</given-names></name><name><surname>Yoon</surname> <given-names>K</given-names></name><name><surname>Gauthier</surname> <given-names>JL</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>Tank</surname> <given-names>DW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A Map-like Micro-Organization of grid cells in the medial entorhinal cortex</article-title><source>Cell</source><volume>175</volume><fpage>736</fpage><lpage>750</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.08.066</pub-id><pub-id pub-id-type="pmid">30270041</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guanella</surname> <given-names>A</given-names></name><name><surname>Kiper</surname> <given-names>D</given-names></name><name><surname>Verschure</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A model of grid cells based on a twisted torus topology</article-title><source>International Journal of Neural Systems</source><volume>17</volume><fpage>231</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1142/S0129065707001093</pub-id><pub-id pub-id-type="pmid">17696288</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Molden</surname> <given-names>S</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Microstructure of a spatial map in the entorhinal cortex</article-title><source>Nature</source><volume>436</volume><fpage>801</fpage><lpage>806</lpage><pub-id pub-id-type="doi">10.1038/nature03721</pub-id><pub-id pub-id-type="pmid">15965463</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Environmental boundaries as an error correction mechanism for grid cells</article-title><source>Neuron</source><volume>86</volume><fpage>827</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.039</pub-id><pub-id pub-id-type="pmid">25892299</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heys</surname> <given-names>JG</given-names></name><name><surname>Rangarajan</surname> <given-names>KV</given-names></name><name><surname>Dombeck</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The functional micro-organization of grid cells revealed by cellular-resolution imaging</article-title><source>Neuron</source><volume>84</volume><fpage>1079</fpage><lpage>1090</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.10.048</pub-id><pub-id pub-id-type="pmid">25467986</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Høydal</surname> <given-names>ØA</given-names></name><name><surname>Skytøen</surname> <given-names>ER</given-names></name><name><surname>Andersson</surname> <given-names>SO</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Object-vector coding in the medial entorhinal cortex</article-title><source>Nature</source><volume>568</volume><fpage>400</fpage><lpage>404</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1077-7</pub-id><pub-id pub-id-type="pmid">30944479</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Itskov</surname> <given-names>V</given-names></name><name><surname>Curto</surname> <given-names>C</given-names></name><name><surname>Pastalkova</surname> <given-names>E</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cell assembly sequences arising from spike threshold adaptation keep track of time in the Hippocampus</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>2828</fpage><lpage>2834</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3773-10.2011</pub-id><pub-id pub-id-type="pmid">21414904</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jun</surname> <given-names>JJ</given-names></name><name><surname>Steinmetz</surname> <given-names>NA</given-names></name><name><surname>Siegle</surname> <given-names>JH</given-names></name><name><surname>Denman</surname> <given-names>DJ</given-names></name><name><surname>Bauza</surname> <given-names>M</given-names></name><name><surname>Barbarits</surname> <given-names>B</given-names></name><name><surname>Lee</surname> <given-names>AK</given-names></name><name><surname>Anastassiou</surname> <given-names>CA</given-names></name><name><surname>Andrei</surname> <given-names>A</given-names></name><name><surname>Aydın</surname> <given-names>Ç</given-names></name><name><surname>Barbic</surname> <given-names>M</given-names></name><name><surname>Blanche</surname> <given-names>TJ</given-names></name><name><surname>Bonin</surname> <given-names>V</given-names></name><name><surname>Couto</surname> <given-names>J</given-names></name><name><surname>Dutta</surname> <given-names>B</given-names></name><name><surname>Gratiy</surname> <given-names>SL</given-names></name><name><surname>Gutnisky</surname> <given-names>DA</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name><name><surname>Karsh</surname> <given-names>B</given-names></name><name><surname>Ledochowitsch</surname> <given-names>P</given-names></name><name><surname>Lopez</surname> <given-names>CM</given-names></name><name><surname>Mitelut</surname> <given-names>C</given-names></name><name><surname>Musa</surname> <given-names>S</given-names></name><name><surname>Okun</surname> <given-names>M</given-names></name><name><surname>Pachitariu</surname> <given-names>M</given-names></name><name><surname>Putzeys</surname> <given-names>J</given-names></name><name><surname>Rich</surname> <given-names>PD</given-names></name><name><surname>Rossant</surname> <given-names>C</given-names></name><name><surname>Sun</surname> <given-names>WL</given-names></name><name><surname>Svoboda</surname> <given-names>K</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name><name><surname>O'Keefe</surname> <given-names>J</given-names></name><name><surname>Harris</surname> <given-names>TD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fully integrated silicon probes for high-density recording of neural activity</article-title><source>Nature</source><volume>551</volume><fpage>232</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1038/nature24636</pub-id><pub-id pub-id-type="pmid">29120427</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname> <given-names>L</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A geometric attractor mechanism for self-organization of entorhinal grid modules</article-title><source>eLife</source><volume>8</volume><elocation-id>e46687</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46687</pub-id><pub-id pub-id-type="pmid">31373556</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keinath</surname> <given-names>AT</given-names></name><name><surname>Epstein</surname> <given-names>RA</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Environmental deformations dynamically shift the grid cell spatial metric</article-title><source>eLife</source><volume>7</volume><elocation-id>e38169</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38169</pub-id><pub-id pub-id-type="pmid">30346272</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>SS</given-names></name><name><surname>Rouault</surname> <given-names>H</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ring attractor dynamics in the <italic>Drosophila</italic> central brain</article-title><source>Science</source><volume>356</volume><fpage>849</fpage><lpage>853</lpage><pub-id pub-id-type="doi">10.1126/science.aal4835</pub-id><pub-id pub-id-type="pmid">28473639</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The emergence of grid cells: intelligent design or just adaptation?</article-title><source>Hippocampus</source><volume>18</volume><fpage>1256</fpage><lpage>1269</lpage><pub-id pub-id-type="doi">10.1002/hipo.20520</pub-id><pub-id pub-id-type="pmid">19021261</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lim</surname> <given-names>S</given-names></name><name><surname>Goldman</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Balanced cortical microcircuitry for maintaining information in working memory</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1306</fpage><lpage>1314</lpage><pub-id pub-id-type="doi">10.1038/nn.3492</pub-id><pub-id pub-id-type="pmid">23955560</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lim</surname> <given-names>S</given-names></name><name><surname>Goldman</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Balanced cortical microcircuitry for spatial working memory based on corrective feedback control</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>6790</fpage><lpage>6806</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4602-13.2014</pub-id><pub-id pub-id-type="pmid">24828633</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manns</surname> <given-names>JR</given-names></name><name><surname>Howard</surname> <given-names>MW</given-names></name><name><surname>Eichenbaum</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Gradual changes in hippocampal activity support remembering the order of events</article-title><source>Neuron</source><volume>56</volume><fpage>530</fpage><lpage>540</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2007.08.017</pub-id><pub-id pub-id-type="pmid">17988635</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname> <given-names>A</given-names></name><name><surname>Herz</surname> <given-names>AV</given-names></name><name><surname>Stemmler</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012a</year><article-title>Optimal population codes for space: grid cells outperform place cells</article-title><source>Neural Computation</source><volume>24</volume><fpage>2280</fpage><lpage>2317</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00319</pub-id><pub-id pub-id-type="pmid">22594833</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathis</surname> <given-names>A</given-names></name><name><surname>Herz</surname> <given-names>AV</given-names></name><name><surname>Stemmler</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2012">2012b</year><article-title>Resolution of nested neuronal representations can be exponential in the number of neurons</article-title><source>Physical Review Letters</source><volume>109</volume><elocation-id>018103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.109.018103</pub-id><pub-id pub-id-type="pmid">23031134</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Battaglia</surname> <given-names>FP</given-names></name><name><surname>Jensen</surname> <given-names>O</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Path integration and the neural basis of the 'cognitive map'</article-title><source>Nature Reviews Neuroscience</source><volume>7</volume><fpage>663</fpage><lpage>678</lpage><pub-id pub-id-type="doi">10.1038/nrn1932</pub-id><pub-id pub-id-type="pmid">16858394</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moser</surname> <given-names>EI</given-names></name><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Place cells, grid cells, and the brain's spatial representation system</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><fpage>69</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.31.061307.090723</pub-id><pub-id pub-id-type="pmid">18284371</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mosheiff</surname> <given-names>N</given-names></name><name><surname>Agmon</surname> <given-names>H</given-names></name><name><surname>Moriel</surname> <given-names>A</given-names></name><name><surname>Burak</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An efficient coding theory for a dynamic trajectory predicts non-uniform allocation of entorhinal grid cells to modules</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005597</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005597</pub-id><pub-id pub-id-type="pmid">28628647</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Kubie</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>The effects of changes in the environment on the spatial firing of hippocampal complex-spike cells</article-title><source>The Journal of Neuroscience</source><volume>7</volume><fpage>1951</fpage><lpage>1968</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.07-07-01951.1987</pub-id><pub-id pub-id-type="pmid">3612226</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Obenhaus</surname> <given-names>HA</given-names></name><name><surname>Rose</surname> <given-names>T</given-names></name><name><surname>Zong</surname> <given-names>W</given-names></name><name><surname>Tsao</surname> <given-names>A</given-names></name><name><surname>Donato</surname> <given-names>F</given-names></name><name><surname>Høydal</surname> <given-names>Ø</given-names></name><name><surname>Goltstein</surname> <given-names>A</given-names></name> <name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Chen</surname> <given-names>PM</given-names></name><name><surname>Cheng</surname> <given-names>L</given-names></name><name><surname>Moser</surname> <given-names>EHI</given-names></name><name><surname>Bonhoeffer</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><chapter-title>Miniaturized two-photon microscopy enables the study of functional network topography in the medial entorhinal cortex</chapter-title><source>Program No. 689.06. 2018 Neuroscience Meeting Planner</source><publisher-loc>San Diego</publisher-loc><publisher-name>Society for Neuroscience</publisher-name></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ocko</surname> <given-names>SA</given-names></name><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Emergent elasticity in the neural code for space</article-title><source>PNAS</source><volume>115</volume><fpage>E11798</fpage><lpage>E11806</lpage><pub-id pub-id-type="doi">10.1073/pnas.1805959115</pub-id><pub-id pub-id-type="pmid">30482856</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>O’Keefe</surname> <given-names>J</given-names></name><name><surname>Nadel</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1978">1978</year><source>The Hippocampus as a Cognitive Map</source><publisher-name>Oxford University Press</publisher-name></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastalkova</surname> <given-names>E</given-names></name><name><surname>Itskov</surname> <given-names>V</given-names></name><name><surname>Amarasingham</surname> <given-names>A</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Internally generated cell assembly sequences in the rat hippocampus</article-title><source>Science</source><volume>321</volume><fpage>1322</fpage><lpage>1327</lpage><pub-id pub-id-type="doi">10.1126/science.1159775</pub-id><pub-id pub-id-type="pmid">18772431</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Pollock</surname> <given-names>E</given-names></name><name><surname>Desai</surname> <given-names>N</given-names></name><name><surname>Wei</surname> <given-names>X-x</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dynamic self-organized error-correction of grid cells by border cells</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/385229</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raudies</surname> <given-names>F</given-names></name><name><surname>Brandon</surname> <given-names>MP</given-names></name><name><surname>Chapman</surname> <given-names>GW</given-names></name><name><surname>Hasselmo</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Head direction is coded more strongly than movement direction in a population of entorhinal neurons</article-title><source>Brain Research</source><volume>1621</volume><fpage>355</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1016/j.brainres.2014.10.053</pub-id><pub-id pub-id-type="pmid">25451111</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rowland</surname> <given-names>DC</given-names></name><name><surname>Roudi</surname> <given-names>Y</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Ten years of grid cells</article-title><source>Annual Review of Neuroscience</source><volume>39</volume><fpage>19</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-070815-013824</pub-id><pub-id pub-id-type="pmid">27023731</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sargolini</surname> <given-names>F</given-names></name><name><surname>Fyhn</surname> <given-names>M</given-names></name><name><surname>Hafting</surname> <given-names>T</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name><name><surname>Witter</surname> <given-names>MP</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title><source>Science</source><volume>312</volume><fpage>758</fpage><lpage>762</lpage><pub-id pub-id-type="doi">10.1126/science.1125572</pub-id><pub-id pub-id-type="pmid">16675704</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seelig</surname> <given-names>JD</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neural dynamics for landmark orientation and angular path integration</article-title><source>Nature</source><volume>521</volume><fpage>186</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1038/nature14446</pub-id><pub-id pub-id-type="pmid">25971509</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadlen</surname> <given-names>MN</given-names></name><name><surname>Newsome</surname> <given-names>WT</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Noise, neural codes and cortical organization</article-title><source>Current Opinion in Neurobiology</source><volume>4</volume><fpage>569</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1016/0959-4388(94)90059-0</pub-id><pub-id pub-id-type="pmid">7812147</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Softky</surname> <given-names>WR</given-names></name><name><surname>Koch</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>The highly irregular firing of cortical cells is inconsistent with temporal integration of random EPSPs</article-title><source>The Journal of Neuroscience</source><volume>13</volume><fpage>334</fpage><lpage>350</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.13-01-00334.1993</pub-id><pub-id pub-id-type="pmid">8423479</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Boccara</surname> <given-names>CN</given-names></name><name><surname>Kropff</surname> <given-names>E</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Representation of geometric borders in the entorhinal cortex</article-title><source>Science</source><volume>322</volume><fpage>1865</fpage><lpage>1868</lpage><pub-id pub-id-type="doi">10.1126/science.1166466</pub-id><pub-id pub-id-type="pmid">19095945</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sreenivasan</surname> <given-names>S</given-names></name><name><surname>Fiete</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Grid cells generate an analog error-correcting code for singularly precise neural computation</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1330</fpage><lpage>1337</lpage><pub-id pub-id-type="doi">10.1038/nn.2901</pub-id><pub-id pub-id-type="pmid">21909090</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stensola</surname> <given-names>H</given-names></name><name><surname>Stensola</surname> <given-names>T</given-names></name><name><surname>Solstad</surname> <given-names>T</given-names></name><name><surname>Frøland</surname> <given-names>K</given-names></name><name><surname>Moser</surname> <given-names>MB</given-names></name><name><surname>Moser</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The entorhinal grid map is discretized</article-title><source>Nature</source><volume>492</volume><fpage>72</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1038/nature11649</pub-id><pub-id pub-id-type="pmid">23222610</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Stevens</surname> <given-names>CF</given-names></name><name><surname>Zador</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="1996">1996</year><chapter-title>When is an integrate-and-fire neuron like a poisson neuron?</chapter-title><person-group person-group-type="editor"><name><surname>Touretzky</surname> <given-names>D. S</given-names></name><name><surname>Mozer</surname> <given-names>M. C</given-names></name><name><surname>Hasselmo</surname> <given-names>M. E</given-names></name></person-group><source>Advances in Neural Information Processing Systems</source><volume>8</volume><publisher-name>MIT Press</publisher-name><fpage>103</fpage><lpage>109</lpage></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname> <given-names>JS</given-names></name><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Ranck</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Head-direction cells recorded from the postsubiculum in freely moving rats. I. description and quantitative analysis</article-title><source>The Journal of Neuroscience</source><volume>10</volume><fpage>420</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.10-02-00420.1990</pub-id><pub-id pub-id-type="pmid">2303851</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The head direction signal: origins and sensory-motor integration</article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>181</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.29.051605.112854</pub-id><pub-id pub-id-type="pmid">17341158</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trettel</surname> <given-names>SG</given-names></name><name><surname>Trimper</surname> <given-names>JB</given-names></name><name><surname>Hwaun</surname> <given-names>E</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name><name><surname>Colgin</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Grid cell co-activity patterns during sleep reflect spatial overlap of grid fields during active behaviors</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>609</fpage><lpage>617</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0359-6</pub-id><pub-id pub-id-type="pmid">30911183</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner-Evans</surname> <given-names>D</given-names></name><name><surname>Wegener</surname> <given-names>S</given-names></name><name><surname>Rouault</surname> <given-names>H</given-names></name><name><surname>Franconville</surname> <given-names>R</given-names></name><name><surname>Wolff</surname> <given-names>T</given-names></name><name><surname>Seelig</surname> <given-names>JD</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Angular velocity integration in a fly heading circuit</article-title><source>eLife</source><volume>6</volume><elocation-id>e23496</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23496</pub-id><pub-id pub-id-type="pmid">28530551</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urdapilleta</surname> <given-names>E</given-names></name><name><surname>Si</surname> <given-names>B</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Selforganization of modular activity of grid cells</article-title><source>Hippocampus</source><volume>27</volume><fpage>1204</fpage><lpage>1213</lpage><pub-id pub-id-type="doi">10.1002/hipo.22765</pub-id><pub-id pub-id-type="pmid">28768062</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vágó</surname> <given-names>L</given-names></name><name><surname>Ujfalussy</surname> <given-names>BB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Robust and efficient coding with grid cells</article-title><source>PLOS Computational Biology</source><volume>14</volume><fpage>e1005922</fpage><lpage>e1005928</lpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005922</pub-id><pub-id pub-id-type="pmid">29309406</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>SN</given-names></name><name><surname>Sprekeler</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Learning place cells, grid cells and invariances with excitatory and inhibitory plasticity</article-title><source>eLife</source><volume>7</volume><elocation-id>e34560</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34560</pub-id><pub-id pub-id-type="pmid">29465399</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>X-X</given-names></name><name><surname>Prentice</surname> <given-names>J</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A principle of economy predicts the functional architecture of grid cells</article-title><source>eLife</source><volume>4</volume><elocation-id>e08362</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.08362</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Welinder</surname> <given-names>PE</given-names></name><name><surname>Burak</surname> <given-names>Y</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Grid cells: the position code, neural network models of activity, and the problem of learning</article-title><source>Hippocampus</source><volume>18</volume><fpage>1283</fpage><lpage>1300</lpage><pub-id pub-id-type="doi">10.1002/hipo.20519</pub-id><pub-id pub-id-type="pmid">19021263</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname> <given-names>X</given-names></name><name><surname>Hahnloser</surname> <given-names>RHR</given-names></name><name><surname>Seung</surname> <given-names>HS</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Double-ring network model of the head-direction system</article-title><source>Physical Review E</source><volume>66</volume><elocation-id>041902</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.66.041902</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname> <given-names>K</given-names></name><name><surname>Buice</surname> <given-names>MA</given-names></name><name><surname>Barry</surname> <given-names>C</given-names></name><name><surname>Hayman</surname> <given-names>R</given-names></name><name><surname>Burgess</surname> <given-names>N</given-names></name><name><surname>Fiete</surname> <given-names>IR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1077</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1038/nn.3450</pub-id><pub-id pub-id-type="pmid">23852111</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-06-02112.1996</pub-id><pub-id pub-id-type="pmid">8604055</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.48494.012</object-id><sec id="s8" sec-type="appendix"><title>Readout of the phase velocity</title><p>In this Appendix, we derive the relationship between <inline-formula><mml:math id="inf244"><mml:mi>ω</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>) and the phase velocity <inline-formula><mml:math id="inf245"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) . To simplify the presentation, we consider separately two situations: first, a noise free network, in which the phase velocity is driven by velocity inputs. Second, a module consisting of Poisson spiking neurons where, for simplicity, we set the velocity inputs to be zero. In the latter case the phase velocity is driven by the stochasticity of the neurons participating in the network dynamics. From the derivation it is easily seen that in the general case, and as long as the linearization of the dynamics (forming the basis of the calculation in both cases) is valid, the phase velocity, as well as <inline-formula><mml:math id="inf246"><mml:mi>ω</mml:mi></mml:math></inline-formula> can be expressed as a sum of independent contributions arising from the two sources considered below.</p></sec><sec id="s9" sec-type="appendix"><title>Phase velocity due to velocity inputs</title><p>Consider a single one dimensional module, whose dynamics follow <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>, and whose synaptic connectivity is described by the double ring model, as specified by <xref ref-type="disp-formula" rid="equ8 equ9 equ10">Equations 8-10</xref>. We expand the dynamic equation around a steady state <inline-formula><mml:math id="inf247"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, so that <inline-formula><mml:math id="inf248"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and assume small velocity input <inline-formula><mml:math id="inf249"><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see similar expansion in <xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>). After linearization:<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>and <inline-formula><mml:math id="inf250"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the synaptic input in the steady state <inline-formula><mml:math id="inf251"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The velocity of the phase <inline-formula><mml:math id="inf252"><mml:mi>θ</mml:mi></mml:math></inline-formula> is obtained by projection of <xref ref-type="disp-formula" rid="equ26">Equation 26</xref> on the left eigenvector of <inline-formula><mml:math id="inf253"><mml:mi>K</mml:mi></mml:math></inline-formula> with zero eigenvalue, <inline-formula><mml:math id="inf254"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>). After some algebra we obtain<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Hence, <inline-formula><mml:math id="inf255"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> is proportional to the velocity input <inline-formula><mml:math id="inf256"><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that both <inline-formula><mml:math id="inf257"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf258"><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula> rotate together with the position <inline-formula><mml:math id="inf259"><mml:mi>θ</mml:mi></mml:math></inline-formula> of the activity bump. Thus, <inline-formula><mml:math id="inf260"><mml:mi>α</mml:mi></mml:math></inline-formula> is independent of <inline-formula><mml:math id="inf261"><mml:mi>θ</mml:mi></mml:math></inline-formula>.</p><p>Let us define the <inline-formula><mml:math id="inf262"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> dimensional vector:<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">…</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">…</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf263"><mml:mi>β</mml:mi></mml:math></inline-formula> is a constant, whose value is determined below. The projection of <xref ref-type="disp-formula" rid="equ26">Equation 26</xref> on <inline-formula><mml:math id="inf264"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> results in<disp-formula id="equ31"><label>(31)</label><mml:math id="m31"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi>β</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The second term on the right hand side of <xref ref-type="disp-formula" rid="equ31">Equation 31</xref> vanishes due to the symmetry of <inline-formula><mml:math id="inf265"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to exchange of the right and left sub-populations, the antisymmetry of <inline-formula><mml:math id="inf266"><mml:msub><mml:mi>v</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> to this exchange, and the structure of the matrix <inline-formula><mml:math id="inf267"><mml:mi>W</mml:mi></mml:math></inline-formula>. Using the definition of <inline-formula><mml:math id="inf268"><mml:mi>ω</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), we can write:<disp-formula id="equ32"><label>(32)</label><mml:math id="m32"><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, <xref ref-type="disp-formula" rid="equ31">Equation 31</xref> becomes:<disp-formula id="equ33"><label>(33)</label><mml:math id="m33"><mml:mrow><mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ34"><label>(34)</label><mml:math id="m34"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In <xref ref-type="disp-formula" rid="equ34">Equation 34</xref> we use again the symmetry of <inline-formula><mml:math id="inf269"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to exchange of the right and left sub-populations. We set <inline-formula><mml:math id="inf270"><mml:mi>β</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ30">Equation 30</xref>) such that <inline-formula><mml:math id="inf271"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula>. Using <xref ref-type="disp-formula" rid="equ29">Equation 29</xref> and <xref ref-type="disp-formula" rid="equ34">Equation 34</xref>:<disp-formula id="equ35"><label>(35)</label><mml:math id="m35"><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>From <xref ref-type="disp-formula" rid="equ33">Equation 33</xref> we see that the readout velocity <inline-formula><mml:math id="inf272"><mml:mi>ω</mml:mi></mml:math></inline-formula> is a convolution of <inline-formula><mml:math id="inf273"><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with the filter<disp-formula id="equ36"><label>(36)</label><mml:math id="m36"><mml:mrow><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mi>t</mml:mi><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Combining <xref ref-type="disp-formula" rid="equ28">Equation 28</xref> and <xref ref-type="disp-formula" rid="equ33">Equation 33</xref> we conclude that<disp-formula id="equ37"><label>(37)</label><mml:math id="m37"><mml:mrow><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>*</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Hence, <inline-formula><mml:math id="inf274"><mml:mi>ω</mml:mi></mml:math></inline-formula> is equal to the phase velocity, smoothed over a relatively short time scale set by the synaptic time constant (<inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p></sec><sec id="s10" sec-type="appendix"><title>Phase velocity due to internal noise</title><p>Consider next a single one dimensional module with Poisson spiking neurons, following the dynamics of <xref ref-type="disp-formula" rid="equ22">Equation 22</xref>. In the limit of large firing rates, <xref ref-type="disp-formula" rid="equ22">Equation 22</xref> can be replaced by<disp-formula id="equ38"><label>(38)</label><mml:math id="m38"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf276"><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is a white noise process with <inline-formula><mml:math id="inf277"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:msub><mml:mi>ξ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib8">Burak and Fiete, 2012</xref>). We use a similar expansion as in section <italic>Phase velocity due to velocity inputs</italic> in this Appendix , and project the linearized dynamics on <inline-formula><mml:math id="inf278"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the left null eigenvector of <inline-formula><mml:math id="inf279"><mml:mi>K</mml:mi></mml:math></inline-formula>, to obtain:<disp-formula id="equ39"><label>(39)</label><mml:math id="m39"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>β</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mpadded></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The first term on the right hand side of <xref ref-type="disp-formula" rid="equ39">Equation 39</xref> is the contribution to the phase velocity arising from the velocity inputs, discussed above. From here on we assume that the velocity input vanishes. The only contribution to the phase velocity is then the second term of <xref ref-type="disp-formula" rid="equ39">Equation 39</xref>, originating from the neural stochasticity. In order to relate this term to <inline-formula><mml:math id="inf280"><mml:mi>ω</mml:mi></mml:math></inline-formula>, let us define:<disp-formula id="equ40"><label>(40)</label><mml:math id="m40"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ41"><label>(41)</label><mml:math id="m41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>2</mml:mn></mml:mstyle></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>2</mml:mn></mml:mstyle></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf281"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf282"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula> are the first or last <inline-formula><mml:math id="inf283"><mml:mi>N</mml:mi></mml:math></inline-formula> coordinates of <inline-formula><mml:math id="inf284"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). <xref ref-type="disp-formula" rid="equ39">Equation 39</xref> becomes:<disp-formula id="equ42"><label>(42)</label><mml:math id="m42"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mo>-</mml:mo><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><fig id="app1fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.48494.013</object-id><label>Appendix 1—figure 1.</label><caption><title>Structure of the left null eigenvector.</title><p>(<bold>A</bold>) The left eigenvector of <inline-formula><mml:math id="inf285"><mml:mi>K</mml:mi></mml:math></inline-formula> with zero eigenvalue, <inline-formula><mml:math id="inf286"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (the bump is centered around <inline-formula><mml:math id="inf287"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>), computed numerically. The first <inline-formula><mml:math id="inf288"><mml:mi>N</mml:mi></mml:math></inline-formula> coordinates of <inline-formula><mml:math id="inf289"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (right sub-population) in red, and the last <inline-formula><mml:math id="inf290"><mml:mi>N</mml:mi></mml:math></inline-formula> coordinates of <inline-formula><mml:math id="inf291"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (left sub-population) in blue. (<bold>B</bold>) <inline-formula><mml:math id="inf292"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> (red and blue for the right and left sub-population respectively), and <inline-formula><mml:math id="inf293"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> (yellow, identical for both of the sub-populations), as defined in <xref ref-type="disp-formula" rid="equ41">Equation 41</xref>. The black dashed line represents the firing rate bump of the steady state (unitless for the sake of comparison with <inline-formula><mml:math id="inf294"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-48494-app1-fig1-v2.tif"/></fig><p>Next, we examine the structure of <inline-formula><mml:math id="inf295"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf296"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>. The left and right components of <inline-formula><mml:math id="inf297"><mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> are spatially antisymmetric with respect to the peak of the activity bump, and precisely vanish at the center of the bump (yellow trace in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1B</xref>). The components of <inline-formula><mml:math id="inf298"><mml:msub><mml:mi>v</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> are symmetric (blue and red traces). We note that the Poisson noise is expressed only within the relatively narrow extent of the activity bump (dashed line). Two consequences follow: first, <inline-formula><mml:math id="inf299"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is very small due to the nearly vanishing values of <inline-formula><mml:math id="inf300"><mml:msub><mml:mi>v</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> on the activity bump. Second, the components of <inline-formula><mml:math id="inf301"><mml:msub><mml:mi>v</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> are nearly constant in magnitude along the narrow extent of the bump, but have opposite signs in the left and right sub-populations. This magnitude can be evaluated by rewriting <xref ref-type="disp-formula" rid="equ35">Equation 35</xref> as:<disp-formula id="equ43"><label>(43)</label><mml:math id="m43"><mml:mrow><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>As the magnitude of <inline-formula><mml:math id="inf302"><mml:msub><mml:mi>v</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> is nearly constant along the bump, we conclude from <xref ref-type="disp-formula" rid="equ43">Equation 43</xref> that this magnitude equals approximately <inline-formula><mml:math id="inf303"><mml:mi>β</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf304"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>. Hence, <xref ref-type="disp-formula" rid="equ42">Equation 42</xref> becomes:<disp-formula id="equ44"><label>(44)</label><mml:math id="m44"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We now project the linearized dynamics of <xref ref-type="disp-formula" rid="equ38">Equation 38</xref> on the vector <inline-formula><mml:math id="inf305"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> to obtain:<disp-formula id="equ45"><label>(45)</label><mml:math id="m45"><mml:mrow><mml:mrow><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>ξ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, <inline-formula><mml:math id="inf306"><mml:mi>ω</mml:mi></mml:math></inline-formula> is approximately a convolution of the velocity phase with the exponential filer <inline-formula><mml:math id="inf307"><mml:mi>f</mml:mi></mml:math></inline-formula>, with the synaptic time integration <inline-formula><mml:math id="inf308"><mml:mi>τ</mml:mi></mml:math></inline-formula>. Therefore:<disp-formula id="equ46"><label>(46)</label><mml:math id="m46"><mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>*</mml:mo><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>as in the case of phase velocity due to external inputs.</p></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.48494.014</object-id><sec id="s11" sec-type="appendix"><title>Linear response tensor</title><p>We next wish to understand how our system of coupled modules responds to an external velocity input <inline-formula><mml:math id="inf309"><mml:mrow><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. First, consider two modules, each in one dimension, that follow the dynamics of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>. The synaptic activation vector is now <inline-formula><mml:math id="inf310"><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> dimensional and has the form:<disp-formula id="equ47"><label>(47)</label><mml:math id="m47"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The firing rate of neuron <inline-formula><mml:math id="inf311"><mml:mi>i</mml:mi></mml:math></inline-formula> from module 1 is (<xref ref-type="fig" rid="fig2">Figure 2E</xref>):<disp-formula id="equ48"><label>(48)</label><mml:math id="m48"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>±</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>±</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the total velocity input is <inline-formula><mml:math id="inf312"><mml:mrow><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. A similar equation for the rate <inline-formula><mml:math id="inf313"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is obtained by switching the indices <inline-formula><mml:math id="inf314"><mml:mrow><mml:mn>1</mml:mn><mml:mo>↔</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ48">Equation 48</xref>. The constant<disp-formula id="equ49"><label>(49)</label><mml:math id="m49"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>α</mml:mi></mml:mfrac></mml:mrow></mml:math></disp-formula>is a proportionality factor that could in principle be absorbed into the definition of the coupling strength parameters, but makes the units of the coupling strengths <inline-formula><mml:math id="inf315"><mml:msub><mml:mi>C</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> more convenient. Substitution of <inline-formula><mml:math id="inf316"><mml:mrow><mml:mpadded width="-1.7pt"><mml:mi>d</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> and <xref ref-type="disp-formula" rid="equ37">Equation 37</xref> in <xref ref-type="disp-formula" rid="equ28">Equation 28</xref> yields:<disp-formula id="equ50"><label>(50)</label><mml:math id="m50"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>*</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>*</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mpadded></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>More generally, for <inline-formula><mml:math id="inf317"><mml:mi>m</mml:mi></mml:math></inline-formula> modules:<disp-formula id="equ51"><label>(51)</label><mml:math id="m51"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>*</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover></mml:mpadded></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, the phase velocities are proportional to the external velocity input, plus the velocities of all other modules filtered in time, and coupled by the matrix C. If we assume that the velocity is sufficiently small, that the position can be regarded as fixed within the synaptic time scale, the convolution with the filter <inline-formula><mml:math id="inf318"><mml:mi>f</mml:mi></mml:math></inline-formula> can be omitted (note that the integral of <inline-formula><mml:math id="inf319"><mml:mi>f</mml:mi></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ36">Equation 36</xref> , is equal to unity), and we obtain:<disp-formula id="equ52"><label>(52)</label><mml:math id="m52"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>-</mml:mo><mml:mi>C</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf320"><mml:mi>X</mml:mi></mml:math></inline-formula> is the linear response tensor.</p></sec><sec id="s12" sec-type="appendix"><title>B.1 Two modules</title><p>In the case of two modules and identical self coupling strength <inline-formula><mml:math id="inf321"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> for both modules, we can easily find the eigenvalues <inline-formula><mml:math id="inf322"><mml:msub><mml:mi>X</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:math></inline-formula> and eigenvectors of <inline-formula><mml:math id="inf323"><mml:mi>X</mml:mi></mml:math></inline-formula>. The coupling matrix in this case is:<disp-formula id="equ53"><label>(53)</label><mml:math id="m53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Using <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> we obtain:<disp-formula id="equ54"><label>(54)</label><mml:math id="m54"><mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mo>±</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>±</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The eigenvectors of <inline-formula><mml:math id="inf324"><mml:mi>X</mml:mi></mml:math></inline-formula> are:<disp-formula id="equ55"><label>(55)</label><mml:math id="m55"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>±</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msqrt></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>±</mml:mo><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, the phase motion of the two modules can be represented as:<disp-formula id="equ56"><label>(56)</label><mml:math id="m56"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>+</mml:mo></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>-</mml:mo></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ57"><label>(57)</label><mml:math id="m57"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>θ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>θ</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and<disp-formula id="equ58"><label>(58)</label><mml:math id="m58"><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>b</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>b</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msqrt><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msqrt><mml:mo>⁢</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf325"><mml:msub><mml:mi>θ</mml:mi><mml:mo>±</mml:mo></mml:msub></mml:math></inline-formula> are the joint or relative phases of the modules, respectively. We choose parameters such that <inline-formula><mml:math id="inf326"><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:math></inline-formula> is large and <inline-formula><mml:math id="inf327"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula> is small in order to obtain large joint motion and small relative motion between modules for any external input. Note that <inline-formula><mml:math id="inf328"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> implies that <inline-formula><mml:math id="inf329"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>-</mml:mo></mml:msub><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ56">Equation 56</xref>), and in this case (<xref ref-type="disp-formula" rid="equ57">Equation 57</xref>):<disp-formula id="equ59"><label>(59)</label><mml:math id="m59"><mml:mrow><mml:mrow><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:mo>≈</mml:mo><mml:mpadded width="+1.7pt"><mml:msqrt><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac></mml:msqrt></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Thus, we can set the velocity ratio between modules (namely, the spacing ratio <inline-formula><mml:math id="inf330"><mml:mi>λ</mml:mi></mml:math></inline-formula>), by the ratio of the coupling parameters, using <xref ref-type="disp-formula" rid="equ59">Equation 59</xref>. We choose<disp-formula id="equ60"><label>(60)</label><mml:math id="m60"><mml:mrow><mml:mrow><mml:msqrt><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:msqrt><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We choose <inline-formula><mml:math id="inf331"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> to maintain the same response to coordinated velocity inputs, as in the case of no coupling. Using <xref ref-type="disp-formula" rid="equ54">Equation 54</xref> we see that this requires <inline-formula><mml:math id="inf332"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, which implies<disp-formula id="equ61"><label>(61)</label><mml:math id="m61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>λ</mml:mi></mml:mstyle></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>and<disp-formula id="equ62"><label>(62)</label><mml:math id="m62"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>To obtain small <inline-formula><mml:math id="inf333"><mml:msub><mml:mi>X</mml:mi><mml:mo>-</mml:mo></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf334"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> should be negative, with a large absolute magnitude. Note that a large positive magnitude of <inline-formula><mml:math id="inf335"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, although seems here as a suitable choice, would cause instability of the system (discussed in Appendix D).</p></sec></boxed-text></app><app id="appendix-3"><title>Appendix 3 </title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.48494.015</object-id><sec id="s13" sec-type="appendix"><title>Optimization of the coupling strengths for <italic>m</italic> modules</title><p>We now wish to find appropriate coupling strengths, <inline-formula><mml:math id="inf336"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, in the general case of <inline-formula><mml:math id="inf337"><mml:mi>m</mml:mi></mml:math></inline-formula> modules, while allowing for different self couplings in each module. We optimize <inline-formula><mml:math id="inf338"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as follows.</p><p>Let <inline-formula><mml:math id="inf339"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> be a vector in the direction of the mutual motion of <inline-formula><mml:math id="inf340"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. The ratios of the components of <inline-formula><mml:math id="inf341"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> are the ratios between corresponding grid spacings. We demand that <inline-formula><mml:math id="inf342"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> is an eigenvector of <inline-formula><mml:math id="inf343"><mml:mi>X</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>) with an eigenvalue <inline-formula><mml:math id="inf344"><mml:mi>α</mml:mi></mml:math></inline-formula>. Under this choice, the motion response in the mutual direction is the same as without coupling (where <inline-formula><mml:math id="inf345"><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ52">Equation 52</xref>). Any other eigenvalue of <inline-formula><mml:math id="inf346"><mml:mi>X</mml:mi></mml:math></inline-formula> should be close to zero, such that the motion in any direction, other than the mutual direction, is small.</p><p>Equivalent requirements are that <inline-formula><mml:math id="inf347"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> is an eigenvector of <inline-formula><mml:math id="inf348"><mml:mi>C</mml:mi></mml:math></inline-formula> with eigenvalue , and any other eigenvalue of <inline-formula><mml:math id="inf349"><mml:mi>C</mml:mi></mml:math></inline-formula> has a large magnitude (see <xref ref-type="disp-formula" rid="equ52">Equation 52</xref>). In addition, as discussed below (<italic>Stability conditions</italic>) all the eigenvalues of <inline-formula><mml:math id="inf350"><mml:mi>C</mml:mi></mml:math></inline-formula> must be smaller than unity, which excludes the possibility that they take large positive values. In order to find the optimal coupling parameters we apply the Karush-Kuhn-Tucker theorem with the Lagrangian:<disp-formula id="equ63"><label>(63)</label><mml:math id="m63"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℒ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>ρ</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The first term of the Lagrangian favors negative eigenvalues with large absolute magnitude, whereas the second term, involving <inline-formula><mml:math id="inf351"><mml:mi>m</mml:mi></mml:math></inline-formula> Lagrange multipliers <inline-formula><mml:math id="inf352"><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, enforces the existence of the eigenvector <inline-formula><mml:math id="inf353"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> with eigenvalue . As the coupling magnitudes cannot be infinitely large, we constrain the self couplings by requiring that <inline-formula><mml:math id="inf354"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> , where <inline-formula><mml:math id="inf355"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is a constant. This constraint is enforced by the third term in <xref ref-type="disp-formula" rid="equ63">Equation 63</xref>, where <inline-formula><mml:math id="inf356"><mml:mrow><mml:msub><mml:mi>ζ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>’s are Karush-Kuhn-Tucker multipliers. We thus obtain the equations:<disp-formula id="equ64"><label>(64)</label><mml:math id="m64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ65"><label>(65)</label><mml:math id="m65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ66"><label>(66)</label><mml:math id="m66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ζ</mml:mi><mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>which results in:<disp-formula id="equ67"><label>(67)</label><mml:math id="m67"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msqrt><mml:mi>Q</mml:mi></mml:msqrt></mml:mrow><mml:mo>≡</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mn>0</mml:mn></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>For <inline-formula><mml:math id="inf357"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf358"><mml:mrow><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>λ</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> we obtain a single solution:<disp-formula id="equ68"><label>(68)</label><mml:math id="m68"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which is identical to the solution we found in Appendix B.1.</p><p>For <inline-formula><mml:math id="inf359"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and a given vector <inline-formula><mml:math id="inf360"><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> there are multiple solutions. The general solution follows the equations:<disp-formula id="equ69"><label>(69)</label><mml:math id="m69"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="equ70"><label>(70)</label><mml:math id="m70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>for every <inline-formula><mml:math id="inf361"><mml:mi>μ</mml:mi></mml:math></inline-formula>. As there are <inline-formula><mml:math id="inf362"><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> parameters and <inline-formula><mml:math id="inf363"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> equations to follow, there are <inline-formula><mml:math id="inf364"><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> degrees of freedom in the solution.</p><p>For example, for <inline-formula><mml:math id="inf365"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf366"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, the solutions are the all <inline-formula><mml:math id="inf367"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>’s that obey:<disp-formula id="equ71"><label>(71)</label><mml:math id="m71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ72"><label>(72)</label><mml:math id="m72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ73"><label>(73)</label><mml:math id="m73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>31</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Making the additional choice that only successive modules are coupled yields the solution:<disp-formula id="equ74"><label>(74)</label><mml:math id="m74"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>23</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>23</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where there is a freedom in choosing <inline-formula><mml:math id="inf368"><mml:msub><mml:mi>C</mml:mi><mml:mn>23</mml:mn></mml:msub></mml:math></inline-formula>. In <xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="fig" rid="fig6">Figure 6</xref> we chose <inline-formula><mml:math id="inf369"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>23</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>For general number of modules <inline-formula><mml:math id="inf370"><mml:mi>m</mml:mi></mml:math></inline-formula>, coupling only successive modules leads to a degeneracy of solutions with <inline-formula><mml:math id="inf371"><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> degrees of freedom, since the matrix <inline-formula><mml:math id="inf372"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> includes <inline-formula><mml:math id="inf373"><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> non-vanishing entries and we solve <inline-formula><mml:math id="inf374"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> equations. The remaining degeneracy can be resolved by requiring identical coupling strengths to each module (<inline-formula><mml:math id="inf375"><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>μ</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>) from its neighbors: <inline-formula><mml:math id="inf376"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The solution is then:<disp-formula id="equ75"><label>(75)</label><mml:math id="m75"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋱</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋱</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋱</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋱</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">…</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">…</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf377"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>In principle, other constraints on the coupling strengths can be used instead of the requirement that <inline-formula><mml:math id="inf378"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf379"><mml:mi>μ</mml:mi></mml:math></inline-formula>. For example, limiting the magnitude of all the coupling strengths (<inline-formula><mml:math id="inf380"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula>), instead of only the magnitude of the self couplings, yields solutions with smaller range of allowed parameters (in the case of multiple solutions), but otherwise identical structure. A different possible constraint is of the form <inline-formula><mml:math id="inf381"><mml:mrow><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:math></inline-formula>. This constraint results in a symmetric solution: <inline-formula><mml:math id="inf382"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>∝</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>ρ</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>k</mml:mi></mml:msub></mml:mstyle><mml:msubsup><mml:mi>u</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We prefer the constraint in <xref ref-type="disp-formula" rid="equ63">Equation 63</xref> as we do not see a compelling reason to limit all of the coupling parameters together instead of limiting them separately.</p></sec></boxed-text></app><app id="appendix-4"><title>Appendix 4 </title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.48494.016</object-id><sec id="s14" sec-type="appendix"><title>Stability conditions</title><p>To map the stability conditions of the coupled network, we consider the dynamics of the velocity estimation <inline-formula><mml:math id="inf383"><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ33">Equation 33</xref>). As <xref ref-type="disp-formula" rid="equ33">Equation 33</xref> is obtained by projecting the full dynamics of the network on the vector <inline-formula><mml:math id="inf384"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, stable network would result in finite <inline-formula><mml:math id="inf385"><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>. We substitute the total velocity input <inline-formula><mml:math id="inf386"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mover><mml:mi>I</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>C</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ33">Equation 33</xref> and obtain:<disp-formula id="equ76"><label>(76)</label><mml:math id="m76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mover><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, in order to maintain the stability of <inline-formula><mml:math id="inf387"><mml:mover accent="true"><mml:mi>ω</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula>, as well as the stability of the full network, all eigenvalues of <inline-formula><mml:math id="inf388"><mml:mi>C</mml:mi></mml:math></inline-formula> must be smaller than unity, and all eigenvalues of <inline-formula><mml:math id="inf389"><mml:mi>X</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>) must be positive.</p></sec></boxed-text></app><app id="appendix-5"><title>Appendix 5 </title><boxed-text><object-id pub-id-type="doi">10.7554/eLife.48494.017</object-id><sec id="s15" sec-type="appendix"><title>The coupled network as a single attractor</title><p>In this Appendix we consider the system as a single neural network with recurrent connectivity that includes both the inter- and intra-modular synaptic connections, instead of thinking of the system as composed of <inline-formula><mml:math id="inf390"><mml:mi>m</mml:mi></mml:math></inline-formula> coupled attractors (modules). The derivation of the system dynamics presented here, is necessary in order to calculate the diffusion tensor (<xref ref-type="disp-formula" rid="equ25">Equation 25</xref>). In addition, it offers an alternative approach for obtaining the linear response tensor <inline-formula><mml:math id="inf391"><mml:mi>X</mml:mi></mml:math></inline-formula>, and provides some additional insights on the behaviour of the network.</p><p>We expand the dynamics of <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> around the steady state <inline-formula><mml:math id="inf392"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see similar expansion in Appendix A). Here <inline-formula><mml:math id="inf393"><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> is the vector of represented phases in all modules, where <inline-formula><mml:math id="inf394"><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub></mml:math></inline-formula> is the phase of module <inline-formula><mml:math id="inf395"><mml:mi>μ</mml:mi></mml:math></inline-formula>. The dynamics of neuron <inline-formula><mml:math id="inf396"><mml:mi>i</mml:mi></mml:math></inline-formula> from module <inline-formula><mml:math id="inf397"><mml:mi>μ</mml:mi></mml:math></inline-formula> (for simplicity, we assume one dimensional modules) can be written as:<disp-formula id="equ77"><label>(77)</label><mml:math id="m77"><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>±</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the sign ± is + () if neuron <inline-formula><mml:math id="inf398"><mml:mi>i</mml:mi></mml:math></inline-formula> belongs to a right (left) sub-population. Here, <inline-formula><mml:math id="inf399"><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> is a <inline-formula><mml:math id="inf400"><mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> matrix:<disp-formula id="equ78"><label>(78)</label><mml:math id="m78"><mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>B</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋯</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>B</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi/></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">…</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf401"><mml:mrow><mml:mi>K</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined in <xref ref-type="disp-formula" rid="equ27">Equation 27</xref>, and<disp-formula id="equ79"><label>(79)</label><mml:math id="m79"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">…</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋱</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">⋮</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>N</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:mi mathvariant="normal">…</mml:mi></mml:mtd><mml:mtd columnalign="center"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mi>N</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>As the system is a continuous attractor of dimension <inline-formula><mml:math id="inf402"><mml:mi>m</mml:mi></mml:math></inline-formula>, there exist <inline-formula><mml:math id="inf403"><mml:mi>m</mml:mi></mml:math></inline-formula> left eigenvectors of <inline-formula><mml:math id="inf404"><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> with zero eigenvalue, <inline-formula><mml:math id="inf405"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which we compute numerically. The diffusion tensor is computed in <xref ref-type="disp-formula" rid="equ25">Equation 25</xref>, using these vectors <inline-formula><mml:math id="inf406"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>By projecting <xref ref-type="disp-formula" rid="equ77">Equation 77</xref> on <inline-formula><mml:math id="inf407"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mi>μ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> we obtain the linear response tensor <inline-formula><mml:math id="inf408"><mml:mi>X</mml:mi></mml:math></inline-formula>, such that <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> is valid. Explicitly:<disp-formula id="equ80"><label>(80)</label><mml:math id="m80"><mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where,<disp-formula id="equ81"><label>(81)</label><mml:math id="m81"><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mpadded width="+1.7pt"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>left</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>right</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mpadded></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and <inline-formula><mml:math id="inf409"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> means that the <inline-formula><mml:math id="inf410"><mml:mi>i</mml:mi></mml:math></inline-formula>th neuron belongs to module <inline-formula><mml:math id="inf411"><mml:mi>ρ</mml:mi></mml:math></inline-formula>. Using this approach numerically, yields nearly identical results as <xref ref-type="disp-formula" rid="equ52">Equation 52</xref>.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.48494.019</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Palmer</surname><given-names>Stephanie</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Hermundstad</surname><given-names>Ann M</given-names></name><role>Reviewer</role><aff><institution>Howard Hughes Medical Institute</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Velocity coupling of grid modules enables stable embedding of a low dimensional variable in a high dimensional attractor&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Laura Colgin as the Senior Editor. The following individual involved in review of your submission has agreed to reveal her identity: Ann M Hermundstad (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This paper develops a model in which grid modules are formed by a standard attractor mechanism, and are also coupled together by recurrent interactions to coordinate stochastic drift (caused by noisy velocity inputs and/or spiking noise) between the modules. Independent drift in grid modules would severely impair the fidelity of their spatial representation (as is shown elegantly in this work), so that if grid cells represent space, it is critical to coordinate the drift in modules. The authors show that a simple mechanism – excitatory interaction between modules – can solve this problem, and suggest experimental tests of the theory. In particular, the theory makes interesting predictions arising from the inactivation of a subset of the modules (e.g. self-motion integration in the remaining modules should be affected in a specific way).</p><p>Essential revisions:</p><p>1) The choice of readout mechanisms might affect the results – hence this key aspect should be better explored.</p><p>2) The system's performance and error should be better characterized – as these are the main observables used to draw conclusions about the effectiveness of the proposed model.</p><p>Specific points concerning these first two essential revisions (followed by more essential revisions below):</p><p>a) It would be good to provide further intuition on the structure of the C_ij that achieved &quot;satisfactory&quot; performance. In particular, even if one constrains the coupling to lie between neighboring modules, the structure of the C_ij was not entirely clear. Is it all-to-all? Does this coupling vary in any interesting way with separation on the neural sheet? Can this coupling be constrained to be somewhat local on the neural sheet and still achieve good results?</p><p>b) The manuscript's main argument is that small differences in the phases of individual modules can lead to large errors in the estimate of position that is read out from these modules; by choosing the appropriate coupling between modules, one can reduce deviations in the phases between different modules, and in turn reduce the frequency of large readout errors. It appears that the existence and degree of these discontinuities is due at least in part to the choice of readout. As argued in the framing of the paper and shown in Figures 4D, 5B, these discontinuities are not present in the phases of individual modules, but rather arise in the readout stage. These discontinuities occur within a single timestep (at least as far as one can tell from Figure 5B), suggesting that a readout with a slightly longer timescale could potentially alleviate some of these errors. The form of the readout was derived by the same authors in a previous paper; in that paper, it was shown that the optimal readout should have different timescales for grid modules with different spacings, ranging from 1ms to 600ms. However, here a readout with a single timescale of 10ms was chosen for all modules. Based on this previous work, it's not clear why this choice was made, and what implications this has for the extent of readout errors that are shown in Figure 5B. To make the strongest argument possible, an optimal version of the readout should be used (with appropriately-chosen timescales for different modules) in order to construct the strongest null model in the absence of coupling. As it is now, it's unclear whether the observed readout errors arise from the construction of readout itself, rather than the lack of couplings. Given that this is the primary argument for necessitating couplings between modules, this should be addressed.</p><p>c) The paper would be stronger if the analyses provided a better characterization of performance and error. As it's written now, it's difficult to gain an intuition as to why catastrophic errors are occurring when they do, and how much gradual error is accumulated between these catastrophic errors. There are some small fixes that could help (see minor points). Beyond these, there are some larger points that could be made more clear. Why does the first catastrophic error occur when it does (i.e., what is the significance of the timescale marked by the dotted line in Figure 5C-D)? This timescale might have been expected to relate to the distance that must be traveled before the three grid spacings are likely to overlap, given the scale of the noise; is this the case? If so, one would have expected a sharper drop off in the percentage of successes in Figure 5C. If not, is there an intuition as to why the errors occur when they do? Does gradual drift accumulate much more rapidly in the uncoupled model that in the coupled model? This itself is interesting and would be valuable to quantify.</p><p>d) Finally, how does performance scale with the number of modules? A general theoretical model was derived for m modules but results are shown for only 2 and 3 modules (and because these two cases were illustrated in one and two dimensions, respectively, it's not possible to compare directly between them). Larger numbers of modules could presumably lead to a couple of different scenarios that might impact the conclusions in different ways: i) more modules could lead to a reduction in readout errors (even in the absence of coupling), because the readout is averaging over inconsistencies among modules; this would suggest that some of observed error could be alleviated with additional modules, or ii) more modules could lead to an increase in readout errors via the additional inter-module recurrence (e.g. in cases where assumptions about linearity or small input velocity break down). It would be useful to report more on these type of analyses and show how they depend on the source/magnitude of noise. Can these findings be interpreted in terms of the actual numbers of modules in mEC (which would be helpful to report somewhere)?</p><p>3) Provide, in the main text, more details/intuition about the choice of inter- and intra-module couplings, which is indeed a fundamental aspect of the work. (See also point 1 and 2a above.)</p><p>A key point of the theory is that modules should be coupled in a phase-independent manner, and that the coupling should only depend on the rate of change of the phase. There are two things that could be shown, perhaps in Figure 1 and incorporated into Figure 2:</p><p>– show the detrimental effect of phase-dependent coupling for position encoding</p><p>– recap the properties of self-motion integration networks (e.g. Seung's model used throughout the paper), showing the velocity dependent tuning of the left and right network and how a simple set of synaptic weights between modules can extract this information.</p><p>4) Discuss the role of landmarks (e.g. boundaries) in path integration – this important aspect did not receive enough attention throughout the manuscript.</p><p>For example, the section on &quot;Intrinsic neural noise&quot; shows how the coupling between modules coordinates their drift. An alternate idea might have been to largely shut down the drift via interaction with border cells (or more generally with boundaries and landmarks). A comment on this alternative would be in order in the Results and in the Discussion since there has been a good bit of work on it lately. These kinds of error correction mechanisms that people have considered so far still work separately on each module, and so a coordination mechanism such as the one in the present paper will still be necessary because even a small amount of independent drift between modules can cause problems with the spatial representation.</p><p>5) An additional figure should be added at the end of the paper, illustrating the non-trivial prediction related to the inactivation of one or more grid cell modules. This would help make the work for broadly accessible, and would strengthen the discussion.</p><p>6) Discuss the possibility that other (published) mechanisms might be at work for the self-organized emergence of modular structure (which is otherwise assumed in the current manuscript).</p><p>In particular, a potential overlap is with recent work on the role of interactions with borders and landmarks in anchoring and reducing drift in the grid system (e.g. Keinath et al., <italic>eLife</italic>; Ocko et al., PNAS; Hardcastle et al., Neuron; Pollock et al., bioRxiv). The present paper is complementary in that it suggests a way of coordinating drift between modules, rather than reducing the overall amount of the drift. Indeed the border interaction mechanisms may not reduce drift enough on their own, and the coordination mechanism described in the present paper may be necessary also – both mechanisms could be in play. Some commentary would be worthwhile in the Discussion as an interesting direction for the future is to ask how border interactions and inter-module interactions could work together.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.48494.020</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The choice of readout mechanisms might affect the results – hence this key aspect should be better explored.</p><p>2) The system's performance and error should be better characterized – as these are the main observables used to draw conclusions about the effectiveness of the proposed model.</p><p>Specific points concerning these first two essential revisions (followed by more essential revisions below):</p><p>a) It would be good to provide further intuition on the structure of the C_ij that achieved &quot;satisfactory&quot; performance. In particular, even if one constrains the coupling to lie between neighboring modules, the structure of the C_ij was not entirely clear. Is it all-to-all? Does this coupling vary in any interesting way with separation on the neural sheet? Can this coupling be constrained to be somewhat local on the neural sheet and still achieve good results?</p></disp-quote><p>There are two different ways in which the term ‘all-to-all connectivity’ can be used in relation to our work: one context is when considering how two modules are coupled: every neuron in one module is coupled to every neuron in the other module. A second context has to do with the coupling strengths between modules, quantified byCμρ. We focus first on. Cμρ</p><p>The optimization goal that we formulated (Equation 63 and surrounding text) involves only the diagonal elements of the matrix <italic>C</italic>, so it does not determine the non-diagonal elements. Consequently, the optimization yields <italic>m</italic> equations, one for each element on the diagonal. The non-diagonal elements, together with the diagonal elements, are constrained by another set of <italic>m</italic> equations, stating that u→ is a null eigenvector of <italic>C</italic>. Since the number of parameters in <italic>C</italic> is quadratic in m, whereas the number of equations is linear, the solution is highly degenerate for anym&gt;2. This degeneracy means that our optimization procedure cannot determine the structure ofCμρ, but we can seek solutions with additional properties. General solutions involve all-to-all connectivity between modules, but we have chosen to work with a solution in which modules are only coupled to their adjacent modules. This is motivated by the fact that there is evidence for topographic organization of modules on the cortical sheet, and for a limited range of excitatory connections within the MEC (see Discussion). Thus, a solution in which the connectivity is only between adjacent modules may be more compatible (compared to other solutions) with what is currently known about the anatomy. However, the data is not yet conclusive on these questions.</p><p>We now write in detail (Appendix 3) the solution for <italic>m</italic> modules, and explicitly discuss the degeneracy of the solution. We then explicitly provide the matrix <italic>C</italic> obtained under the additional restriction that only adjacent modules are coupled (Equation 75).</p><p>When considering the coupling between neurons in any two modules, the connectivity is all-to-all in the sense that every neuron in one module is synaptically coupled to every neuron in the other module (assuming that the corresponding Cμρ is non-vanishing). This form of connectivity is central to our proposal, as it entails complete symmetry to shifts in positions of the activity bumps in the two modules. The symmetry ensures that the set of steady states will involve any combination of bump positions, thereby preserving the large capacity of the code. This is now clarified in subsection “Coupling modules by synaptic connectivity”.</p><disp-quote content-type="editor-comment"><p>b) The manuscript's main argument is that small differences in the phases of individual modules can lead to large errors in the estimate of position that is read out from these modules; by choosing the appropriate coupling between modules, one can reduce deviations in the phases between different modules, and in turn reduce the frequency of large readout errors. It appears that the existence and degree of these discontinuities is due at least in part to the choice of readout. As argued in the framing of the paper and shown in Figures 4D, 5B, these discontinuities are not present in the phases of individual modules, but rather arise in the readout stage. These discontinuities occur within a single timestep (at least as far as one can tell from Figure 5B), suggesting that a readout with a slightly longer timescale could potentially alleviate some of these errors. The form of the readout was derived by the same authors in a previous paper; in that paper, it was shown that the optimal readout should have different timescales for grid modules with different spacings, ranging from 1ms to 600ms. However, here a readout with a single timescale of 10ms was chosen for all modules. Based on this previous work, it's not clear why this choice was made, and what implications this has for the extent of readout errors that are shown in Figure 5B. To make the strongest argument possible, an optimal version of the readout should be used (with appropriately-chosen timescales for different modules) in order to construct the strongest null model in the absence of coupling. As it is now, it's unclear whether the observed readout errors arise from the construction of readout itself, rather than the lack of couplings. Given that this is the primary argument for necessitating couplings between modules, this should be addressed.</p></disp-quote><p>The decoder that we use in the present manuscript was developed in Mosheiff et al., 2017, and its MSE in each module was quantified as a function of the time scale of readout. The reason why we used a time scale of 10 ms is that with the parameters that we use in the present work (see below), the optimal time scale for readout is very short (smaller than 1ms in all three modules), whereas readout on a time scale of 10 ms seems more easy to implement biologically.</p><p>The comment above raises an interesting concern, that the time scale of readout might influence the rate at which catastrophic readout errors occur, and thereby significantly influence the MSE of readout. To address this question, we repeated the analysis with different readout time scales, both shorter and longer than 10ms (1ms, 10ms, and 100ms). The results are shown in a new supporting figure (Figure 5—figure supplement 1), and discussed briefly in paragraph three of subsection “Consequences for spatial representation and readout”. We find that the time scale of readout has very little influence on occurrence of catastrophic readout errors (Figure 5—figure supplement 1A), or on the qualitative behavior of the MSE curves (Figure 5—figure supplement 1B). Therefore, the choice of the readout time scale is not essential in the context of the present work.</p><p>The main goal of Mosheiff et al., 2017 was to propose a normative explanation for a trend seen in the experimental data (Stensola et al., 2012), according to which modules with larger spacing appear to include a smaller number of neurons. However, it is not yet clear whether this trend is representative of the true distribution of cells in the MEC, or whether it was a result of an experimental bias. We think that in the present work, that addresses different questions, it makes more sense to make the simple choice of identical number of neurons in each module, which is why the optimal time scales for readout are small in all modules.</p><disp-quote content-type="editor-comment"><p>c) The paper would be stronger if the analyses provided a better characterization of performance and error. As it's written now, it's difficult to gain an intuition as to why catastrophic errors are occurring when they do, and how much gradual error is accumulated between these catastrophic errors. There are some small fixes that could help (see minor points). Beyond these, there are some larger points that could be made more clear. Why does the first catastrophic error occur when it does (i.e., what is the significance of the timescale marked by the dotted line in Figure 5C-D)? This timescale might have been expected to relate to the distance that must be traveled before the three grid spacings are likely to overlap, given the scale of the noise; is this the case? If so, one would have expected a sharper drop off in the percentage of successes in Figure 5C. If not, is there an intuition as to why the errors occur when they do? Does gradual drift accumulate much more rapidly in the uncoupled model that in the coupled model? This itself is interesting and would be valuable to quantify.</p></disp-quote><p>We added a panel in Figure 4F, quantifying how relative errors between modules accumulate over time, averaged over multiple trials. The parameters are the same as those used in Figure 5. This panel is discussed in paragraph five of subsection “Generalization to two dimensions and several modules”.</p><p>The role of the vertical dotted line in Figures 5C-D is to point out the strong relationship between large MSE and the occurrence of catastrophic readout errors. However, the time at which the first catastrophic error occurs depends not only on dynamic properties of the system, but also on the number of simulations performed: in our case, it roughly corresponds to the time at which the probability for occurrence of a catastrophic error is of order 1%, since we ran 100 simulations. To the left of the dashed line the probability to have a catastrophic error does not vanish, it’s simply very small. This is now clarified in the text (paragraph three subsection “Consequences for spatial representation and readout”).</p><p>Catastrophic errors due to relative phase shifts have been extensively discussed in the literature by us and others (Fiete et al., 2008, Wellinder et al., 2008, Sreenivasan and Fiete, 2011, Burak, 2014, Vágó and Ujfalussy, 2018). However these works focused on the capacity of the code and its resolution. A quantitative analysis of the probability for occurrence of catastrophic readout errors, and how this probability scales with various parameters, has not been achieved. We feel that this question is interesting but lies outside the scope of our manuscript for two main reasons:</p><p>1. There is no question that these errors are highly detrimental (see citations mentioned above).</p><p>2. Our goal is to propose a mechanism that mitigates these errors, and we demonstrate clearly that our proposed mechanism achieves this goal.</p><p>As a basic and rough argumentation, it seems reasonable that in order for a catastrophic readout error to occur, relative phase shifts between modules should become significant compared to unity. Based on the new panel (Figure 4F), it is possible to see that when catastrophic errors started to appear in Figure 5C, the standard deviation of phase shifts was of order 0.15 (MSD ~ 0.025), and there was already a small but appreciable probability for relative phase shifts to become of order unity.</p><p>However, based on previous works (Fiete et al., 2008, Vágó and Ujfalussy, 2018), it should be clear that the probability for a catastrophic readout must depend in a complicated manner on other factors such as the precise grid spacings, the number of modules and the size of the arena. The new supporting figure (Figure 5—figure supplement 2) demonstrates some of this complexity.</p><p>We added a paragraph in the Discussion section (paragraph three) addressing some of the points raised above.</p><p>Regarding the last question: we added a quantification of the mean square error relative to the true trajectory, Figure 4G. In the coupled system, Noise in the three modules is effectively projected on the direction corresponding to joint motion, which is equivalent to averaging the noise injected to each module individually. The mean square error accumulated in each module individually is thus expected to be smaller by a factor of <italic>m</italic> in the case of coupled modules, compared to the uncoupled case, in agreement with our numerical results. We explain this in paragraph five of subsection “Generalization to two dimensions and several modules”.</p><disp-quote content-type="editor-comment"><p>d) Finally, how does performance scale with the number of modules? A general theoretical model was derived for m modules but results are shown for only 2 and 3 modules (and because these two cases were illustrated in one and two dimensions, respectively, it's not possible to compare directly between them). Larger numbers of modules could presumably lead to a couple of different scenarios that might impact the conclusions in different ways: i) more modules could lead to a reduction in readout errors (even in the absence of coupling), because the readout is averaging over inconsistencies among modules; this would suggest that some of observed error could be alleviated with additional modules, or ii) more modules could lead to an increase in readout errors via the additional inter-module recurrence (e.g. in cases where assumptions about linearity or small input velocity break down). It would be useful to report more on these type of analyses and show how they depend on the source/magnitude of noise. Can these findings be interpreted in terms of the actual numbers of modules in mEC (which would be helpful to report somewhere)?</p></disp-quote><p>We agree that this is an interesting question. The actual number of grid cell modules in the brains of rats and mice is unknown, and so far there is direct evidence for the existence of four modules.</p><p>We added a supporting figure (Figure 5—figure supplement 2) with several panels that show how the probability for catastrophic errors, and the MSE, evolve in time when the number of modules is increased. We find that increasing the number of modules reduces the probability for catastrophic errors, in accordance with the intuition described above under scenario i). In interpreting these figures, however, it is important to keep in mind that the size of the environment is important. Increasing the number of modules leads to an increase in the range of positions that can be represented unambiguously. Therefore, when comparing the rate of catastrophic readout errors across systems that differ in the number of modules, one has to decide whether to keep the size of environment fixed, or increase it to reflect the increased capacity. Increasing the size of the environment goes hand-in-hand with an increase in the probability for catastrophic errors, since the larger environment includes a larger set of positions whose representation by the grid phases might be confused with the true position. This is demonstrated in panels E-J in Figure 5—figure supplement 2.</p><p>In fact, spatial coding and memory maintenance in the entorhinal-hippocampal system may require resilience to an even broader range of errors than those associated with confusion between two positions in any given environment. An error in module phases, accumulated during foraging in the absence of sensory cues, might lead to a combination of phases that matches a position in a different spatial map (representing a different environment), more than any position in the present map.</p><p>The main goal of the examples shown in Figure 5 and the new Figure 5—figure supplement 2 is not to systematically analyze the effect of catastrophic errors. The goal is to demonstrate that these effects are highly detrimental over a broad range of parameters, and that the coupling mechanism proposed in our work dramatically reduces these detrimental effects.</p><p>We briefly discuss Figure 5—figure supplement 2 in the text (paragraph four of subsection “Consequences for spatial representation and readout”), and have added a paragraph in the Discussion section addressing some of the issues raised above (paragraph four).</p><disp-quote content-type="editor-comment"><p>3) Provide, in the main text, more details/intuition about the choice of inter- and intra-module couplings, which is indeed a fundamental aspect of the work. (See also point 1 and 2a above.)</p><p>A key point of the theory is that modules should be coupled in a phase-independent manner, and that the coupling should only depend on the rate of change of the phase. There are two things that could be shown, perhaps in Figure 1 and incorporated into Figure 2:</p><p>– show the detrimental effect of phase-dependent coupling for position encoding</p><p>– recap the properties of self-motion integration networks (e.g. Seung's model used throughout the paper), showing the velocity dependent tuning of the left and right network and how a simple set of synaptic weights between modules can extract this information.</p></disp-quote><p>We added to Figure 1 a schematic illustration of two phase-coupled gears (panel C), and included a short explanation inside the figure caption on why this scheme is unfavorable from the point of view of capacity. We refer to this point also in paragraph six of the Introduction.</p><p>We also added a panel to Figure 2 (panel B), illustrating the difference in activity in the left and right bumps as the source of motion along the attractor, and expanded the text in the caption to explain how the double ring model works. Note that the section after Equation 3 in the main text also explain the mechanism of velocity integration in the double ring model.</p><p>The readout mechanism that we propose to each module’s velocity is derived and discussed extensively in Appendix 1. We now also explain in the main text (paragraph two of subsection “Coupling modules by synaptic connectivity”) and in the Materials and methods section (after Equation 13) in more detail the structure of synaptic connectivity that injects this readout velocity (as read out from each module) as input to the other modules.</p><disp-quote content-type="editor-comment"><p>4) Discuss the role of landmarks (e.g. boundaries) in path integration – this important aspect did not receive enough attention throughout the manuscript.</p><p>For example, the section on &quot;Intrinsic neural noise&quot; shows how the coupling between modules coordinates their drift. An alternate idea might have been to largely shut down the drift via interaction with border cells (or more generally with boundaries and landmarks). A comment on this alternative would be in order in the Results and in the Discussion since there has been a good bit of work on it lately. These kinds of error correction mechanisms that people have considered so far still work separately on each module, and so a coordination mechanism such as the one in the present paper will still be necessary because even a small amount of independent drift between modules can cause problems with the spatial representation.</p></disp-quote><p>This is an important point which was addressed in our initial submission only indirectly, by highlighting the significance of coupling under conditions in which sensory cues are absent. We added a paragraph in the Discussion section (paragraph six), in which we comment on the role of boundaries in this context, and cite recent related work. We also briefly mention the possible role of encounters with the walls as a means for updating the spatial representation in paragraph four of subsection “Generalization to two dimensions and several modules”.</p><disp-quote content-type="editor-comment"><p>5) An additional figure should be added at the end of the paper, illustrating the non-trivial prediction related to the inactivation of one or more grid cell modules. This would help make the work for broadly accessible, and would strengthen the discussion.</p></disp-quote><p>Thanks for this suggestion. We added a figure (Figure 4—figure supplement 1) showing the rate maps of individual neurons from three modules after disconnecting module 1 from the other modules. We refer to this figure in subsection “Experimental predictions”.</p><disp-quote content-type="editor-comment"><p>6) Discuss the possibility that other (published) mechanisms might be at work for the self-organized emergence of modular structure (which is otherwise assumed in the current manuscript).</p></disp-quote><p>See added text and citation in paragraph seven of the Discussion.</p><disp-quote content-type="editor-comment"><p>In particular, a potential overlap is with recent work on the role of interactions with borders and landmarks in anchoring and reducing drift in the grid system (e.g. Keinath et al., eLife; Ocko et al., PNAS; Hardcastle et al., Neuron; Pollock et al., bioRxiv). The present paper is complementary in that it suggests a way of coordinating drift between modules, rather than reducing the overall amount of the drift. Indeed the border interaction mechanisms may not reduce drift enough on their own, and the coordination mechanism described in the present paper may be necessary also – both mechanisms could be in play. Some commentary would be worthwhile in the Discussion as an interesting direction for the future is to ask how border interactions and inter-module interactions could work together.</p></disp-quote><p>See the paragraph six in the Discussion.</p></body></sub-article></article>