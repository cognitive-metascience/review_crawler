<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">51004</article-id><article-id pub-id-type="doi">10.7554/eLife.51004</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Advance</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Rank orders and signed interactions in evolutionary biology</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-86268"><name><surname>Crona</surname><given-names>Kristina</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1819-474X</contrib-id><email>kcrona@american.edu</email><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution content-type="dept">Mathematics and Statistics</institution><institution>American University</institution><addr-line><named-content content-type="city">Washington DC</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Krug</surname><given-names>Joachim</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cologne</institution><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Tautz</surname><given-names>Diethard</given-names></name><role>Senior Editor</role><aff><institution>Max-Planck Institute for Evolutionary Biology</institution><country>Germany</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>14</day><month>01</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e51004</elocation-id><history><date date-type="received" iso-8601-date="2019-08-14"><day>14</day><month>08</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-01-05"><day>05</day><month>01</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Crona</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Crona</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-51004-v2.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="article-reference" xlink:href="10.7554/eLife.28629"/><abstract><p>Rank orders have been studied in evolutionary biology for almost a hundred years. Constraints on the order in which mutations accumulate are known from cancer drug treatment, and order constraints for species invasions are important in ecology. However, current theory on rank orders in biology is somewhat fragmented. Here, we show how our previous work on inferring genetic interactions from comparative fitness data (Crona et al., 2017) is related to an influential approach to rank orders based on sign epistasis. Our approach depends on order perturbations that indicate interactions. We apply our results to malaria parasites and find that order perturbations beyond sign epistasis are prevalent in the antimalarial drug-resistance landscape. This finding agrees with the observation that reversed evolution back to the ancestral type is difficult. Another application concerns the adaptation of bacteria to a methanol environment.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>epistasis</kwd><kwd>sign epistasis</kwd><kwd>evolutionary predictability</kwd><kwd>rank orders</kwd><kwd>malaria</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><funding-statement>No external funding was received for this work</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Rectangular order perturbations generalize sign epistasis, capture global aspects of fitness landscapes, and clarify how rank order approaches relate.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Rank orders of genotypes with respect to fitness are central in evolutionary biology. Key concepts, such as peaks and mutational trajectories, refer to an underlying rank order. The impact of suboptimal peaks has been discussed ever since fitness landscapes were introduced (<xref ref-type="bibr" rid="bib25">Wright, 1932</xref>). A major advantage with rank orders, as compared to other statistics for fitness landscape, is that order data is robust for variation in experimental methods and measurements. In fact, one does not necessarily need to measure fitness at all. If a rank order can be established by a competition experiment or by any type of rank order preserving fitness proxy, then one can apply theory on rank orders. Results from different empirical studies can therefore be compared; fitness or log-fitness, radius or area, change per minute or generation, makes no difference if rank orders are considered.</p><p>The concept of sign epistasis introduced by <xref ref-type="bibr" rid="bib24">Weinreich et al. (2005)</xref>, has been important for recent work on rank orders in evolutionary biology (<xref ref-type="bibr" rid="bib14">Kaznatcheev, 2019</xref>; <xref ref-type="bibr" rid="bib8">Crona et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Wu et al., 2016</xref>; <xref ref-type="bibr" rid="bib10">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib7">Crona et al., 2013</xref>; <xref ref-type="bibr" rid="bib20">Poelwijk et al., 2011</xref>). A system has sign epistasis if the sign of the effect of a mutation, whether positive or negative, depends on genetic background. The graphs in <xref ref-type="fig" rid="fig1">Figure 1</xref> illustrate the absence of sign epistasis (A), sign epistasis (B), and reciprocal sign epistasis (C) for two-locus systems. Each arrow points toward the genotype of higher fitness. The importance of rank order data for two-locus subsystems is that they carry information about global aspects of fitness landscapes, and therefore about long-term evolution. For instance, all multi-peaked fitness landscapes have reciprocal sign epistasis (<xref ref-type="bibr" rid="bib20">Poelwijk et al., 2011</xref>). Conversely, if subsystems of type C exist, but no systems of type B, then the landscape is multi-peaked (<xref ref-type="bibr" rid="bib7">Crona et al., 2013</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>The graphs illustrate (<bold>A</bold>) no sign epistasis, (<bold>B</bold>) sign epistasis, and (<bold>C</bold>) reciprocal sign epistasis.</title><p>The peaks are marked red. Under the assumption that 00 has minimal fitness, and that the genotypes are positioned as in the figure, the three types can be characterized as graphs with no arrows down, one arrow down, or two arrows down.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51004-fig1-v2.tif"/></fig><p>The squares representing a two-locus subsystem (see the orange square in <xref ref-type="fig" rid="fig2">Figure 2</xref>) are clearly informative. However larger rectangles can improve the precision of the analysis. Each arrow in <xref ref-type="fig" rid="fig2">Figure 2</xref> points toward the genotype of higher fitness. The undirected edges connect mutational neighbors, that is genotypes that differ at one locus only. The blue rectangles in <xref ref-type="fig" rid="fig2">Figure 2</xref> concern replacements of the type <inline-formula><mml:math id="inf1"><mml:mrow><mml:mn>00</mml:mn><mml:mo>↦</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula> for the second and third loci. If the sign of the effect of such a replacement depends on background, then the long arrows have different directions (<xref ref-type="fig" rid="fig2">Figure 2</xref>B and D). Such a perturbation is similar to sign epistasis, except that two loci are replaced.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Each arrow points toward the genotype of higher fitness.</title><p>The undirected edges connect mutational neighbors and carry no information about fitness differences. The graph 2A is compatible with additive fitness. The other graphs are not compatible with additive fitness because at least one pair of parallel arrows point in different directions. The lower graphs indicate sign epistasis, as is clear from the short arrows. The right graphs indicate size two perturbations, as is clear from the long arrows.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51004-fig2-v2.tif"/></fig><p>We propose a broader perspective on perturbations, that takes advantage of all rectangles in the cube (or hypercube). Differently expressed, in addition to single mutations it is sometimes useful to consider the effects of double mutations and any higher order mutations, as well as replacements <inline-formula><mml:math id="inf2"><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf3"><mml:mrow><mml:mn>1</mml:mn><mml:mo>↦</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for any selected subset of loci. If the sign of the effect of such a replacement depends on background, then the system has a rectangular perturbation. As proof of principle, we demonstrate that the large rectangles give new insights for two empirical studies (as compared to an analysis of sign epistasis). The first concerns antimalarial drug resistance (<xref ref-type="bibr" rid="bib18">Ogbunugafor and Hartl, 2016</xref>), whereas the second example involves bacteria adapting to a methanol environment (<xref ref-type="bibr" rid="bib6">Chou et al., 2011</xref>).</p><p>As in <xref ref-type="bibr" rid="bib8">Crona et al. (2017)</xref>, fitness is additive if the fitness effects of individual mutations sum, otherwise the system has epistasis (or gene interactions). By a rank order induced, or signed, interaction, we mean that the rank order reveals epistasis. Questions about how different approaches to signed interactions relate and how it is possible to determine whether a rank order is compatible with additive fitness were briefly discussed by the authors. As eLife reviewers pointed out, the signed interactions in <xref ref-type="bibr" rid="bib8">Crona et al. (2017)</xref> are not generalizations of sign epistasis but there is clearly some connection. The remaining open problems were the starting point for this work. The main idea for resolving the problems was to consider rectangles such as those in <xref ref-type="fig" rid="fig2">Figure 2</xref> (no knowledge of Walsh-coefficient, polytopes, or similarly is assumed here).</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We consider biallelic <inline-formula><mml:math id="inf4"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus systems. The fitness of a genotype <inline-formula><mml:math id="inf5"><mml:mi>g</mml:mi></mml:math></inline-formula> is denoted <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>w</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>. For simplicity, we assume that there exists a total order of the genotypes with respect to fitness, here referred to as a rank order (no two genotypes have equal fitness).</p><p>For two-locus systems, the expression <inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> measures epistasis. If it easy to verify that <inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if fitness is additive. By definition, the system has an interaction if <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi>u</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and a signed interaction if the rank order implies that <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. For instance the order <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> implies that <inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>For a systematic treatment of order perturbations, it is necessary to write the information in compact form. Notice that a rank order where <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> implies sign epistasis, as the effect of a mutation at the first locus can increase or decrease fitness. Reciprocal sign epistasis for a two-locus system can be defined as a system with two peaks (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). In particular, parallel arrows point in different directions.</p><p>It is straightforward to a check that a two-locus system has sign epistasis exactly if at least one of the following expressions is negative, and reciprocal sign epistasis if both of them are negative (<xref ref-type="fig" rid="fig1">Figure 1</xref>).<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>A negative sign corresponds to that a pair of parallel arrows that point in different directions. Large systems can be analyzed similarly.</p><p>A system has a rectangular perturbation if the sign of the effect of replacing a subset of loci, according to the rule <inline-formula><mml:math id="inf16"><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf17"><mml:mrow><mml:mn>1</mml:mn><mml:mo>↦</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, depends on background. The size of the perturbation refers to the number of loci replaced.</p><p>In particular, a rectangular perturbation of size 1 is a case of sign epistasis. The expression <inline-formula><mml:math id="inf18"><mml:mi>u</mml:mi></mml:math></inline-formula> was used to analyze gene interactions in the two-locus case, and a similar approach works in general. We define <inline-formula><mml:math id="inf19"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula> as the set of all expressions of the type<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>′′</mml:mo></mml:msup></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>′′′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>for genotypes <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>′′′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if fitness is additive. For instance, for <italic>n</italic> = 3, the expressions<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>110</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>000</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>010</mml:mn></mml:mrow></mml:msub><mml:mtext> and </mml:mtext><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>111</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>000</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>011</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>associated with two of the rectangles in <xref ref-type="fig" rid="fig2">Figure 2</xref> (i.e., the leftmost side and the blue rectangle) are included in <inline-formula><mml:math id="inf22"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula>. Note that each expression in <inline-formula><mml:math id="inf23"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula> can be obtained by going around a rectangle in the cube and assigning coefficients with alternating signs along the way (each <inline-formula><mml:math id="inf24"><mml:mi>w</mml:mi></mml:math></inline-formula>-coefficient is +1 or –1).</p><p>We call the elements in <inline-formula><mml:math id="inf25"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula> circuits, with reference to theory presented in <xref ref-type="bibr" rid="bib3">Beerenwinkel et al. (2007b)</xref> (see also 'Materials and methods'; no knowledge of circuits is assumed). By a rank-order-induced circuit, or signed circuit, we mean that the rank order implies that the circuit is positive or negative (exactly as in the two-locus case).</p><p>For <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, consider the circuit <inline-formula><mml:math id="inf27"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and the related expressions (the four genotypes from the circuit can be combined in two different ways):<disp-formula id="equ5"><label>(3)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ6"><label>(4)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If the rank order implies that expression (3) is negative, then the system has sign epistasis, and if expression (4) is negative, the system has an order perturbation of size 2. The short blue arrows in <xref ref-type="fig" rid="fig2">Figure 2</xref> point in different directions in the first case, and the long blue arrows do so in the latter. Similarly, any rectangular perturbation corresponds to two parallel arrows (along opposite sides of a rectangle) that point in different directions.</p><p><bold>Remark 1</bold>. The relation between signed circuits and sign epistasis can be summarized as follows for <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>.</p><list list-type="roman-lower"><list-item><p>A rank order of the genotypes 00, 10, 01 and 11 with respect to fitness implies that <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> exactly if the system has sign epistasis.</p></list-item><list-item><p>From the information that the rank order implies <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (or <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>u</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) alone, one cannot determine whether there are one or two order perturbations, that is, whether or not the system has reciprocal sign epistasis.</p></list-item><list-item><p>The system has reciprocal sign epistasis if both expressions (1) and (2) are negative, and sign epistasis if at least one of them is negative.</p></list-item></list><p><bold>Remark 2</bold>. A similar observation holds for signed circuits and any <inline-formula><mml:math id="inf33"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p><list list-type="roman-lower"><list-item><p>Each case of sign epistasis is associated with a signed interaction for a circuit in <inline-formula><mml:math id="inf34"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula>, that is the rank order of genotypes with respect to fitness implies that the form is positive or negative.</p></list-item><list-item><p>More generally, each rectangular perturbation is associated with a signed circuit interaction for a circuit in <inline-formula><mml:math id="inf35"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula>.</p></list-item><list-item><p>Each circuit in <inline-formula><mml:math id="inf36"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula> corresponds exactly to two potential rectangular perturbations.</p></list-item></list><p>In particular, in order to check a three-locus system for perturbations it is sufficient to check the signs of 24 expressions, including expression (3) and (4), associated with 12 circuits (see 'Materials and methods').</p><sec id="s2-1"><title>Applications</title><p>The first application concerns a study of the malaria-causing parasite <italic>Plasmodium vivax</italic> (<xref ref-type="bibr" rid="bib18">Ogbunugafor and Hartl, 2016</xref>). The original study investigates a four-locus system exposed to different concentrations of the anti-malarial drug pyrimethamine (PYR). The quadruple mutant denoted 1111 has the highest degree of drug resistance, whereas the genotype 0000 has the highest fitness among all genotypes in the drug-free environment. Several concentrations of the drug were tested in the original study. We compared the highest concentration of the drug and the drug-free environment. Sign epistasis was equally frequent in both fitness landscapes. However, the drug-free environment had about twice as many perturbations of size 2 and 3, as the drug-exposed environment. The summary statistic indicates that (<xref ref-type="table" rid="table1">Table 1</xref>) adaptation is more difficult in the drug-free environment, because few replacements of pieces of code (regardless of size) are universally beneficial.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Rectangular perturbations for drug-exposed and drug-free malaria fitness landscapes.</title><p>The third line shows the total number of expressions checked. The prevalence of sign epistasis is similar for the landscapes, whereas the remaining perturbations differ by a factor of two.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Perturbation size</th><th>1</th><th>2</th><th>3</th><th>Size (1-3)</th></tr></thead><tbody><tr><td>Drug-exposed</td><td>55</td><td>21</td><td>5</td><td>81</td></tr><tr><td>Drug-free</td><td>54</td><td>39</td><td>9</td><td>102</td></tr><tr><td>Expressions checked</td><td>112</td><td>72</td><td>16</td><td>200</td></tr></tbody></table></table-wrap><p>This finding agrees well with the authors’ observation that resistance development is a relatively straightforward process, whereas reversed evolution from the mutant 1111 back to the ancestral type is difficult. Interestingly, the complete statistics of order perturbations was better able to distinguish the landscapes than sign epistasis alone.</p><p>The second application concerns a study of the bacterium <italic>Methylobacterium extorquens</italic>, which adapts to a methanol environment (<xref ref-type="bibr" rid="bib6">Chou et al., 2011</xref>). For the sake of the argument, we assume that the published measurements are exact (a discussion about the impact of measurement errors can be found in 'Materials and methods'). The fitness landscape does not have sign epistasis. However, the system has size 2 perturbations (<xref ref-type="table" rid="table2">Table 2</xref>). In particular <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>1000</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0100</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf38"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>1011</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0111</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, so that the sign of the effect of the change <inline-formula><mml:math id="inf39"><mml:mrow><mml:mn>10</mml:mn><mml:mo>↦</mml:mo><mml:mn>01</mml:mn></mml:mrow></mml:math></inline-formula> at the first pair of loci depends on background. The perturbations show that the rank order is incompatible with additive fitness.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Order perturbations of size 1 and 2 for <italic>Methylobacterium extorquens</italic>.</title><p>The landscape has no sign epistasis. However, perturbations of size 2 reveal that the landscape is not additive.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Perturbation of size</th><th>1</th><th>2</th></tr></thead><tbody><tr><td>Number of perturbations</td><td>0</td><td>3</td></tr><tr><td>Expressions checked</td><td>112</td><td>72</td></tr></tbody></table></table-wrap><p>A complete analysis of perturbations for an <inline-formula><mml:math id="inf40"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system requires an investigation of <inline-formula><mml:math id="inf41"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:msup><mml:mn>6</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mn>8</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> expressions for <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (Theorem 1, 'Materials and methods'). Statistics on order perturbations should always be considered estimates because of measurement errors. However, that is true for all rank-order-based concepts, and a peak count is sensitive to noise. One could naively believe that a broader perspective makes the problem worse. By contrast, rectangular perturbations can sometimes be helpful in separating signal and noise.</p><p>For instance, assume that fitness is additive and that all mutations decrease fitness (<xref ref-type="fig" rid="fig3">Figure 3</xref>). The graphs show the proportion of unexpected observations, that is increased fitness, for replacements of the type <inline-formula><mml:math id="inf43"><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf44"><mml:mrow><mml:mn>00</mml:mn><mml:mo>↦</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf45"><mml:mrow><mml:mn>000</mml:mn><mml:mo>↦</mml:mo><mml:mn>111</mml:mn></mml:mrow></mml:math></inline-formula> for two error distributions (errors follow a normal distribution in the upper graph and the Student’s t-distribution with df = 3 in the lower, see 'Materials and methods' for more details). In both cases, the proportion of unexpected results decreases by the number of loci replaced. The reason is that the noise level is similar in all cases, whereas the effect size is not.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>The fitness landscapes are additive and each mutation <inline-formula><mml:math id="inf46"><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> decreases fitness.</title><p>The graphs compare replacements <inline-formula><mml:math id="inf47"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mn>00</mml:mn><mml:mo>↦</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mrow><mml:mn>000</mml:mn><mml:mo>↦</mml:mo><mml:mn>111</mml:mn></mml:mrow></mml:math></inline-formula>. Because of measurement errors, some replacements appear to increase fitness. The graphs show the proportion of such cases.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-51004-fig3-v2.tif"/></fig><p>This observation can be useful. For instance, it is difficult to exclude additive fitness for a collection of detrimental mutations by observing sign epistasis alone (apparent sign epistasis can result from noise). However, an investigation of the three types of replacements described could be conclusive. In particular, similar proportions of unexpected results would constitute a strong argument against additive fitness.</p><p>Rank orders and perturbations are important for problems beyond natural selection. Constraints on the orders in which mutation occur are known for development of cancer drug resistance (<xref ref-type="bibr" rid="bib13">Hosseini et al., 2019</xref>; <xref ref-type="bibr" rid="bib2">Beerenwinkel et al., 2007a</xref>). In brief, a typical case would be that some mutation <inline-formula><mml:math id="inf49"><mml:mi>B</mml:mi></mml:math></inline-formula> is not selected for unless a mutation <inline-formula><mml:math id="inf50"><mml:mi>A</mml:mi></mml:math></inline-formula> has occurred, even though <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> has high fitness. If the constraint holds universally, it can be described as: <inline-formula><mml:math id="inf52"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>01</mml:mn><mml:mo>⁣</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>00</mml:mn><mml:mo>⁣</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo>⁣</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>11</mml:mn><mml:mo>⁣</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <sub>*</sub> is an arbitrary sequence. For an <inline-formula><mml:math id="inf53"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system, such a constraint implies <inline-formula><mml:math id="inf54"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> order perturbations if fitness is additive for the remaining loci.</p></sec><sec id="s2-2"><title>Additivity and rank orders</title><p>The problem of determining if rank orders are compatible with additive fitness is already interesting for <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>For the fitness landscape<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.12</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.09</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.22</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.19</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1.3</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>the rank order is <inline-formula><mml:math id="inf56"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The change <inline-formula><mml:math id="inf57"><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> at any locus increases fitness regardless of background, so there is no sign epistasis. However, the sign of the effect of the change <inline-formula><mml:math id="inf58"><mml:mrow><mml:mn>10</mml:mn><mml:mo>↦</mml:mo><mml:mn>01</mml:mn></mml:mrow></mml:math></inline-formula> at the first pair of loci depends on background, as <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. In particular, the rank order is not compatible with additive fitness.</p><p>As remarked in <xref ref-type="bibr" rid="bib8">Crona et al. (2017)</xref>, exactly 384 orders are compatible with the absence of sign epistasis for <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>. By applying order perturbations (and by inspection), we verified that exactly 96 out of the 384 orders are compatible with additive fitness, or 0.24 percent of all 40,320 rank orders for three-locus systems. After relabeling (see 'Materials and methods' for details), only the following two orders are compatible with additive fitness:<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Theory on rank orders and additivity has been developed independent of biological application and is still an active research area (<xref ref-type="bibr" rid="bib21">Searles and Slinko, 2015</xref>; <xref ref-type="bibr" rid="bib17">Maclagan, 1998</xref>). In principle, one can determine whether a specific rank order is compatible with additive fitness by solving a system of linear inequalities obtained from the order. It is straightforward to verify that a rank order is compatible with additive fitness unless it has rectangular perturbations for <inline-formula><mml:math id="inf62"><mml:mi>n</mml:mi></mml:math></inline-formula>=4. However, counterexamples to the analogous statement for <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> exist (<xref ref-type="bibr" rid="bib15">Kraft et al., 1959</xref>) (see Materials and methods for more details).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>A rank order of genotypes, from highest to lowest fitness, is informative about gene interactions (<xref ref-type="bibr" rid="bib8">Crona et al., 2017</xref>). We introduced rectangular perturbations to resolve problems on how different approaches to rank order induced (or signed) interactions relate. Sign epistasis concerns the effects of single mutations, and the new perturbations also concern the effects of multiple mutations.</p><p>We have established that sign epistasis implies that a system has signed circuit interactions, but the converse is not true. Strictly speaking, signed circuits are not generalizations of sign epistasis, neither are signed circuits refinements of sign epistasis. However, sign epistasis can be seen as rectangular perturbations of minimal size.</p><p>A rank order is compatible with additive fitness unless there is sign epistasis for a two-locus system. We have provided a counterexample for the analogous claim for three loci. For four-locus systems, a rank order is compatible with additive fitness unless there are rectangular perturbations. However, counterexamples exist for five loci (<xref ref-type="bibr" rid="bib17">Maclagan, 1998</xref>; <xref ref-type="bibr" rid="bib15">Kraft et al., 1959</xref>). In general, only a very small proportion of all rank orders are compatible with additive fitness, and the theoretical understanding for the property is limited.</p><p>As a proof of principle, we applied rectangular perturbations to empirical studies on antimalarial drug resistance (<xref ref-type="bibr" rid="bib18">Ogbunugafor and Hartl, 2016</xref>) and on bacteria adapting to a methanol environment (<xref ref-type="bibr" rid="bib6">Chou et al., 2011</xref>). Rectangular perturbations have the capacity to detect epistasis when conventional rank-order-based methods cannot. The perturbations capture evolutionary important properties beyond local aspects. A complete analysis of rectangular perturbations requires an investigation of a large number of expressions (of the order <inline-formula><mml:math id="inf64"><mml:msup><mml:mn>6</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula>). Often, it is meaningful to consider selected perturbations, depending on the context.</p><p>In general, rank orders are quite informative about gene interactions, and also regarding evolutionary potential (in a qualitative sense) provided one assumes the Strong Selection Weak Mutation regime (<xref ref-type="bibr" rid="bib11">Gillespie, 1984</xref>). If the available information from an empirical study is a rank order, for instance from a competition experiment, then it is obviously useful to have methods for interpreting rank orders (further motivations are discussed in <xref ref-type="bibr" rid="bib8">Crona et al., 2017</xref>). However, rank-orders methods have obvious limitations. Rank orders are insufficient for determining the effect of genetic recombination (<xref ref-type="bibr" rid="bib9">de Visser et al., 2009</xref>; <xref ref-type="bibr" rid="bib19">Otto and Lenormand, 2002</xref>). Evolutionary predictability is sensitive for population parameters, and the importance of accessible mutational trajectories is not universal (<xref ref-type="bibr" rid="bib10">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib16">Krug, 2019</xref>).</p><p>It would be interesting to determine the extent to which rectangular perturbations are helpful for relating local and global properties of fitness landscapes, similar to results on sign epistasis (<xref ref-type="bibr" rid="bib24">Weinreich et al., 2005</xref>; <xref ref-type="bibr" rid="bib20">Poelwijk et al., 2011</xref>; <xref ref-type="bibr" rid="bib7">Crona et al., 2013</xref>), and also in analyzing statistical aspects further. Algorithms and exact formulas for potential perturbations are provided in the 'Materials and methods'.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>General circuits</title><p>For a biallelic <inline-formula><mml:math id="inf65"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system, we have discussed a set <inline-formula><mml:math id="inf66"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula> defined as all expressions of the form<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>′′</mml:mo></mml:msup></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msup><mml:mi>g</mml:mi><mml:mo>′′′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>for genotypes <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>′′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mo>′′′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if fitness is additive. In order to connect to general theory, we need some concepts. Starting with the two-locus case, for the genotypes <inline-formula><mml:math id="inf69"><mml:mrow><mml:mn>00</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>01</mml:mn><mml:mo>,</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula>, one can form vectors in <inline-formula><mml:math id="inf70"><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:math></inline-formula> by adding an extra coordinate one for each genotype<disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The four vectors are linearly dependent since<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The dependence relation corresponds exactly to the linear form<disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Similarly, one can form vectors in <inline-formula><mml:math id="inf71"><mml:msup><mml:mi>ℝ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> from the vertices of the <inline-formula><mml:math id="inf72"><mml:mi>n</mml:mi></mml:math></inline-formula>-cube by adding a coordinate 1. Circuits are defined as the <italic>minimal dependence relations</italic>, in the sense that each proper subset of the vectors (with non-zero coefficients) are linearly independent.</p><p>There are in total 20 circuits for <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, including <inline-formula><mml:math id="inf74"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula>, but also for instance the circuit<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In this terminology, one can describe <inline-formula><mml:math id="inf75"><mml:mi class="ltx_font_mathcaligraphic">𝒞</mml:mi></mml:math></inline-formula> as the set of circuits that have exactly four non-zero coefficients for the variables <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>w</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>. Note that all circuits are zero if fitness is additive. In that sense, circuits measure epistasis. An analysis of all circuits provides very complete information on gene interactions (<xref ref-type="bibr" rid="bib3">Beerenwinkel et al., 2007b</xref>).</p></sec><sec id="s4-2"><title>Counting rectangular perturbation</title><p>To count rectangular perturbations, one needs to find all rectangles with vertices in an <inline-formula><mml:math id="inf77"><mml:mi>n</mml:mi></mml:math></inline-formula>-cube. We provide an explicit formula with proof for the reader’s convenience, even though the result is elementary. The proof depends on Stirling numbers of the second kind. The Stirling number <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined as the number of ways to partition a set of <inline-formula><mml:math id="inf79"><mml:mi>n</mml:mi></mml:math></inline-formula> objects into <inline-formula><mml:math id="inf80"><mml:mi>k</mml:mi></mml:math></inline-formula> non-empty subsets. We refer to <xref ref-type="bibr" rid="bib12">Grimaldi (2006)</xref> for more background.</p><p><bold>Theorem 1</bold>. The total number of (potential) rectangular perturbations for an <inline-formula><mml:math id="inf81"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system is<disp-formula id="equ16"><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mn>6</mml:mn><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mn>8</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>n</mml:mi><mml:mo>≥</mml:mo><mml:mn>3.</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Moreover, the number of rectangular perturbations of size <inline-formula><mml:math id="inf82"><mml:mi>k</mml:mi></mml:math></inline-formula> (exactly <inline-formula><mml:math id="inf83"><mml:mi>k</mml:mi></mml:math></inline-formula> loci are replaced) equals<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><bold>Corollary</bold>. A complete investigation of sign epistasis for an <inline-formula><mml:math id="inf84"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system requires that one checks the signs of <inline-formula><mml:math id="inf85"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>n</mml:mi></mml:mpadded><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal">(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac linethickness="0pt"><mml:msup><mml:mn mathvariant="normal">2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">-</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:msup><mml:mn mathvariant="normal">2</mml:mn></mml:mfrac></mml:mstyle><mml:mo mathvariant="normal">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> expressions.</p><p><bold>Lemma 1</bold>. For Stirling numbers of the second kind <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>S</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>k</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the following identities hold.<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><italic><bold>Proof</bold></italic>. The first formula holds since there are <inline-formula><mml:math id="inf87"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> non-empty proper subsets of <inline-formula><mml:math id="inf88"><mml:mi>n</mml:mi></mml:math></inline-formula> elements, and each partition corresponds to exactly two subsets. Similarly, the second formula can be derived from the observation that one can construct three labeled subsets of <inline-formula><mml:math id="inf89"><mml:mi>n</mml:mi></mml:math></inline-formula> elements in <inline-formula><mml:math id="inf90"><mml:msup><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula> ways. After reducing for all cases with empty sets, the number of alternatives is<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mn>3</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>-</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Each partition corresponds to six alternatives, which completes the argument.</p><p><bold>Lemma 2</bold>. Let <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>n</mml:mi><mml:mo mathvariant="normal">≥</mml:mo><mml:mn mathvariant="normal">3</mml:mn></mml:mrow></mml:math></inline-formula>. There are<disp-formula id="equ21"><mml:math id="m21"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mn>6</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mn>8</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula>rectangles with vertices in an <inline-formula><mml:math id="inf92"><mml:mi>n</mml:mi></mml:math></inline-formula>-cube.</p><p><bold><italic>Proof</italic>.</bold> For each vertex <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in an <inline-formula><mml:math id="inf94"><mml:mi>n</mml:mi></mml:math></inline-formula>-cube, one can construct a rectangle with vertices on the <inline-formula><mml:math id="inf95"><mml:mi>n</mml:mi></mml:math></inline-formula>-cube as follows. Distribute the set of <inline-formula><mml:math id="inf96"><mml:mi>n</mml:mi></mml:math></inline-formula> loci into three subsets <inline-formula><mml:math id="inf97"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf98"><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, where the intersection of each pair of sets is empty, and where <inline-formula><mml:math id="inf99"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf100"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are non-empty.</p><p>From the vertex <inline-formula><mml:math id="inf101"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, one constructs the remaining vertices by replacing sets of loci, according to the rule <inline-formula><mml:math id="inf102"><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf103"><mml:mrow><mml:mn>1</mml:mn><mml:mo>↦</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Specifically, one vertex is obtained by replacing all elements in <inline-formula><mml:math id="inf104"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, one by replacing all elements in <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, and the last by replacing all elements in <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo largeop="true" mathsize="160%" stretchy="false" symmetric="true">⋃</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> is empty, one can construct <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> rectangles. If all three sets are non-empty, then one can choose <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> in three ways, and consequently construct <inline-formula><mml:math id="inf110"><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> rectangles. In total, one obtains <inline-formula><mml:math id="inf111"><mml:mrow><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> rectangles starting from a particular vertex. There are <inline-formula><mml:math id="inf112"><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula> vertices in the <inline-formula><mml:math id="inf113"><mml:mi>n</mml:mi></mml:math></inline-formula>-cube and each rectangle has four vertices. By the previous lemma, the number of rectangles is<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mn>4</mml:mn></mml:mfrac><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>⋅</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mn>6</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mn>8</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which completes the proof.</p><p>We can now prove the main result.</p><p><italic><bold>Proof of Theorem 1</bold></italic>. The total number of (potential) rectangular perturbations for an <inline-formula><mml:math id="inf114"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system is<disp-formula id="equ23"><mml:math id="m23"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:msup><mml:mn>6</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mn>8</mml:mn></mml:mfrac><mml:mo>-</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>A rectangle with vertices in the <inline-formula><mml:math id="inf115"><mml:mi>n</mml:mi></mml:math></inline-formula>-cube corresponds to exactly two rectangular perturbations, one for each pair of parallel edges. Consequently, the result follows from Lemma 2.</p><p>The second part of the theorem states that the number of rectangular perturbations where exactly <inline-formula><mml:math id="inf116"><mml:mi>k</mml:mi></mml:math></inline-formula> loci are replaced is equal to<disp-formula id="equ24"><mml:math id="m24"><mml:mrow><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The positions of the <inline-formula><mml:math id="inf117"><mml:mi>k</mml:mi></mml:math></inline-formula> loci that change can be chosen in <inline-formula><mml:math id="inf118"><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> different ways. There are <inline-formula><mml:math id="inf119"><mml:msup><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:msup></mml:math></inline-formula> words of length <inline-formula><mml:math id="inf120"><mml:mi>k</mml:mi></mml:math></inline-formula>, and therefore <inline-formula><mml:math id="inf121"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> pairs consisting of a word and its replacement (for instance, the replacement of 110 is 001). Finally, there are <inline-formula><mml:math id="inf122"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> different backgrounds, so that a pair of backgrounds can be chosen in <inline-formula><mml:math id="inf123"><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> ways.</p><p>As mentioned, a single signed circuit may correspond to two cases of sign epistasis. Indeed, a two-locus system with reciprocal sign epistasis is an example. It is thus of interest to identify all order perturbations, rather than identifying signed circuits only. Theorem 1 and its proof indicate how one can find all order perturbations. In particular, the complete list for identifying rectangular perturbations for <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> consists of the following 24 expressions, where the first 18 expressions concern sign epistasis, and the remaining six size 2 perturbations.<disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ27"><mml:math id="m27"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ28"><mml:math id="m28"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ29"><mml:math id="m29"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ30"><mml:math id="m30"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ31"><mml:math id="m31"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ32"><mml:math id="m32"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-3"><title>Rank orders compatible with additive fitness</title><p>Different rank orders may differ only 'by labels’. For instance, the rank orders<disp-formula id="equ33"><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>differ by the map <inline-formula><mml:math id="inf125"><mml:mrow><mml:mn>0</mml:mn><mml:mo>↦</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf126"><mml:mrow><mml:mn>1</mml:mn><mml:mo>↦</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, applied to both loci for each genotype. By definition, a cube isomorphism preserves the adjacency structure of the cube (a pair of mutational neighbors is mapped to a pair of neighbors).</p><p>Two rank orders are considered equivalent if a cube isomorphism induces a map between them. Differently expressed, for any given rank order (for a two-locus system), one can obtain an equivalent order by assigning the label 00 to a genotype of choice (among four alternatives) and then 10 to one of its neighbors (among two alternatives). After that, the adjacency condition determines the labels of the remaining genotypes. The new rank order is identical to the original one, except that the genotypes have new labels as described. It follows that each equivalence class consists of <inline-formula><mml:math id="inf127"><mml:mrow><mml:mn>8</mml:mn><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⋅</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> orders. The 24 rank orders for a two-locus systems can be partitioned into <inline-formula><mml:math id="inf128"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>24</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> equivalence classes.</p><p>For general <inline-formula><mml:math id="inf129"><mml:mi>n</mml:mi></mml:math></inline-formula>, each equivalence class consists of <inline-formula><mml:math id="inf130"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> rank orders by a similar argument. In particular, for <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, each equivalence class consists of 48 rank orders, and the <inline-formula><mml:math id="inf132"><mml:mrow><mml:mn>8</mml:mn><mml:mo>!</mml:mo></mml:mrow></mml:math></inline-formula> rank orders can be partitioned into 840 equivalence classes. Questions on rank orders for <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> are manageable as it suffices to check 840 orders.</p><p>To determine whether a specific rank order is compatible with additive fitness, one has to solve a system of inequalities. For simplicity, we illustrate the argument for a two-locus system. Consider the order <inline-formula><mml:math id="inf134"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> We can assume that<disp-formula id="equ34"><mml:math id="m34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/></mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Additive fitness would imply <inline-formula><mml:math id="inf135"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and then the rank order implies <inline-formula><mml:math id="inf136"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, which is a contradiction. It follows that the rank order is incompatible with additive fitness. In general, a rank order combined with an additive assumption determines a system of linear inequalities. The rank order is compatible with additive fitness exactly if the system has a solution. It is not difficult to find software for solving such a system of inequalities. In particular any software for solving linear programming problems can be used.</p><p>The case <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> was discussed in the main text. For <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, one can verify computationally that there exist 14 rank orders (up to equivalence) with no order perturbations. As outlined, one can verify that all 14 rank orders are compatible with additive fitness. For <inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, the analogous statement is not true, which was first shown by <xref ref-type="bibr" rid="bib15">Kraft et al. (1959)</xref>. An explicit counterexample is given in <xref ref-type="bibr" rid="bib17">Maclagan (1998)</xref>. This author studies Boolean term orders, in our terminology perturbation free rank orders, and refers to an order as being coherent if it is compatible with additive fitness. (The counterexample is described in slightly different notation, and the translation to our notation is<disp-formula id="equ35"><mml:math id="m35"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">∅</mml:mi><mml:mo>↦</mml:mo><mml:mn>00000</mml:mn></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>↦</mml:mo><mml:mn>10000</mml:mn></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>↦</mml:mo><mml:mn>01000</mml:mn></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>↦</mml:mo><mml:mn>00100</mml:mn></mml:mrow><mml:mo rspace="4.2pt">,</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>↦</mml:mo><mml:mn>11000</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>↦</mml:mo><mml:mn>11100</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and analogously.)</p><p>As explained, in principle, one can check whether a given rank order is compatible with additive fitness. However, the theoretical understanding of rank orders and additive fitness is still limited.</p></sec><sec id="s4-4"><title>Rank orders and statistical significance</title><p>As noted in the main text, rank-order methods are sensitive for measurement errors. A sufficient number of tests is necessary for reliable results, and elementary probability theory provides some guidance. If, for instance, genotype <inline-formula><mml:math id="inf140"><mml:mi>g</mml:mi></mml:math></inline-formula> beats genotype <inline-formula><mml:math id="inf141"><mml:msup><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> in 9 out of 10 comparisons, then it is reasonable to reject a null hypothesis of equal fitness.</p><p>Research on inferring rank orders from pairwise comparisons has a long history because of applications to sports and games (<xref ref-type="bibr" rid="bib23">Wauthier et al., 2013</xref>; <xref ref-type="bibr" rid="bib4">Boyd and Silk, 1983</xref>; <xref ref-type="bibr" rid="bib1">Albers and de Vries, 2001</xref>; <xref ref-type="bibr" rid="bib5">Bradley and Terry, 1952</xref>; <xref ref-type="bibr" rid="bib22">Thurstone, 1927</xref>). However, statistical significance for rank orders has received considerably less attention, and it would be interesting to develop more theory on the topic.</p><p><bold>Simulations</bold>. The upper graph in <xref ref-type="fig" rid="fig3">Figure 3</xref> was obtained by assuming additive fitness, a fitness decrease by 0.01 for each mutation, and errors sampled from a Gaussian distribution, where the magnitude of the errors is a value on the list 0.0010, 0.0011, 0.0012, …, 0.01. The assumptions were the same for the lower graph, except that a Student’s t-distribution with df = 3 was used.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We are grateful to Casey Aguilar-Gervase, Tonia Bell, Payal Dudheida and David Dunleavy for their studies on rank orders of genotypes for four-locus systems, and to Ethan Christensen for his work on antimalarial drug resistance.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Methodology</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-51004-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analyzed during this study are included in the manuscript and supporting files.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albers</surname> <given-names>PCH</given-names></name><name><surname>de Vries</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Elo-rating as a tool in the sequential estimation of dominance strengths</article-title><source>Animal Behaviour</source><volume>61</volume><fpage>489</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1006/anbe.2000.1571</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beerenwinkel</surname> <given-names>N</given-names></name><name><surname>Eriksson</surname> <given-names>N</given-names></name><name><surname>Sturmfels</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007a</year><article-title>Conjunctive bayesian networks</article-title><source>Bernoulli</source><volume>13</volume><fpage>893</fpage><lpage>909</lpage><pub-id pub-id-type="doi">10.3150/07-BEJ6133</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beerenwinkel</surname> <given-names>N</given-names></name><name><surname>Pachter</surname> <given-names>L</given-names></name><name><surname>Sturmfels</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007b</year><article-title>Epistasis and shapes of fitness landscapes</article-title><source>Statistica Sinica</source><volume>17</volume><fpage>1317</fpage><lpage>1342</lpage></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyd</surname> <given-names>R</given-names></name><name><surname>Silk</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>A method for assigning cardinal dominance ranks</article-title><source>Animal Behaviour</source><volume>31</volume><fpage>45</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/S0003-3472(83)80172-9</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradley</surname> <given-names>RA</given-names></name><name><surname>Terry</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="1952">1952</year><article-title>Rank analysis of incomplete block designs: I. the method of paired comparisons</article-title><source>Biometrika</source><volume>4</volume><fpage>324</fpage><lpage>345</lpage><pub-id pub-id-type="doi">10.2307/2334029</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chou</surname> <given-names>HH</given-names></name><name><surname>Chiu</surname> <given-names>HC</given-names></name><name><surname>Delaney</surname> <given-names>NF</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name><name><surname>Marx</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Diminishing returns epistasis among beneficial mutations decelerates adaptation</article-title><source>Science</source><volume>332</volume><fpage>1190</fpage><lpage>1192</lpage><pub-id pub-id-type="doi">10.1126/science.1203799</pub-id><pub-id pub-id-type="pmid">21636771</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crona</surname> <given-names>K</given-names></name><name><surname>Greene</surname> <given-names>D</given-names></name><name><surname>Barlow</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The peaks and geometry of fitness landscapes</article-title><source>Journal of Theoretical Biology</source><volume>317</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2012.09.028</pub-id><pub-id pub-id-type="pmid">23036916</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crona</surname> <given-names>K</given-names></name><name><surname>Gavryushkin</surname> <given-names>A</given-names></name><name><surname>Greene</surname> <given-names>D</given-names></name><name><surname>Beerenwinkel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inferring genetic interactions from comparative fitness data</article-title><source>eLife</source><volume>6</volume><elocation-id>e28629</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.28629</pub-id><pub-id pub-id-type="pmid">29260711</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname> <given-names>JA</given-names></name><name><surname>Park</surname> <given-names>SC</given-names></name><name><surname>Krug</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Exploring the effect of sex on empirical fitness landscapes</article-title><source>The American Naturalist</source><volume>174</volume><fpage>S15</fpage><lpage>S30</lpage><pub-id pub-id-type="doi">10.1086/599081</pub-id><pub-id pub-id-type="pmid">19456267</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname> <given-names>JA</given-names></name><name><surname>Krug</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Empirical fitness landscapes and the predictability of evolution</article-title><source>Nature Reviews Genetics</source><volume>15</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nrg3744</pub-id><pub-id pub-id-type="pmid">24913663</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Molecular evolution over the mutational landscape</article-title><source>Evolution</source><volume>38</volume><fpage>1116</fpage><lpage>1129</lpage><pub-id pub-id-type="doi">10.2307/2408444</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Grimaldi</surname> <given-names>RP</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Discrete and Combinatorial Mathematics</source><edition>5th Edition</edition><publisher-name>Pearson Education India</publisher-name></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hosseini</surname> <given-names>SR</given-names></name><name><surname>Diaz-Uriarte</surname> <given-names>R</given-names></name><name><surname>Markowetz</surname> <given-names>F</given-names></name><name><surname>Beerenwinkel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Estimating the predictability of Cancer evolution</article-title><source>Bioinformatics</source><volume>35</volume><fpage>i389</fpage><lpage>i397</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btz332</pub-id><pub-id pub-id-type="pmid">31510665</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaznatcheev</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Computational complexity as an ultimate constraint on evolution</article-title><source>Genetics</source><volume>212</volume><fpage>245</fpage><lpage>265</lpage><pub-id pub-id-type="doi">10.1534/genetics.119.302000</pub-id><pub-id pub-id-type="pmid">30833289</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kraft</surname> <given-names>CH</given-names></name><name><surname>Pratt</surname> <given-names>JW</given-names></name><name><surname>Seidenberg</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1959">1959</year><article-title>Intuitive probability on finite sets</article-title><source>The Annals of Mathematical Statistics</source><volume>30</volume><fpage>408</fpage><lpage>419</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177706260</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Krug</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Accessibility percolation in random fitness landscapes</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1903.11913">https://arxiv.org/abs/1903.11913</ext-link></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maclagan</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Boolean term orders and the root system bn</article-title><source>Order</source><volume>15</volume><fpage>279</fpage><lpage>295</lpage><pub-id pub-id-type="doi">10.1023/A:1006207716298</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogbunugafor</surname> <given-names>CB</given-names></name><name><surname>Hartl</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A pivot mutation impedes reverse evolution across an adaptive landscape for drug resistance in plasmodium vivax</article-title><source>Malaria Journal</source><volume>15</volume><elocation-id>40</elocation-id><pub-id pub-id-type="doi">10.1186/s12936-016-1090-3</pub-id><pub-id pub-id-type="pmid">26809718</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otto</surname> <given-names>SP</given-names></name><name><surname>Lenormand</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Resolving the paradox of sex and recombination</article-title><source>Nature Reviews Genetics</source><volume>3</volume><fpage>252</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1038/nrg761</pub-id><pub-id pub-id-type="pmid">11967550</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname> <given-names>FJ</given-names></name><name><surname>Tănase-Nicola</surname> <given-names>S</given-names></name><name><surname>Kiviet</surname> <given-names>DJ</given-names></name><name><surname>Tans</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reciprocal sign epistasis is a necessary condition for multi-peaked fitness landscapes</article-title><source>Journal of Theoretical Biology</source><volume>272</volume><fpage>141</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2010.12.015</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Searles</surname> <given-names>D</given-names></name><name><surname>Slinko</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Noncoherent initial ideals in exterior algebras</article-title><source>Beiträge Zur Algebra Und Geometrie / Contributions to Algebra and Geometry</source><volume>56</volume><fpage>759</fpage><lpage>762</lpage><pub-id pub-id-type="doi">10.1007/s13366-015-0239-5</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thurstone</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="1927">1927</year><article-title>The method of paired comparisons for social values</article-title><source>The Journal of Abnormal and Social Psychology</source><volume>21</volume><fpage>384</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1037/h0065439</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wauthier</surname> <given-names>F</given-names></name><name><surname>Jordan</surname> <given-names>M</given-names></name><name><surname>Jojic</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Efficient ranking from pairwise comparisons</article-title><conf-name>International Conference on Machine Learning</conf-name><fpage>109</fpage><lpage>117</lpage></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname> <given-names>DM</given-names></name><name><surname>Watson</surname> <given-names>RA</given-names></name><name><surname>Chao</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Perspective: sign epistasis and genetic costraint on evolutionary trajectories</article-title><source>Evolution</source><volume>59</volume><fpage>1165</fpage><lpage>1174</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2005.tb01768.x</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wright</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1932">1932</year><article-title>The roles of mutation, inbreeding, crossbreeding, and selection in evolution</article-title><conf-name>Proceedings of the Sixth International Congress of Genetics</conf-name><conf-loc>Ithica, New York</conf-loc><fpage>356</fpage><lpage>366</lpage></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>NC</given-names></name><name><surname>Dai</surname> <given-names>L</given-names></name><name><surname>Olson</surname> <given-names>CA</given-names></name><name><surname>Lloyd-Smith</surname> <given-names>JO</given-names></name><name><surname>Sun</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Adaptation in protein fitness landscapes is facilitated by indirect paths</article-title><source>eLife</source><volume>5</volume><elocation-id>e16965</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.16965</pub-id><pub-id pub-id-type="pmid">27391790</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51004.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Krug</surname><given-names>Joachim</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cologne</institution><country>Germany</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Krug</surname><given-names>Joachim</given-names> </name><role>Reviewer</role><aff><institution>University of Cologne</institution><country>Germany</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Ferretti</surname><given-names>Luca</given-names> </name><role>Reviewer</role><aff><institution>The Pirbright Institute</institution></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This work extends a previous paper in <italic>eLife</italic>, where it was shown how the sign of certain epistatic interaction coefficients can be inferred from partial rank orders of fitness values. The purpose of the manuscript is to clarify the relation of this inference with the concept of sign epistasis; Crona et al., 2017, had shown that sign epistasis was a sufficient, but not necessary, condition for rank order to be informative about at least some signed interactions. Here the range of informative rank orders is extended by introducing the concept of rectangular perturbations, which generalizes the concept of sign epistasis by asking for the background dependence of the effect of mutational events that modify several loci at once. In the revision, the presentation was improved so that it has become more accessible for (evolutionary) biologists with a non-mathematical background.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article “Rank orders and signed interactions in evolutionary biology” for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Joachim Krug as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Diethard Tautz as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Luca Ferretti (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This submission refers to the authors' previous <italic>eLife</italic> publication, Crona et al., 2017, where it was shown how the sign of certain epistatic interaction coefficients can be inferred from partial rank orders of fitness values. The purpose of the manuscript is to clarify the relation of this inference with the concept of sign epistasis. Crona et al., 2017 showed that sign epistasis is a sufficient condition for a rank order to be informative about at least some signed interactions, however it is not a necessary condition. Here the range of informative rank orders is extended by introducing the concept of rectangular perturbations, which generalizes the concept of sign epistasis by asking for the background dependence of the effect of mutational events that modify several loci at once. The exploratory application of the new concept to two empirical data sets suggests that it does give access to additional information about the topography of the landscape.</p><p>Overall, the reviewers found that, while the manuscript contains some interesting ideas and results that are worth to be reported in the form of a Research Advance, substantial revisions are necessary. Most importantly, the results should be presented in a way that is reasonably accessible for (evolutionary) biologists with a non-mathematical background, and the presentation also needs to be more systematic. A detailed list of the issues that should be addressed is given below.</p><p>Essential revisions:</p><p>1) All three reviewers found that the manuscript was lacking in clarity and context. Specifically, they felt that both the motivating question of the manuscript (as it arises from the original <italic>eLife</italic> publication of Krona et al., 2017), and the final answer that is achieved need to be spelled out more clearly and concisely. Moreover, it was not clearly stated how the new method of epistasis analysis goes beyond more established approaches, and in what sense it “add(s) precision to the analysis”.</p><p>2) Reviewers #2 and #3 addressed the generalizability of the results. One was concerned that the scaling of the number of perturbations as 6<sup>n</sup> would limit the practical applicability of the method, and both asked whether and how the approach is generalizable to multi-allelic sequence spaces.</p><p>3) Another issue related to the practical application of the approach concerns the effect of measurement error. If measurement errors are not considered and there are many values close to each other, then the ranks could change significantly and the rank order could be heavily influenced by random noise, generating spuriously inferred interactions. The author states that “the results are not sensitive for a few false positives or negatives”, but this statement is not supported in the text aside from its assertion. This must be addressed (maybe through simulation?) before publication.</p><p>4) Reviewers #1 and #3 were concerned that the text assumes too much previous knowledge about fitness landscapes and specifically the polytope theory of Beerenwinkel et al., 2007, on the part of the reader. One reviewer found that the introduction of the “circuits from polytope theory” is not helpful and probably incomprehensible to readers who are not already familiar with the concept, and the other wondered how to understand remark 2.3 about “the class of circuits with non-zero coefficients for exactly four elements” when the word “element” has never been used before in the text. Perhaps a formal definition of circuits can be avoided by simply saying that circuits are linear combinations of the 4 genotypic fitness values that with coefficients +/-1 arranged in such a way that the expression vanishes when fitness is additive?</p><p>5) Reviewers #1 and #2 found that the discussion of the two rank orders that are compatible with additive fitness in the n=3 case in “Example 2.4” requires further clarification. What is “relabeling” in this context? And is it correct that the allowed orders are those where either the fitness is monotonic in the number of mutations, or at most one pair of genotypes violates this monotonicity, and this is a pair of genotypes with 1 and 2 mutations?</p><p>6) Reviewers #2 and #3 addressed the comparison to empirical data. Reviewer #2 was not convinced that the proposed method allows one to gain “new insights” beyond previous findings, and asks for further specification of the unique contribution of the method. Reviewer #3 suggests to place the results into the context of previous analyses of the same empirical landscapes [Ferretti et al., JTB 2016; Blanquart and Bataillon, Genetics 2016]. Moreover, it was not clear whether the proposed method (as applied to empirical landscapes) singles out the wild type sequence, or whether it treats all genotypes on the same footing.</p><p>7) Reviewer #1 requested further clarification of the precise relation between sign epistasis and signed interactions for different values of n (“Example 2.4”). It appears that the information contained in the manuscript regarding this point can be summarized as follows:</p><p>i) For n=2 loci instances of sign epistasis and signed interaction coincide.</p><p>ii) For n=3 and 4, any signed interaction corresponds either to an instance of sign epistasis or to a rectangular perturbation of higher order. If neither of these are present, the rank order is compatible with additive fitness.</p><p>iii) For more than 4 loci, the characterization by rectangular perturbations is insufficient to decide whether a rank order is compatible with additive fitness.</p><p>Statement (i) is obvious and well known, and the case n=3 has apparently been covered by the author through exhaustive enumeration. However, it is clear neither where the statement for n=4 comes from, nor in what sense the paper of Kraft et al., 1959, is relevant in the present context. Is there a characterization beyond rectangular perturbations that would apply for n &gt; 4, and what kind of objects would it involve?</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Rank orders and signed interactions in evolutionary biology&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Diethard Tautz (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>Major issue</p><p>The Results section does not read well in its present form and needs to be reorganized. Presently the section begins with a partial explanation of the theory, followed by the discussion of experimental and hypothetical examples, and the complete account of the theory is found at the end. As a consequence, several concepts and definitions (e.g., the expression for the interaction u and the conditions for sign epistasis and rectangular perturbations) are introduced twice. I suggest to subdivide the section into subsections to improve readability, and to present the theory fully in the first subsection. I would also suggest to emphasize the simple geometric meaning of the various expressions in terms of the squares and rectangles in Figures 1 and 2: The circuits in the set C are obtained by going around one of the square or rectangle and giving the genotype fitness values alternating signs along the way. Similarly the conditions for sign epistasis and higher order perturbations amount to comparing fitness differences (= directions of arrows) on two opposite sides of a square/rectangle. Regarding the hypothetical examples, there is something wrong with landscape B, since the genotypes with 3 1's are not peaks. Also, I did not find the discussion of the epistasis measure of Ferretti et al. very illuminating (and I did not understand why it is called \lambda instead of \gamma as in the original paper). It seems to me that both the hypothetical examples and the discussion of Ferretti et al. could be omitted without losing much content.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.51004.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) All three reviewers found that the manuscript was lacking in clarity and context. Specifically, they felt that both the motivating question of the manuscript (as it arises from the original eLife publication of Krona et al., 2017), and the final answer that is achieved need to be spelled out more clearly and concisely. Moreover, it was not clearly stated how the new method of epistasis analysis goes beyond more established approaches, and in what sense it &quot;add(s) precision to the analysis&quot;.</p></disp-quote><p>In line with the reviewers suggestions, I have expanded text in the Introduction on how the results connect to open problems from Crona et al., 2017, added a separate Discussion section that summarizes conclusions, and also added a discussion about measurement errors to the Materials and method section. Most important, I have provided more evidence that rectangular perturbation goes beyond established approaches.</p><p>A clarification regarding “added precision” is probably necessary. If the available information is complete fitness measurements of the preferred kind (say Wrightian fitness), then rank order methods cannot add precision. There are good reasons to consider rank orders anyway. Observations such as many peaks, prevalent sign epistasis and few trajectories to the global peak, provide intuition for the evolutionary potential.</p><p>The “added precision” refers to how rectangular perturbations perform as compared to other rank order based concepts, such as summary statistics on sign epistasis, accessible mutational trajectories, peaks or fitness graphs:</p><p>A) The new method has the ability to detect epistasis for landscapes, also if there is no sign epistasis. An empirical example has been added as proof of principle.</p><p>B) Similarly, the new method reveals evolutionary important differences for landscapes that cannot be distinguished by frequently used methods. Explicit examples have been added.</p><p>C) In addition, the revised manuscripts describes a case where one can apply rectangular perturbations for handling a problem with measurement errors in sign epistasis data.</p><p>Note: One example from the original manuscript (on <italic>Aspergillus Niger</italic>) was deleted, since the added examples probably are more instructive. From the other original example (on malaria), the more complete statistics on rectangular perturbations that includes replacements 00 → 11, seems more informative than statistics of sign epistasis alone. In general, it seems rather obvious that checking the effects of replacements 00 → 11, in addition to 0 → 1 (sign epistasis) is meaningful, especially since no effort is required.</p><disp-quote content-type="editor-comment"><p>2) Reviewers #2 and #3 addressed the generalizability of the results. One was concerned that the scaling of the number of perturbations as 6<sup>n</sup> would limit the practical applicability of the method, and both asked whether and how the approach is generalizable to multi-allelic sequence spaces.</p></disp-quote><p>In many cases it make sense to consider selected perturbations, depending on context. For very large systems, one can also sample genotypes and sets of loci and check for perturbations. (For a collection of [mostly] deleterious mutations, it would be interesting to check if replacements at several loci sometimes increase fitness.)</p><p>Rectangular perturbations can be defined for multi-allelic sequence spaces. However, a lot of theory on epistasis for biallelic n-locus systems (Walsh-coefficients, applications of the Fourier transform, fitness graphs) cannot easily be generalized to the multi-allelic case. Foundational work would be necessary for extending theoretical results to the multi-allelic case.</p><disp-quote content-type="editor-comment"><p>3) Another issue related to the practical application of the approach concerns the effect of measurement error. If measurement errors are not considered and there are many values close to each other, then the ranks could change significantly and the rank order could be heavily influenced by random noise, generating spuriously inferred interactions. The author states that &quot;the results are not sensitive for a few false positives or negatives&quot;, but this statement is not supported in the text aside from its assertion. This must be addressed (maybe through simulation?) before publication.</p></disp-quote><p>I think the claim: “the results are not sensitive for a few false positives or negatives” caused some confusion (what I intended to say was merely that the conclusion for this particular example would not change because of a small number of false positives/negatives). I have deleted the claim and added a discussion about measurement errors to the Materials and methods section. In addition, the revised manuscripts describes a case where one can apply rectangular perturbations for handling a problem with measurement errors for sign epistasis data (Figure 3 in the revised manuscript shows a related simulation).</p><disp-quote content-type="editor-comment"><p>4) Reviewers #1 and #3 were concerned that the text assumes too much previous knowledge about fitness landscapes and specifically the polytope theory of Beerenwinkel et al., 2007, on the part of the reader. One reviewer found that the introduction of the “circuits from polytope theory” is not helpful and probably incomprehensible to readers who are not already familiar with the concept, and the other wondered how to understand remark 2.3 about “the class of circuits with non-zero coefficients for exactly four elements” when the word “element” has never been used before in the text. Perhaps a formal definition of circuits can be avoided by simply saying that circuits are linear combinations of the 4 genotypic fitness values that with coefficients +/-1 arranged in such a way that the expression vanishes when fitness is additive?</p></disp-quote><p>The manuscript is supposed to be much easier than Beerenwinkel et al., 2007, and several other cited articles. Figure 2 is intended to explain everything a reader needs to know for understanding the main idea. I have followed the reviewers suggestion and replaced my original definition of the circuits we use with a brief description, and moved the discussion about general circuits to the Materials and methods section (some readers will appreciate the full context).</p><disp-quote content-type="editor-comment"><p>5) Reviewers #1 and #2 found that the discussion of the two rank orders that are compatible with additive fitness in the n=3 case in “Example 2.4” requires further clarification. What is &quot;relabeling&quot; in this context? And is it correct that the allowed orders are those where either the fitness is monotonic in the number of mutations, or at most one pair of genotypes violates this monotonicity, and this is a pair of genotypes with 1 and 2 mutations?</p></disp-quote><p>In brief, a pair of rank order differ by labels only, if there exists a cube isomorphism that induces a map between the rank orders. A detailed description has been added to the Materials and methods section.</p><p>Yes, the claim is correct. For clarity, if we assume that ω<sub>000</sub> &lt; ω<sub>g</sub> for each <italic>g</italic> ≠ 000, then additivity would imply that ω <sub>111</sub>&gt; ω g for all <italic>g</italic> ≠ 111. If we also assume ω <sub>100</sub>&gt; ω <sub>010</sub>&gt; ω <sub>001</sub>, then the additivity assumption will impose further conditions on the rank order. A remaining question is whether ω 100 &gt; ω <sub>011</sub>or ω <sub>100</sub>&lt; ω <sub>011</sub>. If that question has been answered, the order is completely determined.</p><disp-quote content-type="editor-comment"><p>6) Reviewers #2 and #3 addressed the comparison to empirical data. Reviewer #2 was not convinced that the proposed method allows one to gain “new insights” beyond previous findings, and asks for further specification of the unique contribution of the method. Reviewer #3 suggests to place the results into the context of prevous analyses of the same empirical landscapes [Ferretti et al., JTB 2016; Blanquart and Bataillon, Genetics 2016]. Moreover, it was not clear whether the proposed method (as applied to empirical landscapes) singles out the wild type sequence, or whether it treats all genotypes on the same footing.</p></disp-quote><p>My response to comment 1 answers this question as well. In particular, an analysis of sign epistasis alone does neither have the same ability to rule out additive fitness, nor to capture global aspects, as a complete analysis of rectangular perturbation has.</p><p>For clarity, I have rephrased the text in one place in the revised manuscript. The new text is: “As proof of principle, we demonstrate that the large rectangles give new insights for two empirical studies (as compared to an analysis of sign epistasis)”.</p><p>I have added a remark about measures λ and λ* from Ferrettti et al., 2016. The proposed methods does not single out the wild type sequence. If the genotypes of highest and lowest fitness have maximal distance, it would be perhaps be most natural to assign the zero-string label to the genotype of lowest fitness (regardless if wild-type or not).</p><disp-quote content-type="editor-comment"><p>7) Reviewer #1 requested further clarification of the precise relation between sign epistasis and signed interactions for different values of n (“Example 2.4”). It appears that the information contained in the manuscript regarding this point can be summarized as follows:</p><p>i) For n=2 loci instances of sign epistasis and signed interaction coincide.</p><p>ii) For n=3 and 4, any signed interaction corresponds either to an instance of sign epistasis or to a rectangular perturbation of higher order. If neither of these are present, the rank order is compatible with additive fitness.</p><p>iii) For more than 4 loci, the characterization by rectangular perturbations is insufficient to decide whether a rank order is compatible with additive fitness.</p><p>Statement (i) is obvious and well known, and the case n=3 has apparently been covered by the author through exhaustive enumeration. However, it is clear neither where the statement for n=4 comes from, nor in what sense the paper of Kraft et al., 1959, is relevant in the present context. Is there a characterization beyond rectangular perturbations that would apply for n &gt; 4, and what kind of objects would it involve?</p></disp-quote><p>If the rank order implies that υ &gt; 0 for n = 2, we do not know whether or not the system has reciprocal sign epistasis. All we know is that the system has sign epistasis. In other words, signed circuits do not reveal complete information about sign epistasis, not even for n = 2. Similarly, a signed circuit interaction for c ε C tells us that there are one or two perturbations corresponding to c (differently expressed, one or two pairs of parallel arrows in the corresponding rectangle disagree). Note that potential rectangular perturbations are exactly twice as many as the number of circuits in C.</p><p>As for additivity, checking rectangular perturbations is sufficient for n <underline>&lt;</underline> 4. The case n = 4 is reasonably straight forward from a computational point of view (the Materials and methods section describes how one can verify the claim). The reviewer’s last question is very interesting. Some relevant results are in Maclagan, 1999, and work that cites the paper (in particular detailed statistics for n = 5). However, the theoretical understanding for rank orders and additivity is limited. Because of the questions I have made several changes:</p><p>a) added explanations and clarifications for n = 3; 4.</p><p>b) In addition to my reference to Kraft et al., 1969, a reference to Maclagan, 1999, has been added. Maclagan gives an explicit counterexample (which is probably easier to understand), and I have provided a “dictionary” that explains concepts and notation in the paper so that an interested reader can check.</p><p>c) I have described how one can determine if a given rank order is compatible with additivity in the Materials and methods section.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>Major issue</p><p>The Results section does not read well in its present form and needs to be reorganized. Presently the section begins with a partial explanation of the theory, followed by the discussion of experimental and hypothetical examples, and the complete account of the theory is found at the end. As a consequence, several concepts and definitions (e.g., the expression for the interaction u and the conditions for sign epistasis and rectangular perturbations) are introduced twice. I suggest to subdivide the section into subsections to improve readability, and to present the theory fully in the first subsection. I would also suggest to emphasize the simple geometric meaning of the various expressions in terms of the squares and rectangles in Figures 1 and 2: The circuits in the set C are obtained by going around one of the square or rectangle and giving the genotype fitness values alternating signs along the way. Similarly the conditions for sign epistasis and higher order perturbations amount to comparing fitness differences (= directions of arrows) on two opposite sides of a square/rectangle. Regarding the hypothetical examples, there is something wrong with landscape B, since the genotypes with 3 1's are not peaks. Also, I did not find the discussion of the epistasis measure of Ferretti et al. very illuminating (and I did not understand why it is called \lambda instead of \gamma as in the original paper). It seems to me that both the hypothetical examples and the discussion of Ferretti et al. could be omitted without losing much content.</p></disp-quote><p>I have restructured the result section accordingly. However, there are still some “repeats” of concepts, because I first discuss the two-locus case in some detail, and then (immediately after in the revised version) the general case, so as not to overwhelm the reader.</p><p>I have removed the hypothetical examples and the discussion of the measures introduced in Ferretti et al., 2016, in line with the suggestions. (My reason for adding the examples in the first place was that I thought reviewers wanted more evidence for that the proposed method differs from checking for sign epistasis, but I don’t insist on the examples.)</p><p>I have also added the clarifications requested (see below).</p><disp-quote content-type="editor-comment"><p>I would also suggest to emphasize the simple geometric meaning of the various expressions in terms of the squares and rectangles in Figures 1 and 2: The circuits in the set C are obtained by going around one of the square or rectangle and giving the genotype fitness values alternating signs along the way.</p></disp-quote><p>A similar text has been added after the definition of rectangular perturbations.</p><disp-quote content-type="editor-comment"><p>Similarly the conditions for sign epistasis and higher order perturbations amount to comparing fitness differences (= directions of arrows) on two opposite sides of a square/rectangle.</p></disp-quote><p>A similar comment has been added right before the remarks in the result section.</p></body></sub-article></article>