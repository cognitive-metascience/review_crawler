<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">44359</article-id><article-id pub-id-type="doi">10.7554/eLife.44359</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Environmental heterogeneity can tip the population genetics of range expansions</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-122277"><name><surname>Gralka</surname><given-names>Matti</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4599-1859</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-101650"><name><surname>Hallatschek</surname><given-names>Oskar</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1312-5975</contrib-id><email>ohallats@berkeley.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Physics</institution><institution>University of California, Berkeley</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Integrative Biology</institution><institution>University of California, Berkeley</institution><addr-line><named-content content-type="city">Berkeley</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewing Editor</role><aff><institution>University of Basel</institution><country>Switzerland</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Baldwin</surname><given-names>Ian T</given-names></name><role>Senior Editor</role><aff><institution>Max Planck Institute for Chemical Ecology</institution><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Department of Civil and Environmental Engineering, Massachusetts Institute of Technology, Cambridge, United States</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>12</day><month>04</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e44359</elocation-id><history><date date-type="received" iso-8601-date="2018-12-18"><day>18</day><month>12</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-04-11"><day>11</day><month>04</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Gralka and Hallatschek</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Gralka and Hallatschek</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-44359-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.44359.001</object-id><p>The population genetics of most range expansions is thought to be shaped by the competition between Darwinian selection and random genetic drift at the range margins. Here, we show that the evolutionary dynamics during range expansions is highly sensitive to additional fluctuations induced by environmental heterogeneities. Tracking mutant clones with a tunable fitness effect in bacterial colonies grown on randomly patterned surfaces we found that environmental heterogeneity can dramatically reduce the efficacy of selection. Time-lapse microscopy and computer simulations suggest that this effect arises generically from a local 'pinning’ of the expansion front, whereby stretches of the front are slowed down on a length scale that depends on the structure of the environmental heterogeneity. This pinning focuses the range expansion into a small number of 'lucky’ individuals with access to expansion paths, altering the neutral evolutionary dynamics and increasing the importance of chance relative to selection.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.44359.002</object-id><title>eLife digest</title><p>Throughout evolution, countless populations have expanded their territories by invading new areas. This invasion can happen on the scale of kilometers and millennia – such as when humans migrated out of Africa – or millimeters and months, such as the growth of a population of cells in a solid tumor. During this expansion, mutations can occur that can either increase or decrease fitness in the new territory. If a favorable mutation occurs at the edge of the population, then it has plenty of room to expand. Such a mutation has a high chance of becoming established, and so it can have a very strong impact on the genetic makeup of the population. This increase in evolutionary advantage in individuals at the front is called “gene surfing”.</p><p>This phenomenon is well known in populations living in “homogeneous” territories, where the new space a population is invading is more or less the same as the one they already occupy – think of the endless flat grasslands of the Siberian steppes. But in reality, many territories are not like that. What happens if the new territory is not completely homogeneous? For instance, if a species’ expansion is impeded by a mountain range with a series of valleys.</p><p>Gralka and Hallatschek investigated how such changes in landscape could affect phenomena like gene surfing. Experiments using <italic>E. coli</italic> as a model system and computer simulations showed that a varied environment – such as roughness akin to a mountain range and valleys, but on a bacterial scale – had a strong influence on the fate of mutations arising in a population. Whether the environment is favorable for expansion or not in the place where the mutation happens becomes much more important than how the mutation itself affects fitness. So, if a beneficial mutation occurs at a cliff-edge, it is not likely to get far. But if it happens at a population edge by the bacterial equivalent of gently rolling hills, there is a much better chance of the mutation taking hold.</p><p>The findings suggest that the amount a population can adapt during expansion is limited, and it can even lead to the spread of harmful mutations in a population if they occur in just the right spot. Piecing together these scenarios is important in order to accurately infer the evolutionary history of a species based on mutations present in its genome now. This type of knowledge can also be useful in developing new treatments for cancers, making use of these evolutionary processes to slow or halt a tumor’s expansion.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>evolutionary dynamics</kwd><kwd>range expansions</kwd><kwd>microbial ecology</kwd><kwd>environmental heterogeneity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Hallatschek</surname><given-names>Oskar</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Hallatschek</surname><given-names>Oskar</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Hallatschek</surname><given-names>Oskar</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Environmental heterogeneity can dramatically reduce the efficacy of selection and alter the neutral evolutionary dynamics in microbial range expansions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Stochasticity and its competition with deterministic forces plays an integral role in biology, such as in stochastic gene expression, cellular decision making, and cell differentiation (<xref ref-type="bibr" rid="bib3">Balázsi et al., 2011</xref>). Stochastic processes are also at the heart of evolutionary dynamics: not only do the mutations entering a population occur at random times in random individuals and at random positions in their genome, but in addition the fate of a mutation and its clonal lineage is largely stochastic and only partly determined by its effect on the individual’s fitness.</p><p>The random fluctuations in the frequency of a mutant allele due to the stochasticity associated with reproduction are called genetic drift. Genetic drift is particularly strong at the front of range expansions, where only a relatively small number of individuals at the front of the expansion contributes to future growth and thus has any influence on the future genotypic composition of the population. The neutral diversity and adaptation in spatially expanding populations has been studied in computer simulations (<xref ref-type="bibr" rid="bib15">Edmonds et al., 2004</xref>; <xref ref-type="bibr" rid="bib38">Klopfstein et al., 2006</xref>; <xref ref-type="bibr" rid="bib42">Kuhr et al., 2011</xref>; <xref ref-type="bibr" rid="bib43">Kuhr and Stark, 2015</xref>; <xref ref-type="bibr" rid="bib45">Lavrentovich and Nelson, 2014</xref>; <xref ref-type="bibr" rid="bib53">Otwinowski and Krug, 2014</xref>), in the field (<xref ref-type="bibr" rid="bib55">Ramachandran et al., 2005</xref>; <xref ref-type="bibr" rid="bib64">White et al., 2013</xref>; <xref ref-type="bibr" rid="bib48">Louppe et al., 2017</xref>), and in microbial colonies (<xref ref-type="bibr" rid="bib28">Hallatschek et al., 2007</xref>; <xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>; <xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>; <xref ref-type="bibr" rid="bib40">Korolev et al., 2011</xref>), which can serve as a useful model system because short generation times and ease of handling allow for quantitative investigations of the evolutionary dynamics of range expansions. In microbial colonies, nutrient gradients and mechanical effects limit the number of proliferating individuals to a small region close to the colony perimeter called the growth layer (<xref ref-type="bibr" rid="bib26">Grant et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>; <xref ref-type="bibr" rid="bib61">Warren et al., 2019</xref>). For mutations occurring inside the growth layer, most mutant offspring are concentrated in a relatively small number of enormously successful lineages that manage to remain at the front and 'surf’ on the expanding population wave (<xref ref-type="bibr" rid="bib16">Excoffier and Ray, 2008</xref>). As a consequence, the evolutionary dynamics is different in microbial colonies compared with well-mixed populations. For instance, the clones (that is the collection of the initial mutant’s offspring) of spontaneous neutral mutations often reach much larger sizes (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>), and existing beneficial variants can sweep to high frequency much faster in microbial colonies than in well-mixed populations (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>). Conversely, deleterious mutations are predicted to remain at the population frontier for extended periods because genetic drift is strong at the front, which prevents selection from efficiently weeding out deleterious alleles (<xref ref-type="bibr" rid="bib58">Travis et al., 2007</xref>; <xref ref-type="bibr" rid="bib10">Burton and Travis, 2008</xref>; <xref ref-type="bibr" rid="bib44">Lavrentovich et al., 2016</xref>; <xref ref-type="bibr" rid="bib54">Peischl et al., 2013</xref>; <xref ref-type="bibr" rid="bib23">Gralka et al., 2016a</xref>). The quantitative outcome of the competition of selection and genetic drift in microbial colonies is determined by the local shape and roughness of the front (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>; <xref ref-type="bibr" rid="bib18">Farrell et al., 2017</xref>), which in turn is determined by microscopic details, such as cell-cell adhesion or cell morphology shaping the mechanical interactions between cells (<xref ref-type="bibr" rid="bib35">Kayser et al., 2018b</xref>; <xref ref-type="bibr" rid="bib34">Kayser et al., 2018a</xref>; <xref ref-type="bibr" rid="bib22">Giometto et al., 2018</xref>), although the direct mapping is typically unknown (<xref ref-type="bibr" rid="bib18">Farrell et al., 2017</xref>).</p><p>The evolutionary effects of fluctuations at expanding microbial population fronts have been studied in depth, but these studies have focused only on fluctuations associated with the growth, division, and random motion of cells, whose strength may depend on <italic>intrinsic</italic> properties of the microbial species, in homogeneous environments. However, any range expansion will experience varying degrees of environmental heterogeneity, which can be viewed as a source of <italic>extrinsic</italic> noise. In macro-ecology, it has long been realized that environmental heterogeneity can dramatically alter the invasion dynamics of invasive species (<xref ref-type="bibr" rid="bib65">With, 1997</xref>; <xref ref-type="bibr" rid="bib66">With, 2002</xref>) or the genetic diversity after macroscopic range expansion (<xref ref-type="bibr" rid="bib62">Wegmann et al., 2006</xref>). By contrast, how the evolutionary dynamics in microbial populations is affected by environmental heterogeneity in the form of, for example locally varying nutrient availability, temperature gradients, or imperfections in the growth substrate, has received much less attention. Experimental efforts have concentrated mostly on simple temporal and spatial gradients in antibiotic concentration, which have been shown to facilitate the emergence of resistance in shaken cultures (<xref ref-type="bibr" rid="bib47">Lindsey et al., 2013</xref>), microfluidic devices (<xref ref-type="bibr" rid="bib67">Zhang et al., 2011</xref>) and on agar plates (<xref ref-type="bibr" rid="bib5">Baym et al., 2016</xref>), as predicted by theory (<xref ref-type="bibr" rid="bib27">Greulich et al., 2012</xref>; <xref ref-type="bibr" rid="bib25">Gralka et al., 2017</xref>; <xref ref-type="bibr" rid="bib29">Hermsen et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Hermsen, 2016</xref>; <xref ref-type="bibr" rid="bib31">Hermsen and Hwa, 2010</xref>).</p><p>The effects of spatial heterogeneity on evolutionary dynamics in expanding microbial populations have been studied in experiments only with neutral alleles in fixed geometries, such as isolated obstacles creating 'geometry-enhanced’ genetic drift (<xref ref-type="bibr" rid="bib49">Möbius et al., 2015</xref>; <xref ref-type="bibr" rid="bib6">Beller et al., 2018</xref>). These studies have shown that obstacles obstructing locally the advance of the front can doom lineages that happen to lie on the blocked part of the expanding population, whereas unobstructed lineages close to the edge of the obstacles obtain a boost as they fill the vacant area behind the obstacle. Even for neutral alleles, however, not much is known about the evolutionary dynamics in more complex heterogeneous environments. Moreover, selection during range expansions can dramatically alter the population structure over just a few generations (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>), but how the action of selection is affected by environmental heterogeneity has so far remained completely unexplored.</p><p>Here, we study the impact of complex environmental heterogeneities on the growth and evolutionary dynamics of microbial colonies. To this end, we introduce plasmid loss in <italic>E. coli</italic> as a model system for spontaneous mutations with tunable growth rate effects whose clones can be tracked under the microscope. By growing colonies on solid substrates with a weakly patterned surface with random microscopic features much bigger than individual cells, but much smaller than the whole colony, we find that environmental heterogeneity can overpower selection such that even strongly beneficial mutations are unable to establish at rates higher than expected for neutral mutations. Using a minimal computer model of populations expanding in randomly disordered environments, we show that dramatic changes in the efficacy of selection can arise from a local 'pinning’ of the expansion front, whereby stretches of the front are slowed down on a length scale that depends on the structure of the environmental heterogeneity. This pinning focuses the range expansion into a small number of individuals with access to expansion paths, increasing the importance of chance and thus limiting the efficacy of selection. We expect these results to generalize to other spatially growing populations, such as biofilms, tumors, and invasive species, when the growing population front is transiently hindered by the local environment.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Experiments</title><p>We grew colonies from single cells of a strain of <italic>E. coli</italic> MG1655 carrying a plasmid that is costly to produce, resulting in a <inline-formula><mml:math id="inf1"><mml:mrow><mml:mn>20</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> growth rate disadvantage <inline-formula><mml:math id="inf2"><mml:mi>s</mml:mi></mml:math></inline-formula> in plasmid-bearing cells compared to their plasmid-less (but otherwise isogenic) conspecifics (<xref ref-type="fig" rid="fig1">Figure 1</xref>). This strain loses the plasmid stochastically at a rate of about <inline-formula><mml:math id="inf3"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> per cell division (approximately independent of antibiotic concentration, see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The plasmid codes for a fluorescence gene and confers resistance to the antibiotic doxycycline (<italic>dox</italic>, a tetracycline analog) such that when grown at increasing antibiotic concentrations, cells missing the plasmid grow more and more slowly, until they eventually grow more slowly than cells harboring the plasmid (for <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0.3</mml:mn><mml:mi>μ</mml:mi><mml:mi>g</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), despite the inherent cost associated with bearing the plasmid. This allowed us to treat plasmid loss effectively as a spontaneous mutation whose fitness effect <inline-formula><mml:math id="inf5"><mml:mi>s</mml:mi></mml:math></inline-formula>, that is the relative growth rate difference between the plasmid-bearing ('wild type’) and non-bearing ('mutant’) cells, we can finely tune from +20% to -15% by varying the amount of doxycycline in the growth media (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>), thus making the mutation either beneficial, neutral or deleterious. Since plasmid loss in our system is also coupled with a loss in fluorescence, we can easily detect mutant clones, that is the individual cell that incurred the mutation originally and its offspring, under the microscope as dark patches in the colonies (see <xref ref-type="fig" rid="fig1">Figure 1</xref>), allowing us to observe the evolutionary dynamics in real time. Our approach extends previous experimental model systems for evolutionary dynamics during microbial range expansion that employed either an initial mixture of wild-type and mutant cells (<xref ref-type="bibr" rid="bib28">Hallatschek et al., 2007</xref>; <xref ref-type="bibr" rid="bib59">Van Dyken et al., 2013</xref>; <xref ref-type="bibr" rid="bib51">Müller et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>; <xref ref-type="bibr" rid="bib41">Korolev et al., 2012</xref>; <xref ref-type="bibr" rid="bib34">Kayser et al., 2018a</xref>) or were confined to spontaneous neutral (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>) or deleterious (<xref ref-type="bibr" rid="bib44">Lavrentovich et al., 2016</xref>) mutations. The ability to track spontaneous mutations in colonies grown from single cells is essential to ensure identical starting conditions in our experiments, allowing a quantitative comparison of the evolutionary outcomes between the two growth conditions.</p><fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.003</object-id><label>Figure 1.</label><caption><title>Substrate roughness impacts bacterial colony morphology.</title><p>(<bold>a</bold> and <bold>b</bold>) Colonies of <italic>E. coli</italic> were grown from single cells harboring a plasmid containing a fluorescence gene and a resistance cassette. Loss of the plasmid leads to non-fluorescent ('mutant’) sectors in the population that expand at the expense of the fluorescent ('wild-type’) population. Colony morphology depends on whether the colony is grown on smooth (<bold>c</bold>) or rough (<bold>d</bold>) agar surfaces (Materials and methods). White scale bars are 2 mm. (<bold>e</bold>) On rough surfaces, troughs in the surface direct growth along them, leading to locally accelerated regions (arrows) that widen slowly and are eventually integrated with the bulk of the population.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>Likelihood of mutation rate for two different concentrations of doxycycline.</title><p>Only the curves with the maximum likelihood value for <inline-formula><mml:math id="inf6"><mml:mi>s</mml:mi></mml:math></inline-formula> are shown.</p><p><supplementary-material id="fig1s1sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.005</object-id><label>Figure 1—figure supplement 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> (Likelihood of mutation rates).</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-44359-fig1-figsupp1-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig1-figsupp1-v2.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.006</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Analysis of substrate roughness.</title><p>(<bold>a</bold>) Microscopic image of an agar surface patterned with filter paper as described in Materials and methods. The image was created by stitching together six images taken on a Dektak 150 profilometer under oblique illumation. Light areas correspond to elevations, dark areas to troughs. (<bold>b</bold>) Traces along the vertical direction in panel (<bold>a</bold>), shifted for visibility (see Materials and methods). The mean roughness is 10 ± 1 μm, with a range of elevations to troughs of 50 μm. (<bold>c</bold>) Close-up of longer runs in (<bold>b</bold>). (<bold>d</bold>) Estimating the density of 'obstacles’, that is parts of the patterns that are significantly elevated compared to their surroundings. The images are binarized version of the area between the dashed lines in (<bold>a</bold>), using the LocalAdaptativeBinarize function in Mathematica with at 15 pixel radius; pixels are scored as one if they are brighter than <inline-formula><mml:math id="inf7"><mml:mrow><mml:mrow><mml:mn>0.8</mml:mn><mml:mo>×</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>×</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf8"><mml:mi>μ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf9"><mml:mi>σ</mml:mi></mml:math></inline-formula> are the local mean and standard deviation in intensity, and <inline-formula><mml:math id="inf10"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is an intensity shift. The dependence of the proportion of pixels scored as one on <inline-formula><mml:math id="inf11"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is shown in the plot in (<bold>d</bold>). (<bold>e</bold>) For different values of <inline-formula><mml:math id="inf12"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>, histograms of the distances <inline-formula><mml:math id="inf13"><mml:mi>x</mml:mi></mml:math></inline-formula> of dark pixels from the nearest white pixel, showing that the width of 'valleys’, i.e., the distance between adjacent ridges, is limited to ≤25 μm (twice the range of <inline-formula><mml:math id="inf14"><mml:mi>x</mml:mi></mml:math></inline-formula>).</p><p><supplementary-material id="fig1s2sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.007</object-id><label>Figure 1—figure supplement 2—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> (Five stylus runs to measure substrate roughness).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig1-figsupp2-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig1-figsupp2-v2.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.008</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Roughness of <italic>E.coli</italic> colonies on smooth and rough substrates, defined as the mean square deviation from the best-fit circle.</title><p>Colony boundaries were extracted and the variance <inline-formula><mml:math id="inf15"><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> of the radius fluctuations measured over different window lengths <inline-formula><mml:math id="inf16"><mml:mi>l</mml:mi></mml:math></inline-formula>. For interfaces in the KPZ universality class, <inline-formula><mml:math id="inf17"><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>∼</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula>. Points are averages over 118 (smooth) and 193 (rough) colonies, error bars are smaller than the symbols.</p><p><supplementary-material id="fig1s3sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.009</object-id><label>Figure 1—figure supplement 3—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref> (Roughness of smooth and rough colonies).</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-44359-fig1-figsupp3-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig1-figsupp3-v2.tif"/></fig></fig-group><p>To investigate the impact of environmental heterogeneity on colony growth and adaptation dynamics, we grew the colonies on two different substrates (<xref ref-type="fig" rid="fig1">Figure 1</xref>): standard, 'smooth’, agar plates as well as agar surfaces with random microscopic features, created by depositing filter paper onto melted agar and removing it after cooling and drying (see Materials and methods). The resulting substrate had an average roughness (i.e., standard deviation of the substrate height) of 10 μm with ridges and valleys much wider than individual cells (about 15–30 μm), but small compared to whole colonies (see <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> for a detailed characterization of the rough substrates). Notably, the width of the valleys is comparable to the growth layer width of <italic>E. coli</italic> colonies (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>), which is the fundamental length scale characterizing the range of mechanical interactions within microbial colonies (<xref ref-type="bibr" rid="bib34">Kayser et al., 2018a</xref>).</p><p>Colonies grew more slowly on these rough substrates compared to smooth substrates (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), but this disorder-induced reduction in radial growth rate was consistent between wild-type and mutant cells, such that their selective difference <inline-formula><mml:math id="inf18"><mml:mi>s</mml:mi></mml:math></inline-formula>, defined as the difference between colony expansion rates, normalized by the wild-type colony expansion rate, was independent of surface structure (<xref ref-type="fig" rid="fig2">Figure 2b–c</xref>). Colonies grown on rough substrates (hereafter called 'rough’ colonies) also had a rougher front line (see <xref ref-type="fig" rid="fig1">Figure 1d</xref> and <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>) than those grown on smooth substrates ('smooth’ colonies), and displayed branch-like outgrowths where the bacteria tended to colonize grooves in the agar surface much faster than the surrounding areas (<xref ref-type="fig" rid="fig1">Figure 1e</xref>, arrows). These branches grew far ahead of the rest of the population, becoming visible at a width of about 20 μm (consistent with the width of the valleys in the substrate), and broadened as they were incorporated into the bulk of the colony. This kind of growth pattern is reminiscent of the 'pinning’ phenomenon observed in the study of interfaces in heterogeneous media, such as the capillary rise of water or autocatalytic fluid interfaces in porous media (<xref ref-type="bibr" rid="bib13">Delker et al., 1996</xref>; <xref ref-type="bibr" rid="bib2">Atis et al., 2015</xref>), macro-ecological species invasions (<xref ref-type="bibr" rid="bib36">Keitt et al., 2001</xref>), or magnetic domains (<xref ref-type="bibr" rid="bib46">Lemerle et al., 1998</xref>). Pinning refers to the effect whereby certain regions of an expanding interface are slowed or even stopped entirely in their advance by heterogeneities, whereas other regions can advance unimpeded. Given the importance of the front morphology for evolutionary dynamics (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>; <xref ref-type="bibr" rid="bib18">Farrell et al., 2017</xref>), we hypothesized that by changing the growth patterns of rough colonies, the structured agar surface should also impact the dynamics of spontaneous mutations.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.010</object-id><label>Figure 2.</label><caption><title>Substrate roughness limits the efficacy of selection in bacterial colonies.</title><p>(<bold>a–c</bold>) The roughness of the growth substrate reduces the radial expansion rate but has no impact on the relative growth rates between mutants and wild type (averages over four colonies per condition, shaded areas in panel (<bold>a</bold>) are ± 1 standard deviation). (<bold>d</bold>) The final mutant frequency <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> (measured as the area fraction of non-fluorescent clones in the colonies, shown in white outline in sketch above) after 3 days of growth for mutants of a given fitness (dis)advantage <inline-formula><mml:math id="inf20"><mml:mi>s</mml:mi></mml:math></inline-formula> differed strongly depending on the roughness of the surface they were grown on, despite relative growth rate differences <inline-formula><mml:math id="inf21"><mml:mi>s</mml:mi></mml:math></inline-formula> being comparable (<bold>c</bold>) (throughout, points are averages over colonies, see <xref ref-type="table" rid="table1">Table 1</xref>, error bars are ± 1 standard deviation). The number of establishing sectors (<bold>e</bold>) was much smaller in rough colonies, with typically no more than two sectors per colony even for large <inline-formula><mml:math id="inf22"><mml:mi>s</mml:mi></mml:math></inline-formula>. The sizes of individual clones are broadly distributed on both substrates (see also <xref ref-type="fig" rid="fig3">Figure 3</xref>), but the mean clone size (<bold>f</bold>) did not vary as strongly with <inline-formula><mml:math id="inf23"><mml:mi>s</mml:mi></mml:math></inline-formula> in rough colonies as it did in smooth colonies.</p><p><supplementary-material id="fig2sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.020</object-id><label>Figure 2—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2">Figure 2</xref>.</title><p>colony radii.csv Source data for panel b (colony radii over time). fMT data.csv Source data for panel d (mutant frequency vs selective difference <inline-formula><mml:math id="inf24"><mml:mi>s</mml:mi></mml:math></inline-formula> for rough and smooth substrates). sectors data.csv Source data for panel e (number sectors vs selective difference <inline-formula><mml:math id="inf25"><mml:mi>s</mml:mi></mml:math></inline-formula> for rough and smooth substrates). fClone data.csv Source data for panel f (area fraction of individual clones vs selective difference <inline-formula><mml:math id="inf26"><mml:mi>s</mml:mi></mml:math></inline-formula> for rough and smooth substrates).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig2-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.011</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Selective difference between mutants and wild type at different concentrations of doxycycline.</title><p>For low antibiotic concentrations, plasmid loss is beneficial such that mutants have an advantage, while the mutants become first neutral and then deleterious for higher concentrations. Points are averages over 12 colony collisions, error bars are standard error of the mean.</p><p><supplementary-material id="fig2s1sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.012</object-id><label>Figure 2—figure supplement 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> (Fitness measurements at various concentrations of doxycycline).</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-44359-fig2-figsupp1-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.013</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Mutant frequency <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> as a function of radius <inline-formula><mml:math id="inf28"><mml:mi>r</mml:mi></mml:math></inline-formula> (see panel (<bold>c</bold>) for schematic), for smooth (<bold>a–b</bold>) and rough (<bold>d–e</bold>) colonies.</title><p>The traces are approximately quadratic in <inline-formula><mml:math id="inf29"><mml:mi>r</mml:mi></mml:math></inline-formula>, such that we can fit straight lines to the square-root transformed traces whose slopes provide a useful summary observable of the traces, shown in panel (<bold>f</bold>).</p><p><supplementary-material id="fig2s2sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.014</object-id><label>Figure 2—figure supplement 2—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> (Mutant frequency <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> as a function of radius <inline-formula><mml:math id="inf31"><mml:mi>r</mml:mi></mml:math></inline-formula> for smooth and rough colonies).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig2-figsupp2-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.015</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Population size of colonies estimated by measuring colony height and area, and by resuspending and measuring the resulting optical density.</title><p>The black line has slope 1. Note that the colonies were chosen to span a wide range of sizes; their sizes are not representative of the overall distribution of colony sizes.</p><p><supplementary-material id="fig2s3sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.016</object-id><label>Figure 2—figure supplement 3—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref> (Colony sizes on rough and smooth substrates).</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-44359-fig2-figsupp3-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.017</object-id><label>Figure 2—figure supplement 4.</label><caption><title>Final frequency of mutants after 3 days of growth, on smooth (red) and rough (blue) plates.</title><p>Same data as <xref ref-type="fig" rid="fig2">Figure 2a</xref>, plotted on a semi-logarithmic scale.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig2-figsupp4-v2.tif"/></fig><fig id="fig2s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.018</object-id><label>Figure 2—figure supplement 5.</label><caption><title>Mutant frequency measured in colonies grown on smooth and rough substrates at five doxycycline concentrations (converted to fitness differences <inline-formula><mml:math id="inf32"><mml:mi>s</mml:mi></mml:math></inline-formula> as described in the main text) in a biological replicate experiment.</title><p>Error bars are ± 1 standard deviation.</p><p><supplementary-material id="fig2s5sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.019</object-id><label>Figure 2—figure supplement 5—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref> (Mutant frequency <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> vs selective difference <inline-formula><mml:math id="inf34"><mml:mi>s</mml:mi></mml:math></inline-formula> in replicate experiment).</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-44359-fig2-figsupp5-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig2-figsupp5-v2.tif"/></fig></fig-group><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.023</object-id><label>Table 1.</label><caption><title>Number of colonies assayed for each condition.</title><p>Pilot experiment one is reported in <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>, experiment two is reported in the main text.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Experiment 1 (<xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>)</th><th/><th/><th/><th/><th/><th/><th/><th/><th/><th/><th/><th/><th/><th/></tr></thead><tbody><tr><td>dox (μg/ml)</td><td>0</td><td>0.2</td><td>0.4</td><td>0.6</td><td>0.8</td><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>n (smooth)</td><td>13</td><td>16</td><td>16</td><td>20</td><td>21</td><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>n (rough)</td><td>11</td><td>20</td><td>16</td><td>19</td><td>14</td><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td><bold>Experiment 2 (main text)</bold></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>dox (μg/ml)</td><td>0</td><td>0.05</td><td>0.1</td><td>0.15</td><td>0.2</td><td>0.25</td><td>0.3</td><td>0.35</td><td>0.4</td><td>0.5</td><td>0.6</td><td>0.7</td><td>0.9</td><td>1.1</td></tr><tr><td>n (smooth)</td><td>8</td><td>30</td><td>37</td><td>26</td><td>31</td><td>27</td><td>32</td><td>41</td><td>30</td><td>36</td><td>30</td><td>24</td><td>31</td><td>28</td></tr><tr><td>n (rough)</td><td>20</td><td>24</td><td>32</td><td>20</td><td>32</td><td>25</td><td>19</td><td>22</td><td>31</td><td>28</td><td>18</td><td>19</td><td>27</td><td>29</td></tr></tbody></table></table-wrap><p>The primary readout of our experiments is the final mutant frequency <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> in the colony and the number of surviving mutant clones (sectors) as a function of the selective advantage <inline-formula><mml:math id="inf36"><mml:mi>s</mml:mi></mml:math></inline-formula> that the mutation confers. These measures are proxies for the degree of adaptation of the population during the expansion process and the success probability of spontaneous mutations in shaping the composition of the population, respectively. Thus, our system gives us direct access to population genetic measures of interest. Alternatively, one can measure the frequency of mutants at the colony perimeter, which has a more direct influence on the future genetic composition of the population at the front. However, this measure can quickly become uninformative for beneficial mutations as mutants overtake the whole perimeter, and it is often difficult to measure accurately because of the low fluorescence signal at the front. The mutant frequency averaged over the whole population still gives a good, if conservative, measure of the mutant frequency at the perimeter.</p><p>On smooth substrates, in accord with previous experimental results (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>; <xref ref-type="bibr" rid="bib41">Korolev et al., 2012</xref>), advantageous mutants increased in frequency <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> rapidly as the colony grew (see <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> for an analysis of the mutant dynamics over time): for <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, mutants made up roughly half of the total population (<xref ref-type="fig" rid="fig2">Figure 2d</xref>) after 72 hrs. At higher antibiotic concentration, mutants became first neutral and eventually deleterious (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>), and accordingly, the final mutant frequency was lower, decreasing approximately exponentially with the fitness cost <inline-formula><mml:math id="inf39"><mml:mi>s</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>) such that strongly deleterious mutants made up only a small fraction of the final population.</p><p>On rough substrates, deleterious and neutral mutants remained at frequencies comparable to those observed in smooth colonies at the corresponding values of the fitness (dis)advantage <inline-formula><mml:math id="inf40"><mml:mi>s</mml:mi></mml:math></inline-formula>. However, in contrast to smooth colonies, beneficial mutants in rough colonies did not increase in frequency with <inline-formula><mml:math id="inf41"><mml:mi>s</mml:mi></mml:math></inline-formula> relative to the neutral case. This finding is surprising, given that the growth rate advantages of mutant over wild-type colonies were the same on rough and smooth substrates (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). Thus, this apparent inefficacy of selection in affecting evolutionary outcomes was not caused by an altogether elimination of growth rate differences. Instead, a closer look at the colony growth dynamics on rough substrates, shown in <xref ref-type="fig" rid="fig1">Figure 1e</xref>, suggests a different mechanism: the surface structure of the rough substrate constrains and guides growth along predetermined paths where growth proceeds faster than in the immediate surroundings, such that any mutation can only be successful, that is establish a sector and thus rise to high frequency in the population, if it happens to arise in one of the branch-like regions of accelerated growth. Conversely, a beneficial mutant clone will be unable expand even if its per capita growth rate is higher than its wild-type neighbors if the mutation occurs in a portion of the front that is slowed down by the environmental heterogeneity.</p><p>If this proposed mechanism is indeed the root cause for the apparent inefficacy of selection on rough substrates, then one would expect the number of successful mutants, that is those that manage to establish sectors, to be independent of the mutant’s selective advantage <inline-formula><mml:math id="inf42"><mml:mi>s</mml:mi></mml:math></inline-formula>. Indeed, this is what we observed: the probability of forming a sector, which quantifies the evolutionary success probability of individual mutations, increased with <inline-formula><mml:math id="inf43"><mml:mi>s</mml:mi></mml:math></inline-formula> in smooth colonies (<xref ref-type="fig" rid="fig2">Figure 2e</xref>), but was constant in rough colonies as long as <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Notably, the establishment probability was extremely low in both scenarios: Even for the most advantageous mutants in smooth colonies, we estimate <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> per mutation making evolutionary success an extremely rare event. The low success probability is a consequence of two processes: firstly, the mutation must occur in a favorable location, namely in the first layer of cells at the front of the population (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>), which reduces the number of mutations eligible for sector formation by a factor of about 1000 (assuming a growth layer width of 10 cells and a colony height of about 100 cells, see <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). We estimate that about 2000 mutations per colony arose in favorable positions, each of which had an establishment probability of order 10<sup>-3</sup>. Secondly, each eligible mutation has to survive genetic drift, which in microbial colonies is manifest in the random fluctuations in the sector boundaries as a consequence of stochastic cell growth and division, and subsequent cell motion due to mechanical pushing of cells on each other (<xref ref-type="bibr" rid="bib28">Hallatschek et al., 2007</xref>; <xref ref-type="bibr" rid="bib18">Farrell et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Kayser et al., 2018a</xref>).</p><p>The low establishment probability means that most mutations will not manage to create sectors, but instead they will form so-called bubbles, that is individual mutant clones that have lost contact with the front. We extracted the size of mutant clones, both bubbles and sectors, by measuring the individual areas of non-fluorescent patches in the colony micrographs. The resulting clone size distribution <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> (clone areas normalized by colony area, shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>) is related to the site frequency spectrum in population genetics, where it can be used to predict rare evolutionary outcomes such as fitness valley crossing (<xref ref-type="bibr" rid="bib63">Weissman et al., 2009</xref>) and evolutionary rescue (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>), and is well understood for toy models of microbial colonies (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>; <xref ref-type="bibr" rid="bib53">Otwinowski and Krug, 2014</xref>). For neutral mutations, the clone size distribution is expected to be broad up to a shoulder indicating the typical size of the largest expected bubble. In our experiments, we indeed observed a broad shoulder-like distribution for neutral mutations, consistent with earlier experiments using population sequencing (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>). In smooth colonies, beneficial mutations created a larger number of bulging sectors, leading to an even broader distribution with maximum clone sizes of almost half the population, while the distribution for strongly deleterious mutations was cut off at small clone sizes. This clone size distribution is consistent with our initial observation that a larger selective advantage <inline-formula><mml:math id="inf47"><mml:mi>s</mml:mi></mml:math></inline-formula> gave rise to a larger overall mutant frequency, but it also shows that even at the largest <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>, most mutant clones remained small, with more than half of the visible clones reaching frequencies of at most 1%. By contrast, the clone size distributions obtained from rough colonies were virtually indistinguishable for all <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>s</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, whereas we observed the same cut-off for large clones for deleterious mutations.</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.021</object-id><label>Figure 3.</label><caption><title>Clone size distribution <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for colonies grown on smooth (<bold>a</bold>) and rough (<bold>b</bold>) substrates.</title><p>Deleterious mutants are shown in magenta tones; their clones are typically small. Neutral clones are shown in green; their size distribution had a broad tail. Advantageous mutations in smooth colonies were even more broadly distributed, as large sectors establish more often. By contrast, beneficial clones in rough colonies had size distributions that were indistinguishable from the distribution for neutral mutations.</p><p><supplementary-material id="fig3sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.022</object-id><label>Figure 3—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig3">Figure 3</xref>.</title><p>sfs_smooth.csv Source data for panel a (clone size distribution for smooth colonies). sfs rough.csv Source data for panel b (clone size distribution for rough colonies).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig3-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig3-v2.tif"/></fig><p>In summary, a microscopically randomly patterned growth surface had several effects on the population and evolutionary dynamics of our colonies. The heterogeneity of the substrate decreased the radial growth rate during early colony growth and gave rise to colonies with an overall rougher morphology. In terms of evolutionary dynamics, heterogeneity decreased the dependence of the final mutant frequency (or, equivalently, the rate of adaptation) on the selective effect of mutations. These effects are large, even though the perturbation we impose seems relatively weak. After all, the rough substrate is only distinguished from the smooth substrate by troughs and elevations of order ten micrometers, and colony growth rate differences are consistent for both substrate types (<xref ref-type="fig" rid="fig2">Figure 2c</xref>).</p></sec><sec id="s2-2"><title>Minimal model</title><p>How can such a relatively small change in environmental conditions have such a dramatic effect on the evolutionary dynamics? Above, we have proposed that the transient colony pinning seen in <xref ref-type="fig" rid="fig1">Figure 1e</xref> may be responsible, by giving a boost to certain regions irrespective of whether that region harbors beneficial mutants or not. However, the growth of the colony and the mutational dynamics within it are highly complex processes affected by the mechanical properties of growing cells and their interactions with each other and the growth substrate (<xref ref-type="bibr" rid="bib26">Grant et al., 2014</xref>; <xref ref-type="bibr" rid="bib8">Boyer et al., 2011</xref>; <xref ref-type="bibr" rid="bib34">Kayser et al., 2018a</xref>; <xref ref-type="bibr" rid="bib22">Giometto et al., 2018</xref>; <xref ref-type="bibr" rid="bib18">Farrell et al., 2017</xref>). In addition, the substrate heterogeneity in our experiments is complex and characterized by long-range correlations (see <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). This raises the question whether our key findings may hinge on these complexities, or whether much simpler uncorrelated heterogeneities in growth rates can also have comparable effects on population genetics.</p><p>To answer this question, we have devised a minimal simulation model for populations expanding in heterogeneous environments. Briefly, colonies grow from single cells on a square lattice, only cells with empty neighbors can divide, and a wild type can mutate upon cell division with probability μ to the mutant type carrying a fitness advantage or disadvantage <inline-formula><mml:math id="inf51"><mml:mi>s</mml:mi></mml:math></inline-formula> (Materials and methods). Disorder sites (density <inline-formula><mml:math id="inf52"><mml:mi>ρ</mml:mi></mml:math></inline-formula>) confer a reduced growth rate <inline-formula><mml:math id="inf53"><mml:mi>k</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>≤</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) to any individual growing on it. We call <inline-formula><mml:math id="inf55"><mml:mi>k</mml:mi></mml:math></inline-formula> the transparency of the disorder sites; for <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we refer to the disorder sites as (impassable) obstacles. The simplicity of the model allows us to explore exhaustively the whole parameter space in <inline-formula><mml:math id="inf57"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf58"><mml:mi>ρ</mml:mi></mml:math></inline-formula>. Our model is based on the classical Eden lattice model (<xref ref-type="bibr" rid="bib14">Eden, 1961</xref>) that is commonly used to model growing microbial colonies (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>; <xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Ben-Zion et al., 2019</xref>). The Eden model without environmental heterogeneity is in the so-called KPZ universality class, that is its statistical properties are described the KPZ equation, a classical model of interface growth (<xref ref-type="bibr" rid="bib33">Kardar et al., 1986</xref>). The KPZ equation has been extended to include environmental heterogeneity (discussed in detail in the Materials and methods) which was shown to induce a pinning transition: the environmental heterogeneity induces a characteristic length scale on which the interface cannot advance (is <italic>pinned</italic> by the heterogeneities). Thus, adding environmental heterogeneity to the Eden model may likewise introduce a pinning transition under certain conditions, making our generalized Eden model a natural candidate for a minimal model of range expansions in heterogeneous environments.</p><p>Indeed, in agreement with our experiments, increasing the density <inline-formula><mml:math id="inf59"><mml:mi>ρ</mml:mi></mml:math></inline-formula> of disorder sites leads to a decrease in the radial colony expansion speed in our simulations (<xref ref-type="fig" rid="fig4">Figure 4b</xref>) that becomes more extreme as the obstacle transparency <inline-formula><mml:math id="inf60"><mml:mi>k</mml:mi></mml:math></inline-formula> goes to 0. For small <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the expansion speed decreases first slowly and then rapidly as the density reaches a critical value <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>. For impassable obstacles (<inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) at densities <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, the obstacles form a closed ring around the incipient colony and prevented further growth (<xref ref-type="fig" rid="fig4">Figure 4b</xref>, black line). This is the anticipated pinning transition, which occurs in our model at a critical density <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>. This critical density corresponds to the scenario where the colony can no longer percolate through the network of obstacles, suggesting that <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> is equivalent to the site percolation threshold <inline-formula><mml:math id="inf67"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.592</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.407</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib9">Bunde et al., 1985</xref>; <xref ref-type="bibr" rid="bib4">Barabási and Stanley, 1995</xref>). Notably, while the percolation transition only occurs at the critical point <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, non-zero but small values of <inline-formula><mml:math id="inf69"><mml:mi>k</mml:mi></mml:math></inline-formula> give rise to transient pinning near the critical density that is essentially indistinguishable from the <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> case over time scales shorter than <inline-formula><mml:math id="inf71"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>, while still allowing the expansion to progress indefinitely, albeit slowly. Close to the pinning transition, small changes in obstacle density can have dramatic effects: not only does the colony expansion speed decrease rapidly, but the colony morphology changes drastically and, as we show below, so do the evolutionary dynamics.</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.024</object-id><label>Figure 4.</label><caption><title>A minimal model captures the change in colony morphology in heterogeneous environments.</title><p>(<bold>a</bold>) The simulation proceeds by allowing cells with empty neighbors ('boundary sites’) to divide into empty space. Disorder sites (gray/black, density <inline-formula><mml:math id="inf72"><mml:mi>ρ</mml:mi></mml:math></inline-formula>) are randomly distributed over the lattice. (<bold>b</bold>) As the obstacle transparency, that is the growth rate <inline-formula><mml:math id="inf73"><mml:mi>k</mml:mi></mml:math></inline-formula> at disorder sites, is reduced, the colony expansion speed decreases as a function of the obstacle density. For impassable disorder sites ('obstacles’, <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), the expansion speed vanishes above a critical obstacle density <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>, beyond which the population was trapped and could not grow to full size. (<bold>c</bold>) As <inline-formula><mml:math id="inf76"><mml:mi>ρ</mml:mi></mml:math></inline-formula> approached <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> colony morphology became increasing fractal. Colors from red to blue show the colony shape at different times. (<bold>d</bold>) Near the critical obstacle density <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>, only few individual sites near the front have empty neighbors, leading to local <italic>pinning</italic> of the front (arrows), where the front can only progress by lateral growth into the pinned region.</p><p><supplementary-material id="fig4sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.027</object-id><label>Figure 4—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig4">Figure 4</xref> (Colony expansion rate in heterogeneous environments).</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-44359-fig4-data1-v2.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.025</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Characterization of Eden clusters with obstacles (<inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>).</title><p>(<bold>a</bold>) Taking the front speed <inline-formula><mml:math id="inf80"><mml:mi>v</mml:mi></mml:math></inline-formula> as the order parameter, there is a phase transition at a critical obstacle density <inline-formula><mml:math id="inf81"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depending on system size <inline-formula><mml:math id="inf82"><mml:mi>L</mml:mi></mml:math></inline-formula>. For an infinite system, <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>0.41</mml:mn><mml:mo>±</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. For <inline-formula><mml:math id="inf84"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we have <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>0.21</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. (<bold>b</bold>) Roughness <inline-formula><mml:math id="inf86"><mml:mi>W</mml:mi></mml:math></inline-formula> of fully developed interfaces at <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:math></inline-formula> for varying obstacle densities, as a function of the window length <inline-formula><mml:math id="inf88"><mml:mi>l</mml:mi></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>W</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mi>α</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. At <inline-formula><mml:math id="inf90"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we find <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, consistent with the KPZ universality class. At <inline-formula><mml:math id="inf92"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>, we find <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>loc</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>, consistent with the QEW universality class (see <italic>Theory</italic> in the Materials and methods section), which is known to be characterized by two roughness exponents, a local exponent (<inline-formula><mml:math id="inf94"><mml:msub><mml:mi>α</mml:mi><mml:mi>loc</mml:mi></mml:msub></mml:math></inline-formula>, panel b), and a global exponent <inline-formula><mml:math id="inf95"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mn>1.15</mml:mn><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>loc</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> when the roughness is measured over the whole system size (see panel c) (<xref ref-type="bibr" rid="bib1">Amaral et al., 1995</xref>). Importantly for <inline-formula><mml:math id="inf96"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, there is a crossover length scale below which the system displays QEW scaling, whereas it returns to the KPZ scaling on longer length scales. (<bold>d</bold>) The time evolution <inline-formula><mml:math id="inf97"><mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mi>β</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> of the interface also follows dynamics consistent with KPZ (<inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) and QEW (<inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>β</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.78</mml:mn></mml:mrow></mml:math></inline-formula>) in the limiting cases. For intermediate <inline-formula><mml:math id="inf100"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≪</mml:mo><mml:mi>ρ</mml:mi><mml:mo>≪</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, there is a crossover from qEW at short times to KPZ dynamics at longer times, before the roughness saturates at a <inline-formula><mml:math id="inf101"><mml:mi>ρ</mml:mi></mml:math></inline-formula>-dependent value. For easier analysis, all simulations were performed in a box-like geometry.</p><p><supplementary-material id="fig4s1sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.026</object-id><label>Figure 4—figure supplement 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> (Analysis of colony expansion rate (v(rho).xlsx), interface width as a function of window length (w(l).xslx) and time (w(t).xslx), and saturation width (Wsat.xlsx)).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig4-figsupp1-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig4-figsupp1-v2.tif"/></fig></fig-group><p>As a result of the local pinning of the colony interface, the colony morphology depends on the density of obstacles (<xref ref-type="fig" rid="fig4">Figure 4c</xref>), most drastically for impassable obstacles (<inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) on which we concentrate for now. Without obstacles, the colonies are compact and relatively smooth. At intermediate obstacle densities (<xref ref-type="fig" rid="fig4">Figure 4c</xref>, middle), colonies are punctured by small holes and the overall density of the colony decreases. At the critical density <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> the colony is characterized by the fragmented morphology of percolation clusters with a large number of holes and a very rough exterior (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> and Materials and methods for a quantitative analysis of the colony interfaces). Below the critical obstacle density, the interface is pinned locally over a length scale that depends on the proximity to the pinning transition; the whole interface becomes pinned when this length scale reaches the system size, whereas the interface is unaffected on length scales much larger than this pinning length (see <italic>Theory</italic>). An example of local pinning is shown in <xref ref-type="fig" rid="fig4">Figure 4d</xref>, where the interface can only advance when the individuals located in unpinned portions of the front grow into the pinned areas (indicated by arrows). This process is equivalent to the branch-like outgrowths in the experiments (<xref ref-type="fig" rid="fig1">Figure 1e</xref>) which correspond to unpinned portions of the front outgrowing the pinned areas. In the following, we show how the changes in colony morphology produced by the environmental heterogeneity affect the evolutionary dynamics.</p><p>We begin by replicating the experimental situation to assess the efficacy of selection in the presence of environmental heterogeneity. We simulated mutations conferring a selective advantage <inline-formula><mml:math id="inf104"><mml:mi>s</mml:mi></mml:math></inline-formula> (that is increasing the growth rate by a factor <inline-formula><mml:math id="inf105"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>), shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>. Transparent obstacles (<inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>, <xref ref-type="fig" rid="fig5">Figure 5a</xref>) only have a relatively mild effect on the mutant frequency <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula>. For any value of the obstacle density <inline-formula><mml:math id="inf108"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> increases roughly exponentially with <inline-formula><mml:math id="inf110"><mml:mi>s</mml:mi></mml:math></inline-formula>, but the dependence on obstacle density is non-monotonic. This is easiest to see for the most beneficial mutations: the final mutant frequency <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> at <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> is lower at intermediate <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> than at the extremes <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Intuitively, this non-monotonicity results from a symmetry between high and low <inline-formula><mml:math id="inf116"><mml:mi>ρ</mml:mi></mml:math></inline-formula>: in both cases, there is only a small fraction of sites of the 'other’ type (i.e., disorder sites at low <inline-formula><mml:math id="inf117"><mml:mi>ρ</mml:mi></mml:math></inline-formula> or regular sites at high <inline-formula><mml:math id="inf118"><mml:mi>ρ</mml:mi></mml:math></inline-formula>), and their density is too small to effect a strong change in the population genetics. The reduction in the sensitivity of <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf120"><mml:mi>s</mml:mi></mml:math></inline-formula> at intermediate <inline-formula><mml:math id="inf121"><mml:mi>ρ</mml:mi></mml:math></inline-formula> becomes much more dramatic as the obstacle transparency <inline-formula><mml:math id="inf122"><mml:mi>k</mml:mi></mml:math></inline-formula> is decreased (see <xref ref-type="fig" rid="fig5">Figure 5b</xref> for the extreme case <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). A similar pattern is found for the final frequency of neutral mutants (<inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), which is largest at intermediate <inline-formula><mml:math id="inf125"><mml:mi>ρ</mml:mi></mml:math></inline-formula>.</p><fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.028</object-id><label>Figure 5.</label><caption><title>A simple lattice model reproduces strong impact of environmental heterogeneity on evolutionary dynamics.</title><p>(<bold>a,b</bold>) The mutant frequency <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> as a function of the selective advantage <inline-formula><mml:math id="inf127"><mml:mi>s</mml:mi></mml:math></inline-formula> of the mutants always increases with <inline-formula><mml:math id="inf128"><mml:mi>s</mml:mi></mml:math></inline-formula> to a degree that depends on the density <inline-formula><mml:math id="inf129"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and the transparency <inline-formula><mml:math id="inf130"><mml:mi>k</mml:mi></mml:math></inline-formula> of the disorder sites. (<bold>c,d</bold>) Parametrizing the mutant frequency for various values of <inline-formula><mml:math id="inf131"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf132"><mml:mi>ρ</mml:mi></mml:math></inline-formula> heuristically with <inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> (panel a, inset), we fit the neutral diversity <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> (shown in panel d) and the selection efficacy <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> (panel c). The selection efficacy <inline-formula><mml:math id="inf136"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> serves as an inverse selection scale, describing the dependence of <inline-formula><mml:math id="inf137"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> on <inline-formula><mml:math id="inf138"><mml:mi>s</mml:mi></mml:math></inline-formula>. (<bold>e</bold>) A scatter plot of the fit parameters <inline-formula><mml:math id="inf139"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> for all values of <inline-formula><mml:math id="inf141"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf142"><mml:mi>ρ</mml:mi></mml:math></inline-formula> reveals that they are effectively not independent parameters, but that <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> entirely determines <inline-formula><mml:math id="inf144"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> and vice-versa (for a given population size <inline-formula><mml:math id="inf145"><mml:mi>N</mml:mi></mml:math></inline-formula> and mutation rate μ; here, <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0005</mml:mn></mml:mrow></mml:math></inline-formula>). The dashed line represents the expect neutral diversity for a circular colony, where <inline-formula><mml:math id="inf148"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> the colony radius (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>). (<bold>f</bold>) Rescaling all curves by fitted values of <inline-formula><mml:math id="inf150"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf151"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, all points fall close to a master curve given by <inline-formula><mml:math id="inf152"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (dashed line), motivating the parametrization introduced in (<bold>a</bold>).</p><p><supplementary-material id="fig5sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.031</object-id><label>Figure 5—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig5">Figure 5</xref>.</title><p><bold>ks_values.csv</bold>. Source data for panel c (fit parameter <inline-formula><mml:math id="inf153"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> for various parameter values <inline-formula><mml:math id="inf154"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf155"><mml:mi>k</mml:mi></mml:math></inline-formula>). <bold>f0 values.csv</bold> Source data for panel d (fit parameter <inline-formula><mml:math id="inf156"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> for various parameter values <inline-formula><mml:math id="inf157"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf158"><mml:mi>k</mml:mi></mml:math></inline-formula>). <bold>rescaled fMT data.xlsx</bold> Source data for panel f (rescaled <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> for various parameter values <inline-formula><mml:math id="inf160"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf161"><mml:mi>k</mml:mi></mml:math></inline-formula>).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig5-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.029</object-id><label>Figure 5—figure supplement 1.</label><caption><title>Clone size distribution <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for colonies grown on smooth (<bold>a</bold>) and rough (<bold>b</bold>) substrates in simulations.</title><p>Deleterious mutants are shown in magenta tones; their clones are typically small. Neutral clones are shown green; their size distribution is broad. Advantageous mutations (red tones) are even more broadly distributed, as large sectors establish more often. In the absence of environmental heterogeneity, the clone size distribution <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> was very broad, with a low-frequency power-law regime <inline-formula><mml:math id="inf164"><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> corresponding to mutant bubbles and a steeper power-law at high frequencies characterizing sector sizes (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>). A deleterious fitness effect <inline-formula><mml:math id="inf165"><mml:mi>s</mml:mi></mml:math></inline-formula> of the mutations created an effective cut-off because sectors no longer formed, whereas positive <inline-formula><mml:math id="inf166"><mml:mi>s</mml:mi></mml:math></inline-formula> increased the likelihood of high-frequency clones, because sectors establish more often and grow to larger frequencies when they do. At the critical obstacle density, we found that a neutral clone size distribution that was remarkably similar to what we found without environmental heterogeneity (<bold>b</bold>, inset). By contrast, selective differences between mutants and wild type had a much less pronounced effect on the clone size distribution as the density of obstacles increased. The clone size distribution for both beneficial and deleterious mutations thus resembled the distribution for neutral mutations. In simulations at the critical obstacle density <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> became roughly independent of <inline-formula><mml:math id="inf169"><mml:mi>s</mml:mi></mml:math></inline-formula>, such that fitness effects associated with the mutations were effectively inconsequential at the level of individual clones.</p><p><supplementary-material id="fig5s1sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.030</object-id><label>Figure 5—figure supplement 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref> (Clone size distribution for various <inline-formula><mml:math id="inf170"><mml:mi>s</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf171"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig5-figsupp1-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig5-figsupp1-v2.tif"/></fig></fig-group><p>To quantify the effects of varying <inline-formula><mml:math id="inf173"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf174"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and summarize the simulation results over many parameter combinations, we introduce the selection efficacy <inline-formula><mml:math id="inf175"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> and the neutral diversity <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> by parametrizing the mutant frequency with an exponential function <inline-formula><mml:math id="inf177"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Although this choice is merely a heuristic, rescaling the mutant frequency curves for a range of values of <inline-formula><mml:math id="inf178"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf179"><mml:mi>k</mml:mi></mml:math></inline-formula> by the fitted values for the neutral diversity <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and the selection efficacy <inline-formula><mml:math id="inf181"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, all points fall close to a single master curve given by a simple exponential (<xref ref-type="fig" rid="fig5">Figure 5f</xref>).</p><p>The selection efficacy <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> and the neutral diversity <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> have a minimum and maximum near <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>, respectively, which is increasingly sharp as <inline-formula><mml:math id="inf185"><mml:mi>k</mml:mi></mml:math></inline-formula> approaches the critical point <inline-formula><mml:math id="inf186"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. At the critical point, the selection efficacy vanishes entirely as <inline-formula><mml:math id="inf187"><mml:mi>ρ</mml:mi></mml:math></inline-formula> approaches <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5c,d</xref>). Thus, selection is completely unable to affect the final mutation frequency as the critical point is approached. The virtual independence of the evolutionary dynamics of the per-capita fitness <inline-formula><mml:math id="inf189"><mml:mi>s</mml:mi></mml:math></inline-formula> holds even at the scale of individual clones, whose size distributions for different values of <inline-formula><mml:math id="inf190"><mml:mi>s</mml:mi></mml:math></inline-formula> are practically indistinguishable for obstacle densities near <inline-formula><mml:math id="inf191"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Importantly, while we find a proper phase transition in the evolutionary dynamics only at the critical point (<inline-formula><mml:math id="inf192"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), the percolation transition is also manifest in populations grown in generic heterogeneous environments with <inline-formula><mml:math id="inf193"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> which do not give rise to a percolation transition. As a consequence, tiny changes in environmental parameters near a non-trivial critical obstacle density <inline-formula><mml:math id="inf194"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> can have a dramatic effect on the population growth dynamics and colony morphology as well as its evolutionary dynamics. The close connection between colony morphology and evolutionary dynamics is underscored by the empirical observation that the two descriptive parameters, the selection efficacy <inline-formula><mml:math id="inf195"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> and the neutral diversity <inline-formula><mml:math id="inf196"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, introduced as independent parameters measured directly from the simulations, are not independent in practice (<xref ref-type="fig" rid="fig5">Figure 5e</xref>). Plotting <inline-formula><mml:math id="inf197"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf198"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> for various choices of <inline-formula><mml:math id="inf199"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf200"><mml:mi>ρ</mml:mi></mml:math></inline-formula> reveals that the two parameters represent two sides of the same coin: environmental heterogeneity alters the growth pattern of the colony, which in turn affects both the neutral diversity and the selection efficacy.</p><p>Our minimal model has shown that simple uncorrelated heterogeneities can have a strong impact on the evolutionary dynamics and morphology of the range expansions. Remarkably, even incomplete obstacles that merely slow down growth can generate large roughness and quasi-neutral population genetics when they are at intermediate density. The reason is that, because the positioning and dynamics at the front are so important in range expansions, a slowdown has similar effects to a complete halt. Regarding environmental heterogeneity as simply another source of (extrinsic) noise, it is perhaps not surprising from a classical population genetics perspective that the addition of noise effectively weakens selection, as other sources of noise, such as small population sizes, are known to push evolutionary dynamics towards the neutral limit (<xref ref-type="bibr" rid="bib21">Gillespie, 2004</xref>). However, as we show in the following, the environmental heterogeneity in our simulations changes the evolutionary dynamics on a fundamental level that is not consistent with a mere increase in total noise level. Consider the neutral diversity <inline-formula><mml:math id="inf201"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig5">Figure 5e</xref>, which corresponds to the rate at which neutral mutations accumulate in the population. On average and in the absence of environmental heterogeneity, this rate is <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> since a fraction <inline-formula><mml:math id="inf203"><mml:mi>μ</mml:mi></mml:math></inline-formula> of cells at the population front acquire new neutral mutations in every generation, and the front size scales as the square root of the population size <inline-formula><mml:math id="inf204"><mml:mi>N</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>). Importantly, this result is independent of the level of noise in the system since it concerns only the average over many populations. Since the population size is the same across all our simulations, we would expect the same neutral diversity for all parameter values <inline-formula><mml:math id="inf205"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf206"><mml:mi>k</mml:mi></mml:math></inline-formula>. By contrast, our simulations show clear systematic deviations from the expected value (dotted line in <xref ref-type="fig" rid="fig5">Figure 5e</xref>).</p><p>To further characterize the qualitative changes on the neutral dynamics induced by environmental heterogeneity, we computed the spatially resolved phylogenetic tree of the population, obtained by tracing the lineages of all individuals at the population front back to the origin, focusing on the extreme cases of no (<inline-formula><mml:math id="inf207"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and critical (<inline-formula><mml:math id="inf208"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) obstacles (i.e., <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). For intermediate <inline-formula><mml:math id="inf210"><mml:mi>ρ</mml:mi></mml:math></inline-formula>, there is a crossover length set by the obstacle density. On length scales much shorter than this crossover length, the dynamics correspond to that in heterogeneous environments, while the homogeneous dynamics are recovered on length scales much larger than the crossover length (see <italic>Theory</italic> for details and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1b</xref> for an illustration of the crossover length at intermediate <inline-formula><mml:math id="inf211"><mml:mi>ρ</mml:mi></mml:math></inline-formula>).</p><p>As shown in <xref ref-type="fig" rid="fig6">Figure 6a,b</xref>, the lineage tree has a vastly different appearance depending on the environmental heterogeneity. Without obstacles (panel a) the lineages are relatively straight and roughly aligned with the radial direction. By contrast, at the critical obstacle density, where the colony has a rough exterior (<xref ref-type="fig" rid="fig4">Figure 4c</xref>), lineages are erratic and often have segments oriented perpendicular to the radial direction.</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.032</object-id><label>Figure 6.</label><caption><title>Neutral lineage dynamics change with environmental heterogeneity.</title><p>Lineage trees extracted from simulated colonies without (<inline-formula><mml:math id="inf212"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), (<bold>a</bold>) and with critical (<inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>), (<bold>b</bold>) environmental heterogeneity. (<bold>c</bold>) The lineage structure is characterized by the fluctuations <inline-formula><mml:math id="inf214"><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub></mml:math></inline-formula> of the lineages in forward time <inline-formula><mml:math id="inf215"><mml:mi>t</mml:mi></mml:math></inline-formula>, and the pair coalescence time <inline-formula><mml:math id="inf216"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (backwards in time) of two samples that are a distance <inline-formula><mml:math id="inf217"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> apart. (<bold>d</bold>) The lineage fluctuations depend on the environmental heterogeneity: in the absence of environmental disorder, lineage fluctuations scale as <inline-formula><mml:math id="inf218"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, whereas the lineages are rougher in strong disorder, scaling as <inline-formula><mml:math id="inf219"><mml:msup><mml:mi>t</mml:mi><mml:mn>0.86</mml:mn></mml:msup></mml:math></inline-formula>. Strong lineage fluctuations in heterogeneous environments also impact the mean pair coalescence time of two samples a distance <inline-formula><mml:math id="inf220"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> apart by allowing lineages from distant regions of the colony to coalesce earlier than without environmental heterogeneity (panel e). As a consequence, the persistence probability <inline-formula><mml:math id="inf221"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that is the probability that two sampled lineages have a pair coalescence time greater than <inline-formula><mml:math id="inf222"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> is typically greater in homogeneous than in heterogeneous environments, even when conditioning on small distance between samples (solid lines, <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.05</mml:mn><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; dashed lines, <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>x</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>0.05</mml:mn><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><p><supplementary-material id="fig6sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.035</object-id><label>Figure 6—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title><p><bold>lineage_fluctuations.csv</bold> Source data for panel d (lineage fluctuations <inline-formula><mml:math id="inf225"><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub></mml:math></inline-formula> vs forward time <inline-formula><mml:math id="inf226"><mml:mi>t</mml:mi></mml:math></inline-formula>). <bold>T2vsDeltaX data.csv</bold> Source data for panel e (mean pair coalescence time <inline-formula><mml:math id="inf227"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> vs pair distance <inline-formula><mml:math id="inf228"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>). <bold>P(T2) data.csv</bold> Source data for panel f (persistence probability <inline-formula><mml:math id="inf229"><mml:mrow><mml:mi>U</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> vs pair coalescence time <inline-formula><mml:math id="inf230"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig6-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44359.033</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Environmental heterogeneity alters the shapes of mutant clones.</title><p>(<bold>a</bold>) Mutant clones (colored by the time of mutation) in a simulated colony grown in a homogeneous environment. (<bold>c</bold>) Environmental heterogeneity impacts the directionality of clones (measured by the angle <inline-formula><mml:math id="inf231"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> that a clone’s semi-major axis makes with the radial direction, see panel (<bold>b</bold>)), which are mostly aligned with the radial direction for smooth colonies, but point in essentially random directions in heterogeneous environments. (<bold>d</bold>) Clones become more isotropic as the pinning transition is approached, as measured by the anisotropy exponent <inline-formula><mml:math id="inf232"><mml:mi>ζ</mml:mi></mml:math></inline-formula> which quantifies how the typical width <inline-formula><mml:math id="inf233"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub><mml:mo>∼</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mo>∥</mml:mo><mml:mi>ζ</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> of a clone scales with its length <inline-formula><mml:math id="inf234"><mml:msub><mml:mi>l</mml:mi><mml:mo>∥</mml:mo></mml:msub></mml:math></inline-formula>.</p><p><supplementary-material id="fig6s1sdata1"><object-id pub-id-type="doi">10.7554/eLife.44359.034</object-id><label>Figure 6—figure supplement 1—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref> (Clone angles and anisotropy exponents for neutral mutations for various <inline-formula><mml:math id="inf235"><mml:mi>ρ</mml:mi></mml:math></inline-formula>).</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-44359-fig6-figsupp1-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig6-figsupp1-v2.tif"/></fig></fig-group><p>To quantify the differences in the lineage structure between the two scenarios, we focused on the pair coalescence 'time’ <inline-formula><mml:math id="inf236"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, that is the time when two individuals, sampled a distance <inline-formula><mml:math id="inf237"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> apart, had their last common ancestor (measured in lattice sites, see <xref ref-type="fig" rid="fig6">Figure 6c</xref>), as well as the strength of lineage fluctuations, that is how much lineages deviate from straight lines over time. The strength of lineage fluctuations determines how likely two randomly lineages are to meet ('coalesce’) and thus directly shapes the coalescence structure of the population (<xref ref-type="bibr" rid="bib39">Korolev et al., 2010</xref>; <xref ref-type="bibr" rid="bib11">Chu et al., 2018</xref>).</p><p>The lateral lineage fluctuations <inline-formula><mml:math id="inf238"><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub></mml:math></inline-formula> (see Materials and methods for details) scale with distance <inline-formula><mml:math id="inf239"><mml:mi>t</mml:mi></mml:math></inline-formula> from the origin as <inline-formula><mml:math id="inf240"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mi>ξ</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where a larger value of <inline-formula><mml:math id="inf241"><mml:mi>ξ</mml:mi></mml:math></inline-formula> indicates rougher boundaries. We find that lineages in rough colonies are not only rougher in absolute value, but also in terms of their scaling in rough colonies. Whereas in the standard Eden model we recover the known (super-diffusive) scaling <inline-formula><mml:math id="inf242"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.66</mml:mn><mml:mo>±</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib33">Kardar et al., 1986</xref>), we find a larger scaling exponent <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.86</mml:mn><mml:mo>±</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> in rough colonies (<inline-formula><mml:math id="inf244"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>). This is consistent with the corresponding change of the statistical properties of the colony interface, which transitions from the Kardar-Parisi-Zhang (KPZ) universality class to the quenched Edwards-Wilkinson (QEW) universality class (see Materials and methods and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). The changes in lineage fluctuations in the presence of environmental heterogeneity are reflected in the shape and orientation of individual neutral clones (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Mutant clones have an approximately ellipsoidal shape oriented preferentially along the radial direction in the absence of heterogeneity, whereas they have essentially random orientations in rough colonies (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1c</xref>), in agreement with the observation that lineages lose their radial orientation as the number of obstacles increased. Similarly, we measured the scaling of clone widths <inline-formula><mml:math id="inf245"><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub></mml:math></inline-formula> with its length <inline-formula><mml:math id="inf246"><mml:msub><mml:mi>l</mml:mi><mml:mo>∥</mml:mo></mml:msub></mml:math></inline-formula> as <inline-formula><mml:math id="inf247"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub><mml:mo>∼</mml:mo><mml:msubsup><mml:mi>l</mml:mi><mml:mo>∥</mml:mo><mml:mi>ζ</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, where the exponent <inline-formula><mml:math id="inf248"><mml:mi>ζ</mml:mi></mml:math></inline-formula> quantifies the anisotropy of the clones (<inline-formula><mml:math id="inf249"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> corresponding to clones whose width is independent of their length, <inline-formula><mml:math id="inf250"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> corresponding to isotropic clones). In our simulation, <inline-formula><mml:math id="inf251"><mml:mi>ζ</mml:mi></mml:math></inline-formula> changed from <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (consistent with KPZ interface statistics [<xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>]) to <inline-formula><mml:math id="inf254"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1d</xref>), indicating roughly isotropic neutral clones.</p><p>The increased roughness of lineages is also reflected in the number of successful lineages emanating from the initial population founder. We quantify this by computing the pairwise coalescence time <inline-formula><mml:math id="inf256"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6e,f</xref>) over all pairs of cells at the front of the population. We find that, for a given distance <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> between the sample pairs, the relative coalescence time and persistence probability (i.e., the probability of not having a common ancestor until time <inline-formula><mml:math id="inf258"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, shown in panel f) is always smaller in the presence of obstacles. This indicates that fewer lineages reach the population edge in the presence of environmental heterogeneity. This makes intuitive sense from the phylogenetic trees shown in <xref ref-type="fig" rid="fig6">Figure 6a,b</xref>, where in rough colonies all individuals at the front coalesce quickly into a small number of large lineages. Thus, for any mutation to be successful and grow into a large clone, it has to belong to one of those large lineages. Since the number of those lineages is small, such mutations are extraordinarily unlikely; at the same time, if they occur, they can grow to large size simply by virtue of having occurred in a fortuitous location.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Using a combination of bacterial colony experiment and population genetics theory, we examined how environmental heterogeneity can shape the population genetics of range expansions. By growing colonies on heterogeneous substrates, we found that microscale ridges and troughs in the growth substrate were enough to dramatically alter the growth dynamics and morphology of the colonies as well as reduce the ability of beneficial mutations to establish and expand. Time-lapse microscopy and minimal model simulations showed that this reduction in selection efficacy on heterogeneous substrates can be explained by a local pinning of the colony front. Since mutations occur only within the growing population at the front, the properties of the front dictate the evolutionary dynamics, including the strength of selection and the size of individual clones. Local pinning impacts the dynamics at the front by reducing the expansion speed of some parts of the population, leading to an effective reduction in the number of expansion paths that can actively contribute successful mutations. Thus, most individuals and their clones will get stuck in dead-ends, and only a few lucky individuals will be able to find the paths along unpinned front positions and be able to establish a large clone. Once established, though, the size of a mutant clone is roughly independent of its fitness because it is constrained by the network of obstacles. Thus, the evolutionary success of a mutation, that is whether a sector can form or not, and how large a mutant clone can get, depends <italic>entirely</italic> on where it arises and not at all on its fitness. In this sense, locally pinned expansions bear little resemblance to unconstrained radial expansions (see <xref ref-type="fig" rid="fig7">Figure 7</xref>). Rather, expansions along each available path more closely correspond to linear expansions, for example along a coastline, where mutations spread deterministically after local establishment (<xref ref-type="bibr" rid="bib19">Fisher, 1937</xref>).</p><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.036</object-id><label>Figure 7.</label><caption><title>Cartoon of how environmental heterogeneity shapes evolutionary dynamics during range expansions.</title><p>In homogeneous environments (<bold>a</bold>), a locally established beneficial mutation (orange star), having survived genetic drift, can expand freely (arrows). By contrast, in heterogeneous environments (<bold>b</bold>), a beneficial mutation can become trapped in pinned stretches of the population, whereas expansion along open paths resembles a one-dimensional expansion.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig7-v2.tif"/></fig><p>While we have focused here on microbial populations, we expect these results to hold more generally. This is one of the conclusions of our deliberately minimal model, which showed that simple uncorrelated heterogeneities are enough to create a strong impact on the population genetics and morphology of the range expansions. These effects persist even when the heterogeneity does not present as impassable obstacles but merely slows down growth. This is because the properties of the front dictate the evolutionary dynamics, since mutations occur only within the growing population at the front, such that a slowdown have comparable effects on the evolutionary dynamics as a complete halt. Since our model does not include any particular biological details, its results may apply generally in systems with front-limited growth and environmental heterogeneity. Thus, we would expect a reduced selection efficacy to generalize to other dense cellular populations in disordered environments, such as tumors and biofilms, but also to macroscopic range expansions of invasive species (<xref ref-type="bibr" rid="bib66">With, 2002</xref>). When a population undergoes a range expansion, it will arguably not experience a completely homogeneous environments: at the very least, some areas will be more hospitable than others, but other parts of the environment may also be entirely inaccessible to the population because of, for example rivers and lakes, a strong local competitor or predator, or lack of resources. Environmental heterogeneity is thus arguably the rule rather than the exception.</p><p>Despite its simplicity, our minimal model reproduces many experimental findings qualitatively, such as a rougher colony morphology and a reduced efficacy of selection in the presence of environmental heterogeneity (in experiments, by a factor of 2.5 - 4 depending on fitting strategy). However, the model cannot quantitatively account for all our experimental results. For instance, the model predicts that the frequency of neutral and deleterious mutants should be greater in heterogeneous than in homogeneous environments (<xref ref-type="fig" rid="fig5">Figure 5d</xref>). By contrast, in our experiments, we find only about half as many neutral mutants in rough colonies as in smooth colonies and comparable mutant frequencies for deleterious mutations (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). A potential reason for this discrepancy may be that the random pattern imposed in our experiments is not correlation-free as in the simulations (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), which may impact the dynamics of mutant clones as follows. A beneficial mutation has to overcome genetic drift, and to do so, it must grow to a lateral size large enough for selection to take over (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>). However, if the characteristic length scale of the environmental heterogeneity is smaller than this 'establishment size’, then the evolutionary dynamics is effectively neutral. On the other hand, a deleterious mutation born on a ridge or in a trough never grows to large enough size to 'see’ the disorder in the first place and thus its dynamics are largely unaffected by the environmental heterogeneity. In the simulations, however, the heterogeneity can be felt on all length scales, such that it affects mutant clones of all sizes the same way.</p><p>We expect environmental heterogeneity to impact not only the fate of beneficial mutations. Since deleterious mutations are typically more numerous than beneficial ones, environmental heterogeneity may also increase the chances of an overall <italic>decrease</italic> in population fitness through the accumulation of deleterious mutations. The accumulation of deleterious mutation, called the expansion load, is already more likely in range expansions than in well-mixed populations (<xref ref-type="bibr" rid="bib54">Peischl et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Lavrentovich et al., 2016</xref>; <xref ref-type="bibr" rid="bib23">Gralka et al., 2016a</xref>). By altering the efficacy of selection in depressing deleterious mutations and elevating beneficial mutations, heterogeneities in the environment may further facilitate the accumulation of deleterious mutations. Depending on the mutational supply, that is the relative rate and effect of deleterious and beneficial mutations, environmental heterogeneity may not only slow down the process of adaptation but also lead to entirely different long-term evolutionary outcomes. As an example, consider <xref ref-type="fig" rid="fig8">Figure 8</xref>, where we compute the rate of adaptation in range expansions in various habitats for a given distribution of fitness effects (DFE). We find that the rate of adaptation can transition from positive (adaptation over time) to negative (accumulation of deleterious mutations) depending only on the degree of environmental heterogeneity. Thus, environmental heterogeneity can fundamentally alter the evolutionary dynamics of range expansions.</p><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.037</object-id><label>Figure 8.</label><caption><title>Environmental heterogeneity can alter evolutionary outcomes.</title><p>Rate of adaptation, defined as <inline-formula><mml:math id="inf259"><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo rspace="0pt">𝑑</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, computed for an exponential distribution of fitness effects <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at various values of the environmental parameters <inline-formula><mml:math id="inf261"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf262"><mml:mi>ρ</mml:mi></mml:math></inline-formula> (see Materials and methods). The distribution of fitness effects is characterized by two parameters: the ratio <inline-formula><mml:math id="inf263"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of deleterious to beneficial mutation rate (<inline-formula><mml:math id="inf264"><mml:mrow><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> in panel a, 1.25 in b), and <inline-formula><mml:math id="inf265"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, the average fitness effect of a mutation (<inline-formula><mml:math id="inf266"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math></inline-formula> in panel a, 0.05 in b). The rate of adaptation is normalized to its maximal value at <inline-formula><mml:math id="inf267"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Green tones correspond to adaptation (accumulation of beneficial mutations), magenta tones to accumulation of deleterious mutations.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44359-fig8-v2.tif"/></fig></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Experimental methods</title><sec id="s4-1-1"><title>Strains and growth conditions</title><p>We used an <italic>E. coli</italic> MG1655 strain transformed with the plasmid pB10 (<xref ref-type="bibr" rid="bib56">Schlüter et al., 2003</xref>). pB10 is a 65 kB plasmid isolated from sewage sludge that confers resistance to several antibiotic resistance including tetracyclines and has an inserted RFP gene. Hence, cells containing pB10 ('wild type’) are red fluorescent and resistant to tetracycline. The plasmid is lost sporadically (<xref ref-type="bibr" rid="bib12">De Gelder et al., 2007</xref>), and the resulting cells ('mutants’) are non-fluorescent and susceptible to tetracycline, but display a higher growth rate in the absence of antibiotics (characterized below). We refer to the loss of the plasmid as a 'mutation’ of known fitness effect and occurrence rate, both of which we characterize below.</p><p>All experiments were performed in LB at 37 °C in a humidified environment. For solid media, 2% agar was added before autoclaving. Varying concentrations of doxycycline, a tetracycline that displays higher stability in agar plates than tetracycline itself, were added to freshly autoclaved media after cooling to about 60 °C and poured immediately. Plates were dried in the dark for at least 24 hr before use.</p></sec><sec id="s4-1-2"><title>Fitness measurements</title><p>We measured the fitness difference <inline-formula><mml:math id="inf268"><mml:mi>s</mml:mi></mml:math></inline-formula> between wild type and mutant cells using the colliding colonies assay (<xref ref-type="bibr" rid="bib41">Korolev et al., 2012</xref>; <xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>). Briefly, a mutant clone was first isolated and then grown independently of the wild type overnight. In the wild type, the plasmid was maintained by adding 10 μg/ml doxycycline to the overnight culture. After growth overnight, cultures were diluted 1:10, grown for about 1.5 hr, and then washed twice in PBS to remove residual doxycycline. 1 μl droplet of each strain were spotted on agar plates about 2 mm apart. After drying, colonies were grown for 3 days and then imaged under the a Zeiss Axiozoom v16 microscope. The resulting images were used to estimate fitness differences by fitting a circle onto the mutant-wild type interface. The results are shown in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>: without doxycyline, mutants have a 20–25% advantage over the wild type. Both strains have equal growth rate around ≈0.35 μg/ml, and the mutants grow more slowly than the wild type at higher concentration of doxycycline.</p><p>For the growth rate measurements in <xref ref-type="fig" rid="fig2">Figure 2</xref>, colonies were grown from single cells on both rough and smooth plates in a temperature-controlled growth chamber and imaged overnight on a Zeiss Axiozoom v16 microscope. The resulting time lapse movies were binarized and the colony areas extracted.</p></sec><sec id="s4-1-3"><title>Mutation rate experiment</title><p>To measure the rate of plasmid loss ('mutation rate’), we grew 48 well-mixed populations from a small number of wild-type cells for about seven generation (i.e., from about 10 to about 1000 cells). The inoculum did not contain any mutants because the culture used to inoculate the populations contained selective amounts of doxycycline. The populations were grown either without doxycycline or at 1 μg/ml doxycycline, which corresponds to the low and high end of concentrations used in our experiments, respectively. After seven generations, each population was plated and the number of red (WT) and gray (MT) colonies was counted via automated image analysis. The resulting frequencies of mutants were used to infer the mutation rate by computing the maximum likelihood against simulations of the process at different mutation rates and fitness differences, as follows.</p></sec><sec id="s4-1-4"><title>Statistical inference of mutation rate</title><p>To estimate the mutation rate, we performed maximum likelihood estimation based on probability density distributions obtained from simulations, as follows: starting from a Poisson distributed number of initial cells, 48 populations go through about seven generations, where every wild type has a chance μ per division to produce a mutant. Mutant cells grow at a growth rate <inline-formula><mml:math id="inf269"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> relative to the wild type. We performed 50000 simulations for each value of <inline-formula><mml:math id="inf270"><mml:mi>s</mml:mi></mml:math></inline-formula> and μ and computed the likelihood of each parameter combination <inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, μ as<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>48</mml:mn></mml:munderover><mml:mrow><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability of observing <inline-formula><mml:math id="inf273"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> under the simulation model, which we estimated from the simulation histograms. We treat <inline-formula><mml:math id="inf274"><mml:mi>s</mml:mi></mml:math></inline-formula> as a free parameter that we can later compare to the experimentally measured value. The precise value of <inline-formula><mml:math id="inf275"><mml:mi>s</mml:mi></mml:math></inline-formula> does not affect the inferred value of <inline-formula><mml:math id="inf276"><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:math></inline-formula> very strongly. This is because the number of generations is small in our experiment and a faster-growing mutant can gain at most a factor of four more cells than the wild type. The global maximum likelihood value <inline-formula><mml:math id="inf277"><mml:msup><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is obtained for <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> for doxycycline concentrations of 0 μg/ml and 1 μg/ml, in good agreement with our measured values of <inline-formula><mml:math id="inf280"><mml:mi>s</mml:mi></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The error is estimated from the curvature of the likelihood as <inline-formula><mml:math id="inf281"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>≳</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msubsup><mml:mo>∂</mml:mo><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁡</mml:mo><mml:mi mathvariant="normal">ℓ</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We find <inline-formula><mml:math id="inf282"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.003</mml:mn><mml:mo>±</mml:mo><mml:mn>0.00055</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf283"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.009</mml:mn><mml:mo>±</mml:mo><mml:mn>0.00068</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-1-5"><title>Main experiment and analysis</title><p>Our main experiment consists in the growth of colonies from single wild-type cells on agar plates (each containing 20 ml of LB +2% agar) containing varying concentrations of doxycycline. The agar plates were either <italic>smooth</italic>, standard agar plates, or <italic>rough</italic>. Rough plates were created by pouring the agar at a temperature of about 60 °C and then gently lowering filter paper (VWR Grade 410 Filter Paper, Qualitative, pore size between 9 and 20 μm) onto the liquid agar, where it remained until the agar had solidified. The filter paper was then removed from the hard agar surface with tweezers, resulting in a patterned agar surface.</p><p>Overnight culture of the wild type grown in LB with 10 μg/ml doxycycline was washed and diluted in PBS to give between 3 and 10 colonies per plate. About <inline-formula><mml:math id="inf284"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>-</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> colonies per condition were analyzed (except for smooth plates without doxycycline, where <inline-formula><mml:math id="inf285"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>; see <xref ref-type="table" rid="table1">Table 1</xref>). After 72 hr of growth, the colonies were imaged on a Zeiss Axiozoom v16 microscope and the resulting images binarized to create a mask of the colony. Mutant clones we found manually with ImageJ. The mutant frequency per colony was measured as the total mutant area divided by the total area of the colony. The mutant frequency as a function of radius was measured by progressively shrinking the colony mask.</p><p>The whole experiment was performed twice. The main text focuses on the second experiment; the results (mutant frequency <inline-formula><mml:math id="inf286"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula>) from the first experiment are shown in SI <xref ref-type="fig" rid="fig2s5">Figure 2—figure supplement 5</xref>.</p></sec><sec id="s4-1-6"><title>Measuring substrate roughness</title><p>The properties of the randomly patterned agar surfaces used for the 'rough’ condition were assessed using a Dektak 150 profilometer with a 12.5 μm stylus. The run length was 10,000 um, with samples taken over 122 s at 0.273 μm per sample. The measurement range was set to 524 μm. The resulting traces were tilted to have zero slope; roughness was defined as the standard deviation of height values.</p></sec><sec id="s4-1-7"><title>Simulations</title><p>To simulate growing bacterial colonies, we employ an Eden model (<xref ref-type="bibr" rid="bib14">Eden, 1961</xref>) on a square lattice that we generalized to include mutations with fitness effect <inline-formula><mml:math id="inf287"><mml:mi>s</mml:mi></mml:math></inline-formula> and environmental disorder. To simulate environmental disorder, we first initialize the lattice with a number of disorder sites at a density <inline-formula><mml:math id="inf288"><mml:mi>ρ</mml:mi></mml:math></inline-formula>. Disorder sites are characterized by a reduced growth rate <inline-formula><mml:math id="inf289"><mml:mi>k</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf290"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mo>≤</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>k</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). For <inline-formula><mml:math id="inf291"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the disorder sites are impassable (we call this type of disorder sites <italic>obstacles</italic>); equivalent models have also been used to simulate epidemics, where the obstacles represent resistant sites (<xref ref-type="bibr" rid="bib32">Herrmann, 1986</xref>). Without disorder, our model is identical to that used in <xref ref-type="bibr" rid="bib20">Fusco et al. (2016)</xref> and <xref ref-type="bibr" rid="bib24">Gralka et al. (2016b)</xref>, and its interfaces are known to be well described by a standard model for stochastically growing interfaces, the KPZ equation (<xref ref-type="bibr" rid="bib33">Kardar et al., 1986</xref>).</p><p>The population is initiated with a single filled site in the center. In each time step, a site with empty neighbor sites is chosen with probability proportional to its growth rate <inline-formula><mml:math id="inf292"><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to divide into a randomly chosen empty neighbor site (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). Upon division, a wild-type site acquires a single mutation with probability μ, potentially conferring a fitness advantage or disadvantage <inline-formula><mml:math id="inf293"><mml:mi>s</mml:mi></mml:math></inline-formula>; already mutated sites do not acquire further mutations. The populations are grown until the same number of lattice sites <inline-formula><mml:math id="inf294"><mml:mi>N</mml:mi></mml:math></inline-formula> is filled; for strong environmental noise this results in colonies that are optically larger (see, e.g., <xref ref-type="fig" rid="fig4">Figure 4c</xref>). For <xref ref-type="fig" rid="fig5">Figures 5</xref> and <xref ref-type="fig" rid="fig6">6</xref>, <inline-formula><mml:math id="inf295"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>The mutant frequency <inline-formula><mml:math id="inf296"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula> is computed as the number of mutant lattice sites at the end of the simulation, divided by <inline-formula><mml:math id="inf297"><mml:mi>N</mml:mi></mml:math></inline-formula>. To arrive at <xref ref-type="fig" rid="fig5">Figure 5</xref>, we fitted the curves <inline-formula><mml:math id="inf298"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with an exponential,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we call <inline-formula><mml:math id="inf299"><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> the neutral diversity and <inline-formula><mml:math id="inf300"><mml:msub><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> the selection efficacy, which measures the susceptibility of the mutant frequency to changes in <inline-formula><mml:math id="inf301"><mml:mi>s</mml:mi></mml:math></inline-formula>.</p><p>To derive the phylogenetic trees in <xref ref-type="fig" rid="fig6">Figure 6</xref>, the locations of mother and daughter cell for each cell division were recorded for 50 colonies, allowing us to trace the lineages of all cells at the front back to the initial cell. From the resulting lineages, we computed the lineage fluctuations <inline-formula><mml:math id="inf302"><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub></mml:math></inline-formula> as the root-mean-squared transverse deviation from the radial direction (<xref ref-type="fig" rid="fig6">Figure 6d</xref>). The mean pair coalescence time in <xref ref-type="fig" rid="fig6">Figure 6e</xref> was computed by finding the most recent common ancestor cell for all pairs of cells at the front. The coalescence times <inline-formula><mml:math id="inf303"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (measured backwards in time from the final time point) and the distance <inline-formula><mml:math id="inf304"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> between the pairs were normalized to be able to compare between the homogeneous and heterogeneous scenarios, then binned and averaged. For <xref ref-type="fig" rid="fig6">Figure 6f</xref>, we first conditioned on a maximum (normalized) pair distance and then computed the inverse cumulative distribution for two lineages to not have coalesced until time <inline-formula><mml:math id="inf305"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>.</p><p>The rate of adaptation in <xref ref-type="fig" rid="fig8">Figure 8</xref> was computed by assuming an exponential distribution of fitness effects <inline-formula><mml:math id="inf306"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for both deleterious and beneficial mutations, that is<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mover><mml:mi>s</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf307"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf308"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula> are the mean fitness effect of beneficial and deleterious mutations, respectively. The normalization enforces that <inline-formula><mml:math id="inf309"><mml:mi>R</mml:mi></mml:math></inline-formula> corresponds to the total relative frequency of deleterious to beneficial mutations. The rate of adaptation is then computed as<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mrow><mml:mo rspace="0pt">𝑑</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>using the values <inline-formula><mml:math id="inf310"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from <xref ref-type="fig" rid="fig5">Figure 5</xref>. For the parameters in <xref ref-type="fig" rid="fig8">Figure 8</xref>, <inline-formula><mml:math id="inf311"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> goes to zero sufficiently quickly such that the limited range in <inline-formula><mml:math id="inf312"><mml:mi>s</mml:mi></mml:math></inline-formula> of the simulations does not impact the integral.</p></sec><sec id="s4-1-8"><title>Theory</title><p>Interfaces created by Eden model simulations fall into the KPZ universality class, governed by the KPZ equation for the height <inline-formula><mml:math id="inf313"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib17">Family and Vicsek, 1985</xref>; <xref ref-type="bibr" rid="bib33">Kardar et al., 1986</xref>). In one dimension, starting from a line in a simulation box, the colony surface is described by<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo>∂</mml:mo><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁡</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf314"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math></inline-formula> is the final speed of front propagation and <inline-formula><mml:math id="inf315"><mml:mrow><mml:mi>η</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is zero-mean Gaussian random noise <inline-formula><mml:math id="inf316"><mml:mi>δ</mml:mi></mml:math></inline-formula>-correlated in space and time describing the noise associated with the growth process. This equation generates a set of characteristic exponents that govern the roughness of the colony front and of sector boundaries. In particular, the surface height is described in terms of its root mean squared fluctuations around the mean by a Family-Viscek scaling relation (<xref ref-type="bibr" rid="bib60">Vicsek and Family, 1984</xref>)<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mi>α</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℱ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>β</mml:mi></mml:msup><mml:mo rspace="12.5pt">,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo rspace="12.5pt">,</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The KPZ universality class is characterized by the roughness exponent <inline-formula><mml:math id="inf317"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and the temporal exponent <inline-formula><mml:math id="inf318"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>; if <inline-formula><mml:math id="inf319"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the resulting universality class is called the Edwards-Wilkinson (EW) universality class characterized by <inline-formula><mml:math id="inf320"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf321"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. The ratio <inline-formula><mml:math id="inf322"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is sometimes called the dynamical exponents. It relates the size of lateral fluctuations <inline-formula><mml:math id="inf323"><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub></mml:math></inline-formula> to the time <inline-formula><mml:math id="inf324"><mml:mi>t</mml:mi></mml:math></inline-formula> as<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mo>⟂</mml:mo></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This relationship explains the fluctuations in sector boundaries in <italic>E. coli</italic> colonies and Eden model simulations, and can be used to derive exponents for the site frequency spectrum and establishment probabilities in Eden model colonies (<xref ref-type="bibr" rid="bib28">Hallatschek et al., 2007</xref>; <xref ref-type="bibr" rid="bib20">Fusco et al., 2016</xref>; <xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>). In the simulation presented here, the scenario without environmental disorder is described by <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>, explaining the site-frequency spectrum and the anisotropy exponents <inline-formula><mml:math id="inf325"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and the lineage fluctuations scaling in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p><p>The effect of environmental <italic>quenched</italic> disorder on the kinetic roughening of interfaces has been investigated in a range of experiments (see <xref ref-type="bibr" rid="bib4">Barabási and Stanley, 1995</xref> for a review). Exponents obtained from experiments are in the range of <inline-formula><mml:math id="inf326"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mn>0.6</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. To model driven interface growth in disordered media, quenched environmental disorder can be included by considering a noise term <inline-formula><mml:math id="inf327"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that does not explicitly depend on time (<xref ref-type="bibr" rid="bib37">Kessler et al., 1991</xref>).<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo>∂</mml:mo><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁡</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo>∂</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mo>⁡</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf328"><mml:mi>F</mml:mi></mml:math></inline-formula> is driving 'force’ fulfilling the same role as <inline-formula><mml:math id="inf329"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ5">Equation (5)</xref>. Since the noise explicitly depends on the interface position, <inline-formula><mml:math id="inf330"><mml:mi>F</mml:mi></mml:math></inline-formula> cannot be transformed away and thus emerges as a new parameter that can be thought of as a force pushing the interface through the disordered media. An important consequence of quenched noise is the emergence of a critical force <inline-formula><mml:math id="inf331"><mml:msub><mml:mi>F</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> below which the interface becomes pinned (<xref ref-type="bibr" rid="bib57">Tang and Leschhorn, 1992</xref>). For <inline-formula><mml:math id="inf332"><mml:mrow><mml:mi>F</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, a depinning transition takes place that is well characterized in 1 + 1 dimensions (<xref ref-type="bibr" rid="bib1">Amaral et al., 1995</xref>). For <inline-formula><mml:math id="inf333"><mml:mrow><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, large regions of the interface of size <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>ν</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> are pinned, and the front speed increases as <inline-formula><mml:math id="inf335"><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>θ</mml:mi></mml:msup></mml:math></inline-formula> (see <xref ref-type="table" rid="table2">Table 2</xref>).</p><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.44359.038</object-id><label>Table 2.</label><caption><title>Characteristic exponents for the KPZ and QEW universality classes and measured in our simulations, which are in good agreement with the literature values in <xref ref-type="bibr" rid="bib1">Amaral et al. (1995)</xref>.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Exponent</th><th>KPZ</th><th>This study (<inline-formula><mml:math id="inf336"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>)</th><th>qEW</th><th>This study (<inline-formula><mml:math id="inf337"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>)</th></tr></thead><tbody><tr><th><inline-formula><mml:math id="inf338"><mml:msub><mml:mi>α</mml:mi><mml:mi>loc</mml:mi></mml:msub></mml:math></inline-formula></th><td>1/2</td><td>0.5 ± 0.05</td><td>0.92 ± 0.04</td><td>0.9 ± 0.05</td></tr><tr><th><inline-formula><mml:math id="inf339"><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="normal">G</mml:mi></mml:msub></mml:math></inline-formula></th><td>1/2</td><td>0.5 ± 0.05</td><td>1.23 ± 0.04</td><td>1.15 ± 0.05</td></tr><tr><th><inline-formula><mml:math id="inf340"><mml:mi>β</mml:mi></mml:math></inline-formula></th><td>1/3</td><td>0.3 ± 0.03</td><td>0.86 ± 0.03</td><td>0.78 ± 0.05</td></tr><tr><th><inline-formula><mml:math id="inf341"><mml:mi>θ</mml:mi></mml:math></inline-formula></th><td>N/A</td><td>N/A</td><td>0.24 ± 0.03</td><td>0.21 ± 0.03</td></tr><tr><th><inline-formula><mml:math id="inf342"><mml:mi>ζ</mml:mi></mml:math></inline-formula></th><td>2/3</td><td>0.66 ± 0.02</td><td>-</td><td>0.86 ± 0.04</td></tr></tbody></table></table-wrap><p>Simulations and numerical integrations of <xref ref-type="disp-formula" rid="equ9">Equation (9)</xref> have characterized the pinned and moving phases and uncovered two universality classes as <inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>F</mml:mi><mml:mo>→</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib1">Amaral et al., 1995</xref>): if <inline-formula><mml:math id="inf344"><mml:mi>λ</mml:mi></mml:math></inline-formula> diverges near the depinning transition, one speaks of the (quenched) QKPZ universality class; its exponents <inline-formula><mml:math id="inf345"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.633</mml:mn></mml:mrow></mml:math></inline-formula> in the pinned phase are understood analytically through an analogy with the directed percolation class, whereas in the moving phase <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≈</mml:mo><mml:mi>β</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf347"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> instead, one speaks of the quenched Edwards-Wilkinson (QEW) universality class with <inline-formula><mml:math id="inf348"><mml:mrow><mml:mi>α</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.92</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf349"><mml:mrow><mml:mi>β</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.82</mml:mn></mml:mrow></mml:math></inline-formula> in the moving phase (see also <xref ref-type="table" rid="table2">Table 2</xref>); a functional renormalization group calculation gives <inline-formula><mml:math id="inf350"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf351"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> in one dimension (<xref ref-type="bibr" rid="bib52">Nattermann et al., 1992</xref>). For <inline-formula><mml:math id="inf352"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, there is a transition from the QKPZ/QEW universality class to the appropriate universality class with annealed noise.</p><p>Our generalized Eden model simulations with obstacles exhibits the same pinning transition for an obstacle density <inline-formula><mml:math id="inf353"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>. At the transition, the resulting colonies are (site) percolation clusters on the square lattice, from whose interfaces we measure exponents that are in excellent agreement with the QEW universality class (see <xref ref-type="table" rid="table2">Table 2</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). This is consistent with the finding of <xref ref-type="bibr" rid="bib50">Moglia et al. (2016)</xref>, who used a slightly more complex simulation algorithm to model the growth of cancer cell monolayers. Without obstacles, our simulations reproduce earlier findings (<xref ref-type="bibr" rid="bib17">Family and Vicsek, 1985</xref>) (<xref ref-type="table" rid="table2">Table 2</xref>). In particular, we find <inline-formula><mml:math id="inf354"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> without obstacles and <inline-formula><mml:math id="inf355"><mml:mrow><mml:mi>z</mml:mi><mml:mo>≈</mml:mo><mml:mn>1.15</mml:mn></mml:mrow></mml:math></inline-formula> at the critical obstacles density, which allows us to compute the scaling exponent of the sector boundaries from <xref ref-type="disp-formula" rid="equ8">Equation (8)</xref> as <inline-formula><mml:math id="inf356"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. This gives <inline-formula><mml:math id="inf357"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf358"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.86</mml:mn></mml:mrow></mml:math></inline-formula>, in excellent agreement with the lineage fluctuation exponents <inline-formula><mml:math id="inf359"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.66</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf360"><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>≈</mml:mo><mml:mn>0.86</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig6">Figure 6d</xref>. The clone size distribution <inline-formula><mml:math id="inf361"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mspace width="thinmathspace"/><mml:mo>&gt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for bubbles is predicted to scale as <inline-formula><mml:math id="inf362"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, which gives <inline-formula><mml:math id="inf363"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> in the KPZ case and predicts <inline-formula><mml:math id="inf364"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.46</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for QEW. In our simulation, we indeed observe similar clone size scaling without obstacles and at the critical obstacle density (see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1b</xref>, inset).</p><p>For a given obstacle density <inline-formula><mml:math id="inf365"><mml:mi>ρ</mml:mi></mml:math></inline-formula> the interface displays QEW scaling on length scales much shorter than the crossover scale <inline-formula><mml:math id="inf366"><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and KPZ scaling on much larger length scales, see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1b</xref>. We expect this crossover to shape the population genetics for intermediate <inline-formula><mml:math id="inf367"><mml:mi>ρ</mml:mi></mml:math></inline-formula>. Consider first neutral mutations, whose clone sizes we quantify in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. Clones with a width <inline-formula><mml:math id="inf368"><mml:mrow><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⟂</mml:mo></mml:msub><mml:mo>≪</mml:mo><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> will exhibit the QEW scaling, whereas clones with a width <inline-formula><mml:math id="inf369"><mml:mrow><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⟂</mml:mo></mml:msub><mml:mo>≫</mml:mo><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> will have the standard KPZ scaling. Since large clones (bubbles and sectors) dominate the mutant fraction <inline-formula><mml:math id="inf370"><mml:msub><mml:mi>f</mml:mi><mml:mi>MT</mml:mi></mml:msub></mml:math></inline-formula>, the neutral dynamics is thus dominated by KPZ scaling if the colony is much larger than <inline-formula><mml:math id="inf371"><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The situation is less clear for beneficial mutations. Selection induces another length scales <inline-formula><mml:math id="inf372"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, as we have recently shown (<xref ref-type="bibr" rid="bib24">Gralka et al., 2016b</xref>). The length scale <inline-formula><mml:math id="inf373"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> is the characteristic width of a beneficial clone below which it behaves neutrally; once the clone width has reached <inline-formula><mml:math id="inf374"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula>, selection can overcome drift and drive the clone to fixation. For KPZ interfaces, <inline-formula><mml:math id="inf375"><mml:mrow><mml:mrow><mml:mpadded width="+3.3pt"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>. Based on our earlier results, we can conjecture that for large systems (<inline-formula><mml:math id="inf376"><mml:mrow><mml:mi/><mml:mo>≫</mml:mo><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>), the selection length <inline-formula><mml:math id="inf377"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> can become larger than <inline-formula><mml:math id="inf378"><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf379"><mml:mi>s</mml:mi></mml:math></inline-formula> is sufficiently small. Thus, for <inline-formula><mml:math id="inf380"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≪</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="normal">ℓ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, we expect to recover the smooth (<inline-formula><mml:math id="inf381"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) behavior, with renormalized coefficients.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The strain pB10 was a generous gift by Thibault Stalder and Eva Top. Surface profilometry was performed with the help of Kurt Broderick. We would like to thank Jayson Paulose, Diana Fusco, and Jona Kayser, and all members of the Hallatschek lab for helpful discussions. We also thank Richard Neher, Maxim Lavrentovich, and an anonymous reviewer for their insightful and helpful comments. Research reported in this publication was supported by the National Institute of General Medical Sciences of the National Institutes of Health under award R01GM115851, a National Science Foundation CAREER Award (#1555330) and a Simons Investigator award from the Simons Foundation (#327934).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.44359.039</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-44359-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are available at Mendeley. Source data files have been provided for all figures.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Matti</surname><given-names>Gralka</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Code &amp; Data for: Environmental heterogeneity can tip the population genetics of range expansions</data-title><source>Mendeley</source><pub-id assigning-authority="other" pub-id-type="doi">10.17632/2fkhp73bc6.1</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amaral</surname> <given-names>LA</given-names></name><name><surname>Barabási</surname> <given-names>AL</given-names></name><name><surname>Makse</surname> <given-names>HA</given-names></name><name><surname>Stanley</surname> <given-names>HE</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Scaling properties of driven interfaces in disordered media</article-title><source>Physical Review E</source><volume>52</volume><fpage>4087</fpage><lpage>4104</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.52.4087</pub-id><pub-id pub-id-type="pmid">9963882</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Atis</surname> <given-names>S</given-names></name><name><surname>Dubey</surname> <given-names>AK</given-names></name><name><surname>Salin</surname> <given-names>D</given-names></name><name><surname>Talon</surname> <given-names>L</given-names></name><name><surname>Le Doussal</surname> <given-names>P</given-names></name><name><surname>Wiese</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Experimental evidence for three universality classes for reaction fronts in disordered flows</article-title><source>Physical Review Letters</source><volume>114</volume><elocation-id>234502</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.114.234502</pub-id><pub-id pub-id-type="pmid">26196805</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balázsi</surname> <given-names>G</given-names></name><name><surname>van Oudenaarden</surname> <given-names>A</given-names></name><name><surname>Collins</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Cellular decision making and biological noise: from microbes to mammals</article-title><source>Cell</source><volume>144</volume><fpage>910</fpage><lpage>925</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2011.01.030</pub-id><pub-id pub-id-type="pmid">21414483</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barabási</surname> <given-names>A-L</given-names></name><name><surname>Stanley</surname> <given-names>HE</given-names></name></person-group><year iso-8601-date="1995">1995</year><source>Fractal Concepts in Surface Growth</source><publisher-name>Cambridge university press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511599798</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baym</surname> <given-names>M</given-names></name><name><surname>Lieberman</surname> <given-names>TD</given-names></name><name><surname>Kelsic</surname> <given-names>ED</given-names></name><name><surname>Chait</surname> <given-names>R</given-names></name><name><surname>Gross</surname> <given-names>R</given-names></name><name><surname>Yelin</surname> <given-names>I</given-names></name><name><surname>Kishony</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatiotemporal microbial evolution on antibiotic landscapes</article-title><source>Science</source><volume>353</volume><fpage>1147</fpage><lpage>1151</lpage><pub-id pub-id-type="doi">10.1126/science.aag0822</pub-id><pub-id pub-id-type="pmid">27609891</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beller</surname> <given-names>DA</given-names></name><name><surname>Alards</surname> <given-names>KMJ</given-names></name><name><surname>Tesser</surname> <given-names>F</given-names></name><name><surname>Mosna</surname> <given-names>RA</given-names></name><name><surname>Toschi</surname> <given-names>F</given-names></name><name><surname>Möbius</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolution of populations expanding on curved surfaces <sup>(a)</sup></article-title><source>EPL</source><volume>123</volume><elocation-id>58005</elocation-id><pub-id pub-id-type="doi">10.1209/0295-5075/123/58005</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Zion</surname> <given-names>I</given-names></name><name><surname>Pollak</surname> <given-names>S</given-names></name><name><surname>Eldar</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Clonality and non-linearity drive facultative-cooperation allele diversity</article-title><source>The ISME Journal</source><volume>13</volume><fpage>824</fpage><lpage>835</lpage><pub-id pub-id-type="doi">10.1038/s41396-018-0310-y</pub-id><pub-id pub-id-type="pmid">30464316</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyer</surname> <given-names>D</given-names></name><name><surname>Mather</surname> <given-names>W</given-names></name><name><surname>Mondragón-Palomino</surname> <given-names>O</given-names></name><name><surname>Orozco-Fuentes</surname> <given-names>S</given-names></name><name><surname>Danino</surname> <given-names>T</given-names></name><name><surname>Hasty</surname> <given-names>J</given-names></name><name><surname>Tsimring</surname> <given-names>LS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Buckling instability in ordered bacterial colonies</article-title><source>Physical Biology</source><volume>8</volume><elocation-id>026008</elocation-id><pub-id pub-id-type="doi">10.1088/1478-3975/8/2/026008</pub-id><pub-id pub-id-type="pmid">21358041</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bunde</surname> <given-names>A</given-names></name><name><surname>Herrmann</surname> <given-names>HJ</given-names></name><name><surname>Margolina</surname> <given-names>A</given-names></name><name><surname>Stanley</surname> <given-names>HE</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Universality classes for spreading phenomena: A new model with fixed static but continuously tunable kinetic exponents</article-title><source>Physical Review Letters</source><volume>55</volume><fpage>653</fpage><lpage>656</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.55.653</pub-id><pub-id pub-id-type="pmid">10032412</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burton</surname> <given-names>OJ</given-names></name><name><surname>Travis</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The frequency of fitness peak shifts is increased at expanding range margins due to mutation surfing</article-title><source>Genetics</source><volume>179</volume><fpage>941</fpage><lpage>950</lpage><pub-id pub-id-type="doi">10.1534/genetics.108.087890</pub-id><pub-id pub-id-type="pmid">18505864</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Chu</surname> <given-names>S</given-names></name><name><surname>Kardar</surname> <given-names>M</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name><name><surname>Beller</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolution in range expansions with competition at rough boundaries</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1812.09279">https://arxiv.org/abs/1812.09279</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Gelder</surname> <given-names>L</given-names></name><name><surname>Ponciano</surname> <given-names>JM</given-names></name><name><surname>Joyce</surname> <given-names>P</given-names></name><name><surname>Top</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Stability of a promiscuous plasmid in different hosts: no guarantee for a long-term relationship</article-title><source>Microbiology</source><volume>153</volume><fpage>452</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1099/mic.0.2006/001784-0</pub-id><pub-id pub-id-type="pmid">17259616</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delker</surname> <given-names>T</given-names></name><name><surname>Pengra</surname> <given-names>DB</given-names></name><name><surname>Wong</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Interface pinning and the dynamics of capillary rise in porous media</article-title><source>Physical Review Letters</source><volume>76</volume><fpage>2902</fpage><lpage>2905</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.76.2902</pub-id><pub-id pub-id-type="pmid">10060820</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eden</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1961">1961</year><article-title>A two-dimensional growth process</article-title><source>Dynamics of Fractal Surfaces</source><volume>4</volume><fpage>223</fpage><lpage>239</lpage></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edmonds</surname> <given-names>CA</given-names></name><name><surname>Lillie</surname> <given-names>AS</given-names></name><name><surname>Cavalli-Sforza</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Mutations arising in the wave front of an expanding population</article-title><source>PNAS</source><volume>101</volume><fpage>975</fpage><lpage>979</lpage><pub-id pub-id-type="doi">10.1073/pnas.0308064100</pub-id><pub-id pub-id-type="pmid">14732681</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Excoffier</surname> <given-names>L</given-names></name><name><surname>Ray</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Surfing during population expansions promotes genetic revolutions and structuration</article-title><source>Trends in Ecology &amp; Evolution</source><volume>23</volume><fpage>347</fpage><lpage>351</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2008.04.004</pub-id><pub-id pub-id-type="pmid">18502536</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Family</surname> <given-names>F</given-names></name><name><surname>Vicsek</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Scaling of the active zone in the Eden process on percolation networks and the ballistic deposition model</article-title><source>Journal of Physics A: Mathematical and General</source><volume>18</volume><fpage>L75</fpage><lpage>L81</lpage><pub-id pub-id-type="doi">10.1088/0305-4470/18/2/005</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farrell</surname> <given-names>FD</given-names></name><name><surname>Gralka</surname> <given-names>M</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name><name><surname>Waclaw</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mechanical interactions in bacterial colonies and the surfing probability of beneficial mutations</article-title><source>Journal of The Royal Society Interface</source><volume>14</volume><pub-id pub-id-type="doi">10.1098/rsif.2017.0073</pub-id><pub-id pub-id-type="pmid">28592660</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>The wave of advance of advantageous genes</article-title><source>Annals of Eugenics</source><volume>7</volume><fpage>355</fpage><lpage>369</lpage><pub-id pub-id-type="doi">10.1111/j.1469-1809.1937.tb02153.x</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fusco</surname> <given-names>D</given-names></name><name><surname>Gralka</surname> <given-names>M</given-names></name><name><surname>Kayser</surname> <given-names>J</given-names></name><name><surname>Anderson</surname> <given-names>A</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Excess of mutational jackpot events in expanding populations revealed by spatial Luria-Delbrück experiments</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>12760</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms12760</pub-id><pub-id pub-id-type="pmid">27694797</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gillespie</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2004">2004</year><source>Population Genetics: A Concise Guide</source><publisher-name>JHU Press</publisher-name></element-citation></ref><ref id="bib22"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Giometto</surname> <given-names>A</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name><name><surname>Murray</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Physical interactions reduce the power of natural selection in growing yeast colonies</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/332700</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gralka</surname> <given-names>M</given-names></name><name><surname>Fusco</surname> <given-names>D</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>Watching populations melt down</article-title><source>Biophysical Journal</source><volume>111</volume><fpage>271</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2016.06.020</pub-id><pub-id pub-id-type="pmid">27463129</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gralka</surname> <given-names>M</given-names></name><name><surname>Stiewe</surname> <given-names>F</given-names></name><name><surname>Farrell</surname> <given-names>F</given-names></name><name><surname>Möbius</surname> <given-names>W</given-names></name><name><surname>Waclaw</surname> <given-names>B</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>Allele surfing promotes microbial adaptation from standing variation</article-title><source>Ecology Letters</source><volume>19</volume><fpage>889</fpage><lpage>898</lpage><pub-id pub-id-type="doi">10.1111/ele.12625</pub-id><pub-id pub-id-type="pmid">27307400</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gralka</surname> <given-names>M</given-names></name><name><surname>Fusco</surname> <given-names>D</given-names></name><name><surname>Martis</surname> <given-names>S</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Convection shapes the trade-off between antibiotic efficacy and the selection for resistance in spatial gradients</article-title><source>Physical Biology</source><volume>14</volume><elocation-id>045011</elocation-id><pub-id pub-id-type="doi">10.1088/1478-3975/aa7bb3</pub-id><pub-id pub-id-type="pmid">28649977</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grant</surname> <given-names>MAA</given-names></name><name><surname>Waclaw</surname> <given-names>B</given-names></name><name><surname>Allen</surname> <given-names>RJ</given-names></name><name><surname>Cicuta</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The role of mechanical forces in the planar-to-bulk transition in growing <italic>Escherichia coli</italic> microcolonies</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20140400</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2014.0400</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greulich</surname> <given-names>P</given-names></name><name><surname>Waclaw</surname> <given-names>B</given-names></name><name><surname>Allen</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Mutational pathway determines whether drug gradients accelerate evolution of drug-resistant cells</article-title><source>Physical Review Letters</source><volume>109</volume><pub-id pub-id-type="doi">10.1103/PhysRevLett.109.088101</pub-id><pub-id pub-id-type="pmid">23002776</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallatschek</surname> <given-names>O</given-names></name><name><surname>Hersen</surname> <given-names>P</given-names></name><name><surname>Ramanathan</surname> <given-names>S</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Genetic drift at expanding frontiers promotes gene segregation</article-title><source>PNAS</source><volume>104</volume><fpage>19926</fpage><lpage>19930</lpage><pub-id pub-id-type="doi">10.1073/pnas.0710150104</pub-id><pub-id pub-id-type="pmid">18056799</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermsen</surname> <given-names>R</given-names></name><name><surname>Deris</surname> <given-names>JB</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>On the rapidity of antibiotic resistance evolution facilitated by a concentration gradient</article-title><source>PNAS</source><volume>109</volume><fpage>10775</fpage><lpage>10780</lpage><pub-id pub-id-type="doi">10.1073/pnas.1117716109</pub-id><pub-id pub-id-type="pmid">22711808</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermsen</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The adaptation rate of a quantitative trait in an environmental gradient</article-title><source>Physical Biology</source><volume>13</volume><elocation-id>065003</elocation-id><pub-id pub-id-type="doi">10.1088/1478-3975/13/6/065003</pub-id><pub-id pub-id-type="pmid">27902491</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermsen</surname> <given-names>R</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Sources and sinks: a stochastic model of evolution in heterogeneous environments</article-title><source>Physical Review Letters</source><volume>105</volume><elocation-id>248104</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.105.248104</pub-id><pub-id pub-id-type="pmid">21231560</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herrmann</surname> <given-names>HJ</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Geometrical cluster growth models and kinetic gelation</article-title><source>Physics Reports</source><volume>136</volume><fpage>153</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1016/0370-1573(86)90047-5</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kardar</surname> <given-names>M</given-names></name><name><surname>Parisi</surname> <given-names>G</given-names></name><name><surname>Zhang</surname> <given-names>YC</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Dynamic scaling of growing interfaces</article-title><source>Physical Review Letters</source><volume>56</volume><fpage>889</fpage><lpage>892</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.56.889</pub-id><pub-id pub-id-type="pmid">10033312</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kayser</surname> <given-names>J</given-names></name><name><surname>Schreck</surname> <given-names>CF</given-names></name><name><surname>Gralka</surname> <given-names>M</given-names></name><name><surname>Fusco</surname> <given-names>D</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>Collective motion conceals fitness differences in crowded cellular populations</article-title><source>Nature Ecology &amp; Evolution</source><volume>3</volume><fpage>125</fpage><lpage>134</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0734-9</pub-id><pub-id pub-id-type="pmid">30510177</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kayser</surname> <given-names>J</given-names></name><name><surname>Schreck</surname> <given-names>CF</given-names></name><name><surname>Yu</surname> <given-names>Q</given-names></name><name><surname>Gralka</surname> <given-names>M</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>Emergence of evolutionary driving forces in pattern-forming microbial populations</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>373</volume><elocation-id>20170106</elocation-id><pub-id pub-id-type="doi">10.1098/rstb.2017.0106</pub-id><pub-id pub-id-type="pmid">29632260</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keitt</surname> <given-names>TH</given-names></name><name><surname>Lewis</surname> <given-names>MA</given-names></name><name><surname>Holt</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Allee effects, invasion pinning, and species' borders</article-title><source>The American naturalist</source><volume>157</volume><fpage>203</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1086/318633</pub-id><pub-id pub-id-type="pmid">18707272</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kessler</surname> <given-names>DA</given-names></name><name><surname>Levine</surname> <given-names>H</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Interface fluctuations in random media</article-title><source>Physical Review A</source><volume>43</volume><fpage>4551</fpage><lpage>4554</lpage><pub-id pub-id-type="doi">10.1103/PhysRevA.43.4551</pub-id><pub-id pub-id-type="pmid">9905566</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klopfstein</surname> <given-names>S</given-names></name><name><surname>Currat</surname> <given-names>M</given-names></name><name><surname>Excoffier</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The fate of mutations surfing on the wave of a range expansion</article-title><source>Molecular Biology and Evolution</source><volume>23</volume><fpage>482</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1093/molbev/msj057</pub-id><pub-id pub-id-type="pmid">16280540</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korolev</surname> <given-names>KS</given-names></name><name><surname>Avlund</surname> <given-names>M</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Genetic demixing and evolution in linear stepping stone models</article-title><source>Reviews of Modern Physics</source><volume>82</volume><fpage>1691</fpage><lpage>1718</lpage><pub-id pub-id-type="doi">10.1103/RevModPhys.82.1691</pub-id><pub-id pub-id-type="pmid">21072144</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korolev</surname> <given-names>KS</given-names></name><name><surname>Xavier</surname> <given-names>JB</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name><name><surname>Foster</surname> <given-names>KR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A quantitative test of population genetics using spatiogenetic patterns in bacterial colonies</article-title><source>The American Naturalist</source><volume>178</volume><fpage>538</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1086/661897</pub-id><pub-id pub-id-type="pmid">21956031</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Korolev</surname> <given-names>KS</given-names></name><name><surname>Müller</surname> <given-names>MJ</given-names></name><name><surname>Karahan</surname> <given-names>N</given-names></name><name><surname>Murray</surname> <given-names>AW</given-names></name><name><surname>Hallatschek</surname> <given-names>O</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Selective sweeps in growing microbial colonies</article-title><source>Physical Biology</source><volume>9</volume><elocation-id>026008</elocation-id><pub-id pub-id-type="doi">10.1088/1478-3975/9/2/026008</pub-id><pub-id pub-id-type="pmid">22476106</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhr</surname> <given-names>J-T</given-names></name><name><surname>Leisner</surname> <given-names>M</given-names></name><name><surname>Frey</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Range expansion with mutation and selection: dynamical phase transition in a two-species Eden model</article-title><source>New Journal of Physics</source><volume>13</volume><elocation-id>113013</elocation-id><pub-id pub-id-type="doi">10.1088/1367-2630/13/11/113013</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhr</surname> <given-names>J-T</given-names></name><name><surname>Stark</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Frequency-dependent selection at rough expanding fronts</article-title><source>New Journal of Physics</source><volume>17</volume><elocation-id>103035</elocation-id><pub-id pub-id-type="doi">10.1088/1367-2630/17/10/103035</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lavrentovich</surname> <given-names>MO</given-names></name><name><surname>Wahl</surname> <given-names>ME</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name><name><surname>Murray</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Spatially constrained growth enhances conversional meltdown</article-title><source>Biophysical Journal</source><volume>110</volume><fpage>2800</fpage><lpage>2808</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2016.05.024</pub-id><pub-id pub-id-type="pmid">27332138</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lavrentovich</surname> <given-names>MO</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Asymmetric mutualism in two- and three-dimensional range expansions</article-title><source>Physical Review Letters</source><volume>112</volume><elocation-id>138102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.112.138102</pub-id><pub-id pub-id-type="pmid">24745459</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lemerle</surname> <given-names>S</given-names></name><name><surname>Ferré</surname> <given-names>J</given-names></name><name><surname>Chappert</surname> <given-names>C</given-names></name><name><surname>Mathet</surname> <given-names>V</given-names></name><name><surname>Giamarchi</surname> <given-names>T</given-names></name><name><surname>Le Doussal</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Domain Wall Creep in an Ising Ultrathin Magnetic Film</article-title><source>Physical Review Letters</source><volume>80</volume><fpage>849</fpage><lpage>852</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.80.849</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindsey</surname> <given-names>HA</given-names></name><name><surname>Gallie</surname> <given-names>J</given-names></name><name><surname>Taylor</surname> <given-names>S</given-names></name><name><surname>Kerr</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evolutionary rescue from extinction is contingent on a lower rate of environmental change</article-title><source>Nature</source><volume>494</volume><fpage>463</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1038/nature11879</pub-id><pub-id pub-id-type="pmid">23395960</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louppe</surname> <given-names>V</given-names></name><name><surname>Courant</surname> <given-names>J</given-names></name><name><surname>Herrel</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Differences in mobility at the range edge of an expanding invasive population of <italic>Xenopus laevis</italic> in the west of France</article-title><source>The Journal of Experimental Biology</source><volume>220</volume><fpage>278</fpage><lpage>283</lpage><pub-id pub-id-type="doi">10.1242/jeb.146589</pub-id><pub-id pub-id-type="pmid">28100805</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Möbius</surname> <given-names>W</given-names></name><name><surname>Murray</surname> <given-names>AW</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>How obstacles perturb population fronts and alter their genetic structure</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004615</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004615</pub-id><pub-id pub-id-type="pmid">26696601</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moglia</surname> <given-names>B</given-names></name><name><surname>Albano</surname> <given-names>EV</given-names></name><name><surname>Guisoni</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pinning-depinning transition in a stochastic growth model for the evolution of cell colony fronts in a disordered medium</article-title><source>Physical Review E</source><volume>94</volume><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.94.052139</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname> <given-names>MJ</given-names></name><name><surname>Neugeboren</surname> <given-names>BI</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name><name><surname>Murray</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Genetic drift opposes mutualism during spatial population expansion</article-title><source>PNAS</source><volume>111</volume><fpage>1037</fpage><lpage>1042</lpage><pub-id pub-id-type="doi">10.1073/pnas.1313285111</pub-id><pub-id pub-id-type="pmid">24395776</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nattermann</surname> <given-names>T</given-names></name><name><surname>Stepanow</surname> <given-names>S</given-names></name><name><surname>Tang</surname> <given-names>L-H</given-names></name><name><surname>Leschhorn</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Dynamics of interface depinning in a disordered medium</article-title><source>Journal de Physique II</source><volume>2</volume><fpage>1483</fpage><lpage>1488</lpage><pub-id pub-id-type="doi">10.1051/jp2:1992214</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otwinowski</surname> <given-names>J</given-names></name><name><surname>Krug</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Clonal interference and Muller's ratchet in spatial habitats</article-title><source>Physical Biology</source><volume>11</volume><elocation-id>056003</elocation-id><pub-id pub-id-type="doi">10.1088/1478-3975/11/5/056003</pub-id><pub-id pub-id-type="pmid">25156977</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peischl</surname> <given-names>S</given-names></name><name><surname>Dupanloup</surname> <given-names>I</given-names></name><name><surname>Kirkpatrick</surname> <given-names>M</given-names></name><name><surname>Excoffier</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>On the accumulation of deleterious mutations during range expansions</article-title><source>Molecular Ecology</source><volume>22</volume><fpage>5972</fpage><lpage>5982</lpage><pub-id pub-id-type="doi">10.1111/mec.12524</pub-id><pub-id pub-id-type="pmid">24102784</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramachandran</surname> <given-names>S</given-names></name><name><surname>Deshpande</surname> <given-names>O</given-names></name><name><surname>Roseman</surname> <given-names>CC</given-names></name><name><surname>Rosenberg</surname> <given-names>NA</given-names></name><name><surname>Feldman</surname> <given-names>MW</given-names></name><name><surname>Cavalli-Sforza</surname> <given-names>LL</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Support from the relationship of genetic and geographic distance in human populations for a serial founder effect originating in Africa</article-title><source>PNAS</source><volume>102</volume><fpage>15942</fpage><lpage>15947</lpage><pub-id pub-id-type="doi">10.1073/pnas.0507611102</pub-id><pub-id pub-id-type="pmid">16243969</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schlüter</surname> <given-names>A</given-names></name><name><surname>Heuer</surname> <given-names>H</given-names></name><name><surname>Szczepanowski</surname> <given-names>R</given-names></name><name><surname>Forney</surname> <given-names>LJ</given-names></name><name><surname>Thomas</surname> <given-names>CM</given-names></name><name><surname>Pühler</surname> <given-names>A</given-names></name><name><surname>Top</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The 64 508 bp IncP-1beta antibiotic multiresistance plasmid pB10 isolated from a waste-water treatment plant provides evidence for recombination between members of different branches of the IncP-1beta group</article-title><source>Microbiology</source><volume>149</volume><fpage>3139</fpage><lpage>3153</lpage><pub-id pub-id-type="doi">10.1099/mic.0.26570-0</pub-id><pub-id pub-id-type="pmid">14600226</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname> <given-names>LH</given-names></name><name><surname>Leschhorn</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Pinning by directed percolation</article-title><source>Physical Review A</source><volume>45</volume><fpage>R8309</fpage><lpage>R8312</lpage><pub-id pub-id-type="doi">10.1103/PhysRevA.45.R8309</pub-id><pub-id pub-id-type="pmid">9907009</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Travis</surname> <given-names>JM</given-names></name><name><surname>Münkemüller</surname> <given-names>T</given-names></name><name><surname>Burton</surname> <given-names>OJ</given-names></name><name><surname>Best</surname> <given-names>A</given-names></name><name><surname>Dytham</surname> <given-names>C</given-names></name><name><surname>Johst</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Deleterious mutations can surf to high densities on the wave front of an expanding population</article-title><source>Molecular Biology and Evolution</source><volume>24</volume><fpage>2334</fpage><lpage>2343</lpage><pub-id pub-id-type="doi">10.1093/molbev/msm167</pub-id><pub-id pub-id-type="pmid">17703053</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Dyken</surname> <given-names>JD</given-names></name><name><surname>Müller</surname> <given-names>MJ</given-names></name><name><surname>Mack</surname> <given-names>KM</given-names></name><name><surname>Desai</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Spatial population expansion promotes the evolution of cooperation in an experimental prisoner's Dilemma</article-title><source>Current Biology</source><volume>23</volume><fpage>919</fpage><lpage>923</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.04.026</pub-id><pub-id pub-id-type="pmid">23664975</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vicsek</surname> <given-names>T</given-names></name><name><surname>Family</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Dynamic scaling for aggregation of clusters</article-title><source>Physical Review Letters</source><volume>52</volume><fpage>1669</fpage><lpage>1672</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.52.1669</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warren</surname> <given-names>MR</given-names></name><name><surname>Sun</surname> <given-names>H</given-names></name><name><surname>Yan</surname> <given-names>Y</given-names></name><name><surname>Cremer</surname> <given-names>J</given-names></name><name><surname>Li</surname> <given-names>B</given-names></name><name><surname>Hwa</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatiotemporal establishment of dense bacterial colonies growing on hard agar</article-title><source>eLife</source><volume>8</volume><elocation-id>e41093</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.41093</pub-id><pub-id pub-id-type="pmid">30855227</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wegmann</surname> <given-names>D</given-names></name><name><surname>Currat</surname> <given-names>M</given-names></name><name><surname>Excoffier</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Molecular diversity after a range expansion in heterogeneous environments</article-title><source>Genetics</source><volume>174</volume><fpage>2009</fpage><lpage>2020</lpage><pub-id pub-id-type="doi">10.1534/genetics.106.062851</pub-id><pub-id pub-id-type="pmid">17028329</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissman</surname> <given-names>DB</given-names></name><name><surname>Desai</surname> <given-names>MM</given-names></name><name><surname>Fisher</surname> <given-names>DS</given-names></name><name><surname>Feldman</surname> <given-names>MW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The rate at which asexual populations cross fitness valleys</article-title><source>Theoretical Population Biology</source><volume>75</volume><fpage>286</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2009.02.006</pub-id><pub-id pub-id-type="pmid">19285994</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname> <given-names>TA</given-names></name><name><surname>Perkins</surname> <given-names>SE</given-names></name><name><surname>Heckel</surname> <given-names>G</given-names></name><name><surname>Searle</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Adaptive evolution during an ongoing range expansion: the invasive bank vole (Myodes glareolus) in Ireland</article-title><source>Molecular Ecology</source><volume>22</volume><fpage>2971</fpage><lpage>2985</lpage><pub-id pub-id-type="doi">10.1111/mec.12343</pub-id><pub-id pub-id-type="pmid">23701376</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>With</surname> <given-names>KA</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The application of neutral landscape models in conservation biology. aplicacion de modelos de paisaje neutros en la biologia de la conservacion</article-title><source>Conservation Biology</source><volume>11</volume><fpage>1069</fpage><lpage>1080</lpage><pub-id pub-id-type="doi">10.1046/j.1523-1739.1997.96210.x</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>With</surname> <given-names>KA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The landscape ecology of invasive spread</article-title><source>Conservation Biology</source><volume>16</volume><fpage>1192</fpage><lpage>1203</lpage><pub-id pub-id-type="doi">10.1046/j.1523-1739.2002.01064.x</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>Q</given-names></name><name><surname>Lambert</surname> <given-names>G</given-names></name><name><surname>Liao</surname> <given-names>D</given-names></name><name><surname>Kim</surname> <given-names>H</given-names></name><name><surname>Robin</surname> <given-names>K</given-names></name><name><surname>Tung</surname> <given-names>CK</given-names></name><name><surname>Pourmand</surname> <given-names>N</given-names></name><name><surname>Austin</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Acceleration of emergence of bacterial antibiotic resistance in connected microenvironments</article-title><source>Science</source><volume>333</volume><fpage>1764</fpage><lpage>1767</lpage><pub-id pub-id-type="doi">10.1126/science.1208747</pub-id><pub-id pub-id-type="pmid">21940899</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.44359.043</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewing Editor</role><aff><institution>University of Basel</institution><country>Switzerland</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewer</role><aff><institution>University of Basel</institution><country>Switzerland</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Lavrentovich</surname><given-names>Maxim</given-names> </name><role>Reviewer</role><aff><institution>University of Tennessee</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Environmental heterogeneity can tip the population genetics of range expansions&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Richard A Neher as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Ian Baldwin as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Maxim Lavrentovich (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Gralka and Hallatschek present an interesting and elegant analysis of the effect of environmental heterogeneity on the efficacy with which populations can select for beneficial mutations and against deleterious mutations. They compare colony growth experiments on agar plates that are either roughened with filter paper or are smooth. The bacterial strains carry a plasmid that is lost at a high rate and loss of this plasmid has a tunable effect on growth. The plasmid is beneficial in presence of doxycycline but induces a cost in absence of drug. The authors show that selection for/against plasmid loss differs dramatically on rough or smooth surfaces. On rough surfaces, populations cannot select efficiently for beneficial mutations, and the fitness effect has little consequences for evolutionary dynamics. These results are then compared to a simple theoretical model of evolution in a heterogeneous environment, which revealed that evolutionary dynamics changes qualitatively as the obstacle density approaches the percolation threshold.</p><p>This work with its combination of experiment and theory addresses an important problem in evolutionary biology. However, to make the conclusions more compelling, we would like the authors to address the points below.</p><p>Essential revisions:</p><p>In their reports and the ensuing discussion, the reviewers agreed that there are two central points that need to be addressed:</p><p>1) Experiment and theory are not sufficiently linked. There is no discussion whether the experimental system is plausibly close to a percolation threshold and the nature of the surface roughness remains elusive. The authors should characterize the patterned surface and possibly repeat the experiments with different degrees of roughness. Quantitative measurements of correlations, colony surface roughness, and other length scales in the experiment should be used to explicitly link to theory and make the case that experimental system is close to a percolation threshold. The reduction in growth rate and the difference in overall colony expansion rate should be explicitly measured at different drug concentrations and used to compare with model predictions. In its current form, the experiments motivate the theory, but the theory is not used to quantitatively explain the experimental results.</p><p>2) Mutation frequencies <italic>f</italic><sub>MT</sub> depend on time and comparing <italic>f</italic><sub>MT</sub> in two conditions with different growth rates at a fixed time is not very meaningful. It would be much better to compare trajectories and log-derivatives of <italic>f</italic><sub>MT</sub>. Some discussion on whether <italic>f</italic><sub>MT</sub> should be measured in bulk or on the perimeter would also be welcome.</p><p>Please also note that simulation and analysis code should be made available (for example on github) along with suitable documentation.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.44359.044</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>In their reports and the ensuing discussion, the reviewers agreed that there are two central points that need to be addressed:</p><p>1) Experiment and theory are not sufficiently linked. There is no discussion whether the experimental system is plausibly close to a percolation threshold and the nature of the surface roughness remains elusive. The authors should characterize the patterned surface and possibly repeat the experiments with different degrees of roughness. Quantitative measurements of correlations, colony surface roughness, and other length scales in the experiment should be used to explicitly link to theory and make the case that experimental system is close to a percolation threshold. The reduction in growth rate and the difference in overall colony expansion rate should be explicitly measured at different drug concentrations and used to compare with model predictions. In its current form, the experiments motivate the theory, but the theory is not used to quantitatively explain the experimental results.</p></disp-quote><p>We have rewritten the manuscript extensively, added new figures and performed additional experiments following the reviewers’ suggestions to connect theory and experiment:</p><p>Firstly, ​we characterized the “rough” surfaces in detail using profilometry. A representative image of a rough surface is shown in Figure 1—figure supplement 2, where light areas correspond to elevation and dark areas corresponds to depressions, showing that the surface is characterized by elongated ridges and “channels” (Figure 1—figure supplement 2A). Profile traces of the surface allow us to accurately quantify the roughness of the surface (SD 10um, range 50um). In addition, adaptive binarization of the microscopic image allows us to estimate the density of elevations, which may serve as obstacles, as between 0.3 and 0.5 (Figure 1—figure supplement 2D). Although this estimate is very approximate, it nevertheless suggests that the rough surface is rugged in a way that makes it plausible that the colony may be near a percolation transition (but, as we discuss below, a strict percolation transition is not needed for a strong effect on population genetics).</p><p>The width of the “channels” in the substrate is robust with respect to the choice of binarization parameters; the channels and ridges are typically about 15-30um wide (Figure 1—figure supplement 2E). This length scale is consistent with the width at which the branch-like outgrowths of the colonies become visible (about 20um). It also coincides with the width of the growth layer, which is the length scale governing the range of mechanical interactions within the colony. This explains why the colony morphology is impacted so strongly by the substrate surface roughness.</p><p>We now also comment in manuscript on the fact that dramatic effects can occur in models that do not have a percolation transition, which is one of the conclusions of our minimal model. This is because the properties of the front dictate the evolutionary dynamics, since mutations occur only within the growing population at the front, such that a slowdown have comparable effects on the evolutionary dynamics as a complete halt. In our experiments, we have no real obstacles because growth continues outside of the channels, and thus we have no percolation transition in the experiment – but just like in our theory, where we see a strong response in population dynamics and genetics even for k&gt;0.</p><p>Secondly, we now ​explicitly show the radial growth rate in Figure 2 for both scenarios, which shows that the ​radial growth rate is lower on rough substrates​, but in a way that preserves the relative growth rate differences between mutants and wild types.</p><p>Thirdly, we now more clearly ​specify the role and purpose of theory in this paper as answering the following question​: given the obvious complexities of the experimental system (mechanical forces, potential for cell-cell ordering, strong correlations in the heterogeneities of growth substrate) do​ our key findings hinge on these complexities, or can much simpler uncorrelated heterogeneities in growth rates also have comparable effects on population genetics? Our simple lattice model that is agnostic to biological details clearly confirms that the latter is the case. We discuss the limitations of this approach in this Discussion section:</p><p>“Despite its simplicity, our minimal model reproduces many experimental findings qualitatively, such as a rougher colony morphology and a reduced efficacy of selection in the presence of environmental heterogeneity. […] In the simulations, however, the heterogeneity can be felt on all length scales, such that it affects mutant clones of all sizes the same way.”</p><disp-quote content-type="editor-comment"><p>2) Mutation frequencies f<sub>MT</sub> depend on time and comparing f<sub>MT</sub> in two conditions with different growth rates at a fixed time is not very meaningful. It would be much better to compare trajectories and log-derivatives of f<sub>MT</sub>. Some discussion on whether f<sub>MT</sub> should be measured in bulk or on the perimeter would also be welcome.</p></disp-quote><p>Measuring <italic>f</italic><sub>MT</sub> on the final colony sizes has the advantage of averaging over a large number of mutant clones, which reduces the noise due to the stochasticity of when a successful mutation arises. In addition, it is simple to measure and interpret, and gives a direct impression of the strong differences in the population genetics between smooth and rough substrates. However, it is accurate that <italic>f</italic><sub>MT</sub> depends on time; in principle, if the colony growth rates were extremely different, <italic>f</italic><sub>MT</sub> could differ simply because one scenario gives rise to much smaller colonies with corresponding smaller <italic>f</italic><sub>MT</sub>. In our experiments, final radii were comparable between the two treatments, so this issue does not arise.</p><p>As suggested, we have analyzed the mutant frequency over time (i.e., as a function of radius) for all different antibiotic concentrations. The results are presented in Figure 2—figure supplement 2. In both scenarios (smooth/rough substrate), the mutant frequency increases super-linearly with radius; square-root transformed <italic>f</italic><sub>MT</sub> values give good linear fits (although noisy for rough substrates), whose slopes show the same tendencies as the original <italic>f</italic><sub>MT</sub> plot in Figure 2: on smooth substrate, the slope increases with s for s&gt;0, whereas it stay roughly constant on rough substrates. However, there is no established theory that would predict the quadratic relationship between <italic>f</italic><sub>MT</sub> and <italic>r</italic>, and since it is beyond the scope of our paper to develop such a theory, we prefer to have the original figure (<italic>f</italic><sub>MT</sub> at the final radius) in the main text, and refer the reader to the new figure supplement.</p><p>Finally, we have added a brief discussion on whether <italic>f</italic><sub>MT</sub> should be measured in bulk or on the perimeter. In our view, there are several reason that make the use of a bulk measurement (either as a function of radius, or simply on the whole-colony level) preferable over measuring the frequency at the perimeter.</p><p>1) For strongly beneficial mutations, the mutant frequency at the perimeter can quickly reach 1, making beneficial mutations more difficult to distinguish in terms of their frequency at the perimeter (although differences remain visible on the colony scale).</p><p>2) At the same time, bulk measurements give a conservative, but proportional estimate of the frequency at the perimeter.</p><p>3) One may argue that the subpopulation at the perimeter is the only important part in terms of the future of the population. However, especially for dense cellular populations such as biofilms or tumors, we believe it is unclear whether this is true in general, since the answer hinges on the mode of dispersal. Biofilms might form spores or other propagules preferentially in the bulk of the population, and tumor cells undergoing the EMT need not be situated at the tumor edge.</p><p>4) Microscopically, clones at the perimeter are difficult to detect reliably because the overall fluorescence intensity is lower.</p><p>5) By restricting the analysis to the perimeter, the amount of data available for analysis is lower, yielding noisier data (even if clone detection was perfect at the perimeter).</p><p>Our decision to focus on the bulk mutant frequency is now discussed in the main text as follows: “The primary readout of our experiments is the final mutant frequency <italic>f</italic><sub>MT</sub> in the colony […]However, this measure can quickly become uninformative for beneficial mutations as mutants overtake the whole perimeter and is often difficult to measure accurately, while the mutant frequency averaged over the whole population gives a conservative, but proportional measure of the mutant frequency at the perimeter.”</p><disp-quote content-type="editor-comment"><p>Please also note that simulation and analysis code should be made available (for example on github) along with suitable documentation.</p></disp-quote><p>We have made all data available under the URL http://dx.doi.org/10.17632/2fkhp73bc6.1 including analysis scripts (Mathematica), simulation code (C++), simulation outputs (txt), as well as raw and edited microscopy images.</p></body></sub-article></article>