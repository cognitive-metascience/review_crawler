<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">11476</article-id><article-id pub-id-type="doi">10.7554/eLife.11476</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Short Report</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Neural signatures of perceptual inference</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-41973"><name><surname>Sedley</surname><given-names>William</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9371-0962</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-37768"><name><surname>Gander</surname><given-names>Phillip E</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-43673"><name><surname>Kumar</surname><given-names>Sukhbinder</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-43674"><name><surname>Kovach</surname><given-names>Christopher K</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-43675"><name><surname>Oya</surname><given-names>Hiroyuki</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-43676"><name><surname>Kawasaki</surname><given-names>Hiroto</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-43677"><name><surname>Howard</surname><given-names>Matthew A</given-names><suffix>III</suffix></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-43678"><name><surname>Griffiths</surname><given-names>Timothy D</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Institute of Neuroscience</institution>, <institution>Newcastle University</institution>, <addr-line><named-content content-type="city">Newcastle upon Tyne</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Human Brain Research Laboratory</institution>, <institution>University of Iowa</institution>, <addr-line><named-content content-type="city">Iowa</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Wellcome Trust Centre for Neuroimaging</institution>, <institution>University College London</institution>, <addr-line><named-content content-type="city">London</named-content></addr-line>, <country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>King</surname><given-names>Andrew J</given-names></name><role>Reviewing editor</role><aff id="aff4"><institution>University of Oxford</institution>, <country>United Kingdom</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>willsedley@gmail.com</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>07</day><month>03</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e11476</elocation-id><history><date date-type="received"><day>09</day><month>09</month><year>2015</year></date><date date-type="accepted"><day>05</day><month>03</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Sedley et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Sedley et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-11476-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.11476.001</object-id><p>Generative models, such as <italic>predictive coding</italic>, posit that perception results from a combination of sensory input and prior <italic>prediction</italic>, each weighted by its <italic>precision</italic> (inverse variance), with incongruence between these termed <italic>prediction error</italic> (deviation from prediction) or <italic>surprise</italic> (negative log probability of the sensory input). However, direct evidence for such a system, and the physiological basis of its computations, is lacking. Using an auditory stimulus whose pitch value changed according to specific rules, we controlled and separated the three key computational variables underlying perception, and discovered, using direct recordings from human auditory cortex, that <italic>surprise</italic> due to prediction violations is encoded by local field potential oscillations in the gamma band (&gt;30 Hz), changes to <italic>predictions</italic> in the beta band (12-30 Hz), and that the <italic>precision</italic> of predictions appears to quantitatively relate to alpha band oscillations (8-12 Hz). These results confirm oscillatory codes for critical aspects of generative models of perception.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.001">http://dx.doi.org/10.7554/eLife.11476.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.11476.002</object-id><title>eLife digest</title><p>Our perception of the world is not only based on input from our senses. Instead, what we perceive is also heavily altered by the context of what is being sensed and our expectations about it. Some researchers have suggested that perception results from combining information from our senses and our predictions. This school of thought, referred to as “predictive coding”, essentially proposed that the brain stores a model of the world and weighs it up against information from our senses in order to determine what we perceive.</p><p>Nevertheless, direct evidence for the brain working in this way was still missing. While neuroscientists had seen the brain respond when there was a mismatch between an expectation and incoming sensory information, no one has observed the predictions themselves within the brain.</p><p>Sedley et al. now provide such direct evidence for predictions about upcoming sensory information, by directly recording the electrical activity in the brains of human volunteers who were undergoing surgery for epilepsy. The experiment made use of a new method in which the volunteers listened to a sequence of sounds that was semi-predictable. That is to say that, at first, the volunteers heard a selection of similarly pitched sounds. After random intervals, the average pitch of these sounds changed and they became more or less variable for a while before randomly changing again. This approach meant that the volunteers had to continually update their predictions throughout the experiment</p><p>In keeping with previous studies, the unexpected sounds, which caused a mismatch between the sensory information and the brain’s prediction, were linked to high-frequency brainwaves. However, Sedley et al. discovered that updating the predictions themselves was linked to middle-frequency brainwaves; this confirms what the predictive coding model had suggested. Finally, this approach also unexpectedly revealed that how confident the volunteer was about the prediction was linked to low-frequency brainwaves.</p><p>In the future, this new method will provide an easy way of directly studying elements of perception in humans and, since the experiments do not require complex learning, in other animals too.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.002">http://dx.doi.org/10.7554/eLife.11476.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>perception</kwd><kwd>predictions</kwd><kwd>surprise</kwd><kwd>prediction error</kwd><kwd>predictive coding</kwd><kwd>auditory cortex</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id><institution>Medical Research Council</institution></institution-wrap></funding-source><award-id>MR/J011207/1</award-id><principal-award-recipient><name><surname>Sedley</surname><given-names>William</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>NIH R01-DC04290</award-id><principal-award-recipient><name><surname>Kovach</surname><given-names>Christopher K</given-names></name><name><surname>Oya</surname><given-names>Hiroyuki</given-names></name><name><surname>Kawasaki</surname><given-names>Hiroto</given-names></name><name><surname>Howard</surname><given-names>Matthew A</given-names><suffix>III</suffix></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id><institution>Wellcome Trust</institution></institution-wrap></funding-source><award-id>WT091681MA</award-id><principal-award-recipient><name><surname>Gander</surname><given-names>Phillip E</given-names></name><name><surname>Griffiths</surname><given-names>Timothy D</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Changes to sensory predictions are encoded by beta oscillations, surprise due to prediction violations by gamma oscillations, and alpha oscillations may have a role in controlling the precision of predictions.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>It has long been apparent that brain responses do not simply represent input from sensory organs, but that they are modulated by context and expectation, giving rise to phenomena such as priming, mismatch negativity and repetition suppression. These can be explained if perceptual systems are based on internal generative models of the environment which are constantly updated based on experience. Predictive coding (<xref ref-type="bibr" rid="bib25">Rao and Ballard, 1999</xref>) is a popular account of perception, in which internal representations generate <italic>predictions</italic> about upcoming sensory input, characterised by their mean and <italic>precision</italic> (inverse variance) (<xref ref-type="bibr" rid="bib12">Friston, 2005</xref>; <xref ref-type="bibr" rid="bib15">Friston and Kiebel, 2009</xref>). Sensory information is processed hierarchically, with backward connections conveying predictions, and forward connections conveying violations of these predictions, namely <italic>prediction errors</italic>. Qualitatively, prediction errors are the mismatch between the prediction and incoming sensory information, but the term is often used without a quantitative definition. One quantitative formulation of prediction error is <italic>surprise</italic> (<xref ref-type="bibr" rid="bib15">Friston and Kiebel, 2009</xref>), which is the negative log probability of a sensory event, given the prior prediction. This definition takes into account the <italic>precision</italic> of predictions, such that the same prediction violation causes greater surprise where predictions are more precise. Prediction errors act to produce changes in predictions, thereby updating and refining internal models of the environment, and reducing subsequent prediction errors. These variables are illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>. There is substantial overlap between predictive coding and other accounts of perception based on internal generative models (<xref ref-type="bibr" rid="bib14">Friston, 2008</xref>). The crucial common feature of any generative model of perception is the brain’s use of hidden states to predict observed sensory inputs, thus the methods and findings of this study are applicable to all generative perceptual models.<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.11476.003</object-id><label>Figure 1.</label><caption><title>Computational variables involved in perceptual inference.</title><p>The graph displays a schematic probability distribution (solid curve) representing the prior prediction about the fundamental frequency (f) of an upcoming auditory stimulus (f<sub>t</sub>), where t simply refers to the number or position of the stimulus within a sequence. This prediction is characterised by its mean (μ<sub>t</sub>) and precision (Π<sub>t</sub>), which is the inverse of its variance (σ<sup>2</sup>). The incongruence between the actual f<sub>t</sub> and the prediction can be expressed either as a (non-precision-weighted) prediction error (ξ<sub>t</sub>), that is, the absolute difference from the prediction mean, or as surprise (S<sub>t</sub>), that is, the negative log probability of the actual f<sub>t</sub> value according to the prediction distribution. As a result of a mismatch with bottom up sensory information, the prediction changes (dashed line). The change to the prediction (Δμ<sub>t</sub>) is calculated simply as the absolute difference between the old (μ<sub>t</sub>) and new (μ<sub>t+1</sub>) prediction means. Note that the curves on the graph display changing predictions on account of a stimulus (i.e. Bayesian belief updating) as opposed to the more commonly encountered graph in this field of research where the curves indicate the prior prediction, the sensory information and the posterior inference about the individual stimulus (i.e. Bayesian inference).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.003">http://dx.doi.org/10.7554/eLife.11476.003</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-11476-fig1-v2"/></fig></p><p>The functional unit of neocortex, the <italic>canonical microcircuit</italic> (<xref ref-type="bibr" rid="bib19">Haeusler and Maass, 2007</xref>), has recently been interpreted in light of predictive coding models (<xref ref-type="bibr" rid="bib3">Bastos et al., 2012</xref>), revealing appropriate neuronal properties and internal/external connectivity to carry out the necessary neuronal computations. It is thus hypothesised that superficial cell populations calculate prediction errors, manifest as gamma-band oscillations (&gt;30 Hz), and pass these to higher brain areas, while deep cell populations encode predictions, which manifest as beta band oscillations (12–30 Hz) and pass these to lower brain areas (<xref ref-type="bibr" rid="bib3">Bastos et al., 2012</xref>). The layer-specific separation of higher and lower frequency oscillations (<xref ref-type="bibr" rid="bib26">Spaak et al., 2012</xref>), and the forward/backward asymmetry of high/low frequency oscillations (<xref ref-type="bibr" rid="bib7">Buschman and Miller, 2007</xref>; <xref ref-type="bibr" rid="bib11">Fontolan et al., 2014</xref>; <xref ref-type="bibr" rid="bib28">van Kerkoerle et al., 2014</xref>, <xref ref-type="bibr" rid="bib4">Bastos et al., 2015</xref>), are supported by direct evidence. A number of studies have found oscillatory gamma magnitude to correlate with the unexpectedness of incongruence of stimuli (<xref ref-type="bibr" rid="bib1">Arnal et al., 2011</xref>; <xref ref-type="bibr" rid="bib6">Brodski et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Todorovic et al., 2011</xref>), but it remains unclear exactly what computational variable they represent. While there is a strong case that beta oscillations are involved in top-down neural communication, evidence specifically linking beta oscillations to predictions is presently limited and indirect (<xref ref-type="bibr" rid="bib2">Arnal and Giraud, 2012</xref>), but includes observations that there is interdependence of gamma and subsequent beta activity in both in vivo (<xref ref-type="bibr" rid="bib18">Haenschel et al., 2000</xref>) and in silico (<xref ref-type="bibr" rid="bib22">Kopell et al., 2011</xref>) studies and that omissions of expected stimuli induce a beta rebound response (<xref ref-type="bibr" rid="bib16">Fujioka et al., 2009</xref>). An oscillatory correlate of precision, to our knowledge, has not been proposed, though precision might affect the magnitude of gamma responses to prediction violations (<xref ref-type="bibr" rid="bib10">Feldman and Friston, 2010</xref>). While an oscillatory correlate is possible, a case has been made that neuromodulatory connections alone, for instance from the basal forebrain cholinergic system, may be sufficient to dynamically mediate precision in sensory hierarchies (<xref ref-type="bibr" rid="bib10">Feldman and Friston, 2010</xref>; <xref ref-type="bibr" rid="bib21">Kanai et al., 2015</xref>). Direct evidence for correlates of processes inherent in perceptual inference requires being able to quantitatively manipulate predictions during an experiment, which has not so far been achieved.</p><p>In the present study, we sought to dissociate and expose the neural signatures of four key variables in predictive coding and other generative accounts of perception, namely <italic>surprise, prediction error, prediction change</italic> and <italic>prediction precision</italic>. Here, <italic>prediction error</italic> refers to absolute deviation of a sensory event from the mean of the prior prediction (which does not take into account the precision of the prediction). We hypothesised that surprise (over and above prediction error) would correlate with gamma oscillations, and prediction change with beta oscillations. The possibility of an oscillatory code for precision was also explored.</p></sec><sec id="s2" sec-type="results|discussion"><title>Results and discussion</title><p>Direct cortical recordings were made from the auditory cortices of three awake humans undergoing invasive monitoring for epilepsy localization, while they listened to a pitch stimulus with a fundamental frequency (usually referred to as ‘f0’; hereafter just ‘f’ for clarity) that varied according to simple rules (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Local field potential (LFP) data were decomposed using Morlet wavelets, separated into evoked and induced components, and regressed against the four perceptual inference variables of interest which were calculated by Bayes-optimal inversion of the sequence of f values assuming full knowledge of the rules by which they were generated (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref> and <xref ref-type="fig" rid="fig2s2">2</xref>).<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.11476.004</object-id><label>Figure 2.</label><caption><title>Algorithm and example stimulus.</title><p>(<bold>A</bold>) The stimulus is composed of a series of concatenated segments, differing only in fundamental frequency (f). At any time, a given f population is in effect, characterised by its mean (μ) and standard deviation (σ). For each successive segment, there is a 7/8 chance that that segment’s f value will be randomly drawn from the present population, and a 1/8 chance that the present population will be replaced, with new μ and σ values drawn from uniform distributions. (<bold>B</bold>) Example section of stimulus. (<bold>Bi</bold>) Dots indicate the f values of individual stimulus segments, of 300 ms duration each. Four population changes are apparent. (<bold>Bii</bold>) Spectrogram of the corresponding stimulus, up to 5 kHz, on a colour scale of -60 to 0 dB relative to the maximum power value. The stimulus power spectrum does not change between segments, and the only difference is the spacing of the harmonics.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.004">http://dx.doi.org/10.7554/eLife.11476.004</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-11476-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Generative model and inversion scheme.</title><p>Schematic of the full three-dimensional model space, with dimensions indicating population mean (σ), population standard deviation (σ) and stimulus fundamental frequency (f). To ease computational demands, the model space was discretised. Each point in model space corresponds to the probability of a particular f, given a specific μ and σ, that is, P(f|μ,σ). Therefore each column (along the f dimension) gives the probability distribution P(f|μ,σ), and corresponds to the forward model. The planes of the model space, conversely, indicate the probability of each given combination of μ and σ, given a particular f value, that is, P(μ,σ|f), or in other words the inverse model. To generate priors based on a series of observed f values, the scalar product of the planes for each of these f values is taken, and the resulting plane scaled to a sum of 1. This plane represents the estimates of the hidden states μ and σ and is then used to weight the columns of the model space. The weighted model space is averaged into a single column (forward model), and scaled to a sum of 1, thus providing optimal priors on the assumption that the f population does not change. The priors assuming a population change are derived from the same procedure, but with uniform weighting across the model space. The change and no change priors are then weighted according to the probability of a population change, and then summed. The only part of the process not illustrated here is the inference of population changes, determining how many preceding f values form part of the model inversion, which is explained in Equation 2.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.005">http://dx.doi.org/10.7554/eLife.11476.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig2-figsupp1-v2"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.006</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Example Bayes-optimal prior predictions generated by model inversion.</title><p>Observed f values from a section of the stimulus (white dots), overlaid on prior predictions (colour scale) based on previous observations of f, using the model inversion scheme.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.006">http://dx.doi.org/10.7554/eLife.11476.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig2-figsupp2-v2"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.007</object-id><label>Figure 2—figure supplement 3.</label><caption><title>Regressor correlations.</title><p>Correlation matrices between instantaneous and time-lagged values of the main regressors. Note the strong instantaneous mutual positive correlations between Δf, S and Δμ, and the negative correlations between Π and preceding values of Δf, S and Δμ.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.007">http://dx.doi.org/10.7554/eLife.11476.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig2-figsupp3-v2"/></fig></fig-group></p><p>In keeping with prior hypotheses, both <italic>surprise</italic> and <italic>prediction error</italic> (the latter not taking into account the precision of predictions) were associated with significant gamma band responses in the LFP. We first established which of these variables explained the LFP data better. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the strong correlation between these variables (A), the explanatory power of each with respect to the LFP data (B), and the unique explanatory power of each after partialling out the other variable (C). The extremely strong correlation between <italic>surprise</italic> and <italic>prediction error</italic> (r = 0.92 over 8000 samples) necessitated this partial analysis (C) in order to examine the independent contribution of each variable to the observed LFP data. Both variables correlated positively with gamma magnitude, but <italic>surprise</italic> showed a stronger correlation in all three subjects. In the partial analysis (C), residual <italic>surprise</italic> (after partialling out <italic>prediction error</italic>) correlated positively with gamma magnitude, whereas residual <italic>prediction error</italic> (after partialling out <italic>surprise</italic>) showed only a weak negative correlation in two subjects, and no correlation in one subject. At group level, these correlations were significantly different to each other at p&lt;0.01 corrected, thus we concluded that <italic>surprise</italic> is the better correlate of gamma magnitude, and used this measure for further analysis.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.11476.008</object-id><label>Figure 3.</label><caption><title>Comparison between surprise and prediction error.</title><p>(<bold>A</bold>) Correlation between surprise (S) and non-precision-weighted prediction error (ξ), with each dot indicating an individual stimulus segment and the line indicating a linear regression fit. (<bold>B</bold>/<bold>C</bold>) Mean Pearson product moment correlation coefficients (r) between S<sub>t</sub> or ξ<sub>t</sub>, and gamma oscillation magnitude (30–100 Hz) in the 90–500 ms period following the onset of stimulus segment t. Regression coefficients were calculated for each time-frequency point, after partialling out the influences of current and preceding/subsequent values of all other regressors, and then averaged across time and frequency; these processing steps diminished the absolute size of the correlation values. In C, the influence of S on ξ, and ξ on S, was also partialled out, thus exposing the unique contribution of each variable to explaining the observed neural response. Partial S showed a higher mean correlation, across subjects, with gamma magnitude than partial ξ (p&lt;0.01).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.008">http://dx.doi.org/10.7554/eLife.11476.008</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-11476-fig3-v2"/></fig></p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows, at group level, the spectrotemporal pattern of induced and evoked oscillations uniquely attributable to each of the three perceptual variables of interest: surprise (S), change in prediction mean (Δμ), precision of predictions (Π), as well as the change in f value from one stimulus to the next (Δf). The latter measure was not a perceptual variable of interest but was included for comparative purposes as it approximately represents the ‘pitch onset response’ which is a robust and familiar response in auditory neurophysiology (<xref ref-type="bibr" rid="bib17">Griffiths et al., 2010</xref>). Data significant at p&lt;0.05 corrected (based on a non-parametric permutation approach [<xref ref-type="bibr" rid="bib24">Maris and Oostenveld, 2007</xref>]) are shown in the left column of each group, and all data in the right column. Individual subject data are shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. As these perceptual variables were highly correlated (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>), instantaneously and over time, regression for the main analysis was based on the residuals after partialling out these correlated influences, such that only the unique explanatory contribution of each variable, with respect to the LFP data, was measured. While the correlation values observed were small in absolute terms (Pearson’s r &lt; 0.1), reassuringly these r values were of the same scale of magnitude as those for change in frequency (Δf), which represents a robust auditory response. Furthermore, the LFP data variance explained by the entire model (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) was around 1%. In accordance with our hypotheses, <italic>surprise</italic> (S) correlated positively, across subjects, with gamma oscillations, beginning at around 100 ms from segment onset, and this was significant by 200 ms. Also in accordance with our hypothesis, changes to <italic>predictions</italic> (Δμ) correlated positively with beta oscillations coinciding with the onset of the subsequent stimulus segment (about 100 ms after), which again was significant. Prediction <italic>precision</italic> (Π) correlated positively with delta-alpha (2–12 Hz) frequency oscillations (for the whole 0–300 ms period from segment onset), although this was only significant in the alpha frequency range, and fell slightly below significance in the delta-theta range. Given the strong negative correlation between Π and the preceding values of S and Δf, it seemed likely that the low-frequency correlates of these were being mutually attenuated by the partialisation process. For this reason, and to search for correlates of the commonalities between key variables, we repeated the analyses with only the contemporaneous value of Δf being partialled out (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). This analysis found highly significant correlates of <italic>precision</italic> (Π) in the full delta-alpha range, spanning the previous, current and subsequent segments, but we cannot attribute the delta-theta component to Π with absolute confidence. To respect the exploratory nature of our search for oscillatory correlates of Π, a further variation of the analysis (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>) omitted Π altogether (including the partialisation of other variables with respect to it). Results were quantitatively stronger (due to reduced partialisation), but qualitatively similar except that S contained a strong negative delta-alpha band correlation coincident with the subsequent stimulus segment. As S for one segment is negatively correlated with Π of the subsequent segment, it is thus not presently clear how much of this low-frequency correlation is with S (negatively), and how much with Π (positively). However, given its sole significant association in the main analysis (<xref ref-type="fig" rid="fig4">Figure 4</xref>) is with Π, and that a low-frequency correlate of S is not expected based on prior literature, we favour the interpretation that low-frequency oscillations are a correlate of the precision of prior predictions. Evoked results are shown in the right hand sections of <xref ref-type="fig" rid="fig4">Figure 4</xref> plus its figure supplements 3 and 4. Unlike the induced results, there was no qualitative distinction between the timing or frequency profiles of the different variables (this is particularly evident in <xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). The only significant evoked responses in the main analysis (<xref ref-type="fig" rid="fig4">Figure 4</xref>) were to Δf and Δμ, while S only showed significant evoked correlates when Π was omitted from the analysis (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>).<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.11476.009</object-id><label>Figure 4.</label><caption><title>Spectrotemporal profiles associated with key perceptual inference variables.</title><p>Each plot illustrates the mean Pearson product moment correlation coefficient (r), across stimulus-responsive electrodes and across subjects, between induced oscillatory amplitude, at each time-frequency point, and the regressor of interest, that is, a time-frequency ‘image’ of the oscillatory correlates of a particular perceptual variable. Time is represented on horizontal axes, and frequency on vertical. Dashed lines indicate the division between the previous (t-1), current (t) and subsequent (t+1) stimulus segment (vertical lines), and between frequency bands (horizontal lines). Each row of plots represents one regressor. The left-hand group contains induced correlates, and the right-hand group evoked, with the left-hand column in each group showing data points significant at p&lt;0.05 corrected. Regressors are partialised with respect to each other, such that only the unique contribution of each to explaining the overall oscillatory data is displayed. (<bold>A</bold>) Spectrotemporal correlates of the three fundamental variables for perceptual inference. Note that the grey area in the upper left plot reflects the spectrotemporal region of interest (ROI) analysis used for correlates of surprise (i.e. &gt;30 Hz). Outside of the ROI analysis, no significant correlates were observed below 30 Hz. (<bold>B</bold>) The variable ‘pitch change’ indicates the overall response to a changing stimulus and is included to illustrate the magnitude and time-frequency distribution of a typical and robust auditory response. δ = delta (0–4 Hz), θ = theta (4–8 Hz), α = alpha (8–12 Hz), β = beta (12–30 Hz), γ = gamma (30–100 Hz).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.009">http://dx.doi.org/10.7554/eLife.11476.009</ext-link></p></caption><graphic mime-subtype="jpeg" mimetype="image" xlink:href="elife-11476-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.010</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Individual subject induced correlates.</title><p>Notation and conventions are as for <xref ref-type="fig" rid="fig4">Figure 4</xref>, except that each column denotes a single subject. All data are displayed, as significance testing was not performed at the individual subject level.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.010">http://dx.doi.org/10.7554/eLife.11476.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig4-figsupp1-v2"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.011</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Total variance explained by the model.</title><p>This figure shows the total variance explained by the four regressor of interest (applicable to the stimulus segment 0-300 ms), including both their overlaps and their unique explanatory contributions. The plot shows the mean across electrodes and subjects.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.011">http://dx.doi.org/10.7554/eLife.11476.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig4-figsupp2-v2"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.012</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Results without mutual partialisation.</title><p>This figure is equivalent in all respects to <xref ref-type="fig" rid="fig4">Figure 4</xref>, except that the four regressors have not been partialised with respect to each other, hence results are not only limited to the unique explanatory power of each, but also include all overlaps between regressors. (<bold>A</bold>) The three perceptual inference regressors have been partialised only with respect to the contemporaneous pitch change value. (<bold>B</bold>) The pitch change regressor has been subjected to no partialisation at all.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.012">http://dx.doi.org/10.7554/eLife.11476.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig4-figsupp3-v2"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.013</object-id><label>Figure 4—figure supplement 4.</label><caption><title>Results with prediction precision omitted.</title><p>This figure is equivalent in all respects to <xref ref-type="fig" rid="fig4">Figure 4</xref>, except that the analysis it displays does not include prediction precision. Hence, this quantity has not been partialised out of the other regressors. Also, a region-of-interest analysis is no longer applied to correlates of surprise. Note stronger but qualitatively similar gamma correlates of surprise, and beta correlates of precision, but the major difference that surprise is now correlated negatively with low-frequency induced oscillations coincident with the subsequent stimulus segment.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.013">http://dx.doi.org/10.7554/eLife.11476.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig4-figsupp4-v2"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.014</object-id><label>Figure 4—figure supplement 5.</label><caption><title>Electrode positions.</title><p>Electrodes used for analysis. White-filled circles each indicate one electrode. All electrodes shown were included in the presented analyses and were selected based on showing significant responses to the experimental stimulus, as described in the Methods section. Top row: lateral surface of the cerebral hemisphere recorded from. Solid black circles mark the insertion point for the Heschl’s gyrus depth electrode. Bottom row: depth electrode contacts used for analysis (white-filled circles), shown in the context of the surface of the superior temporal plane. Depth electrode contacts were positioned along the axis of Heschl’s gyrus. S = superior, I = inferior, A = anterior, P = posterior, M = medial, L = lateral.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.014">http://dx.doi.org/10.7554/eLife.11476.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig4-figsupp5-v2"/></fig><fig id="fig4s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.11476.015</object-id><label>Figure 4—figure supplement 6.</label><caption><title>Distribution of correlations across electrodes.</title><p>Distribution of regressor correlations. Each coloured plot represents one subject. Within each plot, the columns represent individual electrodes (positions displayed in A), with the vertical line separating Heschl’s gyrus (HG) from superior temporal gyrus (STG) electrodes. HG electrodes are arranged medial (left) to lateral (right). Rows indicate the four main partial regressors. Colour values indicate the relative similarity between the correlation pattern for that subject/electrode combination and the mean correlation pattern across electrodes and subjects (range -1 to 1). Δf = absolute change in f value (octaves) compared to previous, S = surprise, Δμ = absolute change in prediction mean (octaves), Π = precision of prediction.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.11476.015">http://dx.doi.org/10.7554/eLife.11476.015</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-11476-fig4-figsupp6-v2"/></fig></fig-group></p><p>In light of the above results, this study provides the first direct demonstration that beta oscillations are involved in updating the content of sensory predictions. We have also found that the precision of predictions is correlated to the magnitude of alpha oscillations, and possibly delta and/or theta also, thereby raising the possibility of an oscillatory mechanism for the control of precision. Interestingly, this correlate of precision was not time-locked to the stimuli (evoked), despite delta-theta oscillations showing strong phase entrainment by stimuli when predicting stimulus timing (<xref ref-type="bibr" rid="bib2">Arnal and Giraud, 2012</xref>), and the period of the stimulus segments (300 ms) falling within the delta-theta range. Possibilities include that there is an evoked correlate closely shared by both surprise and precision which the present methods are unable to disambiguate, or that this time-locking of low-frequency oscillations is entrained preferentially by low-level stimulus features (such as changes in stimulus power spectrum) as opposed to the higher level feature of temporal pitch employed in the present study. Existing generative accounts of perception have not proposed a specific oscillatory correlate for the precision of predictions in predicting <italic>what</italic> a sensory stimulus will be. However, the present findings are not without precedent, as theta (4–8 Hz) and alpha (8–12 Hz) oscillations are implicated in mechanisms to predict <italic>when</italic> a stimulus will occur, with theta phase aligning to the expected stimulus onset (<xref ref-type="bibr" rid="bib2">Arnal and Giraud, 2012</xref>), and alpha magnitude has been found to correlate with the probability of a stimulus change occurring (<xref ref-type="bibr" rid="bib5">Bauer et al., 2014</xref>). Both theta (<xref ref-type="bibr" rid="bib8">Canolty et al., 2006</xref>) and alpha (<xref ref-type="bibr" rid="bib20">Jensen and Mazaheri, 2010</xref>) oscillations modulate higher frequency oscillations, through phase-amplitude coupling, and thereby segregating sensory responses into specific temporal windows. There is also antagonism between theta/alpha and beta/gamma oscillation magnitudes (<xref ref-type="bibr" rid="bib26">Spaak et al., 2012</xref>) which, in the context of a theta/alpha code for precision, might indicate that over coarse time scales neuronal populations alternate between states of precise predictions (with theta/alpha predominating) and states of prediction violation (with beta/gamma predominating). However, the present results would suggest more than simple reciprocal antagonism and reveal the specific computational role of each oscillation type. While an oscillatory code for precision could have far-reaching implications, we must respect the fact that this is a novel finding and thus requires corroboration from additional studies with alternative methodology.</p><p>Perhaps most strikingly, we have shown that the key variables theoretically necessary for sensory inference have distinct oscillatory profiles, with little to no overlap between these, which show remarkable consistency across subjects. Furthermore, each oscillatory frequency band correlates with a distinct computational variable. Thus, the present findings may be able to retrospectively aid in the interpretation of a large number of studies examining induced oscillations. As generative accounts of perception are generic across stimulus dimensions and sensory modalities, and perhaps even all of brain function (for instance, if action is understood as a method of resolving prediction errors [<xref ref-type="bibr" rid="bib13">Friston et al., 2006</xref>]), the applicability of the results may be very broad indeed. The present paradigm is instantly portable to any sensory modality and, given the absence of any training or task requirement, to any species.</p></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><sec id="s3-1"><title>Stimulus algorithm</title><p>The basis of the experiment was an algorithm (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) in which stimulus segments varied across only one perceptual dimension, and values were drawn randomly from <italic>populations</italic>, that is, Gaussian distributions, each characterised by its mean (μ) and standard deviation (σ). These populations constituted hidden states that were not directly observable, but whose parameters (i.e. μ and σ) could be inferred. The populations were randomly changed according to simple rules, such that subjects could be expected to unconsciously learn these rules in order to minimise uncertainty about upcoming stimuli. The rules were that for each stimulus segment, there was a 7/8 chance that its value would be drawn from the existing population, and a 1/8 chance that a new population would come into effect. Once a new population came into effect, it became the ‘existing’ population. Each population had its μ and σ drawn randomly from uniform distributions. The 1/8 transition probability, and the other parameters described below, were chosen in order to maximise the dissociation between the perceptual inference variables under study.</p></sec><sec id="s3-2"><title>Auditory implementation of algorithm</title><p>The algorithm was implemented in the auditory domain, with stimuli taking the form of harmonic complexes, containing only unresolved harmonics (by high-pass filtering from 1.8 kHz). Each harmonic had a random phase offset, which was preserved across all segments, stimuli and subjects. The variable dimension was fundamental frequency (f0; hereafter just ‘f’ for simplicity), which is the major determinant of perceived pitch. Population μ was limited to the range 120–140 Hz, and σ to the range 1/128–1/16 octaves. Stimulus segments were 300 ms in duration and were smoothly concatenated to avoid any transients at the transitions between segments. This was achieved by defining instantaneous frequency at every point in the stimulus, by calculating the cumulative sum of this, and then by creating harmonics individually in the time domain as follows in Equation 1:</p><p><disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>sin</mml:mtext><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>h</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <italic>a</italic> is the amplitude of the waveform, <italic>T</italic> is the current time point (measured in samples), <italic>t</italic> is all previous time points, <italic>r</italic> is the random phase offset for the harmonic, <italic>h</italic> is the number of the harmonic, <italic>s</italic> is the sampling rate and <italic>f</italic> is the instantaneous frequency. This procedure was repeated for every harmonic, from below the high-pass to above the Nyquist frequency. To prevent aliasing, the stimulus was generated at 88.2 kHz sampling rate, then downsampled to 44.1 kHz. The segment duration of 300 ms was chosen as the minimum duration that would capture most of the transient response to the onset of pitch within a stimulus, based on previous work (<xref ref-type="bibr" rid="bib17">Griffiths et al., 2010</xref>). 8000 stimulus segments were presented to each subject, consisting of four blocks of 2000 segments. Blocks were generated by the same rules but were each independently randomly generated. See <xref ref-type="fig" rid="fig2">Figure 2B</xref> for an example section of the stimuli.</p></sec><sec id="s3-3"><title>Subjects and stimulus delivery</title><p>Subjects were three patients undergoing invasive electrode monitoring for localisation of medically refractory epilepsy prior to resective surgery. Subjects were not known to have any major cognitive deficits or clinically significant hearing impairment, and none had lesions in the region of auditory cortex. Informed consent for experimentation was obtained from all subjects, and research procedures were approved by the University of Iowa Institutional Review Board. Stimuli were presented diotically, via insert earphones (ER4B; Etymotic Research, Elk Grove Village, IL) through molds fitted to the subject’s ear, at the loudest comfortable volume. During the experiments, subjects engaged in an irrelevant auditory task to maintain attention, but a specific performance on this task was not required. This task involved detecting a change to the timbre of individual stimulus segments (64 targets over 8000 segments), which was unrelated to their frequencies or underlying population parameters. Subject 1 performed well on the task, and subjects 2 and 3 performed poorly, with high false alarm rates. The first 100 stimulus segments, and 10 segments following each target and false alarm, were removed from analysis.</p></sec><sec id="s3-4"><title>Data acquisition and preprocessing</title><p>Recordings were made from one hemisphere in each subject (Subjects 1 and 3: right, Subject 2: left). All subjects had an 8-contact depth electrode placed along the axis of Heschl’s gyrus, including anatomically and physiologically defined primary auditory cortex, and a subdural grid overlying superior temporal gyrus. Local field potential data were downsampled to 1 kHz, and electrical noise was filtered out. Time-frequency decomposition was performed with Morlet wavelet convolution, oversampled at 2 Hz frequency resolution and 10 ms time resolution, in the time range -300 to 600 ms from segment onset (i.e. spanning previous, current and subsequent segments) and frequency range 2–100 Hz. The upper frequency bound was limited to 100 Hz in light of previous observations of a lack of qualitative response difference to pitch stimuli between the 80–100 Hz range and higher frequencies (<xref ref-type="bibr" rid="bib17">Griffiths et al., 2010</xref>). The number of cycles per wavelet increased linearly from 1 cycle at 2 Hz to 10 cycles at 100 Hz. The absolute value (i.e. amplitude) of the wavelet coefficients was calculated for artefact rejection purposes, and these were normalised for each frequency (i.e. shifted/scaled to mean 0 and standard deviation 1). For each trial, both the mean (across time and frequency) and maximum normalised amplitude value was recorded, and the frequency histograms of these were plotted. Thresholds for trial rejection were set, by visual inspection, at the upper limit of the normal distribution of responses, beyond which trials were assumed to contain artefacts. After removal of segments at the start of the experiment, following target segments, and with outlying amplitude values, 89, 86 and 87% of segments remained, for the three subjects, respectively. Data were processed for all electrodes either in Heschl’s gyrus or over the superior temporal gyrus. The procedure for selecting electrodes for the final analysis is described later.</p></sec><sec id="s3-5"><title>Estimation of perceptual inference variables</title><p>Ideal prior predictions, for each stimulus segment were calculated by inverting the algorithm used to generate the frequency values for the stimulus. Human subjects tend to implicitly make near-optimal inferences based on available sensory evidence and past experience (<xref ref-type="bibr" rid="bib9">Ernst and Banks, 2002</xref>; <xref ref-type="bibr" rid="bib23">Körding and Wolpert, 2004</xref>), but in the present study, all that was assumed was an approximate concordance between the subjects’ actual inferences and the optimal inferences that we modelled. This seems highly probable given the simplicity of the algorithm and its conformation to Gaussian statistics. Prediction calculation was achieved as follows, using a model inversion scheme illustrated in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>:</p><list list-type="order"><list-item><p>A discrete three-dimensional model space was generated (represented as a three-dimensional matrix; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>, left), with dimensions corresponding to population µ, population σ, and f value. Any given value in the matrix indicates P(f|μ,σ), that is, the probability of a given frequency given a particular μ and σ. The columns (all f values for a given μ and σ combination; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, upper-right) thus constitute the forward model (by which stimuli are generated), and the planes (all combinations of μ and σ for a given f value; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, lower-middle) constitute the inverse model (by which hidden parameters can be estimated from observed f values).</p></list-item><list-item><p>2) For each segment, the model was inverted for its particular f value, yielding a two-dimensional probability distribution for the hidden parameters (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, lower-middle). Steps 3-6 were then worked through for each stimulus segment in order, starting at the beginning of the stimulus.</p></list-item><list-item><p>These probability distributions, for each segment subsequent to the most recent estimated population change (as defined later), were multiplied together, and scaled to a sum of 1. The resulting probability distribution (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, lower-right) thus reflects parameter probabilities taking into account all relevant f values</p></list-item><list-item><p>This combined parameter probability distribution was then scalar multiplied with the full model space, in order to weight each of the forward model columns (each corresponding to a particular parameter combination) by the probability of that parameter combination being in effect. The resulting weighted model space was then averaged across parameter dimensions, to yield a one-dimensional (forward) probability distribution, constituting an optimal prediction about the f value of the next stimulus segment, provided a population change did not occur before then. A probability distribution applicable if a population change were to occur was calculated the same way, but without weighting the forward model columns (so as to encompass every possible parameter combination).</p></list-item><list-item><p>It was assumed that a population change occurred immediately prior to the first stimulus segment. To infer subsequent population changes, for each segment the probability of observing the present f value was compared for the two probability distributions (the distribution assuming a population change, and the distribution assuming no change), that is, P(f|c) and P(f|~c), respectively, with c denoting a population change. The probabilities were compared, in conjunction with the known prior probability of a population change (1/8), using Bayes’ rule, as stated in Equation 2:</p><p><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>|</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mtext>|</mml:mtext><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Here, P(c|f) is the chance that a population change occurred at that particular time. Given that P(c) is known to be 1/8, and P(f), the total probability of the observed f value, can be rewritten P(f|c)P(c)+P(f|~c)(1-P(c)), the above equation can be rewritten as Equation 3:</p><p><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mtext>|</mml:mtext><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>7</mml:mn><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>|</mml:mo><mml:mo>~</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>|</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p></list-item><list-item><p>For each segment, the above calculation of P(c|f) was made not only with respect to the immediately preceding segment, but also a number of segments preceding that, up to a maximum of 4. Therefore, for segment t, it was possible to conclude that a population change had occurred immediately prior to t, t-1, t-2, t-3, or none of the above. A population change was judged to have occurred at the time point with the highest value of P(c|f), provided this value was greater than 0.5. Using more than 4 lags did not appreciably alter the estimates obtained by model inversion. Importantly, any retrospective inference of population changes did not retrospectively alter any prior predictions generated by the model (e.g. at time t, if a population change were inferred to have occurred at time t-3 then the priors for t-2, t-1 and t were not affected, but only the priors for t+1 onwards).</p></list-item><list-item><p>Once the above steps were worked through for each stimulus segment in order, the optimal prior predictions were used to calculate the perceptual inference variables of interest. Predictions themselves were summarised by their mean (μ) and precision (1/variance). Changes to predictions (Δµ) were calculated as the absolute change (in octaves) in μ from one prediction to the next. Surprise (S) was calculated as the negative log probability of the observed f value given the prior prediction, and prediction error (irrespective of prediction precision) was calculated as the absolute difference (in octaves) between the observed f value and the mean of the prior prediction. Mathematically, surprise is directly proportional to prediction precision multiplied by prediction error. Finally, Δf was calculated as the absolute difference between the current and preceding value of f.</p></list-item></list><p>An example section of the stimulus, along with Bayes optimal prior predictions generated by the above algorithm, are shown in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>. As the regressors (the variables calculated above) were highly correlated with each other, both instantaneously and over neighbouring segments (see <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>), these were partialised with respect to each of the other regressors, and the preceding and subsequent two values of both the other regressors and themselves. This conservative approach removed a lot of explanatory power from these regressors, but was necessary to be able to uniquely attribute observed neural correlates to a specific process. Importantly, the partialisation did not qualitatively alter the results, except in obscuring the distinction between correlates of S and Δµ. Non-partialised results are shown in <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>.</p></sec><sec id="s3-6"><title>Correlation analysis</title><p>Electrodes were included for further analysis (i.e. included in the averaging process) if they showed a significant response to the stimulus as a whole, based on the single largest response value in time-frequency space. Analysis was based on a 300 ms time window, which was randomly displaced by up to +/- 300 ms for each segment in each permutation (and undisplaced for the actual data) before averaging across segments. The electrodes selected using this procedure are displayed in <xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>. In all subjects, electrodes were included from both primary and non-primary auditory cortex.</p><p>For each partialised regressor, complex time-frequency data were subject to a two-stage regression approach. First, the complex (i.e. with phase data retained) for every electrode-time-frequency point were regressed against it to yield a pair (real and imaginary) of Pearson product moment correlation coefficients (r). The modulus of these constituted the evoked (time-locked) response. To calculate the induced response, the residuals from this regression (i.e. discarding the evoked component) were converted to amplitude (by taking their modulus), and the regression was performed again. All r values were subjected to a Fisher Z transformation prior to further analysis. Inspection of these responses found no qualitative differences between the responses observed in different divisions of auditory cortex, hence the correlations were averaged over electrodes for further analysis. To quantify the distribution of correlation strengths, the pattern, across time and frequency, of induced correlation coefficients for each regressor was averaged across electrodes and subjects. This pattern was used as a filter, in that it was scalar multiplied with the correlation coefficient pattern for each electrode for each subject, then averaged across time and frequency to yield a single correlation value for that electrode/subject combination. These values, for each regressor, for each subject, were divided by the largest absolute correlation value for that regressor, in order to represent relative correlation strengths on a scale of -1 to 1. These correlation values are displayed in <xref ref-type="fig" rid="fig4s6">Figure 4—figure supplement 6</xref>, and show no systematic dissociation between the anatomical distributions of the correlations for the different regressors.</p><p>Statistical analyses were all performed using a permutation approach (<xref ref-type="bibr" rid="bib24">Maris and Oostenveld, 2007</xref>), using 100 permutations (in each of which the experimental parameter of interest was removed through randomization, e.g. by shuffling regressor values across stimulus segments) and a significance threshold of p&lt;0.05 corrected. In each permutation, the statistical measure of interest is calculated, and the largest value within each permutation is added to a null distribution, from which a statistical threshold for significance is set. The measure of interest in this approach varied according to the analysis being performed (see below), and included the values at individual time-frequency points averaged across electrodes, mean values across time and frequency at individual electrodes, and mean values across both time-frequency points and electrodes.</p><p>To compare surprise and prediction error, for each of these regressors, the mean of the correlation coefficients (across time, frequency, electrode and subject) was calculated within the time window 90–500 ms from segment onset and the frequency window 30- 100 Hz. This was performed once with the regressors partialised as previously described (i.e. for current and adjacent values of Δf, Π and Δµ), and again with additional partialisation of each regressor with respect to the other. This latter analysis measures the unique contribution of each regressor in explaining the observed data over and above the other, and was the analysis subjected to statistical analysis.</p><p>For the main correlation analysis, significance testing was performed on average correlation values across the three subjects. Points in time-frequency space exceeding the permutation-derived threshold were considered significant. Due to the strong prior hypothesis about gamma oscillations correlating with surprise or prediction error, the statistical analysis was repeated for these regressors but with only frequencies in the gamma range (30–100 Hz) being included in the analysis.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>Experiments were conceived and designed by WS, and run by PEG. Electrode implantation was performed by MAH, HK and colleagues. Electrode placements were determined and illustrated by CK and HO. Data analysis was performed by WS. The manuscript was written by WS, with input from all other authors. We thank Professor Karl Friston, University College London, and his research group for helpful comments on the work.</p></ack><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>WS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>PEG, Conception and design, Acquisition of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>SK, Conception and design, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>CKK, Conception and design, Acquisition of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>HO, Conception and design, Acquisition of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con6"><p>HK, Conception and design, Acquisition of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con7"><p>MAH, Conception and design, Acquisition of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con8"><p>TDG, Conception and design, Drafting or revising the article</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: The study was approved by the University of Iowa Institutional Review Board, and with full informed written consent from all participants.</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnal</surname><given-names>LH</given-names></name><name><surname>Wyart</surname><given-names>V</given-names></name><name><surname>Giraud</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Transitions in neural oscillations reflect prediction errors generated in audiovisual speech</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>797</fpage><lpage>801</lpage><pub-id pub-id-type="doi">10.1038/nn.2810</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arnal</surname><given-names>LH</given-names></name><name><surname>Giraud</surname><given-names>A-L</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Cortical oscillations and sensory predictions</article-title><source>Trends in Cognitive Sciences</source><volume>16</volume><fpage>390</fpage><lpage>398</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2012.05.003</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastos</surname><given-names>AM</given-names></name><name><surname>Usrey</surname><given-names>WM</given-names></name><name><surname>Adams</surname><given-names>RA</given-names></name><name><surname>Mangun</surname><given-names>GR</given-names></name><name><surname>Fries</surname><given-names>P</given-names></name><name><surname>Friston</surname><given-names>KJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Canonical microcircuits for predictive coding</article-title><source>Neuron</source><volume>76</volume><fpage>695</fpage><lpage>711</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.10.038</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastos</surname><given-names>AM</given-names></name><name><surname>Vezoli</surname><given-names>J</given-names></name><name><surname>Bosman</surname><given-names>CA</given-names></name><name><surname>Schoffelen</surname><given-names>J-M</given-names></name><name><surname>Oostenveld</surname><given-names>R</given-names></name><name><surname>Dowdall</surname><given-names>JR</given-names></name><name><surname>De Weerd</surname><given-names>P</given-names></name><name><surname>Kennedy</surname><given-names>H</given-names></name><name><surname>Fries</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Visual areas exert feedforward and feedback influences through distinct frequency channels</article-title><source>Neuron</source><volume>85</volume><fpage>390</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.12.018</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bauer</surname><given-names>M</given-names></name><name><surname>Stenner</surname><given-names>M-P</given-names></name><name><surname>Friston</surname><given-names>KJ</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Attentional modulation of alpha/beta and gamma oscillations reflect functionally distinct processes</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>16117</fpage><lpage>16125</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3474-13.2014</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brodski</surname><given-names>A</given-names></name><name><surname>Paasch</surname><given-names>G-F</given-names></name><name><surname>Helbling</surname><given-names>S</given-names></name><name><surname>Wibral</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The faces of predictive coding</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>8997</fpage><lpage>9006</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1529-14.2015</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buschman</surname><given-names>TJ</given-names></name><name><surname>Miller</surname><given-names>EK</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Top-down versus bottom-up control of attention in the prefrontal and posterior parietal cortices</article-title><source>Science</source><volume>315</volume><fpage>1860</fpage><lpage>1862</lpage><pub-id pub-id-type="doi">10.1126/science.1138071</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canolty</surname><given-names>RT</given-names></name><name><surname>Edwards</surname><given-names>E</given-names></name><name><surname>Dalal</surname><given-names>SS</given-names></name><name><surname>Soltani</surname><given-names>M</given-names></name><name><surname>Nagarajan</surname><given-names>SS</given-names></name><name><surname>Kirsch</surname><given-names>HE</given-names></name><name><surname>Berger</surname><given-names>MS</given-names></name><name><surname>Barbaro</surname><given-names>NM</given-names></name><name><surname>Knight</surname><given-names>RT</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>High gamma power is phase-locked to theta oscillations in human neocortex</article-title><source>Science</source><volume>313</volume><fpage>1626</fpage><lpage>1628</lpage><pub-id pub-id-type="doi">10.1126/science.1128115</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ernst</surname><given-names>MO</given-names></name><name><surname>Banks</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Humans integrate visual and haptic information in a statistically optimal fashion</article-title><source>Nature</source><volume>415</volume><fpage>429</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1038/415429a</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feldman</surname><given-names>H</given-names></name><name><surname>Friston</surname><given-names>KJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Attention, uncertainty, and free-energy</article-title><source>Frontiers in Human Neuroscience</source><volume>4</volume><pub-id pub-id-type="doi">10.3389/fnhum.2010.00215</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fontolan</surname><given-names>L</given-names></name><name><surname>Morillon</surname><given-names>B</given-names></name><name><surname>Liegeois-Chauvel</surname><given-names>C</given-names></name><name><surname>Giraud</surname><given-names>A-L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The contribution of frequency-specific activity to hierarchical information processing in the human auditory cortex</article-title><source>Nature Communications</source><volume>5</volume><fpage>4694</fpage><pub-id pub-id-type="doi">10.1038/ncomms5694</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A theory of cortical responses</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>360</volume><fpage>815</fpage><lpage>836</lpage><pub-id pub-id-type="doi">10.1098/rstb.2005.1622</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>K</given-names></name><name><surname>Kilner</surname><given-names>J</given-names></name><name><surname>Harrison</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A free energy principle for the brain</article-title><source>Journal of Physiology-Paris</source><volume>100</volume><fpage>70</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1016/j.jphysparis.2006.10.001</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hierarchical models in the brain</article-title><source>PLoS Computational Biology</source><volume>4</volume><elocation-id>e1000211</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000211</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friston</surname><given-names>K</given-names></name><name><surname>Kiebel</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Predictive coding under the free-energy principle</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>364</volume><fpage>1211</fpage><lpage>1221</lpage><pub-id pub-id-type="doi">10.1098/rstb.2008.0300</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fujioka</surname><given-names>T</given-names></name><name><surname>Trainor</surname><given-names>LJ</given-names></name><name><surname>Large</surname><given-names>EW</given-names></name><name><surname>Ross</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Beta and gamma rhythms in human auditory cortex during musical beat processing</article-title><source>Annals of the New York Academy of Sciences</source><volume>1169</volume><fpage>89</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.2009.04779.x</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffiths</surname><given-names>TD</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Sedley</surname><given-names>W</given-names></name><name><surname>Nourski</surname><given-names>KV</given-names></name><name><surname>Kawasaki</surname><given-names>H</given-names></name><name><surname>Oya</surname><given-names>H</given-names></name><name><surname>Patterson</surname><given-names>RD</given-names></name><name><surname>Brugge</surname><given-names>JF</given-names></name><name><surname>Howard</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Direct recordings of pitch responses from human auditory cortex</article-title><source>Current Biology</source><volume>20</volume><fpage>1128</fpage><lpage>1132</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2010.04.044</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haenschel</surname><given-names>C</given-names></name><name><surname>Baldeweg</surname><given-names>T</given-names></name><name><surname>Croft</surname><given-names>RJ</given-names></name><name><surname>Whittington</surname><given-names>M</given-names></name><name><surname>Gruzelier</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Gamma and beta frequency oscillations in response to novel auditory stimuli: A comparison of human electroencephalogram (EEG) data with in vitro models</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>97</volume><fpage>7645</fpage><lpage>7650</lpage><pub-id pub-id-type="doi">10.1073/pnas.120162397</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haeusler</surname><given-names>S</given-names></name><name><surname>Maass</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A statistical analysis of information-processing properties of lamina-specific cortical microcircuit models</article-title><source>Cerebral Cortex</source><volume>17</volume><fpage>149</fpage><lpage>162</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhj132</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jensen</surname><given-names>O</given-names></name><name><surname>Mazaheri</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Shaping functional architecture by oscillatory alpha activity: gating by inhibition</article-title><source>Frontiers in Human Neuroscience</source><volume>4</volume><pub-id pub-id-type="doi">10.3389/fnhum.2010.00186</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanai</surname><given-names>R</given-names></name><name><surname>Komura</surname><given-names>Y</given-names></name><name><surname>Shipp</surname><given-names>S</given-names></name><name><surname>Friston</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cerebral hierarchies: predictive processing, precision and the pulvinar</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>370</volume><fpage>20140169</fpage><pub-id pub-id-type="doi">10.1098/rstb.2014.0169</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kopell</surname><given-names>N</given-names></name><name><surname>Whittington</surname><given-names>MA</given-names></name><name><surname>Kramer</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Neuronal assembly dynamics in the beta1 frequency range permits short-term memory</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>108</volume><fpage>3779</fpage><lpage>3784</lpage><pub-id pub-id-type="doi">10.1073/pnas.1019676108</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Körding</surname><given-names>KP</given-names></name><name><surname>Wolpert</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Bayesian integration in sensorimotor learning</article-title><source>Nature</source><volume>427</volume><fpage>244</fpage><lpage>247</lpage><pub-id pub-id-type="doi">10.1038/nature02169</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maris</surname><given-names>E</given-names></name><name><surname>Oostenveld</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Nonparametric statistical testing of EEG- and MEG-data</article-title><source>Journal of Neuroscience Methods</source><volume>164</volume><fpage>177</fpage><lpage>190</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2007.03.024</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>RPN</given-names></name><name><surname>Ballard</surname><given-names>DH</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Predictive coding in the visual cortex: a functional interpretation of some extra-classical receptive-field effects</article-title><source>Nature Neuroscience</source><volume>2</volume><fpage>79</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1038/4580</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spaak</surname><given-names>E</given-names></name><name><surname>Bonnefond</surname><given-names>M</given-names></name><name><surname>Maier</surname><given-names>A</given-names></name><name><surname>Leopold</surname><given-names>DA</given-names></name><name><surname>Jensen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Layer-specific entrainment of γ-band neural activity by the α rhythm in monkey visual cortex</article-title><source>Current Biology</source><volume>22</volume><fpage>2313</fpage><lpage>2318</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.10.020</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Todorovic</surname><given-names>A</given-names></name><name><surname>van Ede</surname><given-names>F</given-names></name><name><surname>Maris</surname><given-names>E</given-names></name><name><surname>de Lange</surname><given-names>FP</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Prior Expectation Mediates Neural Adaptation to Repeated Sounds in the Auditory Cortex: An MEG Study</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>9118</fpage><lpage>9123</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1425-11.2011</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Kerkoerle</surname><given-names>T</given-names></name><name><surname>Self</surname><given-names>MW</given-names></name><name><surname>Dagnino</surname><given-names>B</given-names></name><name><surname>Gariel-Mathis</surname><given-names>M-A</given-names></name><name><surname>Poort</surname><given-names>J</given-names></name><name><surname>van der Togt</surname><given-names>C</given-names></name><name><surname>Roelfsema</surname><given-names>PR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Alpha and gamma oscillations characterize feedback and feedforward processing in monkey visual cortex</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><volume>111</volume><fpage>14332</fpage><lpage>14341</lpage><pub-id pub-id-type="doi">10.1073/pnas.1402773111</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.11476.016</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>King</surname><given-names>Andrew J</given-names></name><role>Reviewing editor</role><aff id="aff5"><institution>University of Oxford</institution>, <country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;Neural Signatures of Perceptual Inference&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by Andrew King as the Reviewing Editor and Eve Marder as the Senior Editor.</p><p>The following individuals involved in review of your submission have agreed to reveal their identity: Jonas Obleser, Luc Arnal and Peter Kok (peer reviewers).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>There is general agreement among the reviewers that this is a carefully performed and potentially influential study of the neural correlates of predictive coding. In particular, the use of human ECoG recordings from human auditory cortex to investigate the local field potential oscillatory signatures of change to prediction, precision of predictions and surprise represents a novel and important extension of previous work in this field.</p><p>Essential revisions:</p><p>Although they are generally enthusiastic about this paper, the reviewers have raised a number of issues that will need to be addressed, most of which relate to statistical/methodological issues, the organization of the manuscript, and to acknowledgement of prior work.</p><p>1) The reviewers have pointed out that your claim (Results/Discussion, fourth paragraph) that this study provides the first direct evidence that beta oscillations are involved in updating the content of sensory predictions is incorrect. Previous work on the role of beta oscillations has not been cited: Buschman &amp; Miller (2007) Science 315:1860-1862; Bastos et al., 2014, first published on BioRvix, and subsequently in Neuron (2015) 85:390-401. Similarly, in the second paragraph of the Introduction, it is stated that &quot;A neural correlate of precision.… has not been proposed.&quot; Some proposals about the neural implementation of precision have in fact been made in previous studies; see e.g. Feldman &amp; Friston (2010) Front Hum Neurosci 4:215, and Kanai et al. (2015) Philos trans R Soc Lond B 370(1668).</p><p>2) The reviewers (and editors) found it difficult for the reader to navigate through the many (main and supplementary) figures. We suggest that the authors carefully consider some reorganising of the figures and the way the data are presented, as this will likely considerably improve the manuscript. Please take full advantage of <italic>eLife</italic> formatting of figures and figure supplements.</p><p>3) Clarification is needed about when single subject data are being described and when data from the three participants has been combined. While it is crucial to show that your observations are reliable across participants, it is probably not necessary to show single subject response profiles on main figures. You should consider showing the most relevant effects at the group level on main figures while providing single subject effects in supplements to the figures. This would also allow grouping the main findings of each figure into a single one, thereby providing a more synthetic view of the results.</p><p>4) You show that the regressors are highly correlated with each other (e.g. prediction error and surprise). While this validates the authors' partialisation approach, the reviewers are concerned that you only show the (tiny) portion of the data that is not shared between regressors. In addition to showing what is specific to each regressor, it would be useful for the reader to know what is shared between those regressors, i.e. in which parts of brain responses reflect common processes.</p><p>5) Where average r values are further processed, please confirm that this was only done after prior Fisher z transformation.</p><p>6) From point 7 of the explanation of the prediction calculation (subsection “Estimation of perceptual inference variables”), it seems that first population change positions were estimated, before estimating optimal predictions and the other perceptual inference variables. In point 6, it is explained that in order to estimate population change positions, segments up to three trials back were considered, and inferred population changes could be assigned, retroactively, to up to three trials back. Does this mean that the other perceptual inference variables could also be changed retroactively? In other words, when at trial n it was inferred that a population change occurred at trial n-3, were the prediction, precision, surprise and prediction error for trial n-3 affected by this? It seems implausible for a neural surprise response on trial n-3 to be affected by a prediction made during trial n.</p><p>7) The reviewers agree that a strong case has been made to link beta and gamma oscillations in auditory cortex to the updating of and the error in predictions, respectively, but are less convinced about the claims made in respect to alpha (or rather alpha-delta) oscillations. The precision effect reported in the alpha band seems rather weak and is hardly visible in <xref ref-type="fig" rid="fig4">Figure 4A</xref>. Again, one way to show this more convincingly would be to show the time-frequency map of these effects averaged at the group level and not only the significance. Although appropriately corrected statistics for multiple comparisons are used, it would be more convincing to provide additional information and analyses to backup this finding and support the claim that alpha oscillations encode precision. Otherwise, you should be more circumspect in your conclusions about this link.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.11476.017</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions: Although they are generally enthusiastic about this paper, the reviewers have raised a number of issues that will need to be addressed, most of which relate to statistical/methodological issues, the organization of the manuscript, and to acknowledgement of prior work. 1) The reviewers have pointed out that your claim (Results/Discussion, fourth paragraph) that this study provides the first direct evidence that beta oscillations are involved in updating the content of sensory predictions is incorrect. Previous work on the role of beta oscillations has not been cited: Buschman &amp; Miller (2007) Science 315:1860-1862; Bastos et al., 2014, first published on BioRvix, and subsequently in Neuron (2015) 85:390-401.</italic> </p><p>We realise that, in attempt to maintain brevity of the manuscript, we have not cited all relevant work on the subject. However, I think any disagreement here is over the definition of the term ‘direct evidence’. We are aware of compelling evidence that there is a spectral asymmetry inherent in hierarchical neuronal communication, with beta being a major feedback frequency (as demonstrated in the two studies mentioned above, and others), and that in predictive coding feedback connections are argued to convey predictions, or updates to predictions. However, we have not been aware of any evidence specifically and quantitatively linking beta oscillations to prediction updates as we have demonstrated in the present work. We therefore would argue that what has been made previously is a strong case on circumstantial evidence, for which our study is the first to provide direct confirmation. Specifically, our understanding of the above two studies is that Buschman and Miller found low-frequency feedback connections from prefrontal cortex to parietal cortex to be relatively selective for top-down attentional control, and that Bastos found asymmetrical spectral Granger causality, with feedback being associated with beta band connections. The text has been updated as follows:</p><p>The second introductory paragraph now reads:</p><p>“The layer-specific separation of higher and lower frequency oscillations (Spaak et al., 2012), and the forward/backward asymmetry of high/low frequency oscillations (Buschman and Miller, 2007; Fontolan et al., 2014; van Kerkoerle et al., 2014, Bastos et al., 2015), are supported by direct evidence. […] While there is a strong case that beta oscillations are involved in top-down neural communication, evidence specifically linking beta oscillations to predictions is presently limited and indirect (Arnal and Giraud, 2012), but includes observations that there is interdependence of gamma and subsequent beta activity in both in-vivo (Haenschel et al., 2000) and in-silico (Kopell et al., 2011) studies, and that omissions of expected stimuli induce a beta rebound response (Fujioka et al., 2009).”</p><p><italic>Similarly, in the second paragraph of the Introduction, it is stated that &quot;A neural correlate of precision.… has not been proposed.&quot; Some proposals about the neural implementation of precision have in fact been made in previous studies; see e.g. Feldman &amp; Friston (2010) Front Hum Neurosci 4:215, and Kanai et al. (2015) Philos trans R Soc Lond B 370(1668).</italic> </p><p>We acknowledge our mistake here. What we intended to say was that an oscillatory code for precision of predictions has not been proposed. We are aware that cholinergic tone is a likely neurochemical/neuromodulatory correlate of precision, and that gamma synchrony likely reflects precision-weighted prediction errors (as are discussed in Feldman and Friston 2010). Kanai et al. 2015 also describes a neuromodulatory, not oscillatory, mechanism of precision control. The text has been updated with these citations, and now reads:</p><p>“An oscillatory correlate of precision, to our knowledge, has not been proposed, though precision might affect the magnitude of gamma responses to prediction violations (Feldman and Friston, 2010). While an oscillatory correlate is possible, a case has been made that neuromodulatory connections alone, for instance from the basal forebrain cholinergic system, may be sufficient to dynamically mediate precision in sensory hierarchies (Feldman and Friston, 2010; Kanai et al., 2015).”</p><p> <italic>2) The reviewers (and editors) found it difficult for the reader to navigate through the many (main and supplementary) figures. We suggest that the authors carefully consider some reorganising of the figures and the way the data are presented, as this will likely considerably improve the manuscript. Please take full advantage of eLife formatting of figures and figure supplements.</italic> </p><p>The figures have now been simplified and reorganised, in keeping with <italic>eLife</italic>’s particular conventions. Most importantly, composite supplemental figures have been broken down into multiple sub-figures for clarity.</p><p><italic>3) Clarification is needed about when single subject data are being described and when data from the three participants has been combined. While it is crucial to show that your observations are reliable across participants, it is probably not necessary to show single subject response profiles on main figures. You should consider showing the most relevant effects at the group level on main figures while providing single subject effects in supplements to the figures. This would also allow grouping the main findings of each figure into a single one, thereby providing a more synthetic view of the results.</italic> </p><p>This is a good suggestion, which we have followed. The main <xref ref-type="fig" rid="fig4">Figure 4</xref> now shows group-level induced and evoked results, and both single subject data and alternative analyses are shown in supplemental. We have been through the text to ensure that it is clear what type of data are being referred to.</p><p> <italic>4) You show that the regressors are highly correlated with each other (e.g. prediction error and surprise). While this validates the authors' partialisation approach, the reviewers are concerned that you only show the (tiny) portion of the data that is not shared between regressors. In addition to showing what is specific to each regressor, it would be useful for the reader to know what is shared between those regressors, i.e. in which parts of brain responses reflect common processes.</italic> </p><p>While we had previously shown a supplemental figure with non-partialised regressors (which shows the data explained by the commonalities between the regressors as well as the unique contributions), we have expanded on this in the relevant figure, and also included a figure mapping the percentage of variance, across time-frequency space, explained by the whole model. We believe that with these figures included, the reader is able to appreciate the unique regressor correlates in the context of all correlates of the model. The relevant parts of the text have been modified as follows:</p><p>“Furthermore, the LFP data variance explained by the entire model (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>) was around 1%.”</p><p>“We therefore repeated the analyses with only the contemporaneous value of DELTAf being partialled out (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). This analysis found highly significant correlates of <italic>precision</italic> (Π) in the full delta-alpha range, spanning the previous, current and subsequent segments, but we cannot attribute the delta-theta component to Π with absolute confidence.”</p><p><italic>5) Where average r values are further processed, please confirm that this was only done after prior Fisher z transformation.</italic> </p><p>We had not done this previously. Analyses have now been re-run with a Fisher Z transformation being applied at each time-frequency-channel-subject combination prior to any averaging. We note that, as the r values in question are very small, the effect of the Fisher Z transformation is negligible.</p><p><italic>6) From point 7 of the explanation of the prediction calculation (subsection “Estimation of perceptual inference variables”), it seems that first population change positions were estimated, before estimating optimal predictions and the other perceptual inference variables. In point 6, it is explained that in order to estimate population change positions, segments up to three trials back were considered, and inferred population changes could be assigned, retroactively, to up to three trials back. Does this mean that the other perceptual inference variables could also be changed retroactively? In other words, when at trial n it was inferred that a population change occurred at trial n-3, were the prediction, precision, surprise and prediction error for trial n-3 affected by this? It seems implausible for a neural surprise response on trial n-3 to be affected by a prediction made during trial n.</italic> </p><p>This seems to be an issue with our explanation rather than the method, and I realise my mistake in how I described things. To clarify: the algorithm was only allowed to work in ways plausible for an ideal biological observer. The starting assumption was that a population change definitely occurred at trial zero. Then, at each segment subsequently, the algorithm inverted all segments since the last inferred population change (initially trial zero) and decided whether (and if so, where) a population change was likely to have occurred since then. Once this was decided, priors for the upcoming stimulus were generated, and these were ‘set in stone’ (i.e. could never be modified after this). Then, the algorithm would move onto the next trial. Put another way, any retrospective analysis in the algorithm was limited to the inference of population changes, and did not apply to the generation of priors. The text has now been modified as follows:</p><p>“Therefore, for segment t, it was possible to conclude that a population change had occurred immediately prior to t, t-1, t-2, t-3, or none of the above. […] Once the above steps were worked through for each stimulus segment in order, the optimal prior predictions were used to calculate the perceptual inference variables of interest.”</p><p> <italic>7) The reviewers agree that a strong case has been made to link beta and gamma oscillations in auditory cortex to the updating of and the error in predictions, respectively, but are less convinced about the claims made in respect to alpha (or rather alpha-delta) oscillations. The precision effect reported in the alpha band seems rather weak and is hardly visible in <xref ref-type="fig" rid="fig4">Figure 4A</xref>. Again, one way to show this more convincingly would be to show the time-frequency map of these effects averaged at the group level and not only the significance. Although appropriately corrected statistics for multiple comparisons are used, it would be more convincing to provide additional information and analyses to backup this finding and support the claim that alpha oscillations encode precision. Otherwise, you should be more circumspect in your conclusions about this link.</italic></p><p>We think this is a fair point. We have followed the suggestions above, in displaying the averaged group data. We also note that the appropriate correction for multiple comparisons does mean that the finding is almost certainly genuine, however small the time-frequency area concerned is (particularly as such extensive partialisation has been performed as a necessary preprocessing step). We also, however, respect the fact that this is an entirely new concept that does not build upon a robust background literature (as the other main findings do), and therefore agree we should be more circumspect in our interpretation. We do note, though, that it is not merely of interest that precision appears to have its own oscillatory correlate, but also that the inclusion of precision in the analysis at all (in terms of it being partialled out from the other regressors) produces results that are more in keeping with prior theory; with precision included, surprise correlates solely with gamma oscillations, whereas with precision omitted surprise shows a strong late negative low-frequency correlation which is harder to reconcile with existing theory. Overall, we feel genuinely unsure whether the precision findings will prove hugely important across neuroscience, or an alternative explanation will be found in due course. With this in mind, we have revised the text as follows.</p><p>The Abstract now reads:</p><p>“… and discovered, using direct recordings from human auditory cortex, that <italic>surprise</italic> due to prediction violations is encoded by local field potential oscillations in the gamma band (&gt;30 Hz), changes to <italic>predictions</italic> in the beta band (12-30 Hz), and that the <italic>precision</italic> of predictions appears to quantitatively relate to alpha band oscillations (8-12 Hz).”</p><p>The Results section now reads:</p><p>“Prediction <italic>precision</italic> (Π) correlated positively with delta-alpha (2-12 Hz) frequency oscillations (for the whole 0-300 ms period from segment onset), though this was only significant in the alpha frequency range, and fell slightly below significance in the delta-theta range. […] However, given its sole significant association in the main analysis (<xref ref-type="fig" rid="fig4">Figure 4</xref>) is with Π, and that a low-frequency correlate of S is not expected based on prior literature, we favour the interpretation that low-frequency oscillations are a correlate of the precision of prior predictions.”</p><p>“We have also found that the precision of predictions is correlated to the magnitude of alpha oscillations, and possibly delta and/or theta also, thereby raising the possibility of an oscillatory mechanism for the control of precision.”</p><p>The relevant paragraph concludes with:</p><p>“While an oscillatory code for precision could have far-reaching implications, we must respect the fact that this is a novel finding and thus requires corroboration from additional studies with alternative methodology.”</p></body></sub-article></article>