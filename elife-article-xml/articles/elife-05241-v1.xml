<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">05241</article-id><article-id pub-id-type="doi">10.7554/eLife.05241</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Mapping nonlinear receptive field structure in primate retina at single cone resolution</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-20260"><name><surname>Freeman</surname><given-names>Jeremy</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-21110"><name><surname>Field</surname><given-names>Greg D</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5942-2679</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="corresp" rid="cor2">*</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="par-4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-41928"><name><surname>Li</surname><given-names>Peter H</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6193-4454</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="pa1">§</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-21112"><name><surname>Greschner</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-21113"><name><surname>Gunning</surname><given-names>Deborah E</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-21114"><name><surname>Mathieson</surname><given-names>Keith</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-21115"><name><surname>Sher</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-21116"><name><surname>Litke</surname><given-names>Alan M</given-names></name><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-17187"><name><surname>Paninski</surname><given-names>Liam</given-names></name><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con11"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-15874"><name><surname>Simoncelli</surname><given-names>Eero P</given-names></name><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-21117"><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5613-0248</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff10">10</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Janelia Research Center</institution>, <institution>Howard Hughes Medical Institute</institution>, <addr-line><named-content content-type="city">Ashburn</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution>Center for Neural Science</institution>, <institution>New York University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Neurobiology</institution>, <institution>Duke University School of Medicine</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution>Salk Institute for Biological Studies</institution>, <addr-line><named-content content-type="city">La Jolla</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Department of Neuroscience</institution>, <institution>University of Oldenburg</institution>, <addr-line><named-content content-type="city">Oldenburg</named-content></addr-line>, <country>Germany</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Institute of Photonics</institution>, <institution>University of Strathclyde</institution>, <addr-line><named-content content-type="city">Glasgow</named-content></addr-line>, <country>United Kingdom</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Institute for Particle Physics</institution>, <institution>University of California, Santa Cruz</institution>, <addr-line><named-content content-type="city">Santa Cruz</named-content></addr-line>, <country>United States</country></aff><aff id="aff8"><label>8</label><institution content-type="dept">Department of Statistics</institution>, <institution>Columbia University</institution>, <addr-line><named-content content-type="city">Columbia</named-content></addr-line>, <country>United States</country></aff><aff id="aff9"><label>9</label><institution content-type="dept">Center for Neural Science</institution>, <institution>Courant Institute of Mathematical Sciences</institution>, <institution>Howard Hughes Medical Institute, New York University</institution>, <addr-line><named-content content-type="city">New York</named-content></addr-line>, <country>United States</country></aff><aff id="aff10"><label>10</label><institution content-type="dept">Department of Neurosurgery</institution>, <institution>Stanford School of Medicine</institution>, <addr-line><named-content content-type="city">Stanford</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-13133"><name><surname>Carandini</surname><given-names>Matteo</given-names></name><role>Reviewing editor</role><aff><institution>University College London</institution>, <country>United Kingdom</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><label>*</label>For correspondence: <email>freemanj11@janelia.hhmi.org</email> (JF);</corresp><corresp id="cor2"><email>field@neuro.duke.edu</email> (GDF)</corresp><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn><fn fn-type="present-address" id="pa1"><label>§</label><p>Google Research, San Francisco, United States</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>30</day><month>10</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e05241</elocation-id><history><date date-type="received"><day>18</day><month>10</month><year>2014</year></date><date date-type="accepted"><day>07</day><month>09</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Freeman et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Freeman et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-05241-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.05241.001</object-id><p>The function of a neural circuit is shaped by the computations performed by its interneurons, which in many cases are not easily accessible to experimental investigation. Here, we elucidate the transformation of visual signals flowing from the input to the output of the primate retina, using a combination of large-scale multi-electrode recordings from an identified ganglion cell type, visual stimulation targeted at individual cone photoreceptors, and a hierarchical computational model. The results reveal nonlinear subunits in the circuity of OFF midget ganglion cells, which subserve high-resolution vision. The model explains light responses to a variety of stimuli more accurately than a linear model, including stimuli targeted to cones within and across subunits. The recovered model components are consistent with known anatomical organization of midget bipolar interneurons. These results reveal the spatial structure of linear and nonlinear encoding, at the resolution of single cells and at the scale of complete circuits.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.001">http://dx.doi.org/10.7554/eLife.05241.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.05241.002</object-id><title>eLife digest</title><p>Light that enters the eye begins the process of vision by activating two types of photoreceptors: rods, which support vision under low light levels, and cones, which are responsible for fine detail and color vision. Activation of either type of photoreceptor triggers responses in bipolar cells, which activate the ganglion cells that transmit visual signals to the brain.</p><p>Bipolar cells therefore belong to a class of cells called interneurons, which relay information from certain cell types to others. Interneurons play an important role in information processing throughout the brain, but directly accessing them or characterizing their role in neural computation is often difficult.</p><p>To address this problem, Freeman, Field et al. have developed a combined computational and experimental approach to describe the flow of sensory signals through the circuits within the retina of primates. Large arrays of electrodes were used to record the responses of many retinal ganglion cells in response to the activation or de-activation of pairs of cones. These experiments revealed that the responses of ganglion cells are not simply the sum of the inputs that they receive from cones; specifically, the activation of one cone is not cancelled by the deactivation of another. Instead, the data suggest that bipolar cells add cone inputs together and then pass on the total activation (but not deactivation) to ganglion cells.</p><p>By analyzing the responses of ganglion cells to numerous random patterns of cone activation, Freeman, Field et al. were able to estimate the locations and arrangements of bipolar cells that connect to them. These predicted patterns of connectivity agreed with observations from anatomical studies. This work provides detailed insights into how the primate retina works. It also suggests that similar approaches may be used to characterize how signals flow across other brain networks in which large-scale recordings are now possible.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.002">http://dx.doi.org/10.7554/eLife.05241.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author keywords</title><kwd>macaque</kwd><kwd>encoding models</kwd><kwd>nonlinearity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute (HHMI)</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Simoncelli</surname><given-names>Eero P</given-names></name><name><surname>Freeman</surname><given-names>Jeremy</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000053</institution-id><institution>National Eye Institute (NEI)</institution></institution-wrap></funding-source><award-id>EY018003</award-id><principal-award-recipient><name><surname>Paninski</surname><given-names>Liam</given-names></name><name><surname>Simoncelli</surname><given-names>Eero P</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000053</institution-id><institution>National Eye Institute (NEI)</institution></institution-wrap></funding-source><award-id>EY017992</award-id><principal-award-recipient><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001391</institution-id><institution>Whitehall Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Field</surname><given-names>Greg D</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.3</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Multi-electrode recordings and modeling are combined to reveal the transformations of signals from cones to bipolar cells and then to ganglion cells within the primate retina.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The responses of many sensory neurons reflect multiple stages of computational transformation, arising from the functional and anatomical organization of underlying neural circuitry. Although much of our knowledge of these circuits comes from direct measurements of responses during sensory stimulation, experimental and analytical techniques for inferring the properties of intermediate stages remain limited. In particular, in many neural circuits, the critical computations performed by interneurons are difficult to measure directly.</p><p>In the retina, cones, bipolar cells, and retinal ganglion cells (RGCs) form a two-tier cascade of linear and nonlinear processing that is thought to underlie many important visual functions (see <xref ref-type="bibr" rid="bib63">Schwartz and Rieke, 2011</xref>; <xref ref-type="bibr" rid="bib32">Gollisch, 2012</xref>). A notable example is the <italic>nonlinear subunit</italic> computation (<xref ref-type="bibr" rid="bib34">Hochstein and Shapley, 1976</xref>) observed in the responses of several types of RGCs, the output neurons of the retina. In these cell types, the circuitry composing the RGC receptive field does not linearly integrate cone photoreceptor inputs over space, as assumed by simplified descriptive models (<xref ref-type="bibr" rid="bib16">Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib40">Keat et al., 2001</xref>; <xref ref-type="bibr" rid="bib57">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>). Instead, cone signals are first combined by bipolar interneurons, whose outputs are rectified at the synapse onto RGCs (<xref ref-type="bibr" rid="bib21">Demb et al., 1999</xref>, <xref ref-type="bibr" rid="bib22">2001</xref>; <xref ref-type="bibr" rid="bib8">Borghuis et al., 2013</xref>). This nonlinear architecture endows the RGC receptive field with localized subunits that permit the representation of finer spatial detail than would be expected given the overall receptive field size (<xref ref-type="bibr" rid="bib34">Hochstein and Shapley, 1976</xref>; <xref ref-type="bibr" rid="bib42">Lee et al., 1995</xref>; <xref ref-type="bibr" rid="bib22">Demb et al., 2001</xref>; <xref ref-type="bibr" rid="bib3">Baccus et al., 2008</xref>; <xref ref-type="bibr" rid="bib18">Crook et al., 2008</xref>; <xref ref-type="bibr" rid="bib65">Schwartz et al., 2012</xref>). Subunits have also been implicated in the processing of features like object motion and looming (<xref ref-type="bibr" rid="bib51">Olveczky et al., 2007</xref>; <xref ref-type="bibr" rid="bib49">Münch et al., 2009</xref>), and some of their functional characteristics have been inferred for various cell types and species (<xref ref-type="bibr" rid="bib26">Enroth-Cugell and Robson, 1966</xref>; <xref ref-type="bibr" rid="bib34">Hochstein and Shapley, 1976</xref>; <xref ref-type="bibr" rid="bib74">Victor and Shapley, 1979a</xref>, <xref ref-type="bibr" rid="bib75">1979b</xref>; <xref ref-type="bibr" rid="bib25">Enroth-Cugell and Freeman, 1987</xref>; <xref ref-type="bibr" rid="bib6">Bölinger and Gollisch, 2012</xref>; <xref ref-type="bibr" rid="bib65">Schwartz et al., 2012</xref>). However, the spatial organization of convergent cone input onto nonlinear subunits has never been visualized, nor mapped across a population of RGCs.</p><p>We combined large-scale parallel recordings of the responses of RGC populations to high resolution visual stimulation in order to characterize RGC subunits at the resolution of photoreceptors. Independent stimulation of individual cones and pairs of cones revealed significant nonlinear interactions within the receptive fields of OFF midget RGCs. A cascade model and an associated fitting method were developed to capture these nonlinear response properties. The model revealed the spatial structure of nonlinear interactions in the individual cone inputs to each OFF midget RGC, and enabled adaptive generation of validation stimuli targeted to specific cones during experiments. When fitted to entire populations of OFF midget RGCs, the model revealed a spatial organization of nonlinear subunits consistent with the known anatomical convergence of cones to midget bipolar cells.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>RGCs in the primate retina (<italic>Macaca mulatta</italic> and <italic>Macaca fascicularis</italic>) were recorded and identified using a large-scale multi-electrode recording system and visual stimulation (<xref ref-type="bibr" rid="bib19">Dabrowski et al., 2004</xref>; <xref ref-type="bibr" rid="bib29">Frechette et al., 2005</xref>; <xref ref-type="bibr" rid="bib28">Field et al., 2007</xref>). Inputs from individual cones to RGCs were mapped using high-resolution stimuli (<xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>). Experiments and analyses focused on the responses of OFF midget cells over a range of eccentricities. These cells exhibited the largest signal-to-noise ratios and response stability over recordings.</p><sec id="s2-1"><title>Primate OFF midget RGCs exhibit nonlinear spatial integration</title><p>Targeted stimulation of cone pairs within the receptive field of RGCs revealed nonlinear interactions. Specifically, increments and decrements of light were presented in regions that illuminated individual cones or pairs of cones (<xref ref-type="fig" rid="fig1">Figure 1</xref>, see ‘Materials and methods’). If a RGC linearly combines cone inputs, its response should be eliminated, or strongly reduced, when inputs of opposite polarity are presented to two separate cones that are similarly weighted within the receptive field. To test this prediction, we selectively stimulated pairs of cones that were close in space, but sufficiently distinct to ensure independent stimulation (see ‘Materials and methods’).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.003</object-id><label>Figure 1.</label><caption><title>Failure of linear integration in OFF midget retinal ganglion cells (RGCs).</title><p>(<bold>A</bold>) Above, spatial spike-triggered average derived from white-noise analysis with high-resolution pixel stimulation. Black lines indicate regions of pixels independently stimulating individual cones (identified online). White line, scale bar (8.4 microns). Below, rasters of responses to repeated brief presentations of uniform luminance within each cone region. Each row is a trial, each point is a spike. Black line, average firing rate across trials. Gray line, stimulus presentation (250 ms). Stimulation in cone regions was either paired increments and decrements of light, or decrements alone, as shown in insets. (<bold>B</bold>) Another RGC showing failure of cancellation. (<bold>C</bold>) A RGC exhibiting cancellation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.003">http://dx.doi.org/10.7554/eLife.05241.003</ext-link></p></caption><graphic xlink:href="elife-05241-fig1-v1.tif"/></fig></p><p>Many cells exhibited non-linear responses to opposite polarity stimulation of cone pairs (<xref ref-type="fig" rid="fig1">Figure 1A,B</xref>). Specifically, many OFF midget cells responded robustly to decrements of light presented to either of a pair of cones individually, but also responded robustly when a decrement of light was presented to one cone and an increment of the same contrast was presented simultaneously to the other cone (for 73/78 cone pairs tested from 13 RGCs, response to paired stimulations was at least 50% of the response to single cone decrements alone). Only a small number (5/78) of cone pairs yielded response cancellation (see example in <xref ref-type="fig" rid="fig1">Figure 1C</xref>). These failures of cancellation indicate significant spatial nonlinearities within OFF midget cell receptive fields.</p><p>These examples are consistent with the following interpretation suggested by preceding work in other species and cell types: OFF midget bipolar cells (which carry cone signals to OFF midget RGCs) (<xref ref-type="bibr" rid="bib41">Kolb and Marshak, 2003</xref>) linearly combine convergent cone input, but introduce a rectifying nonlinearity at the synapse with RGCs (<xref ref-type="bibr" rid="bib22">Demb et al., 2001</xref>; <xref ref-type="bibr" rid="bib6">Bölinger and Gollisch, 2012</xref>; <xref ref-type="bibr" rid="bib65">Schwartz et al., 2012</xref>). In this interpretation, the cancellation of opposing signals from a pair of cones indicates that the cones converge on a single midget bipolar cell, while failure of cancellation indicates that the cones provide input to distinct midget bipolar cells. The analyses and experiments described below use a model-based approach that provides further evidence for this interpretation.</p></sec><sec id="s2-2"><title>Inferring cone signal interactions with a hierarchical subunit model</title><p>The paired stimulation approach described above is not suitable for characterizing large populations of cones and RGCs, because it relies on testing a small number of cone pairs, in a small number of RGCs per retina. Testing all cone pairs in all RGCs is infeasible. It is possible, however, to identify the two key properties of interest—the presence of an intermediate nonlinearity, and the specific pairs (or groups) of cone signals that combine linearly in a common subunit—by fitting a single hierarchical model to the responses of RGCs under random stimulation with spatiotemporal noise. Across many random stimulus presentations, different spatial patterns will engage different degrees of linear and nonlinear spatial integration within the receptive field. Thus, finding the model that best predicts the RGC response can, in principle, reveal the structure of the nonlinearities.</p><p>We developed a hierarchical model with two stages of linear integration and an intervening static nonlinearity (<xref ref-type="fig" rid="fig2">Figure 2</xref>) mirroring the known elements of the underlying circuitry (<xref ref-type="fig" rid="fig2">Figure 2</xref>). First, subsets of one or more cones are assigned to ‘subunits’, which are assumed to be non-overlapping to ensure unique solutions during fitting, that is, a cone cannot provide input to multiple subunits (see ‘Materials and methods’); this assumption is biologically sensible given evidence for minimal overlap in bipolar dendritic trees (<xref ref-type="bibr" rid="bib79">Wässle et al., 1994</xref>) and little divergence from cones to OFF midget bipolar cells (<xref ref-type="bibr" rid="bib41">Kolb and Marshak, 2003</xref>). Signals from cones within a subunit are weighted and linearly combined. Second, a common nonlinear transformation is applied to the outputs of these subunits (<xref ref-type="bibr" rid="bib2">Ahrens et al., 2008</xref>). Finally, the model computes a weighted sum of subunit responses, meant to reflect the convergence of bipolar cells onto the ganglion cell, and this summed response is subjected to an output nonlinearity that produces a non-negative spike rate. This model builds on previous functional models of nonlinear spatial integration in RGCs (<xref ref-type="bibr" rid="bib74">Victor and Shapley, 1979a</xref>, <xref ref-type="bibr" rid="bib75">1979b</xref>; <xref ref-type="bibr" rid="bib25">Enroth-Cugell and Freeman, 1987</xref>) by describing the subunit computation directly with components that resemble elements of the circuit, and by making predictions about their organization at the resolution of individual cones. It also bears resemblance to two-stage subunit models of V1 complex cells (<xref ref-type="bibr" rid="bib1">Adelson and Bergen, 1985</xref>; <xref ref-type="bibr" rid="bib61">Rust et al., 2005</xref>; <xref ref-type="bibr" rid="bib14">Chen et al., 2007</xref>), and recently developed methods of fitting such models to data (<xref ref-type="bibr" rid="bib2">Ahrens et al., 2008</xref>; <xref ref-type="bibr" rid="bib76">Vintch et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Lochmann et al., 2013</xref>; <xref ref-type="bibr" rid="bib47">McFarland et al., 2013</xref>).<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.004</object-id><label>Figure 2.</label><caption><title>OFF midget RGC anatomy and modeling framework.</title><p>(<bold>A</bold>) Bipolar cells receive convergent input from cones, and ganglion cells receive convergent input from bipolar cells. (<bold>B</bold>) A linear–nonlinear (LN) model describes the RGC response with one stage of linear integration of cone inputs, followed by a nonlinearity. White disks indicate cones, black line indicates integration weights. (<bold>C</bold>) The subunit model describes the RGC response with two stages of linear integration and nonlinearity; subunits perform initial integration following by a nonlinearity (common to all subunits). Red, subunits receiving input from two cones; black, subunits receiving input from one cone. Cones are indexed by <italic>c</italic>, subunits by <italic>s</italic>. <italic>x</italic><sub><italic>c</italic></sub> is the input to each cone. <italic>a</italic><sub><italic>sc</italic></sub> is the weight from cone <italic>c</italic> to subunit <italic>s</italic>. <italic>b</italic><sub><italic>s</italic></sub> is the weight on each subunit. <italic>f</italic> and <italic>g</italic> are the subunit and spiking nonlinearities, respectively. See ‘Materials and methods’ for details on parameterization and fitting.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.004">http://dx.doi.org/10.7554/eLife.05241.004</ext-link></p></caption><graphic xlink:href="elife-05241-fig2-v1.tif"/></fig></p><p>The model was fitted to hundreds of simultaneously recorded OFF midget RGCs by measuring responses to high-resolution spatio-temporal noise (<xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>) (15 retinas total, see ‘Materials and methods’). First, cone locations were identified using a previously described fitting procedure (<xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>) (see ‘Materials and methods’), and the noise stimulus was then spatiotemporally filtered for each cell to describe the stimulus in terms of cone inputs rather than pixel intensities. Second, model parameters (the two nonlinearities, and the summation weights over the cones and over the subunits) were adjusted to maximize the likelihood of the spiking responses of each cell, assuming spikes arose from an inhomogeneous Poisson process (<xref ref-type="bibr" rid="bib68">Simoncelli et al., 2004</xref>; <xref ref-type="bibr" rid="bib57">Pillow et al., 2008</xref>). Specifically, coordinate ascent was used to infer the weights and nonlinearities at both stages of the model, and the assignment of cones to subunits was determined by an iterative greedy merging method, initializing to a single-cone subunit model (one cone per subunit), and then iteratively merging the pair of subunits that yielded the largest improvement in response likelihood (see ‘Materials and methods’).</p></sec><sec id="s2-3"><title>Fitted models recover nonlinearities and subunit organization</title><p>The fitted functional model for each cell is depicted graphically (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). For most cells, the estimated subunit nonlinearity approximated half-wave rectification, consistent with the failures of cancellation observed in paired stimulation. Subunits were generally small. Many OFF midget RGCs had only single-cone subunits (48 ± 10%, percentage ±s.e.m. across retinas). The remaining cells generally had subunits with two (27 ± 6% OFF midgets) or three (13 ± 4% OFF midgets) cones. The performance of the model was assessed by computing the percent of firing rate variance explained (<italic>R</italic><sup><italic>2</italic></sup>) on a portion of the data not used in the fitting process (see ‘Materials and methods’). Although the model was fitted by maximizing likelihood under a Poisson spiking model, <italic>R</italic><sup><italic>2</italic></sup> provides a more easily interpretable measure of performance. Model improvement was assessed relative to a standard linear–nonlinear (LN) cascade model (<xref ref-type="bibr" rid="bib16">Chichilnisky, 2001</xref>), containing only one stage of linear integration followed by a nonlinearity, which was fitted and evaluated using identical methods. Results from each retina were summarized with the average nonlinearities (see <xref ref-type="fig" rid="fig3">Figure 3B</xref> for example subunit nonlinearities), as well as the improvement in predictive accuracy of the subunit model over the LN model (percent increase in cross-validated <italic>R</italic><sup><italic>2</italic></sup>, quantified as the slope of the best-fitting regression line relating the performance of the two models, <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Note that the subunit model can mimic an LN model when all subunits contain single cones and the subunit nonlinearity is linear, and in this case, it cannot underperform the LN model unless the data are insufficient to constrain it (i.e., ‘overfitting’). We found an improvement of 18 ± 3% (mean ± s.e.m.) across 15 retinas (<xref ref-type="fig" rid="fig3">Figure 3D</xref>).<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.005</object-id><label>Figure 3.</label><caption><title>Model fits.</title><p>(<bold>A</bold>) Recovered model fit for an example OFF midget RGC. Top left, spatial spike-triggered average. Identified cone locations indicated by black circles. White line, scale bar (8.4 microns). Top right, diagram of model fit. Light gray regions indicate subunits, including those containing single cones. Within a subunit, color saturation indicates the weight on each cone. Red indicates that the subunit has two cones, orange, three. Line intensities indicate weights used in summing over subunits. Bottom left, recovered subunit and output nonlinearity. Bottom right, explanatory power (<italic>R</italic><sup><italic>2</italic></sup>, see ‘Materials and methods’) of LN and subunit (‘Sub’) models. <italic>R</italic><sup><italic>2</italic></sup> was computed either for all presented stimuli, or for maximally differentiated stimuli, defined as those stimuli for which the predictions of the two models differed the most (see ‘Materials and methods’); in both cases models were evaluated on data not used for model fitting. (<bold>B</bold>) Summary of subunit and output nonlinearities for a population of 104 OFF midgets from one retina. Each line corresponds to a single RGC. Nonlinearities only shown for RGCs with <italic>R</italic><sup>2</sup> exceeding 0.2. (<bold>C</bold>) Summary of model performance for 76 OFF midget RGCs from an example retina. Above, <italic>R</italic><sup><italic>2</italic></sup> for subunit and LN models on all stimuli; below, <italic>R</italic><sup><italic>2</italic></sup> for subunit and LN models on maximally differentiating stimuli (see panel <bold>A</bold>, and ‘Materials and methods’). Each corresponds to a single RGC. (<bold>D</bold>) Histogram of model improvement (subunit/LN) across multiple retinas, quantified for each retina as the slope of the best-fitting regression line to the points shown in panel <bold>C</bold> (forced through the origin). The data point for OFF midgets from one outlying retina (improvement = 5) is not shown.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.005">http://dx.doi.org/10.7554/eLife.05241.005</ext-link></p></caption><graphic xlink:href="elife-05241-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.05241.006</object-id><label>Figure 3—figure supplement 1.</label><caption><title>In three separate simulations, spiking responses were simulated using a known set of parameters (derived from the model fit to a real OFF midget RGC), and simulation duration was either 4, 8, or 16 min (typical experiments were 30 min).</title><p>The model was then fit to these simulated responses. The process was repeated five times for each simulation and duration, yielding five sets of recovered parameters: subunit assignments, weights (on cones and subunits), and nonlinearities. In cases where the fitted subunit assignments did not match the true assignment, the true assignment was used to infer weights and nonlinearities beacuse otherwise comparing to the true values is not well defined. Fitted subunits depicted as in <xref ref-type="fig" rid="fig3 fig6 fig7">Figures 3, 6, 7</xref>. The recovered parameters in all cases were found to be similar to the parameters used in simulating the data. In particular, with 8 or 16 min of data, accurate subunit assignments are nearly always recovered.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.006">http://dx.doi.org/10.7554/eLife.05241.006</ext-link></p></caption><graphic xlink:href="elife-05241-fig3-figsupp1-v1.tif"/></fig></fig-group></p><p>The improvement in predictive power of the subunit model over the LN model was modest, in part because the predictions were performed over a large ensemble of random noise stimuli that only infrequently and weakly activate cones and subunits in a manner that differentiates the model predictions. To obtain a more incisive comparison, for each fitted cell, the model (fitted to training data) was used to identify stimuli (from data not used in fitting) for which the predictions of the two models differed the most. Because independent data were used for training and testing, and because the selection of ‘potent’ stimuli was based only on the magnitude of the difference in predicted response, the improvement is not statistically biased in favor of one model or the other. Model accuracies on these ‘maximally differentiating’ test stimuli revealed a larger improvement of 92 ± 26% (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Variation in improvement across retinas (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) may have arisen from differences in physiological state across tissue preparations (see ‘Discussion’).</p><p>In order to assess model accuracy, responses were averaged over repeated presentations of a short spatio-temporal noise sequence (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). These were used to assess the accuracy of predictions of both the subunit and LN models, expressed as a fraction of the stimulus-induced variation of the response over time (<italic>R</italic><sup><italic>2</italic></sup> adjusted, see ‘Materials and methods’). Accuracy for the subunit model was 51 ± 1% <italic>R</italic><sup><italic>2</italic></sup> adj. (mean ± s.e.m. across 68 OFF midget RGCs from one retina), and improvement over the LN model was 40% (<xref ref-type="fig" rid="fig4">Figure 4B</xref>).<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.007</object-id><label>Figure 4.</label><caption><title>Subunit model predicted responses to repeated white noise.</title><p>(<bold>A</bold>) Average firing rate of a single OFF midget RGC to an 8 s white noise stimulus repeated 100 times. Purple, prediction of subunit model; green, prediction of LN model. Both models were fit to independent data using non-repeated white noise stimuli. Bin width, 83 ms. (<bold>B</bold>) Adjusted <italic>R</italic><sup><italic>2</italic></sup> (see ‘Materials and methods’) for the two models; each point shows performance for one OFF midget RGC.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.007">http://dx.doi.org/10.7554/eLife.05241.007</ext-link></p></caption><graphic xlink:href="elife-05241-fig4-v1.tif"/></fig></p></sec><sec id="s2-4"><title>Subunit model more accurately predicts responses to grating stimuli</title><p>A traditional test of nonlinear integration involves measuring responses to contrast reversing sinusoidal gratings (<xref ref-type="bibr" rid="bib26">Enroth-Cugell and Robson, 1966</xref>; <xref ref-type="bibr" rid="bib74">Victor and Shapley, 1979a</xref>, <xref ref-type="bibr" rid="bib75">1979b</xref>; <xref ref-type="bibr" rid="bib25">Enroth-Cugell and Freeman, 1987</xref>). Responses to gratings were measured in 32 OFF midget RGCs from one retina. RGCs exhibited clear signs of nonlinear integration (see <xref ref-type="fig" rid="fig5">Figure 5A</xref> for an example cell). At low spatial frequencies (period matched approximately to the size of the receptive field), responses were modulated at the temporal frequency of the stimulus. But at higher spatial frequencies, their responses were modulated at twice the temporal frequency of the stimulus, for at least some spatial phases. The rectifying nonlinearities within the fitted subunit model were sufficient to predict this frequency doubling, whereas the LN model exhibited dominant response modulation at the frequency of the stimulus (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Across the population, accuracy of the subunit model was 83 ± 1% <italic>R</italic><sup><italic>2</italic></sup> adj. (mean ± s.e.m. across 32 RGCs), and improvement in predictive performance of the subunit model over the LN model was 28 ± 2% (mean ± bootstrapped confidence interval) (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). Improvement was more pronounced at higher spatial frequencies (<xref ref-type="fig" rid="fig5">Figure 5C</xref>), ranging from 10 ± 1% (at a frequency where one cycle spanned the entire RF) to 50 ± 6% (at a frequency where each cycle spanned 1–2 cones), and was significant at all frequencies (paired t-test, p &lt; 0.0001). A qualitatively similar pattern of results was observed in a second retina (data not shown). Especially for the higher spatial frequencies, the difference between models for gratings was qualitatively more pronounced than for noise stimuli (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), suggesting that stimuli with extended spatial structure help highlight differences between model predictions.<fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.008</object-id><label>Figure 5.</label><caption><title>Responses to gratings.</title><p>(<bold>A</bold>) Sinusoidal gratings temporally modulated in contrast were presented to OFF midget RGCs. Top: grating stimuli superimposed on the cone locations of a single RGC, for a set of example combinations of spatial frequency and phase (with spatial frequency increasing from left to right). Bottom: cycle-averaged firing rate of the RGC (black); predictions of the LN model (green); predictions of the subunit model (purple). Both models were fit to independent data from white-noise stimulation. (<bold>B</bold>) Performance (adjusted <italic>R</italic><sup><italic>2</italic></sup>, see ‘Materials and methods’) for subunit and LN models, across 32 OFF midget RGCs from a single retina. Data point in red corresponds to example shown in panel <bold>A</bold>. (<bold>C</bold>) Adjusted <italic>R</italic><sup><italic>2</italic></sup>, computed separately for the two models for different spatial frequencies, averaged across RGCs. Error bars indicate s.e.m. across RGCs.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.008">http://dx.doi.org/10.7554/eLife.05241.008</ext-link></p></caption><graphic xlink:href="elife-05241-fig5-v1.tif"/></fig></p></sec><sec id="s2-5"><title>Subunit structure validated anatomically and functionally</title><p>Although the subunit model provided large improvements over an LN model, the improvement of the full fitted subunit model over a simpler model with all subunits as single cones was small: roughly 0–10% across all RGCs (see ‘Materials and methods’). The small difference was likely due to the small size and number of multi-cone subunits per RGC—typically no more than a few subunits with two or three cones—and the simplistic spatial structure of the stimuli used. This raises the question of whether the multi-cone subunits inferred from model fits truly reflect the function and anatomy of the underlying neural circuitry.</p><p>Anatomical measurements of synapses between cones and OFF midget bipolar cells (<xref ref-type="bibr" rid="bib79">Wässle et al., 1994</xref>) provide direct estimates for the expected number of cones that synapse on a bipolar cell as a function of retinal eccentricity. The functional connectivity of the fitted model provides, for each recorded retina, a prediction of the number of cones per bipolar cell (<xref ref-type="fig" rid="fig6">Figure 6</xref>). This allowed a comparison between the anatomical connectivity and the functional connectivity predicted by the full subunit model. Note that comparing the number of subunits rather than cone convergence onto subunits is approximately equivalent, because midget bipolar cells tile the retina with a coverage factor of ∼1 and without overlap (<xref ref-type="bibr" rid="bib79">Wässle et al., 1994</xref>). For RGCs at small eccentricities, the fraction of subunits recovered by the model including 1–2 cones was consistent with the fraction expected based on anatomical observations made separately (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). For larger eccentricities, the model recovered larger subunits, also generally in agreement with anatomical observations. Two inconsistencies include some unexpectedly large subunits at high eccentricities (<xref ref-type="fig" rid="fig6">Figure 6C</xref>, [<xref ref-type="bibr" rid="bib79">Wässle et al., 1994</xref>]) and one surprising distribution of subunit sizes at high eccentricity (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). Despite this, the data generally support the interpretation that the fitted model revealed the structure of interneuron circuitry responsible for RGC responses.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.009</object-id><label>Figure 6.</label><caption><title>Recovered subunit structure varies with eccentricity.</title><p>(<bold>A</bold>–<bold>C</bold>) Model fits recovered for local populations of OFF midget RGCs from retinas at three different retinal eccentricities. Model fits for each RGC depicted as in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Colors indicate the number of cones in each subunit; white = 1, red = 2, orange = 3, lime = 4, turquoise = 6. (<bold>D</bold>) Probability of occurrence of subunits with different numbers of cone contacts as a function of eccentricity, for morphological and functional data. Horizontal bars show estimates derived from morphological data from <xref ref-type="bibr" rid="bib79">Wässle et al., 1994</xref>. Circles show estimates from the functional measurements and model fitting for individual retinas.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.009">http://dx.doi.org/10.7554/eLife.05241.009</ext-link></p></caption><graphic xlink:href="elife-05241-fig6-v1.tif"/></fig></p><p>To validate the model fits functionally, we developed a closed-loop experiment to test the specific subunit structure of individual cells recovered by the model. The subunit model was fitted to many OFF midget RGCs simultaneously based on responses to noise stimuli, and these fits were then used to guide the selection of RGCs and cone pairs to be tested for linear cancellation. This is identical to the experiment presented earlier (<xref ref-type="fig" rid="fig1">Figure 1</xref>), with the important difference that cone pairs were chosen based on predictions from the fitted model, during the experiment, instead of at random. Responses to combined increment and decrement stimulation were qualitatively consistent with the predictions of the model: For cones within subunits, RGC responses to inputs of opposite polarity were at least partially cancelled, whereas responses to cones in separate subunits exhibited little cancellation (<xref ref-type="fig" rid="fig7">Figure 7</xref>). Quantitatively, across 252 cone pairs tested (from 21 RGCs), the responses were significantly more accurately predicted by the full subunit model (<italic>r</italic><sup><italic>2</italic></sup> = 0.24) than by either a model with single-cone subunits (<italic>r</italic><sup><italic>2</italic></sup> = 0.11) or an LN model (<italic>r</italic><sup><italic>2</italic></sup> = 0.10) (both p &lt; 0.005, bootstrap test, see ‘Materials and methods’).<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.010</object-id><label>Figure 7.</label><caption><title>Closed-loop validation of subunit organization.</title><p>(<bold>A</bold>) Upper left, spatial spike-triggered average and cone stimulation regions, as in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Lower left, diagram of fitted subunit model, as in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. The three cones (A, B, C) were stimulated with increments (+) or decrements (−) of light. Panels on the right show the responses (as in <xref ref-type="fig" rid="fig1">Figure 1</xref>) of a single OFF midget RGC to different combinations of light increments and decrements. Top row, and left column, show responses to stimulation of single cones. Remaining panels show responses to paired stimulation. Red indicates the pair of cones found by the model to belong to a single subunit, and thus selected for paired stimulation. Gray line, stimulus presentation (250 ms). (<bold>B</bold>) Another example, plotted as in panel <bold>A</bold>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.010">http://dx.doi.org/10.7554/eLife.05241.010</ext-link></p></caption><graphic xlink:href="elife-05241-fig7-v1.tif"/></fig></p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We used a combination of measurement and modeling to reveal nonlinear interneuron computations underlying the responses of RGCs in primate retina. By presenting stimuli at the resolution of individual cones, and fitting a cascade model to the spiking responses of OFF midget RGCs, we identified individual nonlinear subunits that are consistent with the known anatomical convergence from cones to midget bipolar cells. We fitted and validated the model using a comprehensive stimulus ensemble, including noise, gratings, and targeted stimuli that highlighted the nonlinear responses. Together, these results provide a picture of the spatial circuit structure of three major stages of visual processing in the primate retina.</p><sec id="s3-1"><title>Nonlinear spatial summation in OFF midget RGCs</title><p>Previous work has aimed to identify whether different RGC classes exhibit linear or nonlinear spatial summation. In the cat retina, ‘X’ cells were defined as those that sum visual input linearly within the spatial receptive field, whereas ‘Y’ cells were defined as those that exhibited nonlinear behaviors (notably, frequency-doubling) (<xref ref-type="bibr" rid="bib26">Enroth-Cugell and Robson, 1966</xref>; <xref ref-type="bibr" rid="bib34">Hochstein and Shapley, 1976</xref>). These functionally defined classes have been associated with the morphologically distinct beta and alpha RGCs (<xref ref-type="bibr" rid="bib9">Boycott and Wässle, 1974</xref>; <xref ref-type="bibr" rid="bib54">Peichl and Wässle, 1981</xref>; <xref ref-type="bibr" rid="bib78">Wässle et al., 1981a</xref>, <xref ref-type="bibr" rid="bib77">1981b</xref>). Subsequent work aimed to establish a similar dichotomy in the primate retina (<xref ref-type="bibr" rid="bib27">Field and Chichilnisky, 2007</xref>). The magnocellular-projecting parasol RGCs have been shown to exhibit nonlinearities similar to Y cells. In contrast, the parvocellular-projecting midget RGCs have usually been likened to linear X cells (<xref ref-type="bibr" rid="bib66">Shapley et al., 1981</xref>; <xref ref-type="bibr" rid="bib39">Kaplan and Shapley, 1982</xref>; <xref ref-type="bibr" rid="bib23">Derrington and Lennie, 1984</xref>; <xref ref-type="bibr" rid="bib43">Levitt et al., 2001</xref>). The nonlinearities revealed here (<xref ref-type="fig" rid="fig1 fig4 fig6">Figures 1, 4, 6</xref>) are inconsistent with this interpretation, as are previous in vivo studies of parvocellular-projecting cells (<xref ref-type="bibr" rid="bib23">Derrington and Lennie, 1984</xref>) and ex vivo studies of midget RGCs (<xref ref-type="bibr" rid="bib55">Petrusca et al., 2007</xref>; <xref ref-type="bibr" rid="bib12">Cafaro and Rieke, 2013</xref>), which demonstrated modest but clear frequency-doubling in response to contrast reversing visual stimuli. Two factors may explain these discrepancies. First, many previous in vivo studies probed midget cell responses in the central retina, where the receptive field center consists of a single cone, and thus, a single subunit. In such cases, the entire receptive field is formed by the cone collecting aperture, and would be expected to exhibit the linear summation of incident light intensity performed by the cone. Second, in vivo studies were typically performed using anesthetics that could raise the basal release of neurotransmitter from bipolar cells, and low basal release rates are thought to underlie at least part of the rectifying subunit nonlinearity (<xref ref-type="bibr" rid="bib60">Robbins and Ikeda, 1989</xref>; <xref ref-type="bibr" rid="bib22">Demb et al., 2001</xref>). Indeed, variability in basal release rates could account for some of the variability across preparations observed here (<xref ref-type="fig" rid="fig3 fig6">Figures 3D, 6</xref>).</p><p>Although OFF midget RGCs exhibit nonlinear spatial summation not found in X cells, they are also different from Y cells. The most commonly stated defining characteristic for Y cells is a frequency doubled response to a contrast reversing grating, with a magnitude that is independent of the spatial phase of the stimulus (<xref ref-type="bibr" rid="bib26">Enroth-Cugell and Robson, 1966</xref>; <xref ref-type="bibr" rid="bib34">Hochstein and Shapley, 1976</xref>; <xref ref-type="bibr" rid="bib18">Crook et al., 2008</xref>). Although midget cells exhibited frequency doubling in response to contrast reversing gratings (<xref ref-type="fig" rid="fig5">Figure 5</xref>), the magnitude was phase dependent (not shown). Phase dependence may arise both from the low occurrence of multi-cone subunits, and the fact that midget cells receive input from only one bipolar cell type, which forms a single mosaic with minimal dendritic overlap (<xref ref-type="bibr" rid="bib79">Wässle et al., 1994</xref>). In contrast, the ON and OFF parasol RGC populations, which exhibit properties consistent with the Y cell definition (<xref ref-type="bibr" rid="bib55">Petrusca et al., 2007</xref>; <xref ref-type="bibr" rid="bib18">Crook et al., 2008</xref>), receive input primarily from two bipolar cell types (<xref ref-type="bibr" rid="bib7">Bordt et al., 2006</xref>; <xref ref-type="bibr" rid="bib13">Calkins and Sterling, 2007</xref>), each of which receive convergent input from many cones, and overlap each other in space, and thus would be expected to exhibit greater phase invariance. Lack of phase independence in midget cells may also arise from differences between feed-forward and crossover inhibition that shapes midget vs parasol RGC responses respectively (<xref ref-type="bibr" rid="bib12">Cafaro and Rieke, 2013</xref>).</p><p>A final potential caveat in comparing our findings to previous work is the possibility that the ex vivo preparation used here affected the properties of midget cells. The firing rates obtained in the present work are somewhat lower than those found in anesthetized in vivo recordings (<xref ref-type="bibr" rid="bib71">Troy and Lee, 1994</xref>). Nonlinear spatial summation (as in <xref ref-type="fig" rid="fig1">Figure 1A,B</xref>) was observed in midget cells exhibiting a range of spontaneous firing rates from 0 to 10 spikes/s (not shown). It remains uncertain whether and to what degree these ex vivo recordings, or in vivo recordings under anesthesia, reflect a more natural state with respect to the signals studied. The confirmation of the biological relevance of nonlinear signaling by OFF midget cells awaits a decisive test in awake behaving animals.</p></sec><sec id="s3-2"><title>Modeling subunit structure in RGCs</title><p>The model developed here was inspired by previous subunit models (<xref ref-type="bibr" rid="bib75">Victor and Shapley, 1979b</xref>), general successes in maximum likelihood fitting of neural models to spiking responses (<xref ref-type="bibr" rid="bib52">Paninski, 2004</xref>; <xref ref-type="bibr" rid="bib72">Truccolo et al., 2005</xref>; <xref ref-type="bibr" rid="bib2">Ahrens et al., 2008</xref>; <xref ref-type="bibr" rid="bib57">Pillow et al., 2008</xref>), and recent efforts to fit subunit-like models to V1 complex cells (<xref ref-type="bibr" rid="bib61">Rust et al., 2005</xref>; <xref ref-type="bibr" rid="bib76">Vintch et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Lochmann et al., 2013</xref>; <xref ref-type="bibr" rid="bib47">McFarland et al., 2013</xref>). But it differs in several essential aspects. First, the model expresses subunit computations directly in terms of elementary circuit components: photoreceptors, inferred bipolar cells, and ganglion cells. Combined with precise experimental control, this approach bridges the gap between abstract functional models and detailed circuit computations, and may thus complement the growing number of tools available for manipulating neurons and circuits. Second, unlike some previous efforts to characterize subunits (<xref ref-type="bibr" rid="bib75">Victor and Shapley, 1979b</xref>), all components of the model used here were fitted based on a single ensemble of stimuli and spiking responses, rather than inferred separately based on responses to specialized stimuli. Simultaneous fitting is a generally preferable strategy for optimization, because it allows the parameters to work together to explain observed responses. Finally, unlike some approaches (e.g., spike-triggered covariance [<xref ref-type="bibr" rid="bib69">Strong et al., 1998</xref>; <xref ref-type="bibr" rid="bib11">Brenner et al., 2000</xref>; <xref ref-type="bibr" rid="bib61">Rust et al., 2005</xref>; <xref ref-type="bibr" rid="bib70">Touryan et al., 2005</xref>; <xref ref-type="bibr" rid="bib56">Pillow and Simoncelli, 2006</xref>; <xref ref-type="bibr" rid="bib64">Schwartz et al., 2006</xref>; <xref ref-type="bibr" rid="bib14">Chen et al., 2007</xref>] or maximally-informative dimensions [<xref ref-type="bibr" rid="bib67">Sharpee et al., 2004</xref>]), which have recovered stimulus features that are unique only up to an arbitrary linear transformation, this method recovers a unique solution for the spatial structure of subunits.</p><p>Two recent efforts characterized RGC nonlinearities using novel experimental and anatomical methods that complement the approaches described here. One study (<xref ref-type="bibr" rid="bib6">Bölinger and Gollisch, 2012</xref>) used a closed-loop experiment to find combinations of stimuli eliciting constant RGC responses, and used the shapes of the resulting iso-response contours in stimulus space to dissociate linear and nonlinear integration. While elegant, iso-response contour mapping has only proven practically useful with stimuli defined in two or three dimensions (<xref ref-type="bibr" rid="bib6">Bölinger and Gollisch, 2012</xref>; <xref ref-type="bibr" rid="bib36">Horwitz and Hass, 2012</xref>), whereas the current model operated on the full set of cone inputs to each RGC (typically 5–15 dimensions). Another study (<xref ref-type="bibr" rid="bib65">Schwartz et al., 2012</xref>) developed a model for responses of ON alpha-like mouse RGCs by combining detailed morphological measurements with direct physiological measurements from bipolars and RGCs. The functional approach taken here, while lacking the firm anatomical foundation, can extend more readily to describing computations in complete neuronal populations (<xref ref-type="fig" rid="fig6">Figure 6</xref>) and in multiple cell types.</p><p>The model developed here does not account for electrical coupling between photoreceptors (<xref ref-type="bibr" rid="bib73">Tsukamoto et al., 1992</xref>; <xref ref-type="bibr" rid="bib35">Hornstein et al., 2004</xref>; <xref ref-type="bibr" rid="bib50">O'Brien et al., 2012</xref>) which could produce cancellation of increment and decrement stimuli delivered to neighboring cones. A study of cone electrical coupling in primate retina suggested that signal mixing is modest (<xref ref-type="bibr" rid="bib35">Hornstein et al., 2004</xref>), thus it is probably unable to account for the cancellation observed. However, that study was performed in dark-adapted retina, whereas the results reported here were obtained in light-adapted retina; coupling may depend on light adaptation and the circadian cycle (<xref ref-type="bibr" rid="bib5">Bloomfield and Völgyi, 2009</xref>) (but see <xref ref-type="bibr" rid="bib35">Hornstein et al., 2004</xref>). Thus, it is difficult to entirely rule out a contribution of cone coupling. However, since many cone pairs tested exhibited little or no cancellation (e.g., <xref ref-type="fig" rid="fig1">Figure 1</xref>), any effects of adjacent cone coupling are likely to be weak or sporadic. In contrast to this prediction, connexin-36 immunolabeling revealed ubiquitous expression at junctions between nearly all neighboring cones, in both central and peripheral primate retina (<xref ref-type="bibr" rid="bib50">O'Brien et al., 2012</xref>). Also, the observed eccentricity dependence of the spatial extent of cancellation (<xref ref-type="fig" rid="fig6">Figure 6</xref>) implies that for the present results to be explained by cone coupling, the coupling would have to increase substantially with eccentricity.</p></sec><sec id="s3-3"><title>Applications and extensions of the subunit model</title><p>The model described here could potentially capture nonlinear computations in other RGC types, such as ON midget or parasol RGCs. But in some cases the model would require modification. For example, unlike midget RGCs, parasol RGCs receive input from more than one type of bipolar cell, and the receptive fields of these bipolar cells likely exhibit substantial spatial overlap, whereas the current model assumes nonoverlapping subunits (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Indeed, preliminary model fits of parasol responses produce subunits smaller than what is expected from anatomical data, as would be expected in the case of two overlapping bipolar populations (<xref ref-type="bibr" rid="bib10">Boycott and Wässle, 1991</xref>) (not shown). Subunit overlap may underlie the reported Y-cell invariance to spatial phase (see above), and is thus an important goal for future modeling.</p><p>Extensions to the model would also be required to capture RGC responses under more natural stimulus conditions. For example, the current model does not include receptive field surrounds. Insofar as surrounds reflect the contributions of horizontal and amacrine cells (<xref ref-type="bibr" rid="bib45">Mangel, 1991</xref>; <xref ref-type="bibr" rid="bib17">Cook and McReynolds, 1998</xref>; <xref ref-type="bibr" rid="bib48">McMahon et al., 2004</xref>; <xref ref-type="bibr" rid="bib38">Ichinose and Lukasiewicz, 2005</xref>; <xref ref-type="bibr" rid="bib20">Davenport et al., 2008</xref>), additions to the model could capture the contribution of these interneuron types and elucidate their computational role. Incorporating inhibitory interneurons could also improve the accuracy of subunit estimation, if other components in the current model are indirectly absorbing their effects. In some stimulus regimes, it may also be important to incorporate nonlinearities in cone signals. Specifically, the logic of the linearity test (<xref ref-type="fig" rid="fig1">Figure 1</xref>), and the structure of the model (<xref ref-type="fig" rid="fig2">Figure 2</xref>), assume linearity of the cone signal, which is a reasonable approximation for weak stimuli (<xref ref-type="bibr" rid="bib62">Schnapf et al., 1990</xref>), but fails for stronger stimuli (J Angueyra and F Rieke, personal communication). This may account for the moderately lower predictive accuracy of the model when fit to noise and tested on stronger increment-decrement stimuli (<xref ref-type="fig" rid="fig7">Figure 7</xref>). The model would also be enhanced by allowing for temporal nonlinearities (rather than static ones) (<xref ref-type="bibr" rid="bib8">Borghuis et al., 2013</xref>), post-spike temporal filtering (<xref ref-type="bibr" rid="bib57">Pillow et al., 2008</xref>), more complex spike generation, and perhaps nonlinearities that vary across subunits. More generally, the model should be extended to include mechanisms for luminance and contrast gain control (<xref ref-type="bibr" rid="bib46">Mante et al., 2008</xref>), both of which are essential for natural vision. All of these extensions would require new targeted stimulus ensembles and model fitting procedures, and together provide an exciting direction for future research.</p><p>The approach developed here also offers potential opportunities for uncovering the structure and function of other neural circuits. Subunit models have been used to explain pooling behaviors in primary and secondary visual cortex (<xref ref-type="bibr" rid="bib37">Hubel and Wiesel, 1959</xref>; <xref ref-type="bibr" rid="bib61">Rust et al., 2005</xref>; <xref ref-type="bibr" rid="bib76">Vintch et al., 2012</xref>; <xref ref-type="bibr" rid="bib30">Freeman et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Lochmann et al., 2013</xref>), and may represent a ‘canonical’ computation of sensory processing (<xref ref-type="bibr" rid="bib31">Fukushima, 1980</xref>; <xref ref-type="bibr" rid="bib24">Douglas et al., 1989</xref>; <xref ref-type="bibr" rid="bib33">Heeger et al., 1996</xref>; <xref ref-type="bibr" rid="bib59">Riesenhuber and Poggio, 1999</xref>). New stimulation and measurement techniques that facilitate experimental manipulation of these circuits are proliferating. For example, optogenetics enables simultaneous stimulation of many neurons of a given class, while measuring electrical responses of other neurons (<xref ref-type="bibr" rid="bib53">Papagiakoumou, 2013</xref>). But in most scenarios, the circuits of interest will contain neurons that are neither directly stimulated nor measured, analogous to the bipolar interneurons in the present work. Thus, further development of the computational approaches described here may prove an essential tool for inferring the function and connectivity of interneurons in neural circuits.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Animals and dissections</title><p>Preparation and recording methods have been described previously (<xref ref-type="bibr" rid="bib15">Chichilnisky and Kalmar, 2002</xref>). Eyes were enucleated from 15 terminally anesthetized macaque monkeys (<italic>M. mulatta</italic> and <italic>M. fascicularis</italic>) used by other experimenters in accordance with institutional guidelines for the care and use of animals. Five had been used for behavioral and neurophysiological experiments, eight had been experimentally exposed to ethanol (<xref ref-type="bibr" rid="bib80">Wright et al., 2013</xref>), and two had been terminally anesthetized for several days. No systematic differences in retinal physiology were observed between categories of animals. Immediately after enucleation, the anterior portion of the eye and the vitreous were removed in ambient indoor illumination. Segments of peripheral retina (eccentricity 5.5–13.8 mm temporal equivalent [<xref ref-type="bibr" rid="bib15">Chichilnisky and Kalmar, 2002</xref>]) that were well attached to the pigment epithelium were dissected and placed flat, RGC side down, on a planar array of extracellular microelectrodes. The array consisted of 512 electrodes in an isosceles triangular lattice with 30 μm spacing, covering a hexagonal region 450 μm on a side (<xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>). Attachment to the pigment epithelium was preserved during dissection. In some preparations the choroid was largely removed, up to Bruch's membrane, to ensure even retinal thickness and maximize oxygenation. While recording, the retina was perfused with Ames' solution (31–36°C) bubbled with 95% O<sub>2</sub> and 5% CO<sub>2</sub>, pH 7.4.</p></sec><sec id="s4-2"><title>Spike sorting</title><p>Recordings were analyzed online to isolate the spikes of different cells, as described previously (<xref ref-type="bibr" rid="bib19">Dabrowski et al., 2004</xref>; <xref ref-type="bibr" rid="bib28">Field et al., 2007</xref>). Briefly, candidate spike events were detected using a threshold on each electrode, and voltage waveforms on the electrode and nearby electrodes around the time of the spike were extracted. Clusters of similar spike waveforms were identified as candidate neurons if they exhibited a 1 ms refractory period and accounted for more than 100 spikes in 30 min of recording. Duplicate spike trains were identified by temporal cross-correlation and removed.</p></sec><sec id="s4-3"><title>Visual display</title><p>Visual stimulation was performed with the optically reduced image from a computer display. In 14 experiments a gamma-corrected OLED microdisplay (eMagin, Bellvue, WA) refreshing at 60.35 Hz was used. In one experiment a gamma correct CRT display (Sony Trinitron) refreshing at 120 Hz was used. The image was focused through the retina onto the photoreceptor outer segments. The emission spectrum of each display primary was measured with a spectroradiometer (PR-701, PhotoResearch, Chatsworth, CA) after passing through the optical elements between the display and the retina. The mean photoisomerization rates for the L, M and S cones were estimated by computing the inner product of the power scaled emission spectra per unit area with the spectral sensitivity of each opsin, and multiplying by the effective collecting area of primate cones (0.37 μm<sup>2</sup>) (<xref ref-type="bibr" rid="bib4">Baylor et al., 1987</xref>). The power of each display primary was measured at the preparation with a calibrated photodiode (UDT Instruments, San Diego, CA). At the mean background illumination level of the OLED display, the photoisomerization rates for the rods, L, M, and S cones were approximately 29,120, 9440, 9270, and 2320 photoisomerizations per receptor per second (4670, 2200, 2200, 900 for the CRT display). These estimates were not corrected for the angle of illumination and pigment self screening in the cone outer segments, because the precise angle of illumination and the amount of bleached pigment were unknown.</p></sec><sec id="s4-4"><title>Receptive field measurements</title><p>The spatial, temporal and chromatic response properties of recorded RGCs were characterized using a movie stimulus composed of an array of square pixels whose values were updated randomly and independently on each frame (see <xref ref-type="bibr" rid="bib16">Chichilnisky, 2001</xref>). For initial characterization with large pixels, the intensity of each display primary at each pixel location was independently chosen from a binary distribution, yielding a stimulus with chromatic variation. For high resolution characterization of individual cones, the intensities of the display primaries were modulated in unison in most experiments (13 of 15). This yielded a black-white binary intensity modulation with higher variance and thus greater modulation of RGC responses. In the other two experiments, the display primaries were modulated independently of one another. In both conditions, the contrast of each primary (difference between the maximum and minimum intensities divided by the sum) was 96%. For low spatial resolution receptive field maps used for classification (not shown), the pixels were 25.5 or 34 μm on a side, the stimulus refresh rate was 20, 30, or 60 Hz, and recording duration was 30 min. For high resolution maps (<xref ref-type="fig" rid="fig1 fig3 fig4">Figures 1, 3, 4</xref>), the pixels were 3.4 μm on a side, the stimulus refresh rate was 10, 12, or 15 Hz, and recording duration was 30–60 min (depending on the experiment). High resolution spatial receptive fields shown in <xref ref-type="fig" rid="fig1 fig3 fig4">Figures 1, 3, 4</xref> were calculated by collapsing the spike-triggered average over time. For this purpose, the time course was calculated from the average of a subset of stimulus pixels whose absolute peak intensity exceeded four robust standard deviations of all pixel intensities.</p></sec><sec id="s4-5"><title>Identification of OFF midget RGCs</title><p>RGC classification was performed as described previously (<xref ref-type="bibr" rid="bib28">Field et al., 2007</xref>; <xref ref-type="bibr" rid="bib55">Petrusca et al., 2007</xref>; <xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>). OFF midget RGCs were readily identified as those cells with the smallest receptive fields of the appropriate sign, and relatively sustained temporal response properties. The identification of distinct cell types was confirmed by the mosaic organization of receptive fields within each type, and the identities of the different types were consistent with anatomical density measurements (<xref ref-type="bibr" rid="bib15">Chichilnisky and Kalmar, 2002</xref>).</p></sec><sec id="s4-6"><title>Cone finding and preprocessing</title><p>Cone finding was performed using a Bayesian approach described previously (<xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>). Briefly, the linear spatial receptive field of each cone was modeled as a gaussian, and the linear spatial receptive field of each RGC was modeled as a sum of cones. For each retina, a mosaic of cones was greedily chosen to maximize the likelihood of spiking responses across all reliably identified cells (including multiple types). After identifying cone locations, the high-resolution noise stimulus was integrated against the Gaussian profile of each cone, to obtain a set of cone input signals for each RGC. These signals were then convolved in time with the temporal component of the spike-triggered average, effectively aligning the stimulus with the response in time. All modeling subsequently focused only on the spatial component of the response. Spikes were binned by the timing of stimulus frames, which across experiments was typically 12 Hz (83 ms bins). This spatial and temporal preprocessing yielded, for each RGC, a <italic>C</italic> × <italic>T</italic> stimulus matrix <bold><italic>X</italic></bold>, where <italic>C</italic> is the number of cones providing input to that RGC, and <italic>T</italic> is the number of stimulus frames in the experiment, and a <italic>T</italic> × 1 vector <bold><italic>y</italic></bold> of spike counts. These preprocessing steps assume a linear model of the ganglion cell response, but linear analysis is adequate for the purpose of cone localization, because it only requires that each cone provides non-zero input to at least one ganglion cell, which will be true for most monotonic non-linearities; the same procedure was also anatomically validated in previous work (<xref ref-type="bibr" rid="bib58">Field et al., 2010</xref>).</p></sec><sec id="s4-7"><title>Model formulation</title><p>The subunit model describes the transformation of cone signals to the spiking response of a RGC using two stages of computation. Formally, the complete model is a linear-nonlinear-linear-nonlinear-poisson cascade, generalizing and extending both LNP models (<xref ref-type="bibr" rid="bib68">Simoncelli et al., 2004</xref>; <xref ref-type="bibr" rid="bib57">Pillow et al., 2008</xref>), models with ‘input nonlinearities’ (<xref ref-type="bibr" rid="bib2">Ahrens et al., 2008</xref>; <xref ref-type="bibr" rid="bib47">McFarland et al., 2013</xref>), and previous subunit models (<xref ref-type="bibr" rid="bib61">Rust et al., 2005</xref>; <xref ref-type="bibr" rid="bib76">Vintch et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Lochmann et al., 2013</xref>). The first stage linearly combines cone inputs into ‘subunits’ followed by a instantaneous subunit nonlinearity. Let <bold><italic>U</italic></bold> be the <italic>S</italic> × <italic>C</italic> weight matrix connecting <italic>C</italic> cones to <italic>S</italic> subunits. <bold><italic>U</italic></bold> is partitioned as <bold><italic>I</italic></bold> ⊙ <bold><italic>A</italic></bold>, where <bold><italic>I</italic></bold> is a binary indicator matrix, <bold><italic>A</italic></bold> is a continuous-valued weight matrix, and ⊙ is the pointwise product. <bold><italic>I</italic></bold> specifies which cones provide inputs to which subunits, and <bold><italic>A</italic></bold> captures the weight on each cone within a subunit. The response of subunit <italic>s</italic> at time <italic>t</italic> is<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>f</italic>(•) is the subunit nonlinearity (see below for parameterization), and <italic>x</italic><sub><italic>ct</italic></sub> and <italic>u</italic><sub><italic>sc</italic></sub> are elements of the matrices <bold><italic>X</italic></bold> and <bold><italic>U</italic></bold>. The second stage of the model linearly combines subunit responses followed by an instantaneous output nonlinearity. For any given RGC, let <bold><italic>w</italic></bold> be the 1 × <italic>S</italic> vector encoding the weights from subunits to that RGC. The response (mean firing rate) of the RGC at time <italic>t</italic> is<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>g</italic>(•) is the output nonlinearity and <italic>w</italic><sub><italic>s</italic></sub> is an element of the vector <bold><italic>w</italic></bold>. The nonlinearities <italic>f</italic> and <italic>g</italic> were parameterized as piece-wise polynomials (specifically, cubic splines) with eight node points. Our optimization procedure sought parameters <bold><italic>I</italic></bold>, <bold><italic>A</italic></bold>, <bold><italic>w</italic></bold>, <italic>f</italic>, <italic>g</italic> to maximize the log likelihood of the measured spike counts <italic>r</italic><sub><italic>t</italic></sub>, assuming that the number of spikes in at each time <italic>t</italic> was given by a Poisson distribution with rate parameter <italic>z</italic><sub><italic>t</italic></sub>:<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mi>log</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>t</mml:mi></mml:munder><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>t</mml:mi></mml:munder><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-8"><title>Parameters and constraints</title><p>The dimensionality of the parameter space is substantial, and the objective function is non-convex and likely to have many local minima. To encourage reliable estimation, while remaining sufficiently flexible to capture a variety of nonlinear RGC properties, we introduced several constraints: (1) Nonlinearity smoothness was enforced through a set of linear constraints on the spline parameters that guarantees first and second-order derivatives are defined at the nodes (implying that the output of a subunit is smoothly related to its input with no discontinuities); (2) The binary assignment matrix <bold><italic>I</italic></bold> was assumed to be orthogonal (i.e., the subunits were non-overlapping): each cone provided input to exactly one subunit, and the number of subunits was thus constrained to lie between one (equivalent to an LN model) and the number of cones (which we refer to as the single-cone subunit model). (3) The weights from cones to subunits were assumed to be positive, and the weights within each subunit were assumed to sum to 1. No constraints were imposed on the sign or magnitude of weights in the second stage.</p></sec><sec id="s4-9"><title>Model estimation</title><p>Even with constraints, the two-stage structure of the model, and the combination of binary assignments and continuous-valued weights (and nonlinearities) makes optimization difficult. We decomposed the problem into a greedy search over the assignments, and for each assignment performed an optimization over the continuous-valued parameters.</p><p>The optimization over the continuous-valued parameters—the cone weights (<bold><italic>A</italic></bold>), the subunit weights (<bold><italic>w</italic></bold>), and the nonlinearities (<italic>f</italic>, <italic>g</italic>)—was performed using an alternating sequence of simpler gradient descent problems (known as ‘coordinate decent’). First, <italic>g</italic> was initialized as log(1 + exp(•)), <italic>f</italic> was initialized as negative half-wave rectification, <bold><italic>w</italic></bold> and <bold><italic>A</italic></bold> were initialized to contain values of 1. These parameters were then repeatedly optimized, sequentially, in the following order: <bold><italic>w</italic></bold>, <bold><italic>A</italic></bold>, <italic>f</italic>. The nonlinearity <italic>g</italic> was only refit once at the end. In practice, we found that repeating the full optimization after estimating <italic>g</italic> did not substantially change the recovered parameters. Most of these subproblems correspond closely to estimation problems that have been characterized in previous literature on fitting neural encoding models (<xref ref-type="bibr" rid="bib16">Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib52">Paninski, 2004</xref>; <xref ref-type="bibr" rid="bib2">Ahrens et al., 2008</xref>). For example, if the weights (<bold><italic>A</italic></bold>) and nonlinearities (<italic>f</italic>, <italic>g</italic>) are held fixed, estimating the subunit weights (<bold><italic>w</italic></bold>) is identical to fitting a single-stage LNP model, which can be done with gradient descent as long as <italic>f</italic> is convex and log-concave (<xref ref-type="bibr" rid="bib52">Paninski, 2004</xref>). In practice, each of the subproblems on their own, as well as the combined procedure, converged to unique solutions from random initial starting points.</p><p>The best-fitting assignment matrix <bold><italic>I</italic></bold> was found through a greedy procedure. <bold><italic>I</italic></bold> was initialized with the identity matrix (the ‘single cone’ subunit model), all remaining model parameters were estimated (as described above) and the maximized likelihood recorded. For every possible merger of two subunits into a larger subunit, all the remaining model parameters were re-estimated (as described above), and the maximized likelihood recorded. If any of the potential merged pairs yielded an improvement in likelihood over that of the unmerged model, those two subunits were merged. This process was repeated, at each step considering a merger of all possible pairs of subunits, until none of the pairings offered an improvement in likelihood. All code used for model fitting is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/freeman-lab/subunits">https://github.com/freeman-lab/subunits</ext-link> and an interactive web visualization is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/freeman-lab/subunits-web">https://github.com/freeman-lab/subunits-web</ext-link>.</p></sec><sec id="s4-10"><title>Validation of model fitting procedure on simulated data</title><p>Simulations were performed to confirm that the estimation procedure reliably recovered model parameters. Spiking responses were generated using a known set of parameters, with values chosen as typical for those recovered from RGCs, and simulation duration was matched approximately to that of typical experiments (as well as smaller and larger values). The model was fit to these simulated responses. The recovered parameters were found to be nearly identical to the parameters used for simulation (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p></sec><sec id="s4-11"><title>Alternative models</title><p>The accuracy of the subunit model was compared to a simpler LN model, containing only weights on each cone and an output nonlinearity. Formally, the subunit model reduces to the LN model if <bold><italic>I</italic></bold> and <bold><italic>A</italic></bold> are identity matrices and <italic>f</italic> is linear, leaving the parameters <italic>w</italic> and <italic>g</italic>. (An alternative parameterization of LN behavior would be to make <bold><italic>I</italic></bold> a vector of ones, i.e. put all cones in a single subunit). In some cases the subunit model was also compared to a subunit model that included a subunit nonlinearity (<italic>f</italic>), but with an identity matrix for <bold><italic>I</italic></bold> and <bold><italic>A</italic></bold>; that is, the single cone subunit model. In all cases, parameters were fit using similar likelihood maximization methods to those used to fit the full subunit model.</p></sec><sec id="s4-12"><title>Assessing model accuracy</title><p>For every RGC, the model was fit to 80% of the data, and the accuracy of the model was evaluated on the remaining 20%. To account for possible nonstationarities in responses, the subsets of data used for fitting were drawn randomly from periods of time distributed throughout the duration of the experiment. On the evaluation data, model performance was evaluated as<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Although the model was fit by maximizing log likelihood, we used the more intuitive metric of <italic>R</italic><sup><italic>2</italic></sup> to report performance. Comparisons between models were similar when using log likelihood. For repeated white noise and grating data (<xref ref-type="fig" rid="fig5 fig6">Figures 5, 6</xref>), <italic>R</italic><sup><italic>2</italic></sup> was adjusted to account for the reliability of the responses (see below). For each retina, the improvement of one model over another (e.g., subunit over LN) was estimated as the slope of the best-fitting regression line (through the origin) relating the <italic>R</italic><sup><italic>2</italic></sup> of the two models across RGCs (i.e., the best-fitting line to the scatter plots in <xref ref-type="fig" rid="fig3">Figure 3C,D</xref>). In a small number of cases, when analyzing the maximum differentiated stimuli (see below), <italic>R</italic><sup><italic>2</italic></sup> for the LN model was negative, due to particularly poor predictions on these stimuli. In all such cases, the performance of the subunit model was positive. To avoid the influence of these outliers on average performance improvement, they were excluded from the calculation.</p></sec><sec id="s4-13"><title>Maximally differentiated stimuli</title><p>To better differentiate the models, stimuli were selected on the basis of the model predictions. Specifically, the models were fit to training data, and then used to generate predicted responses for stimuli from the remaining data. From amongst these held out stimuli, we selected the 20% individual stimulus frames for which the squared difference in the prediction of the two models was largest. Selecting stimuli by individual frames was appropriate because stimuli were preprocessed to have a one-to-one correspondence with the response at each frame. Performance of both models was then compared to actual neural response on these stimuli. This selection does not favor either model a priori, because it is not based on their performance in explaining the data, but only on how much their predictions differ.</p></sec><sec id="s4-14"><title>White noise repeats</title><p>For the results of <xref ref-type="fig" rid="fig4">Figure 4</xref>, the model was fit to a single run of independent white noise, and then tested on a 10 s sequence of white noise that was repeated 100 times. The repeated presentations allowed prediction accuracy to be computed relative to the inherent reliability of the responses. We compared model predictions of the spike count on individual trials of each 10 s stimulus sequence to the actual responses averaged over all remaining runs of the sequence. In each case, the performance was quantified as the square of the correlation coefficient. This is similar to <italic>R</italic><sup><italic>2</italic></sup> as defined above, but allows for an arbitrary offset and gain, which was important for some RGCs due to changes in overall firing rate between the two experimental preparations. These two <italic>R</italic><sup><italic>2</italic></sup> values were averaged across all trials, and their ratio yielded an adjusted <italic>R</italic><sup><italic>2</italic></sup>, representing the fraction of explainable variance accounted for by the model.</p></sec><sec id="s4-15"><title>Gratings</title><p>Contrast reversing gratings modulating at 2 Hz were presented at eight spatial phases for each of 10 spatial periods. Each presentation of a grating lasted 8 s followed by 2 s of a uniform screen that had an intensity equal to the mean grating intensity over time. Each grating of a particular spatial period and phase was presented three times. For a RGC, the mean spike rate over one contrast reversal was estimated by averaging responses over the 16 contrast reversals (8 s × 2 Hz) in each of these three grating presentations (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). The grating spatial periods ranged from 10 to 1305 microns on the retina. Data reported here (<xref ref-type="fig" rid="fig5">Figure 5</xref>) only for the five spatial periods matched to (or smaller than) a typical OFF midget RGC receptive field. As for white noise, model accuracy was evaluated as adjusted <italic>R</italic><sup><italic>2</italic></sup>. For each spatial period and phase, the response to each of the 36 repeated presentations of the grating (16 contrast reversals × 3 repeats) was predicted by (1) the model and (2) the average across other presentations, and their ratio (averaged across trials) yielded an adjusted <italic>R</italic><sup><italic>2</italic></sup>.</p></sec><sec id="s4-16"><title>Single and paired cone stimulation</title><p>Cone locations and subunit model fits were obtained online during experiments, computed in parallel across roughly 10 multi-core Linux workstations. With parallelization, hundreds of RGCs from an entire retina could be fit in under 10 min. Once model fits were obtained for every RGC, several RGCs (5–10) with high SNR and a variety of subunit configurations were chosen for targeted single cone and paired cone stimulation. Chosen RGCs were at least two cell spacings away from each other, to minimize the impact of stimulating cones lying in the receptive field surround of any of the chosen RGCs. Typically four cones were chosen per RGC. For simplicity, <xref ref-type="fig" rid="fig7">Figure 7</xref> only reports data for the three cones per RGC showing the strongest response to single-cone stimulation, but the quantitative analysis (see below) included all cones tested. Cone location analyses generated stimulus screen coordinates for the center of every cone found in the mosaic. Coordinates of cones within the receptive field of the chosen RGCs were then used to specify regions of the screen selected to stimulate single cones, as follows. Depending on cone spacing in each preparation, spots of radius 7.65–9.35 μm were generated around each cone center location. The full native screen resolution was used (pixels 1.7 μm on a side). For cases in which cone spacing was close enough that the resulting regions would overlap, pixels were assigned to whichever competing cone had the nearest center coordinates. Single cones were then stimulated with uniform contrast steps over the defined regions. Recording trials were 750 ms long with the stimulus presentation occurring in the first 250 ms. Stimulation region (i.e., choice of cone) and contrast were randomized across trials. Control experiments in which light stimuli were presented within the spaces in between cones demonstrated the specificity of this stimulation (<xref ref-type="bibr" rid="bib43a">Li et al., 2014</xref>).</p></sec><sec id="s4-17"><title>Accuracy of closed-loop increment-decrement predictions</title><p>For each RGC, each selected cone was presented with an increment or decrement of light alone, and then separately paired with an increment of light to three other cones. For each such selected cone, the firing rate response to single or paired stimulations were averaged across repeated trials (typically 20–40) and within a 300 ms time window following stimulus presentation. These four firing rates were then divided by their maximum. This normalization served to emphasize the relative effect of pairing increments with a decrement of light, as well as correct for differences in effective cone strength between measurement and model due to, for example, small movement of the retina in between stimulus presentations. For each RGC, model predictions were generated by providing negative or positive inputs to the same combination of cones tested in the experiment. The predictions were then similarly divided by the maximum predicted firing rate for each cone. Finally, the predictive accuracy was computed as the square of the correlation coefficient between predicted and measured response across all cone pairs. Given the non-normal estimator of interest (a difference of correlation coefficients), a bootstrap test was used to compare predictions of the different models—full subunit, single-cone subunit, and LN. On each iteration of a bootstrap, cone pairs were randomly sampled with replacement across RGCs, accuracies for all models were reestimated (as above), and the differences in accuracy between models were computed. The accuracies were considered significantly different if the fifth percentile of the resulting distribution of differences exceeded 0.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>JF, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>EPS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>GDF, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>EJC, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>PHL, Conception and design, Acquisition of data, Analysis and interpretation of data</p></fn><fn fn-type="con" id="con6"><p>MG, Acquisition of data</p></fn><fn fn-type="con" id="con7"><p>DEG, Acquisition of data</p></fn><fn fn-type="con" id="con8"><p>KM, Acquisition of data</p></fn><fn fn-type="con" id="con9"><p>AS, Acquisition of data</p></fn><fn fn-type="con" id="con10"><p>AML, Acquisition of data</p></fn><fn fn-type="con" id="con11"><p>LP, Analysis and interpretation of data</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adelson</surname><given-names>EH</given-names></name><name><surname>Bergen</surname><given-names>JR</given-names></name></person-group><year>1985</year><article-title>Spatiotemporal energy models for the perception of motion</article-title><source>The Journal of the Optical Society of America A</source><volume>2</volume><fpage>284</fpage><lpage>299</lpage><pub-id pub-id-type="doi">10.1364/JOSAA.2.000284</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname><given-names>MB</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Sahani</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Inferring input nonlinearities in neural encoding models</article-title><source>Network</source><volume>19</volume><fpage>35</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1080/09548980701813936</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baccus</surname><given-names>SA</given-names></name><name><surname>Olveczky</surname><given-names>BP</given-names></name><name><surname>Manu</surname><given-names>M</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>A retinal circuit that computes object motion</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>6807</fpage><lpage>6817</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4206-07.2008</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baylor</surname><given-names>DA</given-names></name><name><surname>Nunn</surname><given-names>BJ</given-names></name><name><surname>Schnapf</surname><given-names>JL</given-names></name></person-group><year>1987</year><article-title>Spectral sensitivity of cones of the monkey <italic>Macaca fascicularis</italic></article-title><source>The Journal of Physiology</source><volume>390</volume><fpage>145</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1987.sp016691</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloomfield</surname><given-names>SA</given-names></name><name><surname>Völgyi</surname><given-names>B</given-names></name></person-group><year>2009</year><article-title>The diverse functional roles and regulation of neuronal gap junctions in the retina</article-title><source>Nature Reviews Neuroscience</source><volume>10</volume><fpage>495</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1038/nrn2636</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bölinger</surname><given-names>D</given-names></name><name><surname>Gollisch</surname><given-names>T</given-names></name></person-group><year>2012</year><article-title>Closed-loop measurements of iso-response stimuli reveal dynamic nonlinear stimulus integration in the retina</article-title><source>Neuron</source><volume>73</volume><fpage>333</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.10.039</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bordt</surname><given-names>AS</given-names></name><name><surname>Hoshi</surname><given-names>H</given-names></name><name><surname>Yamada</surname><given-names>ES</given-names></name><name><surname>Perryman-Stout</surname><given-names>WC</given-names></name><name><surname>Marshak</surname><given-names>DW</given-names></name></person-group><year>2006</year><article-title>Synaptic input to OFF parasol ganglion cells in macaque retina</article-title><source>The Journal of Comparative Neurology</source><volume>498</volume><fpage>46</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1002/cne.21040</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borghuis</surname><given-names>BG</given-names></name><name><surname>Marvin</surname><given-names>JS</given-names></name><name><surname>Looger</surname><given-names>LL</given-names></name><name><surname>Demb</surname><given-names>JB</given-names></name></person-group><year>2013</year><article-title>Two-photon imaging of nonlinear glutamate release dynamics at bipolar cell synapses in the mouse retina</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>10972</fpage><lpage>10985</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1241-13.2013</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boycott</surname><given-names>BB</given-names></name><name><surname>Wässle</surname><given-names>H</given-names></name></person-group><year>1974</year><article-title>The morphological types of ganglion cells of the domestic cat's retina</article-title><source>The Journal of Physiology</source><volume>240</volume><fpage>397</fpage><lpage>419</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1974.sp010616</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boycott</surname><given-names>BB</given-names></name><name><surname>Wässle</surname><given-names>H</given-names></name></person-group><year>1991</year><article-title>Morphological classification of bipolar cells of the primate retina</article-title><source>The European Journal of Neuroscience</source><volume>3</volume><fpage>1069</fpage><lpage>1088</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.1991.tb00043.x</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname><given-names>N</given-names></name><name><surname>Strong</surname><given-names>SP</given-names></name><name><surname>Koberle</surname><given-names>R</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>de Ruyter van Steveninck</surname><given-names>RR</given-names></name></person-group><year>2000</year><article-title>Synergy in a neural code</article-title><source>Neural Computation</source><volume>12</volume><fpage>1531</fpage><lpage>1552</lpage><pub-id pub-id-type="doi">10.1162/089976600300015259</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cafaro</surname><given-names>J</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year>2013</year><article-title>Regulation of spatial selectivity by crossover inhibition</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>6310</fpage><lpage>6320</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4964-12.2013</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calkins</surname><given-names>DJ</given-names></name><name><surname>Sterling</surname><given-names>P</given-names></name></person-group><year>2007</year><article-title>Microcircuitry for two types of achromatic ganglion cell in primate fovea</article-title><source>The Journal of Neuroscience</source><volume>27</volume><fpage>2646</fpage><lpage>2653</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4739-06.2007</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Han</surname><given-names>F</given-names></name><name><surname>Poo</surname><given-names>MM</given-names></name><name><surname>Dan</surname><given-names>Y</given-names></name></person-group><year>2007</year><article-title>Excitatory and suppressive receptive field subunits in awake monkey primary visual cortex (V1)</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>104</volume><fpage>19120</fpage><lpage>19125</lpage><pub-id pub-id-type="doi">10.1073/pnas.0706938104</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2001</year><article-title>A simple white noise analysis of neuronal light responses</article-title><source>Network</source><volume>12</volume><fpage>199</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1080/713663221</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name><name><surname>Kalmar</surname><given-names>RS</given-names></name></person-group><year>2002</year><article-title>Functional asymmetries in ON and OFF ganglion cells of primate retina</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>2737</fpage><lpage>2747</lpage></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cook</surname><given-names>PB</given-names></name><name><surname>McReynolds</surname><given-names>JS</given-names></name></person-group><year>1998</year><article-title>Lateral inhibition in the inner retina is important for spatial tuning of ganglion cells</article-title><source>Nature Neuroscience</source><volume>1</volume><fpage>714</fpage><lpage>719</lpage><pub-id pub-id-type="doi">10.1038/3714</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crook</surname><given-names>JD</given-names></name><name><surname>Peterson</surname><given-names>BB</given-names></name><name><surname>Packer</surname><given-names>OS</given-names></name><name><surname>Robinson</surname><given-names>FR</given-names></name><name><surname>Troy</surname><given-names>JB</given-names></name><name><surname>Dacey</surname><given-names>DM</given-names></name></person-group><year>2008</year><article-title>Y-cell receptive field and collicular projection of parasol ganglion cells in macaque monkey retina</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>11277</fpage><lpage>11291</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2982-08.2008</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dabrowski</surname><given-names>W</given-names></name><name><surname>Grybos</surname><given-names>P</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name></person-group><year>2004</year><article-title>A low noise multichannel integrated circuit for recording neuronal signals using microelectrode arrays</article-title><source>Biosensors &amp; Bioelectronics</source><volume>19</volume><fpage>749</fpage><lpage>761</lpage><pub-id pub-id-type="doi">10.1016/j.bios.2003.08.005</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davenport</surname><given-names>CM</given-names></name><name><surname>Detwiler</surname><given-names>PB</given-names></name><name><surname>Dacey</surname><given-names>DM</given-names></name></person-group><year>2008</year><article-title>Effects of pH buffering on horizontal and ganglion cell light responses in primate retina: evidence for the proton hypothesis of surround formation</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>456</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2735-07.2008</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demb</surname><given-names>JB</given-names></name><name><surname>Haarsma</surname><given-names>L</given-names></name><name><surname>Freed</surname><given-names>MA</given-names></name><name><surname>Sterling</surname><given-names>P</given-names></name></person-group><year>1999</year><article-title>Functional circuitry of the retinal ganglion cell's nonlinear receptive field</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>9756</fpage><lpage>9767</lpage></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demb</surname><given-names>JB</given-names></name><name><surname>Zaghloul</surname><given-names>K</given-names></name><name><surname>Haarsma</surname><given-names>L</given-names></name><name><surname>Sterling</surname><given-names>P</given-names></name></person-group><year>2001</year><article-title>Bipolar cells contribute to nonlinear spatial summation in the brisk-transient (Y) ganglion cell in mammalian retina</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>7447</fpage><lpage>7454</lpage></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derrington</surname><given-names>AM</given-names></name><name><surname>Lennie</surname><given-names>P</given-names></name></person-group><year>1984</year><article-title>Spatial and temporal contrast sensitivities of neurones in lateral geniculate nucleus of macaque</article-title><source>The Journal of Physiology</source><volume>357</volume><fpage>219</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1984.sp015498</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Douglas</surname><given-names>RJ</given-names></name><name><surname>Martin</surname><given-names>KA</given-names></name><name><surname>Whitteridge</surname><given-names>D</given-names></name></person-group><year>1989</year><article-title>A canonical microcircuit for neocortex</article-title><source>Neural Computation</source><volume>1</volume><fpage>480</fpage><lpage>488</lpage><pub-id pub-id-type="doi">10.1162/neco.1989.1.4.480</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enroth-Cugell</surname><given-names>C</given-names></name><name><surname>Freeman</surname><given-names>AW</given-names></name></person-group><year>1987</year><article-title>The receptive-field spatial structure of cat retinal Y cells</article-title><source>The Journal of Physiology</source><volume>384</volume><fpage>49</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1987.sp016443</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enroth-Cugell</surname><given-names>C</given-names></name><name><surname>Robson</surname><given-names>JG</given-names></name></person-group><year>1966</year><article-title>The contrast sensitivity of retinal ganglion cells of the cat</article-title><source>The Journal of Physiology</source><volume>187</volume><fpage>517</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1966.sp008107</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Field</surname><given-names>GD</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2007</year><article-title>Information processing in the primate retina: circuitry and coding</article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>1</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.30.051606.094252</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Field</surname><given-names>GD</given-names></name><name><surname>Gauthier</surname><given-names>JL</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Greschner</surname><given-names>M</given-names></name><name><surname>Machado</surname><given-names>TA</given-names></name><name><surname>Jepson</surname><given-names>LH</given-names></name><name><surname>Shlens</surname><given-names>J</given-names></name><name><surname>Gunning</surname><given-names>DE</given-names></name><name><surname>Mathieson</surname><given-names>K</given-names></name><name><surname>Dabrowski</surname><given-names>W</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2010</year><article-title>Functional connectivity in the retina at the resolution of photoreceptors</article-title><source>Nature</source><volume>467</volume><fpage>673</fpage><lpage>677</lpage><pub-id pub-id-type="doi">10.1038/nature09424</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Field</surname><given-names>GD</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Gauthier</surname><given-names>JL</given-names></name><name><surname>Greschner</surname><given-names>M</given-names></name><name><surname>Shlens</surname><given-names>J</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2007</year><article-title>Spatial properties and functional organization of small bistratified ganglion cells in primate retina</article-title><source>The Journal of Neuroscience</source><volume>27</volume><fpage>13261</fpage><lpage>13272</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3437-07.2007</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frechette</surname><given-names>ES</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Grivich</surname><given-names>MI</given-names></name><name><surname>Petrusca</surname><given-names>D</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2005</year><article-title>Fidelity of the ensemble code for visual motion in primate retina</article-title><source>Journal of Neurophysiology</source><volume>94</volume><fpage>119</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1152/jn.01175.2004</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Ziemba</surname><given-names>CM</given-names></name><name><surname>Heeger</surname><given-names>DJ</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Movshon</surname><given-names>JA</given-names></name></person-group><year>2013</year><article-title>A functional and perceptual signature of the second visual area in primates</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>974</fpage><lpage>981</lpage><pub-id pub-id-type="doi">10.1038/nn.3402</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukushima</surname><given-names>K</given-names></name></person-group><year>1980</year><article-title>Neocognitron: a self organizing neural network model for a mechanism of pattern recognition unaffected by shift in position</article-title><source>Biological Cybernetics</source><volume>36</volume><fpage>193</fpage><lpage>202</lpage><pub-id pub-id-type="doi">10.1007/BF00344251</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gollisch</surname><given-names>T</given-names></name></person-group><year>2012</year><article-title>Features and functions of nonlinear spatial integration by retinal ganglion cells</article-title><source>Journal of Physiology</source><volume>107</volume><fpage>338</fpage><lpage>348</lpage><pub-id pub-id-type="doi">10.1016/j.jphysparis.2012.12.001</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heeger</surname><given-names>DJ</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Movshon</surname><given-names>JA</given-names></name></person-group><year>1996</year><article-title>Computational models of cortical visual processing</article-title><source>Proceedings of the National Academy of Sciences of USA</source><volume>93</volume><fpage>623</fpage><lpage>627</lpage><pub-id pub-id-type="doi">10.1073/pnas.93.2.623</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hochstein</surname><given-names>S</given-names></name><name><surname>Shapley</surname><given-names>RM</given-names></name></person-group><year>1976</year><article-title>Quantitative analysis of retinal ganglion cell classifications</article-title><source>The Journal of Physiology</source><volume>262</volume><fpage>237</fpage><lpage>264</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1976.sp011594</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hornstein</surname><given-names>EP</given-names></name><name><surname>Verweij</surname><given-names>J</given-names></name><name><surname>Schnapf</surname><given-names>JL</given-names></name></person-group><year>2004</year><article-title>Electrical coupling between red and green cones in primate retina</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>745</fpage><lpage>750</lpage><pub-id pub-id-type="doi">10.1038/nn1274</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horwitz</surname><given-names>GD</given-names></name><name><surname>Hass</surname><given-names>CA</given-names></name></person-group><year>2012</year><article-title>Nonlinear analysis of macaque V1 color tuning reveals cardinal directions for cortical color processing</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>913</fpage><lpage>919</lpage><pub-id pub-id-type="doi">10.1038/nn.3105</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hubel</surname><given-names>D</given-names></name><name><surname>Wiesel</surname><given-names>T</given-names></name></person-group><year>1959</year><article-title>Receptive fields of single neurones in the cat's striate cortex</article-title><source>The Journal of Physiology</source><volume>148</volume><fpage>574</fpage><lpage>591</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1959.sp006308</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ichinose</surname><given-names>T</given-names></name><name><surname>Lukasiewicz</surname><given-names>PD</given-names></name></person-group><year>2005</year><article-title>Inner and outer retinal pathways both contribute to surround inhibition of salamander ganglion cells</article-title><source>The Journal of Physiology</source><volume>565</volume><fpage>517</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2005.083436</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaplan</surname><given-names>E</given-names></name><name><surname>Shapley</surname><given-names>RM</given-names></name></person-group><year>1982</year><article-title>X and Y cells in the lateral geniculate nucleus of macaque monkeys</article-title><source>The Journal of Physiology</source><volume>330</volume><fpage>125</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1982.sp014333</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keat</surname><given-names>J</given-names></name><name><surname>Reinagel</surname><given-names>P</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year>2001</year><article-title>Predicting every spike: a model for the responses of visual neurons</article-title><source>Neuron</source><volume>30</volume><fpage>803</fpage><lpage>817</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(01)00322-1</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolb</surname><given-names>H</given-names></name><name><surname>Marshak</surname><given-names>D</given-names></name></person-group><year>2003</year><article-title>The midget pathways of the primate retina</article-title><source>Documenta Ophthalmologica</source><volume>106</volume><fpage>67</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1023/A:1022469002511</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>BB</given-names></name><name><surname>Wehrhahn</surname><given-names>C</given-names></name><name><surname>Westheimer</surname><given-names>G</given-names></name><name><surname>Kremers</surname><given-names>J</given-names></name></person-group><year>1995</year><article-title>The spatial precision of macaque ganglion cell responses in relation to vernier acuity of human observers</article-title><source>Vision Research</source><volume>35</volume><fpage>2743</fpage><lpage>2758</lpage><pub-id pub-id-type="doi">10.1016/0042-6989(95)00015-R</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levitt</surname><given-names>JB</given-names></name><name><surname>Schumer</surname><given-names>RA</given-names></name><name><surname>Sherman</surname><given-names>SM</given-names></name><name><surname>Spear</surname><given-names>PD</given-names></name><name><surname>Movshon</surname><given-names>JA</given-names></name></person-group><year>2001</year><article-title>Visual response properties of neurons in the LGN of normally reared and visually deprived macaque monkeys</article-title><source>Journal of Neurophysiology</source><volume>85</volume><fpage>2111</fpage><lpage>2129</lpage></element-citation></ref><ref id="bib43a"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>PH</given-names></name><name><surname>Field</surname><given-names>GD</given-names></name><name><surname>Greschner</surname><given-names>M</given-names></name><name><surname>Ahn</surname><given-names>D</given-names></name><name><surname>Gunning</surname><given-names>DE</given-names></name><name><surname>Mathieson</surname><given-names>K</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name></person-group><year>2014</year><article-title>Retinal Representation of the Elementary Visual Signal</article-title><source>Neuron</source><volume>82</volume><fpage>130</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.10.043</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lochmann</surname><given-names>T</given-names></name><name><surname>Blanche</surname><given-names>TJ</given-names></name><name><surname>Butts</surname><given-names>DA</given-names></name></person-group><year>2013</year><article-title>Construction of direction selectivity through local energy computations in primary visual cortex</article-title><source>PLOS ONE</source><volume>8</volume><fpage>e58666</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0058666</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mangel</surname><given-names>SC</given-names></name></person-group><year>1991</year><article-title>Analysis of the horizontal cell contribution to the receptive field surround of ganglion cells in the rabbit retina</article-title><source>The Journal of Physiology</source><volume>442</volume><fpage>211</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1991.sp018790</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mante</surname><given-names>V</given-names></name><name><surname>Bonin</surname><given-names>V</given-names></name><name><surname>Carandini</surname><given-names>M</given-names></name></person-group><year>2008</year><article-title>Functional mechanisms shaping lateral geniculate responses to artificial and natural stimuli</article-title><source>Neuron</source><volume>58</volume><fpage>625</fpage><lpage>638</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.03.011</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McFarland</surname><given-names>JM</given-names></name><name><surname>Cui</surname><given-names>Y</given-names></name><name><surname>Butts</surname><given-names>DA</given-names></name></person-group><year>2013</year><article-title>Inferring nonlinear neuronal computation based on physiologically plausible inputs</article-title><source>PLOS Computational Biology</source><volume>9</volume><fpage>e1003143</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003143</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMahon</surname><given-names>MJ</given-names></name><name><surname>Packer</surname><given-names>OS</given-names></name><name><surname>Dacey</surname><given-names>DM</given-names></name></person-group><year>2004</year><article-title>The classical receptive field surround of primate parasol ganglion cells is mediated primarily by a non-GABAergic pathway</article-title><source>The Journal of Neuroscience</source><volume>24</volume><fpage>3736</fpage><lpage>3745</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5252-03.2004</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Münch</surname><given-names>TA</given-names></name><name><surname>da Silveira</surname><given-names>RA</given-names></name><name><surname>Siegert</surname><given-names>S</given-names></name><name><surname>Viney</surname><given-names>TJ</given-names></name><name><surname>Awatramani</surname><given-names>GB</given-names></name><name><surname>Roska</surname><given-names><bold>B</bold></given-names></name></person-group><year>2009</year><article-title>Approach sensitivity in the retina processed by a multifunctional neural circuit</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>1308</fpage><lpage>1316</lpage><pub-id pub-id-type="doi">10.1038/nn.2389</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Brien</surname><given-names>JJ</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Macleish</surname><given-names>PR</given-names></name><name><surname>O'Brien</surname><given-names>J</given-names></name><name><surname>Massey</surname><given-names>SC</given-names></name></person-group><year>2012</year><article-title>Photoreceptor coupling mediated by connexin36 in the primate retina</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>4675</fpage><lpage>4687</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4749-11.2012</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olveczky</surname><given-names>BP</given-names></name><name><surname>Baccus</surname><given-names>SA</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name></person-group><year>2007</year><article-title>Retinal adaptation to object motion</article-title><source>Neuron</source><volume>56</volume><fpage>689</fpage><lpage>700</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2007.09.030</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paninski</surname><given-names>L</given-names></name></person-group><year>2004</year><article-title>Maximum likelihood estimation of cascade point-process neural encoding models</article-title><source>Network</source><volume>15</volume><fpage>243</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_15_4_002</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papagiakoumou</surname><given-names>E</given-names></name></person-group><year>2013</year><article-title>Optical developments for optogenetics</article-title><source>Biology of the Cell</source><volume>105</volume><fpage>443</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1111/boc.201200087</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peichl</surname><given-names>L</given-names></name><name><surname>Wässle</surname><given-names>H</given-names></name></person-group><year>1981</year><article-title>Morphological identification of on- and off-centre brisk transient (Y) cells in the cat retina</article-title><source>Proceedings of the Royal Society of London. Series B, Biological Sciences</source><volume>212</volume><fpage>139</fpage><lpage>153</lpage><pub-id pub-id-type="doi">10.1098/rspb.1981.0030</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petrusca</surname><given-names>D</given-names></name><name><surname>Grivich</surname><given-names>MI</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Field</surname><given-names>GD</given-names></name><name><surname>Gauthier</surname><given-names>JL</given-names></name><name><surname>Greschner</surname><given-names>M</given-names></name><name><surname>Shlens</surname><given-names>J</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name></person-group><year>2007</year><article-title>Identification and characterization of a Y-like primate retinal ganglion cell type</article-title><source>The Journal of Neuroscience</source><volume>27</volume><fpage>11019</fpage><lpage>11027</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2836-07.2007</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Shlens</surname><given-names>J</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Sher</surname><given-names>A</given-names></name><name><surname>Litke</surname><given-names>AM</given-names></name><name><surname>Chichilnisky</surname><given-names>EJ</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year>2008</year><article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title><source>Nature</source><volume>454</volume><fpage>995</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1038/nature07140</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year>2006</year><article-title>Dimensionality reduction in neural models: an information-theoretic generalization of spike-triggered average and covariance analysis</article-title><source>Journal of Vision</source><volume>6</volume><fpage>414</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1167/6.4.9</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riesenhuber</surname><given-names>M</given-names></name><name><surname>Poggio</surname><given-names>T</given-names></name></person-group><year>1999</year><article-title>Hierarchical models of object recognition in cortex</article-title><source>Nature Neuroscience</source><volume>2</volume><fpage>1019</fpage><lpage>1025</lpage><pub-id pub-id-type="doi">10.1038/14819</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robbins</surname><given-names>J</given-names></name><name><surname>Ikeda</surname><given-names>H</given-names></name></person-group><year>1989</year><article-title>Benzodiazepines and the mammalian retina. II. Actions on retinal ganglion cells</article-title><source>Brain Research</source><volume>479</volume><fpage>323</fpage><lpage>333</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(89)91635-1</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rust</surname><given-names>NC</given-names></name><name><surname>Schwartz</surname><given-names>O</given-names></name><name><surname>Movshon</surname><given-names>JA</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year>2005</year><article-title>Spatiotemporal elements of macaque v1 receptive fields</article-title><source>Neuron</source><volume>46</volume><fpage>945</fpage><lpage>956</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.05.021</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnapf</surname><given-names>JL</given-names></name><name><surname>Nunn</surname><given-names>BJ</given-names></name><name><surname>Meister</surname><given-names>M</given-names></name><name><surname>Baylor</surname><given-names>DA</given-names></name></person-group><year>1990</year><article-title>Visual transduction in cones of the monkey <italic>Macaca fascicularis</italic></article-title><source>The Journal of Physiology</source><volume>427</volume><fpage>681</fpage><lpage>713</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.1990.sp018193</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>G</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year>2011</year><article-title>Perspectives on: information and coding in mammalian sensory physiology: nonlinear spatial encoding by retinal ganglion cells: when 1 + 1 ≠ 2</article-title><source>The Journal of General Physiology</source><volume>138</volume><fpage>283</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1085/jgp.201110629</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>GW</given-names></name><name><surname>Okawa</surname><given-names>H</given-names></name><name><surname>Dunn</surname><given-names>FA</given-names></name><name><surname>Morgan</surname><given-names>JL</given-names></name><name><surname>Kerschensteiner</surname><given-names>D</given-names></name><name><surname>Wong</surname><given-names>RO</given-names></name><name><surname>Rieke</surname><given-names>F</given-names></name></person-group><year>2012</year><article-title>The spatial structure of a nonlinear receptive field</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1572</fpage><lpage>1580</lpage><pub-id pub-id-type="doi">10.1038/nn.3225</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>O</given-names></name><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Rust</surname><given-names>NC</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name></person-group><year>2006</year><article-title>Spike-triggered neural characterization</article-title><source>Journal of Vision</source><volume>6</volume><fpage>484</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1167/6.4.13</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shapley</surname><given-names>R</given-names></name><name><surname>Kaplan</surname><given-names>E</given-names></name><name><surname>Soodak</surname><given-names>R</given-names></name></person-group><year>1981</year><article-title>Spatial summation and contrast sensitivity of X and Y cells in the lateral geniculate nucleus of the macaque</article-title><source>Nature</source><volume>292</volume><fpage>543</fpage><lpage>545</lpage><pub-id pub-id-type="doi">10.1038/292543a0</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharpee</surname><given-names>T</given-names></name><name><surname>Rust</surname><given-names>NC</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year>2004</year><article-title>Analyzing neural responses to natural signals: maximally informative dimensions</article-title><source>Neural Computation</source><volume>16</volume><fpage>223</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1162/089976604322742010</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Paninski</surname><given-names>L</given-names></name><name><surname>Pillow</surname><given-names>J</given-names></name></person-group><year>2004</year><article-title>Characterization of neural responses with stochastic stimuli</article-title><source>The Cognitive Neurosciences</source></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strong</surname><given-names>SP</given-names></name><name><surname>de Ruyter van Steveninck</surname><given-names>RR</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Koberle</surname><given-names>R</given-names></name></person-group><year>1998</year><article-title>On the application of information theory to neural spike trains</article-title><source>Pacific Symposium on Biocomputing</source><volume>1998</volume><fpage>621</fpage><lpage>632</lpage></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Touryan</surname><given-names>J</given-names></name><name><surname>Felsen</surname><given-names>G</given-names></name><name><surname>Dan</surname><given-names>Y</given-names></name></person-group><year>2005</year><article-title>Spatial structure of complex cell receptive fields measured with natural images</article-title><source>Neuron</source><volume>45</volume><fpage>781</fpage><lpage>791</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.01.029</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Troy</surname><given-names>JB</given-names></name><name><surname>Lee</surname><given-names>BB</given-names></name></person-group><year>1994</year><article-title>Steady discharges of macaque retinal ganglion cells</article-title><source>Visual Neuroscience</source><volume>11</volume><fpage>111</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1017/S0952523800011159</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Truccolo</surname><given-names>W</given-names></name><name><surname>Eden</surname><given-names>UT</given-names></name><name><surname>Fellows</surname><given-names>MR</given-names></name><name><surname>Donoghue</surname><given-names>JP</given-names></name><name><surname>Brown</surname><given-names>EN</given-names></name></person-group><year>2005</year><article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title><source>Journal of Neurophysiology</source><volume>93</volume><fpage>1074</fpage><lpage>1089</lpage><pub-id pub-id-type="doi">10.1152/jn.00697.2004</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsukamoto</surname><given-names>Y</given-names></name><name><surname>Masarachia</surname><given-names>P</given-names></name><name><surname>Schein</surname><given-names>SJ</given-names></name><name><surname>Sterling</surname><given-names>P</given-names></name></person-group><year>1992</year><article-title>Gap junctions between the pedicles of macaque foveal cones</article-title><source>Vision Research</source><volume>32</volume><fpage>1809</fpage><lpage>1815</lpage><pub-id pub-id-type="doi">10.1016/0042-6989(92)90042-H</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Victor</surname><given-names>JD</given-names></name><name><surname>Shapley</surname><given-names>RM</given-names></name></person-group><year>1979a</year><article-title>Receptive field mechanisms of cat X and Y retinal ganglion cells</article-title><source>The Journal of General Physiology</source><volume>74</volume><fpage>275</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1085/jgp.74.2.275</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Victor</surname><given-names>JD</given-names></name><name><surname>Shapley</surname><given-names>RM</given-names></name></person-group><year>1979b</year><article-title>The nonlinear pathway of Y ganglion cells in the cat retina</article-title><source>The Journal of General Physiology</source><volume>74</volume><fpage>671</fpage><lpage>689</lpage><pub-id pub-id-type="doi">10.1085/jgp.74.6.671</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vintch</surname><given-names>B</given-names></name><name><surname>Zaharia</surname><given-names>A</given-names></name><name><surname>Movshon</surname><given-names>J</given-names></name></person-group><year>2012</year><article-title>Efficient and direct estimation of a neural subunit model for sensory coding</article-title><source>Advances in Neural Information Processing Systems</source><volume>25</volume><fpage>3113</fpage><lpage>3121</lpage></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wässle</surname><given-names>H</given-names></name><name><surname>Boycott</surname><given-names>BB</given-names></name><name><surname>Illing</surname><given-names>RB</given-names></name></person-group><year>1981a</year><article-title>Morphology and mosaic of on- and off-beta cells in the cat retina and some functional considerations</article-title><source>Proceedings of the Royal Society of London. Series B, Biological Sciences</source><volume>212</volume><fpage>177</fpage><lpage>195</lpage><pub-id pub-id-type="doi">10.1098/rspb.1981.0033</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wässle</surname><given-names>H</given-names></name><name><surname>Peichl</surname><given-names>L</given-names></name><name><surname>Boycott</surname><given-names>BB</given-names></name></person-group><year>1981b</year><article-title>Morphology and topography of on- and off-alpha cells in the cat retina</article-title><source>Proceedings of the Royal Society of London. Series B, Biological Sciences</source><volume>212</volume><fpage>157</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1098/rspb.1981.0032</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wässle</surname><given-names>H</given-names></name><name><surname>Grünert</surname><given-names>U</given-names></name><name><surname>Martin</surname><given-names>PR</given-names></name><name><surname>Boycott</surname><given-names>BB</given-names></name></person-group><year>1994</year><article-title>Immunocytochemical characterization and spatial distribution of midget bipolar cells in the macaque monkey retina</article-title><source>Vision Research</source><volume>34</volume><fpage>561</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1016/0042-6989(94)90013-2</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>MJ</given-names></name><name><surname>Vandewater</surname><given-names>SA</given-names></name><name><surname>Taffe</surname><given-names>MA</given-names></name></person-group><year>2013</year><article-title>The influence of acute and chronic alcohol consumption on response time distribution in adolescent rhesus macaques</article-title><source>Neuropharmacology</source><volume>70</volume><fpage>12</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1016/j.neuropharm.2013.01.003</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.05241.011</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Carandini</surname><given-names>Matteo</given-names></name><role>Reviewing editor</role><aff><institution>University College London</institution>, <country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>eLife posts the editorial decision letter and author response on a selection of the published articles (subject to the approval of the authors). An edited version of the letter sent to the authors after peer review is shown, indicating the substantive concerns or comments; minor concerns are not usually shown. Reviewers have the opportunity to discuss the decision before the letter is sent (see <ext-link ext-link-type="uri" xlink:href="http://elifesciences.org/review-process">review process</ext-link>). Similarly, the author response typically shows only responses to the major concerns raised by the reviewers.</p></boxed-text><p>Thank you for sending your work entitled “Mapping nonlinear receptive field structure in primate retina at single cone resolution” for consideration at <italic>eLife</italic>. Your article has been favorably evaluated by Eve Marder (Senior Editor) and three reviewers, one of whom, Matteo Carandini, is a member of our Board of Reviewing Editors.</p><p>The Reviewing editor and the other reviewers discussed their comments before we reached this decision, and the Reviewing editor has assembled the following comments to help you prepare a revised submission.</p><p>This useful and interesting paper presents new modeling methods for characterizing retinal ganglion cell receptive fields, and applies it to explain the nonlinear spatial summation in primate OFF midget ganglion cells. The results are surprising, since midget cells (which constitute the vast majority of retinal ganglion cells in primates) were hitherto thought to operate mostly linearly, whereas here they are described as being fundamentally nonlinear. The data are of high quality, the modeling thoughtful and innovative, and the paper clear and well-presented. Some questions, however, need to be addressed.</p><p>Description of the model: Even though the paper is written for a general audience, the modeling should be explained more extensively. Currently, one has trouble understanding the cone finding and preprocessing section (Methods). The paper suggests that the cone positions and weights were fit using previously described methods. Then it states that the signals were convolved with the ganglion cell's spike-triggered average (STA). But the STA is derived from a linear model of the response. Why is this appropriate for a step in building the subunit model? A similar concern: the initial maps of the cones are derived from a linear analysis (STA), and so wouldn't these maps potentially miss nonlinear sources of the response?</p><p>Relationship to known nonlinearities in midget cells: It is interesting to see such pronounced nonlinearities (subunits) in the receptive fields of a class of retinal ganglion cells (RGCs), the midget cells, which are commonly described as linear (X-like). The paper should do a better job at casting these nonlinearities in the context of the existing knowledge, to point out whether they are consistent with previous findings, or whether they are a surprise. For instance, the paper could describe more extensively the prior literature on linearity/nonlinearity of P cells in the LGN, including several papers by Benardete and Kaplan, by Derrington and Lennie, and at least one by the Movshon laboratory (<xref ref-type="bibr" rid="bib43">Levitt et al., 2001</xref>, which is cited in the paper). To what extent are those findings consistent with the findings here? (This applies also to differences and similarities between ON and OFF P cells, see next point).</p><p>Focus on OFF cells: The paper focuses on OFF midget cells, which apparently had the highest signal-to-noise ratio and stability. But what about ON cells? Are they ignored because they are actually linear? In that case, it would help to start the paper with those, and demonstrate linearity. Then go on to the OFF ones and show the nonlinearity. If instead they have more complex nonlinearities, it would help to at least describe them, ideally with a figure.</p><p>Nature of the large subunits: The reported presence of such large photoreceptor subunits (in contrast to preexisting literature) deserves to be given more prominence, to be discussed more extensively, and ideally to be investigated experimentally. A possible explanation for such large subunits could lie in gap-junction among photoreceptors. Ideally one would test this possibility experimentally, e.g. by adding dopamine D1 agonist or antagonist to modulate the gap-junctional link among photoreceptors (or at least test with the model if cones that are associated in one subunit for an OFF RGC tend to be associated as one subunit for an overlapping ON RGC?). Another possible explanation lies in amacrine cells feeding signals from surrounding bipolar cells. These cells are currently not considered in the model, and might result in single subunits pooling from very large photoreceptors sets in the model. Another possibility, which is not possible to rule out given the way the model is explained, is that some sort of constraint (or minimization) is posed on the number subunits (bipolar cells), leading to artifactually large subunits. Finally, if data are available from a region closer to the fovea, it would be very interesting to see whether the model is able to capture the relationship between 1 photoreceptor – 1 bipolar cell – 1 retinal ganglion cell.</p><p>Number of subunits: Another result of the model that must be compared with morphological literature (either <xref ref-type="bibr" rid="bib79">Wassle et al., 1994</xref> or <xref ref-type="bibr" rid="bib41">Kolb and Marshak, 2003</xref>) is the number of subunits (bipolar cells). This subject is pivotal to understand how the results resemble primates' anatomy. This issue deserves a Figure similar to <xref ref-type="fig" rid="fig6">Figure 6D</xref> and an articulated discussion.</p><p>Modeling of nonlinearities: The subunit nonlinearity seems to be modeled as being static, and being the same for all subunits. Any evidence that this is a good assumption? Moreover, can the fits be further improved by imposing a temporal nonlinearity (not just a static one)? For example, direct measurements of glutamate release (imaging of iGluSnFR) in ON layers, revealed that rectification is mild, and that a temporal nonlinearity (transient increases in release) explained nonlinear behavior in postsynaptic ganglion cells (<xref ref-type="bibr" rid="bib8">Borghuis et al., 2013</xref>). The same might be true in primate midget cells.</p><p>In the second paragraph of the subsection “Nonlinear spatial summation in OFF midget RGCs”, the authors should demonstrate the phase dependence of the OFF midget cell responses. This indeed does not follow the rule for Y-like cells and may give insights into the underlying circuitry for generating the nonlinearity. Does the subunit model show similar behavior as the recorded cell? Later in the paragraph, the authors raise the possibility that crossover inhibition may generate differences between midget and parasol cells. This suggestion needs more context/explanation.</p><p>Single-neuron approach: The way the data are presented, these RGCs could have been measured one at a time. And instead, they were measured all together. This is a missed opportunity. For instance, if some cones are arranged in a subunit for one RGC, does that increase their chance of being arranged as a subunit in another RGC? Along the same lines, does the model help in predicting correlations between different RGCs?</p><p>Relationship with measurements in vivo: The authors take the interesting viewpoint that their measurements in vitro are actually closer to being natural than measurements under anesthesia, which may affect the basal release rate and therefore the strength of nonlinearity at the set point. This is a key issue, and if one wanted to prove it one could perhaps add the same anesthetics to the in vitro retina as used during in vivo recordings. The alternative explanation is that it is the in vitro condition that somehow distorts the nonlinearity. The washout of neuromodulators could be a source of variability in ex vivo preps, too. In the absence of experimental data, this issue needs to be treated in a more balanced way, and both possibilities kept open.</p><p>Room for improvement: It would be useful to better describe room for improvement in the model, if possible. For example, the data in the last figure apparently were difficult to capture with the subunit model (low R2 values), although the model fits in this case were not shown. It would be useful to show both subunit and linear model fits in this figure. Also, a surprising omission from the model is inhibitory cells (e.g., amacrine cells) pooling over larger areas. Is there any evidence that data would be better fit by including them in a model?</p><p>Minor comments:</p><p>The paper states repeatedly that the improvement in predictions made by the model over the LN model is minor. Yet, in responses to gratings it seems major (<xref ref-type="fig" rid="fig5">Figure 5</xref>). This might be worth emphasizing.</p><p>For instance, when predicting the responses to gratings (<xref ref-type="fig" rid="fig5">Figure 5</xref>), it would help to see a plot with spatial frequency in the abscissa, and harmonic responses – both first and second – in the ordinate. And curves predicted by the two models.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.05241.012</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>This useful and interesting paper presents new modeling methods for characterizing retinal ganglion cell receptive fields, and applies it to explain the nonlinear spatial summation in primate OFF midget ganglion cells. The results are surprising, since midget cells (which constitute the vast majority of retinal ganglion cells in primates) were hitherto thought to operate mostly linearly, whereas here they are described as being fundamentally nonlinear. The data are of high quality, the modeling thoughtful and innovative, and the paper clear and well-presented. Some questions, however, need to be addressed.</italic></p><p><italic>Description of the model: Even though the paper is written for a general audience, the modeling should be explained more extensively. Currently, one has trouble understanding the cone finding and preprocessing section (Methods). The paper suggests that the cone positions and weights were fit using previously described methods. Then it states that the signals were convolved with the ganglion cell's spike-triggered average (STA). But the STA is derived from a linear model of the response. Why is this appropriate for a step in building the subunit model? A similar concern: the initial maps of the cones are derived from a linear analysis (STA), and so wouldn't these maps potentially miss nonlinear sources of the response?</italic></p><p>We agree that the description of the modeling was a bit unclear on these points. The simple answer is that the STA procedure is used <italic>only</italic> as a preprocessing step to estimate the location and size of the cones. Once this is completed, the stimuli are linearly transformed from pixel arrays to the lower-dimensional space of cone excitation values, and these are used for the model-fitting (which determines the detailed nonlinear contribution of the cones to the ganglion cell response). A simple linear STA analysis is adequate for the purpose of cone localization because it relies only on each cone providing, on average, a non-zero input to the response of at least one ganglion cell. While there are some classes of subunit nonlinearities that could in principle cause cones to be missed in the STA calculation (e.g. full-wave rectification), in practice most monotonic nonlinearities, including half rectification, which appears to dominate in midget cell responses, will not do so. Note that the <xref ref-type="bibr" rid="bib58">Field et al. (2010)</xref> paper developed this method, and showed that the estimated locations were in close correspondence with anatomical measurements. The use of the STA to estimate cone size/extent is justified because each cone combines the pixel intensities within its aperture approximately linearly (<xref ref-type="bibr" rid="bib62">Schnapf, et al. 1990</xref>, Visual Transduction of Cones in the Monkey). Finally, convolving with the temporal component of the STA primarily served only to align stimulus and response times, and all subsequent aspects of the analysis focused entirely on the spatial component of the response.</p><p>We have clarified and expanded these points in the Methods.</p><p><italic>Relationship to known nonlinearities in midget cells: It is interesting to see such pronounced nonlinearities (subunits) in the receptive fields of a class of retinal ganglion cells (RGCs), the midget cells, which are commonly described as linear (X-like). The paper should do a better job at casting these nonlinearities in the context of the existing knowledge, to point out whether they are consistent with previous findings, or whether they are a surprise. For instance, the paper could describe more extensively the prior literature on linearity/nonlinearity of P cells in the LGN, including several papers by Benardete and Kaplan, by Derrington and Lennie, and at least one by the Movshon laboratory (</italic><xref ref-type="bibr" rid="bib43"><italic>Levitt et al., 2001</italic></xref><italic>, which is cited in the paper). To what extent are those findings consistent with the findings here? (This applies also to differences and similarities between ON and OFF P cells, see next point).</italic></p><p>We agree this is a very important issue. Although the reviewers are presumably advocating for treating the issue in Results, we chose to handle it in the Discussion and continue to favor doing so. There is a developed literature on midget/P-cells and their similarity to cat X-cells. We have reviewed this literature and find that most previous in vivo studies measured frequency doubling in P-cells at eccentricities &lt;10 deg (e.g. <xref ref-type="bibr" rid="bib39">Kaplan and Shapley 1982</xref> and <xref ref-type="bibr" rid="bib43">Levitt et al. 2001</xref>). At these eccentricities, the vast majority of macaque-midget RGCs receive input from just one cone (<xref ref-type="bibr" rid="bib41">Kolb and Marshak 2001</xref>). With a single cone in the receptive field, there is no possibility of a spatial (Y-like) non-linearity in the receptive field center, because the cone integrates light linearly over its collecting aperture (<xref ref-type="bibr" rid="bib62">Schnapf, et al. 1990</xref>, Visual Transduction of Cones in the Monkey). One previous in vivo study in which P-cells were studied over a larger range of eccentricities (0-30 deg) did find midget cells with a substantial second harmonic response to contrast reversing gratings (<xref ref-type="bibr" rid="bib23">Derrington and Lennie 1984</xref>). Although this point was not strongly emphasized in the Abstract, it is clear in the data (<xref ref-type="fig" rid="fig2 fig6">Figures 2 and 6</xref>). The authors did not analyze the magnitude of the second harmonic as a function of eccentricity, but their results appear consistent with those presented here as well as other previous ex vivo studies from the peripheral primate retina (Petrusca et al. 2006, <xref ref-type="bibr" rid="bib12">Cafaro and Rieke 2013</xref>). Our interpretation is that the apparent discrepancy probably results from the fact that midget cells appear X-like when they sample from only one cone, while spatial non-linearies are revealed at eccentricities where they sample from multiple cones. In other words, there is no factual disagreement with the literature, and our results point to a possibly nearly ubiquitous mechanism in RGCs. This point is discussed in detail in the second paragraph of the Discussion.</p><p><italic>Focus on OFF cells: The paper focuses on OFF midget cells, which apparently had the highest signal-to-noise ratio and stability. But what about ON cells? Are they ignored because they are actually linear? In that case, it would help to start the paper with those, and demonstrate linearity. Then go on to the OFF ones and show the nonlinearity. If instead they have more complex nonlinearities, it would help to at least describe them, ideally with a figure.</italic></p><p>The ON-midget cells do not behave linearly. We have found that they also exhibit nonlinear spatial integration, and that the model presented here provided a more accurate prediction of their response to white noise and gratings than an LN model. However, we also find that they exhibit additional complexities within their receptive field that were not observed in OFF-midget cells. Namely, a decrement of light presented to one cone in the receptive field center enhances the response to a simultaneously presented increment presented to another cone (this was not found in any OFF midget cells). We are currently investigating the possibility that this is caused by a RF surround within the subunit, facilitating the response of the RF center of the subunit. To explore this issue fully will require a more sophisticated model, novel fitting approaches, and a collection of additional experiments. Thus we view it as beyond the scope of this manuscript. We feel it would be premature to report the findings on ON-midget cells without a fuller exploration, so we would prefer to leave the above comments out of the manuscript.</p><p><italic>Nature of the large subunits: The reported presence of such large photoreceptor subunits (in contrast to preexisting literature) deserves to be given more prominence, to be discussed more extensively, and ideally to be investigated experimentally. A possible explanation for such large subunits could lie in gap-junction among photoreceptors. Ideally one would test this possibility experimentally, e.g. by adding dopamine D1 agonist or antagonist to modulate the gap-junctional link among photoreceptors (or at least test with the model if cones that are associated in one subunit for an OFF RGC tend to be associated as one subunit for an overlapping ON RGC?). Another possible explanation lies in amacrine cells feeding signals from surrounding bipolar cells. These cells are currently not considered in the model, and might result in single subunits pooling from very large photoreceptors sets in the model. Another possibility, which is not possible to rule out given the way the model is explained, is that some sort of constraint (or minimization) is posed on the number subunits (bipolar cells), leading to artifactually large subunits. Finally, if data are available from a region closer to the fovea, it would be very interesting to see whether the model is able to capture the relationship between 1 photoreceptor – 1 bipolar cell – 1 retinal ganglion cell.</italic></p><p>We thank the reviewers for this comment. There are several possible mechanistic underpinnings of the large receptive field subunits observed for some cells (we assume that the reviewers are referring to <xref ref-type="fig" rid="fig6">Figure 6</xref>). The reviewers suggest testing the role of gap junctions by modulating cone-cone gap junctions with D1 agonist or antagonists. This is an interesting idea and one that is worth pursuing, but it requires an extensive repeat of all the experiments shown here, with the additional complexity of pharmacology and controls, and we view it is beyond the scope of this study. First, it is not clear that dopamine modulates cone-cone gap junctions in the primate retina. Dopamine does not appear to modulate rod-cone gap junctions in the primate retina (Schneeweis and Schnapf 1999) as has been found in lower vertebrates. Second, both D1-like and D2-like receptors have been localized to primate photoreceptors (Zarbin 1986; Dearry 1991), so it is unclear which should be targeted. Finally, dopamine has effects at many locations in the retina (Witkovsky 2004). Knowing how to conclusively interpret the results of manipulating dopamine in the primate retina would require extensive intracellular recordings from photoreceptors, bipolar cells and ganglion cells. In short, understanding the role of dopamine receptor signaling among photoreceptor coupling in the primate retina is a major endeavor.</p><p>The reviewers also suggest analyzing ON and OFF midget cells with overlapping receptive fields; subunit structure that is caused by cone-cone gap junctions would be expected to be common to these two pathways. This is a good suggestion, but (1) as explained above, we’ve elected to leave ON cells out of the paper, and (2) obtaining a data set with relatively complete mosaics of ON and OFF cells is quite difficult (some of the difficulty is due to spike sorting issues). We’d prefer not to delay publication of the current results, which are already well developed and warrant extensive documentation.</p><p>The reviewers also suggest the possibility of amacrine cells. In general, the ∼40 types of amacrine cells in the mammalian retina are considered to be inhibitory in their interaction with bipolar and ganglion cells. It is not clear how they would generate the excitatory subunit structure observed here. However we have added a sentence to the Discussion to acknowledge this possibility.</p><p>Finally, the reviewers also ask whether a constraint on the minimum number of subunits might lead to an overestimation of subunit size. In our model fitting, there is no constraint on subunit structure other than disallowing subunit overlap (each cone belongs to one subunit). In fact, in many retinas and RGCs, there is a one-to-one correspondence between cones and subunits, which means the model finds as many subunits as justified through an increase in explanatory power. Unfortunately, we do not have data from sufficiently close to the fovea to capture the 1 cone – 1 subunit – 1 RGC phenomenon suggested by the reviewers, because the size and density of cells and spikes near the fovea makes spike sorting very difficult.</p><p><italic>Number of subunits: Another result of the model that must be compared with morphological literature (either</italic> <xref ref-type="bibr" rid="bib79"><italic>Wassle et al., 1994</italic></xref> <italic>or</italic> <xref ref-type="bibr" rid="bib41"><italic>Kolb and Marshak, 2003</italic></xref><italic>) is the number of subunits (bipolar cells). This subject is pivotal to understand how the results resemble primates' anatomy. This issue deserves a Figure similar to</italic> <xref ref-type="fig" rid="fig6"><italic>Figure 6D</italic></xref> <italic>and an articulated discussion.</italic></p><p>We thank the reviewers for this comment. Midget bipolar cells dendrites are believed to tile the retina with a coverage factor of 1, and their dendrites do not overlap (<xref ref-type="bibr" rid="bib79">Wassle et al. 1994</xref>, see also Wassle 2009). Thus the number of subunits is determined by the convergence of cones to bipolar cells (the statistic that we report in <xref ref-type="fig" rid="fig6">Figure 6</xref>), and reporting the number of subunits would be redundant with reporting the cone convergence to each subunit. We have added a sentence to the Results to clarify this important point.</p><p><italic>Modeling of nonlinearities: The subunit nonlinearity seems to be modeled as being static, and being the same for all subunits. Any evidence that this is a good assumption? Moreover, can the fits be further improved by imposing a temporal nonlinearity (not just a static one)? For example, direct measurements of glutamate release (imaging of iGluSnFR) in ON layers, revealed that rectification is mild, and that a temporal nonlinearity (transient increases in release) explained nonlinear behavior in postsynaptic ganglion cells (</italic><xref ref-type="bibr" rid="bib8"><italic>Borghuis et al., 2013</italic></xref><italic>). The same might be true in primate midget cells.</italic></p><p>This is an interesting suggestion and worthy of further investigation. It is likely that including temporal nonlinearities would further improve model performance, at the expense of a significant increase in free parameters and fitting complexity. Unfortunately, this would require collecting substantially longer data sets than the ones obtained in this paper. Our goal is to provide an extension of the classical “LNP” model that can be fit to responses to white noise stimuli and that phenomenologically accounts for nonlinear spatial summation. However, this point is important, so we have added a sentence to the Discussion to point out that dynamic nonlinearities likely also play a role in shaping RGC responses.</p><p><italic>In the second paragraph of the subsection “Nonlinear spatial summation in OFF midget RGCs”, the authors should demonstrate the phase dependence of the OFF midget cell responses. This indeed does not follow the rule for Y-like cells and may give insights into the underlying circuitry for generating the nonlinearity. Does the subunit model show similar behavior as the recorded cell? Later in the paragraph, the authors raise the possibility that crossover inhibition may generate differences between midget and parasol cells. This suggestion needs more context/explanation.</italic></p><p>Thank you for this suggestion. The example plots in <xref ref-type="fig" rid="fig5">Figure 5A</xref> suggest some degree of phase dependence in the response. We tried to further quantify this by computing F1 and F2 amplitude for the four presented phases. Although measures of F1 and F2 for both models and data were interpretable (and are reproduced in <xref ref-type="fig" rid="fig8">Author response image 1</xref>, in reply to another comment), responses after splitting up by phase were noisy and difficult to interpret (likely due to the small number of repeats per phase), so we have opted not to include these analyses.</p><p><italic>Single-neuron approach: The way the data are presented, these RGCs could have been measured one at a time. And instead, they were measured all together. This is a missed opportunity. For instance, if some cones are arranged in a subunit for one RGC, does that increase their chance of being arranged as a subunit in another RGC? Along the same lines, does the model help in predicting correlations between different RGCs?</italic></p><p>This is a really interesting point, but may be more applicable to other RGC types. Within each midget cell type (ON and OFF), the bipolar axon terminals form a mosaic, and the receptive fields of neighboring midget RGCs show very little overlap. So there is very little opportunity for shared subunits and indeed we have not seen any to date. Between ON and OFF midget cells, we wouldn’t expect to find shared subunits because they receive input from different bipolar types (ON and OFF midget bipolars, respectively).</p><p><italic>Relationship with measurements in vivo: The authors take the interesting viewpoint that their measurements in vitro are actually closer to being natural than measurements under anesthesia, which may affect the basal release rate and therefore the strength of nonlinearity at the set point. This is a key issue, and if one wanted to prove it one could perhaps add the same anesthetics to the in vitro retina as used during in vivo recordings. The alternative explanation is that it is the in vitro condition that somehow distorts the nonlinearity. The washout of neuromodulators could be a source of variability in ex vivo preps, too. In the absence of experimental data, this issue needs to be treated in a more balanced way, and both possibilities kept open.</italic></p><p>Our intention was not to take a stand that either ex vivo or anesthetized in vivo measurements are closer to being natural, but only to point out that it is difficult to know which is closer to natural, and that more work will be required to determine this (as the reviewers state). We have clarified our language on this issue with new text.</p><p><italic>Room for improvement: It would be useful to better describe room for improvement in the model, if possible. For example, the data in the last figure apparently were difficult to capture with the subunit model (low R2 values), although the model fits in this case were not shown. It would be useful to show both subunit and linear model fits in this figure. Also, a surprising omission from the model is inhibitory cells (e.g., amacrine cells) pooling over larger areas. Is there any evidence that data would be better fit by including them in a model.</italic></p><p>Inhibitory inputs and RF surrounds were not included in the modeling work here. As the reviewers point out, our goal was to develop a model and fitting procedure that capture excitatory spatial subunit structure within the receptive field center. The surround, and particularly the diverse array of amacrine cell types, are of great interest to a deeper understanding retinal processing. But, given their diversity and largely unknown properties, to include their potential effects would require a substantial new set of data, analysis, and modeling. We have added text to the Discussion to make this point and to present clearly all the directions in which the modeling could be extended: neighbor-neighbor interactions, temporal nonlinearities, post-spike filter, RF surround, and inhibitory inputs. The predictive accuracies the reviewers mention (from <xref ref-type="fig" rid="fig7">Figure 7</xref>) are only moderately lower than that obtained for typical midget cells (e.g. <xref ref-type="fig" rid="fig3">Figure 3C</xref>); that difference may be due to the relatively stronger increment-decrement used for evaluating the model, compared to the white noise used to train it, as is now suggested in the text.</p><p><italic>Minor comments:</italic></p><p><italic>The paper states repeatedly that the improvement in predictions made by the model over the LN model is minor. Yet, in responses to gratings it seems major (</italic><xref ref-type="fig" rid="fig5"><italic>Figure 5</italic></xref><italic>). This might be worth emphasizing.</italic></p><p>We didn’t want to overstate the results, but we agree that we could probably be more clear on this point. We have tried to balance the description of the result with new text (subsection “Subunit model more accurately predicts responses to grating stimuli”).</p><p><italic>For instance, when predicting the responses to gratings (</italic><xref ref-type="fig" rid="fig5"><italic>Figure 5</italic></xref><italic>), it would help to see a plot with spatial frequency in the abscissa, and harmonic responses – both first and second – in the ordinate. And curves predicted by the two models.</italic></p><p>We generated the figure suggested by the reviewers (please see <xref ref-type="fig" rid="fig8">Author response image 1</xref>; for three example cells, dashed lines are F2, solid lines are F1, purple is subunit model prediction, green is LN model prediction). These representations of the data confirm that the F1 drops off with spatial frequency whereas the F2 does not, and the subunit model is broadly consistent with this behavior whereas the LN model is not. Although informative, this representation does not add fundamentally to our conclusions, so we would prefer not to add it to the manuscript.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.05241.013</object-id><label>Author response image 1.</label><caption><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.05241.013">http://dx.doi.org/10.7554/eLife.05241.013</ext-link></p></caption><graphic xlink:href="elife-05241-resp-fig1-v1.tif"/></fig></p></body></sub-article></article>