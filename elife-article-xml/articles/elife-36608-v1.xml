<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">36608</article-id><article-id pub-id-type="doi">10.7554/eLife.36608</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Dynamic density shaping of photokinetic <italic>E. coli</italic></article-title></title-group><contrib-group><contrib contrib-type="author" id="author-108868"><name><surname>Frangipane</surname><given-names>Giacomo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1533-4754</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-108869"><name><surname>Dell'Arciprete</surname><given-names>Dario</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-108870"><name><surname>Petracchini</surname><given-names>Serena</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-108578"><name><surname>Maggi</surname><given-names>Claudio</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0033-6287</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-108871"><name><surname>Saglimbeni</surname><given-names>Filippo</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-108872"><name><surname>Bianchi</surname><given-names>Silvio</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-108873"><name><surname>Vizsnyiczai</surname><given-names>Gaszton</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-108874"><name><surname>Bernardini</surname><given-names>Maria Lina</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-108875"><name><surname>Di Leonardo</surname><given-names>Roberto</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5020-0663</contrib-id><email>roberto.dileonardo@uniroma1.it</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Dipartimento di Fisica</institution><institution>Università di Roma &quot;Sapienza&quot;</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Istituto Pasteur-Fondazione Cenci Bolognetti</institution><institution>Università di Roma &quot;Sapienza&quot;</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Soft and Living Matter Laboratory</institution><institution>Institute of Nanotechnology (NANOTEC-CNR)</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Dipartimento di Biologia e Biotecnologie</institution><institution>Università di Roma &quot;Sapienza&quot;</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Barkai</surname><given-names>Naama</given-names></name><role>Senior Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>14</day><month>08</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e36608</elocation-id><history><date date-type="received" iso-8601-date="2018-03-13"><day>13</day><month>03</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2018-07-12"><day>12</day><month>07</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Frangipane et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Frangipane et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-36608-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.36608.001</object-id><p>Many motile microorganisms react to environmental light cues with a variety of motility responses guiding cells towards better conditions for survival and growth. The use of spatial light modulators could help to elucidate the mechanisms of photo-movements while, at the same time, providing an efficient strategy to achieve spatial and temporal control of cell concentration. Here we demonstrate that millions of bacteria, genetically modified to swim smoothly with a light controllable speed, can be arranged into complex and reconfigurable density patterns using a digital light projector. We show that a homogeneous sea of freely swimming bacteria can be made to morph between complex shapes. We model non-local effects arising from memory in light response and show how these can be mitigated by a feedback control strategy resulting in the detailed reproduction of grayscale density images.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.36608.002</object-id><title>eLife digest</title><p>Many bacteria can move in response to environmental signals. This helps guide them towards better conditions for growth and survival. <italic>Escherichia coli</italic> is a bacterium that can swim quickly through liquid, using tiny propeller-like structures that rotate many times per second. These ‘propellers’ are powered by a cellular motor, called the flagellar motor, which similar to an electric motor, requires an energy source to drive movement.</p><p>Proteorhodopsin, a protein originally isolated from free-swimming micro-organisms in the ocean, is an alternative energy source that helps bacteria move. The protein is located close to the surface of the cell, where it acts like a solar panel and captures energy from light. In cells powered by proteorhodopsin, the intensity of light from their environment determines their swimming speed: brighter light means faster movement, and less light, slower movement. Proteorhodopsin is now also a useful tool in the laboratory. For example, genetically engineering bacteria to produce proteorhodopsin provides a way to control their movement remotely, using a light source.</p><p>Swimming bacteria, much like cars in city traffic, are known to accumulate in areas where their speed decreases. By controlling swimming speed with proteorhodopsin, researchers can manipulate the local density of bacteria simply by projecting different patterns of light.</p><p>To study the factors influencing this phenomenon, Frangipane et al. used genetically modified <italic>E. coli</italic> that could respond to light via proteorhodopsin to make layers of cells that could then have light patterns projected onto them. The results showed that the bacteria responded slowly to these stimuli, which was the main factor limiting the resolution of the final pattern they formed. A simple feedback mechanism, which compared the pattern formed by the cells to the desired image and updated the projected light accordingly, was enough to solve this problem. This way, the layers of <italic>E.coli</italic> could be turned into a near-perfect copy of the original image.</p><p>This work allows us to control the movement of large populations of bacteria more precisely than ever before. This could be extremely valuable for building the next generation of microscopic devices. For example, bacteria could be made to surround a larger object such as a machine part or a drug carrier, and then used as living propellers to transport it where it is needed.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>active matter</kwd><kwd>flagellar motility</kwd><kwd>light response</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>307940</award-id><principal-award-recipient><name><surname>Di Leonardo</surname><given-names>Roberto</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The concentration of motile bacteria, expressing a light-driven proton pump, can be precisely controlled in space and time by spatially modulating their swimming speeds with a structured light pattern.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A local reduction of speed in a crowd of walking pedestrians or urban car traffic usually results in the formation of high-density regions. Mathematically speaking, a self-propelled particle, moving by an isotropic random walk with space dependent speed, explores the available space with a probability density that is inversely proportional to the local value of the speed (<xref ref-type="bibr" rid="bib13">Schnitzer, 1993</xref>; <xref ref-type="bibr" rid="bib16">Tailleur and Cates, 2009</xref>; <xref ref-type="bibr" rid="bib5">Cates and Tailleur, 2015</xref>), spending a longer time in slow regions than in fast ones. As a consequence, any mechanism that allows to substantially modulate the local propulsion speed can be used as an efficient strategy for controlling the density (<xref ref-type="bibr" rid="bib15">Stenhammar et al., 2016</xref>). In swimming bacteria, proteorhodopsin (PR) provides a particularly convenient way of achieving spatial speed control through the projection of light patterns. PR is a light-driven proton pump that uses photon energy to pump protons out of the cytoplasm, thus modulating the corresponding electrochemical gradient across the inner membrane (<xref ref-type="bibr" rid="bib4">Béjà et al., 2000</xref>). Since this proton motive force drives the rotation of the flagellar motor (<xref ref-type="bibr" rid="bib7">Gabel and Berg, 2003</xref>), PR puts a ‘solar panel’ on every cell allowing to remotely control its swimming speed with light (<xref ref-type="bibr" rid="bib19">Walter et al., 2007</xref>). This has been recently exploited to control the rotational speeds of bio-hybrid micromachines using bacteria as micropropellers (<xref ref-type="bibr" rid="bib18">Vizsnyiczai et al., 2017</xref>). In light driven Janus colloids, spatially asymmetric speed profiles can also affect particle orientation giving rise to an artificial phototaxis mechanism (<xref ref-type="bibr" rid="bib9">Lozano et al., 2016</xref>). <xref ref-type="bibr" rid="bib1">Arlt et al. (2018)</xref> have recently shown that, by projecting a masked illumination pattern, ‘photokinetic’ (<xref ref-type="bibr" rid="bib20">Wilde and Mullineaux, 2017</xref>) bacteria can be accumulated in dark regions and depleted from brighter ones thus forming binary patterns. Here we demonstrate that bacterial density can be controlled to form reconfigurable complex patterns. To do this we exploit a Digital Light Processing (DLP) projector to shape light with a megapixel resolution and with a dynamic range of 256 (8 bit) light intensity levels. We experimentally investigate the limits of validity of the predicted law of inverse proportionality between local density and speed. We demonstrate that observed deviations from this law can be quantitatively described by a theoretical model that explicitly takes into account memory effects in light response. Finally we show that a model independent feedback control loop allows density shaping with high spatial resolution and gray level accuracy.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>Density shaping in photokinetic bacteria or colloids relies on the connection between density and local speed. The density <inline-formula><mml:math id="inf1"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is always a steady-state solution of the master equation of a self-propelled particle with isotropic reorientation dynamics and spatially varying speed <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib5">Cates and Tailleur, 2015</xref>). In our case, <inline-formula><mml:math id="inf3"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the position in the two dimensional image space and <inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the light intensity at <inline-formula><mml:math id="inf6"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula>. This result assumes that all bacteria have the same response to light and that they instantaneously adapt to intensity variations so that the speed only depends on the local value of <inline-formula><mml:math id="inf7"><mml:mi>I</mml:mi></mml:math></inline-formula>. However, suspensions of swimming bacteria, are known to be characterized by motility properties that occur in broad distributions and, in principle, a broad spectrum of light responses could be found. To quantify the effect of light on the speed distributions of our strain, we monitored bacterial dynamics while projecting a chessboard pattern consisting of 12 different levels of light intensity. To do this we couple a DLP projector to a custom video-microscopy setup working in both bright-field and dark-field mode (see <xref ref-type="fig" rid="fig1">Figure 1</xref> and Materials and methods).</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.36608.003</object-id><label>Figure 1.</label><caption><title>Scheme of the experimental setup.</title><p>Schematic representation of the custom inverted-microscope used in the experiments (see Materials and methods). Green light from a DMD based DLP projector is filtered by a bandpass filter F1 (central wavelength 520 nm) and than coupled to the microscope objective through a dichroic mirror (DM). A long pass filter (F2) prevents illumination light to reach the camera. Bacteria are sealed in a square microcapillary glued on a metallic sample holder with a circular aperture.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-36608-fig1-v1"/></fig><p>Using differential dynamic microscopy (DDM) (<xref ref-type="bibr" rid="bib6">Cerbino and Trappe, 2008</xref>; <xref ref-type="bibr" rid="bib21">Wilson et al., 2011</xref>; <xref ref-type="bibr" rid="bib11">Maggi et al., 2013</xref>) we extract the light dependent values of the mean <inline-formula><mml:math id="inf8"><mml:mi>v</mml:mi></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf9"><mml:mi>σ</mml:mi></mml:math></inline-formula> of the speed distributions (<xref ref-type="fig" rid="fig2">Figure 2(a)</xref>) (see Materials and methods). Although the absolute value of the swimming speed depends on several factors (strain, growth medium, etc.) we find a non linear speed response that is consistent with what previously reported for PR expressing bacteria. In particular the speed versus intensity curve is very well fitted by a hyperbola showing saturation for large light intensity values as already reported in (<xref ref-type="bibr" rid="bib19">Walter et al., 2007</xref>; <xref ref-type="bibr" rid="bib14">Schwarz-Linek et al., 2016</xref>; <xref ref-type="bibr" rid="bib18">Vizsnyiczai et al., 2017</xref>; <xref ref-type="bibr" rid="bib1">Arlt et al., 2018</xref>).</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.36608.004</object-id><label>Figure 2.</label><caption><title>Light dependent speed distribution.</title><p>(<bold>a</bold>) Mean value <inline-formula><mml:math id="inf10"><mml:mi>v</mml:mi></mml:math></inline-formula> (circles) and standard deviation <inline-formula><mml:math id="inf11"><mml:mi>σ</mml:mi></mml:math></inline-formula> (squares) of bacterial speeds as a function of light power density. Symbols and error bars are respectively the mean and standard deviation of 14 repeated measurements of <inline-formula><mml:math id="inf12"><mml:mi>v</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf13"><mml:mi>σ</mml:mi></mml:math></inline-formula>. Curves are fits with hyperbolas. (<bold>b</bold>) Parametric plot of <inline-formula><mml:math id="inf14"><mml:mi>σ</mml:mi></mml:math></inline-formula><italic>vs</italic><inline-formula><mml:math id="inf15"><mml:mi>v</mml:mi></mml:math></inline-formula>. The line is a linear fit passing through zero.</p><p><supplementary-material id="fig2sdata1"><object-id pub-id-type="doi">10.7554/eLife.36608.005</object-id><label>Figure 2—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2">Figure 2</xref></title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-36608-fig2-data1-v1.csv"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-36608-fig2-v1"/></fig><p>We also find that, throughout the intensity range, <inline-formula><mml:math id="inf16"><mml:mi>v</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf17"><mml:mi>σ</mml:mi></mml:math></inline-formula> are directly proportional (see <xref ref-type="fig" rid="fig2">Figure 2(b)</xref>) suggesting a homogeneous growth law for individual cell speeds <inline-formula><mml:math id="inf18"><mml:mrow><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf19"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup></mml:math></inline-formula> is the saturation speed for the <inline-formula><mml:math id="inf20"><mml:mi>i</mml:mi></mml:math></inline-formula>-th cell and <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a dimensionless function saturating at one for large intensities. Interestingly, in this scenario, the mean speed <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> will also be proportional to <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> so that the probability density <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> for the generic <inline-formula><mml:math id="inf25"><mml:mi>i</mml:mi></mml:math></inline-formula>-th cell will be proportional to the inverse of the local mean speed:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>∝</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This implies that, despite broad speed distributions, the local density is expected to be only determined by the mean local speed, as set by the light intensity pattern and measured by DDM. To validate this hypothesis we use a DLP projector to display a complex light pattern onto a 400 µm thick layer of cells (<xref ref-type="fig" rid="fig1">Figure 1</xref>) that have been preliminarily exposed to a uniform bright illumination for 5 min. This time is much longer than the speed response time of bacteria (Figure 4) thus ensuring that cells are initialized to swim at maximal speed. The projecting system has an optical resolution of 2 µm approximately matching the size of a single cell which represents the physical ‘pixel’ of our density images. This value sets the limit for the minimum theoretical resolution of density configurations that would be achievable if bacteria could be precisely and statically arranged in space. In practice, as we will see, the real resolution will always be larger for two main reasons: (i) bacteria do not respond instantly to light temporal variations thus introducing a blur in the target speed map, (ii) the stationary state is an ensemble of noisy patterns that constantly fluctuate because of swimming and Brownian motions of bacteria. After projecting an inverted Mona Lisa image, bacteria start to concentrate in dark regions while moving out from the more illuminated areas. After about 4 min, dark field microscopy reveals a recognizable bacterial ‘replica’ of Leonardo’s painting, where brighter areas correspond to regions of accumulated cells. Once a stationary pattern is reached, we collect a time averaged image from which we extract the bacterial density <inline-formula><mml:math id="inf26"><mml:msup><mml:mi>ρ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> normalized to be one when uniform (see Materials and methods).</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.36608.006</object-id><label>Figure 3.</label><caption><title>Shaping density with light.</title><p>(<bold>a</bold>) Dark-field microscopy image of the sample obtained after projecting a static light pattern for 4 min (averaged for 2 min). Scale bar 100 µm. (<bold>b</bold>) Local speed map obtained by interpolating the data-points of <xref ref-type="fig" rid="fig2">Figure 2(a)</xref> at the values of the local (projected) light intensity pattern. (<bold>c</bold>) The circles represent the mean value of the normalized sample density over image pixels corresponding to the same light intensity, plotted as a function of the corresponding inverse local speed. The dashed line is a linear fit of the high-speed points. The error bars are the standard deviation of the density at the same value of the computed inverse average speed. Solid line represent the prediction from the memory blur model described in the text.</p><p><supplementary-material id="fig3sdata1"><object-id pub-id-type="doi">10.7554/eLife.36608.007</object-id><label>Figure 3—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig3">Figure 3</xref></title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-36608-fig3-data1-v1.csv"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-36608-fig3-v1"/></fig><p>We split the density image into components corresponding to the same illumination level <inline-formula><mml:math id="inf27"><mml:mi>I</mml:mi></mml:math></inline-formula>. We then average the density within each component and report in <xref ref-type="fig" rid="fig3">Figure 3(c)</xref> the obtained value as a function of the inverse mean speed <inline-formula><mml:math id="inf28"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> obtained from the speed <italic>vs</italic> intensity curve in <xref ref-type="fig" rid="fig2">Figure 2(a)</xref>. The high speed side of the graph can be very well fitted by a straight line with a finite intercept <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. This suggests that 50% of the total scattering objects in the field of view responds to light and can be spatially modulated while the remaining 50% can be attributed to cells which are non-motile or insensitive to light and also to stray light generated away from the focal plane. The ratio between the maximum and minimum modulation of the light sensitive component can be obtained as <inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mtext>min</mml:mtext></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. A strong deviation from linearity is evident in the high density/low speed region. A violation of the <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>∝</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> law can be attributed to many factors that are not included in the simple theory discussed above. In particular, the theory assumes that speed is a local function of space which would only be the case if bacteria instantly adapt to temporal changes in light intensity. However, previous studies have evidenced that speed response is not instantaneous but it displays a relaxation pattern characterized by multiple timescales. In addition to a fast relaxation time associated to the membrane discharge (<xref ref-type="bibr" rid="bib19">Walter et al., 2007</xref>), ATP synthase and the dynamics of stator units of the flagellar motors introduce slower timescales in the speed relaxation dynamics (<xref ref-type="bibr" rid="bib17">Tipping et al., 2013</xref>; <xref ref-type="bibr" rid="bib1">Arlt et al., 2018</xref>). Using DDM we measured speed response to a uniform light pattern whose intensity switches between two values every 100 s. Results are reported in <xref ref-type="fig" rid="fig4">Figure 4</xref> and clearly show the presence of two timescales. The short time scale is smaller than our time resolution (1 s) and appears as an instantaneous jump that accounts for about a fraction <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.44</mml:mn></mml:mrow></mml:math></inline-formula> of the total relaxation. A slower relaxation follows and it is well fitted by an exponential function with a time constant <inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math></inline-formula> s that is the same for both the rising and falling relaxations. As a result, bacteria will experience an effective speed map that is a blurred version of what we would expect for an instantaneous response <inline-formula><mml:math id="inf34"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. In the case of smooth swimming cells, with a two-step light response, we calculate that, for weak speed modulations around a baseline value <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, the actual speed map can be obtained as a simple convolution (see Materials and methods):</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.36608.008</object-id><label>Figure 4.</label><caption><title>Speed response to light step.</title><p>Average bacteria speeds as a function of time during periodic illumination with a square wave of period 200 s. Open circles represent experimental data averaged over eight periods while solid line is a fit with a step response followed by an exponential relaxation.</p><p><supplementary-material id="fig4sdata1"><object-id pub-id-type="doi">10.7554/eLife.36608.009</object-id><label>Figure 4—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig4">Figure 4</xref></title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-36608-fig4-data1-v1.csv"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-36608-fig4-v1"/></fig><p><disp-formula id="equ2"><label>(1)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> a convolution kernel that is analytic in Fourier space:<disp-formula id="equ3"><label>(2)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> is the modulus of the wave vector and <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Assuming that the stationary distribution will remain isotropic even in the presence of memory, the relation <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>∝</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> will then still be valid provided one uses the actual, blurred speed map <inline-formula><mml:math id="inf40"><mml:mi>w</mml:mi></mml:math></inline-formula> and not the original map <inline-formula><mml:math id="inf41"><mml:mi>V</mml:mi></mml:math></inline-formula> corresponding to instantaneous response. We can then anticipate the stationary density once we calculate the actual speed map <inline-formula><mml:math id="inf42"><mml:mi>w</mml:mi></mml:math></inline-formula> with the convolution formula (1). Recalling that only a fraction <inline-formula><mml:math id="inf43"><mml:mi>α</mml:mi></mml:math></inline-formula> of cells is motile the estimated normalized stationary density will be<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mover><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula> is the spatial average of the inverse actual speed <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Plotting <inline-formula><mml:math id="inf46"><mml:msup><mml:mi>ρ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf47"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> we find that this simple model quantitatively explains the density behavior in <xref ref-type="fig" rid="fig3">Figure 3</xref> with the natural choice of free parameters <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.44</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf50"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>59</mml:mn></mml:mrow></mml:math></inline-formula> µm where <inline-formula><mml:math id="inf51"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is the spatial average of <inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This result is certainly encouraging and prompts for a deeper and more systematic investigation using simpler light patterns. Our aim here, however, is to investigate the resolution limits of density shaping with photokinetic bacteria. Although memory effects could be reduced by deleting ATP-synthase genes (<xref ref-type="bibr" rid="bib1">Arlt et al., 2018</xref>), resulting in a suppression of the slow component in speed relaxation, response will never be truly instantaneous. In addition to memory effects, steric and/or hydrodynamic interactions will always affect density by hindering bacteria penetration and further accumulation in densely packed regions. The combined action of these effects on the stationary density map cannot be easily incorporated in a theoretical model that provides precise quantitative predictions with a priori known parameters.</p><p>An alternative and more practical strategy to improve the accuracy of density shaping, is to implement a feedback control loop. We set up an automated control loop that performs one iteration every 20 s, comparing the current density map to the desired target image and updating the illumination pattern accordingly (see Materials and methods). Light levels are increased in those regions with a density that exceeds the target value and decreased where density is lower. At each step the light intensity increment is simply proportional to the pixel by pixel difference of target and actual density images. We quantify the distance between the obtained density pattern and the target image by the sum of the squared pixel-by-pixel difference after a proper rescaling procedure (see Materials and methods).</p><p>As soon as the feedback is turned on at time <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula> min (<xref ref-type="fig" rid="fig5">Figure 5(a)</xref>) the distance from the target starts to decrease reaching a new stationary value after about 4 min. The final stationary density map shows a level of detail significantly higher than the image obtained before the feedback was turned on (<xref ref-type="fig" rid="fig5">Figure 5(b,c)</xref>). The image is stable and resolution does not deteriorate for hours. However a dark region surrounds the illuminated area so that swimming cells that exit the field of view do not come back and the number of motile cells in the illuminated area is reduced by about 50% in one hour. This issue is the main limiting factor for the lifetime of our patterns and could be solved in the future by using sample chambers that match the size of the illuminated area. As evidenced in <xref ref-type="fig" rid="fig5">Figure 5(d)</xref>, the feedback precompensates this blurring effect due to memory by converging to a sharpened version of the initial target image. Results of comparable quality have been replicated four times in each of the two independent biological replicates.</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.36608.010</object-id><label>Figure 5.</label><caption><title>Improved density control with a feedback loop.</title><p>(<bold>a</bold>) Time evolution of the distance from the target normalized to the initial value (circles) before and after activating the feedback loop (gray area). The yellow and green bars indicate the time interval over which we average the density maps (shown in (<bold>b</bold>)) before and after feedback respectively. The full curve is a fit with a double exponential. (<bold>b</bold>) Comparison of the density map obtained by averaging for 2 min before (top) and after the feedback loop has been turned on (bottom) (see colored bars in (<bold>a</bold>)). (<bold>c</bold>) Time averaged density profile (6 min) with feedback on. (<bold>d</bold>) Projected light intensity patterns at <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (left) and after feedback optimization (right). Scale bars are 100 µm.</p><p><supplementary-material id="fig5sdata1"><object-id pub-id-type="doi">10.7554/eLife.36608.011</object-id><label>Figure 5—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig5">Figure 5</xref></title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-36608-fig5-data1-v1.csv"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-36608-fig5-v1"/></fig><p>A remarkable feature of this optically controlled material lays in its intrinsic dynamic and reconfigurable nature. As a demonstration of this property we show the dynamic morphing of a bacterial layer from an Albert Einstein’s to a Charles Darwin’s portrait (see <xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="video" rid="video1">Video 1</xref>). The morphing is triggered by instantly switching between the two target images on the DLP projector and exponentially converges to the second target in a characteristic time of 1.8 min.</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.36608.012</object-id><label>Figure 6.</label><caption><title>Reconfigurable density patterns.</title><p>Starting from the stationary density modulation (<bold>a</bold>) we switch to a new light pattern at time 0 and record the density distribution of bacteria as it morphs through the intermediate state (<bold>b</bold>) and reaches the final state (<bold>c</bold>). (<bold>d</bold>) Time evolution of the normalized squared distances between instantaneous density maps and the initial (blue circles) and final (orange circles) targets. Curves are exponential fits.</p><p><supplementary-material id="fig6sdata1"><object-id pub-id-type="doi">10.7554/eLife.36608.013</object-id><label>Figure 6—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig6">Figure 6</xref></title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-36608-fig6-data1-v1.csv"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-36608-fig6-v1"/></fig><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-36608-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.36608.014</object-id><label>Video 1.</label><caption><title>The video shows the dynamic morphing of a layer of photokinetic bacteria from an Albert Einstein's to a Charles Darwin's portrait (total time 5 min).</title></caption></media></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Although light induced density modulations can be achieved in large samples of Brownian (passive) colloidal systems, active materials provide a largely superior performance in terms of both required power and response time. The stationary density distribution of Brownian colloids is governed by the Boltzmann law stating that the logarithmic ratio of maximum to minimum density is given by<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>ρ</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:msub><mml:mi>ρ</mml:mi><mml:mi>min</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mpadded></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> is the optical energy difference between brightest and darkest regions. For a plastic or glass bead of radius <inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mpadded width="+2.8pt"><mml:mn>1</mml:mn></mml:mpadded></mml:mrow></mml:math></inline-formula>µm in water, this energy difference can be estimated in the Rayleigh regime as (<xref ref-type="bibr" rid="bib2">Ashkin et al., 1986</xref>) <inline-formula><mml:math id="inf57"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>U</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf58"><mml:mi>I</mml:mi></mml:math></inline-formula> is the maximum power density and <inline-formula><mml:math id="inf59"><mml:mi>c</mml:mi></mml:math></inline-formula> is the speed of light. For a contrast level comparable to the ones shown above, <inline-formula><mml:math id="inf60"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>min</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the required power density would be <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>I</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> W/mm<inline-formula><mml:math id="inf62"><mml:msup><mml:mi/><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. This value is three orders of magnitude larger than the maximum power densities used in our experiments. Our active system is also much faster than its Brownian counterprt as evidenced by comparing the timescales of pattern formation. In both the active and passive case, dynamics is governed by the interplay of diffusion and drift with characteristic timescales <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>τ</mml:mi><mml:mi>diff</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>τ</mml:mi><mml:mi>drift</mml:mi></mml:msub></mml:math></inline-formula>. Calling <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> mm the largest length scale in the target pattern, we obtain for the active case <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>drift</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula> s where we used <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> µm/s as the typical swimming speed. A diffusion time scale can be obtained as <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>diff</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf69"><mml:mi>D</mml:mi></mml:math></inline-formula> is the active translational diffusion coefficient. For wild type bacteria, moving with a run and tumble dynamics, <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mtext>run</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>run</mml:mtext></mml:msub><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> s is the mean duration of a run. The corresponding characteristic diffusion time is <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>diff</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> s. This timescale can be considerably reduced if, as in our case, we suppress tumbling and use a smooth swimming strain with a much larger reorientation time <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>rot</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula>20 s (<xref ref-type="bibr" rid="bib3">Berg, 1993</xref>). In this case the diffusion timescale drops down to <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>diff</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> s leading to a faster relaxation towards the stationary state. In the Brownian case the drift timescale is given by <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>drift</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">ℓ</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula>10<inline-formula><mml:math id="inf76"><mml:msup><mml:mi/><mml:mn>6</mml:mn></mml:msup></mml:math></inline-formula> s where <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> µm/s pN is the mobility of a 1 µm radius microsphere. The same colloidal particle has a diffusivity <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> µm<inline-formula><mml:math id="inf79"><mml:msup><mml:mi/><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>/s giving again <inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>diff</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:msup><mml:mn> 10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> s. Summarizing, using optical forces to achieve a comparable density modulation for Brownian particles would require a thousand times larger powers and from <inline-formula><mml:math id="inf81"><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:math></inline-formula> to <inline-formula><mml:math id="inf82"><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:math></inline-formula> longer times.</p><p>In conclusion, we have shown that a suspension of swimming bacteria, with optically controllable speed, can provide a new class of light controllable active materials whose density can be accurately, reversibly and quickly shaped by employing a low power light projector. An alternative strategy to produce static patterns of bacteria is by ‘biofilm lithography’ where an optical template of blue light is used to induce the expression of membrane proteins that promote cell-cell and cell-substrate attachment (<xref ref-type="bibr" rid="bib8">Jin and Riedel-Kruse, 2018</xref>). As opposed to our motility driven density shaping, these patterns are static and form over a time scale of several hours. Interestingly, the two techniques could be used in combination to achieve faster and more complex (e.g. three dimensional) biofilm lithography by fixing with blue light a template pattern obtained by speed modulation with green light. By further genetic engineering, bacteria could be eventually encapsulated in silicate shells (<xref ref-type="bibr" rid="bib12">Müller et al., 2008</xref>) producing solid permanent structures for micro-mechanics or micro-optics applications. Finally, the possibility of spatial and temporal control of motile bacteria density could also lead to novel strategies for the transport and manipulation of small cargoes inside microdevices <xref ref-type="bibr" rid="bib10">Maggi et al. (2018)</xref>.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Production of photokinetic cells</title><p>For all the experiments we used the <italic>E. coli</italic> strain HCB437 (<xref ref-type="bibr" rid="bib22">Wolfe et al., 1987</xref>) transformed with a plasmid encoding the PR under the control of the araC-pBAD promoter (Biobricks, BBa_K1604010 inserted in pSB1C3 plasmid backbone). <italic>E. coli</italic> colonies from frozen stocks are grown overnight at 33<inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>C on LB agar plates supplemented with kanamycin (Kan 30 µg/mL) and chloramphenicol (Cam 20 µg/mL). A single colony is picked and statically cultivated overnight at 33<inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>C in 10 mL of M9 broth (M9 salts with 0.2% glucose, 0.2% casaminoacids) supplemented with antibiotics as before. The overnight culture is diluted 100-fold into 5 mL of the previous medium, grown at 33<inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>C, 200 rpm. 5 mM arabinose and 20 µM retinal are added once OD<sub>590</sub> ≈ 0.2, keeping the culture in the dark to avoid retinal degradation. Once OD<sub>590</sub> ≈ 0.8, cells are collected by centrifugation (1500 rcf, 5’). The resulting pellet is washed twice by centrifugation (1500 rcf, 5’) with motility buffer (MB: 0.1 mM EDTA, 10 mM phosphate buffer and 0.2% Tween20). The bacterial suspension is eventually adjusted to a working OD<inline-formula><mml:math id="inf86"><mml:mmultiscripts><mml:mo>≈</mml:mo><mml:mprescripts/><mml:mn>590</mml:mn><mml:none/></mml:mmultiscripts></mml:math></inline-formula> 2.0.</p></sec><sec id="s4-2"><title>Sample preparation</title><p>100 µL of the prepared bacterial suspension is injected into a glass capillary (CM Scientific - Rect. boro capillaries 0.40 <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 4 mm), sealed at both sides with vacuum grease (Sigma-Aldrich). The capillary is then placed under the optical microscope and observed in bright and dark field illumination focusing on the plane in the middle of the capillary.</p></sec><sec id="s4-3"><title>Optics</title><p>Bright field and dark field imaging were performed using a custom inverted optical microscope equipped with a 4 <inline-formula><mml:math id="inf88"><mml:mo rspace="5.3pt">×</mml:mo></mml:math></inline-formula> magnification objective (Nikon; NA = 0.13) and a high-sensitivity CMOS camera (Hamamatsu Orca-Flash 2.8) (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). Light shaping was performed using a digital light processing (DLP) projector (Texas Instruments DLP Lightcrafter 4500) coupled to the same microscope objective used for imaging. The size of a (squared) DLP projector pixel imaged on the sample plane results to be 2 µm. All dark-field images have been divided by the flat field image obtained by applying a Gaussian filter on the respective homogeneous bacterial suspension (under uniform green illumination) as detailed in the following. Flat back-ground subtraction (fifth percentile of the image histogram) was only applied to the frames appearing in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p></sec><sec id="s4-4"><title>Differential Dynamic Microscopy (DDM)</title><p>To perform DDM we compute the quantity:<disp-formula id="equ6"><label>(4)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐪</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐪</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐪</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐪</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the spatial Fourier transform at the wave-vector <inline-formula><mml:math id="inf90"><mml:mi mathvariant="bold">𝐪</mml:mi></mml:math></inline-formula> of the bright-field image captured at time <inline-formula><mml:math id="inf91"><mml:mi>t</mml:mi></mml:math></inline-formula>. Assuming time-translational invariance and isotropy in the bacterial movement <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐪</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depends only on the time-lag <inline-formula><mml:math id="inf93"><mml:mi>t</mml:mi></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ6">Equation (4)</xref> and on the modulus of the wave vector <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">𝐪</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, that is <inline-formula><mml:math id="inf95"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐪</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is connected to the intermediate scattering function (ISF) <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ7"><label>(5)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are time-independent factors related, respectively, to the number and shape of bacteria, and to the background noise in the images. Following <xref ref-type="bibr" rid="bib21">Wilson et al., 2011</xref> we use the ISF model for independent smooth swimming cells:<disp-formula id="equ8"><label>(6)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mi>F</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>𝑑</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mpadded></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo rspace="5.3pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>sinc</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf100"><mml:mi>α</mml:mi></mml:math></inline-formula> is the fraction of motile cells, <inline-formula><mml:math id="inf101"><mml:mi>D</mml:mi></mml:math></inline-formula> the Brownian diffusion coefficient and <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the Schultz distribution:<disp-formula id="equ9"><label>(7)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>v</mml:mi></mml:mfrac></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mfrac><mml:mrow><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>v</mml:mi></mml:mfrac></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf103"><mml:mi>v</mml:mi></mml:math></inline-formula> is the mean speed, <inline-formula><mml:math id="inf104"><mml:mi mathvariant="normal">Γ</mml:mi></mml:math></inline-formula> is the Euler gamma function and <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is related to the speed standard deviation <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> by the formula <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>σ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The relevant parameters discussed in the main text <inline-formula><mml:math id="inf108"><mml:mi>v</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf109"><mml:mi>σ</mml:mi></mml:math></inline-formula> are extracted by fitting the experimental <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in the <inline-formula><mml:math id="inf111"><mml:mi>q</mml:mi></mml:math></inline-formula>-range 0.45 μm<sup>-1</sup>&lt;q&lt;1.2 μm<sup>-1</sup>with <xref ref-type="disp-formula" rid="equ7 equ8 equ9">Equations 5, 6 and 7</xref>.</p></sec><sec id="s4-5"><title>Image analysis</title><p>We assume that dark field images are proportional to the bacterial density modulated by a slowly varying envelope due to inhomogeneities in illumination. This flat field correction <inline-formula><mml:math id="inf112"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is obtained by acquiring 100 frames at 25 fps at the beginning of the experiments when the bacterial density is homogeneous. These frames are averaged and then filtered with a Gaussian kernel with a large standard deviation (<inline-formula><mml:math id="inf113"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mpadded width="+1.7pt"><mml:mn>100</mml:mn></mml:mpadded></mml:mrow></mml:math></inline-formula>µm). The normalized experimental density <inline-formula><mml:math id="inf114"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is obtained by first computing a raw density field <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (50 frames average at 25 fps) and then dividing by <inline-formula><mml:math id="inf116"><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>, that is <inline-formula><mml:math id="inf117"><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>For computing the distance between <inline-formula><mml:math id="inf118"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the target density <inline-formula><mml:math id="inf119"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi>tar</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> we first rescale <inline-formula><mml:math id="inf120"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> so that the 10-th and 90-th percentile of the two image histograms coincide:<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>90</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow><mml:mi>tar</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow><mml:mi>tar</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>90</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mpadded width="+1.7pt"><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>10</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow><mml:mi>tar</mml:mi></mml:msubsup></mml:mpadded></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The distance <inline-formula><mml:math id="inf121"><mml:mi>𝖽𝗂𝗌𝗍</mml:mi></mml:math></inline-formula> is then computed as:<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mi>𝖽𝗂𝗌𝗍</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi>tar</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math></disp-formula>where the sum runs over the image pixels <inline-formula><mml:math id="inf122"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-6"><title>Modeling the effects of memory in speed response</title><p>A smooth swimming cell with a two-step response to light intensity and traveling in the <inline-formula><mml:math id="inf123"><mml:mi>x</mml:mi></mml:math></inline-formula> direction over a light imposed speed profile <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, will have an actual speed at time <inline-formula><mml:math id="inf125"><mml:mi>t</mml:mi></mml:math></inline-formula> given by:<disp-formula id="equ12"><label>(8)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo rspace="5.3pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the position of the cell at time <inline-formula><mml:math id="inf127"><mml:mi>t</mml:mi></mml:math></inline-formula>. For a weakly varying speed profile <inline-formula><mml:math id="inf128"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> we can transform the above time convolution into a space convolution by assuming <inline-formula><mml:math id="inf129"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ13"><label>(9)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where we have also assumed that an equal number of bacteria will be traveling in the opposite direction. Assuming isotropy and using the fact that, in the weak modulation limit, density is homogeneous at the zero order, we can easily generalize to the three dimensional case and write:<disp-formula id="equ14"><label>(10)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf130"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo rspace="5.3pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a 3D convolution kernel. Our projecting light system is such that light patterns do not vary significantly across the entire sample depth so that we can assume <inline-formula><mml:math id="inf131"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and express the effective speed distribution as a 2D convolution<disp-formula id="equ15"><label>(11)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf132"><mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Although the convolution kernel <inline-formula><mml:math id="inf133"><mml:mi>γ</mml:mi></mml:math></inline-formula> is not analytic in real space, its Fourier transform is analytic making convolutions easy to calculate numerically:<disp-formula id="equ16"><label>(12)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mi>k</mml:mi><mml:mi>q</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s4-7"><title>Feedback</title><p>The <inline-formula><mml:math id="inf135"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-th illumination pattern at the pixel <inline-formula><mml:math id="inf136"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> is updated as follows:<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>P</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is a proportional control parameter and <inline-formula><mml:math id="inf138"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi></mml:mrow></mml:math></inline-formula> is the difference between the scaled density and the target density:<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi>tar</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>If, for example, the scaled density is larger than the target at <inline-formula><mml:math id="inf139"><mml:mi mathvariant="bold">𝐫</mml:mi></mml:math></inline-formula> the projected power density at that pixel will be increased. That will increase the speed of bacteria and consequently reduce their local density.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The research leading to these results has received funding from the European Research Council under the European Union’s Seventh Framework Programme (FP7/2007-2013)/ERC grant agreement no. 307940.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Investigation, Methodology, Writing—original draft</p></fn><fn fn-type="con" id="con2"><p>Investigation, Methodology, Writing—original draft</p></fn><fn fn-type="con" id="con3"><p>Investigation, Methodology</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Formal analysis, Investigation, Writing—original draft</p></fn><fn fn-type="con" id="con5"><p>Data curation, Methodology</p></fn><fn fn-type="con" id="con6"><p>Software, Methodology</p></fn><fn fn-type="con" id="con7"><p>Software, Methodology</p></fn><fn fn-type="con" id="con8"><p>Supervision, Methodology</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Formal analysis, Supervision, Investigation, Methodology, Writing—original draft</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.36608.015</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-36608-transrepform-v1.pdf"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arlt</surname> <given-names>J</given-names></name><name><surname>Martinez</surname> <given-names>VA</given-names></name><name><surname>Dawson</surname> <given-names>A</given-names></name><name><surname>Pilizota</surname> <given-names>T</given-names></name><name><surname>Poon</surname> <given-names>WCK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Painting with light-powered bacteria</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>768</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03161-8</pub-id><pub-id pub-id-type="pmid">29472614</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashkin</surname> <given-names>A</given-names></name><name><surname>Dziedzic</surname> <given-names>JM</given-names></name><name><surname>Bjorkholm</surname> <given-names>JE</given-names></name><name><surname>Chu</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Observation of a single-beam gradient force optical trap for dielectric particles</article-title><source>Optics Letters</source><volume>11</volume><fpage>288</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1364/OL.11.000288</pub-id><pub-id pub-id-type="pmid">19730608</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="1993">1993</year><source>Random Walks in Biology</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Béjà</surname> <given-names>O</given-names></name><name><surname>Aravind</surname> <given-names>L</given-names></name><name><surname>Koonin</surname> <given-names>EV</given-names></name><name><surname>Suzuki</surname> <given-names>MT</given-names></name><name><surname>Hadd</surname> <given-names>A</given-names></name><name><surname>Nguyen</surname> <given-names>LP</given-names></name><name><surname>Jovanovich</surname> <given-names>SB</given-names></name><name><surname>Gates</surname> <given-names>CM</given-names></name><name><surname>Feldman</surname> <given-names>RA</given-names></name><name><surname>Spudich</surname> <given-names>JL</given-names></name><name><surname>Spudich</surname> <given-names>EN</given-names></name><name><surname>DeLong</surname> <given-names>EF</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Bacterial rhodopsin: evidence for a new type of phototrophy in the sea</article-title><source>Science</source><volume>289</volume><fpage>1902</fpage><lpage>1906</lpage><pub-id pub-id-type="doi">10.1126/science.289.5486.1902</pub-id><pub-id pub-id-type="pmid">10988064</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cates</surname> <given-names>ME</given-names></name><name><surname>Tailleur</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Motility-Induced phase separation</article-title><source>Annual Review of Condensed Matter Physics</source><volume>6</volume><fpage>219</fpage><lpage>244</lpage><pub-id pub-id-type="doi">10.1146/annurev-conmatphys-031214-014710</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cerbino</surname> <given-names>R</given-names></name><name><surname>Trappe</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Differential dynamic microscopy: probing wave vector dependent dynamics with a microscope</article-title><source>Physical Review Letters</source><volume>100</volume><elocation-id>188102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.100.188102</pub-id><pub-id pub-id-type="pmid">18518417</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gabel</surname> <given-names>CV</given-names></name><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The speed of the flagellar rotary motor of Escherichia coli varies linearly with protonmotive force</article-title><source>PNAS</source><volume>100</volume><fpage>8748</fpage><lpage>8751</lpage><pub-id pub-id-type="doi">10.1073/pnas.1533395100</pub-id><pub-id pub-id-type="pmid">12857945</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname> <given-names>X</given-names></name><name><surname>Riedel-Kruse</surname> <given-names>IH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Biofilm lithography enables high-resolution cell patterning via optogenetic adhesin expression</article-title><source>PNAS</source><volume>115</volume><fpage>3698</fpage><lpage>3703</lpage><pub-id pub-id-type="doi">10.1073/pnas.1720676115</pub-id><pub-id pub-id-type="pmid">29555779</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lozano</surname> <given-names>C</given-names></name><name><surname>Ten Hagen</surname> <given-names>B</given-names></name><name><surname>Löwen</surname> <given-names>H</given-names></name><name><surname>Bechinger</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Phototaxis of synthetic microswimmers in optical landscapes</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>12828</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms12828</pub-id><pub-id pub-id-type="pmid">27687580</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maggi</surname> <given-names>C</given-names></name><name><surname>Angelani</surname> <given-names>L</given-names></name><name><surname>Frangipane</surname> <given-names>G</given-names></name><name><surname>Di Leonardo</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Currents and flux-inversion in photokinetic active particles</article-title><source>Soft Matter</source><volume>14</volume><fpage>4958</fpage><lpage>4962</lpage><pub-id pub-id-type="doi">10.1039/C8SM00788H</pub-id><pub-id pub-id-type="pmid">29850728</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maggi</surname> <given-names>C</given-names></name><name><surname>Lepore</surname> <given-names>A</given-names></name><name><surname>Solari</surname> <given-names>J</given-names></name><name><surname>Rizzo</surname> <given-names>A</given-names></name><name><surname>Di Leonardo</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Motility fractionation of bacteria by centrifugation</article-title><source>Soft Matter</source><volume>9</volume><fpage>10885</fpage><lpage>10890</lpage><pub-id pub-id-type="doi">10.1039/c3sm51223a</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname> <given-names>WE</given-names></name><name><surname>Engel</surname> <given-names>S</given-names></name><name><surname>Wang</surname> <given-names>X</given-names></name><name><surname>Wolf</surname> <given-names>SE</given-names></name><name><surname>Tremel</surname> <given-names>W</given-names></name><name><surname>Thakur</surname> <given-names>NL</given-names></name><name><surname>Krasko</surname> <given-names>A</given-names></name><name><surname>Divekar</surname> <given-names>M</given-names></name><name><surname>Schröder</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Bioencapsulation of living bacteria (Escherichia coli) with poly(silicate) after transformation with silicatein-alpha gene</article-title><source>Biomaterials</source><volume>29</volume><fpage>771</fpage><lpage>779</lpage><pub-id pub-id-type="doi">10.1016/j.biomaterials.2007.10.038</pub-id><pub-id pub-id-type="pmid">18022688</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnitzer</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Theory of continuum random walks and application to chemotaxis</article-title><source>Physical Review E</source><volume>48</volume><fpage>2553</fpage><lpage>2568</lpage><pub-id pub-id-type="doi">10.1103/PhysRevE.48.2553</pub-id><pub-id pub-id-type="pmid">9960890</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz-Linek</surname> <given-names>J</given-names></name><name><surname>Arlt</surname> <given-names>J</given-names></name><name><surname>Jepson</surname> <given-names>A</given-names></name><name><surname>Dawson</surname> <given-names>A</given-names></name><name><surname>Vissers</surname> <given-names>T</given-names></name><name><surname>Miroli</surname> <given-names>D</given-names></name><name><surname>Pilizota</surname> <given-names>T</given-names></name><name><surname>Martinez</surname> <given-names>VA</given-names></name><name><surname>Poon</surname> <given-names>WCK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Escherichia coli as a model active colloid: A practical introduction</article-title><source>Colloids and Surfaces B: Biointerfaces</source><volume>137</volume><fpage>2</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1016/j.colsurfb.2015.07.048</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stenhammar</surname> <given-names>J</given-names></name><name><surname>Wittkowski</surname> <given-names>R</given-names></name><name><surname>Marenduzzo</surname> <given-names>D</given-names></name><name><surname>Cates</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Light-induced self-assembly of active rectification devices</article-title><source>Science Advances</source><volume>2</volume><elocation-id>e1501850</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.1501850</pub-id><pub-id pub-id-type="pmid">27051883</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tailleur</surname> <given-names>J</given-names></name><name><surname>Cates</surname> <given-names>ME</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Sedimentation, trapping, and rectification of dilute Bacteria</article-title><source>Epl</source><volume>86</volume><elocation-id>60002</elocation-id><pub-id pub-id-type="doi">10.1209/0295-5075/86/60002</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tipping</surname> <given-names>MJ</given-names></name><name><surname>Steel</surname> <given-names>BC</given-names></name><name><surname>Delalez</surname> <given-names>NJ</given-names></name><name><surname>Berry</surname> <given-names>RM</given-names></name><name><surname>Armitage</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantification of flagellar motor stator dynamics through in vivo proton-motive force control</article-title><source>Molecular Microbiology</source><volume>87</volume><fpage>338</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1111/mmi.12098</pub-id><pub-id pub-id-type="pmid">23216828</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vizsnyiczai</surname> <given-names>G</given-names></name><name><surname>Frangipane</surname> <given-names>G</given-names></name><name><surname>Maggi</surname> <given-names>C</given-names></name><name><surname>Saglimbeni</surname> <given-names>F</given-names></name><name><surname>Bianchi</surname> <given-names>S</given-names></name><name><surname>Di Leonardo</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Light controlled 3D micromotors powered by Bacteria</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15974</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15974</pub-id><pub-id pub-id-type="pmid">28656975</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walter</surname> <given-names>JM</given-names></name><name><surname>Greenfield</surname> <given-names>D</given-names></name><name><surname>Bustamante</surname> <given-names>C</given-names></name><name><surname>Liphardt</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Light-powering Escherichia coli with proteorhodopsin</article-title><source>PNAS</source><volume>104</volume><fpage>2408</fpage><lpage>2412</lpage><pub-id pub-id-type="doi">10.1073/pnas.0611035104</pub-id><pub-id pub-id-type="pmid">17277079</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilde</surname> <given-names>A</given-names></name><name><surname>Mullineaux</surname> <given-names>CW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Light-controlled motility in prokaryotes and the problem of directional light perception</article-title><source>FEMS Microbiology Reviews</source><volume>41</volume><fpage>900</fpage><lpage>922</lpage><pub-id pub-id-type="doi">10.1093/femsre/fux045</pub-id><pub-id pub-id-type="pmid">29077840</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>LG</given-names></name><name><surname>Martinez</surname> <given-names>VA</given-names></name><name><surname>Schwarz-Linek</surname> <given-names>J</given-names></name><name><surname>Tailleur</surname> <given-names>J</given-names></name><name><surname>Bryant</surname> <given-names>G</given-names></name><name><surname>Pusey</surname> <given-names>PN</given-names></name><name><surname>Poon</surname> <given-names>WC</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Differential dynamic microscopy of bacterial motility</article-title><source>Physical Review Letters</source><volume>106</volume><elocation-id>018101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.106.018101</pub-id><pub-id pub-id-type="pmid">21231772</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolfe</surname> <given-names>AJ</given-names></name><name><surname>Conley</surname> <given-names>MP</given-names></name><name><surname>Kramer</surname> <given-names>TJ</given-names></name><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Reconstitution of signaling in bacterial chemotaxis</article-title><source>Journal of Bacteriology</source><volume>169</volume><fpage>1878</fpage><lpage>1885</lpage><pub-id pub-id-type="doi">10.1128/jb.169.5.1878-1885.1987</pub-id><pub-id pub-id-type="pmid">3553150</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.36608.017</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Dynamic density shaping of photokinetic <italic>E. coli</italic>&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Raymond E Goldstein as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Naama Barkai as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>In this paper, the authors demonstrate the ability to dynamically arrange large collections of <italic>E. coli</italic> bacteria into complex two-dimensional density patterns using light illumination using a digital projector. The method relies on <italic>E. coli</italic> mutants whose speed depends on the local level of illumination and is based on a previously proposed relationship between swimming speed and density in suspensions of self-propelled particles. The authors further implement a feedback control strategy to improve resolution, where they adjust illumination based on current density. Their method is shown to be rapid (compared to methods based on passive colloids), to be able to capture fine spatial features, and to be reversible.</p><p>Essential revisions:</p><p>1) The role of run-and-tumble locomotion in this whole process should beexplained. Perhaps the authors could clarify the length/time scales associated with translational diffusion coming from that process in the directed pattern formation.</p><p>2) A more detailed discussion of resolution (and what controls/limits resolution) would be useful.</p><p>3) Presentation: Many concepts and methods warrant expanded explanation. Symbols are introduced without definition. There is inadequate description of experimental methods, a diagram of the experimental protocol would have been helpful, highlighting parameters such as size and geometry of chamber etc. The method of preparation of the bacterial suspension is also unclear. (In fact, supplementary figure 1 might be helpful as part of the main text.) Several algorithms for data extraction or image manipulation are glossed over and require careful definition.</p><p>4a) Interpretation: Discussion of the theoretical background can be improved. For instance, the assumed inverse proportionality law between local density and speed is itself a simplification, and the limitations of this simple theory could be discussed in the context of the experimental results. (The discussion of Figure 1B is ambiguous.)</p><p>4b) There is a growing body of work in which active matter is manipulated successfully with light, and these should be cited and discussed. Notably, recent papers from the Riedel-Kruse lab (Jin and Riedel-Kruse, 2018, PNAS), or the Poon group (Arlt et al., 2018, Nature Comms.), and several others besides. The authors should ensure previously published literature is clearly referenced, and importantly, how their work differs from or represents improvements upon these previous results.</p><p>5) Purpose: While this is a beautiful result, the wider significance of this work is unclear. We are unconvinced by the bioengineering argument that these active materials are somehow better/more controllable for micro optics applications; it is argued in terms of drift and diffusion timescales that active systems are much more responsive than their Brownian counterparts, this is undeniable – but why might it be desirable to control such samples in the first place? Furthermore, are these patterns stable? If continued to be subjected to the light, individual bacteria will adapt to the surrounding light conditions, how long will a typical Mona Lisa image remain recognisable before the pattern degrades?</p><p>We would have liked to have seen either (i) a clear theoretical interpretation in terms of the theory of motility induced phase separation, e.g. what are the physical reasons for the measured deviations from the simple inverse density-speed relationship, or (ii) a clear biological interpretation of the timescales/transients involved in the pattern formation process in terms of some intracellular &quot;memory&quot;. More interesting would be if the authors could measure, by combining precisely projected patterns with feedback modulation of population density, the actual spatiotemporal memory of the bacteria and how this might change with genetic manipulation.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.36608.018</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) The role of run-and-tumble locomotion in this whole process should beexplained. Perhaps the authors could clarify the length/time scales associated with translational diffusion coming from that process in the directed pattern formation.</p></disp-quote><p>We thank the reviewers for pointing that out. We now discuss translational</p><p>diffusion timescales for wild type (run and tumble) bacteria which</p><p>gives us the opportunity of highlighting the importance of using smooth</p><p>swimmers for faster density shaping. This is discussed in the revised</p><p>manuscript as follows:</p><p>“Calling <italic>ℓ</italic> = 1 mm the largest length scale in the target pattern, we obtain for the active case <italic>τ</italic><sub>drift</sub> ≈ <italic>ℓ/v</italic> ≈ 200 s where we used <italic>v</italic> = 5 μm/s as the typical swimming speed. A diffusion time scale can be obtained as <italic>τ</italic><sub>diff</sub> ≈ <italic>ℓ</italic><sup>2</sup><italic>/</italic>2<italic>D</italic> where <italic>D</italic> is the active translational diffusion coefficient. For wild type bacteria, moving with a run and tumble dynamics, <italic>D</italic> = <italic>v</italic><sup>2</sup><italic>τ</italic><sub>run</sub> where <italic>τ</italic><sub>run</sub> ≈ 1 s is the mean duration of a run. The corresponding characteristic diffusion time is <italic>τ</italic><sub>diff</sub> ≈ <italic>ℓ</italic><sup>2</sup><italic>/</italic>2<italic>D</italic> ≈ 2 × 10<sup>4</sup> s. This timescale can be considerably reduced if, as in our case, we suppress tumbling and use a smooth swimming strain with a much larger reorientation time <italic>τ</italic><sub>rot</sub> ≈ 20 s (Ashkin et al., 1986). In this case the diffusion timescale drops down to <italic>τ</italic><sub>diff</sub> ≈ 10<sup>3</sup> s leading to a faster relaxation towards the stationary state.”</p><disp-quote content-type="editor-comment"><p>2) A more detailed discussion of resolution (and what controls/limits resolution) would be useful.</p></disp-quote><p>We now discuss resolution limits in greater detail:</p><p>“To validate this hypothesis we use a DLP projector to display a complex light pattern onto a 400 μm thick layer of cells (Figure 1) that have been preliminarily exposed to a uniform bright illumination for 5 min. This time is much longer than the speed response time of bacteria (Figure 4) thus ensuring that cells are initialized to swim at maximal speed. The projecting system has an optical resolution of 2 μm approximately matching the size of a single cell which represents the physical “pixel” of our density images. This value sets the limit for the minimum theoretical resolution of density configurations that would be achievable if bacteria could be precisely and statically arranged in space. In practice, as we will see, the real resolution will always be larger for two main reasons: (i) bacteria do not respond instantly to light temporal variations thus introducing a blur in the target speed map, (ii) the stationary state is an ensemble of noisy patterns that constantly fluctuate because of swimming and Brownian motions of bacteria.”</p><p>See also reply to point 4 for a deeper theoretical analysis of how memory affects resolution and how feedback can help alleviating this blurring effect.</p><disp-quote content-type="editor-comment"><p>3) Presentation: Many concepts and methods warrant expanded explanation. Symbols are introduced without definition. There is inadequate description of experimental methods, a diagram of the experimental protocol would have been helpful, highlighting parameters such as size and geometry of chamber etc. The method of preparation of the bacterial suspension is also unclear. (In fact, supplementary figure 1 might be helpful as part of the main text.) Several algorithms for data extraction or image manipulation are glossed over and require careful definition.</p></disp-quote><p>We thank the reviewers for addressing these issues. We fully agree with the above comments and have extensively expanded the Materials and methods section to describe the details of data extraction and image analysis.</p><p>The Materials and methods section now includes a detailed subsection about DDM and analysis.</p><p>We have also added a detailed explanation of the normalization procedure, the computation of the distances from the target and the feedback loop (subsection “Image analysis” and subsection “Feedback”).</p><p>We also moved the supplementary figure to the main text as Figure 1 after adding schematic and geometric details of sample preparation.</p><disp-quote content-type="editor-comment"><p>4a) Interpretation: Discussion of the theoretical background can be improved. For instance, the assumed inverse proportionality law between local density and speed is itself a simplification, and the limitations of this simple theory could be discussed in the context of the experimental results. (The discussion of Figure 1B is ambiguous.)</p></disp-quote><p>We thank the reviewers for pushing us to go further in this direction. Stimulated by their questions we arrived at an original theoretical result that provides an expression for the stationary density of smooth swimming bacteria exploring a non-homogeneous light pattern and with a speed response to temporal light changes that is not instantaneous. The details of the theory are reported in the Materials and methods section. The revised manuscript now includes a discussion of this theoretical result in the context of experimental data:</p><p>“As a result, bacteria will experience an effective speed map that is a blurred version of what we would expect for an instantaneous response <italic>V</italic> (<bold>r</bold>) = <italic>v(I</italic>(<bold>r</bold>)). […]</p><p>Our aim here, however, is to investigate the resolution limits of density shaping with photokinetic bacteria.”</p><disp-quote content-type="editor-comment"><p>4b) There is a growing body of work in which active matter is manipulated successfully with light, and these should be cited and discussed. Notably, recent papers from the Riedel-Kruse (Jin and Riedel-Kruse, 2018, PNAS), or the Poon group (Arlt et al., 2018, Nature Comms.), and several others besides. The authors should ensure previously published literature is clearly referenced, and importantly, how their work differs from or represents improvements upon these previous results.</p></disp-quote><p>The paper by the Poon group was already referenced (Arlt et al., 2018). We now better highlight the main differences from our work as follows:</p><p>“[1] have recently shown that, by projecting a masked illumination pattern, “photokinetic” [11] bacteria can be accumulated in dark regions and depleted from brighter ones thus forming binary patterns. […] Finally we show that a model independent feedback control loop allows density shaping with high spatial resolution and gray level accuracy.”</p><p>We thank the reviewers for pointing us to the paper by the Reidel-Kruse lab which we have included in the bibliography and discussed in the concluding section:</p><p>“An alternative strategy to produce static patterns of bacteria is by “biofilm lithography” where an optical template of blue light is used to induce the expression of membrane proteins that promote cell-cell and cell-substrate attachment [4]. As opposed to our motility driven density shaping, these patterns are static and form over a time scale of several hours. Interestingly, the two techniques could be used in combination to achieve faster and more complex (e.g. three dimensional) biofilm lithography by fixing with blue light a template pattern obtained by speed modulation with green light.”</p><disp-quote content-type="editor-comment"><p>5) Purpose: While this is a beautiful result, the wider significance of this work is unclear. We are unconvinced by the bioengineering argument that these active materials are somehow better/more controllable for micro optics applications; it is argued in terms of drift and diffusion timescales that active systems are much more responsive than their Brownian counterparts, this is undeniable – but why might it be desirable to control such samples in the first place? Furthermore, are these patterns stable? If continued to be subjected to the light, individual bacteria will adapt to the surrounding light conditions, how long will a typical Mona Lisa image remain recognisable before the pattern degrades?</p></disp-quote><p>We have expanded the concluding section including novel application ideas:</p><p>“In conclusion, we have shown that a suspension of swimming bacteria, with optically controllable speed, can provide a new class of light controllable active materials whose density can be accurately, reversibly and quickly shaped by employing a low power light projector. […] Finally, the possibility of spatial and temporal control of motile bacteria density could also lead to novel strategies for the transport and manipulation of small cargoes inside microdevices [5].”</p><p>Regarding stability, as we now say in the main text:</p><p>“The image is stable and resolution does not deteriorate for hours. However a dark region surrounds the illuminated area so that swimming cells that exit the field of view do not come back and the number of motile cells in the illuminated area is reduced by about 50% in one hour. This issue is the main limiting factor for the lifetime of our patterns and could be solved in the future by using sample chambers that match the size of the illuminated area.”</p><disp-quote content-type="editor-comment"><p>We would have liked to have seen either (i) a clear theoretical interpretation in terms of the theory of motility induced phase separation, e.g. what are the physical reasons for the measured deviations from the simple inverse density-speed relationship, or (ii) a clear biological interpretation of the timescales/transients involved in the pattern formation process in terms of some intracellular &quot;memory&quot;. More interesting would be if the authors could measure, by combining precisely projected patterns with feedback modulation of population density, the actual spatiotemporal memory of the bacteria and how this might change with genetic manipulation.</p></disp-quote><p>We decided to move in the second direction and investigate the role of intracellular “memory” with new experiments and an original theoretical analysis. We have used DDM to accurately evaluate the time response of swimming speed to a square wave light intensity modulation. Obtained data are now reported in a new figure and discussed in the main text as follows:</p><p>“In particular, the theory assumes that speed is a local function of space which would only be the case if bacteria instantly adapt to temporal changes in light intensity. […] A slower relaxation follows and it is well fitted by an exponential function with a time constant <italic>τ</italic><sub>m</sub> = 35 s that is the same for both the rising and falling relaxations.”</p><p>Looking for a possible origin of the slow component we have performed a more detailed genetic screening of our strain. In particular, contrary to our original expectations, we confirmed with PCR the presence of the <italic>unc</italic>-operon coding for the ATP-synthase complex. The Materials and methods section has been modified accordingly.</p></body></sub-article></article>