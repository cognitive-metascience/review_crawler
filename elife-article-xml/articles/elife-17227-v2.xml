<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">17227</article-id><article-id pub-id-type="doi">10.7554/eLife.17227</article-id><article-categories><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="display-channel"><subject>Short Report</subject></subj-group></article-categories><title-group><article-title>Resolving coiled shapes reveals new reorientation behaviors in <italic>C. elegans</italic></article-title></title-group><contrib-group><contrib contrib-type="author" id="author-57076"><name><surname>Broekmans</surname><given-names>Onno D</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8849-7100</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-57077"><name><surname>Rodgers</surname><given-names>Jarlath B</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataro1"/></contrib><contrib contrib-type="author" id="author-60679"><name><surname>Ryu</surname><given-names>William S</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0350-7507</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="par-1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataro1"/><xref ref-type="other" rid="dataro2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-11508"><name><surname>Stephens</surname><given-names>Greg J</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3135-3514</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-2"/><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Physics and Astronomy</institution>, <institution>VU University Amsterdam</institution>, <addr-line><named-content content-type="city">Amsterdam</named-content></addr-line>, <country>The Netherlands</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Donnelly Center</institution>, <institution>University of Toronto</institution>, <addr-line><named-content content-type="city">Toronto</named-content></addr-line>, <country>Canada</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Cell and Systems Biology</institution>, <institution>University of Toronto</institution>, <addr-line><named-content content-type="city">Toronto</named-content></addr-line>, <country>Canada</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Department of Physics</institution>, <institution>University of Toronto</institution>, <addr-line><named-content content-type="city">Toronto</named-content></addr-line>, <country>Canada</country></aff><aff id="aff5"><label>5</label><institution>OIST Graduate University</institution>, <addr-line><named-content content-type="city">Onna, Okinawa</named-content></addr-line>, <country>Japan</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff id="aff6"><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>g.j.stephens@vu.nl</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>20</day><month>09</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e17227</elocation-id><history><date date-type="received"><day>25</day><month>04</month><year>2016</year></date><date date-type="accepted"><day>19</day><month>08</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Broekmans et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Broekmans et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-17227-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.17227.001</object-id><p>We exploit the reduced space of <italic>C. elegans</italic> postures to develop a novel tracking algorithm which captures both simple shapes and also self-occluding coils, an important, yet unexplored, component of 2D worm behavior. We apply our algorithm to show that visually complex, coiled sequences are a superposition of two simpler patterns: the body wave dynamics and a head-curvature pulse. We demonstrate the precise <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-turn dynamics of an escape response and uncover a surprising new dichotomy in spontaneous, large-amplitude coils; deep reorientations occur not only through classical <inline-formula><mml:math id="inf2"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>-shaped postures but also through larger postural excitations which we label here as <inline-formula><mml:math id="inf3"><mml:mi>δ</mml:mi></mml:math></inline-formula>-turns. We find that omega and delta turns occur independently, suggesting a distinct triggering mechanism, and are the serpentine analog of a random left-right step. Finally, we show that omega and delta turns occur with approximately equal rates and adapt to food-free conditions on a similar timescale, a simple strategy to avoid navigational bias.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.001">http://dx.doi.org/10.7554/eLife.17227.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.17227.002</object-id><title>eLife digest</title><p>We all instinctively recognize behavior: it’s what organisms <italic>do</italic>, whether they are single cells searching for food, or birds singing to mark their territory. If we want to <italic>understand</italic> behavior, however, we have to be able to characterize such actions as precisely and completely as their underlying molecular and cellular mechanisms.</p><p>For the millimeter-sized roundworm <italic>C. elegans</italic>, video tracking and analysis has produced a compact characterization of naturally occurring worm postures. Simply put: every body posture of the worm is a different mix of four fundamental postures called ‘eigenworms’. The worm’s snake-like motion is then a series of combinations of these projections, which can be analyzed to provide an automatic and measureable read-out of the worm’s behavior.</p><p>There is, however, an important caveat: when the worm makes a ‘loop’, and crosses over itself, such posture analysis is inapplicable. That is unfortunate: some of the worm’s most interesting behavior involves looping. One example is the “omega turn”, named after the shape of the Greek letter Ω. This sharp turn is used by the worm to steer away from harm, and more generally to abruptly reorient during the search for food and for mates.</p><p>Broekmans et al. have now created an algorithm, based on eigenworms, which can analyze worm images that encompass both looped and normal shapes. The result is a complete ‘behavioral microscope’ that shows how <italic>C. elegans</italic> moves in 2D. Focusing this microscope in particular on the omega turn, Broekmans et al. found that such turns are not, as has been previously described, a single behavior. Instead, they are two separate behaviors that represent the worm’s equivalent of a left-right step.</p><p>Together with previous posture analysis the work presented by Broekmans et al. allows for the full and precise measurement of the body shapes of <italic>C. elegans</italic> in 2D. This, combined with remarkable recent progress in global brain and gene expression imaging, should help to uncover new mechanisms that ultimately produce and control a worm’s behavior.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.002">http://dx.doi.org/10.7554/eLife.17227.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>behavior</kwd><kwd>low-dimensionality</kwd><kwd>image analysis</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd><italic>C. elegans</italic></kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap></funding-source><award-id>Discovery Grant</award-id><principal-award-recipient><name><surname>Ryu</surname><given-names>William S</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001833</institution-id><institution>Vrije Universiteit Amsterdam</institution></institution-wrap></funding-source><award-id>Startup Funds</award-id><principal-award-recipient><name><surname>Stephens</surname><given-names>Greg J</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004199</institution-id><institution>Okinawa Institute of Science and Technology Graduate University</institution></institution-wrap></funding-source><award-id>Unit Funds</award-id><principal-award-recipient><name><surname>Stephens</surname><given-names>Greg J</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A conceptually simple algorithm can analyze previously uncharacterized 2D coiled postures of the nematode <italic>C. elegans</italic> and has uncovered new reorientation behaviors in large amplitude turns.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Much of our fascination with the living world, from molecular motors to the dynamics of entire societies, is with emergence — where the whole is surprisingly different than the sum of its parts (see, e.g., [<xref ref-type="bibr" rid="bib23">Laughlin, 2014</xref>]). Yet, the existence of such collective organization also suggests that living systems, despite their enormous potential complexity, often inhabit only a much smaller region of their potential ‘phase space’, and evidence for this lower-dimensional behavior is ubiquitous. For example, the motor control system produces movements that are far less complex than what the musculoskeletal system allows (<xref ref-type="bibr" rid="bib10">d'Avella et al., 2003</xref>) and this hints at the presence of an organizational principle. In a typical daily movement like walking, the central nervous system is thought to produce the full walking gait by combining low-level ‘locomotory modules’, some of which appear to be universal among species (<xref ref-type="bibr" rid="bib13">Dominici et al., 2011</xref>). Similarly, the dynamics in brain networks are organized in low-dimensional activity patterns (<xref ref-type="bibr" rid="bib39">Tkačik et al., 2014</xref>; <xref ref-type="bibr" rid="bib17">Gao and Ganguli, 2015</xref>) and these patterns — not individual neurons — might be the carriers of information and computation (<xref ref-type="bibr" rid="bib19">Hopfield, 1982</xref>; <xref ref-type="bibr" rid="bib44">Yoon et al., 2013</xref>).</p><p>The emergent dynamics of behavior, how animals move and interact, is particularly important as the ultimate function of the system (<xref ref-type="bibr" rid="bib38">Tinbergen, 1963</xref>) and the scale on which evolution naturally applies. Yet, our quantitative understanding of behavior is substantially less advanced than the microscopic processes from which it is produced, even as recent efforts have expanded this frontier (<xref ref-type="bibr" rid="bib25">Mirat et al., 2013</xref>; <xref ref-type="bibr" rid="bib3">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="bib7">Cavagna and Giardina, 2014</xref>). How do we analyze high-resolution behavioral dynamics and what does this reveal about an animal’s movement strategy? How do we build effective models on the behavioral level where a ‘bottom-up’ approach is daunting? How do we connect analysis on the organism-scale to the properties of molecules, cells and circuits? We approach these questions through the postural movements of the nematode <italic>C. elegans</italic>.</p><p>In <italic>C. elegans</italic>, the 2D space of body postures can be captured precisely and is also low-dimensional (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>) so that the worm’s motor behavior is faithfully encoded as a time series of only four ‘eigenworm’ variables. These shape projections are collective coordinates in the space of natural worm postures and provide a notable reduction in complexity. However, an important limitation of previous work is the inability to deduce the geometry of self-occluding body shapes. Such coiled body postures occur during ‘omega turns’ (a maneuver during which the worm’s body briefly resembles the Greek letter <inline-formula><mml:math id="inf4"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> [<xref ref-type="bibr" rid="bib8">Croll, 1975</xref>]) and are a general and important feature of the worm’s behavioral repertoire, ranging from foraging (<xref ref-type="bibr" rid="bib35">Stephens et al., 2010</xref>; <xref ref-type="bibr" rid="bib31">Salvador et al., 2014</xref>), and chemotaxis (<xref ref-type="bibr" rid="bib29">Pierce-Shimomura et al., 1999</xref>), to escape from noxious stimuli (<xref ref-type="bibr" rid="bib26">Mohammadi et al., 2013</xref>). For example, during escape behaviors worms use coiled shapes to reorient by <inline-formula><mml:math id="inf5"><mml:msup><mml:mn>180</mml:mn><mml:mo>∘</mml:mo></mml:msup></mml:math></inline-formula> and the benefit seems obvious: it steers the worm back to safety. But how does a ‘blind’ organism achieve this result without any visual reference to the outside world? While some of the neural and molecular mechanisms driving omega turns have been uncovered (<xref ref-type="bibr" rid="bib18">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib14">Donnelly et al., 2013</xref>) and there has been previous work on crossed shapes (<xref ref-type="bibr" rid="bib20">Huang et al., 2006</xref>; <xref ref-type="bibr" rid="bib41">Wang et al., 2009</xref>; <xref ref-type="bibr" rid="bib30">Roussel et al., 2014</xref>; <xref ref-type="bibr" rid="bib27">Nagy et al., 2015</xref>), a quantitative analysis of such self-occluded posture dynamics is lacking.</p><p>Here, we exploit low-dimensionality to develop a novel and conceptually simple posture tracking algorithm able to unravel the worm’s self-occluding body shapes. We apply our approach to analyze coiled shapes during two important behavioral conditions: the escape response induced by a brief heat shock to the head, and spontaneous turns while foraging on a featureless agar plate. We find that, in general, complex deep turn sequences can be viewed as a simpler superposition of body wave phase dynamics with a bimodal head swing followed by a unimodal curvature pulse. In the escape response we show that, while turning accounts for much of the ~180° reorientation, the full distribution of reorientation angles is shaped by significant contributions from the reversal, turn and post-turn behaviors, a result consistent with the presence and action of the monoamine tyramine during the entire response (<xref ref-type="bibr" rid="bib14">Donnelly et al., 2013</xref>). In natural crawling, the peak amplitudes of the curvature pulse reveal two distinct coiling behaviors — the classical omega turn accomplishing large ventral-side reorientations, and a previously uncharacterized ‘delta’ turn which produces dorsal reorientations by overturning through the ventral side. The omega and delta turns occur independently in time, suggesting a separate triggering process, but have similar rates, as expected if they contribute little overall bias in the trajectories.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Tracking posture using low-dimensional worm shapes</title><p>Previously, we analyzed movies of <italic>C. elegans</italic> freely crawling on an agar plate (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>). For each movie frame, we identified the body of the worm, and applied a thinning algorithm to find the centerline. The worm’s 2D body posture was characterized as a 100-dimensional vector of tangent angles along this centerline (<xref ref-type="fig" rid="fig1">Figure 1B–C</xref>). Principal Component Analysis revealed that more than 95% of the variance in naturally-occurring body postures was captured by just four eigenvectors of the posture covariance matrix (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). As a result, any worm posture can be decomposed as a linear combination of these ‘eigenworms’ (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). Worm behavior then becomes a smooth, low-dimensional trajectory through posture space (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). As an example, forward and backward crawling appear as approximately circular trajectories in the <inline-formula><mml:math id="inf6"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM1"><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM2"><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> plane, and correspond to limit-cycle attractors. However, for coiled shapes such as shown in <xref ref-type="fig" rid="fig1">Figure 1H</xref>, the thinning algorithm does not produce a faithful reconstruction of the worm’s actual posture (<xref ref-type="fig" rid="fig1">Figure 1G</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.17227.003</object-id><label>Figure 1.</label><caption><title>Inverting posture analysis to generate worm images.</title><p>(<bold>A–E</bold>) We previously showed that the space of <italic>C. elegans</italic> body postures is low-dimensional. (<bold>A</bold>) For a set of images of a freely moving worm, (<bold>B</bold>) we find the centerline of the body using image thinning (black point indicates the head). (<bold>C</bold>) At equidistant points along the centerline, we measure the direction <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of the tangent <inline-formula><mml:math id="inf8"><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. After subtracting <inline-formula><mml:math id="inf9"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM105">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>, this gives a description of the worm’s shape that is intrinsic to the worm itself. (<bold>D</bold>) Principal Component Analysis reveals that only four eigenvectors of the shape covariance matrix are needed to account for <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>95</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the variance in <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM106">s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. (<bold>E</bold>) Hence, any body shape can be decomposed as a linear combination of postural ‘eigenworms’. (<bold>F</bold>) Alternatively, we can think of any body posture as a point in a low-dimensional ‘posture space’, spanned by the eigenworms (gray). Forward crawling is then represented by clockwise progression along a circular trajectory in the <inline-formula><mml:math id="inf12"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM107"><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM108"><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> plane (blue oval, body wave phase angle <inline-formula><mml:math id="inf13"><mml:mi>φ</mml:mi></mml:math></inline-formula>). (<bold>G</bold>) For any point in this space, we can easily calculate the shape of the backbone. A series of filled circles with radii representing the worm’s thickness, are used to draw an image of the worm’s body (<bold>H</bold>), inverting the original postural analysis to generate an image. For self-overlapping shapes, image thinning (<italic>H, magenta)</italic> does not produce an accurate reconstruction of the posture (<italic>G, red)</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.003">http://dx.doi.org/10.7554/eLife.17227.003</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-17227-fig1-v2"/></fig></p><p>The above procedure can also be implemented in reverse to <italic>generate</italic> worm images. For any point <inline-formula><mml:math id="inf14"><mml:mi mathvariant="bold-italic">𝒑</mml:mi></mml:math></inline-formula> in posture space (<xref ref-type="fig" rid="fig1">Figure 1F</xref>), we can reconstruct the shape of the backbone (<xref ref-type="fig" rid="fig1">Figure 1G</xref>). Knowing the thickness of the worm at each point along the body (which we estimate by averaging over many worm images), we are able to draw a reconstructed body image (<xref ref-type="fig" rid="fig1">Figure 1H</xref>; see Materials and methods). We then track the posture by finding, for each movie frame, the point in posture space (and thus the correct centerline) for which the reconstituted worm image is the most similar to the original image. This approach works for all worm postures — in contrast to image thinning, which fails for self-overlapping shapes (<xref ref-type="fig" rid="fig1">Figure 1H</xref>).</p><p>Our ‘inverse’ tracking algorithm consists of three basic elements. (i) An image error function <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>f</mml:mi><mml:mi>err</mml:mi></mml:msub></mml:math></inline-formula> quantifies how well a reconstituted worm image <inline-formula><mml:math id="inf16"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM3" mathvariant="bold-italic">𝒑</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> matches the movie frame <inline-formula><mml:math id="inf17"><mml:mi mathvariant="bold">𝐖</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2A</xref>); (ii) an efficient optimization scheme to search for a global error minimum over all possible postures, and; (iii) a method to resolve ambiguity, as different self-occluding body shapes can give rise to the same image. We measure image similarity using two specific shape metrics (<xref ref-type="bibr" rid="bib42">Yang et al., 2008</xref>): outline shape, and coarse-grained pixel density (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). By mapping this error function onto posture space: <inline-formula><mml:math id="inf18"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>err</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM4" mathvariant="bold-italic">𝒑</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>err</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi id="XM6" mathvariant="bold">𝐖</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM7"><mml:mover accent="true"><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM5" mathvariant="bold-italic">𝒑</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, we create a fitness landscape, in which the position of the global minimum corresponds to the tracking solution. We find this minimum using a pattern search algorithm (a form of direct search [<xref ref-type="bibr" rid="bib22">Kolda et al., 2003</xref>]). To resolve ambiguity, we retain multiple minima for each frame, until a final step which minimizes total sequence error. We sketch this process for a single mode in <xref ref-type="fig" rid="fig2">Figure 2C</xref>.<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.17227.004</object-id><label>Figure 2.</label><caption><title>Tracking coiled shapes by searching for image matches in posture space.</title><p>Top: tracking algorithm sequence. (<bold>A</bold>) For each movie frame <inline-formula><mml:math id="inf19"><mml:mi mathvariant="bold">𝐖</mml:mi></mml:math></inline-formula> and reconstituted worm image <inline-formula><mml:math id="inf20"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM110" mathvariant="bold-italic">𝒑</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for posture <inline-formula><mml:math id="inf21"><mml:mi mathvariant="bold-italic">𝒑</mml:mi></mml:math></inline-formula>, we apply two metrics, one based on the shape of the boundary (left), and one based on a coarse-grained pixel density matrix (right). (<bold>B</bold>) An error function <inline-formula><mml:math id="inf22"><mml:msub><mml:mi>f</mml:mi><mml:mi>err</mml:mi></mml:msub></mml:math></inline-formula> based on these two shape metrics generates a fitness landscape (schematically shown). The position of the global minimum of <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>f</mml:mi><mml:mi>err</mml:mi></mml:msub></mml:math></inline-formula> corresponds to the tracking solution; if a frame is ambiguous, multiple minima may be present. (<bold>C</bold>) For non-crossed body postures, a simple image thinning algorithm suffices to obtain time series of the modes <inline-formula><mml:math id="inf24"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> (blue line, schematically shown). For crossed frames, we use the procedure outlined in <italic>A–B</italic>. Due to the inherent ambiguity of such images, multiple solutions are generally found for each frame (light gray points). Using the filtering algorithm described in the Materials and methods, we identify the correct solutions (dark gray points). The resulting smooth trajectory (magenta, dotted line) forms the full tracking solution. (<bold>D</bold>) Sample tracking results (bottom, white background), contrasted with original images (top, gray background), for a turning sequence. Bottom: the inverse algorithm accurately tracks both simple and coiled worm shapes with small error. (<bold>E</bold>) Histogram of tracking errors for non–self-overlapping worm shapes, quantified as the Euclidean distance <inline-formula><mml:math id="inf25"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula> between the tangent angle vector <inline-formula><mml:math id="inf26"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> from our algorithm, and <inline-formula><mml:math id="inf27"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> found by image thinning (magenta). For scale, the error due to dimensionality reduction to five postural eigenmodes is shown in black. We also show the Euclidean distance between <inline-formula><mml:math id="inf28"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> in consecutive frames, representing the confidence in <inline-formula><mml:math id="inf29"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> due to the finite time resolution of the movie (gray). Even for an extreme value of <inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>3</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (gray arrow), backbones from the ‘classic’ algorithm (top) and our algorithm (bottom) are nearly indistinguishable by eye (inset). (<bold>F</bold>) Tracking error in eigenmode values for the first four modes. For uncrossed worm shapes (yellow/light), our algorithm shows negligible tracking errors. For a smaller set of crossed frames, we compare to a manually found solution (blue/dark). For scale, we show reconstituted images for worms with a single nonzero mode value of <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; these ‘error worms’ are essentially flat.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.004">http://dx.doi.org/10.7554/eLife.17227.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-17227-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.17227.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>The eigenworms <inline-formula><mml:math id="inf32"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub id="XM111"><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> derived from the fully-tracked data show only minor changes compared to those computed without crossings.</title><p>We show the original eigenworms (blue) (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>); as well as those derived from the current foraging data, but without crossings (red); and those derived from the fully-tracked foraging data (yellow). While the eigenworm shapes are largely similar, and in all cases four modes capture over <inline-formula><mml:math id="inf33"><mml:mrow><mml:mn>95</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> of the postural variance, the third (turning) eigenmode individually accounts for more variance in the fully-tracked data, as expected given its primary role in deep turns.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.005">http://dx.doi.org/10.7554/eLife.17227.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-17227-fig2-figsupp1-v2"/></fig></fig-group></p></sec><sec id="s2-2"><title>Tracking reproduces both simple and self-occluding worm shapes with small errors</title><p>Tracking results for a typical movie that includes complex, self-occluding shapes are shown in <xref ref-type="fig" rid="fig2">Figure 2D</xref> (see also <xref ref-type="other" rid="media1">Videos 1</xref> and <xref ref-type="other" rid="media2">2</xref>). In the gray rows at the top are the original movie frames; the reconstituted images from our inverse algorithm are below. While some minor inaccuracies are visible by eye, the overall result is remarkably similar. To quantify posture tracking accuracy, we first compared the results of our algorithm to image thinning, which allows for verification based on a large dataset. We used image thinning to construct a 100-dimensional vector of tangent angles <inline-formula><mml:math id="inf34"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula>, defined the tracking 'error' as <inline-formula><mml:math id="inf35"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>∥</mml:mo><mml:mrow id="XM8"><mml:msub><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mi>inv</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">𝜽</mml:mi><mml:mi>thinning</mml:mi></mml:msub></mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and we plot the distribution of these errors in <xref ref-type="fig" rid="fig2">Figure 2E</xref> (magenta). We also show the discrepancy in <inline-formula><mml:math id="inf36"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> that results from dimensionality reduction to the postural eigenmodes (black). Additionally, we show Euclidean distances between tangent angle vectors of consecutive frames in a 16 Hz movie, representing limited time resolution (gray). For this dataset of non-crossed frames, our algorithm provides excellent performance, with tracking errors bounded by time resolution and dimensionality reduction. Even for deviations in the tail of the distribution (<inline-formula><mml:math id="inf37"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>3</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), backbones from the thinning and the ‘inverse’ algorithm are quite similar (inset, gray backbones).<media content-type="glencoe play-in-place height-250 width-310" id="media1" mime-subtype="mp4" mimetype="video" xlink:href="elife-17227-media1.mp4"><object-id pub-id-type="doi">10.7554/eLife.17227.006</object-id><label>Video 1.</label><caption><title>Tracking results for the escape response.</title><p>Left images are data, while on the right, there are reconstructed images from our tracking algorithm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.006">http://dx.doi.org/10.7554/eLife.17227.006</ext-link></p></caption></media><media content-type="glencoe play-in-place height-250 width-310" id="media2" mime-subtype="mp4" mimetype="video" xlink:href="elife-17227-media2.mp4"><object-id pub-id-type="doi">10.7554/eLife.17227.007</object-id><label>Video 2.</label><caption><title>Tracking results for a complex, spontaneous coil.</title><p>Left images are data, while on the right, there are reconstructed images from our tracking algorithm.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.007">http://dx.doi.org/10.7554/eLife.17227.007</ext-link></p></caption></media></p><p>A more relevant quantity for low-dimensional trajectories is the mode discrepancy <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>∥</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> which is negligible for simple shapes, as shown in <xref ref-type="fig" rid="fig2">Figure 2F</xref> (yellow). Finally, we created a dataset of self-overlapping body shapes for which backbones were manually drawn. In <xref ref-type="fig" rid="fig2">Figure 2F</xref> (blue), we show that, for the majority of crossed frames, the mode error is less than 10% of the total range of naturally occurring mode values. As a visual reference, the reconstituted worm shapes corresponding to mode errors of <inline-formula><mml:math id="inf39"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are shown in gray: these are noticeably flat.</p></sec><sec id="s2-3"><title>Coiled dynamics in the escape response reveal precise reorientations and the superposition of the body wave and a head-curvature pulse</title><p>We first applied our postural tracking algorithm to quantify the full shape dynamics of the <italic>C. elegans</italic> ‘escape response’. This is a stereotyped behavioral sequence, consisting of a pause, a reversal and an <inline-formula><mml:math id="inf40"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>-turn, that quickly moves the worm away from a threatening stimulus. Featuring only relatively simple coiled shapes, the escape response provided a useful test of our algorithm. While recent work has connected the escape response with genetic, molecular, and neural mechanisms (<xref ref-type="bibr" rid="bib14">Donnelly et al., 2013</xref>), the behavior itself has been described only qualitatively. Here, we elicited an escape response by using an infrared laser pulse administered to the head of the worm, which raised the temperature by ~0.5°C. 10 s of pre-stimulus behavior and 20 s of post-stimulus behavior were recorded at <inline-formula><mml:math id="inf41"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>20</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>Hz</mml:mi></mml:mrow></mml:math></inline-formula>. Each worm was only assayed once, to prevent adaptation. In total, <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>92</mml:mn></mml:mrow></mml:math></inline-formula> worms were recorded, of which <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>91</mml:mn></mml:mrow></mml:math></inline-formula> successful trackings were used in the final analysis.</p><p>A schematic of the response is shown in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, with the associated postural mode dynamics in <xref ref-type="fig" rid="fig3">Figure 3B,C</xref>. During normal, forward locomotion (i in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>10</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figure 3C</xref>), the worm crawls by propagating a sine-like wave through its body. This is reflected as a pair of phase-locked sinusoidal oscillations in <inline-formula><mml:math id="inf45"><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> and we define the body wave phase angle <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>φ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi id="XM10">arctan</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM11"><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where the minus sign ensures that <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mi>φ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is positive during forward crawling. When the worm is stimulated by the infrared pulse (ii in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, pink line in <xref ref-type="fig" rid="fig3">Figure 3C</xref> at <italic>t</italic> = 10 s), it immediately backs up (iii), seen as a decrease in <inline-formula><mml:math id="inf49"><mml:mi>φ</mml:mi></mml:math></inline-formula>. The end of this reversal and the beginning of the <inline-formula><mml:math id="inf50"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>-turn is marked by a head-swing, visible as a bimodal pulse in <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>. The <inline-formula><mml:math id="inf52"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>-turn itself (iv) occurs as a large, unimodal pulse in <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, and propagates head-to-tail. This implies another switch of the direction of the body wave, and hence a return to increasing <inline-formula><mml:math id="inf54"><mml:mi>φ</mml:mi></mml:math></inline-formula>. Finally, as the turn is finished, the worm resumes forward crawling (v). The mode dynamics outlined above illustrate that the complexity of the escape sequence can be seen as a superposition of two simpler patterns: the body wave phase dynamics in <inline-formula><mml:math id="inf55"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM12"><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM13"><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and the head-curvature dynamics of <inline-formula><mml:math id="inf56"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM14"><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM15"><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. An animation of these mode dynamics is available as <xref ref-type="other" rid="media3">Video 3</xref>.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.17227.008</object-id><label>Figure 3.</label><caption><title>Tracking coiled postures and reorientation in the escape response.</title><p>(<bold>A</bold>) Schematic overview (<xref ref-type="bibr" rid="bib14">Donnelly et al., 2013</xref>) with worm body shapes extracted from tracking data: <italic>i</italic> forward locomotion and exploratory head motions; <italic>ii</italic> infrared laser stimulus; <italic>iii</italic> reversal phase; <italic>iv</italic> omega turn; <italic>v</italic> resumption of forward locomotion in the opposite direction. (<bold>B</bold>) Trajectory through posture space. <inline-formula><mml:math id="inf57"><mml:mi>φ</mml:mi></mml:math></inline-formula> indicates direction of increasing body wave phase angle, and color encodes time, with blue for <italic>t</italic> = 0 and red at <italic>t</italic> = 30 s. The worm’s reorienting coiling behavior is evident as a large excursion along the third mode, starting at the red arrow. (<bold>C</bold>) The same trajectory as in <italic>B</italic>, in terms of the body wave phase angle <inline-formula><mml:math id="inf58"><mml:mi>φ</mml:mi></mml:math></inline-formula> and the postural modes <inline-formula><mml:math id="inf59"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM116"><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM117"><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The heat shock occurs at <italic>t</italic> = 10 s (pink bar). The omega turn is initiated by a head swing, as seen in <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>, followed by a large pulse in <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, and is linked to a ‘re-reversal’, a return to forward movement. (<bold>D</bold>) An important feature of the escape response is the change in the worm’s overall orientation, and we apply our algorithm to track this reorientation for each response segment. While turning accounts for much of the reorientation, the full response distribution is shaped by significant contributions from all three segments. In particular, the small but biased reorientations of the reversal and post-turn segments originate in the <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> fluctuations outside the turn (see the time series in <italic>C</italic> and also <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This is consistent with the release and presence of the monoamine tyramine during the entire response. (<bold>E</bold>) The precision of the escape response is evident in the trial-mean reorientation where we find <inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow id="XM118"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.89</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for the full response and <inline-formula><mml:math id="inf64"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow id="XM119"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.97</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.04</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> if we exclude (four) worms that only make small dorsal reorientations. Notably, the mean reorientation in the reversal and post-turn segments closely cancel, suggesting a correction mechanism at the level of the average response. In the inset to (<bold>D</bold>, Omega turn), we also show the distribution of <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> amplitudes, which is peaked near coiled shapes in which the worm barely touches.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.008">http://dx.doi.org/10.7554/eLife.17227.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-17227-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.17227.009</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Bias in the turning mode <inline-formula><mml:math id="inf66"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, and resulting reorientation, occurs during all epochs of the escape response.</title><p>From previous work on the interpretation of the postural eigenmodes, we know that the third eigenmode (an overall bending of the worm) is linked to reorientation of the worm (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>, <xref ref-type="bibr" rid="bib35">2010</xref>). We therefore tested if any asymmetry in the fluctuations of <inline-formula><mml:math id="inf67"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> during the reversal phase could be linked to the observed reorientations. Such asymmetry is also visible in <xref ref-type="fig" rid="fig3">Figure 3C</xref> as a baseline shift of the third mode during the reversal. (Top, left &amp; right) The mean <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> value, versus the resulting orientation change, during the reversal and post-omega behaviors, respectively. The orientation change is strongly correlated with the mean <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> value. (Top, middle) Peak amplitude of the <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peak corresponding to the omega turn, versus the resulting orientation change. (Bottom, left &amp; right) Histogram of mean <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> values, during the reversal phase and post-omega phase, respectively, showing similarly asymmetric distributions. (Bottom, middle) Histogram of <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peak amplitudes during the omega turn. We also show a reconstituted worm image for an <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> value of 15, for which the worm is barely self-occluded.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.009">http://dx.doi.org/10.7554/eLife.17227.009</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-17227-fig3-figsupp1-v2"/></fig></fig-group><media content-type="glencoe play-in-place height-250 width-310" id="media3" mime-subtype="mp4" mimetype="video" xlink:href="elife-17227-media3.mp4"><object-id pub-id-type="doi">10.7554/eLife.17227.010</object-id><label>Video 3.</label><caption><title>The dynamics of the escape response in the space of the first three eigenworms.</title><p>On the right, we show the full body posture, which turns red at the moment of the thermal stimulus. On the left are the dynamics in mode space. The large-amplitude omega turn is visible as a ‘figure-8’ trajectory. Note that, even during the turn, the body wave is progressing. In general, turning behavior is a superposition of the body wave and curvature dynamics.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.010">http://dx.doi.org/10.7554/eLife.17227.010</ext-link></p></caption></media></p><p>A notable feature of the escape response is how closely the worm controls its reorientation. Our tracking algorithm also makes it possible to track the overall orientation continuously, across the different phases of the escape response. In <xref ref-type="fig" rid="fig3">Figure 3D–E</xref>, we calculate how much each of the three response segments reorients the worm. The distribution of reorientations for the full escape response is largely similar to the distribution during the omega turn, but includes contributions from the reversal and post-turn segments. In the trial-averaged reorientation <xref ref-type="fig" rid="fig3">Figure 3E</xref>, we find <inline-formula><mml:math id="inf74"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow id="XM16"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.89</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for the full response. The omega turn itself results in <inline-formula><mml:math id="inf75"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow id="XM17"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.90</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.04</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, while pre- and post-omega phases show smaller but significant contributions, <inline-formula><mml:math id="inf76"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow id="XM18"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>0.13</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.03</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf77"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow id="XM19"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.12</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.03</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively (errors are calculated using bootstrap across trials and are equivalent to standard errors of the mean). In <xref ref-type="fig" rid="fig3">Figure 3D</xref>, the interval <inline-formula><mml:math id="inf78"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM20">0</mml:mn><mml:mo>,</mml:mo><mml:mrow id="XM21"><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> corresponds to a final ventral-side reorientation, and <inline-formula><mml:math id="inf79"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM22"><mml:mo>-</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM23"><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to a final dorsal-side reorientation. The small number of reorientations between <inline-formula><mml:math id="inf80"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM24">0</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM25">π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are also final dorsal-side reorientations but are achieved using a shallow dorsal bend, not an omega turn, and excluding these worms results in a total mean reorientation angle <inline-formula><mml:math id="inf81"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow id="XM26"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>0.97</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.04</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.17227.011</object-id><label>Figure 4.</label><caption><title>Unraveling coiled shapes during foraging reveals two distinct ventrally-biased classes of large-amplitude turns.</title><p>(<bold>A</bold>) (left) Probability of the amplitude of all local extrema in the time series of the third postural eigenmode <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>. Colors represent the sign of the <inline-formula><mml:math id="inf83"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> amplitude, and hence the dorsal (gray) or ventral (blue) direction of the resulting turn. (<bold>A</bold>) (right) As previously, with all negative <inline-formula><mml:math id="inf84"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> amplitudes now plotted as positive. The peaked excess in the distribution for large ventral bends corresponds to ‘classic’ <inline-formula><mml:math id="inf85"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> (omega) shapes, and previously undescribed, deeper <inline-formula><mml:math id="inf86"><mml:mi>δ</mml:mi></mml:math></inline-formula> (delta) turns. Insets in <italic>A</italic> (left) show reconstructed worm shapes for the indicated <inline-formula><mml:math id="inf87"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> amplitudes. (<bold>B</bold>) Stills from a movie of a worm making a classical omega turn (left, yellow), and a deep delta turn (right, blue). The head is marked with a red dot; dashed lines indicate postures determined from our inverse tracking algorithm. The dynamics of delta turns are largely similar to omega turns, differing primarily in the amplitude of the bending mode <inline-formula><mml:math id="inf88"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, and the overall time to complete the maneuver (see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). (<bold>C</bold>) Histogram of orientation change (<inline-formula><mml:math id="inf89"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM121">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) due to ventral omega turns (yellow/light) and ventral delta turns (blue/dark). Ventral reorientations are accomplished through omega turns. To reorient to the dorsal side, however, <italic>C. elegans</italic> employs delta turns, which ‘over-turn’ through the ventral side. (<bold>D</bold>) Average turning rate during the tracking experiment. Ventral omega and delta turns are temporally independent, suggesting a separate triggering mechanism, but occur with approximately equal rates that adapt similarly with time spent away from food, a simple strategy to avoid any dorsal-ventral navigational bias.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.011">http://dx.doi.org/10.7554/eLife.17227.011</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-17227-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.17227.012</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Omega and delta turns follow similar kinematics; while visually quite distinct, the primary difference is the amplitude of the curvature pulse <inline-formula><mml:math id="inf90"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>.</title><p>(<bold>A</bold>) Typical time series for the postural eigenmodes <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>a</mml:mi><mml:mn>1..4</mml:mn></mml:msub></mml:math></inline-formula> during a deep delta turn. <inline-formula><mml:math id="inf92"><mml:mi>φ</mml:mi></mml:math></inline-formula> is the body wave phase angle, as defined in <xref ref-type="fig" rid="fig1">Figure 1F</xref>. Shaded area indicates the delta turn, as defined in the Materials and methods. (<bold>B</bold>) Average eigenmode time series during a delta turn (blue, <italic>N </italic>= 348). Gray lines indicate SD. For comparison, the average escape response omega turn is also shown (red dotted line). Time has been normalized with respect to the total length of the turn: <inline-formula><mml:math id="inf93"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>6</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>2</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (mean ± SD) for delta turns, <inline-formula><mml:math id="inf94"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>7</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>3</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for escape-response omega turns.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.012">http://dx.doi.org/10.7554/eLife.17227.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-17227-fig4-figsupp1-v2"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.17227.013</object-id><label>Figure 4—figure supplement 2.</label><caption><title>The shifted mutual information between delta turn and omega turn time series.</title><p>Events are localized by the large amplitude peaks in the curvature mode <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, and bins from 2 to 20 s are used to convert these timings into a binary event series. The mutual information is very small in all cases (for scale, the entropy of either event series is ∼1 bit) indicating that the two different turn types occur independently. Dashes are estimated errors from finite sampling. Red lines denote the mutual information between shuffled time series, which would be zero in the infinite data limit.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.013">http://dx.doi.org/10.7554/eLife.17227.013</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-17227-fig4-figsupp2-v2"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.17227.014</object-id><label>Figure 4—figure supplement 3.</label><caption><title>(left) Location of one of the 12 tracked worms over the course of a 35-min tracking experiment (off-food), starting at (0, 0) (black arrow).</title><p>Omega turns (orange) and delta turns (blue) are highlighted. (right) An enlargement of the area marked in gray. While both turns occur more frequently at early times, there is no correlated pattern, as consistent with their independence.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.17227.014">http://dx.doi.org/10.7554/eLife.17227.014</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-17227-fig4-figsupp3-v2"/></fig></fig-group></p><p>Remarkably, the mean reorientation in the reversal and post-turn segments precisely cancel, suggesting a correction mechanism at the level of the average response so that the mean overall reorientation is entirely determined by the omega-turn. No such precision is apparent in the variance, where we find <inline-formula><mml:math id="inf96"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>0.69</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.16</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>rad</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for the full response compared to the smaller <inline-formula><mml:math id="inf97"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>0.45</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.16</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>rad</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> for the turn segment. Thus, while the omega turn is an effective maneuver for turning away from the stimulus, the full response orientation change is broadened by the reversal <inline-formula><mml:math id="inf98"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>0.23</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.05</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>rad</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and post-omega <inline-formula><mml:math id="inf99"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>0.19</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow> <mml:mo>± </mml:mo><mml:mrow><mml:mn>0.04</mml:mn><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>π</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:msup><mml:mi>rad</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> behaviors.</p><p>These observations allow us to hypothesize a subtle link between the behavior of the worm and the escape response at the neurotransmitter level (<xref ref-type="bibr" rid="bib14">Donnelly et al., 2013</xref>). As the worm enters the reversal phase, release of tyramine sets up an asymmetry in the worm’s body, and this appears as a baseline shift in the fluctuations of the third mode (see also <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) leading to a positive bias in the reorientation, <xref ref-type="fig" rid="fig3">Figure 3D,E</xref> (reversal). After the turn, lingering effects of the tyramine produce a similar baseline shift, but as the worm is moving forward instead of backward, this now leads to an opposite orientation bias, <xref ref-type="fig" rid="fig3">Figure 3D,E</xref> (post-omega).</p></sec><sec id="s2-4"><title>Coiled dynamics in foraging reveal a surprising dichotomy in large-amplitude turns</title><p>To analyze more complex coiled shapes, we applied our posture algorithm to foraging worm behavior on a flat agar plate. Under these conditions, worms navigate using a combination of maneuvers (<xref ref-type="bibr" rid="bib18">Gray et al., 2005</xref>), including short and long reversals, pirouettes and also gradual turns (<xref ref-type="bibr" rid="bib21">Iino and Yoshida, 2009</xref>). We are particularly interested in the pirouettes, as they involve deep coils. Such body bends are primarily encoded in the third postural eigenmode (<inline-formula><mml:math id="inf100"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>) and, as discussed in the previous section, peaks in <inline-formula><mml:math id="inf101"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> are a characteristic feature of omega turns, and have a known role in reorientation of the worm (<xref ref-type="bibr" rid="bib35">Stephens et al., 2010</xref>).</p><p>In <xref ref-type="fig" rid="fig4">Figure 4A</xref>, we show the full distribution of postural mode <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> for all local extrema. Note that the modes have been normalized so that negative <inline-formula><mml:math id="inf103"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> amplitudes correspond to dorsal turns; ventral turns have strictly positive amplitudes. A clear asymmetry can be observed so that on top of a symmetric background distribution of shallow turns in both directions, we see, on the ventral side, two distinct additional peaks. Drawing reconstituted worm images for the center values of these two peaks, it is clear that the peak at <inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to a ‘classic’ <inline-formula><mml:math id="inf105"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> shape. The second peak, at <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mn>23</mml:mn></mml:mrow></mml:math></inline-formula>, shows a body shape with a much higher characteristic curvature. In <xref ref-type="fig" rid="fig4">Figure 4A</xref> (right), we have ‘folded’ the dorsal side of the distribution over the ventral side, highlighting the ventral asymmetry at high <inline-formula><mml:math id="inf107"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> amplitudes. As noted in the figure, we refer to turns in the lower-amplitude peak as <italic>omega turns</italic> and distinguish these from the higher-amplitude <italic>delta (<inline-formula><mml:math id="inf108"><mml:mi>δ</mml:mi></mml:math></inline-formula>) turns</italic> in the second peak. As for the omega turn, the name <italic>delta turn</italic> is chosen to reflect the <inline-formula><mml:math id="inf109"><mml:mi>δ</mml:mi></mml:math></inline-formula>-like shape of the worm during a typical sequence.</p><p>Returning to the original tracking movies, the presence of these two classes of turns is clearly visible. In <xref ref-type="fig" rid="fig4">Figure 4B</xref>, we display movie stills for two example turns: one omega turn, and one delta turn. During the classical omega turn, the worm slides its head along its body, similar to the escape response, ending up with a large, primarily ventral reorientation. A delta turn, on the other hand, is much deeper: the worm completely crosses its head over its body, resulting in a dorsal reorientation by ‘over-turning’ across the ventral side.</p></sec><sec id="s2-5"><title>Delta and omega turns are the serpentine analog of a left-right step and occur independently in a navigational strategy</title><p>In postural dynamics, <inline-formula><mml:math id="inf110"><mml:mi>δ</mml:mi></mml:math></inline-formula>- and <inline-formula><mml:math id="inf111"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>-turns differ primarily in their <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> pulse amplitude; their turn kinematics are otherwise very similar (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). However, when turns do occur, they result in a dramatically different change of overall orientation. As in the escape response, we use our algorithm to track the worm’s overall body reorientation, and in <xref ref-type="fig" rid="fig4">Figure 4C</xref>, we show how the worm reorients using both omega (orange) and delta (blue) turns. Simply put, omega turns reorient the worm by large, ventral angles, while delta turns reorient the worm dorsally by ‘over-turning’ through the ventral side. The difference in reorientation angle may provide a hint as to why these two behaviors exist. Earlier, we saw that the neural mechanisms that produce the escape-response omega turn, are fundamentally asymmetric, producing only ventral turns (through disinhibition of the VD motor neurons) (<xref ref-type="bibr" rid="bib14">Donnelly et al., 2013</xref>). If the worm uses the same neural infrastructure during free crawling, this would only ever allow it to reorient itself towards its ventral side. Lacking a dorsal ‘copy’ of the same neural infrastructure, the worm could instead hyper-activate the existing infrastructure to produce ventral ‘over-turning’. These ‘over-turns’ are what we call delta turns, and enable the worm to also reorient towards its dorsal side. We also find that delta and omega turns occur seemingly independently; the mutual information between time-binned, time-shifted series for both turning event time series has a maximum of less than a few percent (see Materials and methods and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplements 2</xref> and <xref ref-type="fig" rid="fig4s3">3</xref>). On the other hand, evidence that the turns can be jointly controlled is shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref>. Here, we plot the frequency of turning events over the course of the experiment. As the worm searches for food in a larger area, the turn frequency decreases significantly — a well-known phenomenon (<xref ref-type="bibr" rid="bib18">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib12">de Bono and Villu Maricq, 2005</xref>; <xref ref-type="bibr" rid="bib32">Srivastava et al., 2009</xref>) — and both omega and delta turns show similar frequencies and adaptation.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The ability to track self-overlapping shapes of <italic>C. elegans</italic> together with the eigenworm projection of postures, provides a complete and quantitative accounting of the worm’s locomotory behavior in 2D. Among living systems with a nervous system, such an exact behavioral description is unique, and is likely to be especially important as new techniques emerge for the simultaneous imaging of a substantial fraction of the worm’s neurons during free behavior (<xref ref-type="bibr" rid="bib28">Nguyen et al., 2016</xref>; <xref ref-type="bibr" rid="bib40">Venkatachalam et al., 2016</xref>). Our posture tracking algorithm itself is conceptually simple and relies on an optimized image search within the low-dimensional space of worm shapes. Indeed, while the identification of low-dimensionality occupies an important role in quantitative approaches to living systems (see e.g. <xref ref-type="bibr" rid="bib24">Machta et al., 2013</xref>; <xref ref-type="bibr" rid="bib11">Daniels and Nemenman, 2015</xref>; <xref ref-type="bibr" rid="bib16">Ganguli and Sompolinsky, 2012</xref>), here we have leveraged low-dimensionality to elucidate important and previously unknown aspects of <italic>C. elegans</italic> coils. Interestingly, we were able to apply the characterization of body postures developed previously for non–self-overlapping body shapes (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>), to capture shapes that <italic>do</italic> self-overlap; even the simpler eigenworm space allows for substantial postural diversity.</p><p>We applied our tracking algorithm to two important behaviors: an evoked escape response; and the deep, spontaneous turns that occur during foraging. Viewing the coiled turn as a trajectory through the low-dimensional posture space, a simple model emerges: a superposition of the body wave (a circular trajectory in posture space corresponding to simple forward and backward crawling), and coupled pulses along the third and fourth mode (corresponding to the deep coil and a preceding head oscillation). This model is consistent with the molecular mechanisms found to orchestrate the escape response (<xref ref-type="bibr" rid="bib14">Donnelly et al., 2013</xref>). Our results also hint at a possible answer as to how reorientations of 180° are accomplished: the worm could use its own body as a ‘guide’ for reorientation. During the omega turn, the distribution of <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peak amplitudes (<xref ref-type="fig" rid="fig3">Figure 3D</xref> [Omega turn, inset]) lies close to a value of 15: the lowest <inline-formula><mml:math id="inf114"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> value that generates a self-touching body shape. This suggests that the worm might have evolved to coil until it just intersects its own body, which it then slides along to find its way back.</p><p>While the omega turn has previously been considered as a single class of <italic>C. elegans</italic> behavior, our analysis of the amplitudes of the curvature mode <inline-formula><mml:math id="inf115"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> pulses associated with deep coils, reveals the presence of distinct subpopulations. In foraging, we show that ‘classic’ omega turns, featuring the signature <inline-formula><mml:math id="inf116"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> body shape, primarily reorient the worm to the ventral side, while delta turns reorient the worm dorsally by over-turning through the ventral side. These deep dorsal and ventral reorientations occur independently in time with approximately equal rates, which is important if there is to be no overall bias in the trajectories. On the other hand, in an evoked escape response, we observed only <inline-formula><mml:math id="inf117"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>-type turns with reorientations of ∼180°.</p><p>While distinct in visual appearance, omega and delta turns differ only in the amplitude of the curvature mode, and we have shown that these behaviors are discretely separable during foraging. Interestingly, the neuronal basis for omega bend initiation and execution has been studied in some detail (<xref ref-type="bibr" rid="bib18">Gray et al., 2005</xref>), where in particular the SMD and RIV motor neurons are, respectively, implicated in the amplitude and the ventral bias of the turn. Coiling is also observed in other contexts, including a variety of mutants (<xref ref-type="bibr" rid="bib43">Yemini et al., 2013</xref>; <xref ref-type="bibr" rid="bib27">Nagy et al., 2015</xref>), and we expect that our methods will be useful in further analyzing such shapes, and as a guide for uncovering coiling behavior.</p><p>Deep turns and reorientations form an important component of the taxis strategy of <italic>C. elegans</italic> (<xref ref-type="bibr" rid="bib9">Croll, 1976</xref>; <xref ref-type="bibr" rid="bib29">Pierce-Shimomura et al., 1999</xref>; <xref ref-type="bibr" rid="bib18">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib35">Stephens et al., 2010</xref>; <xref ref-type="bibr" rid="bib31">Salvador et al., 2014</xref>). Under foraging and chemotaxis conditions, these behaviors are seemingly stochastic (<xref ref-type="bibr" rid="bib32">Srivastava et al., 2009</xref>; <xref ref-type="bibr" rid="bib15">Gallagher et al., 2013</xref>), producing a broad distribution of reorientation angles analogous to tumbling in the bacteria <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib2">Berg and Brown, 1972</xref>). However, unlike bacterial tumbling (which occurs through an instantaneous switch in the rotation direction of a molecular motor and the resulting unbundling of the flagellar tail, see, e.g., <xref ref-type="bibr" rid="bib1">Berg, 2006</xref>) the worm’s reorientation is driven by a long, controlled sequence of stereotyped postural changes. Thus, an important question is how the worm effectively randomizes its direction of motion. We have shown here that half the variability in <italic>C. elegans</italic> foraging reorientations is due simply to the initial random choice of delta or omega turns. However, even the level of stochasticity can be modulated, as evidenced by the largely deterministic reorientation in the escape response, differing response variability depending on the strength of a thermal stimulus (<xref ref-type="bibr" rid="bib26">Mohammadi et al., 2013</xref>), and the slow adaptation of the reversal rate (<xref ref-type="bibr" rid="bib18">Gray et al., 2005</xref>; <xref ref-type="bibr" rid="bib33">Stephens et al., 2011</xref>). Overall, such a combination of behaviors, flexible and stochastic combined with patterned and deterministic, is likely to be observed even in more complex organisms, including humans. In initiating the detailed analysis of <italic>C. elegans</italic> turning behavior, we hope that our work offers a first step towards a general understanding of these processes.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Data</title><p>We used two datasets encompassing both foraging and escape response behavioral conditions (<xref ref-type="bibr" rid="bib4">Broekmans et al., 2016a</xref>). The foraging data were explored previously (<xref ref-type="bibr" rid="bib33">Stephens et al., 2011</xref>); for more details on data collection, see also (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>). In short, young L4-stage <italic>C. elegans</italic> N2-strain worms were imaged with a video tracking microscope at <inline-formula><mml:math id="inf118"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+1.7pt"><mml:mn>32</mml:mn></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>Hz</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Worms were grown at 20°C under standard conditions (<xref ref-type="bibr" rid="bib37">Sulston and Brenner, 1974</xref>). Before imaging, worms were removed from bacteria-strewn agar plates using a platinum worm pick, and rinsed from <italic>E. coli</italic> by letting them swim for 1 min in NGM buffer. They were then transferred to an assay plate (9-cm Petri dish) that contained a copper ring (5.1 cm inner diameter) pressed into the agar surface, preventing the worm from reaching the side of the plate. Recording started approximately 5 min. after the transfer, and lasted for 2100 s (35 min). In total, data from <italic>N</italic> = 12 worms was recorded. The second dataset, the ‘escape response’ condition, was recorded following procedures as described in ref. (<xref ref-type="bibr" rid="bib26">Mohammadi et al., 2013</xref>). In short, worm recordings took place in a temperature-controlled room (22.5°C ± 1°C). A 100 ms, 75-mA infrared laser pulse from a diode laser (λ = 1440 nm) was administered to the head of the worm, raising the temperature in a FWHM-radius of 220 m by ∼0.5°C. 10 s of pre-stimulus behavior and 20 s of post-stimulus behavior were recorded at a frame rate of 20 Hz. Each worm was only assayed once, to prevent adaptation. In total, <italic>N</italic> = 92 worms were recorded, of which <italic>N</italic> = 91 successful trackings were used in the final analysis.</p></sec><sec id="s4-2"><title>Image processing and shape reconstruction</title><p>All movie frames were converted to binary images and cropped, using standard image processing functions in MATLAB (R2014b, The Mathworks, Natick, MA) (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>). For faster processing, before analysis with the inverse tracking algorithm, the foraging data was down-sampled to 16 Hz by dropping every second frame. To reconstitute an image of a worm with a body posture <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi mathvariant="bold-italic">𝒑</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM27"><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi id="XM28" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM29"><mml:mi>a</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, we first calculated the vector of backbone tangent angles from <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi mathvariant="bold">𝛉</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝒆</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf121"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝒆</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> the <inline-formula><mml:math id="inf122"><mml:mi>i</mml:mi></mml:math></inline-formula>’th eigenworm. Knowing the total arc length <inline-formula><mml:math id="inf123"><mml:mi>l</mml:mi></mml:math></inline-formula> of the worm, we could calculate the position of each of the 100 points along the backbone. At each backbone point <inline-formula><mml:math id="inf124"><mml:mi>j</mml:mi></mml:math></inline-formula>, we then drew a filled circle with radius <inline-formula><mml:math id="inf125"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> to capture the worm’s body thickness (see also <xref ref-type="fig" rid="fig1">Figure 1G,H</xref>) and thus create the worm image. Circle radii <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> for a particular worm were computed from movies of uncrossed worm postures for that specific worm. In each such frame, after finding the centerline (backbone) and outline of the worm (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>), we could find <inline-formula><mml:math id="inf127"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> as the minimum distance between backbone point and outline. This was averaged across all frames. Similarly, the total arc length <inline-formula><mml:math id="inf128"><mml:mi>l</mml:mi></mml:math></inline-formula> of the worm was computed by averaging across frames. For the error function described below, the overall orientation of the worm in the image is important, and we generate images of worms in all possible orientations by adding an overall orientation value <inline-formula><mml:math id="inf129"><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM30">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn id="XM31">0</mml:mn><mml:mo>,</mml:mo><mml:mrow id="XM32"><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to the backbone tangent angle vector. This gives us a full backbone vector <inline-formula><mml:math id="inf130"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝛉</mml:mi><mml:mi mathvariant="normal">F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM33">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msubsup><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:msub><mml:mi mathvariant="bold-italic">𝒆</mml:mi><mml:mi mathvariant="bold-italic">𝒊</mml:mi></mml:msub><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For the postural dynamics, the eigenworm shape projections were taken from <xref ref-type="bibr" rid="bib34">Stephens et al. (2008)</xref>. Recomputing the eigenworms on the fully-tracked data here showed only minor changes (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p></sec><sec id="s4-3"><title>Image error function and inverse algorithm</title><p>The shape error function compares two binary worm images <inline-formula><mml:math id="inf131"><mml:msub><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf132"><mml:msub><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, and is computed as <inline-formula><mml:math id="inf133"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>err</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>outline</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>pixel</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. For <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>f</mml:mi><mml:mi>outline</mml:mi></mml:msub></mml:math></inline-formula>, we calculate a set of tangent angles <inline-formula><mml:math id="inf135"><mml:mi>ψ</mml:mi></mml:math></inline-formula> to the perimeter of the worm shape (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, bottom left). We find the 4-connected outline of the worm in the binary image <inline-formula><mml:math id="inf136"><mml:msub><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, fit a spline through these points, and discretize it into 201 segments sampled at equal arc length. The 200 resulting angles between the segments form a vector <inline-formula><mml:math id="inf137"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">𝝍</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM40"><mml:mi>ψ</mml:mi><mml:mrow><mml:mi id="XM34">i</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM35">1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM41"><mml:mi>ψ</mml:mi><mml:mrow><mml:mi id="XM36">i</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM37">2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi id="XM42" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM43"><mml:mi>ψ</mml:mi><mml:mrow><mml:mi id="XM38">i</mml:mi><mml:mo>,</mml:mo><mml:mn id="XM39">200</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; the total length of the segments is <inline-formula><mml:math id="inf138"><mml:msub><mml:mi mathvariant="normal">ℓ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is now <inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">ψ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">ψ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ℓ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, for arbitrary constants <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>. Note that the value of <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>f</mml:mi><mml:mi>outline</mml:mi></mml:msub></mml:math></inline-formula> is sensitive to the choice of starting points for tracing the 4-connected outline in each image; this is resolved by choosing the pair of starting points that minimizes <inline-formula><mml:math id="inf144"><mml:msub><mml:mi>f</mml:mi><mml:mi>outline</mml:mi></mml:msub></mml:math></inline-formula>. For <inline-formula><mml:math id="inf145"><mml:msub><mml:mi>f</mml:mi><mml:mi>pixel</mml:mi></mml:msub></mml:math></inline-formula>, we first align the images <inline-formula><mml:math id="inf146"><mml:msub><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:msub><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> so that their centroids overlap. Each image is then divided into a grid of 10x10-pixel ‘blocks’ (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, bottom right). For each block <inline-formula><mml:math id="inf148"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM46">j</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM47">k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf149"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM48">1</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM49" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM50">n</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>; ) in image <inline-formula><mml:math id="inf150"><mml:msub><mml:mi mathvariant="bold">𝐖</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, the fraction <inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM54">j</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM55">k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of black pixels in the block is calculated. This coarse-graining into blocks allows for, e.g., minor inaccuracies in the generation of worm images from mode values, without affecting the error function. We then calculate <inline-formula><mml:math id="inf152"><mml:msub><mml:mi>f</mml:mi><mml:mi>pixel</mml:mi></mml:msub></mml:math></inline-formula> as <inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>pixel</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi id="XM56">j</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM57">k</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow id="XM62"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM58">j</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM59">k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM60">j</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM61">k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. In earlier trials, we found that using five postural eigenmodes gave us significantly better tracking results than only using four. Since our error function is sensitive to the overall rotation of the worm, we amended the five-dimensional posture space with an extra dimension for the overall orientation <inline-formula><mml:math id="inf154"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM63">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>. This means that the search space for our algorithm is six-dimensional, with 5 postural dimensions, and 1 rotational dimension. To find a tracking solution for a frame, we ran hundreds of pattern searches (using MATLAB’s ‘patternsearch’ function) from randomly distributed starting points in search space, with the error function described above as objective function. Only solutions with an error value less than <inline-formula><mml:math id="inf155"><mml:mn>1.0</mml:mn></mml:math></inline-formula>, a threshold value obtained through trial-and-error, were kept. Solutions within a given hypercube of dimensions <inline-formula><mml:math id="inf156"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn id="XM64">3.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM65">3.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM66">3.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM67">3.0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM68">2.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> were merged, leaving only the solution with the lowest error value. This finally resulted in zero, one, or more potential tracking solutions per movie frame. To speed up the optimization, we applied two additional constraints. Firstly, we bounded the absolute value of the eigenmodes to <inline-formula><mml:math id="inf157"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn id="XM69">18</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM70">18</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM71">34</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM72">12</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM73">6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, for each of the five modes respectively. We verified that the distributions of eigenvalues <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> found in our tracking data tailed off before reaching these limits. Secondly, we set a limit to the maximum local curvature of the worm’s backbone, so that elements in the resulting theta vector that are 10 indices apart must not be different by more than 1.95 rad. This limit rules out body shapes that were unnaturally coiled.</p><p>Importantly, we note that our inverse problem is fundamentally ill-posed: multiple body postures may produce the same two-dimensional worm image (e.g., <xref ref-type="fig" rid="fig2">Figure 2B</xref>, bottom) and for each movie frame <inline-formula><mml:math id="inf159"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM74">1</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM75" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi id="XM76">N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, we generally find multiple potential solutions which we label <inline-formula><mml:math id="inf160"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup id="XM77"><mml:mi mathvariant="bold-italic">𝒑</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM78">1</mml:mn><mml:mo>,</mml:mo><mml:mi id="XM79" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM80"><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Even for simple, non-crossed postures, there can be two solutions (<inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>), corresponding to the swapped locations of the head and tail. Across the movie, we label the indices of the correct solutions as a vector <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi mathvariant="bold-italic">𝒃</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM81"><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi id="XM82" mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub id="XM83"><mml:mi>b</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We explicitly allow <inline-formula><mml:math id="inf164"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in case the optimization process fails, and use a cubic spline to interpolate across any such gaps. Let us call the point in posture space for movie frame <inline-formula><mml:math id="inf165"><mml:mi>j</mml:mi></mml:math></inline-formula>, resulting from this interpolation step, <inline-formula><mml:math id="inf166"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝒑</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM84" mathvariant="bold-italic">𝒃</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. To find <inline-formula><mml:math id="inf167"><mml:msup><mml:mi mathvariant="bold-italic">𝒃</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> for the full, correct tracking solution of the movie, we seek the solution vector that minimizes the total sequence error <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. We constrain the mode changes between two successive frames to be below <inline-formula><mml:math id="inf169"><mml:msub><mml:mi mathvariant="bold-italic">𝒗</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula>, which simply reflects the fact that the worm can only change posture continuously.</p></sec><sec id="s4-4"><title>Tracking pipeline</title><p>In a first pass of the data, the ‘classic’ worm tracking algorithm based on image thinning was used on all frames (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>). This fast algorithm yields high-accuracy tracking results for frames with simple, non–self-overlapping body shapes. It also automatically labels crossed frames. For the foraging dataset, the data were cut into smaller segments to allow for faster parallel processing. Each segment consisted of a series of non-crossed frames, followed by a series of crossed frames, followed by more non-crossed frames. This effectively segmented the data by deep turns (936 segments in total for the 12 worm trajectories). For the escape response dataset, such segmentation was not necessary, due to the smaller size of the data for each worm. Frames that were labeled by the ‘classic’ algorithm as ‘crossed’ were tracked using the inverse algorithm described above. The result was an interpolated, smooth trajectory through posture space. When using this pipeline as-is, the algorithm would occasionally swap the locations of head and tail between frames. To resolve head/tail orientation correctly throughout a segment, we implemented four steps. (1) During the filtering and interpolation step, we allowed the algorithm to pick, for each non-crossed frame, not just the solution given by the ‘classic’ algorithm; it could also pick an alternative version in which head and tail were swapped (this version can be trivially computed). (2) We explicitly included a limit for the maximum change of overall orientation <inline-formula><mml:math id="inf170"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM91">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> between frames of <inline-formula><mml:math id="inf171"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula> rad per second in the maximum velocity vector <inline-formula><mml:math id="inf172"><mml:msub><mml:mi mathvariant="bold-italic">𝒗</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula>. Any head/tail swaps between frames violate such a maximum change of <inline-formula><mml:math id="inf173"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM92">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula>. (3) After the filtering and interpolation step had produced a full tracking solution, we computed the error for both that tracking solution, as well as a version in which the head and tail were swapped for all frames in the segment. This fixed the overall head/tail orientation for the full segment. (4) As a final check, we manually verified and, if necessary, corrected head/tail orientations during post-processing. A minimal working set of our tracking code, plus a sample movie that can be successfully tracked using the code’s default parameters is available on Figshare as detailed in the author response (code: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3ac08fbfec9ae3d5a531">https://figshare.com/s/3ac08fbfec9ae3d5a531</ext-link>, movie: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/658dd86e3847d5926257">https://figshare.com/s/658dd86e3847d5926257</ext-link>). A minimal working set of our tracking code, plus a sample movie that can be successfully tracked using the code’s default parameters is available on Figshare (<xref ref-type="bibr" rid="bib5">Broekmans et al., 2016b</xref>; <xref ref-type="bibr" rid="bib6">Broekmans et al., 2016c</xref>).</p></sec><sec id="s4-5"><title>Tracking quality</title><p>In total, 92 escape responses and <inline-formula><mml:math id="inf174"><mml:mn>936</mml:mn></mml:math></inline-formula> free-crawling segments (each containing one self-overlapping turn; see above) were analyzed. The escape response tracking results were inspected manually, and 91 trackings (99%) were considered successful, as they were visually close to the appearance of the original worm. For the free crawling dataset, instead, after inspection of a representative sample of 236 segments across multiple worms, 96% were estimated to be successful. First, we assessed the quality of our tracking algorithm for non-crossed worm shapes (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). We used both the ‘classic’ algorithm and the ‘inverse’ algorithm to track <italic>N</italic> = 15433 non-crossed frames from the foraging dataset. For each frame, we calculated the Euclidean distance between the two resulting <inline-formula><mml:math id="inf175"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> vectors giving the ‘inv. tracking’ distribution. In the same figure, the ‘dim. reduct.’ distribution was calculated from Euclidean distances between the full <inline-formula><mml:math id="inf176"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> vector from the classic algorithm, and <inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf178"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">𝒆</mml:mi><mml:mo mathvariant="bold" stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the eigenworms from (<xref ref-type="bibr" rid="bib34">Stephens et al., 2008</xref>) (see also <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). This represents the information lost in only using the first five postural eigenmodes. The ‘time res.’ distribution represents the Euclidean distance between <inline-formula><mml:math id="inf179"><mml:mi mathvariant="bold-italic">𝜽</mml:mi></mml:math></inline-formula> vectors from consecutive frames in a movie. In <xref ref-type="fig" rid="fig2">Figure 2F</xref>, we additionally collected a dataset of four movies, featuring visually distinct types of omega turns. For the <inline-formula><mml:math id="inf180"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>348</mml:mn></mml:mrow></mml:math></inline-formula> crossed frames in these four movies, backbones were hand-drawn on the worm images, independently from the tracking results. We compared these backbones to the final results of our inverse tracking / filtering and interpolation algorithms. The resulting mode errors <inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are plotted as the blue/dark distributions. We also include the mode errors for the set of 15433 non-crossed frames (yellow).</p></sec><sec id="s4-6"><title>Definition of large-amplitude turns</title><p>For the escape response data, the largest peak in <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> between <italic>t</italic> = 10 <italic>s</italic> (the time of the stimulus) and<italic> t</italic> = 29 s was identified as the apex of the omega turn. To locate the end of the omega turn, the first zero of <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula> after the apex was found; any point after that root that had <inline-formula><mml:math id="inf184"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> was considered to be the end of the omega turn. This ensured that the negative peak in <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>a</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></inline-formula>, representing a high-curvature state of the tail at the end of the omega turn, had finished, and that the worm had reached a relatively ‘straight’ shape. For such straight shapes, the overall orientation <inline-formula><mml:math id="inf186"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM93">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> has a straightforward, intuitive interpretation. The same criterion was used, in the opposite direction, to find the start of the omega turn. If no starting point and/or end point of the omega turn could be found, the recording was excluded from the analysis. (In the escape response dataset, this was the case for 15 out of 91 recordings). We used the same criterion to find both omega and delta turns in the foraging condition. For detection of local extrema in <inline-formula><mml:math id="inf187"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula>, a standard peak-finding algorithm was used to detect both minima and maxima (based on the MATLAB ‘findpeaks’ function, which defines a peak as a data point with a greater value than its immediate neighbors). Only extrema with a minimum prominence of 0.5 were kept, resulting in 1187 large-amplitude <inline-formula><mml:math id="inf188"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub id="XM94"><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> peaks throughout the entire foraging dataset. Some <inline-formula><mml:math id="inf189"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peaks featured smaller sub-peaks in their shoulders; such sub-peaks were discarded.</p></sec><sec id="s4-7"><title>Orientation</title><p>Orientation changes were computed by comparing the overall orientation <inline-formula><mml:math id="inf190"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM95">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> between two reference points around each omega or delta turn. The apex of each deep turn was the largest <inline-formula><mml:math id="inf191"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peak identified previously. The first reference point was the last frame before the turn’s apex that featured a ‘straight’ body shape — i.e., a body shape with a low maximum local curvature. Only for such relatively ‘flat’ worm shapes does the overall orientation <inline-formula><mml:math id="inf192"><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi id="XM96">θ</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> correspond directly to the intuitive orientation assigned to the worm. Similarly, the second reference point was the first frame after the turn’s apex with such a straight body shape. Importantly, our postural tracking algorithm allows us to continuously follow the orientation angle through coiled shapes and this is important for identifying the ‘overturning’ reorientation effects of delta turns. For the analysis of the worm’s reorientation during the escape response (<xref ref-type="fig" rid="fig3">Figure 3D,E</xref>), <italic>N</italic> = 91 escape responses were analyzed. Each 30-second recording was segmented by first finding the omega turn. After identification of the omega turn, the reversal phase was simply defined as the first frame after the stimulus with a negative body wave phase velocity <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mi>φ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, up until the start of the omega turn. The ‘post-omega’ phase was any data after the end of the omega turn until the end of the recording at <italic>t</italic> = 30 s. For reorientation during foraging, we analyzed the angle change for segments with self-overlapping turns.</p></sec><sec id="s4-8"><title>Mutual information between omega and delta-turn event time series</title><p>To calculate the mutual information between the omega and delta turns during foraging, we created a binary event time series by first identifying the time of the <inline-formula><mml:math id="inf194"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peak and then binning these times into bins of width 2, 4, 10, or 20 s. We then calculated the mutual information between these binary time series as in ref. (<xref ref-type="bibr" rid="bib36">Strong et al., 1998</xref>). The mutual information was calculated for different relative shifts, ranging from −60 to +60 s and the results are shown in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>. Mutual information across time shifts never exceeded ∼3% of the maximum entropy of each time series, indicating that these turns occur independently. There is also no apparent spatial correlation (see <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>).</p></sec><sec id="s4-9"><title>Omega and delta turn frequency adaptation</title><p>In <xref ref-type="fig" rid="fig4">Figure 4D</xref>, we show how the average turn frequencies for omega and delta turns change over the course of the 35 min foraging experiments. Turns were detected by using the peak detection algorithm outlined above, applying the amplitude boundaries <inline-formula><mml:math id="inf195"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub id="XM97"><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>. The total of these extrema consists of three populations: the tail of a dorsal/ventral symmetric distribution of shallower turns, and two types of ventral deep turns, the delta and omega turns. To find the number of omega turns, we counted the number of <inline-formula><mml:math id="inf196"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peaks with an amplitude between −20 and −10 in each time window, and subtracted this from the total number of <inline-formula><mml:math id="inf197"><mml:msub><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></inline-formula> peaks with an amplitude between +10 and +20. We then computed the average number of omega turns per unit time, across the 12 experiments, in a 10-minute sliding window, shifted across the data in 5-minute steps. The first 200 s of each experiment were discarded. An identical procedure with <inline-formula><mml:math id="inf198"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub id="XM98"><mml:mi>a</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> gives the number of delta turns. Over the foraging time analyzed in <xref ref-type="fig" rid="fig4">Figure 4D</xref>, we find <inline-formula><mml:math id="inf199"><mml:mrow><mml:mn>274</mml:mn> <mml:mo>± </mml:mo><mml:mn>64</mml:mn></mml:mrow></mml:math></inline-formula> omega turns and <inline-formula><mml:math id="inf200"><mml:mrow><mml:mn>305</mml:mn> <mml:mo>± </mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math></inline-formula> delta turns, where the errors denote bootstrap errors produced by resampling the <italic>N</italic> = 12 different worm recordings with replacement. The equality of turn counts, within error bars, signals an approximate overall balance in turn events, in agreement with the rate calculations. The total turn rate in <xref ref-type="fig" rid="fig4">Figure 4D</xref> is comparable to previous work (e.g., <xref ref-type="bibr" rid="bib18">Gray et al., 2005</xref>), though there are notable differences in turn definitions and experimental conditions. We also note, however, that there are spatiotemporal fluctuations in the turn counts, with an increased number of both turns, as well as a specific bias towards omega turns near the location of the copper ring, likely reflecting an increased rate of ring-induced escape responses. In addition, we find an early-time bias towards delta turns, during which we believe that the behavior is strongly influenced by the mechanical perturbation of picking. In future work, it will be fruitful to examine these spatiotemporal patterns in a larger experimental arena and with increased turn statistics.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank SURFsara (<ext-link ext-link-type="uri" xlink:href="http://www.surfsara.nl">www.surfsara.nl</ext-link>) for help with the Lisa Compute Cluster. ODB was supported by start-up funds from the Department of Physics and Astronomy, Vrije Universiteit Amsterdam. GJS acknowledges funding from the Department of Physics and Astronomy, Vrije Universiteit and The Okinawa Institute of Science and Technology Graduate University. WSR and JBR thank The National Science and Engineering Council of Canada (NSERC).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>ODB, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>JBR, Conception and design, Acquisition of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>WSR, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con4"><p>GJS, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following datasets were generated:</p><p><related-object content-type="generated-dataset" id="dataro1" source-id="http://dx.doi.org/10.5061/dryad.t0m6p" source-id-type="uri"><collab>Rodgers JB</collab><x>,</x> <collab>Ryu WS</collab><x>,</x> <year>2010</year><x>,</x><source>Foraging dataset</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.t0m6p">http://dx.doi.org/10.5061/dryad.t0m6p</ext-link><x>,</x> <comment>Available at Dryad Digital Repository under a CC0 Public Domain Dedication</comment></related-object></p><p><related-object content-type="generated-dataset" id="dataro2" source-id="http://dx.doi.org/10.5061/dryad.t0m6p" source-id-type="uri"> <collab>Ryu WS</collab><x>,</x> <year>2015</year><x>,</x><source>Escape response dataset</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5061/dryad.t0m6p">http://dx.doi.org/10.5061/dryad.t0m6p</ext-link><x>,</x> <comment>Available at Dryad Digital Repository under a CC0 Public Domain Dedication</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Marvels of bacterial behavior</article-title><source>Proceedings of the American Philosophical Society</source><volume>150</volume><fpage>428</fpage><lpage>442</lpage></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>HC</given-names></name><name><surname>Brown</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Chemotaxis in Escherichia coli analysed by three-dimensional tracking</article-title><source>Nature</source><volume>239</volume><fpage>500</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/239500a0</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>GJ</given-names></name><name><surname>Choi</surname><given-names>DM</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><fpage>20140672</fpage><pub-id pub-id-type="doi">10.1098/rsif.2014.0672</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Broekmans</surname><given-names>O</given-names></name><name><surname>Rodgers</surname><given-names>J</given-names></name><name><surname>Ryu</surname><given-names>W</given-names></name><name><surname>Stephens</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016a</year><data-title>Data from: Resolving coiled shapes reveals new reorientation behaviors in C. elegans</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.t0m6p</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Broekmans</surname><given-names>OD</given-names></name><name><surname>Rodgers</surname><given-names>JB</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name><name><surname>Stephens</surname><given-names>GJ</given-names></name></person-group><year iso-8601-date="2016">2016b</year><data-title>EigenWormTracker code. MATLAB code for the EigenWormTracker project, for postural tracking of crawling C. elegans</data-title><source>FigShare</source><ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3ac08fbfec9ae3d5a531">https://figshare.com/s/3ac08fbfec9ae3d5a531</ext-link></element-citation></ref><ref id="bib6"><element-citation publication-type="data"><person-group person-group-type="author"><name><surname>Broekmans</surname><given-names>OD</given-names></name><name><surname>Rodgers</surname><given-names>JB</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name><name><surname>Stephens</surname><given-names>GJ</given-names></name></person-group><year iso-8601-date="2016">2016c</year><data-title>EigenWormTracker movie. An example movie that can be successfully tracked with the EigenWormTracker</data-title><source>FigShare</source><ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/658dd86e3847d5926257">https://figshare.com/s/658dd86e3847d5926257</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cavagna</surname><given-names>A</given-names></name><name><surname>Giardina</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bird Flocks as Condensed Matter</article-title><source>Annual Review of Condensed Matter Physics</source><volume>5</volume><fpage>183</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1146/annurev-conmatphys-031113-133834</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croll</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Components and patterns in the behaviour of the nematode Caenorhabditis elegans</article-title><source>Journal of Zoology</source><volume>176</volume><fpage>159</fpage><lpage>176</lpage><pub-id pub-id-type="doi">10.1111/j.1469-7998.1975.tb03191.x</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Croll</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>When Caenorhabditis elegans (Nematoda: Rhabditidae) bumps into a bead</article-title><source>Canadian Journal of Zoology</source><volume>54</volume><fpage>566</fpage><lpage>570</lpage><pub-id pub-id-type="doi">10.1139/z76-065</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>d'Avella</surname><given-names>A</given-names></name><name><surname>Saltiel</surname><given-names>P</given-names></name><name><surname>Bizzi</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Combinations of muscle synergies in the construction of a natural motor behavior</article-title><source>Nature Neuroscience</source><volume>6</volume><fpage>300</fpage><lpage>308</lpage><pub-id pub-id-type="doi">10.1038/nn1010</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daniels</surname><given-names>BC</given-names></name><name><surname>Nemenman</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Automated adaptive inference of phenomenological dynamical models</article-title><source>Nature Communications</source><volume>6</volume><fpage>8133</fpage><lpage>8138</lpage><pub-id pub-id-type="doi">10.1038/ncomms9133</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Bono</surname><given-names>M</given-names></name><name><surname>Maricq</surname><given-names>AV</given-names></name><name><surname>Villu Maricq</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Neuronal substrates of complex behaviors in C. elegans</article-title><source>Annual Review of Neuroscience</source><volume>28</volume><fpage>451</fpage><lpage>501</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.27.070203.144259</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dominici</surname><given-names>N</given-names></name><name><surname>Ivanenko</surname><given-names>YP</given-names></name><name><surname>Cappellini</surname><given-names>G</given-names></name><name><surname>d'Avella</surname><given-names>A</given-names></name><name><surname>Mondì</surname><given-names>V</given-names></name><name><surname>Cicchese</surname><given-names>M</given-names></name><name><surname>Fabiano</surname><given-names>A</given-names></name><name><surname>Silei</surname><given-names>T</given-names></name><name><surname>Di Paolo</surname><given-names>A</given-names></name><name><surname>Giannini</surname><given-names>C</given-names></name><name><surname>Poppele</surname><given-names>RE</given-names></name><name><surname>Lacquaniti</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Locomotor primitives in newborn babies and their development</article-title><source>Science</source><volume>334</volume><fpage>997</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1126/science.1210617</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donnelly</surname><given-names>JL</given-names></name><name><surname>Clark</surname><given-names>CM</given-names></name><name><surname>Leifer</surname><given-names>AM</given-names></name><name><surname>Pirri</surname><given-names>JK</given-names></name><name><surname>Haburcak</surname><given-names>M</given-names></name><name><surname>Francis</surname><given-names>MM</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name><name><surname>Alkema</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Monoaminergic orchestration of motor programs in a complex C. elegans behavior</article-title><source>PLoS Biology</source><volume>11</volume><elocation-id>e1001529</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001529</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallagher</surname><given-names>T</given-names></name><name><surname>Bjorness</surname><given-names>T</given-names></name><name><surname>Greene</surname><given-names>R</given-names></name><name><surname>You</surname><given-names>YJ</given-names></name><name><surname>Avery</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The geometry of locomotive behavioral states in C. elegans</article-title><source>PLoS One</source><volume>8</volume><elocation-id>e59865</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0059865</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ganguli</surname><given-names>S</given-names></name><name><surname>Sompolinsky</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Compressed sensing, sparsity, and dimensionality in neuronal information processing and data analysis</article-title><source>Annual Review of Neuroscience</source><volume>35</volume><fpage>485</fpage><lpage>508</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-062111-150410</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>P</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>On simplicity and complexity in the brave new world of large-scale neuroscience</article-title><source>Current Opinion in Neurobiology</source><volume>32</volume><fpage>148</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2015.04.003</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname><given-names>JM</given-names></name><name><surname>Hill</surname><given-names>JJ</given-names></name><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A circuit for navigation in Caenorhabditis elegans</article-title><source>PNAS</source><volume>102</volume><fpage>3184</fpage><lpage>3191</lpage><pub-id pub-id-type="doi">10.1073/pnas.0409009101</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hopfield</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Neural networks and physical systems with emergent collective computational abilities</article-title><source>PNAS</source><volume>79</volume><fpage>2554</fpage><lpage>2558</lpage><pub-id pub-id-type="doi">10.1073/pnas.79.8.2554</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>KM</given-names></name><name><surname>Cosman</surname><given-names>P</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Machine vision based detection of omega bends and reversals in C. elegans</article-title><source>Journal of Neuroscience Methods</source><volume>158</volume><fpage>323</fpage><lpage>336</lpage><pub-id pub-id-type="doi">10.1016/j.jneumeth.2006.06.007</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iino</surname><given-names>Y</given-names></name><name><surname>Yoshida</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Parallel use of two behavioral mechanisms for chemotaxis in Caenorhabditis elegans</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>5370</fpage><lpage>5380</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3633-08.2009</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolda</surname><given-names>TG</given-names></name><name><surname>Lewis</surname><given-names>RM</given-names></name><name><surname>Torczon</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Optimization by direct search: New perspectives on some classical and modern methods</article-title><source>SIAM Review</source><volume>45</volume><fpage>385</fpage><lpage>482</lpage><pub-id pub-id-type="doi">10.1137/S003614450242889</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laughlin</surname><given-names>RB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A perspective: Robert B Laughlin</article-title><source>Physical Biology</source><volume>11</volume><elocation-id>053003</elocation-id><pub-id pub-id-type="doi">10.1088/1478-3975/11/5/053003</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machta</surname><given-names>BB</given-names></name><name><surname>Chachra</surname><given-names>R</given-names></name><name><surname>Transtrum</surname><given-names>MK</given-names></name><name><surname>Sethna</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Parameter space compression underlies emergent theories and predictive models</article-title><source>Science</source><volume>342</volume><fpage>604</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1126/science.1238723</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirat</surname><given-names>O</given-names></name><name><surname>Sternberg</surname><given-names>JR</given-names></name><name><surname>Severi</surname><given-names>KE</given-names></name><name><surname>Wyart</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>ZebraZoom: an automated program for high-throughput behavioral analysis and categorization</article-title><source>Frontiers in Neural Circuits</source><volume>7</volume><elocation-id>107</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2013.00107</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohammadi</surname><given-names>A</given-names></name><name><surname>Byrne Rodgers</surname><given-names>J</given-names></name><name><surname>Kotera</surname><given-names>I</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Behavioral response of Caenorhabditis elegans to localized thermal stimuli</article-title><source>BMC Neuroscience</source><volume>14</volume><fpage>66</fpage><pub-id pub-id-type="doi">10.1186/1471-2202-14-66</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagy</surname><given-names>S</given-names></name><name><surname>Goessling</surname><given-names>M</given-names></name><name><surname>Amit</surname><given-names>Y</given-names></name><name><surname>Biron</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Generative Statistical Algorithm for Automatic Detection of Complex Postures</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004517</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004517</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>JP</given-names></name><name><surname>Shipley</surname><given-names>FB</given-names></name><name><surname>Linder</surname><given-names>AN</given-names></name><name><surname>Plummer</surname><given-names>GS</given-names></name><name><surname>Liu</surname><given-names>M</given-names></name><name><surname>Setru</surname><given-names>SU</given-names></name><name><surname>Shaevitz</surname><given-names>JW</given-names></name><name><surname>Leifer</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Whole-brain calcium imaging with cellular resolution in freely behaving Caenorhabditis elegans</article-title><source>PNAS</source><volume>113</volume><fpage>E1074</fpage><lpage>E1081</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507110112</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierce-Shimomura</surname><given-names>JT</given-names></name><name><surname>Morse</surname><given-names>TM</given-names></name><name><surname>Lockery</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>The fundamental role of pirouettes in Caenorhabditis elegans chemotaxis</article-title><source>Journal of Neuroscience</source><volume>19</volume><fpage>9557</fpage><lpage>9569</lpage></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roussel</surname><given-names>N</given-names></name><name><surname>Sprenger</surname><given-names>J</given-names></name><name><surname>Tappan</surname><given-names>SJ</given-names></name><name><surname>Glaser</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Robust tracking and quantification of C. elegans body shape and locomotion through coiling, entanglement, and omega bends</article-title><source>Worm</source><volume>3</volume><elocation-id>e982437</elocation-id><pub-id pub-id-type="doi">10.4161/21624054.2014.982437</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salvador</surname><given-names>LCM</given-names></name><name><surname>Bartumeus</surname><given-names>F</given-names></name><name><surname>Levin</surname><given-names>SA</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Mechanistic analysis of the search behaviour of Caenorhabditis elegans</article-title><source>Journal of the Royal Society Interface</source><volume>11</volume><elocation-id>20131092</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2013.1092</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Srivastava</surname><given-names>N</given-names></name><name><surname>Clark</surname><given-names>DA</given-names></name><name><surname>Samuel</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Temporal analysis of stochastic turning behavior of swimming C. elegans</article-title><source>Journal of Neurophysiology</source><volume>102</volume><fpage>1172</fpage><lpage>1179</lpage><pub-id pub-id-type="doi">10.1152/jn.90952.2008</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Bueno de Mesquita</surname><given-names>M</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Emergence of long timescales and stereotyped behaviors in Caenorhabditis elegans</article-title><source>PNAS</source><volume>108</volume><fpage>7286</fpage><lpage>7289</lpage><pub-id pub-id-type="doi">10.1073/pnas.1007868108</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname><given-names>B</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dimensionality and dynamics in the behavior of C. elegans</article-title><source>PLoS Computational Biology</source><volume>4</volume><elocation-id>e1000028</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000028</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stephens</surname><given-names>GJ</given-names></name><name><surname>Johnson-Kerner</surname><given-names>B</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Ryu</surname><given-names>WS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>From modes to movement in the behavior of Caenorhabditis elegans</article-title><source>PLoS One</source><volume>5</volume><elocation-id>e13914</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0013914</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strong</surname><given-names>SP</given-names></name><name><surname>Koberle</surname><given-names>R</given-names></name><name><surname>de Ruyter van Steveninck</surname><given-names>RR</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Entropy and Information in Neural Spike Trains</article-title><source>Physical Review Letters</source><volume>80</volume><fpage>197</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1103/PhysRevLett.80.197</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sulston</surname><given-names>JE</given-names></name><name><surname>Brenner</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>The DNA of Caenorhabditis elegans</article-title><source>Genetics</source><volume>77</volume><fpage>95</fpage><lpage>104</lpage></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tinbergen</surname><given-names>N</given-names></name></person-group><year iso-8601-date="1963">1963</year><article-title>On aims and methods of Ethology</article-title><source>Zeitschrift Für Tierpsychologie</source><volume>20</volume><fpage>410</fpage><lpage>433</lpage><pub-id pub-id-type="doi">10.1111/j.1439-0310.1963.tb01161.x</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tkačik</surname><given-names>G</given-names></name><name><surname>Marre</surname><given-names>O</given-names></name><name><surname>Amodei</surname><given-names>D</given-names></name><name><surname>Schneidman</surname><given-names>E</given-names></name><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Berry</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Searching for collective behavior in a large network of sensory neurons</article-title><source>PLoS Computational Biology</source><volume>10</volume><elocation-id>e1003408</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003408</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venkatachalam</surname><given-names>V</given-names></name><name><surname>Ji</surname><given-names>N</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Clark</surname><given-names>C</given-names></name><name><surname>Mitchell</surname><given-names>JK</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Tabone</surname><given-names>CJ</given-names></name><name><surname>Florman</surname><given-names>J</given-names></name><name><surname>Ji</surname><given-names>H</given-names></name><name><surname>Greenwood</surname><given-names>J</given-names></name><name><surname>Chisholm</surname><given-names>AD</given-names></name><name><surname>Srinivasan</surname><given-names>J</given-names></name><name><surname>Alkema</surname><given-names>M</given-names></name><name><surname>Zhen</surname><given-names>M</given-names></name><name><surname>Samuel</surname><given-names>ADT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pan-neuronal imaging in roaming Caenorhabditis elegans</article-title><source>PNAS</source><volume>113</volume><fpage>E1082</fpage><lpage>E1088</lpage><pub-id pub-id-type="doi">10.1073/pnas.1507109113</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Schulze</surname><given-names>E</given-names></name><name><surname>Baumeister</surname><given-names>R</given-names></name><name><surname>Burkhardt</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Using lateral coupled snakes for modeling the contours of worms</article-title><source>Lecture Notes in Computer Science</source><volume>5748</volume><fpage>542</fpage><lpage>551</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-03798-6_55</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>M</given-names></name><name><surname>Kpalma</surname><given-names>K</given-names></name><name><surname>Ronsin</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><chapter-title>A survey of shape feature extraction techniques</chapter-title><person-group person-group-type="editor"><name><surname>Yin</surname> <given-names>P</given-names></name></person-group><source>Pattern Recognition</source><fpage>43</fpage><lpage>90</lpage></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yemini</surname><given-names>E</given-names></name><name><surname>Jucikas</surname><given-names>T</given-names></name><name><surname>Grundy</surname><given-names>LJ</given-names></name><name><surname>Brown</surname><given-names>AE</given-names></name><name><surname>Schafer</surname><given-names>WR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A database of Caenorhabditis elegans behavioral phenotypes</article-title><source>Nature Methods</source><volume>10</volume><fpage>877</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2560</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoon</surname><given-names>K</given-names></name><name><surname>Buice</surname><given-names>MA</given-names></name><name><surname>Barry</surname><given-names>C</given-names></name><name><surname>Hayman</surname><given-names>R</given-names></name><name><surname>Burgess</surname><given-names>N</given-names></name><name><surname>Fiete</surname><given-names>IR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>1077</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1038/nn.3450</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.17227.019</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing editor</role><aff id="aff7"><institution>Emory University</institution>, <country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Resolving coiled shapes reveals new reorientation behaviors in <italic>C. elegans</italic>&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom, Roland Calabrese, is a member of our Board of Reviewing Editors, and another is Gordon Berman (Reviewer #2), and the evaluation has been overseen by Naama Barkai as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>In this innovative short report, the authors use a computational approach in combination with video recording of movement to study turning in <italic>C. elegans</italic>, both escape turns and stochastic foraging turns. They develop an automated method for disambiguating coiled postures that builds on their previously published postural analyses that has given rise to the postural eigenmodes by PCA; there are 4 principal eigenmodes. They use this technique to describe turns and the locomotion proceeding and following as movement through the eigenmode space, showing how turns involve the third and fourth eigenmodes and basic crawling the first two eigenmodes. They then apply this techniques to show that escape turns are very stereotyped, while foraging turns have two basic forms; the conventionally recognized omega-turn (similar to the escape turn) and the newly described delta-turn corresponding to the serpentine analog of a left-right step. Moreover in foraging these turns are independent at about the same frequency and show parallel declines with foraging duration. All in all this was an enjoyable paper to read. It introduces a new technique that should be of great interest to the worm community and can serve as an inspiration for automated tracking and dimensionality reduction in other systems. Moreover, it makes a significant discovery the delta-turn that makes unbiased foraging possible.</p><p>Essential revisions:</p><p>1) The authors should emphasize more clearly in the Abstract and Discussion that the laser stimulus only elicits omega-turns.</p><p>2) There is concern that foraging in a copper ring where a nearly equal frequency of omega-turns and delta-turns were observed may not be indicative of foraging in an open petri plate, because copper serves as an aversive stimulus. Are the worms actively avoiding the copper boundary and is this influencing the performance of delta-turns?</p><p>3) The authors should clarify the developmental stage of the worms tracked in the copper ring experiments. Larval worms are more flexible than adults and this may influence the presence of delta-turns.</p><p>4.)The authors should more clearly acknowledge the early work of Croll (1976) and mention that that work reported that worms reorient randomly to dorsal or ventral side when bumping into a bead, and that their new observation may explain how.</p><p>5) The authors might do well to mention in their Discussion the neuronal basis for omega bend initiation and execution by the Bargmann lab (Gray et al., 2004, PNAS). They reported that the SMD and RIV motorneurons appear to stimulate omega bends, and that omega bend amplitude is encoded by SMD, and RIV underlies the ventral bias of omega bends. Indeed, dorsal reorienting turns were shown to occur with equal frequency as ventrally oriented omega bends (Figure 5 H) when the RIV motorneurons were ablated. These dorsal omega bends made by ablated worms in Gray et al. may relate to delta turns in intact worms in the present work.</p><p>6) We would particularly like to know how the observed eigenmodes change when including the new data as mentioned explicitly in the minor comments. It also would be interesting to determine if the fourth eigenmode shows similar dynamics to the third, as it temporally leads the 3rd (at least in the example shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Is this earlier signal (likely a head deflection) predictive of whether the worm goes into an omega or a delta turn?</p><p>7) We would like the authors to provide code for their analysis in some form (even just sample code, not necessarily beautifully-written software) so that others can more easily evaluate and use their novel methods for tracking, as mentioned in the minor comments).</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.17227.020</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p> <italic>Essential revisions:</italic> </p><p> <italic>1) The authors should emphasize more clearly in the Abstract and Discussion that the laser stimulus only elicits omega-turns.</italic> </p><p>We have modified the Abstract and the Discussion (third paragraph) to clarify that the laser stimulus only elects Omega-type turns.</p><p> <italic>2) There is concern that foraging in a copper ring where a nearly equal frequency of omega-turns and delta-turns were observed may not be indicative of foraging in an open petri plate, because copper serves as an aversive stimulus. Are the worms actively avoiding the copper boundary and is this influencing the performance of delta-turns?</italic> </p><p>Over the foraging time shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref> we find (274 +/- 64) omega turns and (305 +/- 35) delta turns, where the errors denote bootstrap errors resampled over the <italic>N</italic>=12 different worm recordings. The agreement in counts, within error bars, signals an approximate balance in overall turning rate, in agreement with the rate calculations. The total turn rate in <xref ref-type="fig" rid="fig4">Figure 4D</xref> is reasonably consistent with previous work (e.g., Gray et al., 2005), though there are notable differences in turn definitions and experimental settings. We also note, however, that there are spatiotemporal fluctuations in the turn counts. Indeed, as the reviewers suggest, we do see an increased number of <italic>both</italic> types of turns, as well as a specific bias towards omega turns, near the location of the copper ring. This likely reflects an increased rate of ring-induced escape responses. There is also an early-time (approximately the first 200s) bias towards delta turns, which we believe is due to the mechanical perturbation of picking. We have added these details to the Methods section (subsection “Omega and delta turn frequency adaptation”). In future work, we intend to examine these spatiotemporal patterns in a larger experimental arena and with higher turn statistics. We have also made minor changes to <xref ref-type="fig" rid="fig4">Figure 4D</xref>, correcting both a mislabeling of the color legend as well as an analysis mistake which resulted in slightly higher reported rates in the previous version of our figure.</p><p> <italic>3) The authors should clarify the developmental stage of the worms tracked in the copper ring experiments. Larval worms are more flexible than adults and this may influence the presence of delta-turns.</italic> </p><p>We have added a sentence to the Methods section (subsection “Data”), stating the young L4 developmental stage of our tracked worms.</p><p> <italic>4.)The authors should more clearly acknowledge the early work of Croll (1976) and mention that that work reported that worms reorient randomly to dorsal or ventral side when bumping into a bead, and that their new observation may explain how.</italic> </p><p>We have added a reference to Croll (1975) in the Introduction (third paragraph) and to Croll (1976) in the Discussion of the use of deep turns in a <italic>taxis</italic> strategy (fifth paragraph).</p><p>5) The authors might do well to mention in their Discussion the neuronal basis for omega bend initiation and execution by the Bargmann lab (Gray et al., 2004, PNAS). They reported that the SMD and RIV motorneurons appear to stimulate omega bends, and that omega bend amplitude is encoded by SMD, and RIV underlies the ventral bias of omega bends. Indeed, dorsal reorienting turns were shown to occur with equal frequency as ventrally oriented omega bends (Figure 5 H) when the RIV motorneurons were ablated. These dorsal omega bends made by ablated worms in Gray et al. may relate to delta turns in intact worms in the present work.</p><p>We have added these ideas to the Discussion, in the fourth paragraph.</p><p>6) We would particularly like to know how the observed eigenmodes change when including the new data as mentioned explicitly in the minor comments. It also would be interesting to determine if the fourth eigenmode shows similar dynamics to the third, as it temporally leads the 3rd (at least in the example shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>). Is this earlier signal (likely a head deflection) predictive of whether the worm goes into an omega or a delta turn?</p><p>We have added <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, in which we show the original eigenworms (Stephens et al., 2008); those derived from the current foraging data, but without including crossings; and those derived from the fully-tracked foraging data, including crossed frames. While the eigenworm shapes are largely similar, and in all cases 4 modes capture over 95% of the postural variance, the third (turning) eigenmode individually accounts for more variance in the fully-tracked data, as expected given its primary role in describing deep turns.</p><p>The comment about the possible predictive value of the fourth mode is an interesting one. We have included in our response (response-fig_a3-vs-a4.pdf) a scatter plot of the peak amplitude of the a4 peak immediately preceding the deep turn, vs. the peak amplitude of the a3 peak itself. The points are color-coded, so that red corresponds to omega turns, and blue to delta turns, as classified in <xref ref-type="fig" rid="fig4">Figure 4</xref>. There is a visible link between the two quantities, and a significant overall correlation of 0.73 +/- 0.03. This suggests that the specific turn-type is determined relatively early in the dynamics. We did not include this plot as supplementary material, as it takes us farther afield from the aim of our current manuscript. We do intend to revisit these points in future work clarifying the turning mechanism.</p><p> <italic>7) We would like the authors to provide code for their analysis in some form (even just sample code, not necessarily beautifully-written software) so that others can more easily evaluate and use their novel methods for tracking, as mentioned in the minor comments).</italic></p><p>We share your stance on the importance of sharing scientific code, and have uploaded a minimal working set of our tracking code, plus a sample movie that can be successfully tracked using the code’s default parameters, to Figshare: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/3ac08fbfec9ae3d5a531">https://figshare.com/s/3ac08fbfec9ae3d5a531</ext-link></p><p>Sample movie: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/658dd86e3847d5926257">https://figshare.com/s/658dd86e3847d5926257</ext-link></p><p>The datasets are currently marked as private, but anyone with the above links can access the files. We will open up access to everyone as soon as the paper is public.</p></body></sub-article></article>