<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">57872</article-id><article-id pub-id-type="doi">10.7554/eLife.57872</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Pupil diameter encodes the idiosyncratic, cognitive complexity of belief updating</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-155252"><name><surname>Filipowicz</surname><given-names>Alexandre LS</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1311-386X</contrib-id><email>alsfilip@pennmedicine.upenn.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-101110"><name><surname>Glaze</surname><given-names>Christopher M</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-34495"><name><surname>Kable</surname><given-names>Joseph W</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-17965"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6018-0483</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution>Departments of Neursocience, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Departments of Psychology, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Departments of Computational Neuroscience Initiative, University of Pennsylvania</institution><addr-line><named-content content-type="city">Philadelphia</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Donner</surname><given-names>Tobias H</given-names></name><role>Reviewing Editor</role><aff><institution>University Medical Center Hamburg-Eppendorf</institution><country>Germany</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Behrens</surname><given-names>Timothy E</given-names></name><role>Senior Editor</role><aff><institution>University of Oxford</institution><country>United Kingdom</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>05</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e57872</elocation-id><history><date date-type="received" iso-8601-date="2020-04-15"><day>15</day><month>04</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-05-18"><day>18</day><month>05</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Filipowicz et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Filipowicz et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-57872-v2.pdf"/><abstract><p>Pupils tend to dilate in response to surprising events, but it is not known whether these responses are primarily stimulus driven or instead reflect a more nuanced relationship between pupil-linked arousal systems and cognitive expectations. Using an auditory adaptive decision-making task, we show that evoked pupil diameter is more parsimoniously described as signaling violations of learned, top-down expectations than changes in low-level stimulus properties. We further show that both baseline and evoked pupil diameter is modulated by the degree to which individual subjects use these violations to update their subsequent expectations, as reflected in the complexity of their updating strategy. Together these results demonstrate a central role for idiosyncratic cognitive processing in how arousal systems respond to new inputs and, via our complexity-based analyses, offer a potential framework for understanding these effects in terms of both inference processes aimed to reduce belief uncertainty and more traditional notions of mental effort.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>pupillometry</kwd><kwd>decision-making</kwd><kwd>belief updating</kwd><kwd>surprise</kwd><kwd>uncertainty</kwd><kwd>complexity</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>NSF-NCS 1533623</award-id><principal-award-recipient><name><surname>Kable</surname><given-names>Joseph W</given-names></name><name><surname>Gold</surname><given-names>Joshua I</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000070</institution-id><institution>National Institute of Biomedical Imaging and Bioengineering</institution></institution-wrap></funding-source><award-id>R01 EB026945</award-id><principal-award-recipient><name><surname>Gold</surname><given-names>Joshua I</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>F32 MH117924</award-id><principal-award-recipient><name><surname>Filipowicz</surname><given-names>Alexandre LS</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Pupil-linked arousal dynamics are influenced more strongly by high-level internal belief states than by low-level sensory events during decision-making.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Pupil size changes primarily as a function of ambient light levels but also in the context of a host of other brain functions that often involve changes in arousal (<xref ref-type="bibr" rid="bib36">Joshi and Gold, 2020</xref>; <xref ref-type="bibr" rid="bib44">Mathôt, 2018</xref>). Several early studies ascribed arousal-related modulations of pupil size to the ‘mental effort’ required to, for example, solve an arithmetic problem or hold items in working memory (<xref ref-type="bibr" rid="bib6">Beatty, 1982</xref>; <xref ref-type="bibr" rid="bib44">Mathôt, 2018</xref>). This view emphasizes the idiosyncratic and cognitive nature of these pupil fluctuations but lacks a precise description of the computations being encoded. Pupil size is also sensitive to stimulus probabilities, typically increasing when unexpected stimuli are presented or expected stimuli are omitted (<xref ref-type="bibr" rid="bib35">Joshi et al., 2016</xref>; <xref ref-type="bibr" rid="bib48">Murphy et al., 2014</xref>; <xref ref-type="bibr" rid="bib58">Qiyang et al., 1985</xref>). More recently, arousal-related pupil modulations have been shown to represent critical computations required to learn from, and adapt to, changes in our environment (<xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>; <xref ref-type="bibr" rid="bib52">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib55">O'Reilly et al., 2013</xref>; <xref ref-type="bibr" rid="bib57">Preuschoff et al., 2011</xref>). This view emphasizes specific computations encoded in pupil size but lacks a clear link to idiosyncratic, cognitive processing. The goal of the present study was to reconcile these different views and synthesize a more comprehensive understanding of the role of pupil-linked arousal systems in cognition.</p><p>We build on studies of adaptive decision-making, in which past experiences are used flexibly to update beliefs about the world that guide decisions (<xref ref-type="bibr" rid="bib24">Filipowicz et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">Johnson-Laird, 2004</xref>; <xref ref-type="bibr" rid="bib68">Tenenbaum et al., 2011</xref>). In uncertain and changing environments, effective belief-updating strategies need to resist spurious noise while remaining flexible enough to adapt to real changes (<xref ref-type="bibr" rid="bib7">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib24">Filipowicz et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Nassar et al., 2010</xref>; <xref ref-type="bibr" rid="bib54">O'Reilly, 2013</xref>). Several key features of these adaptive processes are reflected robustly in dynamic pupil fluctuations. Rapid phasic increases in pupil size occur in response to surprising events that can drive changes in beliefs (<xref ref-type="bibr" rid="bib52">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib55">O'Reilly et al., 2013</xref>; <xref ref-type="bibr" rid="bib57">Preuschoff et al., 2011</xref>). Slower tonic increases in pupil size can encode increased belief uncertainty (<xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>; <xref ref-type="bibr" rid="bib47">Muller et al., 2019</xref>; <xref ref-type="bibr" rid="bib52">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib71">Urai et al., 2017</xref>). These slower pupil changes are also those most closely linked with changes in mental effort (<xref ref-type="bibr" rid="bib6">Beatty, 1982</xref>; <xref ref-type="bibr" rid="bib44">Mathôt, 2018</xref>) and associated with individual differences in cognitive traits such as fluid intelligence (<xref ref-type="bibr" rid="bib70">Tsukahara et al., 2016</xref>).</p><p>However, several key cognitive and idiosyncratic aspects of adaptive decision-making have yet to be linked clearly to pupil modulations. First, adaptive decision-making has been studied primarily in relatively stable environments, in which changes to stimulus properties occur infrequently and are therefore almost always ‘surprising’ (<xref ref-type="bibr" rid="bib24">Filipowicz et al., 2016</xref>; <xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>; <xref ref-type="bibr" rid="bib52">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib55">O'Reilly et al., 2013</xref>). These environments thus conflate violations of top-down, cognitive expectations that govern surprise with more basic bottom-up sensory responses to stimulus changes that can also modulate pupil size (e.g., ‘startle’ or ‘orienting’ responses; <xref ref-type="bibr" rid="bib11">Bremner, 2009</xref>; <xref ref-type="bibr" rid="bib61">Sara, 2009</xref>). Second, adaptive decision-making requires identifying changes in properties of not just observable stimuli but also of latent (i.e., not directly observable) environmental variables that affect uncertainty (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>; <xref ref-type="bibr" rid="bib29">Glaze et al., 2015</xref>; <xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>; <xref ref-type="bibr" rid="bib45">McGuire et al., 2014</xref>). Third, computations related to surprise and uncertainty can be strongly idiosyncratic, reflecting the specific belief-updating strategy being used by the decision-maker to integrate information from the environment (<xref ref-type="bibr" rid="bib22">Faraji et al., 2018</xref>; <xref ref-type="bibr" rid="bib23">Filipowicz et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Filipowicz et al., 2018</xref>).</p><p>The current study aimed to overcome these limitations by assessing pupil size under a range of cognitively demanding task conditions and with respect to individual differences in the belief-updating strategy used to solve the task (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>). A key feature of the task was the use of complementary conditions that had equally predictable stimulus sequences but different relationships between relevant bottom-up stimulus properties and top-down beliefs. We show that across these conditions, the most parsimonious account of task-driven pupil modulations was not in terms of bottom-up stimulus properties. Instead, pupil size reflected the trial-by-trial, top-down belief-updating process, with baseline pupil size encoding the strength of the current belief and stimulus-evoked changes in pupil size encoding violations of the current belief. Moreover, the task conditions that most strongly dissociated bottom-up from top-down processing gave rise to high individual variability in behavior and task-driven pupil modulations, both of which were related systematically to the complexity of each subject’s belief-updating strategy. Together these results imply that task-driven changes in pupil-linked arousal can represent a window into the underlying cognitive operations that update and maintain task-relevant beliefs.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>Seventy-eight subjects performed an auditory predictive-inference task that required them to predict on each trial which of two source locations (left or right) would generate an auditory tone (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). The source generating the tones switched locations from right-to-left or left-to-right at unannounced points throughout the task. The per-trial probability of this source-location switch, or ‘hazard rate’ (<italic>H</italic>), was fixed at either a low (<italic>H</italic> = 0.01), intermediate (<italic>H</italic> = 0.30), or high (<italic>H</italic> = 0.99) value in blocks of trials that changed at unannounced points throughout the task (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). To make this inference process more challenging, uncertainty was added by playing the tone from the opposite side of the generating source on 20% of trials (‘opposite-location trials’). This design allowed us to dissociate top-down expectations from bottom-up stimulus properties (i.e., location switches) and required the subjects to adapt their expectations to the different hazard-rate conditions (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>; <xref ref-type="bibr" rid="bib29">Glaze et al., 2015</xref>). Specifically, the low versus high hazard-rate conditions produced location switches that were predictably rare or common, respectively, and thus could in principle be used strategically to avoid overreacting to opposite-location trials. In contrast, the intermediate hazard-rate condition was less predictable, such that the best strategy was to predict a repeat of the previous location (similar to <italic>H</italic> = 0.5 for a perceptual-judgment task, which requires decisions based on only the most-recent stimulus; <xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>, <xref ref-type="bibr" rid="bib29">Glaze et al., 2015</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Auditory predictive-inference task and average performance.</title><p>(<bold>a</bold>) Subjects predicted which of two sources would generate a tone on the next trial. After making the prediction, a tone was played in either the left or right ear. (<bold>b</bold>) Subjects completed up to three sessions of 1000 trials each. In each session, subjects were exposed to two hazard rates that would change at unannounced points throughout the session. (<bold>c</bold>) Proportion of subject and simulation correct predictions as a function of trials after a source-location switch, separated by hazard rate. (<bold>d</bold>) Proportion of subject and simulation prediction switches (i.e., changing their prediction from the previous trial) for trials after a source switch, separated by hazard rate. Simulated behavior was generated from the Bayesian learning model fit to data from individual subjects and applied to the same sequences observed by each subject. Error bars in c, d are ± SEM across real or simulated subjects.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig1-v2.tif"/></fig><sec id="s2-1"><title>Pupil diameter is sensitive to adaptive, context-dependent expectations</title><p>On average, the subjects adjusted their behavior adaptively to different hazard rates. Across subjects, the proportion of correct predictions was above chance for all hazard-rate conditions, with the highest performance for low hazard rates (median [interquartile range, or IQR] proportion correct = 0.82 [0.79–0.85], 0.59 [0.56–0.61], and 0.63 [0.56–0.67] for low, intermediate, and high hazard rates, respectively; two-tailed signed-rank test for <italic>H<sub>0</sub></italic>: median = 0.5, all <italic>p</italic>s &lt; 4.2×10<sup>−12</sup>; two-tailed paired rank-sum test for <italic>H<sub>0</sub></italic>: per-subject performance difference between hazard pairs = 0, all <italic>ps</italic> ≤ 0.0009). More specifically, in the low hazard-rate condition, source-location switches from one side to the other were relatively rare and therefore unexpected. Accordingly, performance was low for trials on which the source location switched (because subjects reasonably assumed that the switch on that trial was from the 20% of opposite-location trials) but then gradually increased over several trials as the subject gathered more evidence that a real source-location switch had occurred. In the intermediate hazard-rate condition, although stability was still expected, source-location switches were slightly more expected. Accordingly, subjects had initially low performance for trials on which the source location switched, followed by a higher and more immediate propensity to switch predictions on the next trial. In the high hazard-rate condition, source-location switches were highly expected. Accordingly, subjects showed a relatively high prediction switch rate for trials on which the source location switched, with more errors on the rare non-switch trials (0.63 [0.56–0.67] proportion correct, p=3.8×10<sup>−11</sup>). These hazard-dependent behavioral patterns were roughly consistent with simulated behavior from a Bayesian learning model that used trial-by-trial observations to perform inference over both the current source and hazard rate (<xref ref-type="fig" rid="fig1">Figure 1c,d</xref>; <xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>).</p><p>To relate these adaptive behavioral patterns to pupil changes, we characterized how pupil diameter measured before (‘baseline’), during (‘evoked’), and after (‘next baseline’) stimulus presentation on each trial was modulated by task-relevant stimuli (i.e., presentation of the tone and whether or not it switched locations from the previous trial, which could result from either real source switches or opposite-location trials) and behaviors (i.e., whether or not the subject switched predictions from the previous trial). In general, the subjects’ pupils dilated in response to tone presentation (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The magnitude of this evoked pupil response was negatively correlated with the corresponding baseline pupil diameter (median [IQR] Spearman’s <italic>rho</italic> comparing trial-by-trial baseline pupil diameter to baseline-subtracted evoked change per subject = −0.34 [−0.41 – −0.26], sign-rank test for H<sub>0</sub>: median = 0, p=1.1×10<sup>−10</sup>), as has been reported previously (<xref ref-type="bibr" rid="bib16">de Gee et al., 2014</xref>; <xref ref-type="bibr" rid="bib28">Gilzenrat et al., 2010</xref>). To identify pupil modulations that were distinct from this relationship, we used two sets of linear regressions to relate task-relevant stimulus and behavioral features to: 1) baseline pupil diameter; and 2) changes in pupil diameter that were evoked by the tone presentation, with baseline pupil diameter subtracted out and using baseline pupil diameter as an additional regressor.</p><p>Both baseline pupil diameter and evoked pupil responses were affected by whether or not the tone switched locations from the previous trial, in a manner that depended strongly on the hazard-rate condition (i.e., the frequency with which the sound source switched locations). Specifically, in the low and intermediate hazard-rate conditions, the evoked changes in pupil diameter tended to be larger when the tone location switched than when it repeated from the previous trial. This effect persisted into the next baseline for the low, but not the intermediate, hazard-rate condition (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Conversely, in the high hazard-rate condition, the evoked pupil responses were not modulated systematically by whether or not the sound location switched (<xref ref-type="fig" rid="fig2">Figure 2c</xref>), but baseline pupil diameter on the subsequent trial tended to be larger after the source location repeated than when it switched on the previous trial (<xref ref-type="fig" rid="fig2">Figure 2b</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Pupil size encoded violations of expectations.</title><p>(<bold>a</bold>) Sequence of tone and prediction events. (<bold>b–d</bold>) Each panel shows two-tailed linear mixed-effects beta weights with binary regressors corresponding to whether or not subjects switched their prediction and whether or not the tone switched sides on that trial, for: (<bold>b</bold>) baseline pupil diameter from the current trial, before the subject heard the tone and made the next prediction; (<bold>c</bold>) baseline pupil diameter from the next trial, after the subject heard the tone and made a prediction; and (<bold>d</bold>) changes in pupil diameter from baseline in a 2 s period after tone onset. In a and b, the regressions accounted for the evoked pupil change from the previous trial; boxplots show median, IQR, IQR x 1.5, and outliers; **: p&lt;0.01, ***: p&lt;0.001 estimated from linear regressions. In c, the regressions accounted for baseline pupil on the current trial along with the evoked pupil and baseline from the previous trial; lines and shading correspond to mean ± SEM across subjects, and straight lines above (for positive betas) and below (for negative betas) beta values indicate significant timepoints (FWE corrected p&lt;0.05).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Average z-scored pupil diameter from tone onset across all subjects.</title><p>Shading corresponds to mean ± SEM of the per-subject average pupil diameter. Pupil diameter was z-scored per session using data from both before and after tone onset, which accounts for the largely negative values shown here.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Pupil encodes information about tone switches and prediction errors.</title><p>Two-tailed linear mixed-effects beta weights relating whether tones would switch from the previous trial, whether participants made incorrect predictions, and the tone switch-by-incorrect interaction for each hazard rate, for a) baseline (100 ms prior to tone onset) pupil diameter from the current trial, (<bold>b</bold>) baseline pupil diameter from the next trial, and (<bold>c</bold>) evoked changes in pupil diameter in sliding windows 0–2 s after tone onset. In a and b, the regressions accounted for the evoked pupil change from the previous trial; boxplots show median, IQR, IQR x 1.5, and outliers; **: p&lt;0.01, ***: p&lt;0.001 estimated from linear regressions. In c, the regressions accounted for baseline pupil on the current trial along with the evoked pupil and baseline from the previous trial; lines and shading correspond to mean ± SEM across subjects, and straight lines above beta values indicate significant timepoints (FWE corrected p&lt;0.05).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig2-figsupp2-v2.tif"/></fig></fig-group><p>Both baseline pupil diameter and evoked pupil responses were similarly affected by whether or not the subject predicted that the sound source would switch locations from the previous trial, also in a manner that depended strongly on the hazard-rate condition. These effects reflected top-down, hazard-specific expectations that were distinct from the effects of switches in tone-source location, described above (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Specifically, in the low and intermediate hazard-rate conditions, in which switches were unexpected, the baseline pupil diameter (measured prior to the subject hearing the tone and then making a prediction on that trial) was larger on trials in which the subject would then hear the tone and subsequently predict that the source location would switch versus repeat on the next trial (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). The subsequent evoked pupil response showed an additional modulation in the same direction, corresponding to larger evoked dilations when the subject predicted a location switch versus repeat (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). In contrast, in the high hazard-rate condition, in which switches were expected, baseline and evoked changes in pupil diameter tended to be larger when predictions repeated from the previous trial (<xref ref-type="fig" rid="fig2">Figure 2a,c</xref>). These effects also tended to persist into the next baseline pupil diameter (<xref ref-type="fig" rid="fig2">Figure 2b</xref>).</p><p>These stimulus- and behavior- driven effects on pupil were distinguishable from each other because the two were not always aligned; that is, tone and prediction switches did not always occur at the same time because of the generative noise, and because subjects made errors. Thus, another way of identifying whether and how pupil diameter was modulated in a context dependent manner was to characterize modulations by tone-location switch versus repeat, correct predictions versus errors, and their interactions (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). These analyses showed consistent increases in evoked pupil response after errors in all three hazard-rate conditions. Additionally, these pupil responses to errors were modulated by the hazard rate, such that pupils tended to dilate more to errors on tone-switch trials in the low hazard-rate condition, and to errors on tone-repeat trials in the high hazard-rate condition (measured as the tone-switch by error interaction in all three hazard conditions; <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Together these results show that pupil size was modulated by not just low-level stimulus properties (tone-location switches) but also context-specific predictions and their violations, corresponding to location switches when stability was expected and repetitions when instability was expected.</p></sec><sec id="s2-2"><title>Pupil diameter and response times encode adaptive, trial-by-trial belief updating</title><p>To better relate the task-dependent pupil modulations to the specific belief-updating strategies each individual subject used to derive hazard-specific predictions, we fit each subject’s trial-by-trial sequence of behavioral choices (predictions) with a Bayesian learning model that performs inference over both the source location and hazard rate (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>). A key parameter in the model controls the width of the distribution of prior probabilities that subjects assign to different hazard rates, with wider prior distributions leading to model predictions that adapt more effectively to changes in hazard rate than narrower prior distributions (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>). The model combines this prior distribution with each new observation (i.e., on which side the tone is played) to update the strength of its belief about the current source location and hazard rate. Using the per-subject model fits, we quantified belief strength on each trial as the log-odds-ratio that source 1 versus 2 would generate the next tone (<xref ref-type="bibr" rid="bib32">Gold and Shadlen, 2001</xref>). We quantified surprise on each trial as the negative log probability that the observed tone was predicted (<xref ref-type="bibr" rid="bib25">Filipowicz et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Mars et al., 2008</xref>; <xref ref-type="bibr" rid="bib55">O'Reilly et al., 2013</xref>), which reflected the degree to which the new observation did not match the current belief about location (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1b</xref>).</p><p>Baseline and evoked pupil diameter encoded belief strength and surprise, respectively, from this belief-updating process (<xref ref-type="fig" rid="fig3">Figure 3a,b</xref> shows results from linear regressions of pupil diameter that accounted for relationships between baseline and evoked pupil diameter as in <xref ref-type="fig" rid="fig2">Figure 2</xref>; <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref> shows comparable results using a linear regression of the first temporal derivative of evoked changes in pupil diameter, which is thought to be less susceptible to baseline effects; <xref ref-type="bibr" rid="bib18">de Gee and Tsetsos, 2019</xref>; <xref ref-type="bibr" rid="bib35">Joshi et al., 2016</xref>; <xref ref-type="bibr" rid="bib49">Murphy et al., 2020</xref>; <xref ref-type="bibr" rid="bib77">Zhao et al., 2019</xref>). This encoding was similar for the three hazard-rate conditions, implying that the hazard-dependent effects of prediction and tone switches on pupil depicted in <xref ref-type="fig" rid="fig2">Figure 2</xref> reflected a common underlying relationship between pupil and belief updating. In particular, baseline pupil diameter was negatively correlated with the idiosyncratic model-derived belief strength (i.e., inverse uncertainty derived from subject-specific model fits), such that baseline pupil diameter was smaller when beliefs about the next source were more certain (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). After the tone was heard, evoked changes in pupil diameter were closely associated with surprise, with more surprising stimuli evoking larger pupil dilations with a time course similar to the switch modulations (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). Evoked change also reflected information about the prediction belief strength before having heard the tone, such that pupils dilated slightly less after tone onset if beliefs were very strong, regardless of surprise. Thus, on each trial, baseline and evoked changes in pupil diameter reflected top-down computations of uncertainty and surprise, respectively, in a manner that depended on the context in which the stimuli were experienced.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Pupil size encoded belief strength and surprise.</title><p>Each panel shows two-tailed linear mixed-effects beta weights estimating the influence of subject absolute belief strength and surprise on: (<bold>a</bold>) baseline pupil diameter, after accounting for the evoked pupil change from the previous trial; (<bold>b</bold>) evoked change in pupil diameter, after accounting for baseline pupil on the current trial along with the baseline pupil and the evoked pupil from the previous trial; (<bold>c</bold>) log RT (i.e., the time taken to make a prediction before hearing the tone); and (<bold>d</bold>) log RT on the next trial. Note that surprise depended on the current belief strength that was present before tone onset, which likely explains the small modulations by surprise in the high-hazard baseline pupil and low-hazard prediction RT. In a, c, and d, boxplots show median, IQR, IQR x 1.5, and outliers; **: p&lt;0.01, ***: p&lt;0.001. In b, lines and shading correspond to mean ± SEM across subjects, and straight lines above (for positive betas) and below (for negative betas) beta values indicate significant timepoints (FWE corrected p&lt;0.05).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Bayesian model used to compute belief strength and surprise.</title><p>(<bold>a</bold>) Simulations from the Bayesian learning model with a wide prior (left panels) or a narrow prior (right panels) over hazard rate. For each pair of panels, the left panel shows the prior over hazard rate (governed by two parameters, as shown: mean <italic>μ</italic> and precision <italic>ϕ</italic>), and the right panel shows performance versus the number of trials since the previous change-point, separated by hazard rate (as in <xref ref-type="fig" rid="fig1">Figure 1c,d</xref>). Points and error bars correspond to mean ± SEM across simulated subjects. (<bold>b</bold>) Average subject prior computed from fits of the Bayesian learning model to subject-specific behavioral data and the corresponding absolute belief strength (teal) and surprise values (pink) for 400 example trials (the tone location and hazard rate are shown above).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Complimentary analysis to <xref ref-type="fig" rid="fig3">Figure 3b</xref> measuring the influence of belief strength and surprise on the first temporal derivative of evoked changes in pupil diameter.</title><p>An approximation of the first temporal derivative was measured as the signed difference between each timepoint after tone onset and the previous timepoint. All regressions were performed with baseline pupil diameter from the current trial, and baseline and evoked changes in pupil diameter from the previous trial, as nuisance regressors. Lines and shading correspond to mean ± SEM across subjects, and straight lines above (for positive betas) and below (for negative betas) beta values indicate significant timepoints (FWE corrected p&lt;0.05).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Pupils encode belief strength and surprise independently of RT.</title><p>Linear mixed-effects beta weights estimating the influence of subject absolute belief strength and surprise on: (<bold>a</bold>) baseline pupil diameter, after accounting for log RT on the current trial and the previous evoked pupil change; and (<bold>b</bold>) evoked change, after accounting for log RT on the next trial and baseline pupil on the current trial and baseline pupil and evoked from the previous trial. In a, solid horizontal lines, hinges, whiskers, and points correspond to median, interquartile range, interquartile x 1.5, and outliers, respectively; **: p&lt;0.01, ***: p&lt;0.001. In b, lines and shading correspond to mean ± SEM across subjects, and straight lines above (for positive betas) and below (for negative betas) beta values indicate significant timepoints (FWE corrected p&lt;0.05).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig3-figsupp3-v2.tif"/></fig></fig-group><p>Similar effects were evident in the subjects’ behavioral response times (RTs), which tended to be shorter on trials when beliefs were more certain and longer on trials following the occurrence of a surprising stimulus (<xref ref-type="fig" rid="fig3">Figure 3c,d</xref>). These RT effects testify to the behavioral relevance of these model-derived quantities but did not alone account for their relationships with pupil size: although there was a modest trial-to-trial correlation between the RT after hearing the tone and changes in pupil diameter on the same trial (median [IQR] Spearman’s <italic>rho</italic> computed per subject = 0.11 [0.06–0.18] for baseline pupil and 0.12 [0.07–0.18] for evoked pupil, sign-rank test for <italic>H<sub>0</sub></italic>: median = 0, all <italic>p</italic>s &lt; 3.7×10<sup>−7</sup>), baseline and evoked pupil changes showed the same strong modulations by belief strength and surprise, respectively, even when accounting for trial-by-trial RTs (Fig. <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>). Thus, task-dependent pupil modulations provided more information about the belief-updating process than simply how that process affected RT.</p></sec><sec id="s2-3"><title>Pupil dynamics reflect individual differences in belief-updating complexity</title><p>The preceding analyses showed group-level relationships between trial-by-trial belief updating dynamics and pupil diameter. However, the nature of this belief-updating process varied considerably across subjects. We reported previously that a major component of individual variability on this kind of task can be ascribed to differences in the complexity of each subject’s belief-updating strategy (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>). Complexity measures the amount of past information a given belief-updating strategy encodes to predict future events, which captures the flexibility with which new observations are used to update the belief (<xref ref-type="bibr" rid="bib8">Bialek et al., 2001</xref>; <xref ref-type="bibr" rid="bib27">Gilad-Bachrach et al., 2003</xref>; <xref ref-type="bibr" rid="bib50">Myung et al., 2000</xref>). Complex strategies can be helpful if the past features they encode are useful for prediction (e.g., tracking today’s temperature, barometric pressure, and weather trends to predict tomorrow’s weather) but can also lead to errors if the past features they encode are irrelevant (e.g., using today’s European weather trends to predict tomorrow’s weather in New York). Thus, a key signature of this form of complexity is a trade-off that is well known in statistics and machine learning between: 1) bias, or the (in) ability to flexibly update beliefs given new, relevant observations; and 2) variance, or the propensity to over-adjust beliefs given new, irrelevant (e.g., noisy) observations (<xref ref-type="bibr" rid="bib9">Bishop, 2006</xref>). This bias-variance trade-off was evident in the present data set, such that subjects who tended to adjust their beliefs appropriately to real changes in hazard rate (low bias) also tended to have more variable choices even when the hazard rate remained fixed (high variance; <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Below we show that the corresponding individual differences in belief-updating complexity were reflected in certain features of task-driven pupil modulations.</p><p>We characterized individual differences in belief-updating complexity using an information-bottleneck analysis (<xref ref-type="bibr" rid="bib56">Palmer et al., 2015</xref>; <xref ref-type="bibr" rid="bib69">Tishby et al., 2000</xref>). Specifically, we quantified for each subject the mutual information between the sequences of task conditions on the previous trial (i.e., the sound location and hazard rate, which together we refer to as the past ‘feature’ <italic>F</italic>) and their current predictions (<italic>R</italic>), after subtracting the information contained in the sound sequence (<xref ref-type="fig" rid="fig4">Figure 4a,b</xref>; <xref ref-type="bibr" rid="bib13">Chechik, 2005</xref>; <xref ref-type="bibr" rid="bib69">Tishby et al., 2000</xref>). This method provided a model-agnostic measure of the extent to which each subject’s predictions relied on both stimulus and hazard-rate information, while also accounting for differences in the specific stimulus (tone-location) sequences that each subject experienced (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>). Unlike other measures of complexity that are based on a model’s functional form (e.g., Bayesian model-selection methods; <xref ref-type="bibr" rid="bib1">Akaike, 1974</xref>; <xref ref-type="bibr" rid="bib50">Myung et al., 2000</xref>; <xref ref-type="bibr" rid="bib63">Schwarz, 1978</xref>), this method provided a principled and data-driven measure of individual differences in belief-updating complexity that required no assumptions about the specific strategy each subject was using to perform the task (<xref ref-type="bibr" rid="bib8">Bialek et al., 2001</xref>; <xref ref-type="bibr" rid="bib13">Chechik, 2005</xref>; <xref ref-type="bibr" rid="bib26">Filipowicz et al., 2020</xref>; <xref ref-type="bibr" rid="bib69">Tishby et al., 2000</xref>). Consistent with definitions of model complexity in information theory and Bayesian model selection, more complex belief-updating strategies, such as those that explore larger hypothesis spaces, encode more information from the past to make predictions (<xref ref-type="bibr" rid="bib8">Bialek et al., 2001</xref>; <xref ref-type="bibr" rid="bib26">Filipowicz et al., 2020</xref>; <xref ref-type="bibr" rid="bib50">Myung et al., 2000</xref>). As expected given this definition of complexity, subjects using more complex strategies tended to have behavioral patterns that depended more strongly on the hazard-rate condition (<xref ref-type="fig" rid="fig4">Figure 4c</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The subjects differed in belief-updating complexity.</title><p>(<bold>a</bold>) The information-bottleneck measure of complexity, computed as the mutual information between past task features (the combination of the binary tone location, <italic>x,</italic> and hazard rate, <italic>H,</italic> from previous trials) and the current binary prediction, <italic>r.</italic> (<bold>b</bold>) To account for idiosyncratic differences in the sequences of tones that each subject heard, the mutual information between adjacent tones in the actual sequence (‘Sequence <italic>I<sub>past</sub></italic>’) was subtracted from their respective model complexity. The result corresponds to the degree to which subjects encoded hazard-related information in their predictions. (<bold>c</bold>) Average task performance plotted for groups of subjects split by complexity tercile (in bits). Subjects with more complex belief-updating strategies showed stronger hazard-modulated behavior.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Individual differences in performance reflected a bias-variance trade-off, similar to what we reported previously (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>).</title><p>Using fits of the adaptivity model to each subject’s behavioral choices, we quantified: (<bold>a</bold>) adaptivity as the linear relationship between subjective (fit) and objective hazard rate, such that higher adaptivity implies lower ‘bias’ (i.e., an increased ability to adapt to real changes in the hazard-rate condition); and (<bold>b</bold>) choice variability as the slope of the psychometric function relating choices to belief strength, such that higher variability implies higher ‘variance’ (i.e., a propensity to over-adjust beliefs to different stimulus sequences, even when the hazard rate remained unchanged). (<bold>c</bold>) There was a strong, positive relationship between choice variability and adaptivity across subjects, such that subjects with higher adaptivity (lower bias) tended also to have higher choice variability (higher variance). The line is a linear fit.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Parameter recovery for the: (<bold>a</bold>) adaptivity model and (<bold>b</bold>) Bayesian learning model.</title><p>Parameter recovery was performed by simulating responses using subject fits (abscissa) and examining the parameters recovered when fitting those simulated responses (ordinate).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig4-figsupp2-v2.tif"/></fig></fig-group><p>These individual differences in belief-updating complexity were reflected in task-driven pupil modulations. Specifically, we used linear regression to relate changes in baseline pupil diameter from individual subjects to trial-by-trial estimates of belief strength that were computed using a particular, high-complexity learning model (i.e., the Bayesian learning model introduced above with a wide prior over hazard rate, which was not fit to subject data but rather used as reference strategy; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref>) applied to each subject’s task sequence. This relationship between baseline pupil fluctuations and complex belief strength became systematically stronger (more negatively correlated) for subjects who were using increasingly complex belief-updating strategies (<xref ref-type="fig" rid="fig5">Figure 5</xref>). This finding is consistent with our other findings, described above, that: 1) there was, on average, a negative correlation between trial-by-trial baseline pupil diameter and belief strength determined via fits of the Bayesian learning model to each subject’s behavioral data (<xref ref-type="fig" rid="fig3">Figure 3</xref>); and 2) the subjects’ belief-updating strategies varied considerably in complexity (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). That is, given that each subject’s pupil modulations reflected their own belief-updating strategy, and given that those strategies differed in complexity across subjects, it followed that their pupil modulations, measured with respect to a fixed referent strategy, reflected the complexity of their strategy. A similar relationship with complexity was not evident in the surprise-modulated evoked-pupil responses (<xref ref-type="fig" rid="fig4">Figure 4b</xref>), possibly reflecting relatively stronger bottom-up modulation in evoked versus baseline pupil. Together these results imply that certain features of trial-by-trial pupil dynamics can encode the idiosyncratic complexity of the cognitively driven belief-updating processes.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Individual differences in belief-updating complexity were reflected in across-hazard modulations of baseline, but not evoked, pupil diameter.</title><p>(<bold>a</bold>) Strength of modulation of baseline pupil diameter by absolute belief strength from the complex learning model plotted as a function of the subject’s belief-updating complexity. Subjects using simple strategies tended to have baseline pupil dynamics that were uncorrelated with the complex model’s belief-updating process, whereas subjects using complex strategies tended to have baseline pupil dynamics that were anti-correlated (i.e., pupils were less dilated when the model predicted higher belief certainty) with the complex model’s belief-updating process. The solid line is a linear fit. (<bold>b</bold>) Strength of modulation of peak evoked changes from baseline by surprise from the complex learning model plotted as a function of the subject’s belief-updating complexity. Evoked changes in pupil diameter tended to be modulated positively by surprise in the complex model, regardless of the subject’s belief-updating complexity. Points correspond to data from individual subjects. In both panels, the ordinates show the strength (computed via linear regression) of pupil modulations with respect to a particular, complex belief-updating strategy: the Bayesian model with a wide prior on hazard (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig5-v2.tif"/></fig><p>To better understand the trial-by-trial nature of these idiosyncratic, cognitively driven pupil modulations, we examined how complexity related to both behavior and changes in pupil diameter within each of the three hazard-rate conditions. Because our measure of complexity was determined by assessing patterns of choices across hazard-rate conditions, we first had to establish how it related to individual differences in performance within each hazard-rate condition. In general, subjects with more complex strategies tended to make predictions that better matched the objective hazard rate (assessed by fitting the normative choice model to behavior with subjective hazard rate as a free parameter in hazard-specific blocks; <xref ref-type="bibr" rid="bib29">Glaze et al., 2015</xref>; <xref ref-type="fig" rid="fig6">Figure 6a</xref>) and have higher overall accuracy (<xref ref-type="fig" rid="fig6">Figure 6b</xref>) in each of the three hazard-rate conditions.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Individual differences in within-hazard performance reflected differences in belief-updating complexity.</title><p>The two panels show complexity (abscissa) compared to: (<bold>a</bold>) subjective hazard rate determined from fits of the normative choice model (colored dotted lines correspond to objective hazard-rate values), and (<bold>b</bold>) proportion correct responses (colored dotted lines correspond to mean proportion correct responses from the Bayesian learning model with a wide prior over hazard rate). Points are data from individual subjects. Lines are linear fits. Note that subjective hazard rates and overall performance were relatively more variable and further from normative values for the high versus low and intermediate hazard-rate conditions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig6-v2.tif"/></fig><p>Strikingly, however, both of these behavioral effects were most pronounced for the high hazard-rate condition. Several lines of evidence suggest that these effects reflected higher cognitive demands for the high hazard-rate condition, which as emphasized above (<xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>) was the only condition that involved a conflict between bottom-up stimulus changes and top-down expectation violations, such that effective belief updating could not rely on stimulus changes alone to signal surprise. First, subjective hazard rates were most variable and most strongly mis-matched to objective values (dotted lines in <xref ref-type="fig" rid="fig6">Figure 6a</xref>) in the high hazard-rate condition (<italic>F</italic>-test comparing the variance of fits for each hazard rate condition: low versus high, p=2.2×10<sup>−10</sup>; intermediate versus high, p=1.0×10<sup>−13</sup>; low versus intermediate, p=0.179). Second, performance accuracy was furthest from the ceiling provided by a fully adaptive Bayesian learning model in the high hazard-rate condition (median [IQR] difference in accuracy compared with wide-prior model depicted in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1a</xref> = 0.11 [0.08–0.15], 0.04 [0.03–0.07], and 0.29 [0.25–0.36] for the low, intermediate, and high hazard-rate conditions, respectively; two-tailed paired Wilcoxon tests comparing the difference in high versus low and intermediate hazards conditions, all <italic>p</italic>s &lt; 8.5×10<sup>−10</sup>). Third, RTs were slowest in the high-hazard condition (median [IQR] RT for all trials and subjects = 478 [381–560], 507 [415–635], and 641 [513–790] ms for the low, intermediate, and high hazard-rate conditions, respectively; two-tailed paired sign-rank test for <italic>H<sub>0</sub></italic>: median difference = 0, all <italic>ps</italic> &lt; 0.0007). Thus, despite the fact that the same level of accuracy could, in principle, be achieved in the high and low hazard-rate conditions, and that both conditions were more predictable than the intermediate hazard-rate condition, subjects had more difficulty learning in the high hazard-rate condition. Accordingly, only the best-performing subjects, who used the most complex belief-updating strategies, developed expectations for the highly unstable (high-hazard) condition that were as effective as the expectations developed by virtually all of the subjects for the highly stable (low-hazard) condition.</p><p>Consistent with these observations, individual differences in belief-updating complexity were reflected in pupil diameter in the high, but not the low or intermediate, hazard-rate condition. Specifically, subjects with more complex belief-updating strategies were able to learn much more appropriate expectations and thus perform closer to ceiling than subjects with less complex strategies in the high hazard-rate condition. For these subjects with complex strategies, tone switches versus repeats tended to more strongly reinforce their belief (i.e., reduce their uncertainty) that the source had switched, which corresponded to smaller baseline pupil diameter on the next trial (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). Based on these more appropriate expectations, subsequent tone switches versus repeats tended to be less surprising, which corresponded to smaller evoked pupil responses (<xref ref-type="fig" rid="fig7">Figure 7b</xref>). In contrast, these relationships were not evident in the low and intermediate hazard-rate conditions, in which almost all subjects used strategies that led to near-ceiling levels of performance. These across-hazard differences have important implications for understanding the nature of cognitive demands that drive pupil modulations that we discuss below.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Individual differences in belief-updating complexity were reflected in within-hazard modulations of both baseline and evoked pupil diameter in the high hazard-rate condition that required a dissociation of top-down expectations from bottom-up stimulus changes.</title><p>The two panels show (<bold>a</bold>) baseline and (<bold>b</bold>) evoked changes in pupil responses on tone switch versus repeat trials as a function of belief-updating complexity. Pupil measurements were computed as residuals from a linear model that accounted for nuisance variables including the baseline pupil diameter (for evoked changes) and the evoked change in pupil diameter from the previous trial (<xref ref-type="disp-formula" rid="equ14">Equation 14</xref>). Points indicate data from individual subjects. Lines are linear fits for cases for which <italic>H<sub>0</sub></italic>: Spearman correlation coefficient (<italic>rho</italic>, indicated for each data set)=0, p&lt;0.05.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57872-fig7-v2.tif"/></fig><p>It was also notable that this relationship between belief-updating complexity and pupil diameter in the high hazard-rate condition was evident in both baseline and evoked pupil diameter. The relationship was stronger for baseline pupil diameter, which drove the complexity-dependent, across-hazard relationships between belief strength and baseline pupil shown in <xref ref-type="fig" rid="fig5">Figure 5a</xref>. In contrast, the slightly weaker relationship for evoked pupil did not produce a comparable complexity-dependent, across-hazard relationship between surprise and evoked pupil (<xref ref-type="fig" rid="fig5">Figure 5b</xref>), reflecting the fact that the evoked pupil responses were more strongly stimulus driven (<xref ref-type="fig" rid="fig2">Figure 2</xref>) and slightly less variable across subjects (<xref ref-type="fig" rid="fig7">Figure 7</xref>) than baseline pupil. Thus, under conditions in which individual differences in top-down belief-updating strategies had a substantial impact on behavior (i.e., in the more difficult high hazard-rate condition), an individual’s strategy affected both how the pupil responded to task-relevant stimuli and then, to an even greater extent, modulations in the subsequent baseline pupil size that anticipated deployment of that strategy.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We examined relationships between pupil size and belief updating in human subjects performing an on-line predictive-inference task and report three primary findings. First, task-driven modulations of pupil size reflected context-dependent violations of learned expectations and not just bottom-up stimulus changes. Second, these cognitively driven changes in both baseline and evoked changes in pupil size could be parsimoniously understood as representing belief strength and surprise, respectively, associated with the subjects’ trial-by-trial inferences about latent, task-relevant properties of the environment (in this case, a joint inference about the location of the source that would generate the next sound and the hazard rate that governed how often the location of the source switched from one side to the other). Third, these pupil dynamics reflected not just average belief-updating processes but also how they were implemented by individual subjects, further testifying to their behavioral and cognitive relevance. In particular, individual differences in belief-updating complexity were reflected in both baseline and evoked pupil responses under conditions in which the belief-updating process could not rely on bottom-up stimulus changes alone to identify surprising violations of expectations (the high hazard-rate condition).</p><p>These results help to clarify the nature of cognitive modulations of pupil size, including baseline or tonic values that have been associated with ‘mental effort’ (<xref ref-type="bibr" rid="bib6">Beatty, 1982</xref>; <xref ref-type="bibr" rid="bib44">Mathôt, 2018</xref>). According to our results, these modulations do not simply reflect: 1) objective task difficulty, because in our study objective difficulty was equivalent in the low and high hazard-rate conditions that had substantially different pupil responses; 2) overall performance, because performance was similar in the intermediate and high hazard-rate conditions that also had substantially different pupil responses; or 3) RTs, which were only weakly related to pupil diameter on a trial-by-trial basis. Instead, our results suggest that tonic pupil-linked arousal is closely associated with a belief-updating process that aims to reduce uncertainty by interpreting new data according to multiple possible hypotheses (i.e., different hazard rates), which is consistent with a recent proposal that pupil-linked arousal encodes periods of information gain (<xref ref-type="bibr" rid="bib76">Zénon, 2019</xref>). Our results extend this idea by showing that pupil modulations are also sensitive to the complexity of the belief-updating process, which may be related to traditional notions of cognitive load (<xref ref-type="bibr" rid="bib6">Beatty, 1982</xref>; <xref ref-type="bibr" rid="bib44">Mathôt, 2018</xref>). These ideas are related to previous findings showing that pupil dynamics can reflect uncertainty related to under-sampling (<xref ref-type="bibr" rid="bib52">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>) and to subjective estimates of environmental volatility (<xref ref-type="bibr" rid="bib72">Vincent et al., 2019</xref>), which is a component of the belief-updating process that our subjects appeared to be using to solve the task.</p><p>A striking feature of the pupil-linked belief-updating process in our task was an asymmetry in how effectively it was applied to the different task conditions. As we reported previously, subjects tended to adapt incompletely to relatively predictable environments, including over-estimating low hazard rates and under-estimating high hazard rates (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>; <xref ref-type="bibr" rid="bib29">Glaze et al., 2015</xref>; <xref ref-type="bibr" rid="bib37">Kim et al., 2017</xref>). Here we showed that, despite the fact that those two hazard-rate conditions were equally predictable, these incomplete adaptations were asymmetric between the two conditions, with considerably worse and more variable performance in the high hazard-rate condition. This asymmetry was mirrored in pupil responses, with weaker overall modulations by surprise that varied systematically across subjects with belief-updating complexity in the high hazard-rate condition. These asymmetric modulations of pupil and behavior reflected the fact that in the low hazard-rate condition, belief updating could use congruent bottom-up and top-down information (i.e., stimulus changes were surprising), whereas in the high hazard-rate condition, belief updating was based on top-down processing that was incongruent with bottom-up information (i.e., stimulus repeats were surprising). Thus, the high hazard-rate condition promoted a greater sensitivity of both behavior and pupil dynamics to individual differences in top-down belief-updating strategies. It would be interesting to see if such an asymmetry occurs more generally when bottom-up and top-down information processing is and is not in conflict, including in the context of other proposed roles for pupil-linked arousal changes such as reductions in choice biases (<xref ref-type="bibr" rid="bib17">de Gee et al., 2017</xref>).</p><p>Our findings also provide insights into the neural mechanisms that underlie adaptive and dynamic belief-updating processes. Increases in pupil size have been tied to higher levels of activation of the brainstem nucleus locus coeruleus (LC), which is the primary source of norepinephrine (NE) to the brain (<xref ref-type="bibr" rid="bib17">de Gee et al., 2017</xref>; <xref ref-type="bibr" rid="bib35">Joshi et al., 2016</xref>; <xref ref-type="bibr" rid="bib42">Liu et al., 2017</xref>; <xref ref-type="bibr" rid="bib48">Murphy et al., 2014</xref>; <xref ref-type="bibr" rid="bib36">Joshi and Gold, 2020</xref>). Adaptive gain theory proposes that tonic release of NE occurs during periods of active exploration (<xref ref-type="bibr" rid="bib3">Aston-Jones and Cohen, 2005</xref>; <xref ref-type="bibr" rid="bib2">Aston-Jones et al., 1999</xref>). This idea is consistent with our finding of increased baseline pupil size under conditions of low belief (high uncertainty). Specifically, although physical exploration is absent in our task, there may be a form of ‘mental exploration’ that occurs when beliefs are weak and alternative explanations for the observed data are sought in terms of the hypothesis space of possible hazard rates (e.g., the prior distribution over hazard rates in our Bayesian learning model; <xref ref-type="bibr" rid="bib14">Collins and Koechlin, 2012</xref>; <xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>; <xref ref-type="bibr" rid="bib73">Wilson et al., 2010</xref>). Our results suggest that this covert process, like active exploration in adaptive gain theory, may involve increases in activation of the LC-NE system (and possibly the basal forebrain-acetylcholine neuromodulatory system, which has also been linked to pupil dynamics; <xref ref-type="bibr" rid="bib60">Reimer et al., 2016</xref>) during periods of high uncertainty (<xref ref-type="bibr" rid="bib74">Yu and Dayan, 2005</xref>).</p><p>Phasic, event-driven release of NE, possibly corresponding to evoked pupil changes in response to surprise as described in our and other studies (<xref ref-type="bibr" rid="bib35">Joshi et al., 2016</xref>; <xref ref-type="bibr" rid="bib52">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib55">O'Reilly et al., 2013</xref>; <xref ref-type="bibr" rid="bib57">Preuschoff et al., 2011</xref>), may play a complementary role in adaptive inference. Instead of promoting exploration, phasic NE release is thought to result in widespread network ‘resets’ that interrupt and initiate the reorganization of neural networks engaged during a task, possibly reducing previously learned biases and enhancing the relevance of new observations (<xref ref-type="bibr" rid="bib10">Bouret and Sara, 2005</xref>; <xref ref-type="bibr" rid="bib17">de Gee et al., 2017</xref>; <xref ref-type="bibr" rid="bib61">Sara, 2009</xref>). Our results suggest that this kind of network reset can occur for not just an abrupt, surprising change in sensory input, but also an abrupt, surprising lack of change in sensory input.</p><p>Sensitivity to such different kinds of violations of expectations would require the LC and other relevant brain systems to have access to a flexible, complexity-dependent combination of bottom-up and top-down information. One possible source of such information is the anterior cingulate cortex (ACC; <xref ref-type="bibr" rid="bib3">Aston-Jones and Cohen, 2005</xref>), which is reciprocally connected with the LC and has been proposed to guide executive control, allocating when and how executive resources are used during cognitively demanding tasks (<xref ref-type="bibr" rid="bib24">Filipowicz et al., 2016</xref>; <xref ref-type="bibr" rid="bib64">Shenhav et al., 2013</xref>; <xref ref-type="bibr" rid="bib65">Shenhav et al., 2016</xref>; <xref ref-type="bibr" rid="bib66">Shenhav et al., 2017</xref>). During adaptive decision-making, the ACC and the anterior insula are active when changes are detected and mental models are updated (<xref ref-type="bibr" rid="bib7">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib20">Donoso et al., 2014</xref>; <xref ref-type="bibr" rid="bib45">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">O'Reilly et al., 2013</xref>; <xref ref-type="bibr" rid="bib62">Sarafyazd and Jazayeri, 2019</xref>; <xref ref-type="bibr" rid="bib67">Stöttinger et al., 2015</xref>). Moreover, these kinds of signals have been linked directly with computations related to surprise and uncertainty (<xref ref-type="bibr" rid="bib45">McGuire et al., 2014</xref>; <xref ref-type="bibr" rid="bib53">Nassar et al., 2019</xref>). The ACC and anterior insula mediate activation of prefrontal cortical regions, such as the anterior and dorsolateral prefrontal cortex (<xref ref-type="bibr" rid="bib4">Bastin et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Domenech and Koechlin, 2015</xref>; <xref ref-type="bibr" rid="bib33">Ham et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Menon and Uddin, 2010</xref>; <xref ref-type="bibr" rid="bib67">Stöttinger et al., 2015</xref>), that are involved in the prospective and counterfactual reasoning that are characteristic of the exploratory strategies humans use to update mental models (<xref ref-type="bibr" rid="bib15">Daw et al., 2006</xref>; <xref ref-type="bibr" rid="bib19">Domenech and Koechlin, 2015</xref>; <xref ref-type="bibr" rid="bib20">Donoso et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">Koechlin and Hyafil, 2007a</xref>; <xref ref-type="bibr" rid="bib39">Koechlin and Summerfield, 2007b</xref>; <xref ref-type="bibr" rid="bib67">Stöttinger et al., 2015</xref>; <xref ref-type="bibr" rid="bib75">Zajkowski et al., 2017</xref>). Our results suggest that increased activity in the LC, along with the network of brain regions with which it connects, could be more engaged in subjects with more complex mental models, guiding some of the idiosyncratic strategies observed between subjects.</p><p>In summary, the results of this study provide new insights into the cognitive signals that drive pupil diameter, including combinations of bottom-up and top-down processing that are used in idiosyncratic ways to update and maintain appropriate beliefs about an environment. These results can help guide future research to examine how dynamic modulation of physiological arousal influences the information processing trade-offs humans use when learning in dynamic and uncertain environments.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Auditory predictive-inference task</title><p>Seventy-eight University of Pennsylvania undergraduates (49 male, 29 female) performed an auditory predictive-inference task that required them to predict the source location (left or right) of the subsequently presented auditory tone on each trial. On each trial, the subject made a prediction via left and right buttons on a game pad to indicate which source they thought would generate the next tone. Three seconds after each prediction, a 300 ms auditory tone (196 Hz) was played in either the left or right ear via headphones. The next trial then started with no inter-trial interval; thus, RTs were measured from the onset of the tone on the previous trial to the onset of the button press on the current trial. Subjects were encouraged to maintain fixation on a white fixation circle presented on a blue screen placed in front of them throughout the task but were allowed self-timed breaks by breaking fixation after making a prediction. Visual and auditory stimuli were generated using SnowDots stimulus presentation software in MATLAB (<ext-link ext-link-type="uri" xlink:href="https://github.com/TheGoldLab/Lab-Matlab-Control">https://github.com/TheGoldLab/Lab-Matlab-Control</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Lab_Matlab_Control">https://github.com/elifesciences-publications/Lab_Matlab_Control</ext-link>; <xref ref-type="bibr" rid="bib31">Gold et al., 2020</xref>).</p><p>Subjects were informed that the left source had an 80/20 probability of generating left/right tones, respectively, and that the right source had an 80/20 probability of generating right/left tones, respectively. Subjects were also informed that one source was generating tones on each trial, and that the sources would sometimes switch. Subjects were also informed that the rate of these switches, or ‘hazard rate’, would also switch, such that on some trials, the sources switched either infrequently (<italic>H</italic> = 0.01; low hazard rate), at an intermediate rate (<italic>H</italic> = 0.3; intermediate hazard rate), or very frequently (<italic>H</italic> = 0.99; high hazard rate). Subjects performed 1–3 sessions of 1000 trials each, with each session occurring on a separate day. Although all subjects were scheduled to participate in all three sessions, most completed only one (<italic>n</italic> = 39) or two (<italic>n</italic> = 29) sessions but were still included in the analyses (linear mixed-effects models described below were used to account for missed sessions). Two of the three hazard rates were included in each session, and the hazard rates themselves also switched infrequently throughout the session. Session order was counterbalanced between subjects. The sequence of sound-source locations were different across the three sessions for each subject but were the same across subjects. The exact sequences of tones, sources, and hazard rates for each of the three sessions are displayed in <xref ref-type="fig" rid="fig1">Figure 1b</xref>.</p><p>Subjects received $10 USD per hour of participation with an additional performance bonus for accumulated correct predictions (total per session payout was $10–20 USD). The study protocol was reviewed and approved by the University of Pennsylvania’s Institutional Review Board (IRB Protocol # 816727). All subjects provided written informed consent prior to participating in the study.</p></sec><sec id="s4-2"><title>Measuring pupil diameter</title><p>Of the 78 total subjects, 55 had their pupils recorded while performing the task. Pupils were recorded using either a Tobii T60-XL sampling both eyes at 60 Hz (<italic>n</italic> = 45), or an SR Research Eyelink 1000+ sampling the right eye at 1000 Hz (<italic>n</italic> = 10). Signals from the Eyelink were subsequently down sampled to 60 Hz to make them comparable to signals from the Tobii. Baseline pupil diameter was measured as the mean pupil diameter 0–100 ms prior to tone onset. Evoked changes were measured from baseline-subtracted pupil diameter during a 2 s window after tone onset.</p></sec><sec id="s4-3"><title>Pupil processing</title><p>We removed pupil samples corresponding to: 1) abnormally fast changes in pupil diameter (defined as ±3 SD from the median temporal derivative), such as around blink events, and 2) any additionally samples in which the eye position fell 10% of the screen diameter away from the fixation point. Eye movements in the x and y direction were regressed from the remaining samples and missing values were then linearly interpolated and filtered using a first-order Butterworth filter with a 4 Hz cutoff (<xref ref-type="bibr" rid="bib12">Browning et al., 2015</xref>; <xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>; <xref ref-type="bibr" rid="bib52">Nassar et al., 2012</xref>). Trials with &gt;50% missing/interpolated samples were omitted from further analysis (~9% of trials were omitted; <xref ref-type="bibr" rid="bib12">Browning et al., 2015</xref>).</p></sec><sec id="s4-4"><title>Complexity measure</title><p>We used a data-driven approach to measure belief-updating complexity based on the principles of predictive information and the information bottleneck (<xref ref-type="bibr" rid="bib8">Bialek et al., 2001</xref>; <xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>; <xref ref-type="bibr" rid="bib69">Tishby et al., 2000</xref>). The information-bottleneck method seeks the smallest compression <italic>Z</italic> of past observations that retain maximum predictability about the future. This compression represents a ‘model’ that encodes the past observations (<xref ref-type="bibr" rid="bib13">Chechik, 2005</xref>; <xref ref-type="bibr" rid="bib69">Tishby et al., 2000</xref>). The size of the compression (<italic>I<sub>past</sub></italic>), corresponding to the model’s complexity, is measured (in bits) as the mutual information between the <italic>Z</italic> and past observations <italic>X<sub>past</sub></italic>, <italic>I<sub>past</sub></italic> = <italic>I</italic>(<italic>X<sub>past</sub>; Z</italic>).</p><p>Belief-updating complexity was measured as the extent to which a subject’s responses <italic>R</italic> (a prediction of the left or right source) on the current trial <italic>t</italic> encoded past stimulus features <italic>F</italic> from past trials <italic>t’&lt;t</italic>:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:munder><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The features <italic>F</italic> consisted of all six possible combinations of tone side (left or right) and hazard rate (0.01, 0.3, or 0.99) on each trial. Information-theoretic quantities such as mutual information can be biased by small sampling errors. Although this influence was mitigated in part by the fact that the sequence of tones was held constant in each session for each subject, not all subjects participated in all sessions. We therefore corrected for these biases by subtracting the mutual information contained within the sequence of tones themselves, <italic>I(tones<sub>t′&lt;t</sub>;tones<sub>t</sub>)</italic>, from each subject’s <italic>I<sub>past</sub></italic> (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>). The remaining information corresponds to the amount of information subjects encode about the task hazard rate, beyond that provided by the stimuli.</p></sec><sec id="s4-5"><title>Normative choice model</title><p>To determine each subject’s subjective hazard rate corresponding to each objective hazard-rate condition, we fit their predictions to a normative choice model with hazard rate as a free parameter, as we have done previously (<xref ref-type="fig" rid="fig6">Figure 6a</xref>; <xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>; <xref ref-type="bibr" rid="bib29">Glaze et al., 2015</xref>). For this task, the subject’s goal was to predict which of two sources would generate a tone on the current trial. The model characterizes the belief <italic>L</italic> on trial <italic>t</italic> as the log-posterior-odds that the next tone will be generated by the first or second source:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></disp-formula>where <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> indicates the log-prior-odds that either source will generate the next tone and <inline-formula><mml:math id="inf2"><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> indicates the log evidence that the tone was generated by the first or second source. Given that there are only two states, we assigned positive log-prior-odds to the probability that a tone would be generated by the right source. The log-prior-odds <inline-formula><mml:math id="inf3"><mml:mi>ψ</mml:mi></mml:math></inline-formula> were computed using the log-posterior-odds from the previous trial <italic>L<sub>t-1</sub></italic> and incorporating the current hazard rate <italic>H<sub>t</sub></italic>:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">L</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi mathvariant="normal">H</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">L</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The posterior belief for a trial <italic>t</italic> was then calculated as the log-prior-odds plus the evidence provided on each trial, calculated as the log-likelihood ratio that the current tone (<italic>x<sub>t</sub></italic>) was generated by the left or right source (<italic>z<sub>1</sub></italic> and <italic>z<sub>2</sub></italic> respectively)<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Subjective estimates of each separate hazard rate (<xref ref-type="fig" rid="fig6">Figure 6a</xref>) were computed by fitting the model in <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> separately for each hazard-rate condition, keeping <italic>H</italic> as a free parameter in each case (i.e., three free parameters, one for each value of <italic>H</italic>). The model was fit to choice behavior by writing the probability of choosing the right source as a logistic function of the log-prior-odds <inline-formula><mml:math id="inf4"><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as the decision variable, given that the subject’s responses were made before hearing a tone on each trial:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Fitting was performed using gradient decent with multiple starting points to find values of the three free parameters, (three values of <italic>H</italic> for each respective hazard rate) that minimize the cross entropy:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We also fit a variant of this model to assess each subject’s bias-variance trade-off; that is, the relationship between their adaptivity to changes in hazard rate and their choice variability (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>). This model used the same computations as from <xref ref-type="disp-formula" rid="equ2 equ3 equ4">Equations 2–4</xref>, but calculated subjective estimates of the log hazard-rate odds on trial <italic>t</italic> (<italic>J<sub>t,subjective</sub></italic> = log[<italic>H<sub>t,subjective</sub></italic>/(1- <italic>H<sub>t,subjective</sub></italic>)]) as a linear function of the current, objective log-hazard rate odds (<italic>J<sub>t,objective</sub></italic>):<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></disp-formula>where <italic>J<sub>default</sub></italic> indicates the intercept and <italic>m<sub>H</sub></italic> indicates the slope of the regression, which describes the subject’s adaptivity to changes in the task hazard rate. Choices were generated by adding a free parameter <inline-formula><mml:math id="inf5"><mml:mi>v</mml:mi></mml:math></inline-formula> capturing noise in the decision variable (i.e., choice variability):<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>c</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Although a lapse term was previously included in this model (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>), adding this term did not improve our model fits and thus was not included here (BICs were lower for a model with choice variability and no lapse compared to a model with choice variability and lapse in 63 of 78 subjects; paired Wilcoxon signed-rank test comparing BICs: p=0.0004). Parameters from this winning ‘adaptivity’ model were highly recoverable (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2a</xref>), as we reported previously (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>).</p></sec><sec id="s4-6"><title>Bayesian learning model</title><p>We used the same hierarchical Bayesian on-line inference algorithm used previously as a normative learning model for the current task (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>). This model predicts which of the two sources <italic>z</italic> is most likely to generate a tone on the next trial. This model assumes that the likelihood that the sources switch is governed by a hazard rate (<italic>H</italic>), which it must learn, and that there is a fixed probability <italic>K</italic> that <italic>H</italic> changes from trial to trial.</p><p>For each subject, <italic>H</italic> was assumed to be generated from a beta distribution <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo> <mml:mi/><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> with mean <italic>μ</italic> and precision <italic>ϕ</italic> parameters, such that <inline-formula><mml:math id="inf7"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf8"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo><mml:mi>ϕ</mml:mi></mml:math></inline-formula>. The goal was to actively infer which of the two possible sources <italic>z</italic> (right or left) would generate the next tone <italic>x</italic>. Tones were <inline-formula><mml:math id="inf9"><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> distributed, with <italic>p</italic>=0.8. To infer the next tone, we sought a distribution over source-space for a given trial <italic>t</italic>, using all of the previously heard tones thus far <inline-formula><mml:math id="inf10"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The numerator can be re-written recursively as:<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow/><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Where the transition probabilities in hazard-rate space are defined as:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:munder><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mn>0</mml:mn></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>K</mml:mi><mml:munder><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mn>0</mml:mn></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>and the transition probabilities in source space are defined as:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The normative model’s belief <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> about the location of the source on trial <italic>t</italic> after hearing a tone was computed as the log-posterior-odds of each state:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>L</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ψ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo form="prefix" movablelimits="true">Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This model was fit with four free parameters: µ, <inline-formula><mml:math id="inf12"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf13"><mml:mi>K</mml:mi></mml:math></inline-formula> governing the learning process and an additional choice variability parameter, <inline-formula><mml:math id="inf14"><mml:mi>v</mml:mi></mml:math></inline-formula>, identical to the one in <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>. The model was fit by minimizing the cross-entropy function in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>. As with the adaptivity model, a lapse parameter was omitted, because adding this term did not improve our fits (BICs were lower for the choice variability only model for 65 of 78 subjects; paired signed-rank test comparing BICs: <italic>p</italic>=4.5x10<sup>−5</sup>). Parameters from this model were highly recoverable (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2b</xref>), as we reported previously (<xref ref-type="bibr" rid="bib30">Glaze et al., 2018</xref>).</p><p>This Bayesian model was used to derive individual dynamic changes in belief strength and surprise for the pupil analyses in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Belief strength was measured as the absolute value of the trial-by-trial log prior odds (<inline-formula><mml:math id="inf15"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>; <xref ref-type="bibr" rid="bib49">Murphy et al., 2020</xref>), and surprise was computed using the information theoretic “surprisal”, measured as <inline-formula><mml:math id="inf16"><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Pr</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfenced> <mml:mi/></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib25">Filipowicz et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Mars et al., 2008</xref>; <xref ref-type="bibr" rid="bib55">O'Reilly et al., 2013</xref>).</p><p>The simulations used to compute normative surprise and belief strength in <xref ref-type="fig" rid="fig5">Figure 5</xref>, and benchmarks for accuracy in <xref ref-type="fig" rid="fig6">Figure 6a</xref>, were generated using a Bayesian model with a prior defined by parameters <inline-formula><mml:math id="inf17"><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>, which weighs all hazard rates equally while performing inference (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>).</p></sec><sec id="s4-7"><title>Individual differences analyses</title><p>Individual differences in pupil responses were calculated using mixed-effects models implemented with the ‘lme4’ package (<xref ref-type="bibr" rid="bib5">Bates et al., 2015</xref>) in the R statistical language (<xref ref-type="bibr" rid="bib59">R Development Core Team, 2019</xref>). These models included both fixed-effects (e.g., tone switch and prediction switch variables) and nuisance regressors (<xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>):<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mi>P</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi> <mml:mi/></mml:mrow></mml:msub></mml:math></disp-formula>where <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> indicates the <italic>n</italic> fixed-effects regressors, <inline-formula><mml:math id="inf20"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> indicates analysis-specific nuisance regressors, and <inline-formula><mml:math id="inf21"><mml:mi>u</mml:mi></mml:math></inline-formula> indicate random intercepts and random slopes for each fixed effects and nuisance regressor of interest. The fixed effects from these models were used to assess overall trends (e.g., influence of switches or computational variables). The individual subject slopes were used to assess individual differences in pupil dynamics. When measuring baseline pupil diameter, previous change in pupil diameter from baseline (i.e., peak pupil after tone onset on the previous trial minus previous baseline) was used as a nuisance regressor. When measuring evoked changes, baseline pupil diameter from the current trial, pupil change from the previous trial, and baseline pupil from the previous trial were added as nuisance regressors (<xref ref-type="bibr" rid="bib40">Krishnamurthy et al., 2017</xref>).</p><p>Significance testing for the linear mixed effects models was done using the ‘lmerTest’ package (<xref ref-type="bibr" rid="bib41">Kuznetsova et al., 2017</xref>), which computes <italic>p</italic> values for <italic>F</italic> and <italic>t</italic> statistics using Satterthwaite’s method for approximating degrees of freedom (<xref ref-type="bibr" rid="bib21">Fai and Cornelius, 1996</xref>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors would like to thank Kenan Saleh, Mohammed Kabir, and Ian Jean for their assistance with data collection. Funded by NSF-NCS 1533623, R01 EB026945, and NIMH F32 MH117924. The funders had no role in the study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Senior editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Funding acquisition, Validation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Funding acquisition, Methodology, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Funding acquisition, Visualization, Methodology, Project administration, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: The study protocol was reviewed and approved by the University of Pennsylvania's Institutional Review Board. All subjects provided written informed consent prior to participating in the study. (IRB Protocol # 816727).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-57872-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data that support the findings in this article are available at <ext-link ext-link-type="uri" xlink:href="https://osf.io/4ahkx/">https://osf.io/4ahkx/</ext-link>. All code used in the preparation of this article can be found at <ext-link ext-link-type="uri" xlink:href="https://osf.io/4ahkx/">https://osf.io/4ahkx/</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/TheGoldLab/Analysis_Filipowicz_Glaze_etal_Audio_2AFC">https://github.com/TheGoldLab/Analysis_Filipowicz_Glaze_etal_Audio_2AFC</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/Analysis_Filipowicz_Glaze_etal_Audio_2AFC">https://github.com/elifesciences-publications/Analysis_Filipowicz_Glaze_etal_Audio_2AFC</ext-link>).</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Filipowicz</surname><given-names>AL</given-names></name><name><surname>Glaze</surname><given-names>CM</given-names></name><name><surname>Kable</surname><given-names>JW</given-names></name><name><surname>Gold</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Analysis code and Data: Pupil diameter encodes the idiosyncratic, cognitive complexity of belief updating</data-title><source>Open Science Framework</source><pub-id assigning-authority="Open Science Framework" pub-id-type="archive" xlink:href="https://osf.io/4ahkx/">4ahkx</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akaike</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>A new look at the statistical model identification</article-title><source>IEEE Transactions on Automatic Control</source><volume>19</volume><fpage>716</fpage><lpage>723</lpage><pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aston-Jones</surname> <given-names>G</given-names></name><name><surname>Rajkowski</surname> <given-names>J</given-names></name><name><surname>Cohen</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Role of locus coeruleus in attention and behavioral flexibility</article-title><source>Biological Psychiatry</source><volume>46</volume><fpage>1309</fpage><lpage>1320</lpage><pub-id pub-id-type="doi">10.1016/S0006-3223(99)00140-7</pub-id><pub-id pub-id-type="pmid">10560036</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aston-Jones</surname> <given-names>G</given-names></name><name><surname>Cohen</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>An integrative theory of locus coeruleus-norepinephrine function: adaptive gain and optimal performance</article-title><source>Annual Review of Neuroscience</source><volume>28</volume><fpage>403</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.28.061604.135709</pub-id><pub-id pub-id-type="pmid">16022602</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastin</surname> <given-names>J</given-names></name><name><surname>Deman</surname> <given-names>P</given-names></name><name><surname>David</surname> <given-names>O</given-names></name><name><surname>Gueguen</surname> <given-names>M</given-names></name><name><surname>Benis</surname> <given-names>D</given-names></name><name><surname>Minotti</surname> <given-names>L</given-names></name><name><surname>Hoffman</surname> <given-names>D</given-names></name><name><surname>Combrisson</surname> <given-names>E</given-names></name><name><surname>Kujala</surname> <given-names>J</given-names></name><name><surname>Perrone-Bertolotti</surname> <given-names>M</given-names></name><name><surname>Kahane</surname> <given-names>P</given-names></name><name><surname>Lachaux</surname> <given-names>JP</given-names></name><name><surname>Jerbi</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Direct recordings from human anterior insula reveal its leading role within the Error-Monitoring network</article-title><source>Cerebral Cortex</source><volume>27</volume><fpage>1545</fpage><lpage>1557</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhv352</pub-id><pub-id pub-id-type="pmid">26796212</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bates</surname> <given-names>D</given-names></name><name><surname>Mächler</surname> <given-names>M</given-names></name><name><surname>Bolker</surname> <given-names>BM</given-names></name><name><surname>Walker</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Fitting linear Mixed-Effects models using lme4</article-title><source>Journal of Statistical Software</source><volume>67</volume><fpage>1</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beatty</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Task-evoked pupillary responses, processing load, and the structure of processing resources</article-title><source>Psychological Bulletin</source><volume>91</volume><fpage>276</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1037/0033-2909.91.2.276</pub-id><pub-id pub-id-type="pmid">7071262</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Woolrich</surname> <given-names>MW</given-names></name><name><surname>Walton</surname> <given-names>ME</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Learning the value of information in an uncertain world</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1214</fpage><lpage>1221</lpage><pub-id pub-id-type="doi">10.1038/nn1954</pub-id><pub-id pub-id-type="pmid">17676057</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Nemenman</surname> <given-names>I</given-names></name><name><surname>Tishby</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Predictability, complexity, and learning</article-title><source>Neural Computation</source><volume>13</volume><fpage>2409</fpage><lpage>2463</lpage><pub-id pub-id-type="doi">10.1162/089976601753195969</pub-id><pub-id pub-id-type="pmid">11674845</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Pattern Recognition and Machine Learning</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bouret</surname> <given-names>S</given-names></name><name><surname>Sara</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Network reset: a simplified overarching theory of locus coeruleus noradrenaline function</article-title><source>Trends in Neurosciences</source><volume>28</volume><fpage>574</fpage><lpage>582</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2005.09.002</pub-id><pub-id pub-id-type="pmid">16165227</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bremner</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Pupil evaluation as a test for autonomic disorders</article-title><source>Clinical Autonomic Research</source><volume>19</volume><fpage>88</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1007/s10286-009-0515-2</pub-id><pub-id pub-id-type="pmid">19190959</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname> <given-names>M</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Jocham</surname> <given-names>G</given-names></name><name><surname>O'Reilly</surname> <given-names>JX</given-names></name><name><surname>Bishop</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Anxious individuals have difficulty learning the causal statistics of aversive environments</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>590</fpage><lpage>596</lpage><pub-id pub-id-type="doi">10.1038/nn.3961</pub-id><pub-id pub-id-type="pmid">25730669</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chechik</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Information bottleneck for Gaussian variables</article-title><source>Journal of Machine Learning Research : JMLR</source><volume>6</volume><fpage>165</fpage><lpage>188</lpage></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>A</given-names></name><name><surname>Koechlin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Reasoning, learning, and creativity: frontal lobe function and human Decision-Making</article-title><source>PLOS Biology</source><volume>10</volume><elocation-id>e1001293</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001293</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daw</surname> <given-names>ND</given-names></name><name><surname>O'Doherty</surname> <given-names>JP</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>Seymour</surname> <given-names>B</given-names></name><name><surname>Dolan</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Cortical substrates for exploratory decisions in humans</article-title><source>Nature</source><volume>441</volume><fpage>876</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1038/nature04766</pub-id><pub-id pub-id-type="pmid">16778890</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Gee</surname> <given-names>JW</given-names></name><name><surname>Knapen</surname> <given-names>T</given-names></name><name><surname>Donner</surname> <given-names>TH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Decision-related pupil dilation reflects upcoming choice and individual Bias</article-title><source>PNAS</source><volume>111</volume><fpage>E618</fpage><lpage>E625</lpage><pub-id pub-id-type="doi">10.1073/pnas.1317557111</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Gee</surname> <given-names>JW</given-names></name><name><surname>Colizoli</surname> <given-names>O</given-names></name><name><surname>Kloosterman</surname> <given-names>NA</given-names></name><name><surname>Knapen</surname> <given-names>T</given-names></name><name><surname>Nieuwenhuis</surname> <given-names>S</given-names></name><name><surname>Donner</surname> <given-names>TH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamic modulation of decision biases by brainstem arousal systems</article-title><source>eLife</source><volume>6</volume><elocation-id>e23232</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23232</pub-id><pub-id pub-id-type="pmid">28383284</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>de Gee</surname> <given-names>JW</given-names></name><name><surname>Tsetsos</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Phasic arousal suppresses biases in mice and humans across domains of decision-making</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/447656</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domenech</surname> <given-names>P</given-names></name><name><surname>Koechlin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Executive control and decision-making in the prefrontal cortex</article-title><source>Current Opinion in Behavioral Sciences</source><volume>1</volume><fpage>101</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1016/j.cobeha.2014.10.007</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donoso</surname> <given-names>M</given-names></name><name><surname>Collins</surname> <given-names>AG</given-names></name><name><surname>Koechlin</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Human cognition foundations of human reasoning in the prefrontal cortex</article-title><source>Science</source><volume>344</volume><fpage>1481</fpage><lpage>1486</lpage><pub-id pub-id-type="doi">10.1126/science.1252254</pub-id><pub-id pub-id-type="pmid">24876345</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fai</surname> <given-names>AH</given-names></name><name><surname>Cornelius</surname> <given-names>PL</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Approximate F-tests of multiple degree of freedom hypotheses in generalized least squares analyses of unbalanced split-plot experiments</article-title><source>Journal of Statistical Computation and Simulation</source><volume>54</volume><fpage>363</fpage><lpage>378</lpage><pub-id pub-id-type="doi">10.1080/00949659608811740</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faraji</surname> <given-names>M</given-names></name><name><surname>Preuschoff</surname> <given-names>K</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Balancing new against old information: the role of puzzlement surprise in learning</article-title><source>Neural Computation</source><volume>30</volume><fpage>34</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1162/neco_a_01025</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Filipowicz</surname> <given-names>A</given-names></name><name><surname>Valadao</surname> <given-names>D</given-names></name><name><surname>Anderson</surname> <given-names>B</given-names></name><name><surname>Danckert</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Measuring the influence of prior beliefs on probabilistic estimations</article-title><conf-name>Proceedings of the Annual Meeting of the Cognitive Science Society</conf-name><fpage>2198</fpage><lpage>2203</lpage><pub-id pub-id-type="doi">10.13140/2.1.1323.8406</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Filipowicz</surname> <given-names>A</given-names></name><name><surname>Anderson</surname> <given-names>B</given-names></name><name><surname>Danckert</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Adapting to change: the role of the right hemisphere in mental model building and updating</article-title><source>Canadian Journal of Experimental Psychology/Revue Canadienne De Psychologie Expérimentale</source><volume>70</volume><fpage>201</fpage><lpage>218</lpage><pub-id pub-id-type="doi">10.1037/cep0000078</pub-id><pub-id pub-id-type="pmid">27845542</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Filipowicz</surname> <given-names>A</given-names></name><name><surname>Valadao</surname> <given-names>D</given-names></name><name><surname>Anderson</surname> <given-names>B</given-names></name><name><surname>Danckert</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Rejecting outliers: surprising changes do not always improve belief updating</article-title><source>Decision</source><volume>5</volume><fpage>165</fpage><lpage>176</lpage><pub-id pub-id-type="doi">10.1037/dec0000073</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Filipowicz</surname> <given-names>A</given-names></name><name><surname>Levine</surname> <given-names>J</given-names></name><name><surname>Piasini</surname> <given-names>E</given-names></name><name><surname>Tavoni</surname> <given-names>G</given-names></name><name><surname>Kable</surname> <given-names>J</given-names></name><name><surname>Gold</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The complexity of model-free and model-based learning strategies</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2019.12.28.879965</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilad-Bachrach</surname> <given-names>R</given-names></name><name><surname>Navot</surname> <given-names>A</given-names></name><name><surname>Tishby</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>An information theoretic tradeoff between complexity and accuracy</article-title><source>Lecture Notes in Artificial Intelligence</source><volume>2777</volume><fpage>595</fpage><lpage>609</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-45167-9_43</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gilzenrat</surname> <given-names>MS</given-names></name><name><surname>Nieuwenhuis</surname> <given-names>S</given-names></name><name><surname>Jepma</surname> <given-names>M</given-names></name><name><surname>Cohen</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Pupil diameter tracks changes in control state predicted by the adaptive gain theory of locus coeruleus function</article-title><source>Cognitive, Affective, &amp; Behavioral Neuroscience</source><volume>10</volume><fpage>252</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.3758/CABN.10.2.252</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaze</surname> <given-names>CM</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Normative evidence accumulation in unpredictable environments</article-title><source>eLife</source><volume>4</volume><elocation-id>e08825</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.08825</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaze</surname> <given-names>CM</given-names></name><name><surname>Filipowicz</surname> <given-names>ALS</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A bias–variance trade-off governs individual differences in on-line learning in an unpredictable environment</article-title><source>Nature Human Behaviour</source><volume>2</volume><fpage>213</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1038/s41562-018-0297-4</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Gold</surname> <given-names>JI</given-names></name><name><surname>Pizzica</surname> <given-names>C</given-names></name><name><surname>Radillo</surname> <given-names>AE</given-names></name><name><surname>Chavez</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Custom utilities for experimental control for the Gold Lab</data-title><source>GitHub</source><version designator="252a0a3">252a0a3</version><ext-link ext-link-type="uri" xlink:href="https://github.com/TheGoldLab/Lab_Matlab_Control">https://github.com/TheGoldLab/Lab_Matlab_Control</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gold</surname> <given-names>JI</given-names></name><name><surname>Shadlen</surname> <given-names>MN</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Neural computations that underlie decisions about sensory stimuli</article-title><source>Trends in Cognitive Sciences</source><volume>5</volume><fpage>10</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1016/S1364-6613(00)01567-9</pub-id><pub-id pub-id-type="pmid">11164731</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ham</surname> <given-names>T</given-names></name><name><surname>Leff</surname> <given-names>A</given-names></name><name><surname>de Boissezon</surname> <given-names>X</given-names></name><name><surname>Joffe</surname> <given-names>A</given-names></name><name><surname>Sharp</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cognitive control and the salience network: an investigation of error processing and effective connectivity</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>7091</fpage><lpage>7098</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4692-12.2013</pub-id><pub-id pub-id-type="pmid">23595766</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Johnson-Laird</surname> <given-names>PN</given-names></name></person-group><year iso-8601-date="2004">2004</year><chapter-title>The history of mental models</chapter-title><person-group person-group-type="editor"><name><surname>Manktelow</surname> <given-names>K</given-names></name><name><surname>Chung</surname> <given-names>M</given-names></name></person-group><source>Psychology of Reasoning: Theoretical and Historical Perspectives</source><publisher-name>Psychology Press</publisher-name><fpage>179</fpage><lpage>212</lpage></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joshi</surname> <given-names>S</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Kalwani</surname> <given-names>RM</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Relationships between pupil diameter and neuronal activity in the locus coeruleus, Colliculi, and cingulate cortex</article-title><source>Neuron</source><volume>89</volume><fpage>221</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.11.028</pub-id><pub-id pub-id-type="pmid">26711118</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joshi</surname> <given-names>S</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Pupil size as a window on neural substrates of cognition</article-title><source>Trends in Cognitive Sciences</source><volume>24</volume><fpage>466</fpage><lpage>480</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2020.03.005</pub-id><pub-id pub-id-type="pmid">32331857</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>TD</given-names></name><name><surname>Kabir</surname> <given-names>M</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Coupled decision processes update and maintain saccadic priors in a dynamic environment</article-title><source>The Journal of Neuroscience</source><volume>37</volume><fpage>3632</fpage><lpage>3645</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3078-16.2017</pub-id><pub-id pub-id-type="pmid">28242793</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koechlin</surname> <given-names>E</given-names></name><name><surname>Hyafil</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007a</year><article-title>Anterior prefrontal function and the limits of human Decision-Making</article-title><source>Science</source><volume>318</volume><fpage>594</fpage><lpage>598</lpage><pub-id pub-id-type="doi">10.1126/science.1142995</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koechlin</surname> <given-names>E</given-names></name><name><surname>Summerfield</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2007">2007b</year><article-title>An information theoretical approach to prefrontal executive function</article-title><source>Trends in Cognitive Sciences</source><volume>11</volume><fpage>229</fpage><lpage>235</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2007.04.005</pub-id><pub-id pub-id-type="pmid">17475536</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishnamurthy</surname> <given-names>K</given-names></name><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Sarode</surname> <given-names>S</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Arousal-related adjustments of perceptual biases optimize perception in dynamic environments</article-title><source>Nature Human Behaviour</source><volume>1</volume><elocation-id>0107</elocation-id><pub-id pub-id-type="doi">10.1038/s41562-017-0107</pub-id><pub-id pub-id-type="pmid">29034334</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuznetsova</surname> <given-names>A</given-names></name><name><surname>Brockhoff</surname> <given-names>PB</given-names></name><name><surname>Christensen</surname> <given-names>RHB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>lmerTest Package: Tests in Linear Mixed Effects Models</article-title><source>Journal of Statistical Software</source><volume>82</volume><elocation-id>13</elocation-id><pub-id pub-id-type="doi">10.18637/jss.v082.i13</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Rodenkirch</surname> <given-names>C</given-names></name><name><surname>Moskowitz</surname> <given-names>N</given-names></name><name><surname>Schriver</surname> <given-names>B</given-names></name><name><surname>Wang</surname> <given-names>Q</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamic lateralization of pupil dilation evoked by locus coeruleus activation results from sympathetic, not parasympathetic, contributions</article-title><source>Cell Reports</source><volume>20</volume><fpage>3099</fpage><lpage>3112</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2017.08.094</pub-id><pub-id pub-id-type="pmid">28954227</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Debener</surname> <given-names>S</given-names></name><name><surname>Gladwin</surname> <given-names>TE</given-names></name><name><surname>Harrison</surname> <given-names>LM</given-names></name><name><surname>Haggard</surname> <given-names>P</given-names></name><name><surname>Rothwell</surname> <given-names>JC</given-names></name><name><surname>Bestmann</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Trial-by-trial fluctuations in the event-related electroencephalogram reflect dynamic changes in the degree of surprise</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>12539</fpage><lpage>12545</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2925-08.2008</pub-id><pub-id pub-id-type="pmid">19020046</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathôt</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Pupillometry: psychology, physiology, and function</article-title><source>Journal of Cognition</source><volume>1</volume><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.5334/joc.18</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGuire</surname> <given-names>JT</given-names></name><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Functionally dissociable influences on learning rate in a dynamic environment</article-title><source>Neuron</source><volume>84</volume><fpage>870</fpage><lpage>881</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.10.013</pub-id><pub-id pub-id-type="pmid">25459409</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menon</surname> <given-names>V</given-names></name><name><surname>Uddin</surname> <given-names>LQ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Saliency, switching, attention and control: a network model of insula function</article-title><source>Brain Structure and Function</source><volume>214</volume><fpage>655</fpage><lpage>667</lpage><pub-id pub-id-type="doi">10.1007/s00429-010-0262-0</pub-id><pub-id pub-id-type="pmid">20512370</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Muller</surname> <given-names>TH</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>O'Reilly</surname> <given-names>JX</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Control of entropy in neural models of environmental state</article-title><source>eLife</source><volume>8</volume><elocation-id>e39404</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.39404</pub-id><pub-id pub-id-type="pmid">30816090</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murphy</surname> <given-names>PR</given-names></name><name><surname>O'Connell</surname> <given-names>RG</given-names></name><name><surname>O'Sullivan</surname> <given-names>M</given-names></name><name><surname>Robertson</surname> <given-names>IH</given-names></name><name><surname>Balsters</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pupil diameter covaries with BOLD activity in human locus coeruleus</article-title><source>Human Brain Mapping</source><volume>35</volume><fpage>4140</fpage><lpage>4154</lpage><pub-id pub-id-type="doi">10.1002/hbm.22466</pub-id><pub-id pub-id-type="pmid">24510607</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Murphy</surname> <given-names>PR</given-names></name><name><surname>Wilming</surname> <given-names>N</given-names></name><name><surname>Hernandez-Bocanegra</surname> <given-names>D</given-names></name><name><surname>Ortega</surname> <given-names>G</given-names></name><name><surname>Donner</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Normative circuit dynamics across human cortex during evidence accumulation in changing environments</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.01.29.924795</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myung</surname> <given-names>IJ</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name><name><surname>Pitt</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Counting probability distributions: differential geometry and model selection</article-title><source>PNAS</source><volume>97</volume><fpage>11170</fpage><lpage>11175</lpage><pub-id pub-id-type="doi">10.1073/pnas.170283897</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Heasly</surname> <given-names>B</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>An approximately bayesian delta-rule model explains the dynamics of belief updating in a changing environment</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>12366</fpage><lpage>12378</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0822-10.2010</pub-id><pub-id pub-id-type="pmid">20844132</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Rumsey</surname> <given-names>KM</given-names></name><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Parikh</surname> <given-names>K</given-names></name><name><surname>Heasly</surname> <given-names>B</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rational regulation of learning dynamics by pupil-linked arousal systems</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1040</fpage><lpage>1046</lpage><pub-id pub-id-type="doi">10.1038/nn.3130</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>McGuire</surname> <given-names>JT</given-names></name><name><surname>Ritz</surname> <given-names>H</given-names></name><name><surname>Kable</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dissociable forms of Uncertainty-Driven representational change across the human brain</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>1688</fpage><lpage>1698</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1713-18.2018</pub-id><pub-id pub-id-type="pmid">30523066</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Reilly</surname> <given-names>JX</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Making predictions in a changing world-inference, uncertainty, and learning</article-title><source>Frontiers in Neuroscience</source><volume>7</volume><elocation-id>105</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2013.00105</pub-id><pub-id pub-id-type="pmid">23785310</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Reilly</surname> <given-names>JX</given-names></name><name><surname>Schüffelgen</surname> <given-names>U</given-names></name><name><surname>Cuell</surname> <given-names>SF</given-names></name><name><surname>Behrens</surname> <given-names>TE</given-names></name><name><surname>Mars</surname> <given-names>RB</given-names></name><name><surname>Rushworth</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dissociable effects of surprise and model update in parietal and anterior cingulate cortex</article-title><source>PNAS</source><volume>110</volume><fpage>E3660</fpage><lpage>E3669</lpage><pub-id pub-id-type="doi">10.1073/pnas.1305373110</pub-id><pub-id pub-id-type="pmid">23986499</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palmer</surname> <given-names>SE</given-names></name><name><surname>Marre</surname> <given-names>O</given-names></name><name><surname>Berry</surname> <given-names>MJ</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Predictive information in a sensory population</article-title><source>PNAS</source><volume>112</volume><fpage>6908</fpage><lpage>6913</lpage><pub-id pub-id-type="doi">10.1073/pnas.1506855112</pub-id><pub-id pub-id-type="pmid">26038544</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Preuschoff</surname> <given-names>K</given-names></name><name><surname>'t Hart</surname> <given-names>BM</given-names></name><name><surname>Einhäuser</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Pupil dilation signals surprise: evidence for noradrenaline's Role in Decision Making</article-title><source>Frontiers in Neuroscience</source><volume>5</volume><elocation-id>115</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2011.00115</pub-id><pub-id pub-id-type="pmid">21994487</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiyang</surname> <given-names>J</given-names></name><name><surname>Richer</surname> <given-names>F</given-names></name><name><surname>Wagoner</surname> <given-names>B</given-names></name><name><surname>Beatty</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>The pupil and stimulus probability</article-title><source>Psychophysiology</source><volume>55</volume><fpage>530</fpage><lpage>534</lpage><pub-id pub-id-type="doi">10.1111/j.1469-8986.1985.tb01645.x</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="software"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group><year iso-8601-date="2019">2019</year><data-title>R: A language and environment for statistical computing</data-title><publisher-name>R Foundation for Statistical Computing</publisher-name><publisher-loc>Vienna, Austria</publisher-loc><ext-link ext-link-type="uri" xlink:href="http://www.r-project.org">http://www.r-project.org</ext-link></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reimer</surname> <given-names>J</given-names></name><name><surname>McGinley</surname> <given-names>MJ</given-names></name><name><surname>Liu</surname> <given-names>Y</given-names></name><name><surname>Rodenkirch</surname> <given-names>C</given-names></name><name><surname>Wang</surname> <given-names>Q</given-names></name><name><surname>McCormick</surname> <given-names>DA</given-names></name><name><surname>Tolias</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Pupil fluctuations track rapid changes in adrenergic and cholinergic activity in cortex</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>13289</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms13289</pub-id><pub-id pub-id-type="pmid">27824036</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sara</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The locus coeruleus and noradrenergic modulation of cognition</article-title><source>Nature Reviews Neuroscience</source><volume>10</volume><fpage>211</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1038/nrn2573</pub-id><pub-id pub-id-type="pmid">19190638</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarafyazd</surname> <given-names>M</given-names></name><name><surname>Jazayeri</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Hierarchical reasoning by neural circuits in the frontal cortex</article-title><source>Science</source><volume>364</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1126/science.aav8911</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Estimating the dimension of a model</article-title><source>The Annals of Statistics</source><volume>6</volume><fpage>461</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1214/aos/1176344136</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shenhav</surname> <given-names>A</given-names></name><name><surname>Botvinick</surname> <given-names>MM</given-names></name><name><surname>Cohen</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The expected value of control: an integrative theory of anterior cingulate cortex function</article-title><source>Neuron</source><volume>79</volume><fpage>217</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.07.007</pub-id><pub-id pub-id-type="pmid">23889930</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shenhav</surname> <given-names>A</given-names></name><name><surname>Cohen</surname> <given-names>JD</given-names></name><name><surname>Botvinick</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dorsal anterior cingulate cortex and the value of control</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>1286</fpage><lpage>1291</lpage><pub-id pub-id-type="doi">10.1038/nn.4384</pub-id><pub-id pub-id-type="pmid">27669989</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shenhav</surname> <given-names>A</given-names></name><name><surname>Musslick</surname> <given-names>S</given-names></name><name><surname>Lieder</surname> <given-names>F</given-names></name><name><surname>Kool</surname> <given-names>W</given-names></name><name><surname>Griffiths</surname> <given-names>TL</given-names></name><name><surname>Cohen</surname> <given-names>JD</given-names></name><name><surname>Botvinick</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Toward a rational and mechanistic account of mental effort</article-title><source>Annual Review of Neuroscience</source><volume>40</volume><fpage>99</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-072116-031526</pub-id><pub-id pub-id-type="pmid">28375769</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stöttinger</surname> <given-names>E</given-names></name><name><surname>Filipowicz</surname> <given-names>A</given-names></name><name><surname>Valadao</surname> <given-names>D</given-names></name><name><surname>Culham</surname> <given-names>JC</given-names></name><name><surname>Goodale</surname> <given-names>MA</given-names></name><name><surname>Anderson</surname> <given-names>B</given-names></name><name><surname>Danckert</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A cortical network that marks the moment when conscious representations are updated</article-title><source>Neuropsychologia</source><volume>79</volume><fpage>113</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1016/j.neuropsychologia.2015.10.037</pub-id><pub-id pub-id-type="pmid">26529489</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tenenbaum</surname> <given-names>JB</given-names></name><name><surname>Kemp</surname> <given-names>C</given-names></name><name><surname>Griffiths</surname> <given-names>TL</given-names></name><name><surname>Goodman</surname> <given-names>ND</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>How to grow a mind: statistics, structure, and abstraction</article-title><source>Science</source><volume>331</volume><fpage>1279</fpage><lpage>1285</lpage><pub-id pub-id-type="doi">10.1126/science.1192788</pub-id><pub-id pub-id-type="pmid">21393536</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Tishby</surname> <given-names>N</given-names></name><name><surname>Pereira</surname> <given-names>FC</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The information bottleneck method</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/physics/0004057">https://arxiv.org/abs/physics/0004057</ext-link></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsukahara</surname> <given-names>JS</given-names></name><name><surname>Harrison</surname> <given-names>TL</given-names></name><name><surname>Engle</surname> <given-names>RW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The relationship between baseline pupil size and intelligence</article-title><source>Cognitive Psychology</source><volume>91</volume><fpage>109</fpage><lpage>123</lpage><pub-id pub-id-type="doi">10.1016/j.cogpsych.2016.10.001</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Urai</surname> <given-names>AE</given-names></name><name><surname>Braun</surname> <given-names>A</given-names></name><name><surname>Donner</surname> <given-names>TH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Pupil-linked arousal is driven by decision uncertainty and alters serial choice Bias</article-title><source>Nature Communications</source><volume>8</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/ncomms14637</pub-id><pub-id pub-id-type="pmid">28256514</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vincent</surname> <given-names>P</given-names></name><name><surname>Parr</surname> <given-names>T</given-names></name><name><surname>Benrimoh</surname> <given-names>D</given-names></name><name><surname>Friston</surname> <given-names>KJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>With an eye on uncertainty: modelling pupillary responses to environmental volatility</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1007126</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007126</pub-id><pub-id pub-id-type="pmid">31276488</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>RC</given-names></name><name><surname>Nassar</surname> <given-names>MR</given-names></name><name><surname>Gold</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Bayesian online learning of the hazard rate in change-point problems</article-title><source>Neural Computation</source><volume>22</volume><fpage>2452</fpage><lpage>2476</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00007</pub-id><pub-id pub-id-type="pmid">20569174</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname> <given-names>AJ</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Uncertainty, neuromodulation, and attention</article-title><source>Neuron</source><volume>46</volume><fpage>681</fpage><lpage>692</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.04.026</pub-id><pub-id pub-id-type="pmid">15944135</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zajkowski</surname> <given-names>WK</given-names></name><name><surname>Kossut</surname> <given-names>M</given-names></name><name><surname>Wilson</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A causal role for right frontopolar cortex in directed, but not random, exploration</article-title><source>eLife</source><volume>6</volume><elocation-id>e27430</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.27430</pub-id><pub-id pub-id-type="pmid">28914605</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zénon</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Eye pupil signals information gain</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>286</volume><elocation-id>20191593</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2019.1593</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname> <given-names>S</given-names></name><name><surname>Chait</surname> <given-names>M</given-names></name><name><surname>Dick</surname> <given-names>F</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name><name><surname>Furukawa</surname> <given-names>S</given-names></name><name><surname>Liao</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Pupil-linked phasic arousal evoked by violation but not emergence of regularity within rapid sound sequences</article-title><source>Nature Communications</source><volume>10</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1038/s41467-019-12048-1</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.57872.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Donner</surname><given-names>Tobias H</given-names></name><role>Reviewing Editor</role><aff><institution>University Medical Center Hamburg-Eppendorf</institution><country>Germany</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Donner</surname><given-names>Tobias H</given-names></name><role>Reviewer</role><aff><institution>University Medical Center Hamburg-Eppendorf</institution><country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This paper presents a rigorous investigation of the relationship between pupil-linked arousal and dynamic belief updating in humans. The authors present the most conclusive evidence so far, that pupil-linked arousal reflects a high-level form of surprise in the belief updating process, conclusively ruling out low-level change in sensory input as a possible driver. They go on to show that individual differences in the complexity of the updating process.</p><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting your work entitled &quot;Pupil diameter encodes the idiosyncratic, cognitive complexity of belief updating&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Tobias H Donner as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by a Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Sander Nieuwenhuis (Reviewer #2).</p><p>Our decision has been reached after consultation between the reviewers. Based on these discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>.</p><p>Reviewers agreed that the study was interesting and generally well done. However, reviewers #2 and #3 felt that this work was better suited for a more specialised journal than <italic>eLife</italic>. In the discussion leading up to this decision, reviewer #2 stated: The first half of the Results section mainly replicates already published findings (Nassar et al., 2012; Glaze et al., 2015), while the new findings in the second half of the Results section are probably hard to understand for the broad readership of <italic>eLife</italic>. I also found the first major conclusion, that evoked pupil-linked arousal is more sensitive to &quot;high-level&quot; surprise than to low-level changes in sensory stimulation rather unsurprising. In general, I thought that the science was great but the paper not very suited for <italic>eLife</italic>. Reviewer #3 made suggestions for reframing the paper in a way, they felt, would make it more accessible for a broad readership (focussing on general take-home messages rather than framing conclusions with respect to specific models). All reviewers also made a number of suggestions regarding the presentation and analyses that are detailed in the individual reviews below. We hope that these will be useful for you.</p><p><italic>Reviewer #1:</italic></p><p>This is timely work into the involvement of pupil-linked arousal systems in dynamic belief updating. The novelty of this study is twofold:</p><p>1) Demonstration that pupil diameter is sensitive to &quot;high-level&quot; surprise (deviations from expectations about state), as opposed to low-level changes in sensory stimulation. The comparison between high and low hazard rate contexts was necessary for this.</p><p>2) Linking these cognitive pupil diameter modulations to individual differences in internal model complexity. This point is conceptually extremely interesting; in practice I found their results in this part difficult to interpret.</p><p>In addition, there are some replications of effects reported in Glaze et al., 2018.</p><p>Overall, I feel this work merits publication at <italic>eLife</italic>, however, after some substantial revisions.</p><p>1) Quantification of pupil measures.</p><p>I suspect that the way the authors quantify baseline diameter and evoked pupil responses will induce strong (negative) correlations between both measures, as has been reported many times in the literature (Gilzenrath et al., 2010; de Gee et al., 2014). The source of this anti-correlation is not fully understand (it may be trivial or even artifactual), and it generally complicates the interpretation of their correlations with computational variables.</p><p>– The authors should report these correlations.</p><p>– I encourage them to replace their &quot;evoked pupil change&quot; with the 1st temporal derivative of the pupil signal in the post-tone interval; this measure has many advantages as a metric of phasic arousal: it is more temporally precise, it more specifically tracks norepinephrine (rather than ACh) transients, and, most critically, it tends to decorrelate measures of phasic arousal from baseline diameter measures of tonic arousal, see de Gee et al., 2019.</p><p>– For all tonic arousal effects it would be interesting to see effects for the previous baseline, not only the current and next baseline (this could show, for instance, if switches in response hand are preceded or succeeded by an increase of baseline arousal).</p><p>2) Split by choice variability.</p><p>Split into high vs low variability subjects seems ad hoc. No motivation is provided for doing so in Results, beyond this: &quot;some participants had very high choice variability, and the interesting relationships reported here were present for low variability participants but not high variability participants&quot;.</p><p>If model complexity is really a useful construct that captures key features of how individuals perform a task like this, then shouldn't it encompass not just low variability participants, but high variability participants also?</p><p>3) Individual differences.</p><p>The pupil individual difference effects in Figure 6 are highly specific, examining the relationship between estimated model complexity and particular pupil effects within each H condition. If pupil-linked arousal plays a critical role in context-dependent belief updating, wouldn't one expect pupil changes across H conditions to correlate with changes in behaviour/belief updating across conditions? Such an analysis would get even closer to the claim that pupil-linked arousal is involved in adaptation of the inference process to different environmental contexts.</p><p>4) Interpretation of hazard rate condition differences.</p><p>In Discussion, authors speculate that relatively poorer performance in high H condition is due to a failure to engage arousal systems, which in turn produces less effective adaptation to that particular context. But the direction of causality could be reversed – participants might inherently underestimate the H in this context (perhaps due to strong priors for more stable environments encountered in everyday life), and that their level of surprise/arousal is actually appropriate given their subjective H. I suggest this possibility be acknowledged and given equal weight in the Discussion.</p><p>5) Is it possible that in Figure 1B, the dashed and dotted lines for H=.99 have been flipped?</p><p><italic>Reviewer #2:</italic></p><p>This paper reports a highly detailed analysis of the fundamental concepts that are reflected in pupil diameter. The study has a rather large sample size. The first part of the Results section presents findings that are a bit trivial and other findings that replicate the authors' previous work (mainly Nassar et al., 2012 and Glaze et al., 2015). But the paper also presents a number of novel analyses showing how the arousal system encodes complex context-dependent measures of uncertainty and belief updating. I am not able to judge the details of the complexity measure analyses and the &quot;adaptivity model&quot; (Materials and methods).</p><p>1) The paper aims to provide a unified framework for understanding pupil effects in terms of both inference processes and more traditional notions of mental effort and cognitive load. I encourage the authors to discuss how their framework accounts for the typical findings that gave rise to those traditional notions. In addition, could they briefly discuss the relationship between their framework and this paper from Karl Friston's group: Vincent et al., 2019 (https://www.ncbi.nlm.nih.gov/pubmed/31276488).</p><p>2) It would be good if the authors are more explicit in the Results section about which findings are &quot;old&quot; and where the new findings start.</p><p>3) Subsection “Pupil diameter is sensitive to adaptive, context-dependent expectations” and Figure 2C: &quot;These effects persisted into the next baseline pupil, with larger pupil dilation after both stimulus and prediction switches on low and intermediate hazard-rate trials.&quot; Do these findings reflect real baseline shifts? Or are three seconds simply not enough for the pupil response to the previous tone stimulus to return to baseline?</p><p><italic>Reviewer #3:</italic></p><p>In this study Filipowicz and colleagues investigated the relationship between pupil dilation, perceptual surprise and belief updating in ~80 human participants. The used an auditory one-arm bandit task with variable hazard rate. Baseline pupil and phasic pupil response to stimuli were investigated. A number of mathematical models are proposed to account for within-and between subject variation in pupil response.</p><p>I was very interested to read this study which is close to my area of research. However, I was not convinced that it would command sufficient interest outside the immediate field to merit publication in <italic>eLife</italic>. The first reason for this assessment is that the study is a detailed investigation of an experimental effect (pupil dilation in response to learning conditions and surprise) rather than addressing a deeper hypothesis about the brain or behaviour per se. The second reason is that the bulk of the results are presented in relation to specific models and again I am not convinced that non-specialist readers would know how to generalize these (although this could possibly be addressed by a re-write that emphasises the take-home points). Thirdly, in some cases, if a study addressed a relatively non-innovative question but had a rare or technically excellent dataset I would still think it might be a good fit for <italic>eLife</italic>, but the data in this study would not be hard to collect for most cog neuro labs.</p><p>I have the following specific comments:</p><p>1) Figure 1 and related text</p><p>Subjects (and the model) seem to hugely under-estimate the Hazard rate in high H=0.99 condition and overestimate it in low H=0.33 condition (based on Figure 1D). How can this be explained?</p><p>2) Figure 2 and related text</p><p>It seems to me that this non-model-based analysis needs more unpacking.</p><p>– The pupil effects are not broken down into correct (prediction and stimulus = same location) and incorrect trials but I would expect a large difference in the phasic response between these trial types. This should interact with hazard rate as in low H=0.01 case, prediction switch trials should often be correct as they will follow multiple stimulus shifts. Could correct v incorrect be included in the regression model?</p><p>– The task gives quite a few rich comparisons that could be explored before getting stuck in to the modelling.</p><p>I would have liked to see more basic contrasts presented, eg:</p><p>– Compare the phasic pupil response for unexpected switches (in H=0.01) and unexpected repeats (in H=0.99) which nicely mirror each other.</p><p>– Compare baseline pupil on prediction-switch trials that follow a stimulus switch (presumably, mainly in the H=0.01 condition) and on prediction-switch trials that follow a stimulus repeat (presumably, mainly in the H=0.99 condition).</p><p>– Compare phasic pupil response following stimulus switches that will and will not be followed by a prediction switch.</p><p>These are results in themselves and would give the reader a better sense of the data without having to interpret in the light of models etc.</p><p>3) Figure 3 and related text</p><p>As for Figure 2, can surprise (based on model beliefs) be teased apart from correct vs incorrect (ie simply whether the prediction and stimulus were in the same location)?</p><p>4) Model complexity</p><p>I am struggling to understand how model complexity was defined exactly (Figure 4A). What is meant by the mutual information between the features of past trials and the current response – surely there must be some intervening policy that predicts the correct response based on these past features – what is it? Am I right in thinking that the model complexity captures both the extent of the integration kernel, or also so qualitative features of model complexity (e.g. another level in model hierarchy that tells you that you should alternate n the H=0.99 condition)? What aspects of the model complexity measure capture these two processes and can they be teased apart?</p><p>5) Figure 4 and related text</p><p>The relationship between three model based parameters in Figures 4C,D,E looks suspiciously good to me! Could this have arisen because these parameters to some extent capture similar features in the data, rather than separate but correlated cognitive processes? If the authors were to simulate agents who varied on only one or two of the parameters (choice variability/adaptivity/model complexity), to what extent would they be able to recover parameter fits that vary only in that one parameter?</p><p>6) Figure 5</p><p>Can the model based results be related back to raw behaviour? How should Figures 1C,D differ for subjects showing high and low model complexity?</p><p>7) Figure 7</p><p>Am I right in thinking the y-axis on this figure is mean pupil size (or mean phasic pupil response) as a subject-measure? How is this defined given that the raw pupil size on the eye tracker depends mainly on irrelevant factors like the distance from the camera to the eye and the size of the eye? I'm sure there is a sensible definition but I didn't manage to find it in the text. Further, might you not expect an inverted U (Yerkes-Dodson) relationship between pupil dilation and model complexity?</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for submitting your article &quot;Pupil diameter encodes the idiosyncratic, cognitive complexity of belief updating&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, including Tobias H Donner as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Timothy Behrens as the Senior Editor.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>Summary:</p><p>This is a very rigorous study of the involvement of pupil-linked arousal systems in belief updating. The novelty of this work lies in two central points:</p><p>1) Phasic responses of pupil-linked arousal systems reflect a high-level form of surprise, as opposed to simply environmental change. (The high-hazard condition included here was critical to reach this conclusion.)</p><p>2) The model-free analyses of &quot;complexity&quot; pinpointed idiosyncratic way, in which individual participants address the cognitive demands of the inference task studied here.</p><p>Essential revisions:</p><p>You have addressed most of the reviewer concerns in a rigorous and comprehensive fashion. Yet, we felt, that the following conceptual points would deserve further attention in the presentation and discussion of your current findings.</p><p>1) Complexity measure and pupil. Please do more to explain/make intuitive your complexity measure. An example would be welcome. Everyone should be able to understand the most novel finding.</p><p>2) Pupil response to the “absence of change”. It has already been shown that the pupil responds to the unexpected absence of a stimulus (Qiyuan et al., 1985): There's nothing on the screen during the inter-trial interval and then, against expectations, no stimulus is presented. This is another example of &quot;there is no sensory change but still a clear pupil response&quot;, indicating that the pupil responds to the violated expectation and not to bottom changes in sensory input.</p><p>3) Discussion of effort and load. In a new discussion paragraph, you now exclude a number of operationalizations of effort/load as an explanation for your findings. This is quite helpful. However, you end the Abstract mentioning that you will provide a unified framework for understanding effects of new inputs on arousal systems &quot;in terms of both inference processes aimed to reduce belief uncertainty and more traditional notions of mental effort&quot;. We took that to mean that you will offer new interpretations of classical pupil findings, that have previously been explained in terms of effort or load. As far as we see, there is no such unified framework presented in the paper. We feel the last sentence of the Abstract should be toned down.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.57872.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>This is timely work into the involvement of pupil-linked arousal systems in dynamic belief updating. The novelty of this study is twofold:</p><p>1) Demonstration that pupil diameter is sensitive to &quot;high-level&quot; surprise (deviations from expectations about state), as opposed to low-level changes in sensory stimulation. The comparison between high and low hazard rate contexts was necessary for this.</p><p>2) Linking these cognitive pupil diameter modulations to individual differences in internal model complexity. This point is conceptually extremely interesting; in practice I found their results in this part difficult to interpret.</p><p>In addition, there are some replications of effects reported in Glaze et al., 2018.</p><p>Overall, I feel this work merits publication at eLife, however, after some substantial revisions.</p><p>1) Quantification of pupil measures.</p><p>I suspect that the way the authors quantify baseline diameter and evoked pupil responses will induce strong (negative) correlations between both measures, as has been reported many times in the literature (Gilzenrath et al., 2010; de Gee et al., 2014). The source of this anti-correlation is not fully understand (it may be trivial or even artifactual), and it generally complicates the interpretation of their correlations with computational variables.</p></disp-quote><p>We agree and apologize for the confusion. We do indeed find a strong negative correlation between baseline pupil diameter and our measure of baseline-subtracted evoked change. Therefore, all of our analyses of baseline-subtracted evoked change include baseline as a nuisance regressor. We have revised the Results and Materials and methods sections to make this point more clearly.</p><disp-quote content-type="editor-comment"><p>– The authors should report these correlations.</p></disp-quote><p>We now report the correlations between baseline and evoked changes in pupil in the Results section.</p><disp-quote content-type="editor-comment"><p>– I encourage them to replace their &quot;evoked pupil change&quot; with the 1st temporal derivative of the pupil signal in the post-tone interval; this measure has many advantages as a metric of phasic arousal: it is more temporally precise, it more specifically tracks norepinephrine (rather than ACh) transients, and, most critically, it tends to decorrelate measures of phasic arousal from baseline diameter measures of tonic arousal, see de Gee et al., 2019.</p></disp-quote><p>We now include a complimentary analysis of the derivative of pupil responses, which shows the same strong surprise effects as our analysis of evoked pupil (new Figure 3—figure supplement 2). We report in the Results section that this measure is also negatively correlated with baseline pupil diameter.</p><disp-quote content-type="editor-comment"><p>– For all tonic arousal effects it would be interesting to see effects for the previous baseline, not only the current and next baseline (this could show, for instance, if switches in response hand are preceded or succeeded by an increase of baseline arousal).</p></disp-quote><p>We again apologize for the confusion. The baseline pupil diameter analysis in Figure 2A corresponds to the analysis the reviewer is suggesting: baseline arousal is higher when participants make the less common prediction type (prediction switches in the low/intermediate hazard, and prediction repeats in the high hazard), <italic>before</italic> the tone is heard. This result implies that tonic arousal is higher when subjects are more uncertain and more likely to make the less common predictions. We have clarified this result and our interpretation in the text.</p><disp-quote content-type="editor-comment"><p>2) Split by choice variability.</p><p>Split into high vs low variability subjects seems ad hoc. No motivation is provided for doing so in Results, beyond this: &quot;some participants had very high choice variability, and the interesting relationships reported here were present for low variability participants but not high variability participants&quot;.</p><p>If model complexity is really a useful construct that captures key features of how individuals perform a task like this, then shouldn't it encompass not just low variability participants, but high variability participants also?</p></disp-quote><p>We agree that this analysis was somewhat ad hoc and confusing and have removed it from the paper.</p><disp-quote content-type="editor-comment"><p>3) Individual differences.</p><p>The pupil individual difference effects in Figure 6 are highly specific, examining the relationship between estimated model complexity and particular pupil effects within each H condition. If pupil-linked arousal plays a critical role in context-dependent belief updating, wouldn't one expect pupil changes across H conditions to correlate with changes in behaviour/belief updating across conditions? Such an analysis would get even closer to the claim that pupil-linked arousal is involved in adaptation of the inference process to different environmental contexts.</p></disp-quote><p>We have made extensive revisions to the text, analyses, and figures to expand upon and clarify this important point. These changes include:</p><list list-type="bullet"><list-item><p>A new figure (Figure 5) showing that belief-updating complexity is represented in baseline pupil diameter when considering all trials across hazard-rate conditions, as the reviewer suggests. As described in the text: “given that each subject’s pupil modulations reflected their own belief-updating strategy, and given that those strategies differed in complexity across subjects, it followed that their pupil modulations, measured with respect to a fixed referent strategy (i.e., from the Bayesian model using a wide prior over hazard rate), reflected the complexity of their strategy.”</p></list-item><list-item><p>A more thorough description of why the within-hazard effects are specific to the high hazard condition. In brief, that is the only condition with a mismatch between bottom-up change and top-down surprise. Because of this mismatch, individual differences in topdown strategies play a much larger role in how subjects treat tone switch versus nonswitch trials in the high versus other hazard conditions. Consequently, it follows that only in the high-hazard condition do we see systematic, complexity-dependent differences in how the pupil responds to tones on switch versus non-switch trials.</p></list-item></list><disp-quote content-type="editor-comment"><p>4) Interpretation of hazard rate condition differences.</p><p>In Discussion, authors speculate that relatively poorer performance in high H condition is due to a failure to engage arousal systems, which in turn produces less effective adaptation to that particular context. But the direction of causality could be reversed – participants might inherently underestimate the H in this context (perhaps due to strong priors for more stable environments encountered in everyday life), and that their level of surprise/arousal is actually appropriate given their subjective H. I suggest this possibility be acknowledged and given equal weight in the Discussion.</p></disp-quote><p>We agree and have substantially revised the Discussion accordingly.</p><disp-quote content-type="editor-comment"><p>5) Is it possible that in Figure 1B, the dashed and dotted lines for H=.99 have been flipped?</p></disp-quote><p>We have checked and all of the lines in this figure were correctly displayed.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>This paper reports a highly detailed analysis of the fundamental concepts that are reflected in pupil diameter. The study has a rather large sample size. The first part of the Results section presents findings that are a bit trivial and other findings that replicate the authors' previous work (mainly Nassar et al., 2012 and Glaze et al., 2015). But the paper also presents a number of novel analyses showing how the arousal system encodes complex context-dependent measures of uncertainty and belief updating. I am not able to judge the details of the complexity measure analyses and the &quot;adaptivity model&quot; (Materials and methods).</p><p>1) The paper aims to provide a unified framework for understanding pupil effects in terms of both inference processes and more traditional notions of mental effort and cognitive load. I encourage the authors to discuss how their framework accounts for the typical findings that gave rise to those traditional notions. In addition, could they briefly discuss the relationship between their framework and this paper from Karl Friston's group: Vincent et al., 2019 (https://www.ncbi.nlm.nih.gov/pubmed/31276488).</p></disp-quote><p>We thank the reviewer for this useful suggestion and have expanded on this point in the Discussion.</p><disp-quote content-type="editor-comment"><p>2) It would be good if the authors are more explicit in the Results section about which findings are &quot;old&quot; and where the new findings start.</p></disp-quote><p>We have substantially revised our presentation of the results, relegating most of the “old” findings to the supplemental materials (or removed them entirely) and focusing on just the novel findings.</p><disp-quote content-type="editor-comment"><p>3) Subsection “Pupil diameter is sensitive to adaptive, context-dependent expectations” and Figure 2C: &quot;These effects persisted into the next baseline pupil, with larger pupil dilation after both stimulus and prediction switches on low and intermediate hazard-rate trials.&quot; Do these findings reflect real baseline shifts? Or are three seconds simply not enough for the pupil response to the previous tone stimulus to return to baseline?</p></disp-quote><p>We did not test longer inter-trial intervals and thus do not know how long these effects last. However, we emphasize that these baseline pupil modulations were measured after taking into account the strong positive correlation between baseline pupil and the previously evoked change in pupil (i.e., the previous evoked change was included as a nuisance regressor in the linear model). Thus, these effects were not simply the persistence of the evoked change. We have clarified these points in the figure legend.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>In this study Filipowicz and colleagues investigated the relationship between pupil dilation, perceptual surprise and belief updating in ~80 human participants. The used an auditory one-arm bandit task with variable hazard rate. Baseline pupil and phasic pupil response to stimuli were investigated. A number of mathematical models are proposed to account for within-and between subject variation in pupil response.</p><p>I was very interested to read this study which is close to my area of research. However, I was not convinced that it would command sufficient interest outside the immediate field to merit publication in eLife. The first reason for this assessment is that the study is a detailed investigation of an experimental effect (pupil dilation in response to learning conditions and surprise) rather than addressing a deeper hypothesis about the brain or behaviour per se. The second reason is that the bulk of the results are presented in relation to specific models and again I am not convinced that non-specialist readers would know how to generalize these (although this could possibly be addressed by a re-write that emphasises the take-home points). Thirdly, in some cases, if a study addressed a relatively non-innovative question but had a rare or technically excellent dataset I would still think it might be a good fit for eLife, but the data in this study would not be hard to collect for most cog neuro labs.</p><p>I have the following specific comments:</p><p>1) Figure 1 and related text</p><p>Subjects (and the model) seem to hugely under-estimate the Hazard rate in high H=0.99 condition and overestimate it in low H=0.33 condition (based on Figure 1D). How can this be explained?</p></disp-quote><p>We thank the reviewer for bringing up this interesting and important point, which we have also reported for other tasks with similar statistical structures (Glaze et al., 2015; Kim et al., 2017). In our 2018 paper (Glaze et al) that focused on the bias-variance trade-off, we showed that this observation can be accounted for (providing a “how” if not necessarily a “why”) via the normative learning model we use in the present study, in terms of a prior over hazard rate that tends to be centered around 0.4–0.5 for most subjects. We have previously speculated (in Kim et al) that this value may be the default for many people because it might minimize computational costs (e.g., Drugowitsch et al., 2012; Shenhav et al., 2013). We are actively working on this question.</p><p>We now cover this point explicitly in the Discussion.</p><disp-quote content-type="editor-comment"><p>2) Figure 2 and related text</p><p>It seems to me that this non-model-based analysis needs more unpacking.</p><p>– The pupil effects are not broken down into correct (prediction and stimulus = same location) and incorrect trials but I would expect a large difference in the phasic response between these trial types. This should interact with hazard rate as in low H=0.01 case, prediction switch trials should often be correct as they will follow multiple stimulus shifts. Could correct v incorrect be included in the regression model?</p><p>– The task gives quite a few rich comparisons that could be explored before getting stuck in to the modelling.</p><p>I would have liked to see more basic contrasts presented, eg:</p><p>– Compare the phasic pupil response for unexpected switches (in H=0.01) and unexpected repeats (in H=0.99) which nicely mirror each other.</p><p>– Compare baseline pupil on prediction-switch trials that follow a stimulus switch (presumably, mainly in the H=0.01 condition) and on prediction-switch trials that follow a stimulus repeat (presumably, mainly in the H=0.99 condition).</p><p>– Compare phasic pupil response following stimulus switches that will and will not be followed by a prediction switch.</p><p>These are results in themselves and would give the reader a better sense of the data without having to interpret in the light of models etc.</p></disp-quote><p>We appreciate the very useful suggestions and now include more extensive analyses and discussions of the basic task-driven pupil dynamics before considering the learning model, including results from a linear regression with tone switch/repeat, correct/error, and the interaction between the two as regressors (Figure 2—figure supplement 2).</p><disp-quote content-type="editor-comment"><p>3) Figure 3 and related text</p><p>As for Figure 2, can surprise (based on model beliefs) be teased apart from correct vs incorrect (ie simply whether the prediction and stimulus were in the same location)?</p></disp-quote><p>As noted above, we now show pupil modulations by correct versus errors (and their interaction with tone switch/repeat trials; Figure 2—figure supplement 2). These modulations are consistent with the surprise-driven modulations we show in Figure 3. Note that in this task there is no separate feedback about correct or error responses separate from the sound presentation on the next trial, so high surprise (a violation of the prediction) is very strongly correlated with errors.</p><disp-quote content-type="editor-comment"><p>4) Model complexity</p><p>I am struggling to understand how model complexity was defined exactly (Figure 4A). What is meant by the mutual information between the features of past trials and the current response – surely there must be some intervening policy that predicts the correct response based on these past features – what is it? Am I right in thinking that the model complexity captures both the extent of the integration kernel, or also so qualitative features of model complexity (e.g. another level in model hierarchy that tells you that you should alternate n the H=0.99 condition)? What aspects of the model complexity measure capture these two processes and can they be teased apart?</p></disp-quote><p>We apologize for the confusion and have substantially revised our description of the complexity measure to improve clarity. In short, yes, this measure is based on the assumption that the subject is using a policy (we use the term “strategy” to be more general) that makes predictions based on those features. Critically, however, as we note in the text, this method “requires no assumptions about the specific strategy the subject is using to perform the task (Bialek, Nemenman and Tishby, 2001; Chechik et al., 2005; Filipowicz et al., 2020; Tishby et al., 2000).” That is, with this measure we capture the amount of information the policy encodes but nothing about its form (although note that in Glaze et al., 2018, we showed that in the context of this kind of task, this measure is closely related to the width of the prior in the normative learning model, which we refer to in the present manuscript).</p><disp-quote content-type="editor-comment"><p>5) Figure 4 and related text</p><p>The relationship between three model based parameters in Figures 4C,D,E looks suspiciously good to me! Could this have arisen because these parameters to some extent capture similar features in the data, rather than separate but correlated cognitive processes? If the authors were to simulate agents who varied on only one or two of the parameters (choice variability/adaptivity/model complexity), to what extent would they be able to recover parameter fits that vary only in that one parameter?</p></disp-quote><p>We have included parameter recovery analyses for both the adaptivity model and Bayesian updating model (Figure 4—figure supplement 1) to show that our parameters are highly recoverable, and the correlations between adaptivity and choice variability are not due to biases in the model specification (as we showed in Glaze et al., 2018).</p><disp-quote content-type="editor-comment"><p>6) Figure 5</p><p>Can the model based results be related back to raw behaviour? How should Figures 1C,D differ for subjects showing high and low model complexity?</p></disp-quote><p>Subjects with more complex beliefs show stronger hazard-dependent behavior (i.e., they adapt better to changes in hazard rate). We have included a panel showing changes in subject behavior as a function of different complexity terciles (Figure 4B).</p><disp-quote content-type="editor-comment"><p>7) Figure 7</p><p>Am I right in thinking the y-axis on this figure is mean pupil size (or mean phasic pupil response) as a subject-measure? How is this defined given that the raw pupil size on the eye tracker depends mainly on irrelevant factors like the distance from the camera to the eye and the size of the eye? I'm sure there is a sensible definition but I didn't manage to find it in the text. Further, might you not expect an inverted U (Yerkes-Dodson) relationship between pupil dilation and model complexity?</p></disp-quote><p>The goal of this figure was primarily to demonstrate that the effects we observed in Figure 6 were due to real differences between tone switch and non-switch trials rather than some idiosyncrasies in overall baseline or evoked changes. However, our experimental set up does not allow us to make specific claims about how pupil diameter differs as a function of complexity, particularly not without accounting for all of the factors the reviewer mentions (e.g., viewing distance, eye size, etc). We have therefore removed this figure and mention of these analyses from our manuscript.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>You have addressed most of the reviewer concerns in a rigorous and comprehensive fashion. Yet, we felt, that the following conceptual points would deserve further attention in the presentation and discussion of your current findings.</p><p>1) Complexity measure and pupil. Please do more to explain/make intuitive your complexity measure. An example would be welcome. Everyone should be able to understand the most novel finding.</p></disp-quote><p>We have included a more detailed explanation and example of our complexity measure in subsection “Pupil dynamics reflect individual differences in belief-updating complexity” of the revised manuscript.</p><disp-quote content-type="editor-comment"><p>2) Pupil response to the “absence of change”. It has already been shown that the pupil responds to the unexpected absence of a stimulus (Qiyuan et al., 1985): There's nothing on the screen during the inter-trial interval and then, against expectations, no stimulus is presented. This is another example of &quot;there is no sensory change but still a clear pupil response&quot;, indicating that the pupil responds to the violated expectation and not to bottom changes in sensory input.</p></disp-quote><p>We have added a sentence to the Introduction to highlight this finding and have added this reference.</p><disp-quote content-type="editor-comment"><p>3) Discussion of effort and load. In a new discussion paragraph, you now exclude a number of operationalizations of effort/load as an explanation for your findings. This is quite helpful. However, you end the Abstract mentioning that you will provide a unified framework for understanding effects of new inputs on arousal systems &quot;in terms of both inference processes aimed to reduce belief uncertainty and more traditional notions of mental effort&quot;. We took that to mean that you will offer new interpretations of classical pupil findings, that have previously been explained in terms of effort or load. As far as we see, there is no such unified framework presented in the paper. We feel the last sentence of the Abstract should be toned down.</p></disp-quote><p>We have revised the last sentence of the Abstract.</p></body></sub-article></article>