<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">47012</article-id><article-id pub-id-type="doi">10.7554/eLife.47012</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Inferring synaptic inputs from spikes with a conductance-based neural encoding model</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-135266"><name><surname>Latimer</surname><given-names>Kenneth W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9981-3903</contrib-id><email>latimerk@uchicago.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">†</xref></contrib><contrib contrib-type="author" id="author-135467"><name><surname>Rieke</surname><given-names>Fred</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1052-2609</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-10627"><name><surname>Pillow</surname><given-names>Jonathan W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3638-8831</contrib-id><email>pillow@princeton.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Physiology and Biophysics</institution><institution>University of Washington</institution><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Princeton Neuroscience Institute, Department of Psychology</institution><institution>Princeton University</institution><addr-line><named-content content-type="city">Princeton</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Palmer</surname><given-names>Stephanie</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Frank</surname><given-names>Michael J</given-names></name><role>Senior Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Department of Neurobiology, University of Chicago, Chicago, United States</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>18</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e47012</elocation-id><history><date date-type="received" iso-8601-date="2019-03-22"><day>22</day><month>03</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2019-12-17"><day>17</day><month>12</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Latimer et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Latimer et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-47012-v2.pdf"/><abstract><p>Descriptive statistical models of neural responses generally aim to characterize the mapping from stimuli to spike responses while ignoring biophysical details of the encoding process. Here, we introduce an alternative approach, the conductance-based encoding model (CBEM), which describes a mapping from stimuli to excitatory and inhibitory synaptic conductances governing the dynamics of sub-threshold membrane potential. Remarkably, we show that the CBEM can be fit to extracellular spike train data and then used to predict excitatory and inhibitory synaptic currents. We validate these predictions with intracellular recordings from macaque retinal ganglion cells. Moreover, we offer a novel quasi-biophysical interpretation of the Poisson generalized linear model (GLM) as a special case of the CBEM in which excitation and inhibition are perfectly balanced. This work forges a new link between statistical and biophysical models of neural encoding and sheds new light on the biophysical variables that underlie spiking in the early visual pathway.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>retinal circuitry</kwd><kwd>statistical modeling</kwd><kwd>synaptic condutances</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005270</institution-id><institution>McKnight Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Pillow</surname><given-names>Jonathan W</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><award-id>SCGB AWD1004351</award-id><principal-award-recipient><name><surname>Pillow</surname><given-names>Jonathan W</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IIS-1150186</award-id><principal-award-recipient><name><surname>Pillow</surname><given-names>Jonathan W</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>MH099611</award-id><principal-award-recipient><name><surname>Pillow</surname><given-names>Jonathan W</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Rieke</surname><given-names>Fred</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>EY011850</award-id><principal-award-recipient><name><surname>Rieke</surname><given-names>Fred</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The conductance-based encoding model creates a new bridge between statistical models and biophysical models of neurons, and infers visually-evoked excitatory and inhibitory synaptic conductances from spike trains in macaque retina.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Studies of neural coding seek to reveal how sensory information is encoded in neural spike responses. A complete understanding this code requires knowledge of the statistical relationship between stimuli and spike trains, as well as the biophysical mechanisms by which this transformation is carried out. A popular approach to the neural coding problem involves ‘cascade’ models, such as the linear-nonlinear-Poisson (LNP) or generalized linear model (GLM), to characterize how external stimuli are converted to spike trains. These descriptive statistical models describe the encoding process in terms of a series of stages: linear filtering, nonlinear transformation, and ending with noisy or conditionally Poisson spiking (<xref ref-type="bibr" rid="bib15">Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib61">Paninski, 2004</xref>; <xref ref-type="bibr" rid="bib95">Vintch et al., 2012</xref>; <xref ref-type="bibr" rid="bib67">Park et al., 2013</xref>; <xref ref-type="bibr" rid="bib88">Theis et al., 2013</xref>; <xref ref-type="bibr" rid="bib96">Vintch et al., 2015</xref>). These models have found broad application to neural data, and the Poisson GLM in particular has provided a powerful tool for characterizing neural encoding in a variety of sensory, cognitive, and motor brain areas (<xref ref-type="bibr" rid="bib34">Harris et al., 2003</xref>; <xref ref-type="bibr" rid="bib90">Truccolo et al., 2005</xref>; <xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib30">Gerwinn, 2010</xref>; <xref ref-type="bibr" rid="bib86">Stevenson et al., 2012</xref>; <xref ref-type="bibr" rid="bib98">Weber et al., 2012</xref>; <xref ref-type="bibr" rid="bib68">Park et al., 2014</xref>; <xref ref-type="bibr" rid="bib33">Hardcastle et al., 2015</xref>; <xref ref-type="bibr" rid="bib102">Yates et al., 2017</xref>). </p><p>However, there is a substantial gap between cascade-style descriptive statistical models and mechanistic or biophysically interpretable models. In real neurons, stimulus integration is nonlinear, arising from an interplay between excitatory and inhibitory synaptic inputs that depend nonlinearly on the stimulus; these inputs in turn drive conductance changes that alter the nonlinear dynamics governing membrane potential. In retina and other sensory areas, the tuning of excitatory and inhibitory inputs can differ substantially (<xref ref-type="bibr" rid="bib77">Roska et al., 2006</xref>; <xref ref-type="bibr" rid="bib89">Trong and Rieke, 2008</xref>; <xref ref-type="bibr" rid="bib73">Poo and Isaacson, 2009</xref>; <xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>), meaning that a single linear filter is not sufficient to describe stimulus integration in single neurons. Determining how stimuli influence neural conductance changes, and thus the computations that neurons perform, therefore remains an important challenge. This challenge is exacerbated by the fact that most studies of neural coding rely on extracellular recordings, which detect only spikes and not synaptic conductance changes that drive them.</p><p>Here, we aim to narrow the gap between descriptive statistical models and biophysically interpretable models, while remaining within the domain of models that can be estimated from extracellular spike train data (<xref ref-type="bibr" rid="bib53">Meng et al., 2011</xref>; <xref ref-type="bibr" rid="bib54">Meng et al., 2014</xref>; <xref ref-type="bibr" rid="bib97">Volgushev et al., 2015</xref>; <xref ref-type="bibr" rid="bib41">Lankarany, 2017</xref>). We first introduce a quasi-biophysical interpretation of the standard Poisson GLM, which reveals its equivalence to a constrained conductance-based model with equal and opposite excitatory and inhibitory tuning. We then relax these constraints in order to obtain a more flexible and more realistic conductance-based model with independent tuning of excitatory and inhibitory inputs. The resulting model, which we refer to as the <italic>conductance-based encoding model</italic> (CBEM), can capture key features of real neurons such as shunting inhibition and time-varying changes in gain and membrane time constant. We show that the CBEM can predict excitatory and inhibitory synaptic conductances from stimuli and extracellular spike trains alone, which we validate by comparing model predictions to conductances measured with intracellular recordings in macaque parasol and midget retinal ganglion cells (RGCs). This work differs from previous cascade modeling approaches for separating excitatory and inhibitory inputs (e.g., <xref ref-type="bibr" rid="bib9">Butts et al., 2011</xref>; <xref ref-type="bibr" rid="bib59">Ozuysal et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">McFarland et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Maheswaranathan et al., 2018</xref>) by explicitly defining the model components in a biophysical framework and directly comparing model predictions to measured excitation and inhibition tuning in individual cells. We also show that the CBEM outperforms the standard GLM at predicting retinal spike responses to novel stimuli. These differences highlight the CBEM’s ability to shed light on the computations performed by sensory neurons in naturalistic settings.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Background: Poisson GLM with spike history</title><p>The Poisson GLM provides a simple yet powerful description of the encoding relationship between stimuli and neural responses (<xref ref-type="bibr" rid="bib90">Truccolo et al., 2005</xref>). A recurrent Poisson GLM, often referred to in the neuroscience literature simply as ‘the GLM’, describes neural encoding in terms of a cascade of linear, nonlinear, and probabilistic spiking stages (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). The GLM parameters consist of a stimulus filter <inline-formula><mml:math id="inf1"><mml:mi mathvariant="bold">𝐤</mml:mi></mml:math></inline-formula>, which describes how the neuron integrates an external stimulus, a post-spike filter <inline-formula><mml:math id="inf2"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula>, which captures dependencies on spike history, and a baseline <inline-formula><mml:math id="inf3"><mml:mi>b</mml:mi></mml:math></inline-formula> that determines baseline firing rate in the absence of input. The outputs of these filters are summed and passed through a nonlinear function <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> to obtain the conditional intensity for an inhomogeneous Poisson spiking process. The model can be written concisely in discrete time as:<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(1)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thickmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thickmathspace"/><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="thickmathspace"/><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mspace width="1em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(2)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mphantom><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">z</mml:mi></mml:mphantom></mml:mrow></mml:mstyle></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mspace width="1em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf5"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is the spike rate (or conditional intensity) at time <inline-formula><mml:math id="inf6"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf7"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the spatio-temporal stimulus vector at time <inline-formula><mml:math id="inf8"><mml:mi>t</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf9"><mml:msubsup><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is a vector of relevant spike history at time <inline-formula><mml:math id="inf10"><mml:mi>t</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the spike count in bin of size <inline-formula><mml:math id="inf12"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>. Although spike generation is conditionally Poisson, the model can capture complex history-dependent response properties such as refractoriness, bursting, bistability, and adaptation (<xref ref-type="bibr" rid="bib99">Weber and Pillow, 2016</xref>). Additional filters can be added to the model in order to incorporate dependencies on covariates of the response such as spiking in other neurons or local field potential recorded on nearby electrodes (<xref ref-type="bibr" rid="bib90">Truccolo et al., 2005</xref>; <xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Kelly et al., 2010</xref>). A common choice for the nonlinearity is exponential, <inline-formula><mml:math id="inf13"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which corresponds to the ‘canonical’ inverse link function for Poisson GLMs.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Model diagrams.</title><p>(<bold>A</bold>) Diagram illustrating novel biophysical interpretation of the generalized linear model (GLM). The stimulus <inline-formula><mml:math id="inf14"><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is convolved with a conductance filter <inline-formula><mml:math id="inf15"><mml:mi mathvariant="bold">𝐤</mml:mi></mml:math></inline-formula> weighted by <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the difference between excitatory and inhibitory current reversal potentials, resulting in total synaptic current <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This current is injected into the linear RC circuit governing the membrane potential <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, which is subject to a leak current with conductance <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and reversal potential <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>. The instantaneous probability of spiking is governed by a the conditional intensity <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf22"><mml:mi>f</mml:mi></mml:math></inline-formula> is a nonlinear function with non-negative output. Spiking is conditionally Poisson with rate <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, and spikes gives rise to a post-spike current or filter <inline-formula><mml:math id="inf24"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula> that affects the subsequent membrane potential. (<bold>B</bold>) Conductance-based encoding model (CBEM). The stimulus <inline-formula><mml:math id="inf25"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is convolved with filters <inline-formula><mml:math id="inf26"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, whose outputs are transformed by rectifying nonlinearity <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> to produce excitatory and inhibitory synaptic conductances <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. These time-varying conductances and the static leak conductance <inline-formula><mml:math id="inf31"><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> drive synaptic currents with reversal potentials <inline-formula><mml:math id="inf32"><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula>, respectively. The resulting membrane potential <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is added to a linear spike-history term, given by <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, and then transformed via rectifying nonlinearity <inline-formula><mml:math id="inf37"><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> to obtain the conditional intensity <inline-formula><mml:math id="inf38"><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, which governs conditionally Poisson spiking as in the GLM. <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> shows that the CBEM parameters can be recovered from simulated data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Convergence of model parameter fits.</title><p>(<bold>A</bold>) Estimates (solid traces) of excitatory (blue) and inhibitory (red) filters from 10 min of simulated spike trains. (Dashed lines indicate true filters). The inhibitory filter was oppositely tuned and delayed compared to the excitatory filter. (<bold>B</bold>) The <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> norm between the estimated input filters and the true filters as a function of the amount of training data. (<bold>C</bold>) The log-likelihood of the fit CBEM on the test data converged towards the log-likelihood of the true model. (<bold>D,E,F</bold>) Same as A-C for a simulation in which <inline-formula><mml:math id="inf40"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> had the same tuning as <inline-formula><mml:math id="inf41"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> with a delay.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig1-figsupp1-v2.tif"/></fig></fig-group><p>Previous literature has offered a quasi-biological interpretation of the GLM known as ‘soft threshold’ integrate-and-fire (IF) model (<xref ref-type="bibr" rid="bib72">Plesser and Gerstner, 2000</xref>; <xref ref-type="bibr" rid="bib29">Gerstner, 2001</xref>; <xref ref-type="bibr" rid="bib63">Paninski et al., 2007</xref>; <xref ref-type="bibr" rid="bib55">Mensi et al., 2011</xref>). This interpretation views the summed filter outputs as the neuron’s membrane potential. This is similar to the standard IF model in which membrane potential is a linearly filtered version of input current (as opposed to conductance-based input). The nonlinear function <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> can be interpreted as a ‘soft threshold’ function that governs a smooth increase in the instantaneous spike probability as a function of membrane depolarization. Lastly, the post-spike current <inline-formula><mml:math id="inf43"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula> determines how membrane potential is reset following a spike.</p><p>We can rewrite the standard GLM to emphasize this biological interpretation explicitly:<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(3)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thickmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thickmathspace"/><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="thickmathspace"/><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mstyle></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mspace width="1em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(4)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mphantom><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>d</mml:mi><mml:mi>g</mml:mi><mml:mi>j</mml:mi><mml:mi>z</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/></mml:mphantom></mml:mrow></mml:mstyle></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mspace width="1em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mphantom><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mphantom></mml:mrow></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(5)</mml:mtext></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>Poiss</mml:mtext></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mrow><mml:mphantom><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>j</mml:mi><mml:mi>z</mml:mi></mml:mphantom></mml:mrow></mml:mstyle></mml:mstyle></mml:mtd><mml:mtd><mml:mi/><mml:mspace width="1em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mphantom><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mi>x</mml:mi><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mphantom></mml:mrow></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that in this ‘soft’ version of the IF model, the only noise source is the conditionally Poisson spiking mechanism; this differs from other noisy extensions of the IF model with linear current-based input and ‘hard’ spike thresholds, which require more elaborate methods for computing likelihoods (<xref ref-type="bibr" rid="bib61">Paninski, 2004</xref>; <xref ref-type="bibr" rid="bib70">Pillow et al., 2005</xref>; <xref ref-type="bibr" rid="bib64">Paninski et al., 2008</xref>). To convert this model to a classic leaky integrate-and-fire model, we could replace <inline-formula><mml:math id="inf44"><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> with a ‘hard’ threshold function that jumps from zero to infinity at some threshold value of the membrane potential, set the stimulus filter <inline-formula><mml:math id="inf45"><mml:mi mathvariant="bold">𝐤</mml:mi></mml:math></inline-formula> to an exponential decay filter, and set the post-spike filter <inline-formula><mml:math id="inf46"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula> to a delta function that causes instantaneous reset of the membrane potential following a spike. The GLM membrane potential is a linear function of the input, just as in the classic leaky IF model, and thus both models fail to capture the nonlinearities apparent in the synaptic inputs to most real neurons (<xref ref-type="bibr" rid="bib83">Schwartz and Rieke, 2011</xref>).</p></sec><sec id="s2-2"><title>Interpreting the GLM as a conductance-based model</title><p>Here, we propose a novel biophysically realistic interpretation of the classic Poisson GLM as a dynamical model with conductance-based input. In brief, this involves writing the GLM as a conductance-based model with excitatory and inhibitory conductances governed by affine functions of the stimulus, but constrained so that total conductance is fixed. This removes voltage-dependence of the membrane currents, making the membrane potential itself an affine function of the stimulus. The remainder of this section lays out the mathematical details of this interpretation explicitly.</p><p>Consider a neuron with membrane potential <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> governed by the ordinary differential equation:<disp-formula id="equ3"><label>(6)</label><mml:math id="m3"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo maxsize="120%" minsize="120%">(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo maxsize="120%" minsize="120%">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> is leak conductance, <inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are time-varying excitatory and inhibitory synaptic conductances, and <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are the leak, excitatory and inhibitory reversal potentials.</p><p>A natural question to ask is: under what conditions, if any, is this model a GLM? Answering this question aims to reveal what biophysical assumptions the GLM implicitly enforces when modeling spike trains. Here, we provide a set of sufficient conditions for an equivalence between the two. The definition of a GLM requires the membrane potential <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> to be an affine (linear plus constant) function of the stimulus, which holds if the two following conditions are met:</p><list list-type="order"><list-item><p>Total conductance <inline-formula><mml:math id="inf55"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is constant, so the membrane equation is a linear ODE.</p></list-item><list-item><p>The input current <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is an affine function of the stimulus <inline-formula><mml:math id="inf57"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>.</p></list-item></list><p>The first condition implies <inline-formula><mml:math id="inf58"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula>, for some constant <inline-formula><mml:math id="inf59"><mml:mi>c</mml:mi></mml:math></inline-formula>, and the second implies that <inline-formula><mml:math id="inf60"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is a linear function of the stimulus.</p><p>We can satisfy these two conditions simultaneously by modeling the excitatory and inhibitory conductances as affine functions of the stimulus, driven by linear filters of opposite sign:<disp-formula id="equ4"><label>(7)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mstyle></mml:mtd><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mtd><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf61"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> denotes the linear ‘conductance’ filter, and <inline-formula><mml:math id="inf62"><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf63"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are arbitrary constants. Under this setting, excitatory and inhibitory conductances are driven by equal and opposite linear projections of the stimulus, with total conductance fixed at <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>We can therefore rewrite the membrane equation (<xref ref-type="disp-formula" rid="equ3">Equation 6</xref>) as:<disp-formula id="equ5"><label>(8)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">G</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">q</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Setting the initial voltage to the steady-state value <inline-formula><mml:math id="inf66"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the instantaneous membrane potential is then given by<disp-formula id="equ6"><label>(9)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mo>⋅</mml:mo><mml:mpadded width="+1.7pt"><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mpadded></mml:mrow><mml:mo rspace="4.2pt">+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the equivalent standard GLM filter <inline-formula><mml:math id="inf67"><mml:mi mathvariant="bold">𝐤</mml:mi></mml:math></inline-formula> is equal to the linear convolution of <inline-formula><mml:math id="inf68"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> with an exponential decay filter, that is: <inline-formula><mml:math id="inf69"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo rspace="4.2pt" stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> This shows that membrane potential <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is an affine function of the stimulus, so by adding a monotonic nonlinearity and conditionally Poisson spiking, the model is clearly a GLM.</p><p>Thus, to summarize, the GLM can be interpreted as a conductance-based model in which a linear filter drives equal and opposite fluctuations in excitatory and inhibitory synaptic conductances. The GLM filter <inline-formula><mml:math id="inf71"><mml:mi mathvariant="bold">𝐤</mml:mi></mml:math></inline-formula> is equal to the convolution of this conductance filter with an exponential decay filter whose time constant is the inverse of the (constant) total conductance.</p></sec><sec id="s2-3"><title>The conductance-based encoding model (CBEM)</title><p>From this novel interpretation of the GLM, it is straightforward to formulate a more realistic conductance-based statistical spike train model. Namely, we can remove the constraint needed to construct a GLM: that excitatory and inhibitory conductance sum to a constant. Relaxing this constraint, so that total conductance can vary, results in a new model that we refer to as the <italic>conductance-based encoding model</italic> (CBEM). The CBEM represents an extension of GLM to allow for differential tuning of excitation and inhibition and adds rectifying nonlinearities governing the relationship between the stimulus and synaptic conductances. (See model diagram, <xref ref-type="fig" rid="fig1">Figure 1b</xref>). The CBEM model is no longer a GLM because the filtering it performs on the stimulus is nonlinear.</p><p>Formally, the CBEM is driven by excitatory and inhibitory synaptic conductances that are each linear-nonlinear functions of the stimulus:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ8"><label>(10)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf72"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> are linear filters driving excitatory and inhibitory conductance, respectively, <inline-formula><mml:math id="inf74"><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> is a soft-rectifying nonlinearity that ensures that conductances are non-negative (see Materials and methods, <xref ref-type="disp-formula" rid="equ12">Equation 14</xref>), and <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> determine the baseline excitatory and inhibitory conductances in the absence of input. The CBEM membrane potential <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> then evolves according to the ordinary differential equation (<xref ref-type="disp-formula" rid="equ3">Equation 6</xref>) under the influence of the two time-varying conductances <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To incorporate spike-history effects, we add a linear autoregressive term to the membrane potential. This results in an ‘effective’ membrane potential <inline-formula><mml:math id="inf80"><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> given by:<disp-formula id="equ9"><label>(11)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">y</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf81"><mml:msubsup><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is a vector of binned spike history at time t. We convert membrane potential to spike rate using a biophysically motivated output nonlinearity proposed by <xref ref-type="bibr" rid="bib55">Mensi et al. (2011)</xref>:<disp-formula id="equ10"><label>(12)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>λ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>β</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf82"><mml:mi>μ</mml:mi></mml:math></inline-formula> is a ‘soft’ spike threshold, and <inline-formula><mml:math id="inf83"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf84"><mml:mi>β</mml:mi></mml:math></inline-formula> jointly determine slope and sharpness of the nonlinearity, respectively (see Materials and methods). Spiking is then a conditionally Poisson process given the rate, as in the Poisson GLM (<xref ref-type="disp-formula" rid="equ2">Equation 5</xref>).</p><p>The CBEM is similar to the Poisson GLM in that the only source of stochasticity is the conditionally Poisson spiking mechanism: we assume no additional noise in the conductances or the voltage. This simplifying assumption, although not biophysically accurate, makes log-likelihood simple to compute, allowing for efficient maximum likelihood inference using standard ascent methods (see Materials and methods).</p></sec><sec id="s2-4"><title>Validating the CBEM modeling assumptions with intracellular data</title><p>To validate the modeling assumptions of the CBEM, we use intracellular recordings from RGCs. First, we establish that an LN model can capture the relationship between stimuli and synaptic conductances measured intracellularly (<xref ref-type="fig" rid="fig2">Figure 2</xref>). An LN model for RGC conductances is plausible because the bipolar cells that drive RGCs are known to be well-characterized by LN models (<xref ref-type="bibr" rid="bib76">Rieke, 2001</xref>; <xref ref-type="bibr" rid="bib21">Demb et al., 2001</xref>; <xref ref-type="bibr" rid="bib5">Beaudoin et al., 2008</xref>; <xref ref-type="bibr" rid="bib31">Gollisch and Meister, 2010</xref>; <xref ref-type="bibr" rid="bib44">Liu et al., 2017</xref>; <xref ref-type="bibr" rid="bib75">Real et al., 2017</xref>). To test the assumption in detail, we analyzed voltage clamp recordings from ON parasol RGCs in response to a full-field noise stimulus (<xref ref-type="bibr" rid="bib89">Trong and Rieke, 2008</xref>). We fit the measured conductances with a linear-nonlinear model with a soft-rectified nonlinearity to account for synaptic thresholding at the bipolar-to-ganglion cell synapse (and at the amacrine cell synapses for the inhibitory inputs): <inline-formula><mml:math id="inf85"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The model accurately captured the relationship between projected stimuli and observed conductances on test data, accounting for 79 ± 4% (mean ± SEM) and 63 ± 3% of the variance of mean excitatory and inhibitory conductances, respectively.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Validating the LN conductance model.</title><p>The CBEM describes the relationship between stimulus and each synaptic conductance with a linear-nonlinear (LN) cascade, consisting of a linear filter followed by a fixed rectifying nonlinearity. (<bold>A</bold>) LN conductance model schematic. (<bold>B</bold>) The percent variance explained (<inline-formula><mml:math id="inf86"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>) for excitatory and inhibitory conductances from 6 ON parasol RGCs, computed using cross-validation with a 6 s test stimulus. Error bars indicate standard deviation across all test stimuli. (<bold>C</bold>) The excitatory conductance as a function of the filtered stimulus values for the example cell indicated in green in B. The gray region shows the middle 50-percentile of the distribution of observed excitatory conductance given the filtered stimulus value. The soft-rectifying nonlinearity (dark blue) closely matched the average conductance given the filtered stimulus value (light blue points). (<bold>D</bold>) Measured excitatory conductances in the same cell (black) and predictions from the LN model (blue) in response to a test stimulus. (<bold>E</bold>) The inhibitory conductance nonlinearity for the same neuron. The soft-rectifying nonlinearity (dark red) closely approximated the average inhibitory conductance as a function of the filtered stimulus value (light red). (<bold>F</bold>) Measured excitatory conductances (black) and the predictions of the LN model (red) on a test stimulus for the same cell.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig2-v2.tif"/></fig><p>Second, we establish that the output nonlinearity <inline-formula><mml:math id="inf87"><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, which maps membrane potential to instantaneous firing rate (<xref ref-type="disp-formula" rid="equ10">Equation 12</xref>), provides an accurate description of the empirical relationship between membrane potential and spiking (<xref ref-type="fig" rid="fig3">Figure 3</xref>). To validate this model component, we examined dynamic current clamp recordings from two ON parasol RGCs. The dynamic clamp recordings drove RGCs with currents determined by previously measured excitatory and inhibitory conductances. To reduce noise, we computed average membrane potential over repeated presentations of the same measured conductance traces. We then computed nonparametric estimates of the nonlinearity (see Materials and methods). We found that the parametric function we assumed (<xref ref-type="disp-formula" rid="equ10">Equation 12</xref>) closely approximated a non-parametric estimate of the nonlinearity (<xref ref-type="fig" rid="fig3">Figure 3c</xref> black; see Materials and methods for details).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Validating the firing rate nonlinearity.</title><p>(<bold>A</bold>) Schematic of the mapping from membrane potential to spikes under the CBEM. (<bold>B</bold>) The raw (gray) and spike-triggered (black) distribution of intracellular membrane potential obtained from intracellular recordings in two parasol RGCs. (<bold>C</bold>) Nonparametric estimate of the output nonlinearity (black trace), computed by applying Bayes’ rule to the distributions in B, compared to a soft-rectified linear function (red trace).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig3-v2.tif"/></fig><p>Note that although previous analyses of RGC responses using Poisson GLMs have shown that an exponential nonlinearity captures the mapping from stimuli to spike rates more accurately than a rectified-linear nonlinearity (<xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>), we found the opposite here: the nonlinearity was better described with a soft-rectification function. This discrepancy may result from the fact that the GLM has a single nonlinearity, whereas the CBEM has a cascade of two nonlinearities: one mapping filter output to conductance, and a second mapping membrane potential to spike rate.</p></sec><sec id="s2-5"><title>Predicting conductances from spikes with CBEM</title><p>We now turn to a key application of the CBEM: the inferring of excitatory and inhibitory synaptic conductances from extracellular spike train data. To test the model’s ability to make such predictions, we fit the model parameters to a dataset consisting of stimuli and observed spike times. We then used the inferred filters to predict the excitatory and inhibitory conductances elicited in response to novel stimuli recorded in the same cells.</p><p>The training data consisted of spike trains from six macaque ON-parasol RGCs obtained in cell-attached recordings with full-field white noise stimuli. Each cell was stimulated with ten unique 6 s stimulus segments, repeated three or four times each, resulting in a total of thirty to forty 6 s trials per neuron (<xref ref-type="bibr" rid="bib89">Trong and Rieke, 2008</xref>). We fit the CBEM parameters (conductance filters and spike history filter) to a single cell’s responses to 9 of the stimulus segments and evaluated performance using the remaining held-out segment (10-fold cross validation). Thus, the model was fit using spike trains elicited by three or four repeats of a 54 s full-field noise stimulus (see Materials and methods). For comparison, we also fit the conductance filters directly to measured excitatory and inhibitory conductances from intracellular recordings using the same stimuli and the same cross-validation procedure.</p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows the conductance filters estimated from intracellular data (fit to conductances) and extracellular data (fit to spike trains only) for two example cells, along with the predicted excitatory and inhibitory conductances elicited by a novel test stimulus. The filters fit to spikes were similar to those fit to conductances, and the conductance predictions from both models were highly correlated with the measured traces. <xref ref-type="fig" rid="fig5">Figure 5</xref> shows a summary statistics comparing the two models’ performance for all six neurons for which we had both spike train and conductance recordings. For both models, predicted conductances traces were highly correlated with the measured conductances for all six cells. Using only a few minutes of spiking data, the conductances predicted by the extracellular model had an average correlation of r = 0.73 ± 0.01 (mean ± SEM) for the excitatory conductance and r = 0.69 ± 0.03 for the inhibitory conductance, compared to averages of r = 0.89 ± 0.02 (excitation) and r = 0.82 ± 0.01 (inhibition) for the LN model fit directly to conductances (<xref ref-type="fig" rid="fig5">Figure 5a–b</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Predicting conductances from spikes with CBEM.</title><p>Model parameters and conductance predictions for two example ON parasol RGCs. Left: Linear kernels for the excitatory (blue) and inhibitory (red) conductances estimated from spike train data (light red, light blue) alongside filters from an LN model fit directly to measured conductances (dark red, dark blue). The filters represent a combination of events that occur in the retinal circuitry in response to a visual stimulus, and are primarily shaped by the cone transduction process. Right: Measured conductances elicited by a test stimulus (black), along with predictions from the CBEM (fit to spikes) and LN model (fit to conductance data), indicating that the CBEM can predict synaptic conductances nearly as well as a model fit to intracellular conductance measurements. Estimated conductances and conductance filters are scaled for ease of visualization due to the presence of an unidentifiable scale factor relating to membrane capacitance. Inhibition and excitation were scaled equally.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig4-v2.tif"/></fig><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Summary of the CBEM fits to 6 ON parasol RGCs for which we had both spike train and conductance recordings.</title><p>(<bold>A</bold>) The correlation coefficient (<inline-formula><mml:math id="inf88"><mml:mi>r</mml:mi></mml:math></inline-formula>) between the mean observed excitatory synaptic input to a novel 6 s stimulus and the conductance predicted by the LN cascade fit to the excitatory conductance (y-axis) compared to the CBEM prediction from spikes (x-axis) for each cell. Error bars indicate the minimum and maximum values observed across all cross-validated stimuli (<bold>B</bold>) Same as C for the inhibitory conductance. (<bold>C</bold>) The excitatory (blue) and inhibitory (red) filters estimated from voltage-clamp recordings. The thick traces show the mean filters. (<bold>D</bold>) The excitatory (blue) and inhibitory (red) filters estimated by the CBEM from spike trains. (<bold>E</bold>) The cross-correlation of the excitatory and inhibitory conductances for an example cell measured from the data (black trace; region shows standard deviation across the 10 stimuli) compared to the cross-correlation in the CBEM fit to that cell (red trace). Arrows indicate the peaks of the cross-correlations. In the data, excitation and inhibition are anti-correlated and show similar timing. However, excitation precedes inhibition in the model. (<bold>F</bold>) The cross-correlation peak times between excitation and inhibition measured from data (y-axis) compared to the conductances predicted by the CBEM (x-axis) for all 6 cells. Negative values on the x-axis indicate that excitation leads inhibition in the CBEM fits to these cells. (<bold>G</bold>) Comparing the timing of excitatory and inhibitory conductances from the data and the CBEM for the example cell in E. The cross-correlation between the measured excitatory conductance and the CBEM’s excitatory conductance (blue) and the cross-correlation between data and model for the inhibitory conductances (red). (<bold>H</bold>) Cross-correlation peak times between measured and CBEM predicted inhibition (y-axis) and excitation (x-axis).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig5-v2.tif"/></fig><p>Although the extracellular model predicted the basic timecourse of the observed conductances with high fidelity, there were small systematic discrepancies between model-predicted and measured conductances. For example, measured conductances had nearly zero lag in their cross-correlation (0.0 ± 2.4 ms; see also <xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>), whereas the predicted excitatory conductance slightly preceded the inferred inhibition for all six cells (r = 12.6 ± 1.0 ms, Student’s <italic>t</italic>-test p &lt; 0.0001; <xref ref-type="fig" rid="fig5">Figure 5e–f</xref>). The predicted excitation preceded the average measured excitation by 5.6 ± 0.7 ms (p = 0.0005), while the predicted inhibition showed only a slight and statistically insignificant delay compared to the measured inhibition (r = 2.5 ± 1.3 ms, p = 0.11; <xref ref-type="fig" rid="fig5">Figure 5g–h</xref>).</p></sec><sec id="s2-6"><title>Positively correlated excitation and inhibition in ON-midget cells</title><p>We also applied the CBEM to spike trains recorded from 5 ON-midget cells in response to the same type of full-field noise used for the parasol cells. In contrast to the parasol cells, ON-midget cells have positively correlated excitation and inhibition with excitation preceding inhibition (<xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>). This breaks the GLM assumption of equal and opposite tuning of the two conductances. A set of unique 6 s stimuli were used to the the model (33–35 trials for spike recordings and 5–20 trials for the LN conductance model). The models were compared to the average conductances recorded in response to a repeated novel 6 s stimulus (5–10 repeats).</p><p>The CBEM captured the tuning of the synaptic conductances received by the midget cells. An example cell is shown in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. The CBEM predicted the excitatory conductance with an average correlation of r = 0.85 ± 0.03 compared to the intracellular LN model with a correlation of r = 0.95 ± 0.003 (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). The inhibitory conductance showed more nonlinear behavior than can be captured by a single LN unit: the CBEM predicted inhibition with r = 0.33 ± 0.06 and the LN fit to the conductance had a correlation coefficient of only r = 0.54 ± 0.07 (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). The CBEM captured the fact that the inhibitory input had ON tuning, but delayed compared to excitation (<xref ref-type="fig" rid="fig6">Figure 6c–d</xref>). This was also seen in the cross-correlation between excitation and inhibition (<xref ref-type="fig" rid="fig6">Figure 6e</xref>). The data showed a cross-correlation peak with excitation preceding inhibition by 10.1 ± 0.52 ms, and the CBEM showed a similar timing difference of 8.2 ± 0.8 ms (paired Student’s t-test, p = 0.06; <xref ref-type="fig" rid="fig6">Figure 6f</xref>). However, midget cells receive OFF inhibitory input in addition to the larger ON inhibitory input (<xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>), and therefore a single LN unit could not completely capture inhibition in these cells. The true excitation was faster than the predicted excitation by r = 3.8 ± 0.8 ms (Student’s t-test p = 0.008), and the measured inhibition was similarly timed with the model estimate (1.56 ± 0.6 ms, p = 0.06; <xref ref-type="fig" rid="fig6">Figure 6g–h</xref>). In summary, the CBEM can discover positive correlations between excitation and inhibition despite being initialized using a GLM with oppositely tuned excitation and inhibition (see Materials and methods).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Summary of the CBEM fits to 5 ON midget RGCs.</title><p>The plot follows the same conventions as the parasol results in <xref ref-type="fig" rid="fig5">Figure 5</xref>. (<bold>A,B</bold>) The correlation coefficient (<inline-formula><mml:math id="inf89"><mml:mi>r</mml:mi></mml:math></inline-formula>) between the mean observed excitatory and inhibitory synaptic input to a novel 6 s stimulus and the conductance predicted by the LN cascade fit to the excitatory conductance (y-axis) compared to the CBEM prediction from spikes (x-axis) for each cell. Conductance predictions for a single example cell are shown in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. The excitatory (blue) and inhibitory (red) filters estimated from voltage-clamp recordings (<bold>C</bold>) and by the CBEM from spike trains (<bold>D</bold>). (<bold>E</bold>) The cross-correlation of the excitatory and inhibitory conductances for an example cell measured from the test stimulus (data) compared to the cross-correlation predicted by the CBEM fit to that cell (red trace). (<bold>F</bold>) The cross-correlation peak times between excitation and inhibition measured from data compared to the conductances predicted by the CBEM for all five cells. (<bold>G</bold>) Comparing the timing of excitatory and inhibitory conductances from the data and the CBEM for the example cell in E. The cross-correlation between the measured excitatory conductance and the CBEM’s excitatory conductance (blue) and the cross-correlation between data and model for the inhibitory conductances (red). (<bold>H</bold>) Cross-correlation peak times between measured and CBEM predicted inhibition and excitation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>CBEM fit for an example ON-midget cell with a comparison the LN models fit directly to the conductances.</title><p>Left: Linear kernels for the excitatory (blue) and inhibitory (red) inputs estimated from the conductance-based model (light red, light blue) and estimated by fitting a linear-nonlinear model directly to the measured conductances (dark red, dark blue). The filters represent a combination of events that occur in the retinal circuitry in response to a visual stimulus, and are primarily shaped by the cone transduction process. Right: Conductances predicted by our model on a withheld test stimulus. Measured conductances (black) are compared to the predictions from the CBEM filters (fit to spiking data) and an LN model (fit to conductance data). For visualization, we scaled the estimated conductances from the CBEM as in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig6-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2-7"><title>Characterizing spike responses with CBEM</title><p>Given the CBEM’s ability to infer intracellular conductances from spike train data, we sought to examine how well it predicts spike responses to novel stimuli. Most encoding models are only tested with data from extracellular recordings, which are far easier to obtain and to sustain over longer periods. It therefore seems natural to ask: does the CBEM’s increased degree of biophysical realism confer advantages for predicting spikes?</p><p>To answer this question, we fit the CBEM and classic Poisson GLM to a population of 9 extracellularly recorded macaque RGCs stimulated with full-field binary white noise (<xref ref-type="bibr" rid="bib93">Uzzell and Chichilnisky, 2004</xref>; <xref ref-type="bibr" rid="bib70">Pillow et al., 2005</xref>). We evaluated spike rate prediction by comparing the peri-stimulus time histogram (PSTH) of the simulated models to the PSTH of real neurons using a 5 s test stimulus (<xref ref-type="fig" rid="fig7">Figure 7</xref>). The CBEM had higher prediction accuracy than the GLM for all nine cells, 86% of the variance of the PSTH on average vs. 77% for the GLM. We then evaluated spike train prediction by comparing log-likelihood on a 5 min test dataset. The CBEM again outperformed the GLM on all cells, offering an improvement of 0.34 ± 0.11 bits/spike on average over the GLM.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>CBEM spike train predictions.</title><p>(<bold>A</bold>) Spike rate prediction performance for the population of nine cells for 5 s test stimulus. The true rate (black) was estimated using 167 repeat trials. The red circle indicates the cell shown in C. (<bold>B</bold>) Log-likelihood of the CBEM compared to the GLM computed on a 5 min test stimulus. (<bold>C</bold>) (top) Raster of responses of an example OFF parasol RGC to repeats of a novel stimulus (black) and simulated responses from the GLM (blue) and the CBEM (red). (middle) Spike rate (PSTH) of the RGC and the GLM (blue) and CBEM (red). The PSTHs were smoothed with a Gaussian kernel with a 2 ms standard deviation. (bottom) The CBEM predicted excitatory (blue) and inhibitory (orange) conductances. The conductances are given in arbitrary units because the model does not include membrane capacitance. <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref> CBEM conductance predictions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Relation of inferred conductances to GLM prediction error.</title><p>(<bold>A</bold>) The difference in the GLM predicted rate (<inline-formula><mml:math id="inf90"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and the measure spike rate (<inline-formula><mml:math id="inf91"><mml:msub><mml:mi>λ</mml:mi><mml:mtext>true</mml:mtext></mml:msub></mml:math></inline-formula>) from the PSTH in <xref ref-type="fig" rid="fig7">Figure 7c</xref> compared to the excitatory conductances predicted by the CBEM. We only considered the time points for which the predicted rate and the measured rate differed by at least one spike/s (gray region denotes the eliminated interval). (<bold>B</bold>) Same as A for the inhibitory conductance.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig7-figsupp1-v2.tif"/></fig></fig-group><p>To gain insight into the CBEM’s superior performance, we examined the average firing rate predictions of the GLM along with the average conductance predictions of the CBEM (<xref ref-type="fig" rid="fig7">Figure 7c</xref>). We found that GLM rate prediction errors (relative to the PSTH of the real neuron) were anti-correlated with the magnitude of the CBEM inhibitory conductance; the CBEM inhibitory conductance at times when the GLM spike rate exceeded the true spike rate was significantly higher than the CBEM inhibitory conductance at times when the GLM spike rate underestimated the true spike rate (t-test, p &lt; 0.0001; <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1b</xref>). This suggests that the CBEM inhibitory conductance helped CBEM predictions by reducing the firing at times when the GLM over-predicted the firing rate. In contrast, the distribution of excitatory conductances did not depend on the sign of the rate prediction error (<italic>t</italic>-test, p = 0.19; <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1a</xref>), and the predicted excitatory conductance was positively correlated with the magnitude of the error (r = 0.33, p &lt; 0.0001).</p><p>Previous experiments have indicated that inhibition only weakly modulates parasol cell responses to full-field Gaussian noise stimuli (<xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>). To test the effect of inhibition in the model, we also refit the CBEM without any inhibitory synaptic input (CBEM<sub>exc</sub>). We compared the excitatory filters estimated by the CBEM<sub>exc</sub> with the GLM filters and found that the filters are nearly identical (<xref ref-type="fig" rid="fig8">Figure 8e</xref>). This indicates that the GLM stimulus filter accounts only for the excitatory input received by the cell. The CBEM<sub>exc</sub> still provided a superior prediction of the PSTH than the GLM (81% of the variance explained) and an increased cross-validated log-likelihood (mean improvement of 0.14 ± 0.10 bits/sp over the GLM; <xref ref-type="fig" rid="fig8">Figure 8</xref>). The CBEM<sub>exc</sub> can exhibit changes in total conductance through a second, spike history independent nonlinearity (so it is not technically a GLM, as discussed in Section 3), and it predicts RGC responses better than the GLM, but not as well as the full CBEM. Thus, the full CBEM achieves superior model performance over the GLM both by including an inhibitory input, and by treating the excitatory input as a conductance-based input in a simple biophysical model.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Comparison of CBEM and GLM fits.</title><p>(<bold>A</bold>) Spike rate prediction performance and (<bold>B</bold>) cross-validated log-likelihood for the population of nine cells for 7 s test stimulus for the GLM and the CBEM with only an excitatory input term (CBEM<sub>exc</sub>). (<bold>C</bold>) The full CBEM with inhibition shows improved spike rate predication and (<bold>D</bold>) cross-validated log-likelihood compared to the model without inhibition. (<bold>E</bold>) The GLM filters for nine parasol RGCs (black) compared to the excitatory conductance filters estimated by the CBEM without an inhibitory input (blue). The GLM filters are shown scaled to match the height of the CBEM<sub>exc</sub> filters.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig8-v2.tif"/></fig></sec><sec id="s2-8"><title>Capturing spike responses across contrasts</title><p>Retinal ganglion cells adapt to stimulus statistics such as contrast or variance; increases in stimulus contrast lead to decreases in gain of the neural response, allowing the dynamic range of the response to adapt to the range of contrast values present in the stimulus (<xref ref-type="bibr" rid="bib14">Chander and Chichilnisky, 2001</xref>; <xref ref-type="bibr" rid="bib25">Fairhall et al., 2001</xref>; <xref ref-type="bibr" rid="bib2">Baccus and Meister, 2002</xref>; <xref ref-type="bibr" rid="bib5">Beaudoin et al., 2008</xref>; <xref ref-type="bibr" rid="bib48">Mante et al., 2005</xref>; <xref ref-type="bibr" rid="bib28">Garvert and Gollisch, 2013</xref>; <xref ref-type="bibr" rid="bib49">Marava, 2013</xref>; <xref ref-type="bibr" rid="bib22">Demb and Singer, 2015</xref>). Understanding this phenomenon is critical for understanding how the retina codes natural stimuli, because natural scenes vary widely over contrast in both space and time. However, classic linear-nonlinear models with a single linear component fail to capture such effects. This motivates the need for a biophysically plausible modeling framework that can explain RGC responses across stimulus conditions (<xref ref-type="bibr" rid="bib60">Ozuysal and Baccus, 2012</xref>; <xref ref-type="bibr" rid="bib17">Clark et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Cui et al., 2016b</xref>).</p><p>Previous work has shown that changes in the balance of excitatory and inhibitory input can give rise to multiplicative gain changes in neural responses (<xref ref-type="bibr" rid="bib13">Chance et al., 2002</xref>; <xref ref-type="bibr" rid="bib57">Murphy and Miller, 2003</xref>). This raises the possibility that the CBEM may be able account for contrast-dependent changes in RGC responses with a single set of parameters. To test this hypothesis, we fit both the CBEM and GLM to eight RGCs stimulated with full-field binary stimuli of 24%, 48%, and 96% contrast. We compared models fit simultaneously to all contrasts with models fit separately to data from each contrast. Although the CBEM does not account for many aspects of adaptation, this modeling framework allows us to test how well the LN conductance tuning alone can account for gain changes across contrasts (<xref ref-type="bibr" rid="bib59">Ozuysal et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Latimer et al., 2019</xref>).</p><p>To quantify the CBEM’s ability to capture contrast-dependent gain changes in RGC responses, we compared GLM filters fit to RGC responses at each contrast with GLM filters fit to data simulated from the all-contrasts CBEM. (<xref ref-type="fig" rid="fig9">Figure 9a</xref>) shows GLM filters obtained at each contrast for an example RGC, while <xref ref-type="fig" rid="fig9">Figure 9b</xref> shows comparable filters fit to spikes simulated from the CBEM fit to this neuron. Both sets of filters exhibit large reductions in amplitude with increasing contrast, the key signature of contrast gain adaptation. Across all eight RGCs, we found high correlation in the filter amplitude scaling for real RGC and simulated CBEM responses (r = 0.61, p &lt; 0.05; <xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>).</p><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Contrast gain control in the CBEM.</title><p>(<bold>A</bold>) GLM filters for an example ON cell fit to responses recorded at 24%, 48%, and 96% contrast. (<bold>B</bold>) GLM filters fit to spike trains simulated from the CBEM fit to the cell shown in A. The CBEM was fit to responses at all three contrast levels. Filter height comparisons for CBEM fits to all cells are shown in <xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>. Spike train prediction performance of the (<bold>C</bold>) GLM and (<bold>D</bold>) the CBEM tested on a 4 min stimulus at 24% (left column), 48% (middle column), and 96% (right column) contrast. The model trained on all three contrast levels (y-axis) is plotted against the same class of model trained only at the probe contrast level (x-axis). <xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2</xref> shows the cross-correlation between the CBEM predicted excitation and inhibition over a range of contrasts.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig9-v2.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>The filter heights (the absolute value of the peak of the filter) of the GLM fits to eight cells at all three contrast levels (one point per contrast level per cell; lines connect all contrast points from a cell), compared to the GLM filters fit the CBEM simulations of those same cells.</title></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig9-figsupp1-v2.tif"/></fig><fig id="fig9s2" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 2.</label><caption><title>Correlation between the CBEM's excitation and inhibition depends on contrast.</title><p>(<bold>A</bold>) The average CBEM cross-correlation between excitation and inhibition for the 5 OFF cells fit to multi-contrast stimuli. The cross-correlations were computed from 12% (lightest trace) to 100% (darkest trace) contrast. (<bold>B</bold>) Same as A for the 3 ON cells. (<bold>C</bold>) The peak correlation between excitation and inhibition (maximum magnitude of the cross-correlation within 30 ms of 0 lag) as a function of contrast for all eight cells . The thick lines show the peak of the average cross-correlation for ON cells (blue) and OFF cells (red). The thin lines show the correlation for individual cells. (<bold>D</bold>) The mean total synaptic conductance in the CBEM fit (<inline-formula><mml:math id="inf92"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> averaged across time) as a function of contrast. Follows the same conventions as C. (<bold>E</bold>) The standard deviation of the total synaptic conductance as a function of contrast. (<bold>F</bold>) The skewness of the total synaptic conductance as a function of contrast. Unlike the mean and variance, the skewness in the CBEM fits begins to saturate with increased contrast.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig9-figsupp2-v2.tif"/></fig></fig-group><p>We found that the CBEM maintained predictive performance across contrast levels more accurately than the GLM (<xref ref-type="fig" rid="fig9">Figure 9c–d</xref>). At 24% contrast, the GLM fit to all contrasts lost an average 0.36 ± 0.41 bits/sp (normalized test log-likelihood) compared to GLM fit specifically to the 24% contrast stimulus, while the CBEM lost only 0.16 ± 0.2 bits/sp. At 48% contrast, the GLM lost 0.20 bits/sp while CBEM only lost 0.07 ± 0.14 bits/sp. Finally, both models only lost 0.05 ± 0.08 bits/sp in the 96% contrast probe. The GLM’s partial ability to generalize across these particular conditions despite having only one stimulus filter can be viewed as a consequence of our biophysical interpretation of the GLM; the GLM is equivalent to a biophysical model in which synaptic excitation and inhibition are governed by equal filters of opposite sign; <xref ref-type="fig" rid="fig4">Figure 4</xref> left shows that this assumption is approximately correct for ON parasol RGCs. However, the flexibility conferred by the slight differences in these filters with separate nonlinearities gave the CBEM greater accuracy in predicting RGC responses across a range of contrasts. We find that the correlation between excitation and inhibition in the CBEM is not constant: the CBEM predicts that the magnitude of the correlation depends on contrast <xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2a-b</xref>. The CBEM predicted that, on average, excitation and inhibition were most anticorrelated at 22% contrast for the ON cells and 34% contrast for the OFF cells <xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2c</xref>. Additionally, the CBEM predicts that the mean and variance of the total synaptic conductance increases with contrast <xref ref-type="fig" rid="fig9s2">Figure 9—figure supplement 2d-f</xref>.</p></sec><sec id="s2-9"><title>Capturing spike responses to spatially varying stimuli</title><p>To analyze the CBEM’s ability to capture responses to spatially varying stimuli, we examined a dataset of 27 parasol RGCs stimulated with spatio-temporal binary white noise stimuli (<xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>). We fit spatio-temporal filters consisting of a 5 × 5 pixel field over the same temporal extent as the models fit to full-field stimuli. The temporal profiles of excitatory and inhibitory CBEM filters were qualitatively similar to those that we observed in the full-field stimulus condition (<xref ref-type="fig" rid="fig10">Figure 10a,c</xref>). The filters were not constrained to be spatio-temporally separable (the filters were constrained to be rank 2; <xref ref-type="fig" rid="fig10">Figure 10b</xref>), which allowed the synaptic inputs to have different temporal interactions compared to the full-field stimulus.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>CBEM fits to a population of 27 RGCs.</title><p>(<bold>A</bold>) Temporal profile of the excitatory (blue) and inhibitory (red) at the center pixel of the receptive field for 16 OFF parasol cells. The thick lines show the mean. (<bold>B</bold>) The mean spatial profiles of the excitatory (top) and inhibitory (bottom) linear filters at four different time points for the OFF parasol cells. (<bold>C,D</bold>) same as A,B for 11 ON parasol cells. (<bold>E</bold>) Spike rate prediction performance of the CBEM compared to the GLM for the population of 27 cells for 8 s test stimulus. The true rate (black) was estimated using 600 repeat trials. (<bold>F</bold>) Log-likelihood of the CBEM compared to the GLM computed on a 5-min test stimulus. (<bold>G</bold>) Spike rate prediction performance of the CBEM<sub>exc</sub> compared to the GLM. (<bold>H</bold>) Log-likelihood of the CBEM<sub>exc</sub> compared to the GLM.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig10-v2.tif"/></fig><p>We found that the CBEM predicted PSTHs more accurately than a Poisson GLM (83% vs. 79% average R<sup><sub>2</sub></sup>; <xref ref-type="fig" rid="fig10">Figure 10e</xref>). The CBEM also predicted the single-trial responses with higher accuracy than the standard Poisson GLM (average improvement of 0.07 ± 0.04 bits/sp; <xref ref-type="fig" rid="fig10">Figure 10f</xref>). Even the CBEM with excitatory input only yielded more accurate PSTH prediction (81% R<sup><sub>2</sub></sup>) than the GLM, but the single-trial spike train prediction fell to an average of 0.02 ± 0.04 bits/sp higher than the GLM (<xref ref-type="fig" rid="fig10">Figure 10g–h</xref>). Thus, the GLM predicted RGC responses to full-field noise with similar accuracy to the more complex CBEM, suggesting that the predictive performance given the training data was nearing a ceiling. Therefore, we turned to simulations to explore what type of stimuli differentiate the two models.</p><p>To gain insight into how the model’s excitatory and inhibitory inputs shape the CBEM’s responses to spatio-temporal stimuli, we simulated the model with uncorrelated spatio-temporal noise and with spatially correlated stimuli. The uncorrelated spatio-temporal noise was the same independent binary pixel noise used in the RGC recordings, and we used a full-field and a binary center-surround stimuli for the spatially correlated noise (<xref ref-type="fig" rid="fig11">Figure 11a</xref>). Each frame of the spatially correlated center-surround stimulus was constructed by setting the center pixel to the opposite sign of the pixels in the surround, and the center pixel had equal probability of being black or white. We examined the cross-correlation of the CBEM’s excitatory and inhibitory conductances in each stimulus regime and found that they were similar for the full-field and uncorrelated spatio-temporal noise stimuli (<xref ref-type="fig" rid="fig11">Figure 11b</xref> gray and black traces). In response to these two stimuli, the excitatory and inhibitory conductances showed a strong negative correlation with excitation preceding inhibition (as we saw in <xref ref-type="fig" rid="fig5">Figure 5e</xref>). The center-surround stimulus, however, produced a distinct cross-correlation pattern with a larger positive peak at the positive lags (red traces).</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Predicted responses to spatially structured stimuli.</title><p>(<bold>A</bold>) Example sequences of 5 × 5 pixel frames of three different types of spatiotemporal noise stimuli used to probe the CBEM. The spatio-temporal stimulus was the same binary noise stimulus used to fit the cells. The full-field stimulus consisted of binary noise at the same contrast and frame rate as the original spatio-temporal stimulus. In the opposing center-surround condition, the center pixel was of opposite contrasts to the surround pixels and the sign of the center pixel was selected randomly on each frame. (<bold>B</bold>) The mean cross-correlation of the CBEM predicted excitatory and inhibitory conductances for the OFF cells (top) and ON cells (bottom) in response to full-field noise (black), spatio-temporal noise (grey), and opposing center-surround noise (red). The strong negative component showed that <inline-formula><mml:math id="inf93"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is delayed and oppositely tuned compared to <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>C</bold>) Average firing rate of the GLM (blue), CBEM (red), and CBEM<sub>exc</sub> (green) fits to 16 OFF cells (top) and 11 ON cells (middle) in response to opposing center-surround contrasts steps (bottom).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-47012-fig11-v2.tif"/></fig><p>Finally, we simulated GLM and CBEM responses to center-surround contrast steps. The stimulus sequence started as a gray field stepping to a black center pixel with white surround for 500 ms, stepping to a gray field for 500 ms, then stepping to a white center and black surround, finally returning to a gray field (<xref ref-type="fig" rid="fig11">Figure 11c</xref> bottom). The CBEM and GLM showed similar onset responses, but the sustained responses of the CBEM simulations showed inhibition-dependent suppression for both ON and OFF cells (<xref ref-type="fig" rid="fig11">Figure 11c</xref> top and middle). The shape and sustained response of the CBEM<sub>exc</sub> fit to the OFF cells to center-surround steps qualitatively differed to the full CBEM: the CBEM<sub>exc</sub> response decayed and then rebounded slightly instead of showing only a decaying response. Thus, full-field and independent spatio-temporal noise resulted in excitatory and inhibitory correlations that fit closely with the assumptions contained in the GLM. Spatial correlations, and in particular negative correlations, in the stimulus break these assumptions by co-activating excitatory and inhibitory inputs (<xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>) and therefore spatially correlated stimuli differentiate the CBEM’s predictions from the GLM. These results indicate that, although the GLM captures much of the RGC responses to full-field noise, capturing the inhibitory and excitatory synaptic inputs will aid in understanding processing of naturalistic stimuli which contain spatial structure.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The point process GLM has found widespread use for modeling the statistical relationship between stimuli and spike trains. Here, we have offered a new biophysical interpretation of this model, showing that it can written as a conductance-based model with oppositely tuned linear excitatory and inhibitory conductances. This motivated us to introduce a more flexible and more biophysically plausible model with independent excitatory and inhibitory conductances, each given by a rectified-linear function of the sensory stimulus. This conductance-based encoding model (CBEM) is no longer technically a generalized linear model because the membrane potential is a nonlinear function of the stimulus; however, the CBEM has a well behaved point-process likelihood, making it tractable for fitting to extracellular data.</p><p>In contrast to purely statistical approaches to designing encoding models, we used intracellular measurements to motivate the choice of the nonlinear functions in the CBEM. We demonstrated that the CBEM accurately recovers the tuning of the excitatory and inhibitory synaptic inputs to RGCs purely from measured spike times. As an added bonus, it achieves improved prediction performance compared to the GLM, The interaction between excitatory and inhibitory conductances allows the CBEM to change its gain and integration time constant as a function of stimulus statistics (e.g. contrast), an effect that cannot be captured by a standard GLM. Thus, the CBEM can help reveal circuit-level computations that support perception under naturalistic conditions.</p><p>The CBEM belongs to an extended family of neural encoding models that are not technically GLMs because they do not depend on a single linear projection of the stimulus. These include multi-filter LNP models with quadratic terms (<xref ref-type="bibr" rid="bib81">Schwartz et al., 2002</xref>; <xref ref-type="bibr" rid="bib78">Rust et al., 2005</xref>; <xref ref-type="bibr" rid="bib69">Park and Pillow, 2011</xref>; <xref ref-type="bibr" rid="bib26">Fitzgerald et al., 2011</xref>; <xref ref-type="bibr" rid="bib67">Park et al., 2013</xref>; <xref ref-type="bibr" rid="bib74">Rajan et al., 2013</xref>) or general nonparametric nonlinearities (<xref ref-type="bibr" rid="bib85">Sharpee et al., 2004</xref>; <xref ref-type="bibr" rid="bib100">Williamson et al., 2015</xref>); models with input nonlinearities (<xref ref-type="bibr" rid="bib1">Ahrens et al., 2008</xref>) and multilinear context effects (<xref ref-type="bibr" rid="bib101">Williamson et al., 2016</xref>); models inspired by deep learning methods (<xref ref-type="bibr" rid="bib51">McIntosh et al., 2016</xref>; <xref ref-type="bibr" rid="bib46">Maheswaranathan et al., 2018</xref>); and models with biophysically inspired forms of nonlinear response modulation (<xref ref-type="bibr" rid="bib9">Butts et al., 2011</xref>; <xref ref-type="bibr" rid="bib60">Ozuysal and Baccus, 2012</xref>; <xref ref-type="bibr" rid="bib50">McFarland et al., 2013</xref>; <xref ref-type="bibr" rid="bib19">Cui et al., 2016b</xref>; <xref ref-type="bibr" rid="bib75">Real et al., 2017</xref>). The CBEM has most in common with this last group of models. Although more flexible LNLN models may predict spike trains with higher accuracy, the CBEM stands as the only model so far to have directly linked model components fit to spikes alone to experimentally measured conductances.</p><p>Although the CBEM represents a step toward biophysical realism, it still lacks many properties of real neurons. For instance, the CBEM’s linear-rectified conductance does not capture the non-monotonic portions of the stimulus-conductance nonlinearities observed in the data (<xref ref-type="fig" rid="fig2">Figure 2c,e</xref>); this non-monotonicity likely arises from the fact that amacrine cells can receive inputs from both ON and OFF channels (<xref ref-type="bibr" rid="bib47">Manookin et al., 2008</xref>; <xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>). Further developments to the CBEM can include additional sets of nonlinear inputs (<xref ref-type="bibr" rid="bib50">McFarland et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Maheswaranathan et al., 2018</xref>; <xref ref-type="bibr" rid="bib75">Real et al., 2017</xref>). Such extensions could include multiple spatially distinct inputs to account for input from different bipolar cells (<xref ref-type="bibr" rid="bib82">Schwartz et al., 2012</xref>; <xref ref-type="bibr" rid="bib27">Freeman et al., 2015</xref>; <xref ref-type="bibr" rid="bib96">Vintch et al., 2015</xref>; <xref ref-type="bibr" rid="bib92">Turner and Rieke, 2016</xref>; <xref ref-type="bibr" rid="bib44">Liu et al., 2017</xref>), and spatially selective rectification of inhibitory inputs that helps determine RGC responses to spatial stimuli (<xref ref-type="bibr" rid="bib7">Brown and Masland, 2001</xref>; <xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>; <xref ref-type="bibr" rid="bib84">Schwartz and Rieke, 2013</xref>). The model could also be extended to study pre-synaptic inhibition of the excitatory conductance, which can shape the spatial tuning of excitation (<xref ref-type="bibr" rid="bib91">Turner et al., 2018</xref>) and contrast adaptation (<xref ref-type="bibr" rid="bib19">Cui et al., 2016b</xref>). Adaptation can occur in localized regions of a ganglion cell’s RF (<xref ref-type="bibr" rid="bib28">Garvert and Gollisch, 2013</xref>), suggesting that the linear-nonlinear synaptic input functions in the CBEM should be allowed to vary over time. Additionally, future work could apply the CBEM to study the role of active conductances that depend spike history, such as an after hyper-polarization current (<xref ref-type="bibr" rid="bib37">Johnston et al., 1995</xref>; <xref ref-type="bibr" rid="bib3">Badel et al., 2008</xref>; <xref ref-type="bibr" rid="bib45">Lundstrom et al., 2008</xref>), and recent work has shown that the parameters of Hodgkin-Huxley style biophysical models can in some instances be recovered from spike trains alone (<xref ref-type="bibr" rid="bib53">Meng et al., 2011</xref>). Spike-dependent conductances could also be examined in multi-neuron recordings; although the analyses presented here focused on the coding properties of single neurons, many of the RGCs analyzed were recorded simultaneously (<xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>; <xref ref-type="bibr" rid="bib97">Volgushev et al., 2015</xref>).</p><p>Another aspect of the CBEM that departs from biophysical realism is that all stochasticity is confined to the spike generation mechanism. The CBEM models conductances and membrane potential as deterministic functions of the stimulus, which makes the likelihood tractable and allows for efficient fitting with standard conjugate-gradient methods (<xref ref-type="bibr" rid="bib75">Real et al., 2017</xref>). However, the reliability of RGC spike trains depends on the stochasticity of synaptic conductances (<xref ref-type="bibr" rid="bib58">Murphy and Rieke, 2006</xref>), and noise correlations between excitatory and inhibitory conductances may also affect encoding in RGCs (<xref ref-type="bibr" rid="bib10">Cafaro and Rieke, 2010</xref>). A latent variable approach could be used to to incorporate stochasticity in conductances and membrane potential (<xref ref-type="bibr" rid="bib53">Meng et al., 2011</xref>; <xref ref-type="bibr" rid="bib65">Paninski et al., 2012</xref>; <xref ref-type="bibr" rid="bib40">Lankarany et al., 2016</xref>).</p><p>We expect that the CBEM may also be useful for regions beyond the retina. Previous work on the prediction of membrane potential in primary visual cortex suggests that the CBEM could apply to neurons further along in the visual stream (<xref ref-type="bibr" rid="bib56">Mohanty et al., 2012</xref>; <xref ref-type="bibr" rid="bib87">Tan et al., 2011</xref>). The model could also be applied to non-visual areas such as primary auditory cortex, where different tuning motifs of excitation and inhibition are of interest (<xref ref-type="bibr" rid="bib80">Scholl et al., 2010</xref>). Future work might extend the CBEM to use deeper, nonlinear cascade models to predict conductances, as opposed to the simple LN cascade we have assumed here. For example, one might use the LNLN models of the lateral geniculate nucleus (e.g. <xref ref-type="bibr" rid="bib9">Butts et al., 2011</xref>; <xref ref-type="bibr" rid="bib50">McFarland et al., 2013</xref>) as providing the drive to synaptic conductances in V1 neurons. This principle can extend to higher sensory regions, such as the middle temporal cortex where cascade models can approximate the inputs received from V1 (<xref ref-type="bibr" rid="bib79">Rust et al., 2006</xref>). Applications in cortex may also incorporate additional inputs to the model such as local field potential, which is thought to reflect the total synaptic drive to a region (<xref ref-type="bibr" rid="bib24">Einevoll et al., 2013</xref>; <xref ref-type="bibr" rid="bib32">Haider et al., 2016</xref>; <xref ref-type="bibr" rid="bib18">Cui et al., 2016a</xref>).</p><p>Applications of the CBEM to new brain areas could involve testing the accuracy of conductance predictions with a small number of intracellular recordings, and then applying the model to larger set of extracellular recordings with a wider range of stimuli. Although the model’s simplifying assumptions limit the ability to make strong conclusions about the conductances estimated from spikes alone, the model may nevertheless guide experimental design and theories of sensory processing when intracellular recordings are unavailable.</p><p>Future work will require modeling the neural code using naturalistic stimuli, where the GLM has been shown to fail (<xref ref-type="bibr" rid="bib12">Carandini et al., 2005</xref>; <xref ref-type="bibr" rid="bib94">van Hateren et al., 2002</xref>; <xref ref-type="bibr" rid="bib8">Butts et al., 2007</xref>; <xref ref-type="bibr" rid="bib35">Heitman et al., 2016</xref>; <xref ref-type="bibr" rid="bib92">Turner and Rieke, 2016</xref>). Modeling tools must also provide a link between the neural code and computations performed by the neural circuit. As we move toward stimuli with complex spatio-temporal statistics, the ability to connect distinct synaptic conductances to spiking will provide an essential tool for deciphering the complex, nonlinear neural code in sensory systems.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Electrophysiology</title><p>We analyzed four sets of parasol RGCs. All data were obtained from isolated, peripheral macaque monkey, <italic>Macaca mulatta</italic>, retina.</p></sec><sec id="s4-2"><title>Synaptic current recordings</title><p>We analyzed the responses of 6 ON parasol cells previously described in <xref ref-type="bibr" rid="bib89">Trong and Rieke (2008)</xref>. Cell-attached and voltage clamp recordings were performed to measure spike trains and excitatory and inhibitory currents in the same cells. The stimulus, delivered with an LED, consisted of a one dimensional, full-field white noise signal, filtered with a low pass filter with a 60 Hz cutoff frequency, and sampled at a 0.1ms resolution. Spike trains were recorded using 10 unique 6 s stimuli, and each stimulus was repeated three or four times. After the spike trains were recorded, the excitatory and inhibitory synaptic currents to the same stimuli were measured using voltage clamp recordings. Active conductances intrinsic to the RGC were blocked during these recordings and the holding potential was set to isolate either the excitatory or inhibitory inputs received by the cell. For four of the cells, two to four trials were recorded for each of the 10 stimuli for the excitatory and inhibitory currents. For the two remaining cells, three to four excitatory current trials were recorded for all 10 stimuli and one to two trials for the inhibitory current were obtained for 8 of the stimuli. Conductances were estimated by dividing the current by the approximate driving force (−70 mV for the excitatory currents, and 70 mV for the inhibitory).</p><p>The 5 ON-midget cells were recorded as described previously (<xref ref-type="bibr" rid="bib23">Dunn et al., 2006</xref>; <xref ref-type="bibr" rid="bib89">Trong and Rieke, 2008</xref>; <xref ref-type="bibr" rid="bib11">Cafaro and Rieke, 2013</xref>). Retinas were obtained through the Tissue Distribution Program of the Regional Primate Research Center at the University of Washington and procedures were approved by the Institutional Animal Care and Use Committee. The same type of full-field noise stimuli were used for the midget cells as with the parasol cells, and the recordings were again divided into 6 s trials. Spike trains were obtained with cell attached recordings. For each cell, 33–35 trials of unique stimuli were recorded, and 10 (for 4 cells) or 20 (for 1 cell) trials were recorded in response to a repeated stimulus. Excitatory and inhibitory currents were recorded for 5–20 trials each for non-repeated stimuli, and 5–10 trials were recorded in response to the repeated validation stimulus. Conductances were again estimated by dividing the current by the approximate driving force (−70 mV for the excitatory currents, and 70 mV for the inhibitory).</p></sec><sec id="s4-3"><title>Dynamic clamp recordings</title><p>The membrane potentials of 2 ON parasol retinal ganglion cells were recorded during dynamic clamp experiments previously reported in <xref ref-type="bibr" rid="bib11">Cafaro and Rieke (2013)</xref>. The cells were current clamped and current was injected into the cells according to the equation<disp-formula id="equ11"><label>(13)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf95"><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf96"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> were conductances recorded in RGCs in response to a light stimulus. The injected current at time <inline-formula><mml:math id="inf97"><mml:mi>t</mml:mi></mml:math></inline-formula> was computed using the previous measured voltage with offset Δt = 100 μs. The reversal potentials were <inline-formula><mml:math id="inf98"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> mV and <inline-formula><mml:math id="inf99"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>90</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> mV.</p><p>For the first cell, 18 repeat trials were recorded for a 19 s stimulation, and 24 repeat trials were obtained from the second cell.</p></sec><sec id="s4-4"><title>RGC population recordings: full-field stimulus</title><p>We analyzed data from two experiments previously reported in <xref ref-type="bibr" rid="bib93">Uzzell and Chichilnisky (2004)</xref> and <xref ref-type="bibr" rid="bib70">Pillow et al. (2005)</xref>. The first experiment included nine simultaneously recorded parasol RGCs (5 ON and 4 OFF). The stimulus consisted of a full-field binary noise stimulus (independent black and white frames) with a root-mean-square contrast of 96%. The stimulus was displayed on a CRT monitor at a 120 Hz refresh rate and the contrast of each frame was drawn independently. A 10 min stimulus was obtained for characterizing the cell responses, and a 5-min segment was used to obtain a cross-validated log-likelihood. Spike rates were obtained by recording 167 repeats of a 7.5 s stimulus.</p><p>In a second experiment, eight cells (3 ON and 5 OFF parasol) were recorded in response to a full-field binary noise stimulus (120 Hz) at 24%, 48%, and 96% contrast. An 8 min stimulus segment at each contrast level was used for model fitting, and cross-validated log-likelihoods were obtained using a novel 4 min segment at each contrast level.</p></sec><sec id="s4-5"><title>RGC population recordings: spatio-temporal stimulus</title><p>We analyzed 11 ON and 16 OFF parasol RGCs which were previously reported in <xref ref-type="bibr" rid="bib70">Pillow et al. (2005)</xref>. The stimulus consisted of a spatio-temporal binary white noise pattern (i.e. a field of independent white and black pixels). The stimulus was 10 pixels by 10 pixels (pixel size of 120 μm × 120 μm on the retina), and the contrasts of each pixel was drawn independently on each frame (120 Hz refresh rate). The root-mean-square contrast of the stimulus was 96%.</p><p>A 10-min stimulus was obtained for characterizing the cell responses, and a 5-min segment was used to obtain a cross-validated log-likelihood. Spike rates were obtained by recording 600 repeats of a 10 s stimulus.</p></sec><sec id="s4-6"><title>Modeling methods</title><sec id="s4-6-1"><title>The conductance-based encoding model</title><p>The CBEM introduced above models the spike train response of a RGC to a visual stimulus as a Poisson process where the spike rate is a function of the membrane potential (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). The membrane potential is approximated by considering a single-compartment neuron with linear membrane dynamics and conductance-based input (<xref ref-type="disp-formula" rid="equ3">Equation 6</xref>). Note that we have ignored capacitance, which would provide an (unobserved) scaling factor on <inline-formula><mml:math id="inf100"><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, but will not affect our results. The synaptic inputs (<xref ref-type="disp-formula" rid="equ8">Equation 10</xref>) take the form of linear-nonlinear functions of the stimulus, <inline-formula><mml:math id="inf101"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> is a nonlinear function ensuring positivity of the conductances. We will assume a ‘soft-rectification’ nonlinearity given by<disp-formula id="equ12"><label>(14)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which behaves like a smooth version of a linear half-rectification function.</p><p>Given the conductances, we could then obtained the membrane voltage. We use a first-order exponential integrator method to solve this equation, which is exact under the assumption that <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><disp-formula id="equ13"><label>(15)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ14"><label>(16)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ15"><label>(17)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>for <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and assuming <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> at the start of each experiment.</p><p>For a set of spike times <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> in the interval <inline-formula><mml:math id="inf109"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and parameters <inline-formula><mml:math id="inf110"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math></inline-formula>, the log-likelihood in continuous time is<disp-formula id="equ16"><label>(18)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where the spike rate, <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is a function of the voltage plus spike history (<xref ref-type="disp-formula" rid="equ10">Equation 12</xref>). This likelihood can be discretely approximated as the product of <inline-formula><mml:math id="inf112"><mml:mi>T</mml:mi></mml:math></inline-formula> Bernoulli trials in bins of width <inline-formula><mml:math id="inf113"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib16">Citi et al., 2014</xref>)<disp-formula id="equ17"><label>(19)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt">∣</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf114"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if a spike occurred in the <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>th bin and 0 otherwise.</p><p>The membrane voltage (and firing rate) is computed by integrating the membrane dynamics equation (<xref ref-type="disp-formula" rid="equ3">Equation 6</xref>). In practice, we evaluate <inline-formula><mml:math id="inf116"><mml:mi>V</mml:mi></mml:math></inline-formula> along the same discrete lattice of points of width <inline-formula><mml:math id="inf117"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) that we use to discretize the log-likelihood function. Assuming <inline-formula><mml:math id="inf119"><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> remain constant within each bin, the voltage equation becomes a simple linear differential equation which we solve according to <xref ref-type="disp-formula" rid="equ13">Equation 15</xref>.</p><p>The model parameters we fit were <inline-formula><mml:math id="inf121"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf122"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf123"><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf125"><mml:mi mathvariant="bold">𝐡</mml:mi></mml:math></inline-formula>, which were selected using conjugate-gradient methods to maximize the log-likelihood.</p><p>The reversal potential and leak conductance parameters were kept fixed at <inline-formula><mml:math id="inf126"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf127"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf128"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>60</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf129"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>80</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. For modeling the cells in which we had access to intracellular recordings, we set the time bin width to <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> to match the sampling frequency of the synaptic current recordings. For the remaining cells, which were recorded in separate experiments, we set <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.083</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, 100 times the frame rate of the visual stimulus.</p><p>The stimulus filters spanned over 100 ms, or over 1000 time bins. Therefore, we restricted the excitation and inhibitory filters to a low dimensional basis to limit the total number of free parameters in the model. The basis consisted of 10 raised cosine ‘bumps’ (<xref ref-type="bibr" rid="bib70">Pillow et al., 2005</xref>; <xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>) of the form<disp-formula id="equ18"><label>(20)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>a</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">c</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mfrac><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf132"><mml:mi>t</mml:mi></mml:math></inline-formula> is in seconds. We set c = 0.02 and <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> were evenly spaced from <inline-formula><mml:math id="inf135"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0.0</mml:mn><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf136"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0.150</mml:mn><mml:mo>+</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> so that the peaks of the filters spanned 0 ms to 150 ms. The spike history filter was also represented in a low-dimensional basis. The refractory period was accounted for with five square basis functions of width 0.4 ms, spanning the period <inline-formula><mml:math id="inf137"><mml:mrow><mml:mn>0</mml:mn><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> ms after a spike. The remaining spike history filter consisted of 7 raised cosine basis functions (c = 0.0001) with filter peaks spaced from 2 ms to 90 ms.</p><p>The log-likelihood function for this model is not concave in the model parameters, which increases the importance of selecting a good initialization point compared to the GLM. We initialized the parameters by fitting a simplified model which had only one conductance with a linear stimulus dependence, <inline-formula><mml:math id="inf138"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi mathvariant="bold">𝐱</mml:mi><mml:mi>t</mml:mi><mml:none/><mml:mprescripts/><mml:none/><mml:mo>⊤</mml:mo></mml:mmultiscripts></mml:mrow></mml:mrow></mml:math></inline-formula> (note that this allowed for negative conductance values). We initialized this filter at 0, and then numerically maximized the log-likelihood for <inline-formula><mml:math id="inf139"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. We then initialized the parameters for the complete model using <inline-formula><mml:math id="inf140"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf141"><mml:mrow><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, thereby exploiting a mapping between the GLM and the CBEM (see Results).</p><p>When fitting the model to real spike trains, one conductance filter would occasionally become dominant early in the optimization process. This was likely due to the limited amount of data available for fitting, especially for the cells that were recorded intracellularly. The intracellular recordings clearly indicated that the cells received similarly scaled excitatory and inhibitory inputs. To alleviate this problem, we added a penalty term, <inline-formula><mml:math id="inf142"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, to the log-likelihood to the <inline-formula><mml:math id="inf143"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> norms of <inline-formula><mml:math id="inf144"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf145"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="equ19"><label>(21)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo fence="true">||</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo fence="true">||</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo fence="true">||</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo fence="true">||</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Thus, we maximized<disp-formula id="equ20"><label>(22)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">ℒ</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>All cells were fit using the same penalty weights: <inline-formula><mml:math id="inf146"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>. We note that unlike the typical situation with cascade models that contain multiple filters, intracellular recordings can directly measure synaptic currents. Future work with this model could include more informative, data-driven priors on <inline-formula><mml:math id="inf148"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf149"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>In several analyses, we fit the CBEM without the inhibitory conductance, labeled as the CBEM<sub>exc</sub>. All the fixed parameters used in the full CBEM were held at the same values in the CBEM<sub>exc</sub>.</p><p>Code for fitting the CBEM has been made available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pillowlab/CBEM">https://github.com/pillowlab/CBEM</ext-link> (<xref ref-type="bibr" rid="bib42">Latimer, 2018</xref>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/CBEM">https://github.com/elifesciences-publications/CBEM</ext-link>).</p></sec><sec id="s4-6-2"><title>Fitting the CBEM to simulated spike trains</title><p>To examine the performance of our numerical maximum likelihood estimation of the CBEM, we fit the parameters to simulated spike trains from the model with known parameters (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). Our first simulated cell qualitatively mimicked experimental RGC datasets, with input filters selected to reproduce the stimulus tuning of macaque ON parasol RGCs (excitation oppositely tuned and delayed compared to excitation, or ‘crossover’ inhibition). The second simulated cell had similar excitatory tuning, but the inhibitory input had the same tuning as excitation with a short delay. The stimulus consisted of a one dimensional white noise signal, binned at a 0.1 ms resolution, and filtered with a low-pass filter with a 60 Hz cutoff frequency. We validated our maximum likelihood fitting procedure by examining error in the fitted filters, and evaluating the log-likelihood on a 5-min test set. With increasing amounts of training data, the parameter estimates converged to the true parameters for both simulated cells. Therefore, standard fast and non-global optimization algorithms can reliably fit the CBEM to spiking data, despite the fact that the model does not have the concavity guarantees of the standard GLM.</p></sec><sec id="s4-6-3"><title>Fitting the conductance nonlinearity</title><p>We selected the nonlinear function <inline-formula><mml:math id="inf150"><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> governing the synaptic conductances by fitting a linear-nonlinear cascade model to intracellularly measured conductances evoked during visual stimulation (<xref ref-type="bibr" rid="bib36">Hunter and Korenberg, 1986</xref>; <xref ref-type="bibr" rid="bib65">Paninski et al., 2012</xref>; <xref ref-type="bibr" rid="bib67">Park et al., 2013</xref>; <xref ref-type="bibr" rid="bib4">Barreiro et al., 2014</xref>). We modeled the mean conductance <inline-formula><mml:math id="inf151"><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as<disp-formula id="equ21"><label>(23)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ22"><label>(24)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf152"><mml:mi mathvariant="bold">𝐱</mml:mi></mml:math></inline-formula> is a full-field temporal stimulus, and <inline-formula><mml:math id="inf153"><mml:msub><mml:mi>a</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> are constants. We selected a fixed function for the nonlinearity <inline-formula><mml:math id="inf155"><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>. Thus, we chose the <inline-formula><mml:math id="inf156"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf157"><mml:msub><mml:mi>a</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>b</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:math></inline-formula> that minimized the squared error between the LN prediction and the measured excitatory conductance.</p><p>The soft-rectifying function was selected to model the conductance nonlinearity;<disp-formula id="equ23"><label>(25)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We chose to fix these nonlinearities to known functions rather than fitting with a more flexible empirical form (e.g., <xref ref-type="bibr" rid="bib1">Ahrens et al., 2008</xref>; <xref ref-type="bibr" rid="bib50">McFarland et al., 2013</xref>). Fixing these nonlinearities to a simple, closed-form function allowed for fast and robust maximum likelihood parameter estimates while still providing an excellent description of the data.</p></sec><sec id="s4-6-4"><title>Fitting the spike-rate nonlinearity</title><p>We used a spike-triggered analysis (<xref ref-type="bibr" rid="bib20">de Boer and Kuyper, 1968</xref>) on membrane voltage recordings to determine the spike rate nonlinearity, <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, as a function of voltage for the CBEM. This is the same procedure for estimating the LN-model nonlinearity proposed in <xref ref-type="bibr" rid="bib15">Chichilnisky (2001)</xref>; <xref ref-type="bibr" rid="bib52">Mease et al. (2013)</xref>, but substituting the filtered stimulus with the average voltage measured across trials. The membrane potential and spikes were recorded in dynamic-clamp experiments over several repeats of simulated conductances for two cells. We computed the mean voltage recorded over all runs of the dynamic-clamp condition, which largely eliminated the action potential shapes from the voltage trace. Using the spike times from all the repeats, we computed the probability of a spike occurring in one time bin given the mean voltage, <inline-formula><mml:math id="inf160"><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:math></inline-formula>:<disp-formula id="equ24"><label>(26)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the spike-triggered distribution of the membrane potential. The distribution over voltage in all times bins is <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The spike rate (in terms of spikes per bin) is <inline-formula><mml:math id="inf163"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We combined the spike times and voltage distributions for the two cells to compute a common spike rate function.</p><p>We then obtained a least-squares fit to approximate the nonlinearity with a soft-rectification function of the the form<disp-formula id="equ25"><label>(27)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mover><mml:mi>V</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>≈</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ26"><label>(28)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>β</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The parameters fit to the empirical spike-rate nonlinearity was <inline-formula><mml:math id="inf164"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>90</mml:mn><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf165"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>53</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1.67</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>We chose to fit the spike-rate nonlinearity with the average voltage recorded over repeat data, instead of looking at the voltage in bins preceding spikes (<xref ref-type="bibr" rid="bib38">Jolivet et al., 2006</xref>). The average voltage is closer in spirit to the voltage in our model than the single-trial voltage, because the voltage dynamics we considered (<xref ref-type="disp-formula" rid="equ3">Equation 6</xref>) did not include noise nor post-spike currents.</p></sec><sec id="s4-6-5"><title>Generalized linear models</title><p>For a baseline comparison to the CBEM, we also fit spike trains with a GLM. We used the same Bernoulli discretization of the point-process log-likelihood function for the GLM as we did with the CBEM:<disp-formula id="equ27"><label>(29)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">h</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where the firing rate is<disp-formula id="equ28"><label>(30)</label><mml:math id="m28"><mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mo>*</mml:mo><mml:mi mathvariant="bold">𝐱</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">𝐡</mml:mi><mml:mo>*</mml:mo><mml:msup><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The stimulus filter is <inline-formula><mml:math id="inf167"><mml:mi mathvariant="bold">𝐤</mml:mi></mml:math></inline-formula> and the spike history filter is <inline-formula><mml:math id="inf168"><mml:msup><mml:mi mathvariant="bold">𝐲</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. We used conjugate-gradient methods to find the maximum likelihood estimates for the parameters. We set <inline-formula><mml:math id="inf169"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which is the canonical inverse-link function for Poisson GLMs. We confirmed previous results that the soft-rectifying nonlinearity, <inline-formula><mml:math id="inf170"><mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, did not capture RGC responses as well as the exponential function (<xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>).</p></sec><sec id="s4-6-6"><title>Modeling respones to spatio-temporal stimuli</title><p>For spatio-temporal stimuli, the filters for the CBEM and GLM (<inline-formula><mml:math id="inf171"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf172"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>) spanned both space and time. Although the stimulus we used was a 10 × 10 grid of pixels, the receptive field (RF) of the neurons did not cover the entire grid. We therefore limited the spatial extent of the linear filters to a 5 × 5 grid of pixels, where the center pixel was the strongest point in the GLM stimulus filter.</p><p>The filters were represented as a matrix where the columns span the pixel space and the rows span the temporal dimension. The number of parameters was reduced by decomposing the spatio-temporal filters into a low-rank representation (<xref ref-type="bibr" rid="bib71">Pillow et al., 2008</xref>). The filter at pixel <inline-formula><mml:math id="inf173"><mml:mi>x</mml:mi></mml:math></inline-formula> and time <inline-formula><mml:math id="inf174"><mml:mi>τ</mml:mi></mml:math></inline-formula> became<disp-formula id="equ29"><label>(31)</label><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf175"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was a vector containing the spatial portion of the filter of length 25 (the number of pixels in the RF) and <inline-formula><mml:math id="inf176"><mml:msub><mml:mi mathvariant="bold">𝐤</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represented the temporal portion of the filter. The temporal filters were projected into the same 10-dimensional basis as the temporal filters used to model the full-field stimuli and the spatial filters were represented in the natural pixel basis. For identifiability, we normalized the spatial filters and forced the sign of the center pixel of the spatial filters to be positive. We used rank two filters (<inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>J</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) for the CBEM and GLM. Therefore, each filter contained 2 × 25 spatial and 2 × 10 temporal parameters for a total of 70 parameters. In the GLM, we found no significant improvement using rank three filters. To fit these low-rank filters, we alternated between optimizing over the spatial and temporal components of the filters.</p></sec><sec id="s4-6-7"><title>Evaluating model performance</title><p>We evaluated single-trial spike train predictive performance by computing the log-likelihood on a test spike train. We computed the difference between the log (base-2) likelihood under the model and the log-likelihood under a homogeneous rate model (<inline-formula><mml:math id="inf178"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) that captured only the mean spike rate:<disp-formula id="equ30"><label>(32)</label><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>L</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ31"><label>(33)</label><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula>where the test stimulus is of length <inline-formula><mml:math id="inf179"><mml:mi>T</mml:mi></mml:math></inline-formula> (in discrete bins) and contains <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> spikes. We then divided by the number of spikes to obtain the predictive performance in units of bits per spike (bits/sp) (<xref ref-type="bibr" rid="bib66">Panzeri et al., 1996</xref>; <xref ref-type="bibr" rid="bib6">Brenner et al., 2000</xref>; <xref ref-type="bibr" rid="bib62">Paninski et al., 2004</xref>)<disp-formula id="equ32"><label>(34)</label><mml:math id="m32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We evaluated model predictions of spike rate by simulating 2500 trials from the model for a repeated stimulus. We computed the firing rate, or PSTH, by averaging the number of spikes observed in 1 ms bins and smoothing with a Gaussian filter with a standard deviation of 2 ms. The percent of variance in the PSTH explained by the model is<disp-formula id="equ33"><label>(35)</label><mml:math id="m33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">%</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mover><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf181"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> denotes the average value of the PSTH.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank EJ Chichilnisky for generously providing data and valuable discussion. We also thank Il Memming Park and Jacob Yates for helpful comments. This work was supported by the McKnight Foundation (JWP), the Simons Foundation (SCGB AWD1004351, JWP), an NSF CAREER Award IIS-1150186 (JWP), a grant from the NIMH (MH099611, JWP), the Howard Hughes Medical Institute (FR), and a grant from the NIH (EY011850, FR).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Visualization, Methodology</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Validation, Investigation</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Funding acquisition, Visualization, Methodology, Project administration</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: Tissue was obtained via the tissue distribution program at the Washington National Primate Research Center. All animal procedures were performed in accordance with IACUC protocols at the University of Washington (IACUC protocol number 4277-01).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-47012-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All modeling tools have been made publicly available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pillowlab/CBEM">https://github.com/pillowlab/CBEM</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/CBEM">https://github.com/elifesciences-publications/CBEM</ext-link>). The datasets analyzed in this paper have been previously published as the following: 1. Conductance and cell-attached spike recordings: Philipp Khuc Trong and Fred Rieke (2008). &quot;Origin of correlated activity between parasol retinal ganglion cells.&quot; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2199">https://doi.org/10.1038/nn.2199</ext-link>. Dataset available via figshare <ext-link ext-link-type="uri" xlink:href="https://figshare.com/articles/ON-Parasol_RGCs_for_the_conductance-based_encoding_model/9636854">https://figshare.com/articles/ON-Parasol_RGCs_for_the_conductance-based_encoding_model/9636854</ext-link>. 2. Full-field extracellular recordings (including multiple contrasts): VJ Uzzell and EJ Chichilnisky (2004). &quot;Precision of Spike Trains in Primate Retinal Ganglion Cells.&quot; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.01171.2003">https://doi.org/10.1152/jn.01171.2003</ext-link>. Dataset can be accessed through a response to the corresponding author. 3. Spatio-temporal stimuli: Jonathan W Pillow, Jonathon Shlens, Liam Paninski, Alexander Sher, Alan M Litke, EJ Chichilnisky and Eero P Simoncelli (2008). &quot;Spatio-temporal correlations and visual signalling in a complete neuronal population.&quot; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07140">https://doi.org/10.1038/nature07140</ext-link>. Dataset can be accessed through a response to the corresponding author.</p><p>The following previously published dataset was used:</p><p><element-citation id="dataset1" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Kenneth</surname><given-names>W Latimer</given-names></name><name><surname>Fred</surname><given-names>Rieke</given-names></name><name><surname>Jonathan</surname><given-names>W Pillow</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>ON-Parasol RGCs for the conductance-based encoding model</data-title><source>figshare</source><pub-id assigning-authority="figshare" pub-id-type="doi">10.6084/m9.figshare.9636854</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahrens</surname> <given-names>MB</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Sahani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Inferring input nonlinearities in neural encoding models</article-title><source>Network: Computation in Neural Systems</source><volume>19</volume><fpage>35</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1080/09548980701813936</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baccus</surname> <given-names>SA</given-names></name><name><surname>Meister</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Fast and slow contrast adaptation in retinal circuitry</article-title><source>Neuron</source><volume>36</volume><fpage>909</fpage><lpage>919</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)01050-4</pub-id><pub-id pub-id-type="pmid">12467594</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badel</surname> <given-names>L</given-names></name><name><surname>Lefort</surname> <given-names>S</given-names></name><name><surname>Berger</surname> <given-names>TK</given-names></name><name><surname>Petersen</surname> <given-names>CC</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name><name><surname>Richardson</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Extracting non-linear integrate-and-fire models from experimental data using dynamic I-V curves</article-title><source>Biological Cybernetics</source><volume>99</volume><fpage>361</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1007/s00422-008-0259-4</pub-id><pub-id pub-id-type="pmid">19011924</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barreiro</surname> <given-names>AK</given-names></name><name><surname>Gjorgjieva</surname> <given-names>J</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name><name><surname>Shea-Brown</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>When do microcircuits produce beyond-pairwise correlations?</article-title><source>Frontiers in Computational Neuroscience</source><volume>8</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2014.00010</pub-id><pub-id pub-id-type="pmid">24567715</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beaudoin</surname> <given-names>DL</given-names></name><name><surname>Manookin</surname> <given-names>MB</given-names></name><name><surname>Demb</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Distinct expressions of contrast gain control in parallel synaptic pathways converging on a retinal ganglion cell</article-title><source>The Journal of Physiology</source><volume>586</volume><fpage>5487</fpage><lpage>5502</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2008.156224</pub-id><pub-id pub-id-type="pmid">18832424</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname> <given-names>N</given-names></name><name><surname>Strong</surname> <given-names>SP</given-names></name><name><surname>Koberle</surname> <given-names>R</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>de Ruyter van Steveninck</surname> <given-names>RR</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Synergy in a neural code</article-title><source>Neural Computation</source><volume>12</volume><fpage>1531</fpage><lpage>1552</lpage><pub-id pub-id-type="doi">10.1162/089976600300015259</pub-id><pub-id pub-id-type="pmid">10935917</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname> <given-names>SP</given-names></name><name><surname>Masland</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Spatial scale and cellular substrate of contrast adaptation by retinal ganglion cells</article-title><source>Nature Neuroscience</source><volume>4</volume><fpage>44</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1038/82888</pub-id><pub-id pub-id-type="pmid">11135644</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butts</surname> <given-names>DA</given-names></name><name><surname>Weng</surname> <given-names>C</given-names></name><name><surname>Jin</surname> <given-names>J</given-names></name><name><surname>Yeh</surname> <given-names>CI</given-names></name><name><surname>Lesica</surname> <given-names>NA</given-names></name><name><surname>Alonso</surname> <given-names>JM</given-names></name><name><surname>Stanley</surname> <given-names>GB</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Temporal precision in the neural code and the timescales of natural vision</article-title><source>Nature</source><volume>449</volume><fpage>92</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1038/nature06105</pub-id><pub-id pub-id-type="pmid">17805296</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butts</surname> <given-names>DA</given-names></name><name><surname>Weng</surname> <given-names>C</given-names></name><name><surname>Jin</surname> <given-names>J</given-names></name><name><surname>Alonso</surname> <given-names>JM</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Temporal precision in the visual pathway through the interplay of excitation and stimulus-driven suppression</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>11313</fpage><lpage>11327</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0434-11.2011</pub-id><pub-id pub-id-type="pmid">21813691</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cafaro</surname> <given-names>J</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Noise correlations improve response fidelity and stimulus encoding</article-title><source>Nature</source><volume>468</volume><fpage>964</fpage><lpage>967</lpage><pub-id pub-id-type="doi">10.1038/nature09570</pub-id><pub-id pub-id-type="pmid">21131948</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cafaro</surname> <given-names>J</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Regulation of spatial selectivity by crossover inhibition</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>6310</fpage><lpage>6320</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4964-12.2013</pub-id><pub-id pub-id-type="pmid">23575830</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carandini</surname> <given-names>M</given-names></name><name><surname>Demb</surname> <given-names>JB</given-names></name><name><surname>Mante</surname> <given-names>V</given-names></name><name><surname>Tolhurst</surname> <given-names>DJ</given-names></name><name><surname>Dan</surname> <given-names>Y</given-names></name><name><surname>Olshausen</surname> <given-names>BA</given-names></name><name><surname>Gallant</surname> <given-names>JL</given-names></name><name><surname>Rust</surname> <given-names>NC</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Do we know what the early visual system does?</article-title><source>Journal of Neuroscience</source><volume>25</volume><fpage>10577</fpage><lpage>10597</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3726-05.2005</pub-id><pub-id pub-id-type="pmid">16291931</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chance</surname> <given-names>FS</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Reyes</surname> <given-names>AD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Gain modulation from background synaptic input</article-title><source>Neuron</source><volume>35</volume><fpage>773</fpage><lpage>782</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(02)00820-6</pub-id><pub-id pub-id-type="pmid">12194875</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chander</surname> <given-names>D</given-names></name><name><surname>Chichilnisky</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Adaptation to temporal contrast in primate and salamander retina</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>9904</fpage><lpage>9916</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-24-09904.2001</pub-id><pub-id pub-id-type="pmid">11739598</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chichilnisky</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A simple white noise analysis of neuronal light responses</article-title><source>Network: Computation in Neural Systems</source><volume>12</volume><fpage>199</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1080/713663221</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Citi</surname> <given-names>L</given-names></name><name><surname>Ba</surname> <given-names>D</given-names></name><name><surname>Brown</surname> <given-names>EN</given-names></name><name><surname>Barbieri</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Likelihood methods for point processes with refractoriness</article-title><source>Neural Computation</source><volume>26</volume><fpage>237</fpage><lpage>263</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00548</pub-id><pub-id pub-id-type="pmid">24206384</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clark</surname> <given-names>DA</given-names></name><name><surname>Benichou</surname> <given-names>R</given-names></name><name><surname>Meister</surname> <given-names>M</given-names></name><name><surname>Azeredo da Silveira</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dynamical adaptation in photoreceptors</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003289</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003289</pub-id><pub-id pub-id-type="pmid">24244119</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname> <given-names>Y</given-names></name><name><surname>Liu</surname> <given-names>LD</given-names></name><name><surname>McFarland</surname> <given-names>JM</given-names></name><name><surname>Pack</surname> <given-names>CC</given-names></name><name><surname>Butts</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>Inferring cortical variability from local field potentials</article-title><source>The Journal of Neuroscience</source><volume>36</volume><fpage>4121</fpage><lpage>4135</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2502-15.2016</pub-id><pub-id pub-id-type="pmid">27053217</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cui</surname> <given-names>Y</given-names></name><name><surname>Wang</surname> <given-names>YV</given-names></name><name><surname>Park</surname> <given-names>SJ</given-names></name><name><surname>Demb</surname> <given-names>JB</given-names></name><name><surname>Butts</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>Divisive suppression explains high-precision firing and contrast adaptation in retinal ganglion cells</article-title><source>eLife</source><volume>5</volume><elocation-id>e19460</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.19460</pub-id><pub-id pub-id-type="pmid">27841746</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Boer</surname> <given-names>R</given-names></name><name><surname>Kuyper</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>Triggered correlation</article-title><source>IEEE Transactions on Biomedical Engineering</source><volume>15</volume><fpage>169</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1109/TBME.1968.4502561</pub-id><pub-id pub-id-type="pmid">5667803</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demb</surname> <given-names>JB</given-names></name><name><surname>Zaghloul</surname> <given-names>K</given-names></name><name><surname>Haarsma</surname> <given-names>L</given-names></name><name><surname>Sterling</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Bipolar cells contribute to nonlinear spatial summation in the brisk-transient (Y) ganglion cell in mammalian retina</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>7447</fpage><lpage>7454</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-19-07447.2001</pub-id><pub-id pub-id-type="pmid">11567034</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demb</surname> <given-names>JB</given-names></name><name><surname>Singer</surname> <given-names>JH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Functional circuitry of the retina</article-title><source>Annual Review of Vision Science</source><volume>1</volume><fpage>263</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-082114-035334</pub-id><pub-id pub-id-type="pmid">28532365</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname> <given-names>FA</given-names></name><name><surname>Doan</surname> <given-names>T</given-names></name><name><surname>Sampath</surname> <given-names>AP</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Controlling the gain of rod-mediated signals in the mammalian retina</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>3959</fpage><lpage>3970</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5148-05.2006</pub-id><pub-id pub-id-type="pmid">16611812</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Einevoll</surname> <given-names>GT</given-names></name><name><surname>Kayser</surname> <given-names>C</given-names></name><name><surname>Logothetis</surname> <given-names>NK</given-names></name><name><surname>Panzeri</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Modelling and analysis of local field potentials for studying the function of cortical circuits</article-title><source>Nature Reviews Neuroscience</source><volume>14</volume><fpage>770</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.1038/nrn3599</pub-id><pub-id pub-id-type="pmid">24135696</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairhall</surname> <given-names>AL</given-names></name><name><surname>Lewen</surname> <given-names>GD</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>de Ruyter Van Steveninck</surname> <given-names>RR</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Efficiency and ambiguity in an adaptive neural code</article-title><source>Nature</source><volume>412</volume><fpage>787</fpage><lpage>792</lpage><pub-id pub-id-type="doi">10.1038/35090500</pub-id><pub-id pub-id-type="pmid">11518957</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitzgerald</surname> <given-names>JD</given-names></name><name><surname>Rowekamp</surname> <given-names>RJ</given-names></name><name><surname>Sincich</surname> <given-names>LC</given-names></name><name><surname>Sharpee</surname> <given-names>TO</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Second order dimensionality reduction using minimum and maximum mutual information models</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1002249</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002249</pub-id><pub-id pub-id-type="pmid">22046122</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname> <given-names>J</given-names></name><name><surname>Field</surname> <given-names>GD</given-names></name><name><surname>Li</surname> <given-names>PH</given-names></name><name><surname>Greschner</surname> <given-names>M</given-names></name><name><surname>Gunning</surname> <given-names>DE</given-names></name><name><surname>Mathieson</surname> <given-names>K</given-names></name><name><surname>Sher</surname> <given-names>A</given-names></name><name><surname>Litke</surname> <given-names>AM</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name><name><surname>Chichilnisky</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Mapping nonlinear receptive field structure in primate retina at single cone resolution</article-title><source>eLife</source><volume>4</volume><elocation-id>e05241</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.05241</pub-id><pub-id pub-id-type="pmid">26517879</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garvert</surname> <given-names>MM</given-names></name><name><surname>Gollisch</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Local and global contrast adaptation in retinal ganglion cells</article-title><source>Neuron</source><volume>77</volume><fpage>915</fpage><lpage>928</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.12.030</pub-id><pub-id pub-id-type="pmid">23473321</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2001">2001</year><chapter-title>A framework for spiking neuron models: the spike response model</chapter-title><source>Handbook of Biological Physics</source><publisher-name>Elsevier</publisher-name><fpage>469</fpage><lpage>516</lpage><pub-id pub-id-type="doi">10.1016/S1383-8121(01)80015-4</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerwinn</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Bayesian inference for generalized linear models for spiking neurons</article-title><source>Frontiers in Computational Neuroscience</source><volume>4</volume><elocation-id>e00012</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2010.00012</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gollisch</surname> <given-names>T</given-names></name><name><surname>Meister</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Eye smarter than scientists believed: neural computations in circuits of the retina</article-title><source>Neuron</source><volume>65</volume><fpage>150</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.12.009</pub-id><pub-id pub-id-type="pmid">20152123</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haider</surname> <given-names>B</given-names></name><name><surname>Schulz</surname> <given-names>DP</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Millisecond coupling of local field potentials to synaptic currents in the awake visual cortex</article-title><source>Neuron</source><volume>90</volume><fpage>35</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.02.034</pub-id><pub-id pub-id-type="pmid">27021173</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname> <given-names>K</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Giocomo</surname> <given-names>LM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Environmental boundaries as an error correction mechanism for grid cells</article-title><source>Neuron</source><volume>86</volume><fpage>827</fpage><lpage>839</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.039</pub-id><pub-id pub-id-type="pmid">25892299</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname> <given-names>KD</given-names></name><name><surname>Csicsvari</surname> <given-names>J</given-names></name><name><surname>Hirase</surname> <given-names>H</given-names></name><name><surname>Dragoi</surname> <given-names>G</given-names></name><name><surname>Buzsáki</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Organization of cell assemblies in the Hippocampus</article-title><source>Nature</source><volume>424</volume><fpage>552</fpage><lpage>556</lpage><pub-id pub-id-type="doi">10.1038/nature01834</pub-id><pub-id pub-id-type="pmid">12891358</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Heitman</surname> <given-names>A</given-names></name><name><surname>Brackbill</surname> <given-names>N</given-names></name><name><surname>Greschner</surname> <given-names>M</given-names></name><name><surname>Sher</surname> <given-names>AML</given-names></name><name><surname>Chichilnisky</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Testing pseudo-linear models of responses to natural scenes in primate retina</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/045336</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunter</surname> <given-names>IW</given-names></name><name><surname>Korenberg</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>The identification of nonlinear biological systems: wiener and Hammerstein cascade models</article-title><source>Biological Cybernetics</source><volume>55</volume><fpage>135</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1007/bf00341929</pub-id><pub-id pub-id-type="pmid">3801534</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Johnston</surname> <given-names>D</given-names></name><name><surname>Wu</surname> <given-names>SM</given-names></name><name><surname>Gray</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1995">1995</year><source>Foundations of Cellular Neurophysiology</source><publisher-loc>Cambridge, MA</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jolivet</surname> <given-names>R</given-names></name><name><surname>Rauch</surname> <given-names>A</given-names></name><name><surname>Lüscher</surname> <given-names>HR</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Predicting spike timing of neocortical pyramidal neurons by simple threshold models</article-title><source>Journal of Computational Neuroscience</source><volume>21</volume><fpage>35</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1007/s10827-006-7074-5</pub-id><pub-id pub-id-type="pmid">16633938</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelly</surname> <given-names>RC</given-names></name><name><surname>Smith</surname> <given-names>MA</given-names></name><name><surname>Kass</surname> <given-names>RE</given-names></name><name><surname>Lee</surname> <given-names>TS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Local field potentials indicate network state and account for neuronal response variability</article-title><source>Journal of Computational Neuroscience</source><volume>29</volume><fpage>567</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1007/s10827-009-0208-9</pub-id><pub-id pub-id-type="pmid">20094906</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lankarany</surname> <given-names>M</given-names></name><name><surname>Heiss</surname> <given-names>JE</given-names></name><name><surname>Lampl</surname> <given-names>I</given-names></name><name><surname>Toyoizumi</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Simultaneous Bayesian estimation of excitatory and inhibitory synaptic conductances by exploiting multiple recorded trials</article-title><source>Frontiers in Computational Neuroscience</source><volume>10</volume><elocation-id>110</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2016.00110</pub-id><pub-id pub-id-type="pmid">27867353</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lankarany</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Estimating excitatory and inhibitory synaptic conductances from spike trains using a recursive bayesian approach</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/170878</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Latimer</surname> <given-names>KW</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>conductance-based encoding model</data-title><source>GitHub</source><version designator="553892b">553892b</version><ext-link ext-link-type="uri" xlink:href="https://github.com/pillowlab/CBEM">https://github.com/pillowlab/CBEM</ext-link></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Latimer</surname> <given-names>KW</given-names></name><name><surname>Barbera</surname> <given-names>D</given-names></name><name><surname>Sokoletsky</surname> <given-names>M</given-names></name><name><surname>Awwad</surname> <given-names>B</given-names></name><name><surname>Katz</surname> <given-names>Y</given-names></name><name><surname>Nelken</surname> <given-names>I</given-names></name><name><surname>Lampl</surname> <given-names>I</given-names></name><name><surname>Fairhall</surname> <given-names>AL</given-names></name><name><surname>Priebe</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Multiple timescales account for adaptive responses across sensory cortices</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>10019</fpage><lpage>10033</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1642-19.2019</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname> <given-names>JK</given-names></name><name><surname>Schreyer</surname> <given-names>HM</given-names></name><name><surname>Onken</surname> <given-names>A</given-names></name><name><surname>Rozenblit</surname> <given-names>F</given-names></name><name><surname>Khani</surname> <given-names>MH</given-names></name><name><surname>Krishnamoorthy</surname> <given-names>V</given-names></name><name><surname>Panzeri</surname> <given-names>S</given-names></name><name><surname>Gollisch</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Inference of neuronal functional circuitry with spike-triggered non-negative matrix factorization</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>149</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00156-9</pub-id><pub-id pub-id-type="pmid">28747662</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lundstrom</surname> <given-names>BN</given-names></name><name><surname>Higgs</surname> <given-names>MH</given-names></name><name><surname>Spain</surname> <given-names>WJ</given-names></name><name><surname>Fairhall</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Fractional differentiation by neocortical pyramidal neurons</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>1335</fpage><lpage>1342</lpage><pub-id pub-id-type="doi">10.1038/nn.2212</pub-id><pub-id pub-id-type="pmid">18931665</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maheswaranathan</surname> <given-names>N</given-names></name><name><surname>Kastner</surname> <given-names>DB</given-names></name><name><surname>Baccus</surname> <given-names>SA</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inferring hidden structure in multilayered neural circuits</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006291</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006291</pub-id><pub-id pub-id-type="pmid">30138312</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manookin</surname> <given-names>MB</given-names></name><name><surname>Beaudoin</surname> <given-names>DL</given-names></name><name><surname>Ernst</surname> <given-names>ZR</given-names></name><name><surname>Flagel</surname> <given-names>LJ</given-names></name><name><surname>Demb</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Disinhibition combines with excitation to extend the operating range of the OFF visual pathway in daylight</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>4136</fpage><lpage>4150</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4274-07.2008</pub-id><pub-id pub-id-type="pmid">18417693</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mante</surname> <given-names>V</given-names></name><name><surname>Frazor</surname> <given-names>RA</given-names></name><name><surname>Bonin</surname> <given-names>V</given-names></name><name><surname>Geisler</surname> <given-names>WS</given-names></name><name><surname>Carandini</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Independence of luminance and contrast in natural scenes and in the early visual system</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>1690</fpage><lpage>1697</lpage><pub-id pub-id-type="doi">10.1038/nn1556</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marava</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><chapter-title>Adaptation and sensory coding</chapter-title><source>Principles of Neural Coding</source><publisher-name>CRC Press</publisher-name><fpage>357</fpage><lpage>378</lpage></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McFarland</surname> <given-names>JM</given-names></name><name><surname>Cui</surname> <given-names>Y</given-names></name><name><surname>Butts</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inferring nonlinear neuronal computation based on physiologically plausible inputs</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003143</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003143</pub-id><pub-id pub-id-type="pmid">23874185</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>McIntosh</surname> <given-names>L</given-names></name><name><surname>Maheswaranathan</surname> <given-names>N</given-names></name><name><surname>Nayebi</surname> <given-names>A</given-names></name><name><surname>Ganguli</surname> <given-names>S</given-names></name><name><surname>Baccus</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title><italic>Deep learning models of the retinal response to natural scenes</italic></article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>1369</fpage><lpage>1377</lpage></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mease</surname> <given-names>RA</given-names></name><name><surname>Famulare</surname> <given-names>M</given-names></name><name><surname>Gjorgjieva</surname> <given-names>J</given-names></name><name><surname>Moody</surname> <given-names>WJ</given-names></name><name><surname>Fairhall</surname> <given-names>AL</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Emergence of adaptive computation by single neurons in the developing cortex</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>12154</fpage><lpage>12170</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3263-12.2013</pub-id><pub-id pub-id-type="pmid">23884925</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meng</surname> <given-names>L</given-names></name><name><surname>Kramer</surname> <given-names>MA</given-names></name><name><surname>Eden</surname> <given-names>UT</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A sequential monte carlo approach to estimate biophysical neural models from spikes</article-title><source>Journal of Neural Engineering</source><volume>8</volume><elocation-id>065006</elocation-id><pub-id pub-id-type="doi">10.1088/1741-2560/8/6/065006</pub-id><pub-id pub-id-type="pmid">22058277</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meng</surname> <given-names>L</given-names></name><name><surname>Kramer</surname> <given-names>MA</given-names></name><name><surname>Middleton</surname> <given-names>SJ</given-names></name><name><surname>Whittington</surname> <given-names>MA</given-names></name><name><surname>Eden</surname> <given-names>UT</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A unified approach to linking experimental, statistical and computational analysis of spike train data</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e85269</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0085269</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Mensi</surname> <given-names>S</given-names></name><name><surname>Naud</surname> <given-names>R</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>From stochastic nonlinear integrate-and-fire to generalized linear models</article-title><conf-name>Advances in Neural Information Processing Systems 24</conf-name><fpage>1377</fpage><lpage>1385</lpage></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohanty</surname> <given-names>D</given-names></name><name><surname>Scholl</surname> <given-names>B</given-names></name><name><surname>Priebe</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The accuracy of membrane potential reconstruction based on spiking receptive fields</article-title><source>Journal of Neurophysiology</source><volume>107</volume><fpage>2143</fpage><lpage>2153</lpage><pub-id pub-id-type="doi">10.1152/jn.01176.2011</pub-id><pub-id pub-id-type="pmid">22279194</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murphy</surname> <given-names>BK</given-names></name><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Multiplicative gain changes are induced by excitation or inhibition alone</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>10040</fpage><lpage>10051</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-31-10040.2003</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murphy</surname> <given-names>GJ</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Network variability limits stimulus-evoked spike timing precision in retinal ganglion cells</article-title><source>Neuron</source><volume>52</volume><fpage>511</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2006.09.014</pub-id><pub-id pub-id-type="pmid">17088216</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozuysal</surname> <given-names>Y</given-names></name><name><surname>Kastner</surname> <given-names>DB</given-names></name><name><surname>Baccus</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Adaptive feature detection from differential processing in parallel retinal pathways</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006560</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006560</pub-id><pub-id pub-id-type="pmid">30457994</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozuysal</surname> <given-names>Y</given-names></name><name><surname>Baccus</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Linking the computational structure of variance adaptation to biophysical mechanisms</article-title><source>Neuron</source><volume>73</volume><fpage>1002</fpage><lpage>1015</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.12.029</pub-id><pub-id pub-id-type="pmid">22405209</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paninski</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Maximum likelihood estimation of cascade point-process neural encoding models</article-title><source>Network: Computation in Neural Systems</source><volume>15</volume><fpage>243</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_15_4_002</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Shoham</surname> <given-names>S</given-names></name><name><surname>Fellows</surname> <given-names>MR</given-names></name><name><surname>Hatsopoulos</surname> <given-names>NG</given-names></name><name><surname>Donoghue</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Superlinear population encoding of dynamic hand trajectory in primary motor cortex</article-title><source>Journal of Neuroscience</source><volume>24</volume><fpage>8551</fpage><lpage>8561</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0919-04.2004</pub-id><pub-id pub-id-type="pmid">15456829</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Pillow</surname> <given-names>J</given-names></name><name><surname>Lewi</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Statistical models for neural encoding, decoding, and optimal stimulus design</article-title><source>Progress in Brain Research</source><volume>165</volume><fpage>493</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1016/S0079-6123(06)65031-0</pub-id><pub-id pub-id-type="pmid">17925266</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Haith</surname> <given-names>A</given-names></name><name><surname>Szirtes</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Integral equation methods for computing likelihoods and their derivatives in the stochastic integrate-and-fire model</article-title><source>Journal of Computational Neuroscience</source><volume>24</volume><fpage>69</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1007/s10827-007-0042-x</pub-id><pub-id pub-id-type="pmid">17492371</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Vidne</surname> <given-names>M</given-names></name><name><surname>DePasquale</surname> <given-names>B</given-names></name><name><surname>Ferreira</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Inferring synaptic inputs given a noisy voltage trace via sequential monte carlo methods</article-title><source>Journal of Computational Neuroscience</source><volume>33</volume><fpage>1</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1007/s10827-011-0371-7</pub-id><pub-id pub-id-type="pmid">22089473</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panzeri</surname> <given-names>S</given-names></name><name><surname>Biella</surname> <given-names>G</given-names></name><name><surname>Rolls</surname> <given-names>ET</given-names></name><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Treves</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Speed, noise, information and the graded nature of neuronal responses</article-title><source>Network: Computation in Neural Systems</source><volume>7</volume><fpage>365</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_7_2_018</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Park</surname> <given-names>IM</given-names></name><name><surname>Archer</surname> <given-names>EW</given-names></name><name><surname>Priebe</surname> <given-names>N</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2013">2013</year><chapter-title>Spectral methods for neural characterization using generalized quadratic models</chapter-title><source>Advances in Neural Information Processing Systems</source><volume>26</volume><publisher-name>Neural Information Processing Systems Foundation, Inc</publisher-name><fpage>2454</fpage><lpage>2462</lpage></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname> <given-names>IM</given-names></name><name><surname>Meister</surname> <given-names>ML</given-names></name><name><surname>Huk</surname> <given-names>AC</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Encoding and decoding in parietal cortex during sensorimotor decision-making</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>1395</fpage><lpage>1403</lpage><pub-id pub-id-type="doi">10.1038/nn.3800</pub-id><pub-id pub-id-type="pmid">25174005</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Park</surname> <given-names>IM</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title>Bayesian spike-triggered covariance analysis</chapter-title><source>Advances in Neural Information Processing System</source><publisher-name>MIT Press</publisher-name><fpage>1692</fpage><lpage>1700</lpage></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname> <given-names>JW</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Uzzell</surname> <given-names>VJ</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name><name><surname>Chichilnisky</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Prediction and decoding of retinal ganglion cell responses with a probabilistic spiking model</article-title><source>Journal of Neuroscience</source><volume>25</volume><fpage>11003</fpage><lpage>11013</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3305-05.2005</pub-id><pub-id pub-id-type="pmid">16306413</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pillow</surname> <given-names>JW</given-names></name><name><surname>Shlens</surname> <given-names>J</given-names></name><name><surname>Paninski</surname> <given-names>L</given-names></name><name><surname>Sher</surname> <given-names>A</given-names></name><name><surname>Litke</surname> <given-names>AM</given-names></name><name><surname>Chichilnisky</surname> <given-names>EJ</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title><source>Nature</source><volume>454</volume><fpage>995</fpage><lpage>999</lpage><pub-id pub-id-type="doi">10.1038/nature07140</pub-id><pub-id pub-id-type="pmid">18650810</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plesser</surname> <given-names>HE</given-names></name><name><surname>Gerstner</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Noise in integrate-and-fire neurons: from stochastic input to escape rates</article-title><source>Neural Computation</source><volume>12</volume><fpage>367</fpage><lpage>384</lpage><pub-id pub-id-type="doi">10.1162/089976600300015835</pub-id><pub-id pub-id-type="pmid">10636947</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poo</surname> <given-names>C</given-names></name><name><surname>Isaacson</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Odor representations in olfactory cortex: &quot;sparse&quot; coding, global inhibition, and oscillations</article-title><source>Neuron</source><volume>62</volume><fpage>850</fpage><lpage>861</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.05.022</pub-id><pub-id pub-id-type="pmid">19555653</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajan</surname> <given-names>K</given-names></name><name><surname>Marre</surname> <given-names>O</given-names></name><name><surname>Tkačik</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Learning quadratic receptive fields from neural responses to natural stimuli</article-title><source>Neural Computation</source><volume>25</volume><fpage>1661</fpage><lpage>1692</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00463</pub-id><pub-id pub-id-type="pmid">23607557</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Real</surname> <given-names>E</given-names></name><name><surname>Asari</surname> <given-names>H</given-names></name><name><surname>Gollisch</surname> <given-names>T</given-names></name><name><surname>Meister</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Neural circuit inference from function to structure</article-title><source>Current Biology</source><volume>27</volume><fpage>189</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2016.11.040</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Temporal contrast adaptation in salamander bipolar cells</article-title><source>The Journal of Neuroscience</source><volume>21</volume><fpage>9445</fpage><lpage>9454</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.21-23-09445.2001</pub-id><pub-id pub-id-type="pmid">11717378</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roska</surname> <given-names>B</given-names></name><name><surname>Molnar</surname> <given-names>A</given-names></name><name><surname>Werblin</surname> <given-names>FS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Parallel processing in retinal ganglion cells: how integration of space-time patterns of excitation and inhibition form the spiking output</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>3810</fpage><lpage>3822</lpage><pub-id pub-id-type="doi">10.1152/jn.00113.2006</pub-id><pub-id pub-id-type="pmid">16510780</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rust</surname> <given-names>NC</given-names></name><name><surname>Schwartz</surname> <given-names>O</given-names></name><name><surname>Movshon</surname> <given-names>JA</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Spatiotemporal elements of macaque v1 receptive fields</article-title><source>Neuron</source><volume>46</volume><fpage>945</fpage><lpage>956</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.05.021</pub-id><pub-id pub-id-type="pmid">15953422</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rust</surname> <given-names>NC</given-names></name><name><surname>Mante</surname> <given-names>V</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name><name><surname>Movshon</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>How MT cells analyze the motion of visual patterns</article-title><source>Nature Neuroscience</source><volume>9</volume><fpage>1421</fpage><lpage>1431</lpage><pub-id pub-id-type="doi">10.1038/nn1786</pub-id><pub-id pub-id-type="pmid">17041595</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scholl</surname> <given-names>B</given-names></name><name><surname>Gao</surname> <given-names>X</given-names></name><name><surname>Wehr</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Nonoverlapping sets of synapses drive on responses and off responses in auditory cortex</article-title><source>Neuron</source><volume>65</volume><fpage>412</fpage><lpage>421</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.01.020</pub-id><pub-id pub-id-type="pmid">20159453</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Schwartz</surname> <given-names>O</given-names></name><name><surname>Chichilnisky</surname> <given-names>E</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Characterizing neural gain control using Spike-Triggered covariance</article-title><conf-name>Advances in Neural Information Processing Systems 14</conf-name><fpage>269</fpage><lpage>276</lpage></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname> <given-names>GW</given-names></name><name><surname>Okawa</surname> <given-names>H</given-names></name><name><surname>Dunn</surname> <given-names>FA</given-names></name><name><surname>Morgan</surname> <given-names>JL</given-names></name><name><surname>Kerschensteiner</surname> <given-names>D</given-names></name><name><surname>Wong</surname> <given-names>RO</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The spatial structure of a nonlinear receptive field</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1572</fpage><lpage>1580</lpage><pub-id pub-id-type="doi">10.1038/nn.3225</pub-id><pub-id pub-id-type="pmid">23001060</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname> <given-names>G</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Nonlinear spatial encoding by retinal ganglion cells: when 1 + 1 ≠ 2</article-title><source>The Journal of General Physiology</source><volume>138</volume><fpage>283</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1085/jgp.201110629</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname> <given-names>GW</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Controlling gain one photon at a time</article-title><source>eLife</source><volume>2</volume><elocation-id>e00467</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00467</pub-id><pub-id pub-id-type="pmid">23682314</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharpee</surname> <given-names>T</given-names></name><name><surname>Rust</surname> <given-names>NC</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Analyzing neural responses to natural signals: maximally informative dimensions</article-title><source>Neural Computation</source><volume>16</volume><fpage>223</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1162/089976604322742010</pub-id><pub-id pub-id-type="pmid">15006095</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stevenson</surname> <given-names>IH</given-names></name><name><surname>London</surname> <given-names>BM</given-names></name><name><surname>Oby</surname> <given-names>ER</given-names></name><name><surname>Sachs</surname> <given-names>NA</given-names></name><name><surname>Reimer</surname> <given-names>J</given-names></name><name><surname>Englitz</surname> <given-names>B</given-names></name><name><surname>David</surname> <given-names>SV</given-names></name><name><surname>Shamma</surname> <given-names>SA</given-names></name><name><surname>Blanche</surname> <given-names>TJ</given-names></name><name><surname>Mizuseki</surname> <given-names>K</given-names></name><name><surname>Zandvakili</surname> <given-names>A</given-names></name><name><surname>Hatsopoulos</surname> <given-names>NG</given-names></name><name><surname>Miller</surname> <given-names>LE</given-names></name><name><surname>Kording</surname> <given-names>KP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Functional connectivity and tuning curves in populations of simultaneously recorded neurons</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002775</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002775</pub-id><pub-id pub-id-type="pmid">23166484</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname> <given-names>AY</given-names></name><name><surname>Brown</surname> <given-names>BD</given-names></name><name><surname>Scholl</surname> <given-names>B</given-names></name><name><surname>Mohanty</surname> <given-names>D</given-names></name><name><surname>Priebe</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Orientation selectivity of synaptic input to neurons in mouse and cat primary visual cortex</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>12339</fpage><lpage>12350</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2039-11.2011</pub-id><pub-id pub-id-type="pmid">21865476</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theis</surname> <given-names>L</given-names></name><name><surname>Chagas</surname> <given-names>AM</given-names></name><name><surname>Arnstein</surname> <given-names>D</given-names></name><name><surname>Schwarz</surname> <given-names>C</given-names></name><name><surname>Bethge</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Beyond GLMs: a generative mixture modeling approach to neural system identification</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003356</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003356</pub-id><pub-id pub-id-type="pmid">24278006</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trong</surname> <given-names>PK</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Origin of correlated activity between parasol retinal ganglion cells</article-title><source>Nature Neuroscience</source><volume>11</volume><fpage>1343</fpage><lpage>1351</lpage><pub-id pub-id-type="doi">10.1038/nn.2199</pub-id><pub-id pub-id-type="pmid">18820692</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Truccolo</surname> <given-names>W</given-names></name><name><surname>Eden</surname> <given-names>UT</given-names></name><name><surname>Fellows</surname> <given-names>MR</given-names></name><name><surname>Donoghue</surname> <given-names>JP</given-names></name><name><surname>Brown</surname> <given-names>EN</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title><source>Journal of Neurophysiology</source><volume>93</volume><fpage>1074</fpage><lpage>1089</lpage><pub-id pub-id-type="doi">10.1152/jn.00697.2004</pub-id><pub-id pub-id-type="pmid">15356183</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname> <given-names>MH</given-names></name><name><surname>Schwartz</surname> <given-names>GW</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Receptive field center-surround interactions mediate context-dependent spatial contrast encoding in the retina</article-title><source>eLife</source><volume>7</volume><elocation-id>e38841</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38841</pub-id><pub-id pub-id-type="pmid">30188320</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner</surname> <given-names>MH</given-names></name><name><surname>Rieke</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synaptic rectification controls nonlinear spatial integration of natural visual inputs</article-title><source>Neuron</source><volume>90</volume><fpage>1257</fpage><lpage>1271</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.05.006</pub-id><pub-id pub-id-type="pmid">27263968</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uzzell</surname> <given-names>VJ</given-names></name><name><surname>Chichilnisky</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Precision of spike trains in primate retinal ganglion cells</article-title><source>Journal of Neurophysiology</source><volume>92</volume><fpage>780</fpage><lpage>789</lpage><pub-id pub-id-type="doi">10.1152/jn.01171.2003</pub-id><pub-id pub-id-type="pmid">15277596</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Hateren</surname> <given-names>JH</given-names></name><name><surname>Rüttiger</surname> <given-names>L</given-names></name><name><surname>Sun</surname> <given-names>H</given-names></name><name><surname>Lee</surname> <given-names>BB</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Processing of natural temporal stimuli by macaque retinal ganglion cells</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>9945</fpage><lpage>9960</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.22-22-09945.2002</pub-id><pub-id pub-id-type="pmid">12427852</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Vintch</surname> <given-names>B</given-names></name><name><surname>Zaharia</surname> <given-names>A</given-names></name><name><surname>Movshon</surname> <given-names>J</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>Efficient and direct estimation of a neural subunit model for sensory coding</chapter-title><source>Advances in Neural Information Processing Systems</source><publisher-name>MIT Press</publisher-name><fpage>3113</fpage><lpage>3121</lpage></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vintch</surname> <given-names>B</given-names></name><name><surname>Movshon</surname> <given-names>JA</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A convolutional subunit model for neuronal responses in macaque V1</article-title><source>Journal of Neuroscience</source><volume>35</volume><fpage>14829</fpage><lpage>14841</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2815-13.2015</pub-id><pub-id pub-id-type="pmid">26538653</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Volgushev</surname> <given-names>M</given-names></name><name><surname>Ilin</surname> <given-names>V</given-names></name><name><surname>Stevenson</surname> <given-names>IH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Identifying and tracking simulated synaptic inputs from neuronal firing: insights from in vitro experiments</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004167</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004167</pub-id><pub-id pub-id-type="pmid">25823000</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>F</given-names></name><name><surname>Machens</surname> <given-names>CK</given-names></name><name><surname>Borst</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Disentangling the functional consequences of the connectivity between optic-flow processing neurons</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>441</fpage><lpage>448</lpage><pub-id pub-id-type="doi">10.1038/nn.3044</pub-id><pub-id pub-id-type="pmid">22327473</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>A</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Capturing the dynamical repertoire of single neurons with generalized linear models</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1602.07389">https://arxiv.org/abs/1602.07389</ext-link></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williamson</surname> <given-names>RS</given-names></name><name><surname>Sahani</surname> <given-names>M</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The equivalence of information-theoretic and likelihood-based methods for neural dimensionality reduction</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004141</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004141</pub-id><pub-id pub-id-type="pmid">25831448</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williamson</surname> <given-names>RS</given-names></name><name><surname>Ahrens</surname> <given-names>MB</given-names></name><name><surname>Linden</surname> <given-names>JF</given-names></name><name><surname>Sahani</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Input-Specific gain modulation by local sensory context shapes cortical and thalamic responses to complex sounds</article-title><source>Neuron</source><volume>91</volume><fpage>467</fpage><lpage>481</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.05.041</pub-id><pub-id pub-id-type="pmid">27346532</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yates</surname> <given-names>JL</given-names></name><name><surname>Park</surname> <given-names>IM</given-names></name><name><surname>Katz</surname> <given-names>LN</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name><name><surname>Huk</surname> <given-names>AC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Functional dissection of signal and noise in MT and LIP during decision-making</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>1285</fpage><lpage>1292</lpage><pub-id pub-id-type="doi">10.1038/nn.4611</pub-id><pub-id pub-id-type="pmid">28758998</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.47012.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Palmer</surname><given-names>Stephanie</given-names></name><role>Reviewing Editor</role><aff><institution>University of Chicago</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This paper provides a bridge between traditional phenomenological models of neuronal spiking and more biophysically realistic models, by supplying a method to infer excitatory and inhibitory conductances directly from spiking data. This manuscript describes this new model, a conductance-based encoding model (CBEM), and adds a crucial stage in testing this type of biophysical modeling by direct comparison with intracellular data. The CBEM model is validated with spiking and conductance data measured in retinal ganglion cells. Excitatory and inhibitory conductances in both midget and parasol cells from the primate retina can be inferred reliably. The method has potential applications to other cell types beyond the retina and can provide more mechanistic insights into what drives spiking in the brain.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your work entitled &quot;Inferring synaptic inputs from spikes with a conductance-based neural encoding model&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by a Senior Editor. The reviewers have opted to remain anonymous.</p><p>All reviewers found this to be an interesting new model, and thought it is a useful tool for the computational neuroscience community to have. The manuscript was well-written and clear, but some major concerns about the broader impacts and applicability of the model were raised, as detailed below in the three individual reviews.</p><p><italic>Reviewer #1:</italic></p><p>This paper provides a bridge between traditional phenomenological LNP models and more biophysically realistic models, by supplying a method to infer excitatory and inhibitory conductances from spiking data. It is a well-reasoned and well-written account of this new model (CBEM) for computational neuroscience. The CBEM model is validated with a comparison to spiking and conductance data measured in retinal ganglion cells, and compares reasonably well to an LN model fit directly to the conductance data.</p><p>1) The biggest concern the current manuscript raises is: what important features of RGC encoding does the current model capture that a GLM cannot? Put another way, the new model explains more of the response variance of RGC cells, but what does that extra variance encode about the stimulus? What does this extra fitting power allow one to explain in terms of RGC computation? Can simulations be added that explore what aspects of stimulus encoding the full CBEM captures better than a GLM?</p><p>2) For the checkerboard stimuli (Figure 9), the GLM and CBEM models seem to have fairly comparable fits to the data. If these are the more interesting data to fit, how should one interpret the weaker additional explanatory power of the CBEM?</p><p>3) Some more discussion of the results of the model simulations of center-surround stimuli is needed. How do the observed spike rates compare to known RGC responses? The full CBEM model clearly makes different predictions about the spiking response to spatially correlated stimuli (particularly the inhibition of the sustained response). What aspects of RGC computation are captured by the full CBEM model compared to the excitation only CBEM or GLM for these kind of stimuli?</p><p>4) Some variations (dynamic gain adaptation, cascade nonlinearities) on LN models for RGC data can explain more of the observed spiking response to natural image sequences, but still fail to predict the majority of response variance. Several groups have shown that deep or recurrent neural nets can be fit to retinal data and explain about 30% more of this variance. How does a CBEM compare? It could potentially have a serious advantage over these NN models, both in the number of parameters and in interpretability. The absence of a fit to more complex stimuli, where LN models are known to fail spectacularly, stands out as a large hole in the current manuscript. Of course the points brought up in comment 1 apply here as well.</p><p><italic>Reviewer #2:</italic></p><p>This paper introduces a new point-process model applied to retinal ganglion cell data, which is based on model components that infer excitatory and inhibitory conductances to predict spikes. It uses a smorgasbord of data to demonstrate difference successes of this model (better performance over linear models, ability to explain some aspects of contrast adaptation), and has a number of mathematical derivations and some simulations to demonstrate how it works.</p><p>Overall, it is a mixture of what appears to be solid methods with some interesting results from combining them. However, I found this paper scattered, flipping between mathematical derivations, modeling results, and findings specific to the retina. This has the effect of not clearly tying down any element convincingly, nor clearly demonstrating novelty – or at least the need for the advances suggested in this paper.</p><p>1) If main purpose is to demonstrate a better way to model neurons (or perhaps just retinal ganglion cells), one would want to understand its generality, as well as how it compares to models of similar ilk, particularly phenomenological models of excitation/inhibition such as the Butts, 2011, 2016. There is a lot of overhead in computing the integration-properties of this model, and not clear what is gained over a more phenomenological LNLN cascade model. I see that it is possible there could be a lot to be gained from the CBEM, but the current manuscript does not make this clear.</p><p>Furthermore, what is the scope of this model. Do the authors expect this to be a more generally applicable method, or simply a means to model retinal ganglion cell responses? Under what conditions?</p><p>2) Relatedly, one wonders how important it is to model the conductances explicitly, versus membrane potential. Comparisons to membrane potential has been explored in several previous modeling approaches requiring only LN modeling (since there will not be two separate terms), including work of Priebe (Mohanty, 2012) in V1 and Demb (Zaghloul, 2005) in retina. More could be said about motivation for wanting to infer conductances past fitting data better. If the motivation is simply to fit data better, see #1 above.</p><p>3) The ability to explain adaptation to contrast as total-conductance changes seems interesting, but is only presented to the level of validating the model, and not explored. It is thus difficult to evaluate based on the extensive literature studying this in the retina.</p><p>4) Relatedly, the Cui et al., 2016 paper that was cited in this manuscript also posits excitation and inhibition, models recorded synaptic currents and spikes, and offers an explanation for contrast adaptation, but with a different model form. It seems worth more of a discussion here commenting on it. Could their proposed model explain these results? (and/or vice versa). Can one distinguish between their proposed circuit (presynaptic inhibition being dominant) and normal inhibition proposed here? Likewise, although not matching in content as much, Ozuysal and Baccus also model intracellular recordings and contrast adaptation, using yet another model form.</p><p>5) The derivations in the subsection “Background: Poisson GLM with spike history”, motivating the modeling, do not make a clear argument that the model goes beyond the phenomenological, given its overly restrictive assumptions (e.g., that E=-I). As soon as the GLM-based biophysical model is derived making explicit assumptions, it seems to say that these assumptions do not hold and defines the CBEM without them. Later data in the paper (and in previous papers) seem to invalidate these assumptions as well. If these assumptions do not hold, what is the purpose of deriving the model in this context?</p><p>6) It was very unclear the components of the various models and how they are fit to data, and I could not make sense until poring through the Materials and methods section. This was in part complicated by the use of different models in different figures (fit to different experiments), without a clear overarching structure. It might also be useful to compare and contrast the derived model forms to simpler phenomenological models of excitation/inhibition (see #1 above).</p><p>7) The subsection “Capturing spike responses to spatially varying stimuli” based on simulation had very confusing motivation and conclusions, and could be much better fit into the logical structure of the rest of the paper.</p><p><italic>Reviewer #3:</italic></p><p>The manuscript by Latimer et al., proposes a new model for analyzing single neurons under sensory stimulation. The model framework, here termed conductance-base encoding model (CBEM) is similar in spirit to the widely used generalized linear model (GLM), applying filters to integrate a sensory stimulus and a stochastic process to generate spikes. Also similar to the GLM approach, model parameters can be obtained from experimentally recorded spike trains by a maximum-likelihood approach. A conceptual advance of the CBEM, however, is that the model incorporates separate filters for excitatory and inhibitory inputs and that these inputs are treated as conductance changes of the neuron, providing an additional level of biological realism. The authors validate their approach by analyzing previously published data from parasol retinal ganglion cells recorded in primate retina. They show that the inferred conductances match intracellularly recorded conductances, and they show that their model improves predictions of spike trains to new data as compared to a GLM.</p><p>The manuscript presents an interesting and thought-provoking approach. The possibility of inferring features of excitatory and inhibitory input from recorded spike trains may be a great tool for investigating sensory processing. Also, the mathematical connections to the GLM, which are nicely drawn out in the manuscript, provide a good background for understanding how this model framework functions. In the present form, however, one concern is that it remains a bit unclear how directly applicable the model is to other systems or what sort of insights it may provide. I would imagine that a more general discussion of the applicability, limitations, and interpretation of the model, potentially supported by some additional example from data or simulations, would considerably strengthen the manuscript.</p><p>Essential revisions:</p><p>The successful inference of excitatory and inhibitory inputs is only shown for parasol cells under full-field stimulation. Here, the excitatory and inhibitory filters are nearly inverted with respect to each other, similar to the specific case discussed in the text where the conductance model can be mapped onto a GLM. Therefore, one wonders how the model performs when excitation and inhibition are correlated instead of anti-correlated or when their filters are (nearly) orthogonal to each other. Are correlated components of the inhibition as well recovered as uncorrelated (orthogonal) components, or will there be some bias?</p><p>The match of the inferred and measured conductance is impressive and suggests that this should work as a general technique to assess inhibitory input. However, it is not clear to me how the model would treat inhibitory signals that are not direct conductance inputs into the analyzed neuron. In the retina, for example, many circuits are also influenced by presynaptic inhibition, which acts on bipolar cell terminals. Should one expect that such inhibition is captures by the inhibition filter (because it is likely filtered differently than the direct excitatory pathway) or by the excitation filter (because it affects the excitatory conductance)?</p><p>Regarding the improvement of response predictions over the GLM, I'm wondering whether the differences in the applied nonlinearities play any role here. While the soft-threshold nonlinearities of the CBEM are backed up nicely by analyses, the exponential nonlinearity of the GLM could create problems in the quantitative predictions, especially for strong activation as is likely the case under full-field stimulation.</p><p>To emphasize the significance of the work, maybe the authors could point out more clearly how the method could be used for providing new insight into the investigated neurons. Is there a specific finding regarding the inputs into parasol cells derived from the present analysis that could serve as an example? Or maybe the authors could point out questions where the model framework might provide answers.</p><p>[Editors’ note: what now follows is the decision letter after the authors submitted for further consideration.]</p><p>Thank you for submitting your article &quot;Inferring synaptic inputs from spikes with a conductance-based neural encoding model&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Michael Frank as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>Essential revisions:</p><p>The reviews on this version of the manuscript were mixed, with some definite enthusiasm for the inclusion of the new midget cell data, but some remaining skepticism and questions about the presentation and generality of the current results. Several points need to be fully addressed for this manuscript to be accepted:</p><p>1) For the section on interpreting the GLM as a conductance-based model, and the biophysical motivation for the paper:</p><p>The model is set up to make some mathematical manipulations in order to remove the voltage dependence of the currents. That wasn't super clear on a first or second pass and should be made more accessible to the reader.</p><p>Other points to address for clarity and scholarship:a) There exists a common quasi-biophysical interpretation of the GLM, wherein the output of the linear stage is thought of as an approximation of the intracellular input or voltage. This interpretation requires (1) that E and I inputs are thought of as currents and sum linearly. Near threshold, this approximation might be decent for modeling spiking, as the voltage is ~constant. (2) the integration time of the neuron must be short enough that the response is mostly a function of the inputs, not on its own voltage history. With these constraints presumed satisfied, many previous studies over the years have assumed that the generating function of the GLM has a quasi-biophysical basis. Can this more standard derivation/interpretation be addressed in this manuscript? Does the explicit integration in the &quot;biophysical&quot; GLM detailed in this work (which addresses assumption 2 above) help in fitting neuronal spiking as compared to a standard GLM? No explicit comparisons are made in the manuscript, and should be added.</p><p>b) The derivations seem overly long to simply notice that ge(V-Ee) – gi(V-Ei) will have no voltage dependence if ge and gi cancel. This derivation might be difficult to follow for the broad readership of this journal and should be explained more clearly.</p><p>c) This should be reorganized so that it doesn't distract from subsequent results. It could be made more clear that the E = -I assumption is made only to connect this to the GLM-like model class, to motivate the model setup, and is relaxed in the subsequent CBEM inference scheme.</p><p>2) For the CBEM model setup, justification, and background:a) The GLM derivation is what is used to motivate the CBEM, and excitation and inhibition are rectified (Equation 10 compared with Equation 9). While the motivation for such rectification is that conductances must be non-negative, this seems somewhat misleading. In the retina, rectification of excitation and inhibition (where it exists) often comes from other sources, most notably non-linear synaptic release from bipolar cells (see Schwartz et al., 2012, Turner and Rieke, 2016, and Freeman, 2015), as well as the effect of amacrine cell processing, which often preserve or extend non-linear effects. While conductances cannot be negative (as the authors assert), the rectification in Equation 10 probably has other sources. This issue raises concerns about the motivation for the CBEM and should be addressed and clarified.</p><p>b) The model in its current form cannot capture any cell for which either excitation or inhibition is a non-monotonic function of contrast (i.e. any cell with ON-OFF excitation or ON-OFF inhibition). This applies to many other RGC types, and likely most visual neurons downstream in the brain. Please discuss this limitation more fully and argue for the generality of the model. How does this limit the general utility of this approach outside the retina? Can this model be used to infer a larger class of different contrast-response function shapes? That would certainly be impressive, but doesn't appear to be within the reach of the current model.</p><p>c) The advances of the CBEM over previous work on models with separate LN components for excitatory and inhibitory inputs needs to be more thoroughly reviewed, placing the CBEM in the context of this work and arguing for its particular advances.</p><p>d) Rectification of the inputs (Equation 10) is the basis of the LNLN cascade model used in many papers over the years, starting with the work of Shapley and Victor and Korenberg and Sakai (in 1970s and 80s). It has been explicitly incorporated in likelihood-based models of the retina and LGN in more recent years (Butts et al., 2011) and most recently in (Maheswaranathan et al., 2018). This includes models that explicitly model excitation and inhibition in the retina using nearly equivalent mathematical forms as used in the current manuscript.</p><p>The fact that previous models use spike trains to infer excitation and inhibition does seem to detract a bit from the novelty of the CBEM, if the manuscript does not demonstrate why the CBEM's particular form leads to better inference (certainly the validation with intracellular data here is key to drawing these conclusions and is understood as the main innovation in the paper). Answering the following questions would also provide more biological insight into the success of the CBEM: Is the CBEM's ability to match measured excitatory and inhibitory conductances a result of the integration of currents? The rectification of inputs? The difference between conductance and current?</p><p>e) What does the restriction that the conductances are non-noisy do to the CBEM in terms of the types of cellular computations it can and cannot reproduce? Are there particular biophysical effects (e.g. stim-dependent spiking noise) that will be missed via this constraint?</p><p>3) For a reader interested in applying the method, it will likely be important to get a better feeling for the applicability and interpretability of the data, in particular when no intracellular data are available for comparison.</p><p>a) Important questions are, for example, whether the method also works for non-white-noise stimuli and what may be limitations for the applicability of the method, or the interpretation of the obtained filters as corresponding to actual excitatory or inhibitory conductances. If no data are available, simulations and/or thoughtful discussion could help address these concerns.</p><p>b) As a specific example, Figure 10 shows that the inhibitory component can capture surround effects, at least for OFF parasol cells. But is it clear that this actually corresponds to inhibition received by the ganglion cell and not a representation of presynaptic inhibition that nonlinearly interacts with excitatory signals? (Presynaptic effects appear to form a major part of the surround in parasol cells, see, e.g., discussion in Turner, Schwartz and Rieke, 2018.)</p><p>c) The method currently uses an explicit model and parameters of the output nonlinearity that are obtained from intracellular data. For pure extracellular data, these parameters (or the shape of the nonlinearity) will not be known a priori. How does that affect the model fitting? Can the parameters of the output nonlinearity be included in the fitting procedure?</p><p>4) The results concerning contrast adaptation could be shortened or omitted. The CBEM does a bit better than a GLM, but really, both fail at contrast adaptation because one needs to model it explicitly, as has been done in many previous models, including papers cited in this manuscript from the Baccus group.</p><p>5) Existing approaches for inferring excitation and inhibition from spike trains are incorrectly labeled in the Introduction as LN modeling, and only briefly mentioned as alternative to the CBEM in the third paragraph of the discussion. This should be corrected, and the CBEM should be presented in this fuller context.</p><p>[Editors’ note: further revisions were suggested before acceptance.]</p><p>Thank you for resubmitting your work entitled &quot;Inferring synaptic inputs from spikes with a conductance-based neural encoding model&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Michael Frank (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>1) To clarify a bit first: The main model comparison that was sought after by the reviewers had the following aim: Explain how the inference of conductances here (i.e. the biophysical basis of the CBEM) is the key ingredient in successfully predicting the E/I values, as opposed to LNLN models, which have more general nonlinearities (as compared to the GLM's). The reviewers agree with you that the goal here is not to outperform other models per se, in terms of fitting performance or whatnot, but to add interpretable knowledge about the underlying biophysics. The prompt, then, from the reviewers is this: show more clearly and directly how the biophysical assumptions in the CBEM are crucial for getting this E/I estimation right, which allows for the proper interpretation of the model results; show that it's not just the fact that the CBEM (like LNLN models) has a more generalized form of nonlinearity built into it. Essentially, that one needs to model the biophysics in this more correct way to get the right interpretation out.</p><p>Here's the concern spelled out more explicitly:</p><p>If the CBEM is no better (at predicting the E/I inputs to a cell) than other LNLN models that simply have voltage-like, LN approximations of excitatory and inhibitory inputs, this means that the biophysics presented here is somewhat misleading (at least in the sense that it has to do with considering conductances), which is the current basis of the paper.</p><p>Additionally, any more-flexible LNLN models (with many subunits) -- now several in the literature – would actually outperform the CBEM because they can include multiple subunits, and model more general nonlinearities.</p><p>It is very possible that the more explicit model of the biophysics in the CBEM would do better and its particular structure is therefore an advance – but the manuscript does not show or address this directly.</p><p>There were certainly some things said about this in the response to reviewers, and more of that should be entered into the paper as well.</p><p>2) You had a question in the response to reviewers about references for the &quot;quasi-biophysical interpretation of the GLM&quot;. The Gerstner references are certainly great here, but please also cite (and if appropriate, discuss) Pillow et al., 2004 and 2005 (where the output of the linear term is explicitly treated as a voltage) and perhaps one of the more recent papers comparing GLM fits to intracellular data.</p><p>3) Please add a few more lines to the Discussion section outlining why you expect this model to be of broad utility beyond the retina. Specifically: what sorts of heuristics can a future user of the method employ to decide if the model's assumptions are appropriate for their data? Here, just saying a bit more to justify the breadth of the expected applicability of the model would be sufficient.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.47012.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the author responses to the first round of peer review follow.]</p><p>Reviewer #1:</p><disp-quote content-type="editor-comment"><p>This paper provides a bridge between traditional phenomenological LNP models and more biophysically realistic models, by supplying a method to infer excitatory and inhibitory conductances from spiking data. It is a well-reasoned and well-written account of this new model (CBEM) for computational neuroscience. The CBEM model is validated with a comparison to spiking and conductance data measured in retinal ganglion cells, and compares reasonably well to an LN model fit directly to the conductance data.</p><p>1) The biggest concern the current manuscript raises is: what important features of RGC encoding does the current model capture that a GLM cannot? Put another way, the new model explains more of the response variance of RGC cells, but what does that extra variance encode about the stimulus? What does this extra fitting power allow one to explain in terms of RGC computation? Can simulations be added that explore what aspects of stimulus encoding the full CBEM captures better than a GLM?</p></disp-quote><p>The CBEM can capture nonlinear response properties that arise from the interaction of excitatory and inhibitory conductance based inputs (which can give rise, for example to gain changes and changes in time constant), whereas the GLM is limited to a single filter, which assumes linear summation of excitatory and inhibitory inputs. In Figure 8 and Figure 10, we presented simulations showing that E‑I dependence leads to different predictions for contrast changes and center surround integration. We will extend these analyses to highlight how the CBEM’s conductances lead to these effects. More broadly, we would like to emphasize that we do not view the paper’s primary contribution as the fact that the CBEM “captures more response variance of RGC cells”. Rather, we think that the fact that it reveals intracellular conductances (verified with intracellular recordings) purely on the basis of spike times is the most important finding, and future application of our model. We will emphasize this primary motivation more clearly in our revision.</p><disp-quote content-type="editor-comment"><p>2) For the checkerboard stimuli (Figure 9), the GLM and CBEM models seem to have fairly comparable fits to the data. If these are the more interesting data to fit, how should one interpret the weaker additional explanatory power of the CBEM?</p></disp-quote><p>For these stimuli, the GLM does a fairly good job of fitting the data, and thus there isn't that much room for improvement. We note that even on natural scene data, the GLM can predict a large amount of the variance (for example, Batty et al., 2017). Despite the similar predictions to white noise, the CBEM predicts significant differences in responses to correlated stimuli.</p><disp-quote content-type="editor-comment"><p>3) Some more discussion of the results of the model simulations of center-surround stimuli is needed. How do the observed spike rates compare to known RGC responses? The full CBEM model clearly makes different predictions about the spiking response to spatially correlated stimuli (particularly the inhibition of the sustained response). What aspects of RGC computation are captured by the full CBEM model compared to the excitation only CBEM or GLM for these kind of stimuli?</p></disp-quote><p>The CBEM captures nonlinear center‑surround modulation that cannot be explained by a single linear filter. Additionally, in our simulations the interactions between inhibitory and excitatory inputs could produce more precise responses than predicted by the GLM or CBEM with only excitation.</p><disp-quote content-type="editor-comment"><p>4) Some variations (dynamic gain adaptation, cascade nonlinearities) on LN models for RGC data can explain more of the observed spiking response to natural image sequences, but still fail to predict the majority of response variance. Several groups have shown that deep or recurrent neural nets can be fit to retinal data and explain about 30% more of this variance. How does a CBEM compare? It could potentially have a serious advantage over these NN models, both in the number of parameters and in interpretability. The absence of a fit to more complex stimuli, where LN models are known to fail spectacularly, stands out as a large hole in the current manuscript. Of course the points brought up in comment 1 apply here as well.</p></disp-quote><p>Again, we apologize that we were not clearer about the primary contributions of our paper. As noted above, our goal is not simply to explain more variance, but to offer biological insights into what drives spiking in retinal ganglion cells. We offered the comparison to LN models and standard GLM as an “added bonus” that the CBEM also can provide a more accurate model of spiking. (Presumably this is because of the higher level of biological realism it achieves). However, the main point of our paper was not to produce a better R^2 value (although a higher R^2 is a consequence of better capturing of the synaptic input to the RGC), but to link purely phenomenological models to biology. We agree of course that applications to natural scenes are an important avenue for future research, and we hope that the CBEM will be provide a tool for studying neural responses obtained from such datasets.</p><p>Reviewer #2:</p><disp-quote content-type="editor-comment"><p>This paper introduces a new point-process model applied to retinal ganglion cell data, which is based on model components that infer excitatory and inhibitory conductances to predict spikes. It uses a smorgasbord of data to demonstrate difference successes of this model (better performance over linear models, ability to explain some aspects of contrast adaptation), and has a number of mathematical derivations and some simulations to demonstrate how it works.</p><p>Overall, it is a mixture of what appears to be solid methods with some interesting results from combining them. However, I found this paper scattered, flipping between mathematical derivations, modeling results, and findings specific to the retina. This has the effect of not clearly tying down any element convincingly, nor clearly demonstrating novelty – or at least the need for the advances suggested in this paper.</p><p>1) If main purpose is to demonstrate a better way to model neurons (or perhaps just retinal ganglion cells), one would want to understand its generality, as well as how it compares to models of similar ilk, particularly phenomenological models of excitation/inhibition such as the Butts, 2011, 2016. There is a lot of overhead in computing the integration-properties of this model, and not clear what is gained over a more phenomenological LNLN cascade model. I see that it is possible there could be a lot to be gained from the CBEM, but the current manuscript does not make this clear.</p><p>Furthermore, what is the scope of this model. Do the authors expect this to be a more generally applicable method, or simply a means to model retinal ganglion cell responses? Under what conditions?</p></disp-quote><p>We apologize — the main goal of our model is not a better model of RGCs in terms of spike rate prediction, but to tie phenomenological to biophysical models which include dynamics. The overhead of computing the integration is not actually that big: this is solved with a tri‑diagonal matrix operation which is computed in linear time. What we gain with this is a far more solid connection between our model and biophysical components of the neurons, than is achieved by a phenomenological model. We do however see the merit in including a comparison to the Nonlinear Interaction Model proposed in McFarland, Cui and Butts, (2013).</p><p>As with the GLM, we expect that this model may be useful in many sensory regions. The conditions that we expect this model to be useful under conditions that any cascade model might be useful.</p><disp-quote content-type="editor-comment"><p>2) Relatedly, one wonders how important it is to model the conductances explicitly, versus membrane potential. Comparisons to membrane potential has been explored in several previous modeling approaches requiring only LN modeling (since there will not be two separate terms), including work of Priebe (Mohanty, 2012) in V1 and Demb (Zaghloul, 2005) in retina. More could be said about motivation for wanting to infer conductances past fitting data better. If the motivation is simply to fit data better, see #1 above.</p></disp-quote><p>We apologize again for the confusion: we feel the problem of identifying the factors that govern spiking at an intracellular level are worthwhile in their own right (e.g., does an increase in spiking result from a decrease in inhibition or an increase in excitation). So the viewpoint that we take is not that “it is important to model the conductances explicitly in order to obtain a state‑of‑the‑art descriptive model of retinal spike responses”, but rather that identifying the separate excitatory and inhibitory inputs to neurons is an interesting scientific problem in its own right. We did in fact use an LN model, the GLM, as a basis of comparison throughout the paper; this would be practically equivalent to the reviewer’s suggestion of modeling the voltage as LN because our spike rate was a nonlinear function of voltage. There are situations for which the voltage can be modeled as a simple LN model, but such models do not capture cells' responses to all stimuli. We note that of course there are known features of RGC responses that cannot be captured with LN models, as the reviewer has pointed out in comments 1, 3, and 4.</p><disp-quote content-type="editor-comment"><p>3) The ability to explain adaptation to contrast as total-conductance changes seems interesting, but is only presented to the level of validating the model, and not explored. It is thus difficult to evaluate based on the extensive literature studying this in the retina.</p></disp-quote><p>Sorry, we are not sure we understand the reviewer's objection here. Because we are introducing the CBEM and presenting it broadly, we did not aim to explore the entire gamut of contrast adaptation experiments within one subsection of the results. However, we would like to extend the presentation in this section to include information on how the prediction distributions of excitation and inhibition depend on contrast.</p><disp-quote content-type="editor-comment"><p>4) Relatedly, the Cui et al., 2016 paper that was cited in this manuscript also posits excitation and inhibition, models recorded synaptic currents and spikes, and offers an explanation for contrast adaptation, but with a different model form. It seems worth more of a discussion here commenting on it. Could their proposed model explain these results? (and/or vice versa). Can one distinguish between their proposed circuit (presynaptic inhibition being dominant) and normal inhibition proposed here? Likewise, although not matching in content as much, Ozuysal and Baccus also model intracellular recordings and contrast adaptation, using yet another model form.</p></disp-quote><p>Cui et al., model did not define inhibitory and excitatory synaptic conductances in a biophysical model. Comparisons between our two methods is difficult because their work focused on capturing nonlinear effects of presynaptic inhibition in the mouse retina. We feel that exploring these specific nonlinear presynaptic inhibition is beyond the scope of our paper, but it would be interesting to explore in future work. We are familiar with the work of Ozuysal and Baccus, but would like to emphasize that work required intracellular recordings for model fitting — the main achievement of our work is that the model can be used to identify intracellular conductances despite being fit only spike trains; thus it can shed light on underlying biological mechanisms even when only extracellular recordings are available.</p><disp-quote content-type="editor-comment"><p>5) The derivations in the subsection “Background: Poisson GLM with spike history”, motivating the modeling, do not make a clear argument that the model goes beyond the phenomenological, given its overly restrictive assumptions (e.g., that E=-I). As soon as the GLM-based biophysical model is derived making explicit assumptions, it seems to say that these assumptions do not hold and defines the CBEM without them. Later data in the paper (and in previous papers) seem to invalidate these assumptions as well. If these assumptions do not hold, what is the purpose of deriving the model in this context?</p></disp-quote><p>Sorry, but we feel we did not explain this clearly enough. Our point was not to suggest that E=‑I is a good model for real neurons, but to offer a new interpretation for the classic GLM. (This connection to a biophysical model — albeit an unrealistic one — has not to our knowledge been proposed before). The idea of relaxing this overly restrictive constraint is the step that leads to our model, the CBEM.</p><p>The main point of our paper is to link phenomenological models to biophysical models. These derivations were only intended show a link between a commonly used statistical model of spiking (GLM) and a biophysical model to demonstrate the assumptions on biophysics placed by the GLM that are not obvious from the purely statistical presentation. We will clarify this motivation in the revision.</p><disp-quote content-type="editor-comment"><p>6) It was very unclear the components of the various models and how they are fit to data, and I could not make sense until poring through the Materials and methods section. This was in part complicated by the use of different models in different figures (fit to different experiments), without a clear overarching structure. It might also be useful to compare and contrast the derived model forms to simpler phenomenological models of excitation/inhibition (see #1 above).</p></disp-quote><p>We apologize for the difficulty in understanding our model. Our motivation for the paper’s organization was to isolate each biophysically interpretable component of the model and relate the component to quantities measures in the real retina. Our Materials and methods section is structured in accordance to each Results section and figure. Secondly, as we mentioned in our response to comment 1, we are willing to compare the CBEM with NIM, a phenomenological model with excitatory and suppressive units.</p><disp-quote content-type="editor-comment"><p>7) The subsection “Capturing spike responses to spatially varying stimuli” based on simulation had very confusing motivation and conclusions, and could be much better fit into the logical structure of the rest of the paper.</p></disp-quote><p>We are sorry this was not clear. The simulation attempts to demonstrate how the models differ in their predictions of center‑surround tuning (with a stimulus that wasn’t used in fitting) despite giving similar fits to noise data. We can provide additional information on the simulation work.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>[…] The manuscript presents an interesting and thought-provoking approach. The possibility of inferring features of excitatory and inhibitory input from recorded spike trains may be a great tool for investigating sensory processing. Also, the mathematical connections to the GLM, which are nicely drawn out in the manuscript, provide a good background for understanding how this model framework functions. In the present form, however, one concern is that it remains a bit unclear how directly applicable the model is to other systems or what sort of insights it may provide. I would imagine that a more general discussion of the applicability, limitations, and interpretation of the model, potentially supported by some additional example from data or simulations, would considerably strengthen the manuscript.</p><p>Essential revisions:</p><p>The successful inference of excitatory and inhibitory inputs is only shown for parasol cells under full-field stimulation. Here, the excitatory and inhibitory filters are nearly inverted with respect to each other, similar to the specific case discussed in the text where the conductance model can be mapped onto a GLM. Therefore, one wonders how the model performs when excitation and inhibition are correlated instead of anti-correlated or when their filters are (nearly) orthogonal to each other. Are correlated components of the inhibition as well recovered as uncorrelated (orthogonal) components, or will there be some bias?</p></disp-quote><p>We expect that the specific configuration of excitation and inhibition will matter. However, we have found in simulations that we can recover the conductance filters when inhibition is delayed, but not opposite, to excitation.</p><disp-quote content-type="editor-comment"><p>The match of the inferred and measured conductance is impressive and suggests that this should work as a general technique to assess inhibitory input. However, it is not clear to me how the model would treat inhibitory signals that are not direct conductance inputs into the analyzed neuron. In the retina, for example, many circuits are also influenced by presynaptic inhibition, which acts on bipolar cell terminals. Should one expect that such inhibition is captures by the inhibition filter (because it is likely filtered differently than the direct excitatory pathway) or by the excitation filter (because it affects the excitatory conductance)?</p></disp-quote><p>Presynaptic inhibition is an interesting effect (as noted by reviewer 2 in reference to Cui et al., 2016 which looked at such computations in the mouse retina). However, we believe these effects are beyond the scope of the current paper, but we would like to explore more complicated nonlinear effects in the future.</p><disp-quote content-type="editor-comment"><p>Regarding the improvement of response predictions over the GLM, I'm wondering whether the differences in the applied nonlinearities play any role here. While the soft-threshold nonlinearities of the CBEM are backed up nicely by analyses, the exponential nonlinearity of the GLM could create problems in the quantitative predictions, especially for strong activation as is likely the case under full-field stimulation.</p></disp-quote><p>We found that the GLM performed very poorly with the soft‑rectified nonlinearity for these cells (as was also reported in Pillow et al., 2008). We have made sure to mention this. We also emphasize that the choice of the CBEM’s nonlinearity was by matching voltage to spike rate, and not to maximize the performance of spike rate predictions in response to a stimulus.</p><disp-quote content-type="editor-comment"><p>To emphasize the significance of the work, maybe the authors could point out more clearly how the method could be used for providing new insight into the investigated neurons. Is there a specific finding regarding the inputs into parasol cells derived from the present analysis that could serve as an example? Or maybe the authors could point out questions where the model framework might provide answers.</p></disp-quote><p>Our method provides a quantitative framework to combine different measures of neural activity that cannot be simultaneously measured. In the array recordings we analyzed, we had access to far more data than with intracellular recordings, but we could only observe spikes.</p><p>The gain control section of our paper showed that independent excitation and inhibition can capture some of the contrast adaptation observed in RGCs. Because multiple mechanisms contribute to contrast adaptation, this affect could not easily be quantified without a model.</p><p>[Editors' note: the author responses to the re-review follow.]</p><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The reviews on this version of the manuscript were mixed, with some definite enthusiasm for the inclusion of the new midget cell data, but some remaining skepticism and questions about the presentation and generality of the current results. Several points need to be fully addressed for this manuscript to be accepted:</p><p>1) For the section on interpreting the GLM as a conductance-based model, and the biophysical motivation for the paper:</p><p>The model is set up to make some mathematical manipulations in order to remove the voltage dependence of the currents. That wasn't super clear on a first or second pass and should be made more accessible to the reader.</p></disp-quote><p>We apologize for the confusion. We have revised this section to make clearer that the goal here was to achieve voltage independence. The revised text reads:</p><p>“Here we propose a novel biophysically realistic interpretation of the classic Poisson GLM as a dynamical model with conductance-based input. In brief, this involves writing the GLM as a conductance-based model with excitatory and inhibitory conductances governed by affine functions of the stimulus, but constrained so that total conductance is fixed. This removes voltage-dependence of the membrane currents, making the membrane potential itself an affine function of the stimulus.</p><p>The remainder of this section lays out the mathematical details of this interpretation explicitly.”</p><disp-quote content-type="editor-comment"><p>Other points to address for clarity and scholarship:</p><p>a) There exists a common quasi-biophysical interpretation of the GLM, wherein the output of the linear stage is thought of as an approximation of the intracellular input or voltage. This interpretation requires (1) that E and I inputs are thought of as currents and sum linearly. Near threshold, this approximation might be decent for modeling spiking, as the voltage is ~constant. (2) the integration time of the neuron must be short enough that the response is mostly a function of the inputs, not on its own voltage history. With these constraints presumed satisfied, many previous studies over the years have assumed that the generating function of the GLM has a quasi-biophysical basis. Can this more standard derivation/interpretation be addressed in this manuscript? Does the explicit integration in the &quot;biophysical&quot; GLM detailed in this work (which addresses assumption 2 above) help in fitting neuronal spiking as compared to a standard GLM? No explicit comparisons are made in the manuscript, and should be added.</p></disp-quote><p>We thank the reviewers for this comment, and we apologize if we have failed to cite relevant literature about interpretations of the Poisson GLM. We have cited Plesser and Gerstner, 2000 (which first described the “escape rate” approximation to noisy integrate-and-fire as an LN neuron), as well as work from Gerstner on the spike-response model. We are not familiar however with other previous work interpreting the GLM as having a biophysical basis (e.g. in terms of E and I current inputs that sum linearly). If the reviewers wouldn’t mind clarifying which references they are referring to, we would be grateful for the opportunity to add citations and discuss the relationship to previous work more clearly.</p><p>We did not fully understand the comment about a lack of explicit comparisons, as we did indeed compare the “conductance based model” (CBEM) to the standard Poisson GLM in Figure7, Figure 8, Figure 10 and Figure 11. Was there another comparison the reviewers would have liked to see? We apologize if we have misunderstood.</p><p>We have updated the discussion of these previous interpretations that was included in subsection “Background: Poisson GLM with spike history”. We now state that this interpretation assumes a current-based input rather than conductance based. The biophysical interpretation of the GLM offered in subsection “Interpreting the GLM as a conductance-based model”, unfortunately does not affect the fits data, as it is mathematically equivalent. (We have sought to emphasize that it is a new interpretation, not a new model).</p><disp-quote content-type="editor-comment"><p>b) The derivations seem overly long to simply notice that ge(V-Ee) – gi(V-Ei) will have no voltage dependence if ge and gi cancel. This derivation might be difficult to follow for the broad readership of this journal and should be explained more clearly.</p></disp-quote><p>We thank the reviewers for this comment. We have now added a summary(“In brief,…”, subsection “Interpreting the GLM as a conductance-based model”), which attempts to summarize the idea so that reviewers who are not interested in the detailed derivation can skip the remainder of the section. We have also shortened and simplified the derivation itself, as we agree with the reviewer that the section was overly long; although we still wish to make clear exactly how to relate the GLM filter k_glm defined in the previous section to the linear conductance filter “k” that we introduced in our interpretation. We hope the revised derivation will be simpler and easier to understand.</p><disp-quote content-type="editor-comment"><p>c) This should be reorganized so that it doesn't distract from subsequent results. It could be made more clear that the E = -I assumption is made only to connect this to the GLM-like model class, to motivate the model setup, and is relaxed in the subsequent CBEM inference scheme.</p></disp-quote><p>Thanks for the suggestion. We have reiterated that this assumption is only to construct a GLM at the start of both the subsection “Interpreting the GLM as a conductance-based model” and subsection “The conductance-based encoding model (CBEM)”.</p><disp-quote content-type="editor-comment"><p>2) For the CBEM model setup, justification, and background:a) The GLM derivation is what is used to motivate the CBEM, and excitation and inhibition are rectified (eq 10 compared with eq 9). While the motivation for such rectification is that conductances must be non-negative, this seems somewhat misleading. In the retina, rectification of excitation and inhibition (where it exists) often comes from other sources, most notably non-linear synaptic release from bipolar cells (see Schwartz et al., 2012, Turner and Rieke, 2016, and Freeman, 2015), as well as the effect of amacrine cell processing, which often preserve or extend non-linear effects. While conductances cannot be negative (as the authors assert), the rectification in Equation 10 probably has other sources. This issue raises concerns about the motivation for the CBEM and should be addressed and clarified.</p></disp-quote><p>Thanks for this suggestion. We have clarified that our nonlinearity is primarily aimed at accounting for synaptic thresholding/nonlinearities, instead of just enforcing positive conductances. This is included where we introduce the soft-rectified nonlinearity for RGC data (subsection: Validating the CBEM modeling assumptions with intracellular data”).</p><disp-quote content-type="editor-comment"><p>b) The model in its current form cannot capture any cell for which either excitation or inhibition is a non-monotonic function of contrast (i.e. any cell with ON-OFF excitation or ON-OFF inhibition). This applies to many other RGC types, and likely most visual neurons downstream in the brain. Please discuss this limitation more fully and argue for the generality of the model. How does this limit the general utility of this approach outside the retina? Can this model be used to infer a larger class of different contrast-response function shapes? That would certainly be impressive, but doesn't appear to be within the reach of the current model.</p></disp-quote><p>Our code allows for an arbitrary set of conductances with different nonlinear functions. However, adding more conductances with more nonlinearities makes fitting more challenging. Future work with additional experiments (which are beyond the scope of this current manuscript) would be needed to test how the model can estimate ON-OFF inhibition or excitation. The discussion now reads “For instance, the CBEM's linear-rectified conductance does not capture the non-monotonic portions of the stimulus-conductance nonlinearities observed in the data”</p><disp-quote content-type="editor-comment"><p>c) The advances of the CBEM over previous work on models with separate LN components for excitatory and inhibitory inputs needs to be more thoroughly reviewed, placing the CBEM in the context of this work and arguing for its particular advances.</p><p>d) Rectification of the inputs (Equation 10) is the basis of the LNLN cascade model used in many papers over the years, starting with the work of Shapley and Victor and Korenberg and Sakai (in 1970s and 80s). It has been explicitly incorporated in likelihood-based models of the retina and LGN in more recent years (Butts et al., 2011) and most recently in (Maheswaranathan et al., 2018). This includes models that explicitly model excitation and inhibition in the retina using nearly equivalent mathematical forms as used in the current manuscript.</p><p>The fact that previous models use spike trains to infer excitation and inhibition does seem to detract a bit from the novelty of the CBEM, if the manuscript does not demonstrate why the CBEM's particular form leads to better inference (certainly the validation with intracellular data here is key to drawing these conclusions and is understood as the main innovation in the paper). Answering the following questions would also provide more biological insight into the success of the CBEM: Is the CBEM's ability to match measured excitatory and inhibitory conductances a result of the integration of currents? The rectification of inputs? The difference between conductance and current?</p></disp-quote><p>We thank the reviewers for this comment and suggestions which will help make our specific contributions much more clear within the context of existing literature in the revised manuscript. We have provided additional discussion of the relationship between CBEM and previous work with LNLN cascade models, some of which include functionally suppressive units in the Introduction and Discussion section. We have added clarifications to explain that our approach adds on these previous approaches by comparing the model components identified from spike trains to conductances measured in the same cells (Introduction and Discussion section), which to our knowledge has not been performed in previous modeling exercises. Comparing the model’s predictions specifically to excitatory and inhibitory inputs is a primary goal of our work because phenomenological models may combine inputs from amacrine and bipolar cells into common input channels (as described by Maheswaranathan et al., mentioned by the reviewer) and functionally suppressive units may not correspond to the actual inhibition received by the cell. Moreover, our approach takes the additional step of using a biophysical framework, but instead of being defined purely as an LNLN phenomenological model. Thus, our modeling approach may provide a superior tool to combine quantitative biophysical measurements of cells and circuits with measurement of stimulus encoding.</p><disp-quote content-type="editor-comment"><p>e) What does the restriction that the conductances are non-noisy do to the CBEM in terms of the types of cellular computations it can and cannot reproduce? Are there particular biophysical effects (e.g. stim-dependent spiking noise) that will be missed via this constraint?</p></disp-quote><p>This is an excellent point. Without correlations in the two channels, we cannot predict the coding benefits of correlations observed in Cafaro and Rieke, (2010). We have included this in the Discussion section as a possible direction for future research.</p><disp-quote content-type="editor-comment"><p>3) For a reader interested in applying the method, it will likely be important to get a better feeling for the applicability and interpretability of the data, in particular when no intracellular data are available for comparison.</p></disp-quote><p>We thank the reviewers for this suggestion. We have added text discussing the applicability of the CBEM to the Discussion section. Primarily, we believe that the model can be applied when the inputs to a cell are assumed to be approximately linear (or a linearized approximation is assumed through a model; for example, a model V1 as an input to MT).</p><disp-quote content-type="editor-comment"><p>a) Important questions are, for example, whether the method also works for non-white-noise stimuli and what may be limitations for the applicability of the method, or the interpretation of the obtained filters as corresponding to actual excitatory or inhibitory conductances. If no data are available, simulations and/or thoughtful discussion could help address these concerns.</p></disp-quote><p>Thanks for this comment, yes — the method makes no assumptions about Gaussiannity or whiteness of the stimulus. The applicability of our model to non-white noise stimuli is similar to other statistical methods fit by maximum likelihood MAP, because these tools do not rely on STA or STC features. GLMs and neural network models have been successfully fit using naturalistic stimuli.</p><disp-quote content-type="editor-comment"><p>b) As a specific example, Figure 10 shows that the inhibitory component can capture surround effects, at least for OFF parasol cells. But is it clear that this actually corresponds to inhibition received by the ganglion cell and not a representation of presynaptic inhibition that nonlinearly interacts with excitatory signals? (Presynaptic effects appear to form a major part of the surround in parasol cells, see, e.g., discussion in Turner, Schwartz and Rieke, 2018.)</p></disp-quote><p>We appreciate the reviewer’s comment, but we have considered the treatment of pre-synaptic inhibition beyond the scope of this manuscript. However, we are hoping to explore this more thoroughly in future work. Currently, our model only considers independent excitatory and inhibitory signals. We have made sure to better address this point in the Discussion section.</p><disp-quote content-type="editor-comment"><p>c) The method currently uses an explicit model and parameters of the output nonlinearity that are obtained from intracellular data. For pure extracellular data, these parameters (or the shape of the nonlinearity) will not be known a priori. How does that affect the model fitting? Can the parameters of the output nonlinearity be included in the fitting procedure?</p></disp-quote><p>We could fit these parameters in our optimization. We have run some model fits using a wider range of output nonlinearity parameters and found that this did not strongly impact our ability to predict excitatory and inhibitory tuning. Thus, we would caution against making conclusions about the spike nonlinearity that rest on a single setting of those output parameters in the extracellular setting. Instead, we would argue in favor of considering the range output nonlinearity parameters that are consistent with the data (similar to the work of Prinz and Marder), perhaps within a Bayesian framework.</p><disp-quote content-type="editor-comment"><p>4) The results concerning contrast adaptation could be shortened or omitted. The CBEM does a bit better than a GLM, but really, both fail at contrast adaptation because one needs to model it explicitly, as has been done in many previous models, including papers cited in this manuscript from the Baccus group.</p></disp-quote><p>We apologize but we do not fully understand what the reviewer means by the claim that the models fail at contrast adaptation. We appreciate the reviewers’ concerns and we have edited this section to make the limitations of our work more clear. We have better emphasized that we are not attempting to model all aspects of adaptation, but that our test is aimed only to determine to what extent adaptation can be predicted from the fixed LN conductances alone. Additionally, our model does a fair job at predicting gain change across contrast levels. We have added a citation to the recently published modeling work by Ozuysal, Kastner and Baccus, (2018) who concluded that “differences in synaptic threshold in the two pathways” was the primary source of adaptation in their study.</p><disp-quote content-type="editor-comment"><p>5) Existing approaches for inferring excitation and inhibition from spike trains are incorrectly labeled in the Introduction as LN modeling, and only briefly mentioned as alternative to the CBEM in the third paragraph of the discussion. This should be corrected, and the CBEM should be presented in this fuller context.</p></disp-quote><p>We apologize for this oversight, and have rephrased this paragraph to emphasize that we are referring more generally to the cascade model class (to which all these models belong), not just LN. Additionally, we have also elaborated in the final paragraph of the Introduction how the CBEM compares to the cascade models (LNLN models) the reviewer mentions in terms of excitatory and inhibitory conductance estimation.</p><p>[Editors' note: further revisions were suggested before acceptance.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>1) To clarify a bit first: The main model comparison that was sought after by the reviewers had the following aim: Explain how the inference of conductances here (i.e. the biophysical basis of the CBEM) is the key ingredient in successfully predicting the E/I values, as opposed to LNLN models, which have more general nonlinearities (as compared to the GLM's). The reviewers agree with you that the goal here is not to outperform other models per se, in terms of fitting performance or whatnot, but to add interpretable knowledge about the underlying biophysics. The prompt, then, from the reviewers is this: show more clearly and directly how the biophysical assumptions in the CBEM are crucial for getting this E/I estimation right, which allows for the proper interpretation of the model results; show that it's not just the fact that the CBEM (like LNLN models) has a more generalized form of nonlinearity built into it. Essentially, that one needs to model the biophysics in this more correct way to get the right interpretation out.</p><p>Here's the concern spelled out more explicitly:</p><p>If the CBEM is no better (at predicting the E/I inputs to a cell) than other LNLN models that simply have voltage-like, LN approximations of excitatory and inhibitory inputs, this means that the biophysics presented here is somewhat misleading (at least in the sense that it has to do with considering conductances), which is the current basis of the paper.</p><p>Additionally, any more-flexible LNLN models (with many subunits) -- now several in the literature – would actually outperform the CBEM because they can include multiple subunits, and model more general nonlinearities.</p><p>It is very possible that the more explicit model of the biophysics in the CBEM would do better and its particular structure is therefore an advance – but the manuscript does not show or address this directly.</p><p>There were certainly some things said about this in the response to reviewers, and more of that should be entered into the paper as well.</p></disp-quote><p>We have made clarifications to the Discussion section to clarify that we believe more flexible LNLN models could help in extending the CBEM (see comment 3). The specific aims of the CBEM are primarily that simple biophysical assumptions leads to an accurate prediction of RGC synaptic input tuning with the CBEM (points which have not been directly testing with LNLN models), and we made sure that the paper did not make claims that one must model biophysics.</p><p>However, we admit that we are a bit confused by the request to show that the CBEM that our biophysical assumptions are crucial, or that CBEM is better at predicting conductances than other LNLN models. There simply are no models that we are aware of that have sought to predict conductances before!</p><p>Note that our paper does <italic>not</italic> represent a classic machine learning approach, where you take a bunch of stimuli and a bunch of voltage data and train a network to approximate the mapping from one to the other. In our paper, we take a stimuli and recorded spike-trains and learn a model to predict the <italic>membrane potential</italic> that underlay those spikes. So to ask, “does it achieve better voltage prediction than an LNLN model that accurately predicts firing rate?” seems like a non non-sequitur to us. It would be like asking how well a network that predicts MNIST digits can predict the labels of ImageNet images. (Such a model can’t, because it doesn’t even have the right output capability to do so!) Similarly, for our model: there are two conductances at any time point (exc and inh) whereas an LNLN model predicting spike rate has only one output.</p><p>But please forgive us if we have misunderstood something. Our view is that — while other models might reasonably be adapted to the prediction of conductances from spike train recordings, using either ours or different assumptions about the underlying biology — that is very much hypothetical “future work” that has not yet been carried out, and so is not a benchmark we aim for in this manuscript.</p><p>We are grateful for the feedback, nonetheless, as it clarifies some of the confusion the reviewers may have had with our paper. We have tried to revise the Discussion section to clarify that, while more flexible ML approaches may give better spike prediction, our model seeks an explicit link to biological processes which we confirmed using intracellular data (Discussion section). We also suggest some future avenues along which the two approaches (the CBEM and LNLN or deep learning models) might be fruitfully combined to achieve even better models for conductance prediction. (See Discussion section).</p><disp-quote content-type="editor-comment"><p>2) You had a question in the response to reviewers about references for the &quot;quasi-biophysical interpretation of the GLM&quot;. The Gerstner references are certainly great here, but please also cite (and if appropriate, discuss) Pillow et al., 2004 and 2005 (where the output of the linear term is explicitly treated as a voltage) and perhaps one of the more recent papers comparing GLM fits to intracellular data.</p></disp-quote><p>Thanks for the suggestion. We have made sure to discuss these references to the stochastic LIF models from Pillow et al., 2004 and 2005 to mention that those references assume the input is a current-based, linear function of the stimulus (subsection “Background: Poisson GLM with spike history”).</p><disp-quote content-type="editor-comment"><p>3) Please add a few more lines to the Discussion section outlining why you expect this model to be of broad utility beyond the retina. Specifically: what sorts of heuristics can a future user of the method employ to decide if the model's assumptions are appropriate for their data? Here, just saying a bit more to justify the breadth of the expected applicability of the model would be sufficient.</p></disp-quote><p>We have included a much more detailed discussion on the utility of the CBEM and provided recommendations for future applications (Discussion section).</p></body></sub-article></article>