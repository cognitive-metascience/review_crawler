<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">34862</article-id><article-id pub-id-type="doi">10.7554/eLife.34862</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Shearing in flow environment promotes evolution of social behavior in microbial populations</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-95147"><name><surname>Uppal</surname><given-names>Gurdip</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3957-256X</contrib-id><email>guppal@nd.edu</email><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-98678"><name><surname>Vural</surname><given-names>Dervis Can</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0495-8086</contrib-id><email>dvural@nd.edu</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution content-type="dept">Department of Physics</institution><institution>University of Notre Dame</institution><addr-line><named-content content-type="city">Notre Dame</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-6428"><name><surname>Gore</surname><given-names>Jeff</given-names></name><role>Reviewing Editor</role><aff id="aff2"><institution>Massachusetts Institute of Technology</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>22</day><month>05</month><year>2018</year></pub-date><pub-date pub-type="collection"><year>2018</year></pub-date><volume>7</volume><elocation-id>e34862</elocation-id><history><date date-type="received" iso-8601-date="2018-01-15"><day>15</day><month>01</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2018-05-10"><day>10</day><month>05</month><year>2018</year></date></history><permissions><copyright-statement>© 2018, Uppal et al</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Uppal et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-34862-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.34862.001</object-id><p>How producers of public goods persist in microbial communities is a major question in evolutionary biology. Cooperation is evolutionarily unstable, since cheating strains can reproduce quicker and take over. Spatial structure has been shown to be a robust mechanism for the evolution of cooperation. Here we study how spatial assortment might emerge from native dynamics and show that fluid flow shear promotes cooperative behavior. Social structures arise naturally from our advection-diffusion-reaction model as self-reproducing Turing patterns. We computationally study the effects of fluid advection on these patterns as a mechanism to enable or enhance social behavior. Our central finding is that flow shear enables and promotes social behavior in microbes by increasing the group fragmentation rate and thereby limiting the spread of cheating strains. Regions of the flow domain with higher shear admit high cooperativity and large population density, whereas low shear regions are devoid of life due to opportunistic mutations.</p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.34862.002</object-id><title>eLife digest</title><p>According to the principle of the ‘survival of the fittest’, selfish individuals should be better off compared to peers that cooperate with each other. Indeed, even though a population of organisms benefits from working together, selfish members can exploit the cooperative behavior of others without doing their part. These ‘cheaters’ then use their advantage to reproduce faster and take over the population.</p><p>Yet, social cooperation is widespread in the natural world, and occurs in creatures as diverse as bacteria and whales. How can it arise and persist then? One idea is that when individuals form distinct groups, the ones with cheaters will perish. Even though a selfish individual will fare better than the rest of its team, overall, cooperating groups will survive more and reproduce faster; ultimately, they will be favored by evolution. This is called group selection.</p><p>Here, Uppal and Vural examine how the physical properties of the environment can influence the evolution of social interactions between bacteria. To this end, mathematical models are used to simulate how bacteria grow, evolve and drift in a flowing fluid. These are based on equations worked out from the behavior of real-life populations.</p><p>The results show that flow patterns in a fluid habitat govern the social behavior of bacteria. When different regions of the fluid are moving at different speeds, ‘shear forces’ are created that cause bacterial colonies to distort and occasionally break apart to form two groups. As such, cooperative groups will rapidly form new cooperating colonies, whereas groups with cheaters will reproduce slower or perish.</p><p>Furthermore, results show that when different areas of the fluid have different shear forces, social cooperation will only prevail in certain places. This makes it possible to use flow patterns to fine tune social evolution so that cooperating bacteria will be confined in a certain region. Outside of this area, these bacteria would be taken over by cheaters and go extinct.</p><p>Bacteria are both useful and dangerous to humans: for example, certain species can break down pollutants in the water, when others cause deadly infections. These results show it could be possible to control the activity of these microorganisms to our advantage by changing the flow of the fluids in which they live. More broadly, the simulations developed by Uppal and Vural can be applied to a variety of ecosystems where microscopic organisms inhabit fluids, such as plankton flowing in oceanic currents.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>ecological pattern formation</kwd><kwd>fluid dynamics</kwd><kwd>evolutionary dynamics</kwd><kwd>shear flows</kwd><kwd>self organization</kwd><kwd>microbial growth</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000185</institution-id><institution>Defense Advanced Research Projects Agency</institution></institution-wrap></funding-source><award-id>Contract No. HR0011-16-C0062</award-id><principal-award-recipient><name><surname>Vural</surname><given-names>Dervis</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Shearing in fluid flow induces or enhances budding dispersal in microbial populations, resulting in stronger cooperative behavior.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Cooperation is the cement of biological complexity. A combined investment brings larger returns. However, while cooperating populations are fitter, individuals have evolutionary incentive to cheat by taking advantage of available public goods without contributing their own. Avoiding the cost of these goods allow larger reproduction rates, causing cheaters to proliferate until the lack of public goods compromise the fitness of the entire population. In other words, while cooperating populations are fitter than non–cooperating ones, cooperation is not evolutionarily stable. How then can social behavior emerge and persist in microbial colonies?</p><p>The evolution of cooperation is an active field of research, with multiple theories resolving this dilemma (<xref ref-type="bibr" rid="bib4">Axelrod and Hamilton, 1981</xref>; <xref ref-type="bibr" rid="bib53">Sachs et al., 2004</xref>; <xref ref-type="bibr" rid="bib54">Sachs and Simms, 2006</xref>; <xref ref-type="bibr" rid="bib47">Nowak, 2006</xref>). According to (<xref ref-type="bibr" rid="bib18">Fletcher and Doebeli, 2009</xref>) the fundamental mechanism is assortment. That is, in order for cooperation to evolve, cooperators and cheaters must experience different interaction environments.</p><p>How this assortment is achieved is a central question. Possibilities include positive and negative reciprocity (<xref ref-type="bibr" rid="bib66">Trivers, 1971</xref>; <xref ref-type="bibr" rid="bib11">Clutton-Brock and Parker, 1995</xref>; <xref ref-type="bibr" rid="bib17">El Mouden et al., 2010</xref>), where cooperators are rewarded later by others, or where cheaters are inflicted a cost, via policing or reputation. For example, quorum signals reveal whether available public goods add up to the population density. In this case, altruists cut back public good production to eliminate cheaters (albeit with collateral damage) (<xref ref-type="bibr" rid="bib2">Allen et al., 2016</xref>; <xref ref-type="bibr" rid="bib55">Sandoz et al., 2007</xref>; <xref ref-type="bibr" rid="bib12">Diggle et al., 2007</xref>). Another idea is group selection (<xref ref-type="bibr" rid="bib77">Wynne-Edwards, 1962</xref>; <xref ref-type="bibr" rid="bib23">Haldane, 1932</xref>; <xref ref-type="bibr" rid="bib65">Traulsen and Nowak, 2006</xref>; <xref ref-type="bibr" rid="bib75">Wilson, 1975</xref>) and its modern incarnation, multi-level selection, (<xref ref-type="bibr" rid="bib74">Wilson and Sober, 1994</xref>) which propose that cooperating groups (or groups of groups) will reproduce faster than non-cooperating ones and prevail. Kin-selection theory (<xref ref-type="bibr" rid="bib24">Hamilton, 1964a</xref>, <xref ref-type="bibr" rid="bib25">1964b</xref>; <xref ref-type="bibr" rid="bib72">Williams, 1966</xref>; <xref ref-type="bibr" rid="bib59">Smith, 1964</xref>; <xref ref-type="bibr" rid="bib26">Hamilton, 1975</xref>; <xref ref-type="bibr" rid="bib37">Lion et al., 2011</xref>) provides a mechanism that arises from individual level dynamics. Kin-selection proposes that individuals cooperate with those to which they are genetically related, and thus, a cooperative genotype is really cooperating with itself.</p><p>Hamilton conjectured that kin selection should promote cooperation if the population is viscous, that is when the mobility of the population is limited (<xref ref-type="bibr" rid="bib24">Hamilton, 1964a</xref>; <xref ref-type="bibr" rid="bib25">Hamilton, 1964b</xref>). This helps ensure that genetically related individuals cooperate with each other. However, competition within kin can inhibit altruism (<xref ref-type="bibr" rid="bib62">Taylor, 1992</xref>; <xref ref-type="bibr" rid="bib73">Wilson et al., 1992</xref>). One solution to this is if individuals disperse as groups, also known as budding dispersal. This was shown to promote cooperation theoretically by <xref ref-type="bibr" rid="bib19">Gardner and West (2006)</xref> and demonstrated experimentally by (<xref ref-type="bibr" rid="bib34">Kümmerli et al., 2009</xref>). Budding dispersal has also been studied by (<xref ref-type="bibr" rid="bib50">Pollock, 1983</xref>; <xref ref-type="bibr" rid="bib22">Goodnight, 1992</xref>; <xref ref-type="bibr" rid="bib30">Kelly, 1994</xref>) and by (<xref ref-type="bibr" rid="bib73">Wilson et al., 1992</xref>) from a group selection perspective.</p><p>There may be multiple and overlapping mechanisms underlying assortment. There is much debate in the literature over which theories best explain the evolution of cooperation and under which conditions each theory may be applicable. There is still not agreement, for example, on whether kin-selection and group selection can be viewed as equivalent theories (<xref ref-type="bibr" rid="bib37">Lion et al., 2011</xref>; <xref ref-type="bibr" rid="bib33">Kramer and Meunier, 2016</xref>). According to (<xref ref-type="bibr" rid="bib57">Simon et al., 2012</xref>; <xref ref-type="bibr" rid="bib58">Simon et al., 2013</xref>), since relatedness need not impact certain group level selection events, such as various games between groups, group selection is distinct from kin selection. Also, individual and group level selection events are generally asynchronous in nature and therefore cannot be equivalent. However, the debate still goes on (<xref ref-type="bibr" rid="bib33">Kramer and Meunier, 2016</xref>; <xref ref-type="bibr" rid="bib71">West et al., 2007</xref>; <xref ref-type="bibr" rid="bib20">Gardner, 2015</xref>; <xref ref-type="bibr" rid="bib21">Goodnight, 2015</xref>).</p><p>Typically, evolution of cooperation is quantitatively analyzed with the aid of game theoretic models applied to well-mixed populations, networks and other phenomenological spatial structures (<xref ref-type="bibr" rid="bib60">Szabó and Fáth, 2007</xref>; <xref ref-type="bibr" rid="bib1">Allen et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Nowak and Sigmund, 2004</xref>; <xref ref-type="bibr" rid="bib68">Vural et al., 2015</xref>). While there are few models that take into account spatial proximity effects, (<xref ref-type="bibr" rid="bib39">Medvinsky et al., 2002</xref>; <xref ref-type="bibr" rid="bib43">Nadell et al., 2010</xref>; <xref ref-type="bibr" rid="bib42">Nadell et al., 2013</xref>; <xref ref-type="bibr" rid="bib13">Dobay et al., 2014</xref>; <xref ref-type="bibr" rid="bib15">Driscoll and Pepper, 2010</xref>) and the influence of decay and diffusion of public goods (<xref ref-type="bibr" rid="bib13">Dobay et al., 2014</xref>; <xref ref-type="bibr" rid="bib70">Wakano et al., 2009</xref>; <xref ref-type="bibr" rid="bib27">Hauert et al., 2008</xref>), how advective fluid flow influences social evolution remains mostly unexplored. The present study aims to fill this gap.</p><p>A flowing habitat can have a drastic effect on population dynamics (<xref ref-type="bibr" rid="bib63">Tél et al., 2005</xref>; <xref ref-type="bibr" rid="bib44">Nickerson et al., 2004</xref>; <xref ref-type="bibr" rid="bib32">Koshel' and Prants, 2006</xref>; <xref ref-type="bibr" rid="bib56">Sandulescu et al., 2008</xref>). For example, a flowing open system can allow the coexistence of species despite their differential fitness (<xref ref-type="bibr" rid="bib29">KarolyiKárolyi et al., 2000</xref>). Interactions between fluid shear and bacterial motility has been shown to lead to shear trapping (<xref ref-type="bibr" rid="bib52">Rusconi et al., 2014</xref>; <xref ref-type="bibr" rid="bib7">Berke et al., 2008</xref>) which causes preferential attachment to surfaces (<xref ref-type="bibr" rid="bib7">Berke et al., 2008</xref>; <xref ref-type="bibr" rid="bib35">Li et al., 2011</xref>). Turbulent flows can also lead to a trade-off in nutrient uptake and the cost of locomotion due to chemotaxis (<xref ref-type="bibr" rid="bib61">Taylor and Stocker, 2012</xref>), and can drastically effect the population density (<xref ref-type="bibr" rid="bib49">Pigolotti et al., 2012</xref>; <xref ref-type="bibr" rid="bib48">Perlekar et al., 2010</xref>). Most importantly, the reproductive successes of species (and individuals within a single species) are coupled over distance, through the secretion of toxins, goods, and signals (<xref ref-type="bibr" rid="bib40">Mimura et al., 2000</xref>; <xref ref-type="bibr" rid="bib3">Allison, 2005</xref>; <xref ref-type="bibr" rid="bib28">Hibbing et al., 2010</xref>). The spatial distributions of all such fitness altering intermediaries depend on flow. Indeed, the experimental study by <xref ref-type="bibr" rid="bib14">Drescher et al. (2014)</xref> has shown that flow can help promote cooperation in bacterial biofilms. Thus, we are motivated to find out how flow plays a role in the evolution of cooperation.</p><p>Here we theoretically study how fluid dynamics molds the social behavior of a planktonic microbial population. Qualitatively stated, our evolutionary model has three assumptions: (1) Individuals secrete one waste compound and one public good. The former has no cost, whereas the latter does. (2) Mutations can vary the public good secretion rates of microbes, thereby producing a continuum of social behavior. (3) Microbes and their secretions diffuse and flow according to the laws of fluid dynamics.</p><p>Under these assumptions, we find, through computer simulations and analytical theory, that bacteria self organize and form patterns of spots, which then exhibit an interesting form of budding dispersal when sheared by ambient fluid flow. The dispersal process preserves the group structure, thereby enabling evolutionarily stable social behavior.</p><p>Our model is applicable to a wide variety of social ecosystems ranging from phytoplankton flowing in oceanic currents to opportunistic bacteria colonizing blood or industrial pipelines. Our findings imply that greater social complexity amongst planktonic species would be observed in regions of large shear, such as by rocks and river banks. We might even speculate that multicellularity may have originated near fluid domains with large shear flow, rather than the bulk of oceans or lakes.</p><p>This paper is organized as follows: We first establish that under certain conditions our physical model gives rise to spatially organized cooperative structures. The structures are a natural byproduct of the dynamics of the system. Furthermore, these social structures reproduce in whole to form new identical structures. Variants of such structures have already been studied in ecological settings (<xref ref-type="bibr" rid="bib64">Tian et al., 2011</xref>; <xref ref-type="bibr" rid="bib8">Camara, 2011</xref>; <xref ref-type="bibr" rid="bib5">Baurmann et al., 2007</xref>; <xref ref-type="bibr" rid="bib76">Wilson et al., 2003</xref>) and growth patterns of microbial populations havebeen explored (<xref ref-type="bibr" rid="bib6">Ben-Jacob et al., 1994</xref>; <xref ref-type="bibr" rid="bib9">Chang-Li et al., 1988</xref>). We then study the effects of mutation. We first start with a simplified model with only two phenotypes: cheater and altruist. We then generalize to a continuum of public good secretion rates. In both cases, we observe that above a certain mutation rate, cheating strains take over groups which leads to total extinction. The latter finding is consistent with other empirical (<xref ref-type="bibr" rid="bib51">Rainey and Rainey, 2003</xref>; <xref ref-type="bibr" rid="bib12">Diggle et al., 2007</xref>) and theoretical studies (<xref ref-type="bibr" rid="bib45">Nowak and May, 1992</xref>).Through the fragmentation of social groups, and death of cheating groups, we recover the results of Simpson’s paradox (<xref ref-type="bibr" rid="bib10">Chuang et al., 2009</xref>) where individual groups may decrease in sociality, but the population as a whole becomes more social.</p><p>After setting up the stage for naturally forming social groups, we present our central and novel finding, that flow shear can lead to evolutionarily stable cooperative behavior within the population. Specifically, we demonstrate and study the evolution ofsociality of a microbial population (1) subjected to constant shear, (2) embedded in a cylindrical laminar flow and (3) in a Rankine vortex. We find that in all three cases population density and cooperative behavior scales with flow shear.</p><p>The mechanism of action is that shear distortion enhances the fragmentation of cooperative clusters, thereby increasing the group fragmentation rate and limiting the spread of cheaters. If the shear is large enough that groups are torn apart at a larger rate than the mutation rate, then cooperation will prevail. Otherwise, groups will become dominated by cheaters, and eventually die out (Figure 2, <xref ref-type="video" rid="video1">Videos 1</xref>–<xref ref-type="video" rid="video3">3</xref>).</p><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-34862-video1.mp4"><object-id pub-id-type="doi">10.7554/eLife.34862.003</object-id><label>Video 1.</label><caption><title>This is a video file of a simulation of the homogeneous phase.</title></caption></media><media id="video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-34862-video2.mp4"><object-id pub-id-type="doi">10.7554/eLife.34862.004</object-id><label>Video 2.</label><caption><title>This is a video file of a simulation of the group phase.</title></caption></media><media id="video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-34862-video3.mp4"><object-id pub-id-type="doi">10.7554/eLife.34862.005</object-id><label>Video 3.</label><caption><title>This is a video file of a simulation of the group phase under Couette flow.</title></caption></media></sec><sec id="s2" sec-type="results"><title>Results</title><p>We study a physically realistic spatial model of microorganisms, where fluid dynamical forces contribute significantly to the evolution of their social behavior. Our analysis consists of simulations and analytical formulas.</p><p>We simulate microbes as discrete particles subject to stochastic physical and evolutionary forces, and the compounds secreted by microbes as continuous fields. In contrast, our analytical expressions are derived from analogous equations that are entirely continuous and deterministic. In general, we should not expect the discrete simulations to perfectly be described by the continuous set of partial differential equations. Nevertheless, the continuous system of equations do allow us to obtain relevant quantities such as group size and group fragmentation rate to a good approximation (cf. appendix 1 and Figure 3).</p><p>In our model, the microorganisms secrete two types of diffusive molecules that influence each other’s fitness (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The first molecule, the concentration of which is denoted by <inline-formula><mml:math id="inf1"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, is a beneficial public good that increases the fitness of those exposed, whereas the second, <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, is a waste compound or toxin that has the opposite effect, and effectively acts as a volumetric carrying capacity. The continuous equations that represent our system are<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mo>⋅</mml:mo><mml:mo>∇</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>d</mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:msubsup><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mtext>d</mml:mtext><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here <inline-formula><mml:math id="inf3"><mml:mi>n</mml:mi></mml:math></inline-formula> is a shorthand for <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, the number density of microbes at time <inline-formula><mml:math id="inf5"><mml:mi>t</mml:mi></mml:math></inline-formula> and position <inline-formula><mml:math id="inf6"><mml:mi>x</mml:mi></mml:math></inline-formula> that produce the public good at a rate of <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. These microbes pay a fitness cost of <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> per unit time. The production rate of waste <inline-formula><mml:math id="inf9"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> on the other hand, is assumed constant for all, and has no fitness cost. Waste limits the number of individuals that a unit volume can carry. Microbes secreting public goods at a rate <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> replicate to produce others with the same secretion rate. This reproduction rate is given by the square bracket. However, the production rate <inline-formula><mml:math id="inf11"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> can change due to mutations. This is described by the last term of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. Mutations can be thought as diffusion in <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> space.</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.006</object-id><label>Figure 1.</label><caption><title>Schematics of our Model.</title><p>The microbes secrete two types of molecules into the environment. The first, a beneficial public good that promotes growth, and the second, a waste or harmful substance hinders growth. Cheating microbes produce lessor none of the former, while benefiting from public goods secreted by the altruistic population.</p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-34862-fig1-v2"/></fig><p>In all three equations the first two terms describe diffusion and advection, while the last two terms of <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> and <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> describe the production and decay of chemicals. The first two terms in the square bracket describe the effect of the secreted compounds on fitness. This saturating form is experimentally established and well understood (<xref ref-type="bibr" rid="bib41">Monod, 1949</xref>). The crucial third term in the square bracket describes the cost of producing the public good, which increases linearly.</p><sec id="s2-1"><title>Social groups as turing patterns</title><p>Diffusion can cause an instability that leads to the formation of intriguing patterns (<xref ref-type="bibr" rid="bib67">Turing, 1990</xref>), which among other fields, have been investigated in ecological context (<xref ref-type="bibr" rid="bib64">Tian et al., 2011</xref>; <xref ref-type="bibr" rid="bib8">Camara, 2011</xref>; <xref ref-type="bibr" rid="bib5">Baurmann et al., 2007</xref>; <xref ref-type="bibr" rid="bib76">Wilson et al., 2003</xref>). These so called Turing patterns typically form when an inhibiting agent has a diffusion length greater than that of an activating agent. For our model system, the waste compound and public good play the role of inhibiting and activating agents, and patterns manifest as cooperating microbial clusters <xref ref-type="fig" rid="fig2">Figure 2</xref>. The size and reproduction rate of these clusters, in terms of system parameters, can be estimated from a Turing analysis (cf. appendix 1). <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the values of diffusion constants that gives rise to Turing patterns, as well as the size of the groups.</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.007</object-id><label>Figure 2.</label><caption><title>Snapshots of homogeneous and group phases without and with shear.</title><p>Microbes interact by secreting diffusive chemicals into their environment. Cooperators are seen as bright green dots, and cheaters are seen as dark green dots. The waste compound is shown as blue and the public good as red, the two combined is seen as magenta. Top row: In the homogeneous phase the microbes spread to fill the domain. Cheaters quickly begin to take over, and eventually take over the whole domain. With no cooperators left, the public good decays away and the system goes extinct. Middle row: In the group phase, when the diffusion length of the waste compound is larger than the diffusion length of public good, microbes form stable groups. As the microbes increase in number, the groups split apart and form new groups. As mutations occur within groups, the cheaters take over and the group goes extinct. Cooperation can only be stable here if groups reproduce quicker than mutants take over. Bottom row: By adding a shearing flow to the group system, we can cause the groups to split apart quicker. Mutations still take over groups, but the groups are able to reproduce quicker than mutants take over, thus allowing cooperative groups to prevail at steady state. The simulation videos corresponding to this figure are provided in the <xref ref-type="video" rid="video1">Videos 1</xref>–<xref ref-type="video" rid="video3">3</xref>.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-34862-fig2-v2"/></fig><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.008</object-id><label>Figure 3.</label><caption><title>Turing analysis results.</title><p>The top-left figure, (<bold>A</bold>) shows the group size <inline-formula><mml:math id="inf13"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>fast</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as obtained by our theoretical analysis (appendix); whereas the bottom figure, (<bold>B</bold>) shows the same for continuous simulations, and the top-right figure, (<bold>C</bold>) is for agent based simulations. The black line in (<bold>B</bold>) divides parameters that give rise to striped patterns, and those that give rise to spots, corresponding images are shown to the left and right of (<bold>B</bold>). Due to the discreteness of the agent based simulations, Turing patterns are not always stable where they might be in the continuous analogue. We see that the discrete simulations cut off around where we would see stripes in the continuous case, and do not see striped patterns in the discrete case. For different sets of parameters, we can also see Turing patterns in the discrete-stochastic case where they might not occur in the continuous case. For the region where Turing patterns are stable, the continuous theory gives a good prediction of group size and group reproduction rate. The Matlab code and data for this figure is provided in <xref ref-type="supplementary-material" rid="fig3sdata1">Figure 3—source data 1</xref>.</p><p><supplementary-material id="fig3sdata1"><object-id pub-id-type="doi">10.7554/eLife.34862.009</object-id><label>Figure 3—source data 1.</label><caption><title>Matlab data and code files for <xref ref-type="fig" rid="fig3">Figure 3</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-34862-fig3-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-34862-fig3-v2"/></fig><p>In the homogeneous phase, the system is evolutionarily very unstable, since as soon as one cheating mutant emerges, it quickly takes over the entire population, ultimately causing the population to go extinct (<xref ref-type="video" rid="video1">Video 1</xref>). The group phase tolerates cheaters better, since once a cheater emerges it will take over and compromise the fitness of only one group, while the others will live on. However, in the absence of group fragmentation, novel cheating mutations will ultimately emerge in all groups, and annihilate the population one group at a time (<xref ref-type="video" rid="video2">Video 2</xref>).</p><p>The main contribution of this paper is to demonstrate that stable social cooperation can be induced or enhanced by fluid flow gradients. Specifically, shear forces induced by advective flow distorts and fragments microbial clusters, leading to a kind of budding dispersal, which in turn enables evolutionary stable cooperation (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="video" rid="video3">Video 3</xref>).</p><p>It is well known that evolutionary outcomes can depend on individuals being discrete (<xref ref-type="bibr" rid="bib16">Durrett and Levin, 1994</xref>). In our model, having a continuous population density can allow for the existence of ‘micro-mutant populations’ which can spread easier between adjacent groups. The discreteness further separates the clusters of microbes from each other, since there cannot exist fractional individuals. In reality microbes are quantized, and we thus expect a discrete simulation to better model the biology. In <xref ref-type="fig" rid="fig3">Figure 3</xref> we present the phase diagram of the system, as obtained by analytical theory, discrete agent based simulations (where microbes are discrete, self-replicating brownian particles), and continuous simulations (where <xref ref-type="disp-formula" rid="equ1 equ2 equ3"><bold><italic>Equations 1,2,3</italic></bold></xref> are solved numerically). In order not to obfuscate the biology, we report our detailed mathematical treatment in the appendix.</p></sec><sec id="s2-2"><title>Effect of shear on groups</title><p>We quantitatively determine the effect of different flow velocity profiles on the social evolution of the system. A constant fluid flow merely amounts to a change in reference frame, which of course, does not change the evolutionary fate of the population. However, we find that velocity gradients cause significant changes to the social structure, both spatially and temporally. Specifically, we find that large shear rate causes microbial groups to distort and fragment, which in turn facilitates group reproduction. To investigate this effect in detail, we ran simulations for three fluid velocity distributions: Couette flow, Hagen-Poiseuille flow, and Rankine vortex.</p></sec><sec id="s2-3"><title>Evolution of sociality in constant shear for a binary phenotype</title><p>We first look at a simplified system with just two phenotypes, cheater and altruist, to gain a basic understanding of the mechanism involved. Mutations can cause a switch in social behavior.</p><p>To see the effect of shear on social evolution, we introduced Couette flow to the microbial habitat. In this case, the flow velocity takes the form<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:mi>r</mml:mi><mml:mi>R</mml:mi></mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf14"><mml:mi>R</mml:mi></mml:math></inline-formula> is the radius of the pipe, and <inline-formula><mml:math id="inf15"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is the longitudinal direction.</p><p>The shear rate is the derivative of the flow velocity and is related to the maximum flow rate <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>,<disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mi>R</mml:mi></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We ran simulations for various shear rates and diffusion constants and observed that shear does not significantly influence the <italic>region</italic> of parameter space that gives rise to cooperating groups. However <italic>if</italic> the system parameters are conducive to the formation of groups, shear tears groups apart and <italic>increases</italic> the rate at which spatially distinct cooperative clusters form.</p><p>We find that the group fragmentation rate <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, depends linearly on the shear rate <inline-formula><mml:math id="inf18"><mml:mi>σ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4</xref>)<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is the fragmentation rate solely due to microbial diffusion and can approximately be given by the Turing eigenvalue <inline-formula><mml:math id="inf20"><mml:mrow><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi>Λ</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> (see appendix). The constant of proportionality <inline-formula><mml:math id="inf21"><mml:mi>m</mml:mi></mml:math></inline-formula> is given empirically from our simulations and depends on diffusion lengths and group density. This holds in the low density regime. Once the population density becomes large, group-group interactions slow the group reproduction rate and the population saturates.</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.010</object-id><label>Figure 4.</label><caption><title>Critical shear for cooperativity for cheater-altruist system.</title><p>(<bold>A</bold>) Group fragmentation rate versus shear rate. We see that the group fragmentation rate increases linearly with the shear rate. (<bold>B</bold>) Group population versus shear rate. As the shear distorts and elongates the group, the average group population also increases linearly with shear. (<bold>C</bold>) Average population versus shear rate for different mutation rates. Simulations were run for a time of <inline-formula><mml:math id="inf22"><mml:mrow><mml:mn>5.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> s and averaged over 10 runs for each shear rate and mutation rate. Error bars correspond to one standard deviation. Here, a mutation corresponds to a full cheater, with no public good secretion. The population goes extinct under larger mutation rates unless the shear rate is above the critical value. The critical shear values for different mutation rates are roughly obtained by 10 and are shown by the vertical dashed lines corresponding to curves of the same color. The Matlab code and data for this figure is provided in <xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>.</p><p><supplementary-material id="fig4sdata1"><object-id pub-id-type="doi">10.7554/eLife.34862.011</object-id><label>Figure 4—source data 1.</label><caption><title>Matlab data and code files for <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-34862-fig4-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-34862-fig4-v2"/></fig><p>Larger shear corresponds to a faster rate of group fragmentation, thus enabling or enhancing social behavior in the microbial population. Given the group size and fragmentation rate as a function of shear, we can calculate roughly where the critical shearrate is for sociality. We also find that the group population <inline-formula><mml:math id="inf23"><mml:mi>N</mml:mi></mml:math></inline-formula> increases linearly with shear,<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf24"><mml:mi>n</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are the slope and intercept of the line in <xref ref-type="fig" rid="fig4">Figure 4B</xref>. This also influences where the critical shear rate will be.</p><p>Cooperation is stable if a group is able to fragment before a cheating strain emerges and proliferates in the group. Therefore, for stability, we need the take-over time to exceed the time it takes for a group to reproduce. A mutant emerges at a rate of <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>μ</mml:mi><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>σ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> (we emphasize that <inline-formula><mml:math id="inf27"><mml:mi>μ</mml:mi></mml:math></inline-formula> is not the generic mutation rate, but the rate at which a particular social gene mutates). Once a mutant emerges, it takes some time <inline-formula><mml:math id="inf28"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to spread to where the daughter group forms. <inline-formula><mml:math id="inf29"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> will depend on where the mutant first emerges. Assuming a uniform distribution, and taking the diffusion time in two dimensions as a function of radius <inline-formula><mml:math id="inf30"><mml:mi>r</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we obtain<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>R</mml:mi></mml:munderover></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mtext>d</mml:mtext><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf32"><mml:mi>R</mml:mi></mml:math></inline-formula> is the group radius. The take-over rate is then given by taking the inverse of the total take-over time, and the critical shear rate <inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> necessary for social cooperation is given by equating the take-over rate with the reproduction rate,<disp-formula id="equ9"><label>(4)</label><mml:math id="m9"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mstyle displaystyle="true" mathsize="140%"><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>μ</mml:mi><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&gt;</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The critical shear rate <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> above which the system can maintain stable cooperation is then given by the positive root,<disp-formula id="equ10"><label>(5)</label><mml:math id="m10"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mi>σ</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>=&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>μ</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:msub><mml:mo>=&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>μ</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>μ</mml:mi><mml:mi>m</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>μ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>The values obtained from <xref ref-type="disp-formula" rid="equ10">Equation 5</xref> is indicated by the vertical dashed lines in <xref ref-type="fig" rid="fig4">Figure 4</xref> and agrees with the computationally observed critical shear reasonably well. It may be possible to improve this formula further by taking into account additional factors, such as the non-uniform spatial distribution of population within a group and the elongation of groups with shear. Furthermore, as the mutants increase in numbers it becomes more likely that one of them crosses over the daughter group, thereby reducing further the expected <inline-formula><mml:math id="inf37"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula>. We see better agreement with analytical theory and simulations at lower mutation rates, since these corrections are mainly to the diffusion time <inline-formula><mml:math id="inf38"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula>, and become more significant at higher mutation rates, where <inline-formula><mml:math id="inf39"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mo>≫</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>μ</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, (cf. <xref ref-type="disp-formula" rid="equ9">Equation 4</xref>).</p><p>If shear is below the critical value (<xref ref-type="disp-formula" rid="equ10">Equation 5</xref>), the system will be in a non-social state. Ultimately, cheaters will take over, and wipe out all groups. When shear is increased above the critical value however, the system will transition to a stable social state, thereby maintaining its fitness and dense population indefinitely. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows the long-time population of the system versus the shear rate. The population goes extinct under larger mutation rates unless the shear rate is above the critical value.</p><p>When is shear necessary, and when is it just a sufficient condition for cooperation? By setting <inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ10">Equation 5</xref> and solving for <inline-formula><mml:math id="inf41"><mml:mi>μ</mml:mi></mml:math></inline-formula> we can also obtain the critical mutation rate above which shear is necessary in order to have social cooperation. We get <inline-formula><mml:math id="inf42"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>6.9</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> analytically and our simulations show a critical mutation rate around <inline-formula><mml:math id="inf43"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>5.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s2-4"><title>Evolution of sociality in constant shear for a continuum of phenotypes</title><p>As we will see, we obtain similar results when the available phenotypes include a continuum of social behaviors. In this case, a mutation changes the secretion rate of a microbe by a uniformly chosen random number between 0 and 1 <inline-formula><mml:math id="inf44"><mml:mrow><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>We observe from our simulations, that mutations that increase the secretion rate of a microbe do not fixate, since the microbe now pays a higher cost and is less fit than its neighbors. However, once a mutation that lowers the secretion rate of a microbe occurs within a group, it quickly takes over the entire group, leaving individual groups homogeneous in secretion rate.</p><p>We show the diversity of social behaviors across groups and within individual groups in greater detail in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>. Since less cooperative phenotypes always dominate more cooperative phenotypes, we find no diversity of social behavior within a group. However we do see a large variation across groups, which increases with shear.</p><p>Groups with different secretion rates reproduce at different rates. Groups with too low of a secretion rate are not stable and die off. In general, the system will evolve to a distribution of groups with secretion rates centered around the value of secretion rate that maximizes the group reproduction. For larger mutation rates, the system will tend towards lower average secretion rate and/or go extinct. The average secretion rate of the population can be maintained at a higher value by introducing shear flow, <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.012</object-id><label>Figure 5.</label><caption><title>Evolution of sociality in constant shear (continuum of secretion rates).</title><p>Individual groups are essentially homogeneous in secretion space, whereas the meta-population contains a distribution of groups with different secretion rates (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). (<bold>A</bold>) Groups that have a higher secretion rate reproduce quicker than those of lower secretion rate. Shear works to increase the reproduction rate of groups. (<bold>B</bold>) Just as in the two phenotype case, the population of the system increases with shear, since groups are able to split apart quicker than novel cheating mutations occur. (<bold>C</bold>) The average secretion rate of the entire population generally increases with shear and saturates around where the group reproduction rate is sufficient to maintain the population. Simulations were run for a time of <inline-formula><mml:math id="inf45"><mml:mrow><mml:mn>2.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> s and averaged over 80 runs for each shear rate and under a mutation rate of <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Error bars correspond to one standard deviation. The Matlab code and data for this figure is provided in <xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>.</p><p><supplementary-material id="fig5sdata1"><object-id pub-id-type="doi">10.7554/eLife.34862.013</object-id><label>Figure 5—source data 1.</label><caption><title>Matlab data and code files for <xref ref-type="fig" rid="fig5">Figure 5</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-34862-fig5-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-34862-fig5-v2"/></fig><p>We therefore have the same qualitative result as in the two phenotype case, if shear is below some critical value, the system will be in a non-social state. Ultimately, cheaters will take over, and wipe out all groups. As before, the social state of the population can transition from a non-cooperative state to a cooperative one with increased flow shear.</p></sec><sec id="s2-5"><title>Evolution of sociality in a flowing pipe</title><p>We now further generalize our results by looking at laminar flow with fixed boundaries, and with a continuum of public good secretion rates. For Hagen-Poiseuille flow, the shear rate varies linearly with the radius, taking its maximum value adjacent to the boundaries, when <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>. The flow and shear profiles are given as,<disp-formula id="equ11"><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:mi>r</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We therefore expect to see groups fragment quicker at the boundary, leading to larger cooperation, higher average secretion rate, and larger population, which is indeed what we do see (<xref ref-type="fig" rid="fig6">Figure 6</xref>, <xref ref-type="video" rid="video4">Video 4</xref>).</p><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.014</object-id><label>Figure 6.</label><caption><title>Evolution of sociality in pipe and vortex geometries (continuum of secretion rates).</title><p>The top row gives simulation snapshots of the system in a Hagen-Poiseuille flow in a pipe (<bold>A</bold>) and of the system in a Rankine vortex (<bold>B</bold>). The middle row gives the average microbial population and the shear rate magnitude versus distance from the center of the pipe (<bold>C</bold>) and the center of the Rankine vortex (<bold>D</bold>). Since shear is spatially dependent, the population is localized in regions of large shear. For Hagen-Poiseuille flow, we see that the population is larger at the boundaries, where the shear is also larger (<bold>C</bold>). This is because groups fragment quicker at the boundaries and are able to overcome take-over by mutation, whereas near the center they cannot. For the Rankine vortex we also see that the population follows very closely to the shear (<bold>D</bold>), which suggests that the growth is proportional to shear. We caution that this holds in the low density limit. At higher densities the population saturates and is no longer proportional to shear. The bottom row gives the average public good secretion rates of the entire population for Hagen-Poiseuille flow (<bold>E</bold>) and for Rankine vortex flow (<bold>F</bold>). Again, regions of larger shear admit more cooperative populations with larger public good secretion rates. Simulations were run for a duration of <inline-formula><mml:math id="inf48"><mml:mrow><mml:mn>2.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> s under a mutation rate of <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> and data was averaged over 200 runs. The undulations observed in the population plots are due to the finite size of the groups. Groups form layers of width equal to the group diameter. The population curve therefore shows undulations of width equal to the group width. Simulation videos of Hagen-Poiseuille flow and Rankine vortex flow are provided in <xref ref-type="video" rid="video4">Videos 4</xref>, <xref ref-type="video" rid="video5">5</xref> and Matlab code and data for (<bold>C</bold>)-(<bold>F</bold>) is given in <xref ref-type="supplementary-material" rid="fig6sdata1">Figure 6—source data 1</xref>.</p><p><supplementary-material id="fig6sdata1"><object-id pub-id-type="doi">10.7554/eLife.34862.015</object-id><label>Figure 6—source data 1.</label><caption><title>Matlab data and code files for <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-34862-fig6-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-34862-fig6-v2"/></fig><media id="video4" mime-subtype="mp4" mimetype="video" xlink:href="elife-34862-video4.mp4"><object-id pub-id-type="doi">10.7554/eLife.34862.016</object-id><label>Video 4.</label><caption><title>This is a video file of a simulation of the group phase under a Hagen-Poiseuille flow.</title></caption></media><p>Earlier studies have proposed and shown that shear trapping due to the interaction between bacterial motility and fluid shear can result in preferential attachment to surfaces, (<xref ref-type="bibr" rid="bib52">Rusconi et al., 2014</xref>; <xref ref-type="bibr" rid="bib7">Berke et al., 2008</xref>; <xref ref-type="bibr" rid="bib35">Li et al., 2011</xref>). In a similar spirit, we suggest that inhabiting surfaces may have the additional advantage of enhanced sociality, due to shear driven group fragmentation and dispersal.</p></sec><sec id="s2-6"><title>Evolution of sociality in vortices</title><p>In a vortex, the region above the critical shear value constitutes an annulus. Thus, we expect social behavior to be localized. Any point in the fluid outside this annulus will be taken over and destroyed by cheaters. In our simulations, at steady state we indeed see clusters whirling around exclusively within annulus, neither too near, nor too far from the vortex core (<xref ref-type="video" rid="video5">Video 5</xref>). Life cannot exist outside this annulus, as cheaters kill these groups.</p><media id="video5" mime-subtype="mp4" mimetype="video" xlink:href="elife-34862-video5.mp4"><object-id pub-id-type="doi">10.7554/eLife.34862.017</object-id><label>Video 5.</label><caption><title>This is a video file of a simulation of the group phase under a Rankine vortex flow.</title></caption></media><p>The Rankine vortex in two dimensions is characterized by a vortex radius <inline-formula><mml:math id="inf50"><mml:mi>R</mml:mi></mml:math></inline-formula> and a rotation rate <inline-formula><mml:math id="inf51"><mml:mi>Γ</mml:mi></mml:math></inline-formula>. The shear rate acting on a group acts tangential to the flow. The velocity profile and shear magnitude are given as,<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>R</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>r</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>R</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf52"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>The shear rate is then a maximum at the minimum value of <inline-formula><mml:math id="inf53"><mml:mi>r</mml:mi></mml:math></inline-formula> which occurs at the vortex radius <inline-formula><mml:math id="inf54"><mml:mi>R</mml:mi></mml:math></inline-formula>. We therefore expect to see the largest concentration of groups at the vortex radius, which is what we observe in our simulations (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p></sec><sec id="s2-7"><title>Limitations</title><p>While we paid close attention to physical realism, we also made important simplifying assumptions which under certain circumstances, may lead to incorrect conclusions. We caution the reader by enumerating the limitations of our model. First, since many microorganisms live in a low Reynolds number environment, we have chosen to neglect the inertia of microorganisms. However in reality, the microorganisms influence the flow around them. This effect will be particularly significant for a dense microbial population, especially when the microbes stick onto one other, or integrate via extracellular polymers. A more sophisticated model would include the coupling of the microbes to the flow. Secondly, the finite size and shapes of the microorganisms have been neglected. Instead, we have treated microbes as point particles, which will also invalidate our model in the dense population limit. Lastly, real microbes display a large number of complex behaviors such as biofilm formation and chemotactic migration. Here we have ignored the active response of microorganisms to the chemical gradients that surround them and to the surfaces they might attach and migrate. Instead, we took them as simple Brownian particles.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>It is well known that spatial structure is crucial in the evolution of cooperation, (<xref ref-type="bibr" rid="bib73">Wilson et al., 1992</xref>; <xref ref-type="bibr" rid="bib62">Taylor, 1992</xref>; <xref ref-type="bibr" rid="bib36">Lion and Baalen, 2008</xref>). Many of these studies introduce these mechanisms ‘manually’, for example density regulation and migration are enforced by applying carrying capacities and migration rates to groups. In this study we have distanced ourselves from the typical game theoretic abstractions used to investigate evolution of cooperation. Instead we adopted a mechanical point of view. We investigated in detail, the fluid dynamical forces between microbes and their secretions, to understand how cooperation evolves among a population of planktonic microbes inhabiting in a flowing medium. In our first principles model, the spatial structuring and dispersion occur naturally from the physical dynamics.</p><p>We found that under certain conditions, microbes naturally form social communities, which then procreate new social communities of the same structure. More importantly, we discovered that regions of a fluid with large shear can enhance the formation of such social structures. The mechanism behind this effect is that fluid shear distorts and tears apart microbial clusters, thereby limiting the spread of cheating mutants. Our proposed mechanism can be seen as shear flow enhanced budding dispersal. This can also be viewed under the phenomenon of Simpson’s paradox (<xref ref-type="bibr" rid="bib10">Chuang et al., 2009</xref>) where individual groups may decrease in sociality, but the population as a whole becomes more social.</p><p>In our investigation, we found only certain regions of the fluid domain admits life, social or otherwise, as governed by the domain geometry and flow rate. From this perspective, it appears that evolution of sociality is a mechanical phenomenon.</p><p>In our physics-based model, groups emerge from individual-level dynamics and selection. Groups with cheaters are negatively selected, and give way to those without cheaters. On the other hand the ensemble of groups do not exhibit any variation in their propensity to progenerate cheaters, neither is such propensity heritable. Rather, the progeneration of cheating is a (non-genetic) <italic>symptom</italic> that inevitably manifests in every group that has been around long enough. In this sense, it might be appropriate to view the emergence and spread of cheaters in a microbial population as a phenomenon of ‘aging’, in the non-evolutionary and mechanical sense, that any system consisting of a large number of interdependent components will inevitably and with increasing likelihood, fall apart (<xref ref-type="bibr" rid="bib69">Vural et al., 2014</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>The analytical conclusions we derive from our system (<xref ref-type="disp-formula" rid="equ1 equ2 equ3">Equations 1,2,3</xref>) has been guided and supplemented by an agent based stochastic simulation. Videos of simulations are provided in <xref ref-type="video" rid="video1">Videos 1</xref>–<xref ref-type="video" rid="video5">5</xref>. Our simulation algorithm is as follows: at each time interval, <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, the microbes (1) diffuse by Brownian motion, with step size <inline-formula><mml:math id="inf56"><mml:mi>δ</mml:mi></mml:math></inline-formula> derived from the diffusion constant and a bias dependent on the flow velocity, <inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, (2) secrete chemicals locally that then diffuse and advect using a finite difference scheme, and (3) reproduce or die with a probability dependent on their local fitness given by <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="inf59"><mml:mi>f</mml:mi></mml:math></inline-formula> is negative, the microbes die with probability 1, if <inline-formula><mml:math id="inf60"><mml:mi>f</mml:mi></mml:math></inline-formula> is between 0 and 1 they reproduce with probability <inline-formula><mml:math id="inf61"><mml:mi>f</mml:mi></mml:math></inline-formula>, and if <inline-formula><mml:math id="inf62"><mml:mi>f</mml:mi></mml:math></inline-formula> is larger than 1, they produce number of offspring given by the integer part of <inline-formula><mml:math id="inf63"><mml:mi>f</mml:mi></mml:math></inline-formula> and another with probability given by the decimal part of <inline-formula><mml:math id="inf64"><mml:mi>f</mml:mi></mml:math></inline-formula>. Upon reproduction, random mutations may alter the secretion rate of the public good –and thus the reproduction rate– of the microbes. Mutations occur with probability <inline-formula><mml:math id="inf65"><mml:mi>μ</mml:mi></mml:math></inline-formula> and can change the secretion rate by a random number between <inline-formula><mml:math id="inf66"><mml:mn>0</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The secretion rate is assumed to be heritable, and constant in time. Numerical simulations for figures were performed by implementing the model described above using the Matlab programming language and simulated using Matlab (Mathworks, Inc.). The source code for discrete simulations is provided in <xref ref-type="supplementary-material" rid="scode1">Source code 1</xref> and the source code for continuous simulations used in <xref ref-type="fig" rid="fig3">Figure 3B</xref> is provided in <xref ref-type="supplementary-material" rid="scode2">Source code 2</xref>.</p><p>A summary of the system parameters is given in <xref ref-type="table" rid="table1">Table 1</xref>, along with typical ranges for their values used in the simulations. The relevant ratios of parameters are consistent with those observed experimentally (<xref ref-type="bibr" rid="bib31">Kim, 1996</xref>; <xref ref-type="bibr" rid="bib38">Ma et al., 2005</xref>).</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.018</object-id><label>Table 1.</label><caption><title>Summary of system parameters.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Parameter</th><th valign="top">Definition</th><th valign="top">Values</th></tr></thead><tbody><tr><td valign="top"><p><inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Microbial diffusion constant</td><td valign="top"><p><inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.3906</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>cm</mml:mtext><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Public good diffusion constant</td><td valign="top"><inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>60</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>cm</mml:mtext><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Waste diffusion constant</td><td valign="top"><inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>50</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>cm</mml:mtext><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf74"><mml:mi>v</mml:mi></mml:math></inline-formula></p></td><td valign="top">Flow velocity</td><td valign="top"><inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>100</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mtext>cm</mml:mtext><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Public good decay constant</td><td valign="top"><p><inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>5.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Waste decay constant</td><td valign="top"><p><inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>1.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf80"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Public good saturation</td><td valign="top"><p><inline-formula><mml:math id="inf81"><mml:mrow><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf82"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Waste saturation</td><td valign="top"><p><inline-formula><mml:math id="inf83"><mml:mrow><mml:mn>0.10</mml:mn></mml:mrow></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Public good secretion rate</td><td valign="top"><inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>1.0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Waste secretion rate</td><td valign="top"><inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>1.0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf88"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Benefit of public good</td><td valign="top"><p><inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>7.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf90"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Harm of waste compound</td><td valign="top"><p><inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>8.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf92"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></p></td><td valign="top">Cost of secretion</td><td valign="top"><p><inline-formula><mml:math id="inf93"><mml:mrow><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula></p></td></tr><tr><td valign="top"><p><inline-formula><mml:math id="inf94"><mml:mi>μ</mml:mi></mml:math></inline-formula></p></td><td valign="top">Mutation rate</td><td valign="top"><inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6.0</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mn>20.0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mtext>s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table></table-wrap></sec></body><back><sec id="s5-2" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Supervision, Funding acquisition, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s5-1" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="scode1"><object-id pub-id-type="doi">10.7554/eLife.34862.019</object-id><label>Source code 1.</label><caption><title>Matlab code for discrete stochastic simulations.</title><p>Main file is main_discrete.m. See README file for more information.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-34862-code1-v2.zip"/></supplementary-material><supplementary-material id="scode2"><object-id pub-id-type="doi">10.7554/eLife.34862.020</object-id><label>Source code 2.</label><caption><title>Matlab code for continuous simulations used in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.</title><p>Main file is main_continuous.m. See README file for more information.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-34862-code2-v2.zip"/></supplementary-material><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.34862.021</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-34862-transrepform-v2.docx"/></supplementary-material><sec id="s5-3" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files</p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname> <given-names>B</given-names></name><name><surname>Gore</surname> <given-names>J</given-names></name><name><surname>Nowak</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Spatial dilemmas of diffusible public goods</article-title><source>eLife</source><volume>2</volume><elocation-id>e01169</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.01169</pub-id><pub-id pub-id-type="pmid">24347543</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname> <given-names>RC</given-names></name><name><surname>McNally</surname> <given-names>L</given-names></name><name><surname>Popat</surname> <given-names>R</given-names></name><name><surname>Brown</surname> <given-names>SP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Quorum sensing protects bacterial co-operation from exploitation by cheats</article-title><source>The ISME Journal</source><volume>10</volume><fpage>1706</fpage><lpage>1716</lpage><pub-id pub-id-type="doi">10.1038/ismej.2015.232</pub-id><pub-id pub-id-type="pmid">26744811</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allison</surname> <given-names>SD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Cheaters, diffusion and nutrients constrain decomposition by microbial enzymes in spatially structured environments</article-title><source>Ecology Letters</source><volume>8</volume><fpage>626</fpage><lpage>635</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2005.00756.x</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Axelrod</surname> <given-names>R</given-names></name><name><surname>Hamilton</surname> <given-names>WD</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>The evolution of cooperation</article-title><source>Science</source><volume>211</volume><fpage>1390</fpage><lpage>1396</lpage><pub-id pub-id-type="doi">10.1126/science.7466396</pub-id><pub-id pub-id-type="pmid">7466396</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baurmann</surname> <given-names>M</given-names></name><name><surname>Gross</surname> <given-names>T</given-names></name><name><surname>Feudel</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Instabilities in spatially extended predator-prey systems: spatio-temporal patterns in the neighborhood of Turing-Hopf bifurcations</article-title><source>Journal of Theoretical Biology</source><volume>245</volume><fpage>220</fpage><lpage>229</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2006.09.036</pub-id><pub-id pub-id-type="pmid">17140604</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Jacob</surname> <given-names>E</given-names></name><name><surname>Schochet</surname> <given-names>O</given-names></name><name><surname>Tenenbaum</surname> <given-names>A</given-names></name><name><surname>Cohen</surname> <given-names>I</given-names></name><name><surname>Czirók</surname> <given-names>A</given-names></name><name><surname>Vicsek</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Generic modelling of cooperative growth patterns in bacterial colonies</article-title><source>Nature</source><volume>368</volume><fpage>46</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1038/368046a0</pub-id><pub-id pub-id-type="pmid">8107881</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berke</surname> <given-names>AP</given-names></name><name><surname>Turner</surname> <given-names>L</given-names></name><name><surname>Berg</surname> <given-names>HC</given-names></name><name><surname>Lauga</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Hydrodynamic attraction of swimming microorganisms by surfaces</article-title><source>Physical Review Letters</source><volume>101</volume><elocation-id>038102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.101.038102</pub-id><pub-id pub-id-type="pmid">18764299</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Camara</surname> <given-names>BI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Waves analysis and spatiotemporal pattern formation of an ecosystem model</article-title><source>Nonlinear Analysis: Real World Applications</source><volume>12</volume><fpage>2511</fpage><lpage>2528</lpage><pub-id pub-id-type="doi">10.1016/j.nonrwa.2011.02.020</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang-Li</surname> <given-names>X</given-names></name><name><surname>Hou-Kuhan</surname> <given-names>T</given-names></name><name><surname>Zhau-Hua</surname> <given-names>S</given-names></name><name><surname>Song-Sheng</surname> <given-names>Q</given-names></name><name><surname>Yao-Ting</surname> <given-names>L</given-names></name><name><surname>Hai-Shui</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Microcalorimetric study of bacterial growth</article-title><source>Thermochimica Acta</source><volume>123</volume><fpage>33</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1016/0040-6031(88)80007-8</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chuang</surname> <given-names>JS</given-names></name><name><surname>Rivoire</surname> <given-names>O</given-names></name><name><surname>Leibler</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Simpson's paradox in a synthetic microbial system</article-title><source>Science</source><volume>323</volume><fpage>272</fpage><lpage>275</lpage><pub-id pub-id-type="doi">10.1126/science.1166739</pub-id><pub-id pub-id-type="pmid">19131632</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clutton-Brock</surname> <given-names>TH</given-names></name><name><surname>Parker</surname> <given-names>GA</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Punishment in animal societies</article-title><source>Nature</source><volume>373</volume><fpage>209</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1038/373209a0</pub-id><pub-id pub-id-type="pmid">7816134</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diggle</surname> <given-names>SP</given-names></name><name><surname>Griffin</surname> <given-names>AS</given-names></name><name><surname>Campbell</surname> <given-names>GS</given-names></name><name><surname>West</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Cooperation and conflict in quorum-sensing bacterial populations</article-title><source>Nature</source><volume>450</volume><fpage>411</fpage><lpage>414</lpage><pub-id pub-id-type="doi">10.1038/nature06279</pub-id><pub-id pub-id-type="pmid">18004383</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dobay</surname> <given-names>A</given-names></name><name><surname>Bagheri</surname> <given-names>HC</given-names></name><name><surname>Messina</surname> <given-names>A</given-names></name><name><surname>Kümmerli</surname> <given-names>R</given-names></name><name><surname>Rankin</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Interaction effects of cell diffusion, cell density and public goods properties on the evolution of cooperation in digital microbes</article-title><source>Journal of Evolutionary Biology</source><volume>27</volume><fpage>1869</fpage><lpage>1877</lpage><pub-id pub-id-type="doi">10.1111/jeb.12437</pub-id><pub-id pub-id-type="pmid">24962623</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drescher</surname> <given-names>K</given-names></name><name><surname>Nadell</surname> <given-names>CD</given-names></name><name><surname>Stone</surname> <given-names>HA</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name><name><surname>Bassler</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Solutions to the public goods dilemma in bacterial biofilms</article-title><source>Current Biology</source><volume>24</volume><fpage>50</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.10.030</pub-id><pub-id pub-id-type="pmid">24332540</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Driscoll</surname> <given-names>WW</given-names></name><name><surname>Pepper</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Theory for the evolution of diffusible external goods</article-title><source>Evolution</source><volume>64</volume><fpage>2682</fpage><lpage>2687</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2010.01002.x</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durrett</surname> <given-names>R</given-names></name><name><surname>Levin</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The importance of being discrete (and spatial)</article-title><source>Theoretical Population Biology</source><volume>46</volume><fpage>363</fpage><lpage>394</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1994.1032</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El Mouden</surname> <given-names>C</given-names></name><name><surname>West</surname> <given-names>SA</given-names></name><name><surname>Gardner</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The enforcement of cooperation by policing</article-title><source>Evolution</source><volume>17</volume><fpage>2139</fpage><lpage>2152</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2010.00963.x</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fletcher</surname> <given-names>JA</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A simple and general explanation for the evolution of altruism</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>276</volume><fpage>13</fpage><lpage>19</lpage><pub-id pub-id-type="doi">10.1098/rspb.2008.0829</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname> <given-names>A</given-names></name><name><surname>West</surname> <given-names>SA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Demography, altruism, and the benefits of budding</article-title><source>Journal of Evolutionary Biology</source><volume>19</volume><fpage>1707</fpage><lpage>1716</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2006.01104.x</pub-id><pub-id pub-id-type="pmid">16911000</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gardner</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The genetical theory of multilevel selection</article-title><source>Journal of Evolutionary Biology</source><volume>28</volume><fpage>305</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1111/jeb.12566</pub-id><pub-id pub-id-type="pmid">25475922</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodnight</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Multilevel selection theory and evidence: a critique of gardner, 2015</article-title><source>Journal of Evolutionary Biology</source><volume>28</volume><fpage>1734</fpage><lpage>1746</lpage><pub-id pub-id-type="doi">10.1111/jeb.12685</pub-id><pub-id pub-id-type="pmid">26265012</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodnight</surname> <given-names>KF</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>The effect of stochastic variation on kin selection in a budding-viscous population</article-title><source>The American Naturalist</source><volume>140</volume><fpage>1028</fpage><lpage>1040</lpage><pub-id pub-id-type="doi">10.1086/285454</pub-id><pub-id pub-id-type="pmid">19426032</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Haldane</surname> <given-names>JBS</given-names></name></person-group><year iso-8601-date="1932">1932</year><source>The Causes of Evolution</source><publisher-loc>London, New York</publisher-loc><publisher-name>Green and Co</publisher-name></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamilton</surname> <given-names>WD</given-names></name></person-group><year iso-8601-date="1964">1964a</year><article-title>The genetical evolution of social behaviour. I</article-title><source>Journal of Theoretical Biology</source><volume>7</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1016/0022-5193(64)90038-4</pub-id><pub-id pub-id-type="pmid">5875341</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamilton</surname> <given-names>WD</given-names></name></person-group><year iso-8601-date="1964">1964b</year><article-title>The genetical evolution of social behaviour. II</article-title><source>Journal of Theoretical Biology</source><volume>7</volume><fpage>17</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1016/0022-5193(64)90039-6</pub-id><pub-id pub-id-type="pmid">5875340</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamilton</surname> <given-names>WD</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Innate social aptitudes of man: an approach from evolutionary genetics</article-title><source>Biosocial Anthropology</source><volume>53</volume><fpage>133</fpage><lpage>155</lpage></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hauert</surname> <given-names>C</given-names></name><name><surname>Wakano</surname> <given-names>JY</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Ecological public goods games: cooperation and bifurcation</article-title><source>Theoretical Population Biology</source><volume>73</volume><fpage>257</fpage><lpage>263</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2007.11.007</pub-id><pub-id pub-id-type="pmid">18221761</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hibbing</surname> <given-names>ME</given-names></name><name><surname>Fuqua</surname> <given-names>C</given-names></name><name><surname>Parsek</surname> <given-names>MR</given-names></name><name><surname>Peterson</surname> <given-names>SB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Bacterial competition: surviving and thriving in the microbial jungle</article-title><source>Nature Reviews Microbiology</source><volume>8</volume><fpage>15</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2259</pub-id><pub-id pub-id-type="pmid">19946288</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Károlyi</surname> <given-names>G</given-names></name><name><surname>Péntek</surname> <given-names>A</given-names></name><name><surname>Scheuring</surname> <given-names>I</given-names></name><name><surname>Tél</surname> <given-names>T</given-names></name><name><surname>Toroczkai</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Chaotic flow: the physics of species coexistence</article-title><source>PNAS</source><volume>97</volume><fpage>13661</fpage><lpage>13665</lpage><pub-id pub-id-type="doi">10.1073/pnas.240242797</pub-id><pub-id pub-id-type="pmid">11087815</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kelly</surname> <given-names>JK</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The effect of scale dependent processes on kin selection: mating and density regulation</article-title><source>Theoretical Population Biology</source><volume>46</volume><fpage>32</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1994.1018</pub-id><pub-id pub-id-type="pmid">8079196</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>Y-C</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Diffusivity of bacteria</article-title><source>Korean Journal of Chemical Engineering</source><volume>13</volume><fpage>282</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1007/BF02705951</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koshel'</surname> <given-names>KV</given-names></name><name><surname>Prants</surname> <given-names>SV</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Chaotic advection in the ocean</article-title><source>Physics-Uspekhi</source><volume>49</volume><fpage>1151</fpage><lpage>1178</lpage><pub-id pub-id-type="doi">10.1070/PU2006v049n11ABEH006066</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kramer</surname> <given-names>J</given-names></name><name><surname>Meunier</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Kin and multilevel selection in social evolution: a never-ending controversy?</article-title><source>F1000Research</source><volume>5</volume><fpage>776</fpage><pub-id pub-id-type="doi">10.12688/f1000research.8018.1</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kümmerli</surname> <given-names>R</given-names></name><name><surname>Gardner</surname> <given-names>A</given-names></name><name><surname>West</surname> <given-names>SA</given-names></name><name><surname>Griffin</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Limited dispersal, budding dispersal, and cooperation: an experimental study</article-title><source>Evolution</source><volume>63</volume><fpage>939</fpage><lpage>949</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2008.00548.x</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>G</given-names></name><name><surname>Bensson</surname> <given-names>J</given-names></name><name><surname>Nisimova</surname> <given-names>L</given-names></name><name><surname>Munger</surname> <given-names>D</given-names></name><name><surname>Mahautmr</surname> <given-names>P</given-names></name><name><surname>Tang</surname> <given-names>JX</given-names></name><name><surname>Maxey</surname> <given-names>MR</given-names></name><name><surname>Brun</surname> <given-names>YV</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Accumulation of swimming Bacteria near a solid surface</article-title><source>Physical Review E</source><volume>84</volume><fpage>041932</fpage><pub-id pub-id-type="doi">10.1103/PhysRevE.84.041932</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lion</surname> <given-names>S</given-names></name><name><surname>Baalen</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Self-structuring in spatial evolutionary ecology</article-title><source>Ecology Letters</source><volume>11</volume><fpage>277</fpage><lpage>295</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2007.01132.x</pub-id><pub-id pub-id-type="pmid">18070102</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lion</surname> <given-names>S</given-names></name><name><surname>Jansen</surname> <given-names>VA</given-names></name><name><surname>Day</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Evolution in structured populations: beyond the kin versus group debate</article-title><source>Trends in Ecology &amp; Evolution</source><volume>26</volume><fpage>193</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2011.01.006</pub-id><pub-id pub-id-type="pmid">21353325</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname> <given-names>Y</given-names></name><name><surname>Zhu</surname> <given-names>C</given-names></name><name><surname>Ma</surname> <given-names>P</given-names></name><name><surname>Yu</surname> <given-names>KT</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Studies on the diffusion coefficients of amino acids in aqueous solutions</article-title><source>Journal of Chemical &amp; Engineering Data</source><volume>50</volume><fpage>1192</fpage><lpage>1196</lpage><pub-id pub-id-type="doi">10.1021/je049582g</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Medvinsky</surname> <given-names>AB</given-names></name><name><surname>Petrovskii</surname> <given-names>SV</given-names></name><name><surname>Tikhonova</surname> <given-names>IA</given-names></name><name><surname>Malchow</surname> <given-names>H</given-names></name><name><surname>Li</surname> <given-names>B-L</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Spatiotemporal complexity of plankton and fish dynamics</article-title><source>SIAM Review</source><volume>44</volume><fpage>311</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1137/S0036144502404442</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mimura</surname> <given-names>M</given-names></name><name><surname>Sakaguchi</surname> <given-names>H</given-names></name><name><surname>Matsushita</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Reaction–diffusion modelling of bacterial colony patterns</article-title><source>Physica A: Statistical Mechanics and Its Applications</source><volume>282</volume><fpage>283</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1016/S0378-4371(00)00085-6</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monod</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1949">1949</year><article-title>The growth of bacterial cultures</article-title><source>Annual Review of Microbiology</source><volume>3</volume><fpage>371</fpage><lpage>394</lpage><pub-id pub-id-type="doi">10.1146/annurev.mi.03.100149.002103</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadell</surname> <given-names>CD</given-names></name><name><surname>Bucci</surname> <given-names>V</given-names></name><name><surname>Drescher</surname> <given-names>K</given-names></name><name><surname>Levin</surname> <given-names>SA</given-names></name><name><surname>Bassler</surname> <given-names>BL</given-names></name><name><surname>Xavier</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cutting through the complexity of cell collectives</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>280</volume><elocation-id>20122770</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2012.2770</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nadell</surname> <given-names>CD</given-names></name><name><surname>Foster</surname> <given-names>KR</given-names></name><name><surname>Xavier</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Emergence of spatial structure in cell groups and the evolution of cooperation</article-title><source>PLoS Computational Biology</source><volume>6</volume><elocation-id>e1000716</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000716</pub-id><pub-id pub-id-type="pmid">20333237</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nickerson</surname> <given-names>CA</given-names></name><name><surname>Ott</surname> <given-names>CM</given-names></name><name><surname>Wilson</surname> <given-names>JW</given-names></name><name><surname>Ramamurthy</surname> <given-names>R</given-names></name><name><surname>Pierson</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Microbial responses to microgravity and other low-shear environments</article-title><source>Microbiology and Molecular Biology Reviews</source><volume>68</volume><fpage>345</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1128/MMBR.68.2.345-361.2004</pub-id><pub-id pub-id-type="pmid">15187188</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowak</surname> <given-names>MA</given-names></name><name><surname>May</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Evolutionary games and spatial Chaos</article-title><source>Nature</source><volume>359</volume><fpage>826</fpage><lpage>829</lpage><pub-id pub-id-type="doi">10.1038/359826a0</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowak</surname> <given-names>MA</given-names></name><name><surname>Sigmund</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Evolutionary dynamics of biological games</article-title><source>Science</source><volume>303</volume><fpage>793</fpage><lpage>799</lpage><pub-id pub-id-type="doi">10.1126/science.1093411</pub-id><pub-id pub-id-type="pmid">14764867</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nowak</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Five rules for the evolution of cooperation</article-title><source>Science</source><volume>314</volume><fpage>1560</fpage><lpage>1563</lpage><pub-id pub-id-type="doi">10.1126/science.1133755</pub-id><pub-id pub-id-type="pmid">17158317</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perlekar</surname> <given-names>P</given-names></name><name><surname>Benzi</surname> <given-names>R</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name><name><surname>Toschi</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Population dynamics at high Reynolds number</article-title><source>Physical Review Letters</source><volume>105</volume><elocation-id>144501</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.105.144501</pub-id><pub-id pub-id-type="pmid">21230833</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pigolotti</surname> <given-names>S</given-names></name><name><surname>Benzi</surname> <given-names>R</given-names></name><name><surname>Jensen</surname> <given-names>MH</given-names></name><name><surname>Nelson</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Population genetics in compressible flows</article-title><source>Physical Review Letters</source><volume>108</volume><elocation-id>128102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.108.128102</pub-id><pub-id pub-id-type="pmid">22540626</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollock</surname> <given-names>GB</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Population viscosity and kin selection</article-title><source>The American Naturalist</source><volume>122</volume><fpage>817</fpage><lpage>829</lpage><pub-id pub-id-type="doi">10.1086/284174</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rainey</surname> <given-names>PB</given-names></name><name><surname>Rainey</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Evolution of cooperation and conflict in experimental bacterial populations</article-title><source>Nature</source><volume>425</volume><fpage>72</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1038/nature01906</pub-id><pub-id pub-id-type="pmid">12955142</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rusconi</surname> <given-names>R</given-names></name><name><surname>Guasto</surname> <given-names>JS</given-names></name><name><surname>Stocker</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Bacterial transport suppressed by fluid shear</article-title><source>Nature Physics</source><volume>10</volume><fpage>212</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1038/nphys2883</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sachs</surname> <given-names>JL</given-names></name><name><surname>Mueller</surname> <given-names>UG</given-names></name><name><surname>Wilcox</surname> <given-names>TP</given-names></name><name><surname>Bull</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The evolution of cooperation</article-title><source>The Quarterly Review of Biology</source><volume>79</volume><fpage>135</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1086/383541</pub-id><pub-id pub-id-type="pmid">15232949</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sachs</surname> <given-names>JL</given-names></name><name><surname>Simms</surname> <given-names>EL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Pathways to mutualism breakdown</article-title><source>Trends in Ecology &amp; Evolution</source><volume>21</volume><fpage>585</fpage><lpage>592</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2006.06.018</pub-id><pub-id pub-id-type="pmid">16828927</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sandoz</surname> <given-names>KM</given-names></name><name><surname>Mitzimberg</surname> <given-names>SM</given-names></name><name><surname>Schuster</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Social cheating in Pseudomonas aeruginosa quorum sensing</article-title><source>PNAS</source><volume>104</volume><fpage>15876</fpage><lpage>15881</lpage><pub-id pub-id-type="doi">10.1073/pnas.0705653104</pub-id><pub-id pub-id-type="pmid">17898171</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Sandulescu</surname> <given-names>M</given-names></name><name><surname>López</surname> <given-names>C</given-names></name><name><surname>Hernández-García</surname> <given-names>E</given-names></name><name><surname>Feudel</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Plankton blooms in vortices: the role of biological and hydrodynamic time scales</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/0802.3973">https://arxiv.org/abs/0802.3973</ext-link></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname> <given-names>B</given-names></name><name><surname>Fletcher</surname> <given-names>JA</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Hamilton's rule in multi-level selection models</article-title><source>Journal of Theoretical Biology</source><volume>299</volume><fpage>55</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2011.07.014</pub-id><pub-id pub-id-type="pmid">21820447</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname> <given-names>B</given-names></name><name><surname>Fletcher</surname> <given-names>JA</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Towards a general theory of group selection</article-title><source>Evolution</source><volume>67</volume><fpage>1561</fpage><lpage>1572</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2012.01835.x</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>Group selection and kin selection</article-title><source>Nature</source><volume>201</volume><fpage>1145</fpage><lpage>1147</lpage><pub-id pub-id-type="doi">10.1038/2011145a0</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szabó</surname> <given-names>G</given-names></name><name><surname>Fáth</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Evolutionary games on graphs</article-title><source>Physics Reports</source><volume>446</volume><fpage>97</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1016/j.physrep.2007.04.004</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname> <given-names>JR</given-names></name><name><surname>Stocker</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Trade-offs of chemotactic foraging in turbulent water</article-title><source>Science</source><volume>338</volume><fpage>675</fpage><lpage>679</lpage><pub-id pub-id-type="doi">10.1126/science.1219417</pub-id><pub-id pub-id-type="pmid">23118190</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname> <given-names>PD</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Altruism in viscous populations — an inclusive fitness model</article-title><source>Evolutionary Ecology</source><volume>6</volume><fpage>352</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1007/BF02270971</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tél</surname> <given-names>T</given-names></name><name><surname>de Moura</surname> <given-names>A</given-names></name><name><surname>Grebogi</surname> <given-names>C</given-names></name><name><surname>Károlyi</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Chemical and biological activity in open flows: a dynamical system approach</article-title><source>Physics Reports</source><volume>413</volume><fpage>91</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1016/j.physrep.2005.01.005</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname> <given-names>C</given-names></name><name><surname>Ling</surname> <given-names>Z</given-names></name><name><surname>Lin</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Turing pattern formation in a predator–prey–mutualist system</article-title><source>Nonlinear Analysis: Real World Applications</source><volume>12</volume><fpage>3224</fpage><lpage>3237</lpage><pub-id pub-id-type="doi">10.1016/j.nonrwa.2011.05.022</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traulsen</surname> <given-names>A</given-names></name><name><surname>Nowak</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Evolution of cooperation by multilevel selection</article-title><source>PNAS</source><volume>103</volume><fpage>10952</fpage><lpage>10955</lpage><pub-id pub-id-type="doi">10.1073/pnas.0602530103</pub-id><pub-id pub-id-type="pmid">16829575</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trivers</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The evolution of reciprocal altruism</article-title><source>The Quarterly Review of Biology</source><volume>46</volume><fpage>35</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1086/406755</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turing</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>The chemical basis of morphogenesis. 1953</article-title><source>Bulletin of Mathematical Biology</source><volume>52</volume><fpage>153</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.1007/BF02459572</pub-id><pub-id pub-id-type="pmid">2185858</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vural</surname> <given-names>DC</given-names></name><name><surname>Isakov</surname> <given-names>A</given-names></name><name><surname>Mahadevan</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The organization and control of an evolving interdependent population</article-title><source>Journal of the Royal Society Interface</source><volume>12</volume><elocation-id>20150044</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2015.0044</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vural</surname> <given-names>DC</given-names></name><name><surname>Morrison</surname> <given-names>G</given-names></name><name><surname>Mahadevan</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Aging in complex interdependency networks</article-title><source>Physical Review E</source><volume>89</volume><fpage>022811</fpage><pub-id pub-id-type="doi">10.1103/PhysRevE.89.022811</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wakano</surname> <given-names>JY</given-names></name><name><surname>Nowak</surname> <given-names>MA</given-names></name><name><surname>Hauert</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Spatial dynamics of ecological public goods</article-title><source>PNAS</source><volume>106</volume><fpage>7910</fpage><lpage>7914</lpage><pub-id pub-id-type="doi">10.1073/pnas.0812644106</pub-id><pub-id pub-id-type="pmid">19416839</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>West</surname> <given-names>SA</given-names></name><name><surname>Griffin</surname> <given-names>AS</given-names></name><name><surname>Gardner</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Social semantics: altruism, cooperation, mutualism, strong reciprocity and group selection</article-title><source>Journal of Evolutionary Biology</source><volume>20</volume><fpage>415</fpage><lpage>432</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2006.01258.x</pub-id><pub-id pub-id-type="pmid">17305808</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Williams</surname> <given-names>GC</given-names></name></person-group><year iso-8601-date="1966">1966</year><source>Adaptation and Natural Selection. Princeton</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DS</given-names></name><name><surname>Pollock</surname> <given-names>GB</given-names></name><name><surname>Dugatkin</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Can altruism evolve in purely viscous populations?</article-title><source>Evolutionary Ecology</source><volume>6</volume><fpage>331</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1007/BF02270969</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DS</given-names></name><name><surname>Sober</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Reintroducing group selection to the human behavioral sciences</article-title><source>Behavioral and Brain Sciences</source><volume>17</volume><fpage>585</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1017/S0140525X00036104</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>A theory of group selection</article-title><source>PNAS</source><volume>72</volume><fpage>143</fpage><lpage>146</lpage><pub-id pub-id-type="doi">10.1073/pnas.72.1.143</pub-id><pub-id pub-id-type="pmid">1054490</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>WG</given-names></name><name><surname>Morris</surname> <given-names>WF</given-names></name><name><surname>Bronstein</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Coexistence of mutualists and exploiters on spatial landscapes</article-title><source>Ecological Monographs</source><volume>73</volume><fpage>397</fpage><lpage>413</lpage><pub-id pub-id-type="doi">10.1890/02-0297</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wynne-Edwards</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="1962">1962</year><source>Animal Dispersion in Relation to Social Behaviour</source><publisher-loc>New York</publisher-loc><publisher-name>Hafner Publishing Co</publisher-name></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s6" sec-type="appendix"><boxed-text><object-id pub-id-type="doi">10.7554/eLife.34862.022</object-id><p>Here we describe a number of simplifying assumptions and following mathematical analysis that allow us to make sense of our simulation results, both qualitatively and quantitatively. Our approach is the standard Turing analysis commonly used to describe pattern formation in reaction diffusion systems. We first obtain a steady state solution, that is find out the population density and concentration of the public good and waste compound that leads to an equilibrium state. We then linearize the system around this equilibrium, and find out what kind of perturbations destabilize this equilibrium. The spotty patterns that form upon destabilization biologically correspond to cooperating microbial communities, the size of which we obtain in terms of system parameters. Our analytical outcomes are compared to discrete simulations in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p><p>Our simulations start with the whole population having a given secretion rate. The Turing analysis conducted below is then to find the group size and reproduction rate with this secretion rate.</p><fig id="app1fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.34862.023</object-id><label>Appendix 1—figure 1.</label><caption><title>Secretion rate distributions of groups under different shear rates.</title><p>Microbes are grouped by their position in space and the distribution of their secretion rates is plotted. Simulations were started with a secretion rate of 100 and random mutations were allowed to change the secretion rate of individual microbes. Distributions are given by looking at 10 simulations for each shear rate after a duration of <inline-formula><mml:math id="inf96"><mml:mrow><mml:mn>2.0</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> s. (<bold>A</bold>) With no shear, there are very few groups left at the chosen time and these will eventually go extinct. Cheaters have taken over these groups and individual groups are homogeneous in secretion rate. (<bold>B</bold>) With some added shear, groups are better able to beat cheating mutations, but the bulk of the distribution is still at lower secretion rates. (<bold>C</bold>) At higher shear rates there are more groups centered at a higher secretion rate due to shear augmented group fragmentation. In all cases, groups that initially start off with a heterogeneous population quickly become homogeneous, as seen by the delta peaks in the distributions. Each peak corresponds to a group. In the larger population however, groups of different secretion rates can and do coexist, as seen by the distribution of the peaks. In this case we can still analyze individual groups by looking at their secretion rate. The Matlab code and data for this figure is provided in <xref ref-type="supplementary-material" rid="app1fig1sdata1">Appendix 1—figure 1—source data 1</xref>.</p><p><supplementary-material id="app1fig1sdata1"><object-id pub-id-type="doi">10.7554/eLife.34862.024</object-id><label>Appendix 1—figure 1—source data 1.</label><caption><title>Matlab data and code files for figure in appendix.</title></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-34862-app1-fig1-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-34862-app1-fig1-v2"/></fig><p>We also observe in our simulations, that groups are typically homogeneous in terms of secretion rate; that is once a cheating mutation occurs in a group, it fixates and quickly takes over the group, on a time scale much quicker than the group fragmentation (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). In other words, while the populations in different groups may have different secretion rates, the secretion rate within one group is approximately uniform. We can therefore simplify our equations to determine the spatial structure of a group in terms of the secretion rate of its constituents, even after mutations occur. To determine the native group size and reproduction rate (i.e. when there is no shear and mutation) we can now write down a simplified set of equations,.<disp-formula id="equ13"><label>(6)</label><mml:math id="m13"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><label>(7)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ15"><label>(8)</label><mml:math id="m15"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Through some rescaling, we can non-dimensionalize the system. If we define the rescaled variables as<disp-formula id="equ16"><label>(9)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">←</mml:mo><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:msqrt><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:msqrt></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi>μ</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>μ</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">←</mml:mo><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mi>σ</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mfrac><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>then our equations become,<disp-formula id="equ17"><label>(10)</label><mml:math id="m17"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:malignmark/><mml:mo>=</mml:mo><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ18"><label>(11)</label><mml:math id="m18"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ19"><label>(12)</label><mml:math id="m19"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mo>∇</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>σ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We will now obtain steady states and conditions for linear stability. We first obtain the steady states in the absence of diffusion and investigate the stability of the system. The steady states are given by<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mi>σ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>σ</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p><p>This gives, either the trivial solution <inline-formula><mml:math id="inf97"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>2</mml:mn><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, or the solutions:<disp-formula id="equ21"><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>±</mml:mo><mml:msqrt><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>a</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. For this to be a sensible solution, we require <inline-formula><mml:math id="inf100"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to be real and positive. This also imposes conditions on the system parameters.</p><p>Next, we establish the local stability of this solution by perturbing the system away from the steady state and expand up to first order. We take the perturbation <inline-formula><mml:math id="inf101"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>2</mml:mn><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, and substitute it into our system to get the linear system<disp-formula id="equ22"><label>(13)</label><mml:math id="m22"><mml:mrow><mml:mfrac><mml:mo>∂</mml:mo><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>With the stability matrix, <inline-formula><mml:math id="inf102"><mml:mi>A</mml:mi></mml:math></inline-formula>, given as,<disp-formula id="equ23"><label>(14)</label><mml:math id="m23"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>σ</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p> where<disp-formula id="equ24"><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The system is stable if the eigenvalues, <inline-formula><mml:math id="inf103"><mml:mi>Λ</mml:mi></mml:math></inline-formula> of this matrix have a negative real part. The characteristic polynomial for the eigenvalues is given as <inline-formula><mml:math id="inf104"><mml:mrow><mml:msup><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>Λ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, where<disp-formula id="equ25"><mml:math id="m25"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:msub><mml:mi>A</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>σ</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>σ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Since the first two coefficients of the characteristic equation are positive, by Descartes’ rule of signs, in order to get only negative real part eigenvalues, we need <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> to be positive as well. This is a requirement for linear stability. Thus, we have the conditions<disp-formula id="equ26"><mml:math id="m26"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mi>σ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>σ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>⇒</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Next we include diffusion and analyze the instability caused by diffusion. Fourier expanding the solution<disp-formula id="equ27"><label>(15)</label><mml:math id="m27"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>W</mml:mi></mml:mstyle><mml:mo>(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder></mml:mstyle><mml:mtext> </mml:mtext><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>k</mml:mi></mml:mstyle><mml:mo>⋅</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>k</mml:mi></mml:mstyle><mml:mo>)</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and plugging this into our equations, we get the eigenvalue equation, <inline-formula><mml:math id="inf107"><mml:mrow><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>W</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mi>Λ</mml:mi><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>W</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula>, where<disp-formula id="equ28"><label>(16)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Solving for the eigenvalues again gives a characteristic equation of the form <inline-formula><mml:math id="inf108"><mml:mrow><mml:msup><mml:mi>Λ</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:msup><mml:mi>Λ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mi>Λ</mml:mi><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, where now<disp-formula id="equ29"><label>(17)</label><mml:math id="m29"><mml:mrow><mml:mi>A</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>Θ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ30"><label>(18)</label><mml:math id="m30"><mml:mrow><mml:mi>B</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ31"><label>(19)</label><mml:math id="m31"><mml:mrow><mml:mi>C</mml:mi><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and the <inline-formula><mml:math id="inf109"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> dependent functions are,<disp-formula id="equ32"><label>(20)</label><mml:math id="m32"><mml:mrow><mml:mi>Θ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ33"><label>(21)</label><mml:math id="m33"><mml:mrow><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ34"><label>(22)</label><mml:math id="m34"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>k</mml:mi><mml:mn>6</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>4</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>σ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>σ</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We can again use Descartes’ rule of signs, this time looking for an instability, which will happen when <inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is sufficiently negative. To be precise, the range of unstable wavenumbers satisfy,<disp-formula id="equ35"><label>(23)</label><mml:math id="m35"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>At the critical values for the diffusion parameters, the function <inline-formula><mml:math id="inf111"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only vanishes at one point, the local minumum of <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>Ψ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. This occurs at the critical <inline-formula><mml:math id="inf113"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> value where <inline-formula><mml:math id="inf114"><mml:mrow><mml:mtext>d</mml:mtext><mml:mi>Ψ</mml:mi><mml:mo>/</mml:mo><mml:mtext>d</mml:mtext><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, giving<disp-formula id="equ36"><label>(24)</label><mml:math id="m36"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mrow><mml:mtext>crit</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p> where <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf116"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>σ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>σ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> We take the positive root in 33 corresponding to the physical, positive <inline-formula><mml:math id="inf117"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>For all combinations of parameters giving rise to stable groups, we observe in our simulations that the group size approximated well by <inline-formula><mml:math id="inf118"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>fast</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where, <inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>fast</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the wave number corresponding to the fastest growing mode (i.e. the value that maximizes <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi>Λ</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>). The size of the microbial clusters, as obtained by analytical theory <inline-formula><mml:math id="inf121"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>fast</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and stochastic simulations are shown in the top row of 3. The color indicates the size of microbialgroups.</p><p>Roughly speaking, if we view a microbial cluster as the cause of perturbation at a nearby location, the Turing instability will manifest as group reproduction. We should strongly caution that as the instability proceeds, the system moves away from the initial unstable fixed point around which it was linearized, and thus the exponential dependence in 24 should eventually break down. Nevertheless, the eigenvalues in the exponents still provide us with an approximate estimation of the group reproduction rate, within a factor of two near the phase boundary.</p></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.34862.026</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Gore</surname><given-names>Jeff</given-names></name><role>Reviewing Editor</role><aff id="aff3"><institution>Massachusetts Institute of Technology</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your work entitled &quot;Shearing in flow environment promotes evolution of social behavior in microbial populations&quot; for consideration by <italic>eLife</italic>. Your article has been evaluated by a Senior Editor and three reviewers, one of whom, Jeff Gore (Reviewer #3), served as Reviewing Editor. Our decision has been reached after consultation between the reviewers.</p><p>The referees appreciated that the study allows for a principled way of thinking about how spatial structure could arise. However, there were several significant concerns that were expressed regarding the presentation, conceptual framing, and technical implementation of the model. We do believe that the approach has potential, so if you can address all the concerns of the referees, we would consider a new manuscript.</p><p>Major issues that would have to be addressed:</p><p>* Framing of the question in terms of spatial structure vs. group selection</p><p>* Clarify how heterogeneity is analyzed in the population</p><p>* Does the social strain actually evolve / spread in the model?</p><p>* Show what happens with fixed strategies with and without flow and with and without the Turing pattern and then explore the effect of evolution</p><p>* Was there an error in the implementation of the model? (See reviewer #2's comments.)</p><p><italic>Reviewer #1:</italic> </p><p>The manuscripts considers the problem of how cooperation survives in the presence of cheaters. The explanation is based on the Simpson's paradox (paper by Stan Leibler is not cited and the mechanism is not discussed). The novelty is that the metacommunity dynamics emerge from the governing equations rather than being externally imposed.</p><p>Specifically, the production of public good and waste are set up to produce a Turing instability, which creates patches of high population density separated by voids. These act as local communities in a meta community. Within each patch cooperators are outcompeted, but patches with many cooperators grow faster than patches with few cooperators. As a result, cooperators persist.</p><p>The key factor in the above argument is that the competition occurs between different patches. It seems to me that, for this to happen, the patches need to be constantly reformed. Reforming could occur due to breaking of the Turing patters by the flow. I think this mechanism is very important, but it is not discussed in the manuscript in any detail. Instead, a lot of the Discussion is focused on the enhancement of the cluster growth rate due to flow. While this enhancement plays a role, it is not clear whether this or the above mechanism is the dominant force. This seems to be a major point to address.</p><p>Other comments. The first half of the paper restates the standard results from Turing pattern formation and is better suited for Supplementary Information. I don't think these derivations are necessary to understand the main results and will probably be skipped by most readers. The simulation methods need to be better discussed. The following paper could also be relevant, Drescher, Knut, et al., 2014.</p><p>Overall, this seems to be a solid research paper. As far as potential impact, there are three distracting factors:</p><p>1) Simpson's paradox is pretty well established.</p><p>2) Turing patterns are known to occur in ecological models and possibly real ecosystems. The fact that inhomogeneous spatial densities due to Turing patterns affect species interactions is also well known. There is a lot of literature on this. See for example Wilson, Morris and Bronstein, 2003.</p><p>3) It is not clear whether the specific model is applicable to any specific ecosystem or that the Turing mechanism is robust and present in actual microbial communities.</p><p><italic>Reviewer #2:</italic> </p><p>In this paper, the authors show that advection in the spatial population dynamics of microbes can lead to the assortment that is necessary to maintain cooperation (in the form of public good production).</p><p>This is potentially interesting, but I find the background and Introduction of the paper conceptually flawed. Moreover, the basic model seems to contain an error.</p><p>For me, the conceptual problems start with the first sentence of the Abstract: &quot;It is advantageous for microbes to form social aggregates when they commonly benefit from secreting a public good.&quot; This is the wrong premise: whether it is advantageous to form groups is a question, not a fact.</p><p>Similarly, in the Introduction the authors state: &quot;… until the lack of public goods compromise the fitness of the entire group&quot;. This sounds like it is already known how this plays out, but that's exactly the problem: it is generally <italic>not</italic> known how this plays out. The way the authors are stating this, the outcome would be a matter of the relative strength of individual vs. group selection.</p><p>However, despite the fact that they are vaguely referring to &quot;group fitness&quot; and &quot;species fitness&quot; throughout the paper, their model does not have reproducing groups, and hence they are not talking about group selection (see also below). In fact, they are talking about individual selection, and in particular they are talking about a particular mechanisms, advection, that can lead to assortment of cooperative types and thereby the maintenance of cooperation.</p><p>In general, the Introduction doesn't make much conceptual sense to me. For example, I don't see how quorum sensing falls into the category of mechanism where altruism is a consequence of a self-serving trait. With quorum sensing, the problem is shifted onto the production of the sensing signal, which becomes itself a public good. Judging from the literature cited, the authors do not seem to be up to date with group selection theory: Simon et al., 2012, 2013 have shown that kin selection is <italic>not</italic> closely linked to kin selection, as claimed by the authors in the third paragraph of the Introduction.</p><p>Group selection is an altogether different mechanism than selection at the individual level, of which kin selection is an example. In general, all individual-level explanations for cooperation, including kin selection, can be understood on the basis of assortment (Fletcher and Doebeli 2009). Group selection is a conceptually different mechanism that involves differential birth and death of groups with different type compositions, as well as (possibly) interactions between groups (Simon et al., 2013). In particular, it seems clear that the mechanism for the evolution of cooperation proposed by the authors is an example of (spatial) assortment, and not of group selection as they claim. They mention that in their model, spatial groups form and &quot;reproduce&quot;, but this is simply an emergent property of the model, and the significance of the differential reproductive success of different groups is not investigated in the paper. My guess is that even if these &quot;groups&quot; would not reproduce, cooperation would still be maintained due to the assortment caused by advection. Overall, it is therefore not clear that the authors fully understand the conceptual underpinnings of the evolution of cooperation, and how their model fits with existing theory and concepts.</p><p>Perhaps more importantly, I think the basic model 1-3 may contain a fundamental flaw. Specifically, in Equation 2 the term -<italic>ns<sub>1</sub></italic> does not seem to make sense, since this represents only the public good produced by those microbes whose cooperation level is <italic>s<sub>1</sub></italic>. This term should be replaced by an integral over <italic>s<sub>1</sub></italic>, thus measuring the contribution to the public good of all types. Similarly, the term -<italic>ns<sub>2</sub></italic> in Equation 3 seems wrong, as here the term <italic>n</italic> should be replaced by an integral over all types <italic>s<sub>1</sub></italic>, i.e., n should be replaced by the total number of all microbes living at a given location. (Note that the model does not assume only a single type <italic>s<sub>1</sub> </italic>at any given location; otherwise the second derivative with respect to <italic>s<sub>1</sub> </italic>in Equation 1, i.e., diffusion in <italic>s<sub>1</sub> </italic>space, would not make sense.) Given that the basic equations may be wrong, I am uneasy about the rest of the analysis in the paper.</p><p><italic>Reviewer #3:</italic> </p><p>Overall, I found this to be an intriguing combination of two rather different fields. As the authors describe, there is a long history of theory and experiment probing the conditions required for the evolution of cooperative behaviors, and some of this work has focused on spatial structure. However, little of the work has considered interesting flow fields with shear. I very much like the idea of a public good and a public bad, each of which is secreted. Then, if the public bad diffuses faster than the public good it is possible to have Turing instabilities.</p><p>My primary concern is that I didn't understand how the dynamics between cooperation and cheating took place in terms of distribution and abundance of the different strategies. How much cooperation was present in the various flow situations? Was there heterogeneity in the population? What would happen if there were a (non-evolving) fixed cooperator and another genetic cheater?</p><p>[Editors’ note: what now follows is the decision letter after the authors submitted for further consideration.]</p><p>Thank you for resubmitting your work entitled &quot;Shearing in flow environment promotes evolution of social behavior in microbial populations&quot; for further consideration at <italic>eLife</italic>. Your revised article has been evaluated by Arup Chakraborty (Senior Editor), and three reviewers, one of whom served as Reviewing Editor</p><p>The manuscript has been improved but there are remaining issues that need to be addressed before the manuscript can be considered for acceptance, as outlined below:</p><p>Two of the three reviewers are still uncomfortable with your treatment of heterogeneity in the population. Even if a cheater will quickly take over a local population, it does not mean that there cannot be heterogeneity of different levels of cooperation within each local population or within the broader metapopulation, where different groups could have different levels of cooperation. As far as we can tell, this sort of heterogeneity was never analyzed in the paper, but we think that it is very important for a complete understanding of the system. As indicated below in more detail, this is not simply a question of &quot;notation.&quot; It seems that the integral was added into the model description but that no analysis of this heterogeneity was actually done.</p><p>Please consider the following points in revising your manuscript:</p><p>1] The authors state that &quot;It is well known that evolution of altruism in species strongly depends on the individuals being discrete (Durrett and Levin (1994)). This would seem to imply that deterministic models, e.g. involving differential equations for frequencies of different types, would never lead to cooperation, which is of course not true. Furthermore, the argument in Simon et al. (2012) for why group selection is different from kin selection is <italic>not</italic> primarily based on the asynchrony of individual-level and group-level events. Rather, it is a consequence of the fact that assortment (or, equivalently, relatedness) may have no influence on certain group level events, such as games between groups.</p><p>2] The authors' statement in the rebuttal letter that &quot;This change in notation does not affect our results or analysis, since in our simulations we start the population with a fixed secretion rate.&quot; is unclear to us. First, starting with a fixed secretion rate would not make the original equations correct, because mutation would quickly lead to a situation in which secretion rates are variable. Second, what is meant by &quot;a change in notation does not affect our results&quot;? Of course, a change in notation does not affect anything, apart from the notation in itself. The question is whether the simulations were carried out correctly, i.e., with the integral (summation) term taken into account. Have the simulations been carried out according to the new, correct equations?</p><p>3] The authors' finding that without advection, cooperation cannot be maintained in their system is curious. This seems contrary to previous work by Hauert and colleagues (Wakano et al., 2009), which shows that cooperation is maintained in public goods reaction-diffusion systems. I am wondering about the cause of the different outcomes in these models. Is it due to the continuous nature of the secretion trait considered in the present study? If so, this might be important to point out in the Discussion.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.34862.027</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the author responses to the first round of peer review follow.]</p><p>Reviewer #1:</p><disp-quote content-type="editor-comment"><p>The manuscripts considers the problem of how cooperation survives in the presence of cheaters. The explanation is based on the Simpson's paradox (paper by Stan Leibler is not cited and the mechanism is not discussed). The novelty is that the metacommunity dynamics emerge from the governing equations rather than being externally imposed.</p></disp-quote><p>We have now added a reference to Stan Leibler’s paper [1] in the Introduction and final discussion citing that our results also fall under the broad phenomenon of Simpson’s paradox (Introduction, eleventh paragraph, Discussion, second paragraph).</p><disp-quote content-type="editor-comment"><p>Specifically, the production of public good and waste are set up to produce a Turing instability, which creates patches of high population density separated by voids. These act as local communities in a meta community. Within each patch cooperators are outcompeted, but patches with many cooperators grow faster than patches with few cooperators. As a result, cooperators persist.</p><p>The key factor in the above argument is that the competition occurs between different patches. It seems to me that, for this to happen, the patches need to be constantly reformed. Reforming could occur due to breaking of the Turing patters by the flow. I think this mechanism is very important, but it is not discussed in the manuscript in any detail. Instead, a lot of the Discussion is focused on the enhancement of the cluster growth rate due to flow. While this enhancement plays a role, it is not clear whether this or the above mechanism is the dominant force. This seems to be a major point to address.</p></disp-quote><p>We have now added more discussion to clarify that it is indeed the shear driven group fragmentation that promotes sociality, and not the growth rate of the clusters (subsection “Social groups as Turing patterns”). We have also modified Figure 2 to better illustrate the main mechanism, and have included videos of our simulations in Supplementary files 1-5. Also, Figure 4A shows that group fragmentation rate increases with shear.</p><disp-quote content-type="editor-comment"><p>Other comments. The first half of the paper restates the standard results from Turing pattern formation and is better suited for Supplementary Information. I don't think these derivations are necessary to understand the main results and will probably be skipped by most readers. The simulation methods need to be better discussed. The following paper could also be relevant, Drescher, Knut, et al., 2014.</p></disp-quote><p>We have now moved the mathematical details to an appendix to help clarify the biological results. We have added more detail in the Materials and methods section (fourth paragraph) explaining our simulation methods. We have also added a reference to Drescher’s paper [2] (Introduction, seventh paragraph).</p><disp-quote content-type="editor-comment"><p>Overall, this seems to be a solid research paper. As far as potential impact, there are three distracting factors:</p><p>1) Simpson's paradox is pretty well established.</p><p>2) Turing patterns are known to occur in ecological models and possibly real ecosystems. The fact that inhomogeneous spatial densities due to Turing patterns affect species interactions is also well known. There is a lot of literature on this. See for example Wilson, Morris and Bronstein, 2003.</p><p>3) It is not clear whether the specific model is applicable to any specific ecosystem or that the Turing mechanism is robust and present in actual microbial communities.</p></disp-quote><p>Regarding the “distracting factors” mentioned above, we agree that Simpson’s paradox and Turing patterns in nature are well known. We now emphasize in the paper, that the novelty is not in the Turing mechanism. This is our starting point (Introduction, eleventh paragraph). We now clarify in the paper that the novel aspect of our work is the effect of fluid shear on spatial assortment and on the evolution of cooperation (Introduction, twelfth paragraph). We’ve also added reference to Wilson’s paper [3] (Introduction, eleventh paragraph and subsection “Social groups as Turing patterns”, first paragraph) as well as references to studies finding growth patterns in microbial systems [4,5].</p><p>As for point number three: We would be very excited to see experimental verification of our fluid dynamical model in specific aquatic niches. We now emphasize that we have built our model and chosen parameter values (e.g. diffusion constants, decay rates, flow velocities etc.) from well-established results (Materials and methods, third and last paragraphs) that would generalize to a wide range of systems (Introduction, tenth paragraph). Hopefully this generality will inspire experimentalists to look for the phenomenon we reported.</p><p>1] Chuang, John S., Olivier Rivoire, and Stanislas Leibler. &quot;Simpson's paradox in a synthetic microbial system.&quot; Science323.5911 (2009): 272-275.</p><p>2] Drescher, Knut, et al. &quot;Solutions to the public goods dilemma in bacterial biofilms.&quot; Current Biology 24.1 (2014): 50-55.</p><p>3] Wilson, W. G., W. F. Morris, and J. L. Bronstein. &quot;Coexistence of mutualists and exploiters on spatial landscapes.&quot; Ecological monographs 73.3 (2003): 397-413.</p><p>4] Ben-Jacob, Eshel, et al. &quot;Generic modelling of cooperative growth patterns in bacterial colonies.&quot; Nature 368.6466 (1994): 46-49.</p><p>5] Chang-Li, Xie, et al. &quot;Microcalorimetric study of bacterial growth.&quot; Thermochimica Acta 123 (1988): 33-41.</p><p>Reviewer #2:</p><disp-quote content-type="editor-comment"><p>In this paper, the authors show that advection in the spatial population dynamics of microbes can lead to the assortment that is necessary to maintain cooperation (in the form of public good production).</p><p>This is potentially interesting, but I find the background and Introduction of the paper conceptually flawed. Moreover, the basic model seems to contain an error.</p><p>For me, the conceptual problems start with the first sentence of the Abstract: &quot;It is advantageous for microbes to form social aggregates when they commonly benefit from secreting a public good.&quot; This is the wrong premise: whether it is advantageous to form groups is a question, not a fact.</p><p>Similarly, in the Introduction the authors state: &quot;… until the lack of public goods compromise the fitness of the entire group&quot;. This sounds like it is already known how this plays out, but that's exactly the problem: it is generally not known how this plays out. The way the authors are stating this, the outcome would be a matter of the relative strength of individual vs. group selection.</p></disp-quote><p>We have now changed the Abstract to state that the general question is how microbes maintain cooperative behavior. Additionally, we state (subsection “Social groups as Turing patterns”) that one way to maintain this behavior is through forming social groups. In our model, without this spatial structuring, the population does get taken over by cheaters. We have also modified Figure 2 to illustrate this phenomenon in a clearer way. We have also included videos of simulations in the different scenarios in Supplementary files 1-5.</p><disp-quote content-type="editor-comment"><p>However, despite the fact that they are vaguely referring to &quot;group fitness&quot; and &quot;species fitness&quot; throughout the paper, their model does not have reproducing groups, and hence they are not talking about group selection (see also below). In fact, they are talking about individual selection, and in particular they are talking about a particular mechanisms, advection, that can lead to assortment of cooperative types and thereby the maintenance of cooperation.</p></disp-quote><p>We clarify that we indeed have reproducing and dying groups in our system, these are emergent phenomena from the individual level dynamics, this is evident from (Equations 6, 9, 10) and also, Figure 4A gives the group reproduction rate as a function of shear. To clarify this, we have also added some more discussion (Introduction, eleventh paragraph and subsection “Social groups as Turing patterns”). Also, we have now modified Figure 2 to explicitly show how shear driven group fragmentation enhances cooperation. The videos included in the supplementary files also illustrate this. Hopefully this should greatly clarify our main finding.</p><disp-quote content-type="editor-comment"><p>In general, the Introduction doesn't make much conceptual sense to me. For example, I don't see how quorum sensing falls into the category of mechanism where altruism is a consequence of a self-serving trait. With quorum sensing, the problem is shifted onto the production of the sensing signal, which becomes itself a public good.</p></disp-quote><p>We have clarified this discussion to explain how quorum sensing can be an example of reciprocity (Introduction, third paragraph); the cited paper by Allen 2016, discusses this phenomenon.</p><disp-quote content-type="editor-comment"><p>Judging from the literature cited, the authors do not seem to be up to date with group selection theory: Simon et al., 2012, 2013 have shown that kin selection is not closely linked to kin selection, as claimed by the authors in the third paragraph of the Introduction.</p><p>Group selection is an altogether different mechanism than selection at the individual level, of which kin selection is an example. In general, all individual-level explanations for cooperation, including kin selection, can be understood on the basis of assortment (Fletcher and Doebeli 2009). Group selection is a conceptually different mechanism that involves differential birth and death of groups with different type compositions, as well as (possibly) interactions between groups (Simon et al., 2013). In particular, it seems clear that the mechanism for the evolution of cooperation proposed by the authors is an example of (spatial) assortment, and not of group selection as they claim. They mention that in their model, spatial groups form and &quot;reproduce&quot;, but this is simply an emergent property of the model, and the significance of the differential reproductive success of different groups is not investigated in the paper. My guess is that even if these &quot;groups&quot; would not reproduce, cooperation would still be maintained due to the assortment caused by advection. Overall, it is therefore not clear that the authors fully understand the conceptual underpinnings of the evolution of cooperation, and how their model fits with existing theory and concepts.</p></disp-quote><p>The review by Kramer [1] shows that this is still not a settled discussion. The model proposed by Simon [2, 3] makes an interesting point that since individual and group level selection are asynchronous in nature, they cannot be equivalent. We agree that according to the definition given by [2], group selection is different from kin selection, though there is still some debate on this [1, 4-6]. Nevertheless, we agree that our mechanism can be better described by individual level selection, and rather than muddle the discussion with group selection, we have changed our discussion throughout from group selection to individual selection and spatial assortment. Indeed, the fluid dynamical / diffusion equations on which the simulations are based on describes the growth and evolution of individual microbes, and not of groups. We therefore change our discussion to now focus on assortment that arises from population viscosity and budding dispersal, which, in our case, emerges from the Turing instability. We clarify this further with discussion (Introduction, fourth and fifth paragraphs) and have added references to Simon [2, 3] as well as Fletcher and Doebeli [7]. We also emphasize that cooperation would not be maintained without group fragmentation. Advection only enhances the group fragmentation, whereas the spatial isolation of microbial groups caused by the Turing instability is what allows for cooperation to persist (subsection “Social groups as Turing patterns”). We have now modified Figure 2 to illustrate this.</p><disp-quote content-type="editor-comment"><p>Perhaps more importantly, I think the basic model 1-3 may contain a fundamental flaw. Specifically, in Equation 2 the term -ns<sub>1</sub> does not seem to make sense, since this represents only the public good produced by those microbes whose cooperation level is s<sub>1</sub>. This term should be replaced by an integral over s<sub>1</sub>, thus measuring the contribution to the public good of all types. Similarly, the term -ns<sub>2</sub> in Equation 3 seems wrong, as here the term n should be replaced by an integral over all types s<sub>1</sub>, i.e., n should be replaced by the total number of all microbes living at a given location. (Note that the model does not assume only a single type s<sub>1</sub> at any given location; otherwise the second derivative with respect to s<sub>1</sub> in Equation 1, i.e., diffusion in s<sub>1</sub> space, would not make sense.) Given that the basic equations may be wrong, I am uneasy about the rest of the analysis in the paper.</p></disp-quote><p>The referee is correct. The old version of the equation did not notate the continuum of possible secretion rates. We have now changed the equations of the model in the Materials and methods section, where our notation now accounts for a continuum of possible secretion rates. This change in notation does not affect our results or analysis, since in our simulations we start the population with a fixed secretion rate. The Turing analysis conducted in the paper is to find the native group size and reproduction rate with this secretion rate. We also observe in our simulations that groups are typically homogeneous in terms of secretion rate; i.e. once a cheating mutation occurs in a group, it fixates and quickly takes over the group, on a time scale much quicker than the group fragmentation. Therefore, this simplification is also applicable after mutations occur.</p><p>To better clarify our analysis, we have now moved the mathematical analysis into the appendix. We have added discussion in the first section of the appendix on how we can make some simplifying assumptions to the model to analyze homogenous groups (Appendix 1, first to fourth paragraphs). We also better clarify our simulation methods and acknowledge that we do not expect perfect agreement between the stochastic-discrete simulations and the continuous equations, although we were able to obtain the relevant quantities such as group size and reproduction rate, to good approximation, using a continuum analysis (Materials and methods, fourth paragraph).</p><p>1] Kramer, Jos, and Joël Meunier. &quot;Kin and multilevel selection in social evolution: a never-ending controversy?.&quot; F1000Research 5 (2016).</p><p>2] Simon, Burton, Jeffrey A. Fletcher, and Michael Doebeli. &quot;Towards a general theory of group selection.&quot; Evolution 67.6 (2013): 1561-1572.</p><p>3] Simon, Burton, Jeffrey A. Fletcher, and Michael Doebeli. &quot;Hamilton's rule in multi-level selection models.&quot; Journal of theoretical biology 299 (2012): 55-63.</p><p>4] West, Stuart A., Ashleigh S. Griffin, and Andy Gardner. &quot;Social semantics: altruism, cooperation, mutualism, strong reciprocity and group selection.&quot; Journal of evolutionary biology 20.2 (2007): 415432.</p><p>5] Gardner, Andy. &quot;The genetical theory of multilevel selection.&quot; Journal of evolutionary biology 28.2 (2015): 305-319.</p><p>6] Goodnight, C. J. &quot;Multilevel selection theory and evidence: a critique of Gardner, 2015.&quot; Journal of evolutionary biology 28.9 (2015): 1734-1746.</p><p>Fletcher, Jeffrey A., and Michael Doebeli. &quot;A simple and general explanation for the evolution of altruism.&quot; Proceedings of the Royal Society of London B: Biological Sciences276.1654 (2009): 13-19</p><p>Reviewer #3:</p><disp-quote content-type="editor-comment"><p>Overall, I found this to be an intriguing combination of two rather different fields. As the authors describe, there is a long history of theory and experiment probing the conditions required for the evolution of cooperative behaviors, and some of this work has focused on spatial structure. However, little of the work has considered interesting flow fields with shear. I very much like the idea of a public good and a public bad, each of which is secreted. Then, if the public bad diffuses faster than the public good it is possible to have Turing instabilities.</p><p>My primary concern is that I didn't understand how the dynamics between cooperation and cheating took place in terms of distribution and abundance of the different strategies. How much cooperation was present in the various flow situations? Was there heterogeneity in the population? What would happen if there were a (non-evolving) fixed cooperator and another genetic cheater?</p></disp-quote><p>We thank the referee for his interest and feedback. We have added discussion to clarify how heterogeneity was analyzed, in both the appendix (lines 436-460), and in the results (subsection “Social groups as Turing patterns”). We explain how spatial homogeneity would lead to take over by cheaters, and how Turing patterns are a necessary first step to have social evolution in our model. We also state that, because of the spatial structure, the cheaters do not enter cooperative groups very easily and remain localized in their own groups. Therefore, if there is no mutation, and only a fixed cheater, groups with cheaters would get taken over and die out, leaving the groups with cooperators. These groups are stable. However, there are random mutations, sociality can only prevail if the groups fragment faster than new mutants materialize (subsection “Social groups as Turing patterns”). We have also modified Figure 2 and included videos in Supplementary files 1-5 to better illustrate this main result.</p><p>[Editors' note: the author responses to the re-review follow.]</p><disp-quote content-type="editor-comment"><p>[…] Please consider the following points in revising your manuscript:</p><p>1] The authors state that &quot;It is well known that evolution of altruism in species strongly depends on the individuals being discrete (Durrett and Levin (1994)). This would seem to imply that deterministic models, e.g. involving differential equations for frequencies of different types, would never lead to cooperation, which is of course not true.</p></disp-quote><p>Deterministic models can and do lead to cooperation. What was shown by Durrett and Levin is that discreteness can alter the outcome. For example, in our particular case, having a continuous population density can allow for the existence of “micro-mutant populations”’ which can spread easier between adjacent groups. Furthermore, the discreteness fully separates the clusters of microbes from each other, since there cannot exist fractional individuals. In reality, microbes are discrete, and we thus expect a discrete simulation to better model the biology. We have clarified this discussion in the paper (subsection “Social groups as Turing patterns”, last paragraph).</p><disp-quote content-type="editor-comment"><p>Furthermore, the argument in Simon et al. (2012) for why group selection is different from kin selection is not primarily based on the asynchrony of individual-level and group-level events. Rather, it is a consequence of the fact that assortment (or, equivalently, relatedness) may have no influence on certain group level events, such as games between groups.</p></disp-quote><p>We agree that this additional distinction also separates group selection events from kin selection ones. We have further clarified this in the paper (Introduction, fifth paragraph).</p><disp-quote content-type="editor-comment"><p>2] The authors' statement in the rebuttal letter that &quot;This change in notation does not affect our results or analysis, since in our simulations we start the population with a fixed secretion rate.&quot; is unclear to us. First, starting with a fixed secretion rate would not make the original equations correct, because mutation would quickly lead to a situation in which secretion rates are variable. Second, what is meant by &quot;a change in notation does not affect our results&quot;? Of course, a change in notation does not affect anything, apart from the notation in itself. The question is whether the simulations were carried out correctly, i.e., with the integral (summation) term taken into account. Have the simulations been carried out according to the new, correct equations?</p></disp-quote><p>In the first version of our paper there was a typo where integrals (summations) in Equations 2 and 3 were missing. However, simulations did take into account the sum. To be entirely clear, and to fully reassure the referees, we outline what the simulations do: Every microbe secretes a waste compound and a public good, and there are individual variations in the secretion rates of the latter (but not the former). To determine the spatial concentrations of these two compounds, we use the diffusion equation, treating each microbe as a source. The contribution of every individual, taking into account the individual variations in their secretion rates, is summed over.</p><p>Since diversity within and across groups is an interesting subject we have now added some analysis of the heterogeneity of secretion rates. We have prepared Figure 5 and extra panels to Figure 6 to show the average secretion rate of the population in the different flow situations. Appendix 1: Figure 1 also illustrates the distribution of secretion rates in the system. Every peak corresponds to one group. We observe that while there is a wide diversity in cooperative behavior <italic>across</italic> groups, there is very little diversity <italic>within</italic> a group. This is because among two phenotypes the less cooperative one will always dominate the more cooperative one, prohibiting stable coexistence of phenotypes within a group.</p><p>A final remark: There is still not a sum in appendix Equations 7, 8. This is because our analytical work has been significantly more difficult than simulations, and we were able to obtain formulas only when diversity in social behavior is ignored (and hence the reason for the original typo).</p><disp-quote content-type="editor-comment"><p>3] The authors' finding that without advection, cooperation cannot be maintained in their system is curious. This seems contrary to previous work by Hauert and colleagues (Wakano et al., 2009), which shows that cooperation is maintained in public goods reaction-diffusion systems.</p></disp-quote><p>We suspect the difference between our model and Hauert et al. might be the mutation rate. We find that flow shear is absolutely necessary for stable cooperation to exist beyond a critical mutation rate. We now added a calculation of this critical mutation rate and compared it with our simulations (the agreement is within 25%) (–subsection “Evolution of sociality in constant shear for a binary phenotype”, last paragraph).</p><disp-quote content-type="editor-comment"><p>I am wondering about the cause of the different outcomes in these models. Is it due to the continuous nature of the secretion trait considered in the present study? If so, this might be important to point out in the Discussion.</p></disp-quote><p>Our findings are not sensitive to the discrete vs. continuous social phenotypes. To show this clearly, we now run two sets of simulations: In one set, the individuals are allowed to have a continuum of social behaviors, whereas in the other set they are binary (either cooperative or cheating). We have now included results in our paper that supports our findings for both models (Figure 4, 5).</p></body></sub-article></article>