<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">55389</article-id><article-id pub-id-type="doi">10.7554/eLife.55389</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A Bayesian and efficient observer model explains concurrent attractive and repulsive history biases in visual perception</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-110266"><name><surname>Fritsche</surname><given-names>Matthias</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5835-9057</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="other" rid="dataset1"/></contrib><contrib contrib-type="author" id="author-101312"><name><surname>Spaak</surname><given-names>Eelke</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2018-3364</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-28130"><name><surname>de Lange</surname><given-names>Floris P</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6730-1452</contrib-id><email>floris.delange@donders.ru.nl</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><institution>Donders Institute for Brain, Cognition and Behaviour, Radboud University</institution><addr-line><named-content content-type="city">Kapittelweg</named-content></addr-line><country>Netherlands</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Serences</surname><given-names>John T</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Diego</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><role>Senior Editor</role><aff><institution>University of Pennsylvania</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>01</day><month>06</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e55389</elocation-id><history><date date-type="received" iso-8601-date="2020-01-22"><day>22</day><month>01</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-05-29"><day>29</day><month>05</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Fritsche et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Fritsche et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-55389-v2.pdf"/><abstract><p>Human perceptual decisions can be repelled away from (repulsive adaptation) or attracted towards recent visual experience (attractive serial dependence). It is currently unclear whether and how these repulsive and attractive biases interact during visual processing and what computational principles underlie these history dependencies. Here we disentangle repulsive and attractive biases by exploring their respective timescales. We find that perceptual decisions are concurrently attracted towards the short-term perceptual history and repelled from stimuli experienced up to minutes into the past. The temporal pattern of short-term attraction and long-term repulsion cannot be captured by an ideal Bayesian observer model alone. Instead, it is well captured by an ideal observer model with efficient encoding and Bayesian decoding of visual information in a slowly changing environment. Concurrent attractive and repulsive history biases in perceptual decisions may thus be the consequence of the need for visual processing to simultaneously satisfy constraints of efficiency and stability.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>visual perception</kwd><kwd>history biases</kwd><kwd>efficient coding</kwd><kwd>Bayesian inference</kwd><kwd>serial dependence</kwd><kwd>sensory adaptation</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>ERC Starting Grant 678286 ’Contextvision’</award-id><principal-award-recipient><name><surname>Fritsche</surname><given-names>Matthias</given-names></name><name><surname>de Lange</surname><given-names>Floris P</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003246</institution-id><institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek</institution></institution-wrap></funding-source><award-id>NWO Veni grant 016.Veni.198.065</award-id><principal-award-recipient><name><surname>Spaak</surname><given-names>Eelke</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Attractive and repulsive history biases in visual perception occur simultaneously, yet over dissociable timescales, and are explained by efficient encoding and Bayesian decoding of visual information in a stable environment.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A fundamental question of human visual perception is how our brains efficiently and accurately process the flood of visual information that continuously bombards our retinae. Importantly, our visual environment exhibits strong temporal regularities (<xref ref-type="bibr" rid="bib17">Dong and Atick, 1995</xref>; <xref ref-type="bibr" rid="bib49">Schwartz et al., 2007</xref>; <xref ref-type="bibr" rid="bib51">Simoncelli and Olshausen, 2001</xref>); for instance, in natural viewing behavior, orientation information tends to be preserved across successive time points and thus stable over short time scales (<xref ref-type="bibr" rid="bib18">Felsen et al., 2005</xref>; <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). Our brains could potentially exploit this temporal stability and leverage information from the recent past to optimize processing of new visual input.</p><p>Indeed, there is ample evidence that our brains adapt visual processing in response to recent experience. For example, a prolonged exposure to a stimulus typically induces a repulsive bias in the percept of a subsequent stimulus – a phenomenon termed repulsive adaptation. Repulsive adaptation has been reported for a wide range of visual features such as orientation (<xref ref-type="bibr" rid="bib26">Gibson and Radner, 1937</xref>; <xref ref-type="bibr" rid="bib28">Jin et al., 2005</xref>), color (<xref ref-type="bibr" rid="bib58">Webster and Mollon, 1991</xref>), and numerosity (<xref ref-type="bibr" rid="bib6">Burr and Ross, 2008</xref>). Prominent theories of adaptation posit that repulsive biases may be explained by an optimally efficient encoding of visual information, given temporal regularities in the input. Mechanisms underlying such efficient encoding could include self-calibration and decorrelation (<xref ref-type="bibr" rid="bib2">Barlow and Földiák, 1989</xref>; <xref ref-type="bibr" rid="bib11">Clifford et al., 2000</xref>; <xref ref-type="bibr" rid="bib38">Müller et al., 1999</xref>), or an increase in the signal-to-noise ratio for measurements similar to recently perceived stimuli (<xref ref-type="bibr" rid="bib53">Stocker and Simoncelli, 2006</xref>). Such a mechanism would increase sensitivity to small changes in the environment (<xref ref-type="bibr" rid="bib12">Clifford et al., 2001</xref>; <xref ref-type="bibr" rid="bib35">Mattar et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Regan and Beverley, 1985</xref>).</p><p>In contrast to repulsive adaptation, recent studies have found that perceptual decisions about stimulus features can be attracted <italic>towards</italic> stimuli encountered in the recent past – a phenomenon termed attractive serial dependence (<xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>). Like repulsive adaptation, attractive serial dependence has now been reported for a large variety of visual features, such as orientation (<xref ref-type="bibr" rid="bib9">Cicchini et al., 2017</xref>; <xref ref-type="bibr" rid="bib15">Czoschke et al., 2019</xref>; <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>), numerosity (<xref ref-type="bibr" rid="bib8">Cicchini et al., 2014</xref>; <xref ref-type="bibr" rid="bib14">Corbett et al., 2011</xref>; <xref ref-type="bibr" rid="bib21">Fornaciai and Park, 2018</xref>) and spatial location (<xref ref-type="bibr" rid="bib3">Bliss et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Manassi et al., 2018</xref>; <xref ref-type="bibr" rid="bib40">Papadimitriou et al., 2015</xref>). This phenomenon may represent a (Bayes-)optimal strategy of decoding the sensory information into a perceptual decision (<xref ref-type="bibr" rid="bib10">Cicchini et al., 2018</xref>; <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). Effectively, attractive serial dependence may smooth perceptual representations over time, in order to promote visual stability in the face of disruptive factors, such as eye blinks and external or internal noise. Although it is evident that both repulsive and attractive biases occur (<xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>), it is currently unclear whether and how these biases interact during perceptual decision-making.</p><p>If repulsive adaptation and attractive serial dependence reflect the distinct mechanisms of encoding and decoding, they may have separate timescales that are optimized for their respective process. Previous studies on attractive serial dependence suggest that the perceptual history attracts subsequent perceptual decisions over a relatively short time period of about 10–15 s (<xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>; <xref ref-type="bibr" rid="bib56">Van der Burg et al., 2019</xref>). Reports on the timescale of repulsive adaptation are more variable. While some studies have found that adaptation in response to brief stimuli is short-lived, vanishing after a few seconds (<xref ref-type="bibr" rid="bib30">Kanai and Verstraten, 2005</xref>; <xref ref-type="bibr" rid="bib43">Pastukhov and Braun, 2013</xref>; <xref ref-type="bibr" rid="bib46">Pavan et al., 2012</xref>), recent studies have reported minutes-long repulsive biases in perceptual decisions (<xref ref-type="bibr" rid="bib7">Chopin and Mamassian, 2012</xref>; <xref ref-type="bibr" rid="bib25">Gekas et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Suárez-Pinilla et al., 2018</xref>). Together, these studies raise the possibility that attractive serial dependence and repulsive adaptation biases may occur over dissociable timescales. This could provide an opportunity for disentangling history-dependent encoding and decoding mechanisms underlying perceptual decision-making, even within the same perceptual decision.</p><p>In the current study, we examined the timescales over which current visual processing is attracted and repelled by the perceptual history. Across four experiments, we show that attraction and repulsion have distinct time scales: perceptual decisions about orientation are attracted towards recently perceived stimuli, but repelled from stimuli that were experienced further in the past. Importantly, we demonstrate that the long-term repulsive bias is spatially specific, akin to classical sensory adaptation (<xref ref-type="bibr" rid="bib4">Boi et al., 2011</xref>; <xref ref-type="bibr" rid="bib31">Knapen et al., 2010</xref>; <xref ref-type="bibr" rid="bib34">Mathôt and Theeuwes, 2013</xref>) and in contrast to short-term attractive serial dependence (<xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). Furthermore, it exhibits a long exponential decay, with stimuli experienced minutes into the past still exerting repulsive effects. Moreover, we find that this pattern of concurrent attractive and repulsive biases cannot be explained by a Bayesian ideal observer model, which exploits the temporal stability of the environment (<xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). We present a novel ideal observer model, in which repulsive biases arise due to efficient encoding (<xref ref-type="bibr" rid="bib53">Stocker and Simoncelli, 2006</xref>; <xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>), and attractive biases are due to Bayesian decoding of sensory information. This model illustrates a principled way in which observers can exploit the temporal stability in the environment across multiple processing stages to concurrently achieve efficient and stable visual processing.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Experiment 1: Perceptual decisions are attracted towards short-term history but repelled from long-term history</title><p>The aim of the first experiment was to characterize the dependence of perceptual decisions on the short- and long-term stimulus history. To this end, twenty-three human observes completed a series of trials, in which they were presented with oriented Gabor stimuli, randomly sampled on each trial from the full range of possible orientations (0, 180°], and subsequently had to report the perceived orientation of each stimulus by adjusting a response bar (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We then analyzed the dependence of the current adjustment response on each stimulus experienced in the 40 preceding trials, corresponding to a time window reaching ~3.5 min into the past. We found that adjustment responses were systematically attracted towards the stimulus presented on the previous trial (p&lt;0.0001; <xref ref-type="fig" rid="fig2">Figure 2A</xref>). This attraction bias was maximal when orientations of successive stimuli differed by 18° (max. attraction = 1.66°), similar to previous reports of attractive serial dependence (<xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>; <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). However, the attractive influence of previous stimuli was short-lived and was only clearly observable between adjacent trials, corresponding to an inter-stimulus interval of about 5 s (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Conversely, stimuli encountered further back in the past exerted a repulsive bias on the current adjustment response. The repulsive bias was maximal for stimuli presented four trials in the past (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, p&lt;0.0001, max. repulsion = −1.07°) and subsequently decreased towards zero, albeit remaining negative up to 22 trials back, corresponding to a time window of about two minutes. Similar to the short-term attractive bias, the repulsive bias was tuned to the orientation difference between the current and past stimulus, such that current adjustment responses were maximally repelled for orientation differences of ~19° (average tuning width of 4- to 22-back trials). The results of Experiment 1 thus indicate that perceptual estimates are subject to both attractive and repulsive biases, operating over different timescales. While perceptual estimates are attracted towards immediately preceding stimuli, they are repelled from temporally distant stimuli. This repulsive bias potentially reaches back minutes into the past. The orientation tuning of the long-term repulsive bias is reminiscent of sensory adaptation (i.e. the negative tilt-aftereffect), which typically induces maximal repulsion for orientation differences of about 20° (<xref ref-type="bibr" rid="bib26">Gibson and Radner, 1937</xref>; <xref ref-type="bibr" rid="bib28">Jin et al., 2005</xref>). To shed more light on the nature of the long-term repulsive bias, we next investigated whether it is modulated by the spatial overlap between the current and temporally distant stimulus. Such a spatial specificity is a hallmark of classical sensory adaptation effects (<xref ref-type="bibr" rid="bib4">Boi et al., 2011</xref>; <xref ref-type="bibr" rid="bib31">Knapen et al., 2010</xref>; <xref ref-type="bibr" rid="bib34">Mathôt and Theeuwes, 2013</xref>), and thus would point towards low-level sensory encoding as the origin of the repulsive bias.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Task of Experiment 1.</title><p>Observers saw a Gabor stimulus followed by a noise mask and subsequently reproduced the orientation of the stimulus by adjusting a response bar. Stimulus presentation in the left or right visual field alternated between separate, interleaved blocks.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig1-v2.tif"/></fig><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Results of Experiment 1: Estimation responses are attracted towards short-term, but repelled from long-term stimulus history.</title><p>(<bold>A</bold>) Serial dependence of current response errors on the previous stimulus orientation. We expressed the response errors (y-axis) as a function of the difference between previous and current stimulus orientation (x-axis). For positive x-values, the previous stimulus was oriented more clockwise than the current stimulus and for positive y-values the current response error was in the clockwise direction. Responses are systematically attracted towards the previous stimulus, as is revealed by the group moving average of response errors (thin black line). The attraction bias follows a Derivative-of-Gaussian shape (DoG, model fit shown as thick black line). Parameters <italic>a</italic> and <italic>w</italic> determine the height and width of the DoG curve, respectively. Parameter <italic>a</italic> was taken as the strength of serial dependence, as it indicates how much the response to the current stimulus orientation was biased towards or away from a previous stimulus with the maximally effective orientation difference between stimuli. Positive values for <italic>a</italic> mark an attractive bias. Shaded region depicts the SEM of the group moving average. (<bold>B</bold>) Current responses are systematically biased away from 4-back stimulus. (<bold>C</bold>) Attraction and repulsion biases exerted by the 40 preceding stimuli. Bias amplitudes show the amplitude parameter <italic>a</italic> of the DoG models, fit to the n-back conditioned response errors (see panel <bold>A and B</bold>). While the current response is attracted towards the 1-back stimulus, it is repelled from stimuli encountered further in the past. Colored bars indicate significant attraction (blue) and repulsion (red) biases (solid: Bonferroni correction for multiple comparisons; striped: no multiple comparison correction). Error bars represent 1 SD of the bootstrap distribution.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Results of Experiment 1: Estimation responses are attracted towards short-term, but repelled from long-term stimulus history.</title><p>The source data file contains a csv file with the 1- to 40-back DoG model parameter estimates and a csv file with p-values for testing the model’s amplitude parameters against zero. It also contains csv files with moving averages of response errors conditioned on the 1- and 4-back trial, respectively (participants x orientation). Furthermore, it contains a mat file with all 1- to 40-back moving averages of each participant.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-55389-fig2-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig2-v2.tif"/></fig></sec><sec id="s2-2"><title>Experiment 2: Long-term repulsive biases are spatially specific</title><p>Experiment 2 was similar to Experiment 1, with the exception that stimulus position could vary between two locations (10 visual degrees apart) on a trial-by-trial basis. Consequently, any past stimulus could be presented at the same or a different spatial location as the current stimulus. This dataset, comprising 24 human observers, has been previously described (<xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). We previously showed that adjustment responses were systematically biased towards the immediately preceding stimulus, with a similar magnitude when it was presented at the same or a different location (see Experiment 1 in <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref> and <xref ref-type="fig" rid="fig3">Figure 3A and B</xref>; same location: max. attraction = 1.15°, p=0.005; different location: max. attraction = 1.17°, p=0.0006; same vs. different: p=0.97). Here, we sought to investigate the spatial specificity of the long-term repulsive bias. To this end, we focused on the past 10 stimuli preceding the current stimulus, for which repulsive biases in Experiment 1 were strongest. In line with Experiment 1, we found that adjustment responses were significantly repelled away from stimuli seen 4 to 9 trials ago (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Moreover, stimuli presented within this time window, reaching from 26 to 60 s in the past, exerted a spatially specific bias on the current adjustment response. That is, the current adjustment response was more strongly repelled by a previous stimulus presented at the same compared to a different spatial location as the current stimulus (<xref ref-type="fig" rid="fig3">Figure 3C</xref>; same location: max. repulsion = −0.81°, p&lt;0.0001; different location: max. repulsion = −0.39°, p=0.0006; same vs. different: p=0.006). This spatial specificity of the repulsive bias, exerted by stimuli seen tens of seconds in the past, points towards a sensory origin of the long-term repulsive bias, akin to the negative tilt-aftereffect. Moreover, the small remaining repulsion bias for stimuli presented at a different spatial location is consistent with previous findings, which suggested that weak tilt-aftereffects may occur at spatial locations further away from the adaptor stimulus (e.g. see <xref ref-type="bibr" rid="bib31">Knapen et al., 2010</xref>; <xref ref-type="bibr" rid="bib34">Mathôt and Theeuwes, 2013</xref>).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Results of Experiment 2: Long-term repulsive biases are spatially specific.</title><p>(<bold>A</bold>) Attraction and repulsion biases exerted by the 10 preceding stimuli, regardless of changes in spatial locations. The current response is attracted towards the previous stimulus, but repelled from stimuli seen 4 to 9 trials ago. Colored bars indicate significant attraction (blue) and repulsion (red) biases (solid: Bonferroni correction for multiple comparisons; striped: no multiple comparison correction). Error bars represent 1 SD of the bootstrap distribution. The gray shaded area marks the time window of interest for which we estimated the spatial specificity of the repulsive bias (panel <bold>C</bold>). (<bold>B</bold>) Serial dependence on previous stimulus, considering trials for which the previous stimulus was presented at the same location as the current stimulus (‘same location’, purple), or trials for which the previous and current stimulus location was 10 visual degrees apart (‘different location’, orange). Attractive serial dependence is similarly strong for same and different location trials. Shaded region depicts the SEM of the group moving average (thin lines). Thick lines show the best fitting DoG curves. Same data as shown in Experiment 1 by <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>. (<bold>C</bold>) Average serial dependence on 4- to 9-back stimuli for same (purple) or different (orange) location trials. Current responses are more strongly repelled from 4- to 9-back stimuli, when current and past stimuli were presented at the same spatial location.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Results of Experiment 2: Long-term repulsive biases are spatially specific.</title><p>The source data file contains a csv file with the 1- to 10-back DoG model parameter estimates and a csv file with p-values for testing the model’s amplitude parameters against zero. It also contains two csv files with model parameters fit to 1-back or 4- to 9-back conditioned response errors, split by location change. Furthermore, it contains a mat file with all 1- to 10-back moving averages of each participant (same and different locations).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-55389-fig3-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig3-v2.tif"/></fig></sec><sec id="s2-3"><title>Experiment 3: Long-term repulsive biases are not strongly modulated by working memory delay</title><p>We have previously shown that the short-term positive bias exerted by the previous stimulus grows during the working memory retention period of the current trial, indicating a role of working memory for the positive bias (Experiment 4 in <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref> and <xref ref-type="fig" rid="fig4">Figure 4B</xref>; see also <xref ref-type="bibr" rid="bib3">Bliss et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Papadimitriou et al., 2015</xref>). One may surmise that if the long-term repulsive bias reflects a low-level encoding bias, affecting the earliest stages of visual processing, then in contrast to the short-term positive bias, long-term repulsion should not be modulated by the duration of the current working memory delay. To test this hypothesis, we analyzed an additional, previously published dataset involving perceptual estimation responses to oriented Gabor stimuli, in which we introduced a variable delay period of 50 or 3500 ms between stimulus offset and the estimation response (<xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). Similar to Experiment 1 and 2, we found that estimation responses were biased towards the stimulus orientation of the previous trial (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, max. attraction = 1.25°, p&lt;0.0001), but repelled from stimuli presented further in the past (max. repulsion of −0.81° for 3-back stimulus, p&lt;0.0001). This further corroborates the existence of short-term attraction and long-term repulsion biases in perceptual estimates. Interestingly, in comparison to Experiment 1 and 2, it appeared that the transition from attractive to repulsive effects occurred earlier in time, such that repulsive effects were already visible for the 2-back trial (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, max. repulsion = −0.46°, p=0.034). Importantly, trials in Experiment 3 were longer compared to the previous experiments, due to the working-memory delay period (8.25 s vs. 5.37 and 6.55 s trial lengths). Thus, one potential explanation for the earlier onset of repulsion biases could be that the decay of attractive and repulsive biases may depend on the elapsed time (i.e. seconds) between previous and current stimulus, rather than the number of intervening stimuli or decisions. We will return to a quantitative comparison of the temporal decay across the different experiments later.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Results of Experiment 3: Long-term repulsive biases are not strongly modulated by working memory delay.</title><p>(<bold>A</bold>) Attraction and repulsion biases exerted by the 10 preceding stimuli, pooled across response delay conditions. The current response is attracted towards the previous stimulus, but repelled from stimuli seen 2 to 6 trials ago. Colored bars indicate significant attraction (blue) and repulsion (red) biases (solid: Bonferroni correction for multiple comparisons; striped: no multiple comparison correction). Error bars represent 1 SD of the bootstrap distribution. The gray shaded area marks the time window of interest for which we estimated the working memory delay dependence of the repulsive bias (panel <bold>C</bold>). (<bold>B</bold>) Serial dependence on previous stimulus, considering trials for which the delay between current stimulus and response was short (green) or long (pink). Attractive serial dependence increases with working memory delay on the current trial. Shaded region depicts the SEM of the group moving average (thin lines). Thick lines show the best fitting DoG curves. Same data shown in Experiment 4 by <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>. (<bold>C</bold>) Average serial dependence on 2- to 6-back stimuli for current short (green) or long (pink) working memory delays. There is a trend towards a stronger repulsive bias when the current working memory delay is long. However, this difference between delay conditions was not significant.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Results of Experiment 3: Long-term repulsive biases are not strongly modulated by working memory delay.</title><p>The source data file contains a csv file with the 1- to 10-back DoG model parameter estimates and a csv file with p-values for testing the model’s amplitude parameters against zero. It also contains two csv files with model parameters fit to 1-back or 2- to 6-back conditioned response errors, split by memory delay duration. Furthermore, it contains a mat file with all 1- to 10-back moving averages of each participant (short and long memory delay).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-55389-fig4-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig4-v2.tif"/></fig><p>The attraction bias towards the 1-back stimulus was stronger when the current memory delay was long compared to short (<xref ref-type="fig" rid="fig4">Figure 4B</xref>; short delay: max. attraction = 1.08°, p=0.001; long delay: max. attraction = 1.64°, p&lt;0.0001; short vs. long: p=0.047; <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). In contrast, for stimuli that exhibited overall repulsive biases (2- to six trials back, 17 to 50 s in the past), there was no significant difference in the magnitude of repulsion across memory delays (<xref ref-type="fig" rid="fig4">Figure 4C</xref>; short delay: max. repulsion = −0.47°, p=0.0002; long delay: max. repulsion = −0.75°, p&lt;0.0001; short vs. long: p=0.055), although there was a trend towards stronger repulsion for current long delays. Indeed, there was a significant interaction between n-back trial (1-back vs. 2- to 6-back) and working memory delay (F(1,23) = 5.21, p=0.032, η<sup>2</sup> = 0.19), indicating that working memory delay has a stronger impact on short-term attraction than on long-term repulsion biases.</p><p>In order to quantify evidence for the null hypothesis of no modulation of the repulsive bias by working memory delay, we turned to a model-free analysis of averaging response errors for trials that were preceded by clockwise or counter-clockwise stimulus orientations, respectively (see Materials and methods). This allowed us to quantify serial dependence biases at the single participant level, which could subsequently be used for a Bayes Factor analysis. While this analysis provided moderate evidence for a modulation of the 1-back attraction bias by working memory delay (BF<sub>10</sub> = 7.25), which is in line with the model-based analysis, there was anecdotal (but no decisive) evidence for a lack of modulation for the long-term repulsive bias (BF<sub>10</sub> = 0.77).</p></sec><sec id="s2-4"><title>Experiment 4: Long-term history alters perceived orientation</title><p>To further test whether long-term repulsive biases arise at an early encoding stage, we turned to a different experimental paradigm, which sought to measure perception more directly compared to the stimulus reproduction technique employed in the previous experiments. Stimulus reproductions necessarily rely on memory of the perceived stimulus feature and thus may reflect a combination of early perceptual and late post-perceptual working memory and decision biases (<xref ref-type="bibr" rid="bib3">Bliss et al., 2017</xref>; <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Papadimitriou et al., 2015</xref>). We have previously shown that when the perceived orientation of a stimulus is measured more directly, by an immediate comparison to a reference stimulus that is visible at the same time (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), it is repelled from the previous stimulus in a spatially specific manner, likely reflecting sensory adaptation (see <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref> and <xref ref-type="fig" rid="fig5">Figure 5C</xref> ‘current inducer’). Here we asked, whether the perceived orientation of the current stimulus, as measured in direct comparison to a reference, would continue to be repelled from stimuli experienced further in the past. This analysis not only allowed us to investigate whether the long-term repulsive bias reflects a genuine low-level perceptual bias that directly alters the appearance of a stimulus, as would be expected of sensory adaptation, but also enabled us to assess the temporal decay of the repulsion effect while short-term attraction biases are absent or strongly reduced (<xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>; but see <xref ref-type="bibr" rid="bib9">Cicchini et al., 2017</xref>). In Experiment 4, the same 24 observers that participated in Experiment 2 performed two consecutive tasks on each trial. First, they were simultaneously presented with two Gabor stimuli and were cued to reproduce the orientation of one of the stimuli by adjusting a response bar. We termed the cued stimulus ‘inducer’, since it induced a perceptual decision at one location. In order to measure subsequent biases in perception, another two Gabor stimuli were presented (one at the previously cued location and one at a location in the opposite hemifield, 20 visual degrees apart) and observers judged which of the two stimuli was tilted more clockwise (two-alternative forced choice [2AFC], <xref ref-type="fig" rid="fig5">Figure 5A and B</xref>). To recapitulate, we previously found in the same dataset that in this direct perceptual comparison the perceived orientations of the 2AFC stimuli were repelled from the immediately preceding inducer in a spatially specific manner (see <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref> and <xref ref-type="fig" rid="fig5">Figure 5C</xref> ‘current inducer’; same location: repulsion −0.71°±0.10 SEM, t(23) = −6.91, p=5e-7, d = −1.41; different location: repulsion −0.17°±0.11 SEM, t(23) = −1.54, p=0.14, d = −0.31; same vs. different: t(23) = −3.85, p=0.0008, d = −0.79). Importantly, here we found that this repulsive bias was not limited to the inducer presented on the current trial (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). On average, inducers presented on the 10 previous trials, corresponding to a time window of 10 to 100 s prior to the current trial, exerted a significantly repulsive bias on the perceived orientation of the current 2AFC stimuli, when presented at an overlapping spatial location (same location: repulsion −0.24°±0.05 SEM, t(23) = −5.24, p=3e-5, d = - 1.07), but not when presented at a different location 10 visual degrees away (different location: repulsion −0.09°±0.05 SEM, t(23) = −1.66, p=0.11, d = 0.34; same vs. different location: t(23) = −2.38, p=0.026, d = −0.49). The temporal decay of this spatially specific repulsion bias was captured by an exponential decay model, which revealed a half-life of about five trials, corresponding to 50 s. The presence of long-term repulsive biases in perceptual comparisons indicates that brief stimuli experienced tens of seconds ago can directly bias the perceived orientation of a current stimulus in a spatially specific manner. This further supports the view that the long-term repulsive biases occur early during perceptual processing during the encoding of sensory information. Moreover, in the absence of the attractive bias measured in perceptual estimates (Experiment 1–3), the repulsive adaptation effect is strongest for stimuli which are temporally closest to the current stimulus and decays with increasing time between previous and current stimulus, with a long half-life. The current finding suggests that attractive and repulsive biases may coexist in perceptual estimations (Experiment 1–3), but differ in their relative strength and rate of decay. While both attractive and repulsive biases are strongest for the most recent stimulus, an initially stronger attractive bias typically masks a weaker repulsive bias, leading to an overall attractive influence of the immediate past. However, since the attractive bias decays at a much faster rate compared to the repulsive bias, the net bias that a stimulus exerts on the current perceptual estimate switches from attractive to repulsive as the intervening time increases.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Task and results of Experiment 4: The long-term stimulus history directly biases the perceived orientation of current stimuli.</title><p>(<bold>A</bold>) Observers were cued to reproduce one of two Gabor stimuli by adjusting a response bar (adjustment response). Subsequently, two new Gabor stimuli appeared at priorly cued locations in the left and right visual field. Those stimuli could appear either at the same locations as the previous stimuli or 10 visual degrees above or below. Observers had to judge which of the two new stimuli was oriented more clockwise (2AFC). Similar to the previous experiments, all Gabor stimuli were followed by noise masks. (<bold>B</bold>) Psychometric curves for the 2AFC judgments of one example observer. We expressed the probability of a ‘right’ response (y-axis) as a function of the orientation difference between right and left 2AFC stimuli (x-axis). For positive x-values, the right stimulus was oriented more clockwise. We binned the trials in two bins according to the expected influence of repulsive adaptation to the inducer stimulus. Blue data points represent trials in which repulsive adaptation, away from the inducer, would favor a ‘right’ response, while red data points represent trials in which it would favor a ‘left’ response. The example observer exhibits a repulsive adaptation bias. We quantified the magnitude of the bias as the difference in the points of subjective equality between ‘adapt right’ and ‘adapt left’ curves (ΔPSE) divided in half. This value indicates how much a 2AFC stimulus is biased by a single inducer stimulus. (<bold>C</bold>) Bias exerted by the current inducer (gray shaded box, same data as in Experiment 2 by <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>) and inducers of the 10 preceding trials. Previous inducer stimuli exert a repulsive bias on the current 2AFC stimuli, specifically when past inducer and current 2AFC stimuli were presented at an overlapping spatial location. This bias appears to decay exponentially for inducers encountered further in the past. Note that while current inducers were always oriented ±20° from the subsequent 2AFC stimulus, constituting an optimal orientation difference for eliciting adaptation biases (e.g. see <xref ref-type="fig" rid="fig2">Figure 2B</xref>), relative orientations of previous inducers ranged from −49 to 49°, and thus presented overall less effective adaptor stimuli. This may explain the discontinuity in the magnitude of repulsion exerted by the current and previous trial inducer. Data points show group averages and error bars present SEMs.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Task and results of Experiment 4: The long-term stimulus history directly biases the perceived orientation of current stimuli.</title><p>The source data file contains two csv files with estimated biases exerted by the previous 10 inducer stimuli, when the inducer was presented at the same or different spatial location, respectively (participants x n-back inducer).</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-55389-fig5-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig5-v2.tif"/></fig></sec><sec id="s2-5"><title>Repulsive and attractive biases can be explained by efficient encoding and optimal decoding of visual information</title><p>What are the underlying computational principles that may lead to these concurrent attractive and repulsive biases in perceptual decisions? To shed more light on this question, we turned to computational modeling to explore whether the coexisting attractive and repulsive biases can be explained by an observer that exploits the temporal continuity of visual environment in order to optimize the efficient <italic>encoding</italic> and/or <italic>decoding</italic> of visual information.</p><p>Previous studies proposed that attractive biases in perceptual estimates arise from a probabilistically optimal strategy of decoding sensory information into a perceptual decision (<xref ref-type="bibr" rid="bib10">Cicchini et al., 2018</xref>; <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). Attractive serial dependencies towards the previous stimulus orientation are well captured by such an observer model that estimates the current stimulus orientation by integrating a noisy sensory measurement of the current stimulus with a prior prediction about the upcoming stimulus orientation in a probabilistically optimal, that is Bayesian, manner (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, orange box). If predictions are well matched to the temporal regularities in the environment, combining predictions based on previous stimuli with current sensory measurements generally produces more accurate stimulus estimates than those based on current sensory measurements alone. We implemented such an ideal observer model to test whether it could account for the short-term attractive and long-term repulsive biases in the empirical data. In this observer model, the prediction about the upcoming visual stimulus was formed by combining an internal model of naturally occurring orientation changes (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, green box, <italic>transition distribution</italic>) with knowledge about previous stimulus orientations (i.e. previous posterior distributions). In contrast to the ideal observer model by <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>, we here assumed that the observer does not only rely on a prediction formed on the most recent trial, but utilizes a weighted mixture of previous predictions, where the relative contribution of previous predictions is determined by an exponential integration time constant (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, blue box, <italic>temporal integration weights</italic>). Such a mixture prior accounts for the fact that statistical regularities in natural environments do not only exist between immediately consecutive orientation samples, but over extended timescales, with the most recent stimuli also being the most predictive of the current stimulus. In contrast to an observer that only relies on the prediction based on the previous trial, an observer utilizing such a mixture prior has been shown to adequately capture positive serial dependencies beyond the most recent trial (<xref ref-type="bibr" rid="bib29">Kalm and Norris, 2018</xref>). We found that this observer model indeed captured attractive serial dependencies. However, it was not able to produce the long-term repulsive biases found in Experiments 1–3 (<xref ref-type="fig" rid="fig7">Figure 7</xref> and <xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). Thus, an observer that exploits the temporal stability of the environment via Bayes-optimal decoding alone cannot explain the pattern of attractive and repulsive biases. Furthermore, the inability of the Bayesian ideal observer to capture both attraction and repulsion biases provides evidence that the long-term repulsion biases are not an artifact resulting from short-term attraction biases and random fluctuations in the input sequence (<xref ref-type="bibr" rid="bib36">Maus et al., 2013</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Bayesian decoding and efficient encoding of orientation information in a stable environment.</title><p>(<bold>A</bold>) Bayesian decoding. Orange box: The observer encodes a grating stimulus with orientation <italic>θ</italic> into a noisy measurement <italic>m</italic>. Since the noisy measurement is uncertain, it is consistent with a range of orientations, described by the likelihood function. The likelihood is combined with prior knowledge to form a posterior, which describes the observer’s knowledge about the current stimulus orientation. The final orientation estimate is taken as the posterior mean. Blue box: In a stable environment, the observer can leverage knowledge about previous stimuli for improving the current estimate. To predict the current stimulus orientation, the observer combines a model of orientation changes in a stable environment, represented by a transition distribution (green box), with knowledge about previous stimuli, that is previous posteriors. Predictions based on previous stimuli are integrated into recency-weighted mixture prior, using exponential integration weights. This mixture prior is subsequently used for Bayesian inference about the current stimulus. (<bold>B</bold>) Efficient encoding. The observer maximizes the mutual information between the sensory representation and physical stimulus orientations by matching the encoding accuracy (measured as the square root of Fisher information <italic>J(θ)</italic>) to the prior probability distribution over current stimulus orientations. In a stable environment, this prior distribution can be informed by previous sensory measurements. With some assumptions about the sensory noise characteristics (see Materials and methods), the likelihood function of new sensory measurements is fully constrained by the Fisher information. The likelihood function is typically asymmetric, with a long tail away from the most likely predicted stimulus orientation. For details see Materials and methods and <xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig6-v2.tif"/></fig><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Empirical biases and ideal observer predictions.</title><p>Left column: An observer with efficient encoding and history-dependent Bayesian decoding (green) accurately captures the empirical magnitudes of short-term attractive and long-term repulsive biases exerted by the 1- to 20-back trials of Experiment 1–3 (grey). In contrast, an observer with Bayesian decoding (orange) only produces positive biases, but cannot capture the long-term repulsive biases. For each experiment, model bias amplitudes were estimated by simulating the observer model with the best fitting set of parameters on the stimulus sequences shown to human participants, and fitting the resulting model response errors with a Derivative-of-Gaussian (DoG) curve. Analogous to the analysis of human behavior, the amplitude parameter of the DoG curve was taken as the bias amplitude. Error bars represent 1 SD of the bootstrap distribution of the empirical data. Right column: Both attractive (left) and repulsive biases (right) of the ideal observer model with efficient encoding and Bayesian decoding (green) closely follow the average biases of human participants (black). The observer with Bayesian decoding (orange) does not produce repulsive biases. Black shaded regions show the SEMs of the empirical data. Model fits to the full range of 1- to 20-back conditioned response errors are shown in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplements 1</xref> and <xref ref-type="fig" rid="fig7s2">2</xref>. A comparison of cross-validated prediction accuracies of the different models is shown in <xref ref-type="fig" rid="fig7s3">Figure 7—figure supplement 3</xref>. The best fitting parameters of the observer model with efficient encoding and history-dependent Bayesian decoding are reported in <xref ref-type="fig" rid="fig7s5">Figure 7—figure supplement 5</xref>.</p><p><supplementary-material id="fig7sdata1"><label>Figure 7—source data 1.</label><caption><title>Empirical biases and ideal observer predictions.</title><p>The source data file contains csv files with the empirical bias amplitudes of 1- to 20-back stimuli, as well as the predicted bias amplitudes of the ideal observer with efficient encoding and Bayesian decoding and the observer with Bayesian decoding alone. Three separate files are provided for Experiment 1–3, respectively. Furthermore, for each experiment we provide two mat files with the model fitting results of the two ideal observer models.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-55389-fig7-data1-v2.zip"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Serial dependence biases of an ideal observer with efficient encoding and history-dependent Bayesian decoding (green).</title><p>The model can accurately capture the tuning profile of short-term attraction and long-term repulsion biases across Experiments 1–3. Model biases were computed by simulating the ideal observer model on the stimulus sequences shown to human participants. Human serial dependence biases are shown in black. Shaded regions denote SEMs of the empirical data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig7-figsupp1-v2.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Serial dependence biases of an ideal observer, in which sensory history influenced only Bayesian decoding (orange) or only efficient encoding (blue).</title><p>Neither of the models can account for both attractive and repulsive biases. While the observer with Bayesian decoding can only produce attraction biases, the observer with efficient encoding only exhibits repulsion. Model biases are computed by simulating the ideal observer model on the stimulus sequences shown to human participants. Human serial dependence biases are shown in black. Shaded regions denote SEMs of the empirical data.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig7-figsupp2-v2.tif"/></fig><fig id="fig7s3" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 3.</label><caption><title>Cross-validated prediction accuracies of the four different observer models.</title><p>Across all three experiments, an ideal observer model with efficient encoding and Bayesian decoding optimized according to distinct priors (distinct transition distributions and integration time constants) provided the best fits to the held-out testing data. It consistently outperformed an ideal observer model in which encoding and decoding were based on the same predictions (single prior), or models in which the sensory history influenced only Bayesian decoding or only efficient encoding. Importantly, those models could not qualitatively account for all aspects of the empirical bias pattern, being limited to producing only attractive or only repulsive biases. A baseline level of chance prediction accuracy of each model is indicated by the red lines. To this end, we randomly permuted the models’ predicted responses to the stimuli in the testing dataset, thereby abolishing the trial correspondence between model and participant errors, and computed the correlation between the resulting permuted model predictions and observed serial dependence curves. This procedure was repeated 1000 times. The red line indicates the 95th percentile of the resulting permutation distribution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig7-figsupp3-v2.tif"/></fig><fig id="fig7s4" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 4.</label><caption><title>Normalized variability of estimation response errors as a function of the orientation difference between current and n-back trial.</title><p>Variability of estimation response errors was quantified by computing each participant’s standard deviation of estimation response errors in a 30° sliding window over relative orientation differences between current and n-back trial. The resulting conditional response variability estimates were normalized by subtracting each participant’s mean response variability before averaging across participants. Across all three estimation experiments, there was a clear reduction in response variability when current and previous stimuli had similar orientations (left column, thin black line) and this pattern was well captured by a second-derivative-of-a-gaussian curve (bold black line). The amplitude parameter <italic>a</italic> of the gaussian derivative model quantifies the reduction of response variability at 0° relative orientation difference. While for some n-back trials there appears to be a small reduction in response variability (e.g. 4-back trials, middle column), temporally more distant trials show no consistent effect overall (right column). Shaded error regions around the group-averaged example curves depict SEMs. Error bars on amplitude estimates depict 1 <italic>SD</italic> of the bootstrapped amplitude distribution, resampling participants with replacement.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig7-figsupp4-v2.tif"/></fig><fig id="fig7s5" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 5.</label><caption><title>Best fitting parameters of the observer model with efficient encoding and history-dependent Bayesian decoding (Full efficient-encoding-Bayesian-decoding model).</title><p>Parameters of the encoding and decoding stages are presented in the blue and red shaded cells, respectively. Note that exponential integration time constants are fitted in units of trials, and can be converted into an estimate of seconds by multiplying with the average trial duration of the respective experiment (average trial durations: Exp. 1: 5.38 s; Exp. 2: 6.55 s; Exp. 3: 8.25 s).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-55389-fig7-figsupp5-v2.tif"/></fig></fig-group><p>As described in the Introduction, repulsive adaptation biases have been proposed to arise from efficient encoding of visual information (<xref ref-type="bibr" rid="bib2">Barlow and Földiák, 1989</xref>; <xref ref-type="bibr" rid="bib11">Clifford et al., 2000</xref>; <xref ref-type="bibr" rid="bib38">Müller et al., 1999</xref>; <xref ref-type="bibr" rid="bib53">Stocker and Simoncelli, 2006</xref>). For instance, the sensory system may allocate sensory coding resources such that it is optimally adapted to represent the current stimulus (<xref ref-type="bibr" rid="bib60">Wei and Stocker, 2017</xref>; <xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>). For temporally stable visual input, in which current stimulus features are similar to previous ones, an optimally efficient allocation of encoding resources entails that more resources should be dedicated to stimulus features encountered in the recent history. As a consequence, the most likely stimulus, as predicted from the sensory history, is represented with highest fidelity. Here, we implemented an observer model that predicted the orientation of an upcoming stimulus based on previous sensory measurements and subsequently allocated sensory encoding resources such that the mutual information between the predicted stimulus and its sensory representation was maximized (<xref ref-type="fig" rid="fig6">Figure 6B</xref>; <xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref> and ‘<italic>Efficient encoding model with history-independent decoding’</italic> in Materials and methods). For this observer, repulsive adaptation biases then result not from changes to the prior, but from changes in the sensory representation of the current stimulus; in other words in the likelihood function. Due to biased allocation of encoding resources, the likelihood function of a current stimulus often becomes asymmetric, with a long tail away from the most likely predicted stimulus orientation (<xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>; <xref ref-type="fig" rid="fig6">Figure 6B</xref>). Any subsequent ‘readouts’ of this likelihood function by downstream decoders, which take the full likelihood function into account, will consequently be biased away from the predicted stimulus.</p><p>We found that such an observer with optimally efficient encoding at the likelihood stage, but no influence of the sensory history on the decoding stage (i.e. a uniform, history-independent decoding prior), is able to produce long-term repulsive biases. However, this observer additionally results in repulsive and not attractive biases in response to the most recently experienced stimuli (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). Therefore, an observer with efficient coding alone is not able to capture the transition from short-term attractive to long-term repulsive biases observed in the empirical data.</p><p>Neither an observer in which sensory history influenced only Bayesian decoding nor only efficient encoding was able to reproduce the pattern of attractive and repulsive biases that we observed in perceptual decisions. An intriguing possibility is that the coexisting attractive and repulsive biases might arise from a concurrent optimization of both encoding and decoding according to the sensory history. We tested this idea by developing an ideal observer model with both efficient encoding and history-dependent Bayes optimal decoding of sensory information (see ‘<italic>Full efficient-encoding-Bayesian-decoding model</italic>’ in Materials and methods). In this observer, efficient coding determined the shape of the likelihood function during the encoding of the current stimulus orientation, whereas Bayesian decoding prescribed how this likelihood function was subsequently integrated with a prior prediction about the current stimulus orientation. Importantly, we allowed predictions used for optimizing encoding and decoding to be based on potentially distinct transition distributions and integration time constants. This was motivated by the possibility that encoding transition models in low-level sensory circuits could be relatively inflexible and learned over the organism’s lifetime, whereas higher-level transition models used for decoding are likely context- and task-dependent (<xref ref-type="bibr" rid="bib19">Fischer et al., 2020</xref>) and learned quickly, within minutes to hours (<xref ref-type="bibr" rid="bib5">Braun et al., 2018</xref>).</p><p>We found that this ideal observer model with efficient encoding and history-dependent Bayesian decoding was able to faithfully reproduce short-term attraction and long-term repulsion biases across all three experiments (<xref ref-type="fig" rid="fig7">Figure 7</xref> and <xref ref-type="fig" rid="fig7s1">Figure 7—figre supplement 1</xref>). It predicted estimation biases better than observers, in which sensory history only influenced Bayesian decoding or only efficient encoding (<xref ref-type="fig" rid="fig7s3">Figure 7—figre supplement 3</xref>; cross-validated prediction accuracy, Exp. 1: <italic>r</italic> = 0.58 vs. 0.29 and 0.27; Exp. 2: <italic>r</italic> = 0.53 vs. 0.38 and 0.20; Exp. 3: <italic>r</italic> = 0.66 vs. 0.32 and 0.42). Furthermore, the observer captured estimation biases far better than an observer in which efficient encoding and Bayesian decoding were based on the same predictions, using the identical transition distribution and integration time constant (see “<italic>Efficient-encoding-Bayesian-decoding model (single prior)</italic>” in Materials and methods; cross-validated prediction accuracy, Exp. 1: <italic>r</italic> = 0.58 vs. 0.29; Exp. 2: <italic>r</italic> = 0.53 vs. 0.20; Exp. 3: <italic>r</italic> = 0.66 vs. 0.42). Crucially, we found that predictions for efficient encoding and Bayesian decoding were integrated over different timescales. Bayesian decoding was based on predictions with a short half-life, thus only integrating information of the most recent trials (decoding t<sub>1/2</sub>: Exp. 1: 4.59 s; Exp. 2: 4.47 s; Exp. 3: 3.94 s). Conversely, predictions used for efficient encoding were integrated over a longer timescale, as indicated by substantially longer half-lives (encoding t<sub>1/2</sub>: Exp. 1: 40.10 s; Exp. 2: 18.94 s; Exp. 3: 30.99 s). Moreover, we observed that transition distributions, reflecting internal models of orientation changes occurring in the environment, were broader at the encoding compared to decoding stage across all three experiments (Exp. 1: <inline-formula><mml:math id="inf1"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi> <mml:mi/></mml:mrow></mml:msub></mml:math></inline-formula>= 11.28° vs 8.35°; Exp. 2: <inline-formula><mml:math id="inf2"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi> <mml:mi/></mml:mrow></mml:msub></mml:math></inline-formula>= 13.02° vs 9.14°; Exp. 3: <inline-formula><mml:math id="inf3"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi> <mml:mi/></mml:mrow></mml:msub></mml:math></inline-formula>= 21.77° vs 9.75°). This suggests that the observer expects orientation information to be more variable at encoding compared to decoding. One speculative explanation is that the encoding transition model captures more variable orientation changes in spatially localized, retinotopic regions of the visual field, whereas the decoding transition model captures more stable orientation transitions between successively attended features across a broad region of visual space.</p><p>Finally, we sought to corroborate evidence for the involvement of efficient encoding principles in the present experiments. The current efficient coding scheme prescribes that more encoding resources should be dedicated to stimulus features encountered in the recent history. Next to inducing repulsive biases, such a reallocation of encoding resources would increase the fidelity of stimulus representations that are similar to recently encountered orientations, by narrowing the width of the likelihood function. From this follows the prediction that estimation responses should be less variable when current and previous stimulus orientation are similar. We indeed observed a marked reduction in response variability when the current and 1-back stimulus were of similar orientation (<italic>SD</italic> reduction – Exp. 1: −0.99°±0.18; Exp. 2: −0.59°±0.14; Exp. 3: −0.62°±0.12; <xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>; for details see Materials and methods). However, variability estimates for temporally more distant stimuli were noisy and did not exhibit a consistent reduction for similarly oriented n-back stimulus orientations (<xref ref-type="fig" rid="fig7s4">Figure 7—figure supplement 4</xref>), so we did not find evidence for a slow decay in variability, as we reported for the repulsive bias.</p><p>Together, the current findings indicate that the coexisting attractive and repulsive biases in perceptual decisions may originate from the concurrent optimization of efficient encoding and Bayes-optimal decoding of visual information. Furthermore, our model suggests that human observers use distinct predictions, accumulated over different timescales of the perceptual history, to optimize encoding and decoding of sensory information in a stable environment.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The goal of the current study was to disentangle and understand repulsive and attractive biases in perceptual decision making by exploring the respective timescales over which current visual processing is influenced by the perceptual history. Across four experiments, we show that perceptual estimates are attracted towards recently seen stimuli, but repelled from stimuli encountered further in the past. The long-term repulsive bias was spatially specific, directly altered the perceived orientation of the current stimulus, and appeared to be only weakly or not at all modulated by the current working memory delay. These findings clearly point towards a low-level sensory encoding origin of the long-term repulsive bias. In contrast, attraction biases were short-lived, spatially unspecific and they were modulated by the working memory delay on the current trial. To further disentangle attractive and repulsive biases and to elucidate the computational principles underlying these history dependencies, we developed an ideal observer model that combined efficient encoding with Bayes-optimal decoding of sensory information. This model was able to capture both short-term attractive and long-term repulsive serial dependencies across all perceptual estimation experiments. Exploiting the temporal stability of the environment according to efficient encoding and Bayesian decoding principles may enable our brains to achieve two concurrent goals of perceptual decision-making. By efficiently allocating sensory encoding resources, the visual system can maximize its sensitivity to small changes in the environment. Concurrently, Bayes-optimal integration of current noisy sensory measurements with predictions based on recent sensory input guards visual processing against instabilities, effectively smoothing visual representations across time. This ideal observer model thus illustrates a principled way in which observers can exploit the temporal stability in the environment, using different mechanisms across multiple processing stages, to optimize visual processing.</p><sec id="s3-1"><title>Distinct timescales of attractive and repulsive serial dependencies</title><p>Across three perceptual estimation experiments, we found that while the current estimation response is attracted towards the most recently perceived stimuli, it is simultaneously repelled from stimuli seen further in the past. Based on our ideal observer model, we estimate that the attractive influence of a previous stimulus decreases exponentially and is reduced to half of its initial magnitude after ~4.5 s. This exponential half-life is in line with previous studies, which found attractive serial dependencies to decay over a relatively short time period of about 10–15 s (<xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>; <xref ref-type="bibr" rid="bib54">Suárez-Pinilla et al., 2018</xref>; <xref ref-type="bibr" rid="bib56">Van der Burg et al., 2019</xref>). Conversely, timescale estimates of repulsive adaptation effects in response to brief stimuli have been more variable. Several studies have reported short-lived adaptation, persisting no more than a few seconds (<xref ref-type="bibr" rid="bib30">Kanai and Verstraten, 2005</xref>; <xref ref-type="bibr" rid="bib43">Pastukhov and Braun, 2013</xref>; <xref ref-type="bibr" rid="bib43">Pastukhov and Braun, 2013</xref>; <xref ref-type="bibr" rid="bib46">Pavan et al., 2012</xref>). However, recent studies found that initial attraction biases are replaced by long-term repulsive biases that extend many trials into the past (<xref ref-type="bibr" rid="bib25">Gekas et al., 2019</xref>; <xref ref-type="bibr" rid="bib27">Gordon et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Suárez-Pinilla et al., 2018</xref>), potentially lasting for minutes (<xref ref-type="bibr" rid="bib7">Chopin and Mamassian, 2012</xref>; but see <xref ref-type="bibr" rid="bib36">Maus et al., 2013</xref>). Our current findings are in line with these latter reports of long-term repulsive adaptation. We estimate the repulsive bias reaches half of its initial magnitude after 20 to 40 s and this is thus marked by a distinctly slower decay compared to the short-term attraction bias. Importantly, several of the previous studies reporting long-term repulsive biases measured perceptual decisions in two-alternative forced choice paradigms (<xref ref-type="bibr" rid="bib27">Gordon et al., 2019</xref>), while employing repeated presentations of a limited set of stimuli (<xref ref-type="bibr" rid="bib7">Chopin and Mamassian, 2012</xref>; <xref ref-type="bibr" rid="bib25">Gekas et al., 2019</xref>). In the current study we demonstrate that long-term repulsive biases are similarly present in two-alternative forced choice (Experiment 4) <italic>and</italic> continuous report paradigms (Experiment 1–3), even when presenting continuously varying stimuli from the full range of possible orientations. Thus, repulsive biases are unlikely to arise due to artifacts of the measurement method or necessitate the repeated presentation of the same stimuli, but present a genuine perceptual bias arising from the brief exposure to individual stimuli experienced seconds to minutes in the past.</p><p>Notably, opposite effects to ours have also been reported in the literature (<xref ref-type="bibr" rid="bib16">Dekel and Sagi, 2015</xref>). In particular, Dekel and Sagi observed short-term repulsive biases followed long-term attraction, when observers adapted to natural image stimuli. However, note that the long-term attraction biases were likely explained by response correlations, which are absent in the present experiments (see <xref ref-type="bibr" rid="bib16">Dekel and Sagi, 2015</xref>, sections 3.4 and 4.4.).</p><p>One outstanding question is whether short-term attractive and long-term repulsive biases decay as a function of physical time, or as a function of intervening visual events. We estimated relatively similar half-lives of the temporal decay of both attractive and repulsive biases across estimation experiments, even though experiments differed in their average trial durations (5.37, 6.55 and 8.25 s). This may suggest the decay is mainly determined by intervening time and not the frequency of stimulus presentations. However, estimation experiments also differed in other aspects of experimental design, complicating a direct comparison between experiments. Furthermore, the only source of temporal variability within the current experiments was introduced via the self-paced estimation responses, leading to only minor temporal jitter across trials (in other words, intervening time and intervening trials were very highly correlated). This renders the current experiments unsuitable for distinguishing the role of elapsed time and intervening stimulus presentations for the history decay. Future studies may investigate this question more specifically, by experimentally dissociating time and the frequency of stimulus presentations.</p></sec><sec id="s3-2"><title>Repulsive and attractive biases can be explained by efficient encoding and Bayesian decoding of visual information</title><p>Previous studies proposed that attractive biases in perceptual estimates towards the previous stimulus arise from a probabilistically optimal strategy of decoding sensory information into a perceptual decision (<xref ref-type="bibr" rid="bib10">Cicchini et al., 2018</xref>; <xref ref-type="bibr" rid="bib29">Kalm and Norris, 2018</xref>; <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). In a stable environment, integrating current noisy sensory measurements with information about previous stimuli generally results in more accurate perceptual estimates, compared to relying on noisy sensory measurements alone. Effectively, such a Bayesian integration of previous and current visual information would smooth perceptual representations over time, thereby promoting visual stability in the face of disruptive factors, such as eye blinks and external and internal noise. However, in the current study, we show that the temporal pattern of history biases is more complex, consisting of a superposition of concurrent attractive and repulsive biases, which cannot be explained by an observer model based on Bayesian decoding of visual information alone. Importantly, this not only shows that a Bayesian observer model is inadequate to explain the full pattern of history dependencies in perceptual estimates, but the inability of the Bayesian observer to capture both short-term attraction and long-term repulsion biases also indicates that the long-term repulsion biases are not an artifact resulting from short-term attraction biases in combination with random input fluctuations (<xref ref-type="bibr" rid="bib36">Maus et al., 2013</xref>). Rather, the spatial specificity (Experiment 2) and the presence in immediate perceptual comparisons to a reference stimulus (Experiment 4) suggest a low-level sensory origin of the long-term repulsive bias, akin to sensory adaptation (<xref ref-type="bibr" rid="bib26">Gibson and Radner, 1937</xref>).</p><p>Prominent theories of sensory adaptation posit that repulsive biases may arise as a consequence of optimally efficient encoding of visual information in a stable environment. In particular, repulsive biases may arise due to self-calibration and decorrelation (<xref ref-type="bibr" rid="bib2">Barlow and Földiák, 1989</xref>; <xref ref-type="bibr" rid="bib11">Clifford et al., 2000</xref>; <xref ref-type="bibr" rid="bib38">Müller et al., 1999</xref>), or an increase in the signal-to-noise ratio for measurements similar to recently perceived stimuli (<xref ref-type="bibr" rid="bib53">Stocker and Simoncelli, 2006</xref>). In line with the latter proposal, we here developed a model in which repulsive adaptation biases arise as a consequence of efficient allocation of sensory coding resources (<xref ref-type="bibr" rid="bib60">Wei and Stocker, 2017</xref>; <xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>). Since in a temporally stable visual environment new visual input is likely to be similar to recent input, the visual system can exploit the sensory history to strategically allocate sensory coding resources such that the mutual information between the likely physical stimulus and its sensory representation is maximized. Such an efficient allocation of sensory resources increases sensitivity to small changes in the input, in line with previous findings of improved discriminability following adaptation (<xref ref-type="bibr" rid="bib12">Clifford et al., 2001</xref>; <xref ref-type="bibr" rid="bib35">Mattar et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Regan and Beverley, 1985</xref>). At the same time, it leads to a repulsive bias of perceptual estimates, away from previous stimulus orientations, thus producing classical sensory adaptation effects.</p><p>Across three experiments involving perceptual estimation tasks, we show that an ideal observer with efficient encoding together with Bayesian decoding can adequately capture the pattern of short-term attraction and long-term repulsion biases in perceptual estimates. This observer model provides a framework for explaining how the visual system exploits temporal regularities in the input to achieve sensitivity to changes in the environment, while at the same time maintaining stable visual processing of visual information. Importantly, however, our model indicates that efficient encoding and Bayesian decoding are based on distinct priors, accumulating previous stimulus information over different timescales and employing distinct internal models of naturally occurring input changes. In particular, at the encoding stage, the prediction about the upcoming stimulus is based on many previous stimulus encodings, reaching far into the past. Conversely, the prediction used for Bayesian decoding is solely based on previous stimulus information encountered in the most recent past (previous 2–3 trials). Moreover, the transition distribution, reflecting an internal model of naturally occurring orientation changes, is broader at the encoding compared to the decoding stage, suggesting that the observer expects successive orientation samples to be less stable at encoding compared to decoding. As a consequence, the efficient allocation of encoding resources is less biased to any particular previous stimulus, but more broadly influenced by the long-term history of visual stimulation. In contrast, at decoding, the relatively stronger contribution of the short-term history to the Bayesian decoding prior leads to a dominating attractive influence of the most recent stimuli, but no influence of long-term stimulus history.</p><p>We may speculate on the reasons for the distinct timescales and transition models for efficient encoding and Bayesian decoding. At encoding, the long integration timescale and broad transition model, which effectively diffuse and smooth prior information across time, may reflect the need to adapt to long-term perturbations in visual processing or slowly changing input statistics without over-adjusting to the rapidly changing low-level input at spatially localized, retinotopic regions of the visual field. In contrast, the more narrow transition model and short integration timescale at decoding may be tuned to more stable orientation transitions between briefly attended features across a broad region of visual space. However, such explanations remain speculative at this moment. More extensive characterizations of the spatiotemporal statistics of natural visual input and visual information processing will be needed to advance our understanding of the principles underlying the distinct encoding and decoding priors. In this regard, it will also be interesting to study whether observers can flexibly modify encoding and/or decoding transition models in response to experimentally induced temporal regularities in visual input. There is evidence that human observers can indeed adapt to simple temporal regularities after relatively brief exposure (<xref ref-type="bibr" rid="bib5">Braun et al., 2018</xref>), and our ideal observer model provides a framework to understand changes in internal transition models across multiple stages of the perceptual decision-making process.</p><p>The current model in which attraction biases are due to Bayesian decoding of sensory information provides a parsimonious explanation for the increase of attractive serial dependence biases with working memory delay (Experiment 3; <xref ref-type="bibr" rid="bib3">Bliss et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Papadimitriou et al., 2015</xref>), and the absence of short-term attraction biases in the perceptual comparison task of Experiment 4. In particular, Bayesian decoding posits that the attractive serial dependence bias is dependent on the relative widths of sensory likelihood and prior. When sensory likelihoods are relatively narrow, briefly after the initial encoding of the sensory stimulus, the prior has little influence on the resulting posterior, leading only to small attraction biases. As the sensory representation degrades during working memory retention, and the likelihood becomes increasingly broader, the influence of the prior increases. As a result, the posterior will be increasingly pulled towards the prior, leading to an increase in attraction during working memory retention. Importantly, in Experiment 4, observers could make their perceptual decision about the perceptual comparison stimuli while the stimuli were simultaneously presented on the screen, minimizing the influence of working memory noise and presumably leading to relatively narrow sensory likelihoods at the time of the perceptual decision. As outlined above, this would lead to a strong reduction or even absence of attraction biases in this scenario, consistent with the absence of attraction biases in Experiment 4. Furthermore, in agreement with this proposal, it has recently been found that attractive biases can arise early after stimulus offset when visual stimulation is very weak (<xref ref-type="bibr" rid="bib33">Manassi et al., 2018</xref>), leading to a broad likelihood function, and are stronger for more uncertain stimulus representations (<xref ref-type="bibr" rid="bib10">Cicchini et al., 2018</xref>; <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). Whether such a Bayesian decoding computation operates continuously during working memory retention, causing systematic drifts in working memory representations over time (<xref ref-type="bibr" rid="bib39">Panichello et al., 2019</xref>; <xref ref-type="bibr" rid="bib62">Wolff et al., 2020</xref>), or occurs only once during the final read-out of the working memory representation is an exciting question for future research.</p><p>The current model bears some similarity to a recently proposed two-process model of serial dependence in which repulsive biases are mediated by sensory adaptation, in the form of gain changes in low-level perceptual neural populations, whereas attractive biases arise due to persistent read-out biases at a higher-level decisional units (<xref ref-type="bibr" rid="bib42">Pascucci et al., 2019</xref>). A key distinction to the model by Pascucci et al. is that the current model of repulsive adaptation and attractive serial dependence is based on a normative framework of efficient encoding and Bayesian decoding of visual information. At the same time, the current model is agnostic to the neural implementation underlying efficient encoding and Bayesian decoding. In fact, at the level of neural population tuning, efficient encoding could be realized by multiple alternative mechanisms, involving changes in the location, width and/or gain of neural tuning curves of sensory neurons (<xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>). Similarly, Bayesian decoding could be achieved by combining predictions with sensory information in low-level sensory circuits via feedback mechanisms or later integration in mid- and high-level visual areas. The model by Pascucci et al., which models a potential neural implementation of history biases, and the current model are therefore not mutually exclusive, but rather reside at two different levels of explanation. Notably, however, if human visual processing indeed follows the computational goals of efficient encoding and Bayesian decoding of visual information, this will put important constraints on the neural mechanisms that need to fulfill these goals.</p><p>The general premise that repulsive biases arise at a low-level encoding stage, whereas attractive biases arise at a higher-level decoding stage is well supported by recent empirical findings. For instance, it has been shown that in contrast to repulsive adaptation, attractive serial dependence biases are strongly dependent on attention (<xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>; <xref ref-type="bibr" rid="bib24">Fritsche and de Lange, 2019</xref>; <xref ref-type="bibr" rid="bib54">Suárez-Pinilla et al., 2018</xref>), and are modulated by subjective confidence (<xref ref-type="bibr" rid="bib48">Samaha et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Suárez-Pinilla et al., 2018</xref>). Furthermore, in contrast to repulsive adaptation biases, which exhibit a clear spatial specificity (<xref ref-type="fig" rid="fig3">Figures 3</xref> and <xref ref-type="fig" rid="fig5">5</xref>; <xref ref-type="bibr" rid="bib31">Knapen et al., 2010</xref>), attractive serial dependencies appear to have a very broad spatial tuning (<xref ref-type="bibr" rid="bib13">Collins, 2019</xref>; <xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>; <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>) and have been shown do increase during the post-perceptual working-memory delay period (<xref ref-type="bibr" rid="bib3">Bliss et al., 2017</xref>; <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Papadimitriou et al., 2015</xref>). A recent study showed that attractive serial dependencies are abolished when backward-masking the previous inducer stimulus, suggesting a role of high-level feedback processing in attractive serial-dependence (<xref ref-type="bibr" rid="bib22">Fornaciai and Park, 2019</xref>). Conversely, repulsive adaptation was not affected by masking, consistent with feedforward changes in local, low-level neural circuits underlying adaptation. Moreover, a recent study found that attractive serial dependences can be modulated by contextual features, such as stimulus color or serial position in a trial, suggesting a more selective integration of prior information at the higher-level decoding stage (<xref ref-type="bibr" rid="bib19">Fischer et al., 2020</xref>). Finally, there is evidence that repulsive adaptation and attractive serial dependence map onto distinct cortical networks (<xref ref-type="bibr" rid="bib50">Schwiedrzik et al., 2014</xref>). While adaptation was confined to posterior regions, comprising early visual cortex, a more widespread network of higher-level visual and fronto-parietal areas was involved in attractive serial dependence.</p><p>Despite the above empirical evidence that points towards low- and high-level visual processing as the source of repulsive and attractive history biases, one may wonder to which extent the current biases could be explained by temporal dependencies in low-level motor processing instead. There are several arguments against a systematic influence of motor biases in the present experiments. First, in each trial of the perceptual estimation tasks (Experiments 1–3), the initial orientation of the response bar was randomly selected from the range of all possible orientations (0180], and thus the motor actions required for adjusting the response bar to a particular orientation were independent across trials. Second, several previous studies have shown that an explicit reproduction response is not necessary to elicit an attraction bias on the next trial (<xref ref-type="bibr" rid="bib15">Czoschke et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>; <xref ref-type="bibr" rid="bib54">Suárez-Pinilla et al., 2018</xref>), that perceptual decisions are attracted towards the presented stimulus orientation rather than a mirrored response orientation (<xref ref-type="bibr" rid="bib9">Cicchini et al., 2017</xref>), and that attraction biases occur even when performing a different task (and response) on the previous stimulus (<xref ref-type="bibr" rid="bib24">Fritsche and de Lange, 2019</xref>). Together, these studies strongly suggest that short-term attractive serial dependencies are not due to low-level motor biases. Furthermore, it seems unlikely that low-level motor biases would lead to larger attraction biases with increasing working memory delay (Experiment 3) and that they would induce <italic>spatially specific</italic> long-term repulsion biases (Experiments 2 and 4). Additional evidence against an involvement of motor biases in the long-term repulsion effect is provided by Experiment 4. In this experiment, participants alternate between a reproduction task and 2-AFC task, which require very different motor responses. Furthermore, stimuli in Experiment 4 were counterbalanced such that simple motor biases in the 2-AFC task (e.g. a previous response to a leftward tilted stimulus in the reproduction task induces a bias to press the left response button in the 2-AFC task) would not induce systematic biases in the analysis of the perceptual comparison data. Taken together, while there is evidence for temporal dependencies in low-level motor responses (<xref ref-type="bibr" rid="bib41">Pape and Siegel, 2016</xref>), the above points provide strong arguments against a systematic influence of such dependencies on the current estimate of short-term attraction and long-term repulsion biases in perceptual decisions.</p><p>Finally, next to short-term attraction between successive stimuli with similar orientations, in Experiment 2 and 3 we observed systematic short-term repulsion when the orientation difference between current and previous stimuli was large (&gt;60°; see <xref ref-type="fig" rid="fig3">Figures 3B</xref> and <xref ref-type="fig" rid="fig4">4B</xref>), in line with previous findings (<xref ref-type="bibr" rid="bib24">Fritsche and de Lange, 2019</xref>; <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). In the current study, we specifically focused on short-term attraction biases between similar stimuli and the current ideal observer model does not capture the repulsion biases between highly dissimilar stimuli. We previously found that while the attraction bias between stimuli with similar orientations were strongly dependent on attention to previous stimulus features, the repulsion bias for dissimilar stimuli was not modulated by attention (<xref ref-type="bibr" rid="bib24">Fritsche and de Lange, 2019</xref>). This dissociation speaks against a model in which attraction of similar and repulsion of dissimilar stimuli are mediated by the same Bayesian decoding process. Rather, the short-term repulsion effect could reflect an encoding bias, that is sensory adaptation. While the repulsion bias of the previous stimulus is indeed partly captured by the efficient encoding component in Experiment 3 (<xref ref-type="fig" rid="fig7">Figure 7</xref>, lower row), it is not accounted for in Experiment 2 (<xref ref-type="fig" rid="fig7">Figure 7</xref>, middle row). Furthermore, in Experiment 1, repulsion by previous dissimilar stimuli is absent, even though long-term repulsion effects are clearly present (<xref ref-type="fig" rid="fig7">Figure 7</xref>, upper row). This suggests that long-term and short-term repulsion biases are (at least partially) independent. Taken together, more research is necessary to elucidate the nature of the repulsion biases for large orientation differences and their potential relationship to efficient encoding and Bayesian decoding of sensory information.</p></sec><sec id="s3-3"><title>Limitations</title><p>It should be noted that current ideal observer model with efficient encoding and Bayesian decoding is based on several assumptions. For instance, we assumed a particular efficient coding scheme in which the observer maximizes the mutual information between physical stimuli and sensory representations (<xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>). Due to the efficient reallocation of encoding resources to stimulus features encountered in the recent history, this efficient encoding scheme makes the prediction that estimation responses should be less variable when current and previous stimulus orientation are similar. While we indeed observed a short-term reduction of response variability when current and previous stimuli were similar, variability estimates for temporally more distant stimuli were noisy and did not exhibit a consistent reduction for similarly oriented n-back stimulus orientations, so we did not find evidence for a slow decay in variability, as we reported for the repulsive bias. Thus, we were not able to fully confirm the predicted changes in encoding fidelity for temporally more distant trials. Future studies may specifically test whether long-term repulsive biases are accompanied by reductions in discrimination thresholds, as predicted from the efficient coding scheme based on the maximization of mutual information. There exist alternative formulations of efficient coding, such as minimizing redundancy (<xref ref-type="bibr" rid="bib1">Barlow, 1961</xref>) or reconstruction error (<xref ref-type="bibr" rid="bib57">Wang et al., 2012</xref>). Encoding efficiency may also depend on the specific task context for which the encoded information is used. Since low-level orientation information is likely used for many different tasks, the current efficient coding scheme in which a more generic information criterion is optimized may represent a good general strategy for the visual system (<xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>). A further assumption is that the observer reads out the mean of the posterior distribution at the Bayesian decoding stage. This presents the optimal strategy for minimizing the expected squared error (<xref ref-type="bibr" rid="bib32">Ma, 2019</xref>), but it is unclear whether the visual system employs this strategy. It is important to note that different encoding schemes and read-out rules may or may not lead to similar predictions. More work is needed to explore the validity of these assumptions and the consequences for modeling attractive and repulsive history dependencies.</p><p>Notably, the effects of adaptation on neural tuning are diverse, and may depend on many stimulus parameters such as stimulus size and duration in non-trivial ways (<xref ref-type="bibr" rid="bib45">Patterson et al., 2014</xref>; <xref ref-type="bibr" rid="bib44">Patterson et al., 2013</xref>). Several neural mechanisms, such as stimulus-specific fatigue and suppressive normalization, have been proposed to underly these neural tuning changes (<xref ref-type="bibr" rid="bib52">Solomon and Kohn, 2014</xref>) and have been related to functional explanations of adaptation, such as efficient coding (<xref ref-type="bibr" rid="bib49">Schwartz et al., 2007</xref>), modulations of stimulus salience (<xref ref-type="bibr" rid="bib37">McDermott et al., 2010</xref>; <xref ref-type="bibr" rid="bib61">Wissig et al., 2013</xref>), and prediction (<xref ref-type="bibr" rid="bib7">Chopin and Mamassian, 2012</xref>). Importantly, the current study cannot explicitly rule out such alternative explanations of repulsive adaptation biases. Rather, here we seek to illustrate a principled way in which the visual system can exploit the temporal stability in the environment across multiple processing stages. Future studies will need to investigate how population-level changes in neural responses may support these different functional explanations of adaptation, respectively.</p></sec><sec id="s3-4"><title>Conclusion</title><p>Our results demonstrate that visual processing is concurrently influenced by repulsive encoding and attractive decoding biases, operating over distinct timescales. While attractive decoding biases are confined to the immediately preceding stimuli, repulsive encoding biases decay at a distinctly slower rate. The temporal pattern of short-term attraction and long-term repulsion can be well captured by an ideal observer model with efficient encoding and Bayesian decoding of visual information in a stable environment. This model illustrates a principled way in which observers can exploit the temporal stability in the environment across multiple processing stages to concurrently achieve efficient and stable visual processing.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>General methods</title><p>Participants were recruited from the institute’s subject pool and received either monetary compensation or study credits. All participants provided written informed consent prior to the start of the experiments. All experiments were approved by the Radboud University Institutional Review Board (CMO region Arnhem-Nijmegen, The Netherlands; Protocol CMO2014/288). Participants reported normal or corrected-to-normal visual acuity. Stimuli were generated with the Psychophysics Toolbox for MATLAB and were displayed on a 24’' flat panel display (Benq XL2420T, resolution 1920 × 1080, refresh rate: 60 Hz). Participants viewed the stimuli from a distance of 53 cm in a dimly lit room, resting their head on a table-mounted chinrest. All data analyses were performed with MATLAB.</p></sec><sec id="s4-2"><title>Experiment 1</title><sec id="s4-2-1"><title>Participants</title><p>Twenty-three naïve participants (15 female, age 19–29 years) took part in Experiment 1. The sample size was chosen to achieve approximately 80% power for detecting experimental effects that had least a medium effect size (Cohen’s d ≥ 0.5) with a one-sided test at an alpha level of 0.05.</p></sec><sec id="s4-2-2"><title>Stimuli and design</title><p>The sequence of events within each trial is illustrated in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Throughout the experiment, a central white fixation dot of 0.3° visual angle diameter was presented on a mid-grey background. Participants were instructed to maintain fixation at all times. First, a randomly oriented Gabor stimulus (windowed sine wave grating) was presented left or right of the fixation dot at 6.5° eccentricity. The side of stimulus presentation was constant within a block, but alternated across separate, interleaved blocks. The Gabor stimulus could either have a low or high spatial frequency (0.33 or 0.5 cycles/°) and had a fixed phase. We introduced the spatial frequency manipulation to investigate a different research question, unrelated to the current investigation of the timescales of positive and negative serial dependence biases, and thus ignored this manipulation in our subsequent analyses. Gabor stimuli were presented at 25% Michelson contrast, and windowed by a Gaussian envelope (1.5° s.d.). After 500 ms, the Gabor stimulus was replaced by a noise patch, presented for 1000 ms, to minimize effects of visual afterimages. The noise patch consisted of white noise, smoothed with a 0.5° s.d. Gaussian kernel and windowed by a Gaussian envelope (1.5° s.d.). Following the offset of the noise patch and a delay of 250 ms, a randomly oriented response bar (0.3° wide white bar windowed by a 0.8° Gaussian envelope) appeared at the same location. The participants’ task was to adjust the response bar such that it matched the orientation of the Gabor patch seen just before. Once adjusted to the desired position, the response was submitted by pressing the space bar. The response was followed by a 2 s inter-trial-interval. Each participant completed a series of 820 trials, divided into 10 blocks, run in a single experimental session.</p></sec><sec id="s4-2-3"><title>Data analysis</title><sec id="s4-2-3-1"><title>Outlier correction</title><p>Prior to analyzing serial dependence biases, we discarded those trials in which the response error (shortest angular distance between stimulus and response orientation) was further than three circular standard deviations away from the participant’s mean response error. This was done in order to exclude trials on which the participant gave random responses due to blinks or attentional lapses during stimulus presentation as well as due to inadvertent responses. Subsequently, we subtracted the mean response error from all responses to remove general clockwise or counterclockwise response biases that were independent of the stimulus history. On average, 13.43 ± 9.31 (mean ±s.d.) of 820 trials were excluded per participant and the mean absolute response error was 9.15°±2.47 (mean ±s.d.). Participants took on average 1.63 s to respond.</p></sec><sec id="s4-2-3-2"><title>Quantifying serial dependence</title><p>We quantified the systematic biases of adjustment responses by the stimuli presented on the 40 preceding trials. For the immediately preceding (1-back) trial, response errors were expressed as a function of the difference between previous (1-back) and current stimulus orientation. For positive values of this difference, the previous stimulus was oriented more clockwise than the current stimulus. Similarly, positive response errors denote trials in which the response bar was adjusted more clockwise than the stimulus. Consequently, data points in this error plot (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) that have x- and y-values of the same sign represent trials in which the response error was in the direction of the previous stimulus orientation. In order to quantify the systematic bias, we pooled the response errors of all participants and fitted the first derivative of a Gaussian curve (DoG, see <xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>) to the group data. The DoG is given by <inline-formula><mml:math id="inf4"> <mml:mi/><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mi>a</mml:mi><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>w</mml:mi><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:math></inline-formula>, where <italic>x</italic> is the relative orientation of the previous trial, <italic>a</italic> is the amplitude of the curve peaks, <italic>w</italic> is the width of the curve and <italic>c</italic> is the constant <inline-formula><mml:math id="inf5"> <mml:mi/><mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. The constant <italic>c</italic> is chosen such that parameter <italic>a</italic> numerically matches the height of the curve peak. The amplitude parameter <italic>a</italic> was taken as the strength of the serial dependence bias, as it indicates how much the response to the current stimulus orientation could be biased towards or away from a previous stimulus with the maximally effective orientation difference between stimuli. For all model fits, the width parameter w of the DoG curve was treated as a free parameter, constrained to a range of plausible values (w = 0.02–0.07, corresponding to curve peaks between 10° and 35° orientation difference). To assess the systematic influence of n-back stimuli on the current adjustment response, we repeated the above procedure, but conditioned response errors on the difference between the n-back and current stimulus orientation. We only considered trials, which had an n-back stimulus in the same experiment block. Consequently, when assessing 1-back serial dependence, we discarded the first trial of each block. Conversely, for the 40-back analysis, we discarded the first 40 stimuli of each block, that is nearly half of the data. Therefore, biases by temporally more remote stimuli are estimated for a lower number of trials, reflected in the increasing error bars for bias estimates (<xref ref-type="fig" rid="fig2">Figure 2C</xref>).</p></sec><sec id="s4-2-3-3"><title>Statistical analysis</title><p>We used permutation tests to statistically assess serial dependence biases on the group level, separately for each n-back stimulus. A single permutation was computed by first randomly inverting the signs of each participant’s n-back conditioned response errors (i.e. changing the direction of the response errors). This is equivalent to randomly shuffling the labels between the empirically observed data and an artificial null distribution of no serial dependence (a flat surrogate response error distribution) and subtracting the two conditions from each other per participant. Subsequently, we fitted a new DoG model to the pooled group data and collected the resulting amplitude parameter <italic>a</italic> in a permutation distribution. We repeated this permutation procedure 10,000 times. As p-values we report the percentage of permutations that led to (1) equal or higher values for <italic>a</italic> than the one estimated on the empirical data, when the empirical estimate of <italic>a</italic> was positive, or (2) equal or lower values for <italic>a</italic> than the one estimated on the empirical data, when the empirical estimate of <italic>a</italic> was negative. As we conducted a two-sided test, we multiplied this p-value by two and set the significance level to α = 0.05. Subsequently, we Bonferroni-corrected for multiple comparisons, resulting in a significance level of α = 0.00125.</p></sec><sec id="s4-2-3-4"><title>Quantifying variability of response errors</title><p>In order to test whether the variability of response errors was dependent on the relative orientation difference between current and previous stimuli, we computed the standard deviation of response errors in a 30° sliding window over relative orientation differences between current and previous stimulus, separately for each participant. Subsequently, we normalized the resulting conditioned variability estimates by subtracting each participant’s mean response variability estimate and averaged the normalized variability estimates across participants. To quantify systematic changes in response variability, we fitted the second derivative of a Gaussian curve (2-DoG) to the group data (<xref ref-type="fig" rid="fig7s4">Figure 7—figre supplement 4</xref>). The 2-DoG is given by <inline-formula><mml:math id="inf6"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>a</mml:mi> <mml:mi/><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>w</mml:mi><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:math></inline-formula>, where <italic>x</italic> is the relative orientation of the previous trial, <italic>a</italic> is the amplitude of the negative peak at <inline-formula><mml:math id="inf7"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, <italic>w</italic> controls the width of the curve and <italic>b</italic> controls the vertical offset. The amplitude parameter <italic>a</italic> was taken as the strength of the response variability modulation, as it indicates how much the response variability is reduced when current and previous stimulus orientations are identical. For all model fits, the width parameter <italic>w</italic> of the DoG curve was treated as a free parameter, constrained to a range of plausible values (w = 0.01 – 0.1). To assess the systematic influence of n-back stimuli on current response variability, we repeated the above procedure, but conditioned response error variability on the difference between the n-back and current stimulus orientation (<xref ref-type="fig" rid="fig7s4">Figure 7—figre supplement 4</xref>, right column).</p></sec></sec></sec><sec id="s4-3"><title>Experiment 2</title><p>The data of Experiment 2 were collected as part of a previously published study, where we reported on the bias exerted by the previous stimulus (Experiment 1 in <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). Here, we reanalyzed this dataset to investigate biases exerted by stimuli encountered further in the past, when presented at the same or different spatial location as the current stimulus.</p><sec id="s4-3-1"><title>Participants</title><p>Twenty-five naïve participants took part in Experiment 2. One participant was excluded from data analysis due to difficulties in perceiving peripherally presented stimuli during the experiment. Thus, data of twenty-four participants (19 female, age 18–27 years) were analyzed. This target sample was chosen to achieve approximately 80% power for detecting experimental effects that had at least a medium effect size (Cohen’s d ≥ 0.5) with a one-sided test at an alpha level of 0.05.</p></sec><sec id="s4-3-2"><title>Stimuli and design</title><p>Experiment 2 was similar to Experiment 1, but the location of stimulus presentation could change between upper and lower half of the visual field on a trial-by-trial basis. Throughout the experiment, a central white fixation dot of 0.25° visual angle diameter was presented on a mid-grey background. Participants were instructed to maintain fixation at all times. First, a cue (white disc windowed by a 0.7° Gaussian envelope) appeared at 10° horizontal and 5° vertical eccentricity from fixation for 350 ms. Presentation in the left and right visual field was alternated in separate, interleaved blocks, while presentation in the upper and lower visual field was pseudo-randomized across trials. After further 350 ms of fixation, a randomly oriented Gabor stimulus (windowed sine wave grating) was presented at the same location as the cue. Gabor stimuli were windowed by a Gaussian envelope (1.5°s.d.), had a spatial frequency of 0.33 cycles/° with fixed phase, and were presented at 25% Michelson contrast. After 500 ms, the Gabor stimulus was replaced by a noise patch, presented for 1000 ms, to minimize effects of visual afterimages. The noise patches consisted of white noise, smoothed with a 0.3° s.d. Gaussian kernel, windowed by a Gaussian envelope (1.5° s.d.) and presented at 50% contrast. A response bar (0.6° wide white bar windowed by a 1.3° Gaussian envelope) appeared 250 ms after the offset of the noise patch at the same location. The participants’ task was to adjust the response bar such that it matched the orientation of the Gabor stimulus seen just before. Once adjusted to the desired position, the response was submitted by pressing the space bar. The response was followed by a 2 s inter-trial-interval. Each participant completed a series of 808 trials, divided into eight blocks. After each block, participants received feedback about their mean (absolute) response error. The temporal sequence of stimulus presentations in the upper and lower visual field was counterbalanced with respect to the stimulus location of trial <italic>n</italic> and <italic>n-1</italic>. Consequently, on half of the trials stimuli were presented at the same spatial location as the previous stimulus (same-location trials), while on the other half of the trials the spatial location of current and previous stimulus changed (different-location trials).</p></sec><sec id="s4-3-3"><title>Data analysis</title><sec id="s4-3-3-1"><title>Outlier correction</title><p>We performed the same outlier correction and removal of the general (history-independent) response bias as in Experiment 1. On average, 9.08 ± 6.96 trials (mean ±s.d.) of 808 trials were excluded per participant and the overall mean response error was 7.21 ± 1.45° (mean ±s.d.). Participants took on average 2.10 s to respond.</p></sec><sec id="s4-3-3-2"><title>Quantifying serial dependence</title><p>To estimate the systematic biases exerted by past stimuli, we performed the same DoG model fitting procedure as described in Experiment 1. In order to gain statistical sensitivity, we focused on the influence of the past 10 trials, for which Experiment one revealed the strongest repulsive biases. This analysis was performed on all trials, regardless of spatial location. To investigate the spatial specificity of the long-term repulsive bias, we subsequently pooled response errors conditioned on 4- to 9-back trials, which showed the overall strongest repulsive biases in this experiment. We subsequently split the data according to whether the current and 4- to 9-back stimulus were presented at the same or a different spatial location and repeated the model fitting procedure separately for the two subsets of data. This analysis captured how much the current adjustment response was biased on average by a stimulus occurring 4 to 9 trials ago, depending on the spatial overlap between past and current stimulus.</p></sec><sec id="s4-3-3-3"><title>Statistical analysis</title><p>We statistically assessed the biases exerted by the 10 past stimuli, regardless of their spatial location, using the same two-sided permutation test described in Experiment 1. The significance level was first set to α = 0.05, and subsequently Bonferroni-corrected for multiple comparisons, resulting in a significance level of α = 0.005. To test the spatial specificity of the repulsive bias, we conducted a second permutation test. For each permutation, we randomly shuffled the condition labels of the same-location and different-location condition of the pooled 4- to 9-back conditioned response errors of each participant. We then fitted DoG models to the permuted conditions, pooled across participants, and recorded the difference between the amplitude parameters <italic>a</italic>. We repeated this procedure 10,000 times. As p-values, we report the percentage of permutations that led to an equal or more extreme amplitude difference than the one we observed in the experiment, multiplied by a factor of 2 to reflect the two-sided test. The significance level was set to α = 0.05. The exchangeability requirement for permutation tests is met, because under the null hypothesis of no difference in serial dependence between same-location and different-location conditions, the condition labels are exchangeable.</p></sec><sec id="s4-3-3-4"><title>Quantifying variability of response errors</title><p>The variability of response errors was quantified with the same procedure as described in Experiment 1.</p></sec></sec></sec><sec id="s4-4"><title>Experiment 3</title><p>The data of Experiment 3 were collected as part of a previously published study, where we reported on the bias exerted by the previous stimulus (Experiment 4 in <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). Here, we reanalyzed this dataset to investigate biases exerted by stimuli encountered further in the past, when the working memory delay on the current trial was either short or long. Experiment 4 was conducted in two separate sessions. Experimental sessions were conducted on different days, but scheduled no longer than three days apart. The experimental procedures were similar across the two sessions.</p><sec id="s4-4-1"><title>Participants</title><p>Twenty-five naïve participants took part in Experiment 3. One participant aborted the experiment during the first session due to nausea symptoms and was consequently excluded from the remainder of the experiment and data analysis. Thus, data of 24 participants (15 female, age 18–30 years) were analyzed. This target sample size was chosen to achieve approximately 80% power for detecting experimental effects that had at least a medium effect size (Cohen’s d ≥ 0.5) with a one-sided test at an alpha level of 0.05.</p></sec><sec id="s4-4-2"><title>Stimuli and design</title><p>The experiment was similar to Experiment 2 and unless otherwise stated, the stimulus parameters were identical. At the beginning of each trial, the fixation dot briefly dimmed for 250 ms to indicate the upcoming appearance of a randomly oriented Gabor stimulus. After further 250 ms, the Gabor was presented at 6.5° horizontal eccentricity from fixation. Presentation in the left and right visual field was alternated in separate interleaved blocks. After 250 ms, the Gabor was replaced by a noise patch, also presented for 250 ms. The offset of the noise patch was followed by either a 50 ms (short response delay) or a 3500 ms (long response delay) period of fixation. Subsequently, a randomly oriented response bar appeared at the same location and participants adjusted the bar’s orientation to reproduce the orientation of the Gabor seen just before. Participants were instructed to submit their response by pressing the space bar within a fixed response period of 3000 ms. After submitting the response, the bar disappeared from the screen. When participants failed to respond within the response period, the fixation dot’s color briefly changed to red (250 ms). The response period was followed by an inter-trial interval (ITI) with one of two lengths, contingent on the response delay: in short response delay trials the ITI was 4200 ms, whereas in long response delay trials it was 750 ms. This timing, together with the fixed response interval, ensured that the Gabor on the following trial was always presented exactly 8 s after the offset of the Gabor on the current trial, regardless of the length of the response delay. Each participant completed 1212 trials, divided into 12 blocks that were distributed over two sessions. The duration of one session was ~110 min. After each block, participants received feedback about their mean (absolute) response error, averaged over response delays. The temporal sequence of short and long response delays was counterbalanced with respect to the response delay of trial <italic>n</italic> and <italic>n-1</italic>, such that each combination of response delays on the current and previous trial occurred equally often.</p></sec><sec id="s4-4-3"><title>Data analysis</title><sec id="s4-4-3-1"><title>Outlier correction</title><p>We excluded those trials from further analysis in which the response error (shortest angular distance between stimulus and response orientation) was further than three circular standard deviations away from the participant’s mean response error. This was done separately for short and long response delay trials in order to prevent a bias towards removing long delay trials, for which response error distributions had a higher variance. Subsequently, we removed general clockwise or counterclockwise response biases that were independent of biases due to stimulus history by removing the mean response error from each participant’s responses. For short response delay trials, an average of 9.25 ± 5.78 trials (mean ±s.d.) of 606 trials was excluded per participant. For long response delay trials, 9.58 ± 6.83 trials were excluded. Participants failed to give a response within the response period in 18.38 ± 22.27 trials. Mean (absolute) response errors were significantly larger for long response delay trials than for short response delay trials (long: 9.14°±2.32; short: 7.67°±2.04; t(23) = 8.89, p=6.75 × 10<sup>−9</sup>; paired t-test), indicating that the working memory representation of the Gabor’s orientation deteriorated during the response delay.</p></sec><sec id="s4-4-3-2"><title>Quantification and statistical analysis of serial dependence</title><p>We statistically assessed the biases exerted by the 10 past stimuli, regardless of working memory delay, using the same two-sided permutation test as described in Experiment 1 and 2. The significance level was first set to α = 0.05, and subsequently Bonferroni-corrected for multiple comparisons, resulting in a significance level of α = 0.005. To assess the modulation of the long-term repulsive bias by current working memory delay, we employed a similar procedure as in Experiment 2. First, we defined a time window of interest, ranging from 2- to 6-back trials, for which the repulsive biases were generally most pronounced. We then pooled the response errors conditioned on stimuli from this time window, and split these data according to the response delay on the current trial. Similar to assessing the difference of serial dependence between same-location and different-location trials in Experiment 2, we assessed the difference of serial dependence between short and long response delay trials with a permutation test (see above). The significance level was set to α = 0.05.</p><p>A priori, we hypothesized that the long-term repulsion bias would not be modulated by the working memory delay on the current trial. In order to quantify evidence for this null hypothesis, we employed a Bayes Factor analysis. In contrast to the permutation tests described above, the Bayes Factor analysis required us to estimate serial dependence biases on the participant level. In some cases, appropriate DoG model fits to the participant’s data could not be obtained, as their data did not strongly follow the DoG model’s shape. In order to obtain estimates of serial dependence on the participant level independent of model fit, we used a model free quantification. To this end, we averaged response errors of trials in which the n-back stimulus was oriented more clockwise or counter-clockwise than the current stimulus, respectively. Subsequently, we subtracted the average error on ‘n-back counterclockwise’ trials from the error on ‘n-back clockwise’ trials. The resulting estimate was divided by 2, to reflect the participant’s average response error in the direction of the n-back stimulus. Positive values indicated an attraction bias. The single participant estimates of 1-back and 2- to 6-back serial dependence were subsequently used for conducting Bayesian t tests with default Cauchy priors (scale 0.707).</p><p>Furthermore, to directly compare working memory delay modulations between short-term attractive and long-term repulsive biases (i.e. their interaction), we entered single participant estimates into a repeated measures ANOVA with factors n-back (1-back vs. 2- to 6-back) and working memory delay (short vs. long). As we were interested in the modulation of bias magnitudes, independent of their direction, we entered the absolute values of bias estimates. The significance level was set to α = 0.05.</p></sec><sec id="s4-4-3-3"><title>Quantifying variability of response errors</title><p>The variability of response errors was quantified with the same procedure as described in Experiment 1.</p></sec></sec></sec><sec id="s4-5"><title>Experiment 4</title><p>The data of Experiment 4 were collected as part of a previous study, where we reported on the bias exerted by the history-inducing stimulus on the current (Experiment 2 in <xref ref-type="bibr" rid="bib23">Fritsche et al., 2017</xref>). Here, we reanalyzed this dataset to investigate biases exerted by inducer stimuli encountered further in the past.</p><sec id="s4-5-1"><title>Participants</title><p>The same 25 naïve participants, who took part in Experiment 2, participated in Experiment 4. One participant was excluded from data analysis due to problems of seeing peripherally presented stimuli during the experiments. Thus, data of twenty-four participants (19 female, age 18–27 years) were analyzed.</p></sec><sec id="s4-5-2"><title>Stimuli and design</title><p>In Experiment 4, participants had to perform two consecutive tasks on each trial (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). First, participants performed an adjustment task similar to that of Experiment 1, 2 and 3 (adjustment response). Subsequently, two Gabor stimuli were presented (one at the location of the previous adjustment response, and one at a location 20 visual degrees apart) and participants judged which of the two stimuli was tilted more clockwise (two-alternative forced choice, 2AFC). Unless otherwise stated, stimulus parameters where the same as in Experiment 2. First, a cue appeared at 10° horizontal and 5° vertical eccentricity from fixation and informed participants about the location of the stimulus whose orientation they would need to reproduce. Afterwards, two Gabor stimuli were presented – one at the location of the cue, the other in the opposite hemifield – and subsequently masked by two noise patches. Next, a response bar appeared at the location of the cued stimulus and participants had to adjust the bar’s orientation to that of the stimulus. The submission of the response was followed by a 1300 ms period of fixation. The second half of each trial started with two cues simultaneously presented for 350 ms. The cues were either presented at the same locations as the adjustment stimuli (same-location trials), or 10° above or below, respectively (different-location trials). After 350 ms of fixation, two Gabor stimuli were presented at the locations of the cues. Orientations of both Gabor stimuli were constrained to the range of −14.5 and 14.5° around vertical and the orientation difference between the stimuli was varied between −9 to 9° in steps of 3°. After 500 ms the stimuli were masked by noise patches, presented for 1000 ms. After the offset of the noise patches, participants had to indicate which one of the two stimuli was oriented more clockwise (or counterclockwise, instruction was varied in separate blocks) by pressing the left or right arrow key. The response was followed by a 1,500 ms fixation period after which the next trial began. Crucially, the orientations of the first set of stimuli (adjustment stimuli) were chosen as follows. The stimulus at the cued location was tilted either −20 or 20° with respect to the 2AFC stimulus subsequently appearing at the same side of fixation. This orientation difference was chosen, as it has been previously shown to induce maximally attractive serial dependence effects on perceptual choices (<xref ref-type="bibr" rid="bib20">Fischer and Whitney, 2014</xref>). The stimulus at the uncued location had a random orientation in the range of −34.5 and 34.5°, the range in which all stimulus orientations fell. Thus, the stimulus orientation at the uncued location had no systematic relationship with either of the two 2AFC stimuli appearing afterwards. Participants completed 8 blocks of 56 trials each. After each block, participants received feedback about their average (absolute) response error on the adjustment task and accuracy on the 2AFC task. The order of same-location and different-location trials, as well as the tilt direction and vertical position of the adjustment stimulus were counterbalanced and pseudo-randomized across trials. Importantly, while we were previously concerned with the bias exerted by the current inducer stimulus on the current perceptual comparison (2AFC judgment), here we investigated the influence of previous trials’ inducer stimuli on the current perceptual comparison. The orientation statistics of the experiment implied that those inducer stimuli of previous trials had relative orientations ranging from −49 to 49° with respect to the current 2AFC stimulus appearing at the same side of fixation.</p></sec><sec id="s4-5-3"><title>Data analysis</title><p>The purpose of the adjustment phase of each trial was to introduce a stimulus history, which could subsequently induce a bias in the perceived orientation of the Gabor presented later, at the same or vertically nearby location. Hence, we refer to the adjustment stimulus as the inducer stimulus. While we were previously concerned with the bias exerted by the inducer stimulus presented on the same trial as the subsequent 2AFC stimuli, here we investigated whether inducer stimuli, presented on previous trials, bias the perceptual comparison of the 2AFC stimuli on the current trial. To this end, we binned the data into two bins according to the influence of the n-back inducer stimulus on the current 2AFC response that would be expected under repulsive adaptation. For instance, for a trial in which the 2AFC stimulus in the right visual field was preceded by a more counterclockwise n-back inducer, repulsive adaptation would bias the perceived orientation of the right stimulus in the clockwise direction. Consequently, when judging which 2AFC stimulus was oriented more clockwise, choosing the stimulus in the right visual field would be facilitated. Similarly, for a trial in which the 2AFC stimulus in the left visual field was preceded by a more clockwise n-back inducer, repulsive adaptation would bias the perceived orientation of the left stimulus in the counterclockwise direction, again making it more likely that the participant would judge the stimulus in the right visual field as more clockwise. These two types of trials were combined in the same ‘adapt right’ bin, since the n-back inducer would facilitate a ‘right’ response in both cases. Analogously, we collected the trials for which repulsive adaptation would make participants more likely to report the stimulus in the left visual field as more clockwise in a ‘adapt left’ bin. The binning procedure was performed separately for trials in which the n-back inducer and current 2AFC stimuli were presented at the same vertical location (same location trials) or at a different vertical location (different location trials). In order to quantify the bias of the n-back inducer on perceived orientation of the 2AFC stimuli, we fitted psychometric functions to each participant’s data, separately for ‘adapt right’ and ‘adapt left’ bins. The psychometric function is given by <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> describes the proportion of ‘right’ responses and <inline-formula><mml:math id="inf10"><mml:mi>F</mml:mi></mml:math></inline-formula> is a cumulative Gaussian distribution. Parameters α and β determine the location and slope of the psychometric function and <italic>x</italic> denotes the orientation difference between right and left 2AFC stimuli on the current trial. Parameter λ account for stimulus independent lapses and was fixed to 0.01. Importantly, α corresponds to the point of subjective equality (PSE): the orientation difference between right and left stimulus for which participants perceived the orientations as equal. We estimated PSEs for ‘adapt right’ and ‘adapt left’ conditions and recorded the difference as ΔPSE = PSE<sub>bias left</sub> - PSE<sub>bias right</sub>, separately for same-location and different-location trials. We quantified the overall bias on perception as 0.5 * ΔPSE. This value indicates how much a 2AFC stimulus is biased by a single inducer stimulus. While positive values signal an attraction effect exerted by the n-back inducer, negative values imply repulsion. This analysis was performed separately for the inducer stimuli of the previous 10 trials, reaching back ~100 seconds into the past. To statistically assess whether previous inducer stimuli biased the current perceptual comparison, we averaged the bias estimates of the past 10 trials per participant, separately for same-location and different-location trials and compared these average biases against zero using two-sided one-sample t-tests (α = 0.05). Furthermore, we compared the average 1- to 10-back bias between same and different location trials using a two-sided paired t-test (α = 0.05). In order, to characterize the decay of the n-back biases over past trials, we fit exponential functions of the form <inline-formula><mml:math id="inf11"><mml:mi>N</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> to the same- and different location bias estimates, where <italic>n</italic> denotes the index of the n-back trial. We converted the decay constant λ into the half-life t<sub>1/2</sub> estimate with the formula <inline-formula><mml:math id="inf12"><mml:msub><mml:mrow> <mml:mi/> <mml:mi/><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p></sec><sec id="s4-5-4"><title>Ideal observer model</title><p>We modeled orientation estimates as resulting from a probabilistic encoding-decoding process. In this process, a physical grating stimulus with orientation <italic>θ</italic> elicits a noisy sensory measurement <italic>m</italic> (encoding), which is subsequently used to generate an estimate <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, representing the observer’s estimate of the stimulus orientation (decoding). To model history dependencies, we made two assumptions. First, we assumed that the encoding of the physical stimulus is efficient (<xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>), such that the sensory system is optimally adapted to represent the current stimulus orientation. In particular, in a stable environment in which current visual input is similar to previous input, the prior probability over current stimulus orientations is dependent on previously experienced stimuli. This predictability between previous and current stimuli allows the sensory system to allocate coding resources such that the mutual information between the likely physical stimulus and its sensory representation is maximized. Second, we assumed that at the decoding stage, similar to encoding, the observer forms a prediction about the current stimulus based on knowledge about previous stimuli and combines this prediction with the current sensory measurement in a probabilistically optimal, that is Bayesian manner (<xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). If predictions are well matched to the temporal regularities in the environment, combining such predictions with current sensory measurements generally produces more accurate stimulus estimates than those based on current sensory measurements alone. Using data of the three orientation estimation tasks (Experiments 1 to 3), we quantitatively compared such an ideal observer model with efficient encoding and Bayesian decoding, to observers that only exhibited efficient encoding or Bayesian decoding.</p></sec><sec id="s4-5-5"><title>Efficient encoding</title><p>The current efficient coding implementation largely follows the framework put forward by Wei and Stocker (<xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>; <xref ref-type="bibr" rid="bib60">Wei and Stocker, 2017</xref>). Briefly, we assumed that sensory encoding maximizes the mutual information I[θ, m] between the sensory measurement <italic>m</italic> and the physical stimulus orientation <italic>θ</italic> with regard to the intrinsic uncertainty in the sensory representation. To this end, the observer leverages its knowledge about the prior probability distribution over current stimulus orientations <italic>p(θ)</italic>. By using a tight bound on mutual information, one can link Fisher information <italic>J(θ)</italic> of the sensory representation to the prior stimulus probability <italic>p(θ)</italic>, such that <inline-formula><mml:math id="inf14"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo> <mml:mi/><mml:mo>∝</mml:mo> <mml:mi mathvariant="normal"/><mml:msqrt><mml:mi>J</mml:mi><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:msqrt></mml:math></inline-formula> (for details see <xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>). Fisher information reflects the amount of coding resources that is dedicated to the representation of a certain stimulus orientation <italic>θ</italic>. According to the above formulation, coding resources are allocated such that the most likely stimulus orientation is represented with highest accuracy. In order to specify the encoding model in terms of a likelihood function, we further assumed that sensory noise, and thus the likelihood function, is homogenous and symmetric around the physical stimulus orientation in a sensory space with uniform Fisher information defined by the mapping <italic>F(θ)</italic>, where <italic>F(θ)</italic> is the cumulative prior probability distribution over current stimulus orientations. After defining the likelihood function in sensory space, one can then apply the inverse mapping <inline-formula><mml:math id="inf15"><mml:msup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></inline-formula> to obtain the likelihood in stimulus space: <inline-formula><mml:math id="inf16"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. This likelihood is typically asymmetric, with a long tail away from the peak of the prior probability distribution (<xref ref-type="fig" rid="fig6">Figure 6B</xref>; for further intuition about the asymmetry in the likelihood function see <xref ref-type="bibr" rid="bib53">Stocker and Simoncelli, 2006</xref>).</p><p>Crucially, in contrast to <xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>, who assumed a fixed prior probability distribution <italic>p(θ),</italic> here we assumed that the sensory system leverages previous sensory measurements <inline-formula><mml:math id="inf17"><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, in order to predict the current stimulus <inline-formula><mml:math id="inf18"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. In particular, predictions are based on an internal model that approximates the true changes in orientation statistics in natural environments (<xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>):<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>U</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>180</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>with<disp-formula id="equ2"><mml:math id="m2"><mml:mi>C</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac> <mml:mi/><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mi/><mml:msup><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></disp-formula>where Z is a normalization constant that was computed numerically. This transition distribution describes the probability that a stimulus at time <italic>t</italic> has the orientation <inline-formula><mml:math id="inf19"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, given that the previous stimulus had the orientation <inline-formula><mml:math id="inf20"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. The distribution is formed by a mixture of a central Gaussian peak with standard deviation <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and a uniform distribution. The uniform distribution accounts for cases, in which orientations change suddenly and unpredictably, occurring with probability <inline-formula><mml:math id="inf22"> <mml:mi/><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>. <italic>t<sub>0</sub></italic> denotes the starting time point of the inference process.</p><p>In order to compute a prediction about the current stimulus orientation, <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, the sensory system then combines this model of natural orientation changes with its knowledge about the previous stimulus orientation, based on the previous sensory measurement:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>∫</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>where<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf24"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mrow> <mml:mi/><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula> is the likelihood function of the previous stimulus, and <italic>Z</italic> is a numerically computed normalization constant that ensures that <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since statistical regularities in natural environments do not only exist between immediately consecutive orientation samples, but over extended timescales, we further assumed that the sensory system does not only base its prediction about the current stimulus <inline-formula><mml:math id="inf26"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> on the previous measurement, but forms a prediction based on an exponentially weighted mixture of previous predictions:<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>with weights<disp-formula id="equ6"><mml:math id="m6"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mi/></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Where <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the exponential integration time constant that determines the time window over which the sensory system integrates previous predictions to predict the current stimulus orientation, and Z was a normalization constant, chosen such that <inline-formula><mml:math id="inf28"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, the exponential decay function is defined over elapsed trials, where <italic>t</italic> denotes the index of the current trial and <italic>i</italic> denotes the index of a previous trial. Thus, <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the number of elapsed trials after which the contribution of a stimulus to the encoding prior has decreased to 1/<italic>e</italic> ≈ 0.37 of its initial value. From this, we derived a half-life estimate with the formula <inline-formula><mml:math id="inf30"><mml:msub><mml:mrow> <mml:mi/> <mml:mi/><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mi>*</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> and converted this estimate to seconds by multiplying with the average trial duration of the respective experiment (average trial durations: Exp. 1: 5.38 s; Exp. 2: 6.55 s; Exp. 3: 8.25 s).</p><p>On a given trial, the sensory system then used the prediction <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to allocate sensory resources for the efficient encoding of stimulus <inline-formula><mml:math id="inf32"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, as described above, resulting in a new sensory measurement <inline-formula><mml:math id="inf33"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mrow> <mml:mi/><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>.</p></sec></sec><sec id="s4-6"><title>Bayesian decoding</title><p>After obtaining a noisy sensory measurement of the current stimulus, <inline-formula><mml:math id="inf34"> <mml:mi/><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msup><mml:mrow> <mml:mi/><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:math></inline-formula>, the observer seeks to infer the stimulus orientation, which most likely caused the measurement. Importantly, when doing so, the observer does not only rely on the current sensory measurement, but makes use of predictions based on knowledge about previous stimulus orientations (<xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). While, in principle, encoding and decoding stages could utilize the same predictions about the upcoming stimulus (see ‘<italic>Encoding-decoding model (single prior)’</italic> below), here we allowed encoding and decoding to be based on separate predictions, involving separate transition models and integration time constants. For instance, transition models in low-level sensory circuits, encoding visual information, could be acquired over the organism’s lifetime, whereas higher-level transition models used for decoding could be context dependent (<xref ref-type="bibr" rid="bib19">Fischer et al., 2020</xref>) and learned quickly, within minutes to hours (<xref ref-type="bibr" rid="bib5">Braun et al., 2018</xref>).</p><p>Following <xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>, predictions at the decoding stage were computed by convolving the distribution of knowledge about the previous stimulus <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with the distribution of changes that can occur between two consecutive measurements, as given by the transition model <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>∫</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Importantly, even though the Bayesian inference process is recursive and consequently the prediction <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> theoretically contains information about all sensory measurements since the starting point of the inference process, it has been previously found that such a model does not adequately capture positive serial dependencies beyond the most recent trial (<xref ref-type="bibr" rid="bib29">Kalm and Norris, 2018</xref>). Therefore, when predicting the upcoming stimulus orientation, the current observer does not only rely on the most recent prediction, but utilizes an exponentially weighted mixture of previous predictions (<xref ref-type="bibr" rid="bib29">Kalm and Norris, 2018</xref>):<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>with weights<disp-formula id="equ9"><mml:math id="m9"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mi/></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>Similar to encoding, the exponential decay function is defined over elapsed trials, where <italic>t</italic> denotes the index of the current trial and <italic>i</italic> denotes the index of a previous trial. Subsequently, the ideal observer combines this prediction with the current sensory measurement according to Bayes, resulting in a posterior distribution:<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>∝</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>We assume that the observer reports the mean of this posterior distribution as their best estimate of the viewed stimulus orientation. Reporting the mean presents the optimal strategy for minimizing the expected squared error (<xref ref-type="bibr" rid="bib32">Ma, 2019</xref>).</p><p>It should be noted that in this formulation of the ideal observer, the prior of the current trial consists of a mixture of previous trials’ posteriors, from which previous perceptual decisions were estimated, convolved with a transition distribution. Therefore, the likelihood of the current trial is pulled towards previous posteriors, more closely reflecting previous decisions, rather than previous likelihoods, reflecting previous stimuli.</p></sec><sec id="s4-7"><title>Models</title><p>We compared four different models in their ability to capture the temporal pattern of short-term attraction and long-term repulsion biases in our perceptual estimation experiments. While all of these models consisted of an encoding and decoding stage, they differed in how the sensory history influenced encoding and decoding, respectively:</p><sec id="s4-7-1"><title>Bayesian decoding model with history-independent encoding</title><p>The first model implemented history-dependent Bayesian decoding, without efficient encoding, and closely resembles a recent ideal observer model, which successfully modeled 1-back attractive serial dependencies (<xref ref-type="bibr" rid="bib55">van Bergen and Jehee, 2019</xref>). In contrast to the full model presented above, in this model the observer encoded physical stimulus orientations as a symmetric, Gaussian likelihood function centered on the true stimulus orientation:<disp-formula id="equ11"><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf38"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is the variance of the sensory noise. Consequently, the encoding of the current stimulus was independent of previously encoded stimuli. The model had four free parameters: <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf40"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf41"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p></sec><sec id="s4-7-2"><title>Efficient encoding model with history-independent decoding</title><p>The second model implemented efficient encoding of sensory information (<xref ref-type="bibr" rid="bib59">Wei and Stocker, 2015</xref>; <xref ref-type="bibr" rid="bib60">Wei and Stocker, 2017</xref>), without history-dependent Bayesian decoding. Thus, while the likelihood function was influenced by previously experienced stimuli through efficient coding (see section <italic>Efficient encoding</italic>), the decoding was based on the sensory measurement alone (analogous to multiplying the likelihood with a uniform, i.e. history-independent prior):<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <italic>Z</italic> is a numerically computed normalization constant that ensured that <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. In this model, the decoding of the current sensory measurement was thus independent of previously experienced stimuli. The model had four free parameters: <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf46"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p></sec><sec id="s4-7-3"><title>Efficient-encoding-Bayesian-decoding model (single prior)</title><p>A third model implemented both efficient encoding and history-dependent Bayesian decoding, and utilized the same prior probability distribution over current stimulus orientations, <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, both for efficient encoding and Bayesian decoding. Consequently, this observer had a single transition model, <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and integration time constant <inline-formula><mml:math id="inf50"><mml:mi>τ</mml:mi></mml:math></inline-formula> that determined the time window over which the observer integrated previous predictions to predict the current stimulus orientation. The model had four free parameters: <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf52"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf53"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf54"><mml:mi>τ</mml:mi></mml:math></inline-formula>.</p></sec><sec id="s4-7-4"><title>Full efficient-encoding-Bayesian-decoding model</title><p>Finally, the full encoding-decoding model implemented efficient encoding and Bayesian decoding, as described above. In this model, efficient encoding and Bayesian decoding could be based on distinct predictions, characterized by different transition models and separate integration time constants <inline-formula><mml:math id="inf55"> <mml:mi/> <mml:mi/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"> <mml:mi/><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, respectively. The model had seven free parameters: <inline-formula><mml:math id="inf57"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the encoding transition model, <inline-formula><mml:math id="inf60"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf61"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the decoding transition model, and <inline-formula><mml:math id="inf62"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf63"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p></sec></sec><sec id="s4-8"><title>Model fits</title><p>We fitted all four models to the empirical serial dependence biases of Experiment 1 to 3, respectively. In particular, models were fit to the 1- to 20-back group-average serial dependence curves of each experiment. In a first step, we performed a grid search over a wide range of parameter combinations and evaluated the sum of squared residuals (SSR) between predicted and observed serial dependence curves. Subsequently, we used the parameter combination with the lowest SSR as a starting point for further numerical minimization of SSRs using MATLAB’s lsqcurvefit algorithm. To ensure plausible parameter estimates we constrained parameters to <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>,<inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf66"> <mml:mi/><mml:mn>0</mml:mn> <mml:mi/><mml:mo>≤</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mi/><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Parameters of the encoding and decoding transition models of the full encoding-decoding model were constrained to the same ranges.</p></sec><sec id="s4-9"><title>Model evaluation</title><p>In order to evaluate the models’ ability to capture the empirically observed serial dependence biases, we employed a cross-validation procedure. Separately for each experiment, we split the data of each participant into two halves (odd- versus even-numbered blocks) and computed the group-average 1- to 20-back serial dependence curves for each half. We then conducted the model fitting on the first half and testing on the second half. The models’ performance was evaluated based on the Pearson correlation between the predicted and observed 1- to 20-back serial dependence curves of the testing dataset. This cross-validation procedure accounts for the increased flexibility of the full encoding-decoding model, due to its greater number of free parameters.</p><p>In order to establish a baseline level of chance prediction accuracy of each model, we employed a permutation procedure. Specifically, we randomly permuted the models’ predicted responses to the stimuli in the testing dataset, thereby abolishing the trial correspondence between model and participant errors, and computed the correlation between the resulting permuted model predictions and observed serial dependence curves. This procedure was repeated 1000 times and p-values were taken as the proportion of permutation correlations, which exceeded the true correlation between predicted and observed serial dependence curves.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Senior editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Formal analysis, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Human subjects: The study followed institutional guidelines of the local ethics committee (CMO region Arnhem-Nijmegen, The Netherlands; Protocol CMO2014/288), including informed consent of all participants.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-55389-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data and code are openly available on the Donders Institute for Brain, Cognition and Behavior repository at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.34973/hcea-dt25">https://doi.org/10.34973/hcea-dt25</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Fritsche</surname><given-names>M</given-names></name><name><surname>Spaak</surname><given-names>E</given-names></name><name><surname>de Lange</surname><given-names>FP</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>A Bayesian and efficient observer model explains concurrent attractive and repulsive history biases in visual perception</data-title><source>Donders Repository</source><pub-id assigning-authority="other" pub-id-type="doi">10.34973/hcea-dt25</pub-id></element-citation></p><p>The following previously published dataset was used:</p><p><element-citation id="dataset2" publication-type="data" specific-use="references"><person-group person-group-type="author"><name><surname>Fritsche</surname><given-names>MF</given-names></name><name><surname>Mostert</surname><given-names>P</given-names></name><name><surname>de Lange</surname><given-names>FP</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Opposite Effects of Recent History on Perception and Decision</data-title><source>Donders Repository</source><pub-id assigning-authority="other" pub-id-type="doi">10.34973/yzm7-bd26</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barlow</surname> <given-names>HB</given-names></name></person-group><year iso-8601-date="1961">1961</year><chapter-title>Possible Principles Underlying the Transformations of Sensory messages</chapter-title><person-group person-group-type="editor"><name><surname>Rosenblith</surname> <given-names>W</given-names></name></person-group><source>Sensory Communication</source><publisher-loc>Cambridge, Mass</publisher-loc><publisher-name>M.I.T. Press</publisher-name><fpage>217</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.7551/mitpress/9780262518420.003.0013</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barlow</surname> <given-names>HB</given-names></name><name><surname>Földiák</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1989">1989</year><chapter-title>Adaptation and decorrelation in the cortex</chapter-title><person-group person-group-type="editor"><name><surname>Durbin</surname> <given-names>R</given-names></name><name><surname>Miall</surname> <given-names>C</given-names></name><name><surname>Mitchison</surname> <given-names>G</given-names></name></person-group><source>The Computing Neuron</source><publisher-loc>Wokingham, England</publisher-loc><publisher-name>Addison-Wesley</publisher-name><fpage>54</fpage><lpage>72</lpage></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bliss</surname> <given-names>DP</given-names></name><name><surname>Sun</surname> <given-names>JJ</given-names></name><name><surname>D'Esposito</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Serial dependence is absent at the time of perception but increases in visual working memory</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>14739</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-15199-7</pub-id><pub-id pub-id-type="pmid">29116132</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boi</surname> <given-names>M</given-names></name><name><surname>Oğmen</surname> <given-names>H</given-names></name><name><surname>Herzog</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Motion and tilt aftereffects occur largely in retinal, not in object, coordinates in the Ternus-Pikler display</article-title><source>Journal of Vision</source><volume>11</volume><elocation-id>7</elocation-id><pub-id pub-id-type="doi">10.1167/11.3.7</pub-id><pub-id pub-id-type="pmid">21389102</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Braun</surname> <given-names>A</given-names></name><name><surname>Urai</surname> <given-names>AE</given-names></name><name><surname>Donner</surname> <given-names>TH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Adaptive history biases result from Confidence-Weighted accumulation of past choices</article-title><source>The Journal of Neuroscience</source><volume>38</volume><fpage>2418</fpage><lpage>2429</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2189-17.2017</pub-id><pub-id pub-id-type="pmid">29371318</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burr</surname> <given-names>D</given-names></name><name><surname>Ross</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A Visual Sense of Number</article-title><source>Current Biology</source><volume>18</volume><fpage>425</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2008.02.052</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chopin</surname> <given-names>A</given-names></name><name><surname>Mamassian</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Predictive Properties of Visual Adaptation</article-title><source>Current Biology</source><volume>22</volume><fpage>622</fpage><lpage>626</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2012.02.021</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cicchini</surname> <given-names>GM</given-names></name><name><surname>Anobile</surname> <given-names>G</given-names></name><name><surname>Burr</surname> <given-names>DC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Compressive mapping of number to space reflects dynamic encoding mechanisms, not static logarithmic transform</article-title><source>PNAS</source><volume>111</volume><fpage>7867</fpage><lpage>7872</lpage><pub-id pub-id-type="doi">10.1073/pnas.1402785111</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cicchini</surname> <given-names>GM</given-names></name><name><surname>Mikellidou</surname> <given-names>K</given-names></name><name><surname>Burr</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Serial dependencies act directly on perception</article-title><source>Journal of Vision</source><volume>17</volume><elocation-id>6</elocation-id><pub-id pub-id-type="doi">10.1167/17.14.6</pub-id><pub-id pub-id-type="pmid">29209696</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cicchini</surname> <given-names>GM</given-names></name><name><surname>Mikellidou</surname> <given-names>K</given-names></name><name><surname>Burr</surname> <given-names>DC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>The functional role of serial dependence</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>285</volume><elocation-id>20181722</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2018.1722</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clifford</surname> <given-names>CWG</given-names></name><name><surname>Wenderoth</surname> <given-names>P</given-names></name><name><surname>Spehar</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A functional angle on some after-effects in cortical vision</article-title><source>Proceedings of the Royal Society of London. Series B: Biological Sciences</source><volume>267</volume><fpage>1705</fpage><lpage>1710</lpage><pub-id pub-id-type="doi">10.1098/rspb.2000.1198</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clifford</surname> <given-names>CW</given-names></name><name><surname>Wyatt</surname> <given-names>AM</given-names></name><name><surname>Arnold</surname> <given-names>DH</given-names></name><name><surname>Smith</surname> <given-names>ST</given-names></name><name><surname>Wenderoth</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Orthogonal adaptation improves orientation discrimination</article-title><source>Vision Research</source><volume>41</volume><fpage>151</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1016/S0042-6989(00)00248-0</pub-id><pub-id pub-id-type="pmid">11163850</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The perceptual continuity field is retinotopic</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>18841</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-55134-6</pub-id><pub-id pub-id-type="pmid">31827138</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corbett</surname> <given-names>JE</given-names></name><name><surname>Fischer</surname> <given-names>J</given-names></name><name><surname>Whitney</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Facilitating stable representations: serial dependence in vision</article-title><source>PLOS ONE</source><volume>6</volume><elocation-id>e16701</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0016701</pub-id><pub-id pub-id-type="pmid">21304953</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Czoschke</surname> <given-names>S</given-names></name><name><surname>Fischer</surname> <given-names>C</given-names></name><name><surname>Beitner</surname> <given-names>J</given-names></name><name><surname>Kaiser</surname> <given-names>J</given-names></name><name><surname>Bledowski</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Two types of serial dependence in visual working memory</article-title><source>British Journal of Psychology</source><volume>110</volume><fpage>256</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1111/bjop.12349</pub-id><pub-id pub-id-type="pmid">30198553</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dekel</surname> <given-names>R</given-names></name><name><surname>Sagi</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Tilt aftereffect due to adaptation to natural stimuli</article-title><source>Vision Research</source><volume>117</volume><fpage>91</fpage><lpage>99</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2015.10.014</pub-id><pub-id pub-id-type="pmid">26550954</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname> <given-names>DW</given-names></name><name><surname>Atick</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Statistics of natural time-varying images</article-title><source>Network: Computation in Neural Systems</source><volume>6</volume><fpage>345</fpage><lpage>358</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_6_3_003</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsen</surname> <given-names>G</given-names></name><name><surname>Touryan</surname> <given-names>J</given-names></name><name><surname>Dan</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Contextual modulation of orientation tuning contributes to efficient processing of natural stimuli</article-title><source>Network: Computation in Neural Systems</source><volume>16</volume><fpage>139</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1080/09548980500463347</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname> <given-names>C</given-names></name><name><surname>Czoschke</surname> <given-names>S</given-names></name><name><surname>Peters</surname> <given-names>B</given-names></name><name><surname>Rahm</surname> <given-names>B</given-names></name><name><surname>Kaiser</surname> <given-names>J</given-names></name><name><surname>Bledowski</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Context information supports serial dependence of multiple visual objects across memory episodes</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>1932</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-15874-w</pub-id><pub-id pub-id-type="pmid">32321924</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischer</surname> <given-names>J</given-names></name><name><surname>Whitney</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Serial dependence in visual perception</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>738</fpage><lpage>743</lpage><pub-id pub-id-type="doi">10.1038/nn.3689</pub-id><pub-id pub-id-type="pmid">24686785</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fornaciai</surname> <given-names>M</given-names></name><name><surname>Park</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Attractive serial dependence in the absence of an explicit task</article-title><source>Psychological Science</source><volume>29</volume><fpage>437</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1177/0956797617737385</pub-id><pub-id pub-id-type="pmid">29381415</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fornaciai</surname> <given-names>M</given-names></name><name><surname>Park</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spontaneous repulsive adaptation in the absence of attractive serial dependence</article-title><source>Journal of Vision</source><volume>19</volume><elocation-id>21</elocation-id><pub-id pub-id-type="doi">10.1167/19.5.21</pub-id><pub-id pub-id-type="pmid">31112999</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fritsche</surname> <given-names>M</given-names></name><name><surname>Mostert</surname> <given-names>P</given-names></name><name><surname>de Lange</surname> <given-names>FP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Opposite effects of recent history on perception and decision</article-title><source>Current Biology</source><volume>27</volume><fpage>590</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.01.006</pub-id><pub-id pub-id-type="pmid">28162897</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fritsche</surname> <given-names>M</given-names></name><name><surname>de Lange</surname> <given-names>FP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The role of feature-based attention in visual serial dependence</article-title><source>Journal of Vision</source><volume>19</volume><elocation-id>21</elocation-id><pub-id pub-id-type="doi">10.1167/19.13.21</pub-id><pub-id pub-id-type="pmid">31770772</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gekas</surname> <given-names>N</given-names></name><name><surname>McDermott</surname> <given-names>KC</given-names></name><name><surname>Mamassian</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Disambiguating serial effects of multiple timescales</article-title><source>Journal of Vision</source><volume>19</volume><elocation-id>24</elocation-id><pub-id pub-id-type="doi">10.1167/19.6.24</pub-id><pub-id pub-id-type="pmid">31251808</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibson</surname> <given-names>JJ</given-names></name><name><surname>Radner</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1937">1937</year><article-title>Adaptation, after-effect and contrast in the perception of tilted lines. I. quantitative studies</article-title><source>Journal of Experimental Psychology</source><volume>20</volume><fpage>453</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1037/h0059826</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gordon</surname> <given-names>U</given-names></name><name><surname>Marom</surname> <given-names>S</given-names></name><name><surname>Brenner</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Visual detection of time-varying signals: opposing biases and their timescales</article-title><source>PLOS ONE</source><volume>14</volume><elocation-id>e0224256</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0224256</pub-id><pub-id pub-id-type="pmid">31725731</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname> <given-names>DZ</given-names></name><name><surname>Dragoi</surname> <given-names>V</given-names></name><name><surname>Sur</surname> <given-names>M</given-names></name><name><surname>Seung</surname> <given-names>HS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Tilt aftereffect and adaptation-induced changes in orientation tuning in visual cortex</article-title><source>Journal of Neurophysiology</source><volume>94</volume><fpage>4038</fpage><lpage>4050</lpage><pub-id pub-id-type="doi">10.1152/jn.00571.2004</pub-id><pub-id pub-id-type="pmid">16135549</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalm</surname> <given-names>K</given-names></name><name><surname>Norris</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Visual recency bias is explained by a mixture model of internal representations</article-title><source>Journal of Vision</source><volume>18</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1167/18.7.1</pub-id><pub-id pub-id-type="pmid">29971347</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanai</surname> <given-names>R</given-names></name><name><surname>Verstraten</surname> <given-names>FA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Perceptual manifestations of fast neural plasticity: motion priming, rapid motion aftereffect and perceptual sensitization</article-title><source>Vision Research</source><volume>45</volume><fpage>3109</fpage><lpage>3116</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2005.05.014</pub-id><pub-id pub-id-type="pmid">16023173</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knapen</surname> <given-names>T</given-names></name><name><surname>Rolfs</surname> <given-names>M</given-names></name><name><surname>Wexler</surname> <given-names>M</given-names></name><name><surname>Cavanagh</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The reference frame of the tilt aftereffect</article-title><source>Journal of Vision</source><volume>10</volume><elocation-id>8</elocation-id><pub-id pub-id-type="doi">10.1167/10.1.8</pub-id><pub-id pub-id-type="pmid">20143901</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname> <given-names>WJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bayesian decision models: a primer</article-title><source>Neuron</source><volume>104</volume><fpage>164</fpage><lpage>175</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.09.037</pub-id><pub-id pub-id-type="pmid">31600512</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manassi</surname> <given-names>M</given-names></name><name><surname>Liberman</surname> <given-names>A</given-names></name><name><surname>Kosovicheva</surname> <given-names>A</given-names></name><name><surname>Zhang</surname> <given-names>K</given-names></name><name><surname>Whitney</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Serial dependence in position occurs at the time of perception</article-title><source>Psychonomic Bulletin &amp; Review</source><volume>25</volume><fpage>2245</fpage><lpage>2253</lpage><pub-id pub-id-type="doi">10.3758/s13423-018-1454-5</pub-id><pub-id pub-id-type="pmid">29582377</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathôt</surname> <given-names>S</given-names></name><name><surname>Theeuwes</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A reinvestigation of the reference frame of the tilt-adaptation aftereffect</article-title><source>Scientific Reports</source><volume>3</volume><elocation-id>1152</elocation-id><pub-id pub-id-type="doi">10.1038/srep01152</pub-id><pub-id pub-id-type="pmid">23359857</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mattar</surname> <given-names>MG</given-names></name><name><surname>Olkkonen</surname> <given-names>M</given-names></name><name><surname>Epstein</surname> <given-names>RA</given-names></name><name><surname>Aguirre</surname> <given-names>GK</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Adaptation decorrelates shape representations</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>3812</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-06278-y</pub-id><pub-id pub-id-type="pmid">30232324</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maus</surname> <given-names>GW</given-names></name><name><surname>Chaney</surname> <given-names>W</given-names></name><name><surname>Liberman</surname> <given-names>A</given-names></name><name><surname>Whitney</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The challenge of measuring long-term positive aftereffects</article-title><source>Current Biology</source><volume>23</volume><fpage>R438</fpage><lpage>R439</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.03.024</pub-id><pub-id pub-id-type="pmid">23701683</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDermott</surname> <given-names>KC</given-names></name><name><surname>Malkoc</surname> <given-names>G</given-names></name><name><surname>Mulligan</surname> <given-names>JB</given-names></name><name><surname>Webster</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Adaptation and visual salience</article-title><source>Journal of Vision</source><volume>10</volume><elocation-id>17</elocation-id><pub-id pub-id-type="doi">10.1167/10.13.17</pub-id><pub-id pub-id-type="pmid">21106682</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname> <given-names>JR</given-names></name><name><surname>Metha</surname> <given-names>AB</given-names></name><name><surname>Krauskopf</surname> <given-names>J</given-names></name><name><surname>Lennie</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Rapid adaptation in visual cortex to the structure of images</article-title><source>Science</source><volume>285</volume><fpage>1405</fpage><lpage>1408</lpage><pub-id pub-id-type="doi">10.1126/science.285.5432.1405</pub-id><pub-id pub-id-type="pmid">10464100</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Panichello</surname> <given-names>MF</given-names></name><name><surname>DePasquale</surname> <given-names>B</given-names></name><name><surname>Pillow</surname> <given-names>JW</given-names></name><name><surname>Buschman</surname> <given-names>TJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Error-correcting dynamics in visual working memory</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>3366</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-11298-3</pub-id><pub-id pub-id-type="pmid">31358740</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papadimitriou</surname> <given-names>C</given-names></name><name><surname>Ferdoash</surname> <given-names>A</given-names></name><name><surname>Snyder</surname> <given-names>LH</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Ghosts in the machine: memory interference from the previous trial</article-title><source>Journal of Neurophysiology</source><volume>113</volume><fpage>567</fpage><lpage>577</lpage><pub-id pub-id-type="doi">10.1152/jn.00402.2014</pub-id><pub-id pub-id-type="pmid">25376781</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pape</surname> <given-names>A-A</given-names></name><name><surname>Siegel</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Motor cortex activity predicts response alternation during sensorimotor decisions</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>13098</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms13098</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pascucci</surname> <given-names>D</given-names></name><name><surname>Mancuso</surname> <given-names>G</given-names></name><name><surname>Santandrea</surname> <given-names>E</given-names></name><name><surname>Della Libera</surname> <given-names>C</given-names></name><name><surname>Plomp</surname> <given-names>G</given-names></name><name><surname>Chelazzi</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Laws of concatenated perception: vision goes for novelty, decisions for perseverance</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e3000144</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000144</pub-id><pub-id pub-id-type="pmid">30835720</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastukhov</surname> <given-names>A</given-names></name><name><surname>Braun</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Disparate time-courses of adaptation and facilitation in multi-stable perception</article-title><source>Learning &amp; Perception</source><volume>5</volume><fpage>101</fpage><lpage>118</lpage><pub-id pub-id-type="doi">10.1556/LP.5.2013.Suppl2.7</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname> <given-names>CA</given-names></name><name><surname>Wissig</surname> <given-names>SC</given-names></name><name><surname>Kohn</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Distinct Effects of Brief and Prolonged Adaptation on Orientation Tuning in Primary Visual Cortex</article-title><source>Journal of Neuroscience</source><volume>33</volume><fpage>532</fpage><lpage>543</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3345-12.2013</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patterson</surname> <given-names>CA</given-names></name><name><surname>Duijnhouwer</surname> <given-names>J</given-names></name><name><surname>Wissig</surname> <given-names>SC</given-names></name><name><surname>Krekelberg</surname> <given-names>B</given-names></name><name><surname>Kohn</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Similar adaptation effects in primary visual cortex and area MT of the macaque monkey under matched stimulus conditions</article-title><source>Journal of Neurophysiology</source><volume>111</volume><fpage>1203</fpage><lpage>1213</lpage><pub-id pub-id-type="doi">10.1152/jn.00030.2013</pub-id><pub-id pub-id-type="pmid">24371295</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pavan</surname> <given-names>A</given-names></name><name><surname>Marotti</surname> <given-names>RB</given-names></name><name><surname>Campana</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The temporal course of recovery from brief (sub-second) adaptations to spatial contrast</article-title><source>Vision Research</source><volume>62</volume><fpage>116</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.visres.2012.04.001</pub-id><pub-id pub-id-type="pmid">22521510</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Regan</surname> <given-names>D</given-names></name><name><surname>Beverley</surname> <given-names>KI</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Postadaptation orientation discrimination</article-title><source>Journal of the Optical Society of America A</source><volume>2</volume><fpage>147</fpage><lpage>155</lpage><pub-id pub-id-type="doi">10.1364/JOSAA.2.000147</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samaha</surname> <given-names>J</given-names></name><name><surname>Switzky</surname> <given-names>M</given-names></name><name><surname>Postle</surname> <given-names>BR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Confidence boosts serial dependence in orientation estimation</article-title><source>Journal of Vision</source><volume>19</volume><elocation-id>25</elocation-id><pub-id pub-id-type="doi">10.1167/19.4.25</pub-id><pub-id pub-id-type="pmid">31009526</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname> <given-names>O</given-names></name><name><surname>Hsu</surname> <given-names>A</given-names></name><name><surname>Dayan</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Space and time in visual context</article-title><source>Nature Reviews Neuroscience</source><volume>8</volume><fpage>522</fpage><lpage>535</lpage><pub-id pub-id-type="doi">10.1038/nrn2155</pub-id><pub-id pub-id-type="pmid">17585305</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwiedrzik</surname> <given-names>CM</given-names></name><name><surname>Ruff</surname> <given-names>CC</given-names></name><name><surname>Lazar</surname> <given-names>A</given-names></name><name><surname>Leitner</surname> <given-names>FC</given-names></name><name><surname>Singer</surname> <given-names>W</given-names></name><name><surname>Melloni</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Untangling perceptual memory: hysteresis and adaptation map into separate cortical networks</article-title><source>Cerebral Cortex</source><volume>24</volume><fpage>1152</fpage><lpage>1164</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhs396</pub-id><pub-id pub-id-type="pmid">23236204</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simoncelli</surname> <given-names>EP</given-names></name><name><surname>Olshausen</surname> <given-names>BA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Natural image statistics and neural representation</article-title><source>Annual Review of Neuroscience</source><volume>24</volume><fpage>1193</fpage><lpage>1216</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.24.1.1193</pub-id><pub-id pub-id-type="pmid">11520932</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Solomon</surname> <given-names>SG</given-names></name><name><surname>Kohn</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Moving sensory adaptation beyond suppressive effects in single neurons</article-title><source>Current Biology</source><volume>24</volume><fpage>R1012</fpage><lpage>R1022</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.09.001</pub-id><pub-id pub-id-type="pmid">25442850</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Stocker</surname> <given-names>AA</given-names></name><name><surname>Simoncelli</surname> <given-names>EP</given-names></name></person-group><year iso-8601-date="2006">2006</year><chapter-title>Sensory Adaptation Within a Bayesian Framework for Perception Advances</chapter-title><person-group person-group-type="editor"><name><surname>Weiss</surname> <given-names>Y</given-names></name><name><surname>Schölkopf</surname> <given-names>B</given-names></name><name><surname>Platt</surname> <given-names>J</given-names></name></person-group><source>Neural Information Processing Systems</source><publisher-loc>Cambridge MA</publisher-loc><publisher-name>MIT Press</publisher-name><fpage>1291</fpage><lpage>1298</lpage></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suárez-Pinilla</surname> <given-names>M</given-names></name><name><surname>Seth</surname> <given-names>AK</given-names></name><name><surname>Roseboom</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Serial dependence in the perception of visual variance</article-title><source>Journal of Vision</source><volume>18</volume><elocation-id>4</elocation-id><pub-id pub-id-type="doi">10.1167/18.7.4</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Bergen</surname> <given-names>RS</given-names></name><name><surname>Jehee</surname> <given-names>JFM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Probabilistic Representation in Human Visual Cortex Reflects Uncertainty in Serial Decisions</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>8164</fpage><lpage>8176</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3212-18.2019</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Burg</surname> <given-names>E</given-names></name><name><surname>Rhodes</surname> <given-names>G</given-names></name><name><surname>Alais</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Positive sequential dependency for face attractiveness perception</article-title><source>Journal of Vision</source><volume>19</volume><elocation-id>6</elocation-id><pub-id pub-id-type="doi">10.1167/19.12.6</pub-id><pub-id pub-id-type="pmid">31621804</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>Z</given-names></name><name><surname>Stocker</surname> <given-names>AA</given-names></name><name><surname>Lee</surname> <given-names>DD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Optimal neural tuning curves for arbitrary stimulus distributions: discrimax, infomax and minimum lp loss</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>2177</fpage><lpage>2185</lpage></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webster</surname> <given-names>MA</given-names></name><name><surname>Mollon</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Changes in colour appearance following post-receptoral adaptation</article-title><source>Nature</source><volume>349</volume><fpage>235</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1038/349235a0</pub-id><pub-id pub-id-type="pmid">1987475</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>X-X</given-names></name><name><surname>Stocker</surname> <given-names>AA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A Bayesian observer model constrained by efficient coding can explain 'anti-Bayesian' percepts</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>1509</fpage><lpage>1517</lpage><pub-id pub-id-type="doi">10.1038/nn.4105</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>XX</given-names></name><name><surname>Stocker</surname> <given-names>AA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Lawful relation between perceptual bias and discriminability</article-title><source>PNAS</source><volume>114</volume><fpage>10244</fpage><lpage>10249</lpage><pub-id pub-id-type="doi">10.1073/pnas.1619153114</pub-id><pub-id pub-id-type="pmid">28874578</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wissig</surname> <given-names>SC</given-names></name><name><surname>Patterson</surname> <given-names>CA</given-names></name><name><surname>Kohn</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Adaptation improves performance on a visual search task</article-title><source>Journal of Vision</source><volume>13</volume><elocation-id>6</elocation-id><pub-id pub-id-type="doi">10.1167/13.2.6</pub-id><pub-id pub-id-type="pmid">23390320</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolff</surname> <given-names>MJ</given-names></name><name><surname>Jochim</surname> <given-names>J</given-names></name><name><surname>Akyürek</surname> <given-names>EG</given-names></name><name><surname>Buschman</surname> <given-names>TJ</given-names></name><name><surname>Stokes</surname> <given-names>MG</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Drifting codes within a stable coding scheme for working memory</article-title><source>PLOS Biology</source><volume>18</volume><elocation-id>e3000625</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000625</pub-id><pub-id pub-id-type="pmid">32119658</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55389.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Serences</surname><given-names>John T</given-names></name><role>Reviewing Editor</role><aff><institution>University of California, San Diego</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Sheehan</surname><given-names>Timothy</given-names> </name><role>Reviewer</role><aff><institution>UC San Diego</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p>Thank you for submitting your article &quot;A Bayesian and efficient observer model explains concurrent attractive and repulsive history biases in visual perception&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Joshua Gold as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Timothy Sheehan (Reviewer #1).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>As the editors have judged that your manuscript is of interest, but as described below that additional analyses are required before it is published, we would like to draw your attention to changes in our policy on revisions we have made in response to COVID-19 (https://elifesciences.org/articles/57162). First, because many researchers have temporarily lost access to the labs, we will give authors as much time as they need to submit revised manuscripts. We are also offering, if you choose, to post the manuscript to bioRxiv (if it is not already there) along with this decision letter and a formal designation that the manuscript is 'in revision at <italic>eLife</italic>'. Please let us know if you would like to pursue this option.</p><p>In addition to all of the specific comments from the reviews, we especially focused on the following issues during consultation.</p><p>The clarity of model needs to be improved, both in terms of presentation and justifying choices as well as strengthening the link between the Bayesian decoding framework fit and other observations in the literature (e.g. that serial dependence emerges and increases with working memory delay period).</p><p>Both reviewers also focused on the importance of accounting for motor biases, which has been shown to be an important contributing factor in response bias for trial history effects (e.g. Akrami et al., 2018). See their comments for more specifics.</p><p>During consultation, the reviewers also raised the importance of considering the variability of the discrimination threshold. The current model is based on an efficient coding formulation from Wei and Stocker, which predicts that the discrimination threshold should be inversely proportional to the prior distribution. The authors could re-analyze the data to test this prediction, as least qualitatively.</p><p><italic>Reviewer #1:</italic></p><p>This manuscript clearly describes a previously underreported perceptual effect including many critical details such as time course and spatial specificity. Reported effects were robust and were replicated in two additional datasets. Fritsche et al. make sense of this phenomenon by building off of recent modeling work utilizing both principals of both Bayesian inference and efficient coding. This model is innovative by combining distinct concepts and introducing an exponential decay of trial influence across time. Critically, it provides a great fit to the pooled data both subjectively (Figure 7—figure supplement 1) and when quantified using cross validation (Figure 7—figure supplement 3). Overall this proposed model adds needed clarity to an area of research with much confusion and apparently contradictory results.</p><p>One point of concern is the lack of evidence for efficient encoding being the mechanism leading to repulsion. The authors do not cover an important feature (and the whole theoretical motivation for efficient encoding), that responses are more accurate (or discrimination thresholds smallest) for orientations where Fisher information is highest (see Stoker and Simoncelli, 2006: Figure 4). Since Fisher Information is directly linked to the prior probability, this would be supported by seeing a reduction is absolute error on trials with previous stimuli that are similar in orientation. In line with the exponential decay of efficient encoding, the magnitude of this change in response accuracy (perhaps parameterized with the second derivative of gaussian) should decay with time. If this does not hold true, then the authors should acknowledge other possible explanations for repulsion of previous stimuli including sensory adaptation from, for example, synaptic fatigue (see Solomon and Kohn, 2014).</p><p><italic>Reviewer #2:</italic></p><p>The authors examined historical effect in perception using data from one new experiment and three previously published datasets. They found both attractive serial dependence (Fischer and Whitney, 2014) and repulsive effect in the same experiments, and crucially the two effects have different time scales. To explain these findings, they modified an efficient coding-bayesian decoding framework (Wei and Stocker, 2015; 2017) and found that a modified model could fit the data well. The new ingredient of the current model is that the predictive prior used in Bayesian inference and efficient coding do not match each other. I think this work contains some interesting results, and could potentially help unify an array of previously disconnected findings. Having said that, I do find that various interpretations of the results to be problematic, and the presentation of the models to be very confusing.</p><p>1) Potential confounding factor, i.e., the motor biases, in the reproduction task.</p><p>I think it is important to rule this out, in particular for the attractive biases under short time scale. The results in Experiment 4 addresses the perceptual aspect of the long-term repulsive bias to some extent. However, I am puzzled why attractive biases were not observed/reported in this 2-AFC paradigm. If the serial dependence is a perceptual effect, shouldn't we expect attractive biases at short-term scale? I had a difficult time reconciling the results in the two paradigms.</p><p>2) The calculation of the historical effect:</p><p>Should the attractive/repulsive bias be considered with respect to the orientation of the stimulus or the reported orientation? It would be useful to run the analysis using the reported orientation. Barbosa and Compte (2020, bioRxiv) reports the serial dependence is stronger with using reported stimuli. It would be useful to check whether that's also the case in the authors' data.</p><p>If the historical effect need depends on the reported orientation, there seems to be a following-up concern. This one is perhaps naive but could be potentially important if it's true: could attraction biases (toward reported stimulus value) at the short-time scale automatically lead to repulsion at longer time-scale? It would be useful to simulate a ground-truth model with just attraction toward the reported (but no generic repulsion) to see if using the authors' analysis procedure would lead to repulsive effect in longer time scale.</p><p>3) The spatial dependence of repulsion and attraction:</p><p>The authors claim the attractive biases are not spatially specific (Figure 3), while the repulsive biases are spatially specific. The spatial specificity of the repulsive bias is interpreted as to be consistent with the adaptation effect as measured previously. I found this to be problematic. The two stimulus locations are separated by 13° eccentricity, yet there is still a clear repulsive effect for the &quot;different location&quot; condition. I'd think classical orientation adaptation would lead to almost zero after-effect when the stimulus was to presented to that far away from the adaptor.</p><p>4) The role of the noise patch in the experiments is obscure.</p><p>If removing the noise patch and using a blank screen instead, would one still observe similar effect? The computational models do not model the noise patch, so I'd think it is fair to say that the model should predict that removing the noise patch would not change any of these biases.</p><p>Alternatively, perhaps the noise patch does play a rule. In Experiment 4, noise patch was not used, and interestingly the attractive bias was not observed. So could the noise patch be the main reason why different effects were observed for the two paradigms (this also relates back to my first concern)?</p><p>5) The explanation/presentation of the model is highly confusing.</p><p>The labeling of efficient coding model and Bayesian decoding model is particularly mis-leading. Each of the models consider in this paper has an efficient encoding component and a Bayesian decoding component. So I found it is strange to label one as encoding model and another as decoding model.</p><p>Relatedly, in the sixth paragraph of the subsection “Repulsive and attractive biases can be explained by efficient encoding and optimal decoding of visual information”, the model the authors referring to is a model consisting efficient coding and Bayesian decoding with mismatched prior. It is the mis-match between the encoding and decoding that leads to the explanation power.</p><p>Again it is misleading to talk about model with &quot;only Bayesian decoding&quot; or with &quot;only efficient coding&quot;. I feel that it is not what actually happens in the models, unless I am profoundly confused with what the authors actually did.</p><p>These are some of the instances in the paper which could lead to profound confusions. I'd suggest the authors to systematically re-write the last section of the Results and the related section in the Discussion to make it clear.</p><p>6) The dependence of historical biases on time scales within a single experiment has been reported previously. For example, Dekel and Sagi, 2015, reported a sign reversal of the biases when examining different time-scales in adaptation experiments using natural stimuli (their Figure 4). Interestingly, they found the opposite pattern, i.e. repulsion at short-time scale, attraction at longer-time scale. There might be other related studies I missed. I feel that the authors should discuss the relevant findings more thoroughly.</p><p>Reference:</p><p>Barbosa, João, and Albert Compte. &quot;Build-up of serial dependence in color working memory.&quot; bioRxiv (2019): 503185.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.55389.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>[…] In addition to all of the specific comments from the reviews, we especially focused on the following issues during consultation.</p><p>The clarity of model needs to be improved, both in terms of presentation and justifying choices as well as strengthening the link between the Bayesian decoding framework fit and other observations in the literature (e.g. that serial dependence emerges and increases with working memory delay period).</p></disp-quote><p>We now improved the clarity of the model and strengthened the link between the Bayesian decoding framework and other observations in the literature (subsection “Repulsive and attractive biases can be explained by efficient encoding and Bayesian decoding of visual information”, fifth paragraph). Please see the point-by-point replies to the reviewers’ comments for detailed descriptions of the improvements.</p><disp-quote content-type="editor-comment"><p>Both reviewers also focused on the importance of accounting for motor biases, which has been shown to be an important contributing factor in response bias for trial history effects (e.g. Akrami et al., 2018). See their comments for more specifics.</p></disp-quote><p>We appreciate this concern. However, due to the specific design of the current experiments and empirical evidence provided by previous studies, we regard a systematic contribution of motor biases in the current experiments as highly unlikely. We provide a detailed explanation in our response to point 1 by reviewer 2 and added a discussion of motor biases to the manuscript (subsection “Repulsive and attractive biases can be explained by efficient encoding and Bayesian decoding of visual information”, eighth paragraph).</p><disp-quote content-type="editor-comment"><p>During consultation, the reviewers also raised the importance of considering the variability of the discrimination threshold. The current model is based on an efficient coding formulation from Wei and Stocker, which predicts that the discrimination threshold should be inversely proportional to the prior distribution. The authors could re-analyze the data to test this prediction, as least qualitatively.</p></disp-quote><p>We now re-analyzed the data to test this prediction (subsection “Repulsive and attractive biases can be explained by efficient encoding and optimal 341 decoding of visual information”, seventh paragraph and Figure 7—figure supplement 4). While we indeed confirm such a pattern for the 1-back stimulus, the estimates of sensitivity conditioned on temporally distant trials were relatively noisy and did not provide clear evidence for or against this hypothesis. We now discuss this in the limitations section of the manuscript, and emphasize the need for future studies to test this prediction of the efficient encoding model. Please see point 1 by reviewer 1 for a detailed response to this point.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>[…] One point of concern is the lack of evidence for efficient encoding being the mechanism leading to repulsion. The authors do not cover an important feature (and the whole theoretical motivation for efficient encoding), that responses are more accurate (or discrimination thresholds smallest) for orientations where Fisher information is highest (see Stoker and Simoncelli, 2006: Figure 4). Since Fisher Information is directly linked to the prior probability, this would be supported by seeing a reduction is absolute error on trials with previous stimuli that are similar in orientation. In line with the exponential decay of efficient encoding, the magnitude of this change in response accuracy (perhaps parameterized with the second derivative of gaussian) should decay with time. If this does not hold true, then the authors should acknowledge other possible explanations for repulsion of previous stimuli including sensory adaptation from, for example, synaptic fatigue (see Solomon and Kohn, 2014).</p></disp-quote><p>The current efficient coding scheme in which the observer maximizes the mutual information between physical stimuli and sensory representations would indeed predict that discrimination thresholds should be lowest when previous stimuli were of similar orientation, in line with previous findings of improved discriminability following adaptation (Clifford et al., 2001; Mattar et al., 2018; Regan and Beverley, 1985). In the context of the current estimation tasks, note that we can distinguish two sources of response errors: bias and variability. The original manuscript already describes bias in detail (and reports results in line with the theory; see Figure 7). It is an interesting further prediction of the efficient encoding framework that <italic>sensitivity</italic> should be highest when the Fisher information is highest. This translates to decreased variability of estimation response errors when the current trial has a similar orientation to the previous one. In order to test this prediction, we computed the standard deviation of the response error distribution as a function of the orientation difference between current and n-back trials. We observed that current response variability was markedly decreased when current and 1-back stimuli had similar orientations, and this pattern was well captured by a second-derivative-of-a-gaussian curve (see Figure 7—figure supplement 4). While a similar pattern was observable for the 2-back trial in Experiment 1 and 2, we did not observe a consistent influence of temporally more distant trials across all three experiments. Notably, the estimates of response variability conditioned on temporally distant trials were relatively noisy and could greatly fluctuate from one n-back trial to the next. This might have obscured potentially smaller reductions in response variability conditioned on temporally more distant trials. We thus indeed verify the prediction of the efficient encoding model that responses are more accurate (i.e., less variable, in addition to being less biased) with increasing similarity between successive trials. However, we do not find evidence for a slow exponential decay in variability reduction, as we found in bias. Taken together, we believe that these new results on response error variability neither contradict, nor provide additional support for, the involvement of the efficient coding scheme based on Fisher information. More specific experiments will be necessary to investigate whether long-term repulsion biases are accompanied by reductions in discrimination thresholds. We now report the analysis of response variability in the manuscript (Results section and Materials and methods; Figure 7—figure supplement 4) and discuss this somewhat undecisive additional evidence for the current efficient coding scheme in the limitations section of the Discussion. Furthermore, we now also discuss other forms of adaptation that could underlie the long-term repulsion biases in the Discussion section:</p><p>“Notably, the effects of adaptation on neural tuning are diverse, and may depend on many stimulus parameters such as stimulus size and duration in non-trivial ways (Patterson et al., 2014, 2013). […] Future studies will need to investigate how population-level changes in neural responses may support these different functional explanations of adaptation, respectively.”</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>The authors examined historical effect in perception using data from one new experiment and three previously published datasets. They found both attractive serial dependence (Fischer and Whitney, 2014) and repulsive effect in the same experiments, and crucially the two effects have different time scales. To explain these findings, they modified an efficient coding-bayesian decoding framework (Wei and Stocker, 2015; 2017) and found that a modified model could fit the data well. The new ingredient of the current model is that the predictive prior used in Bayesian inference and efficient coding do not match each other. I think this work contains some interesting results, and could potentially help unify an array of previously disconnected findings. Having said that, I do find that various interpretations of the results to be problematic, and the presentation of the models to be very confusing.</p><p>1) Potential confounding factor, i.e., the motor biases, in the reproduction task.</p><p>I think it is important to rule this out, in particular for the attractive biases under short time scale. The results in Experiment 4 addresses the perceptual aspect of the long-term repulsive bias to some extent.</p></disp-quote><p>We agree with the reviewer that it is important to rule out potential confounding factors, such as motor biases. However, we regard the involvement of systematic motor biases in the reproduction task as highly unlikely. First, in each trial of the estimation tasks (Experiments 1-3), the initial orientation of the response bar was randomly selected from the range of all possible orientations (0,180], and thus the motor actions required for adjusting the response bar to a particular orientation were independent across trials. Second, several previous studies have shown that an explicit reproduction response is not necessary to elicit an attraction bias on the next trial (Czoschke et al., 2019; Fischer and Whitney, 2014; Suárez-Pinilla et al., 2018), that perceptual decisions are attracted towards the presented stimulus orientation rather than a mirrored response orientation (Cicchini et al., 2017), and that attraction biases occur even when performing a different task (and response) on the previous stimulus (Fritsche and de Lange, 2019). Together, these studies strongly suggest that short-term attractive serial dependencies are not due to low-level motor biases. Furthermore, it seems unlikely that low-level motor biases would lead to larger attraction biases with increasing working memory delay (Experiment 3) and that they would induce <italic>spatially specific</italic> long-term repulsion biases (Experiments 2 and 4). As the reviewer already suggests, Experiment 4 provides similar evidence against an involvement of motor biases in the long-term repulsion effect. In this experiment, participants alternate between a reproduction task and 2-AFC task, which require very different motor responses. Furthermore, stimuli in Experiment 4 are counterbalanced such that simple motor biases in the 2-AFC task (e.g. a response to a previous leftward tilted stimulus in the reproduction task induces a bias to press the left response button in the 2-AFC task) would not induce systematic biases in our analysis of the perceptual comparison (2-AFC) data. We now explicitly discuss the evidence against a contribution of motor biases to the short-term attractive and long-term repulsive serial dependencies in the manuscript (subsection “Repulsive and attractive biases can be explained by efficient encoding and Bayesian decoding of visual information”, eighth paragraph).</p><disp-quote content-type="editor-comment"><p>However, I am puzzled why attractive biases were not observed/reported in this 2-AFC paradigm. If the serial dependence is a perceptual effect, shouldn't we expect attractive biases at short-term scale? I had a difficult time reconciling the results in the two paradigms.</p></disp-quote><p>The data of Experiment 4 (2-AFC paradigm) were previously published in Fritsche et al., 2017, in which we investigated the perceptual nature of the short-term attractive serial dependence bias. In this study, we argued that the absence of the attractive bias in perceptual comparison judgments (2-AFC) suggests that the attractive bias is not a perceptual, but a post-perceptual decisional bias (in line with the reviewer’s argument above; but importantly not a motor bias, as argued above). The evidence for a post-perceptual bias was further corroborated by the increase of bias with increasing working memory delay (Experiment 3), pointing towards working memory as the locus of the attraction effect. Importantly, our explanation of attractive serial dependence arising from high-level Bayesian decoding is consistent with a view in which the attractive bias arises during decoding of working memory information. In particular, Bayesian decoding posits that the attraction bias is dependent on the relative widths of sensory likelihood and prior. When sensory likelihoods are narrow, briefly after the initial encoding of the sensory stimulus, the prior has little influence on the resulting posterior, leading only to small attraction biases. As the sensory representation degrades during working memory retention, and the likelihood becomes increasingly broader, the influence of the prior increases. As a result, the posterior will be increasingly pulled towards the prior, leading to an increase in attraction during working memory retention. Importantly, in Experiment 4, observers could compare the 2-AFC stimuli while they were simultaneously presented on the screen, minimizing or even eliminating the influence of working memory noise, and presumably leading to relatively narrow sensory likelihoods at the time of the perceptual decision. As outlined above, we would predict a strong reduction or even absence of attraction biases in this scenario, consistent with the absence of attraction biases in Experiment 4. We now clarified this point in the Discussion section (subsection “Repulsive and attractive biases can be explained by efficient encoding and Bayesian decoding of visual information”, fifth paragraph).</p><disp-quote content-type="editor-comment"><p>2) The calculation of the historical effect:</p><p>Should the attractive/repulsive bias be considered with respect to the orientation of the stimulus or the reported orientation? It would be useful to run the analysis using the reported orientation. Barbosa and Compte (2020, bioRxiv) reports the serial dependence is stronger with using reported stimuli. It would be useful to check whether that's also the case in the authors' data.</p></disp-quote><p>We thank the reviewer for this suggestion. However, directly conditioning empirical responses on the previous response orientation, rather than the previous stimulus orientation, is problematic, as it can introduce a confound due to history-independent biases, such as the oblique bias (Tomassini et al., 2010). As a consequence, spurious serial-dependence-like bias patterns emerge, even when conditioning on <italic>future</italic> responses, which could not have influenced the current response (see Pascucci et al., 2019, Figure 2F for a demonstration).</p><p>Since the response-conditioned serial dependence curve is a superposition of genuine serial dependencies plus a spurious confound, the curve is of higher amplitude than the stimulus-conditioned bias curve, leading to stronger serial dependence estimates. This confound is also present in the preprint by Barbosa and Compte – conditioning on future responses leads to a strong artifactual attraction bias (personal communication with Joao Barbosa). This confound makes it problematic to directly compare response- to stimulus-conditioned serial dependence curves.</p><p>Furthermore, as we demonstrate in the current study, any previous response itself is affected by stimuli experienced over minutes into the past. Therefore, these responses will themselves carry information about the history, and will be statistically co-dependent with previous responses. When conditioning response errors on previous responses, this co-dependence between responses may obfuscate the individual contribution of each trial to the current response – a problem which is not present when conditioning on statistically independent stimulus orientations.</p><p>Since conditioning on previous responses is problematic, we decided to report stimulus-conditioned response errors, which do not suffer from the above confounds. However, we do believe that current stimulus estimates are biased towards previous stimulus estimates, and not the physical orientations of previous stimuli. This is incorporated in our Bayesian ideal observer model in which sensory representations are integrated with the posteriors of previous trials (see below).</p><disp-quote content-type="editor-comment"><p>If the historical effect need depends on the reported orientation, there seems to be a following-up concern. This one is perhaps naive but could be potentially important if it's true: could attraction biases (toward reported stimulus value) at the short-time scale automatically lead to repulsion at longer time-scale? It would be useful to simulate a ground-truth model with just attraction toward the reported (but no generic repulsion) to see if using the authors' analysis procedure would lead to repulsive effect in longer time scale.</p></disp-quote><p>In our Bayesian decoding model, the prior on the current trial is composed of a mixture of previous trials’ posteriors, from which previous perceptual decisions were derived. Therefore, our model implements an observer in which the current perceptual decision is pulled towards previous perceptual decisions, in line with the model that the reviewer describes above. We find that such a model cannot explain long-term repulsion effects (Figure 7—figure supplement 2, Bayesian decoding only). We now clarified that in the Bayesian decoding model, the likelihood is pulled towards previous posteriors, from which previous perceptual decisions were derived, rather than previous likelihoods, reflecting previous physical stimulus orientations (subsection “Models”).</p><disp-quote content-type="editor-comment"><p>3) The spatial dependence of repulsion and attraction:</p><p>The authors claim the attractive biases are not spatially specific (Figure 3), while the repulsive biases are spatially specific. The spatial specificity of the repulsive bias is interpreted as to be consistent with the adaptation effect as measured previously. I found this to be problematic. The two stimulus locations are separated by 13° eccentricity, yet there is still a clear repulsive effect for the &quot;different location&quot; condition. I'd think classical orientation adaptation would lead to almost zero after-effect when the stimulus was to presented to that far away from the adaptor.</p></disp-quote><p>There is indeed a small, but statistically significant repulsion bias when test stimuli are presented 10 visual degrees away from the previous stimulus (Experiment 2). Similarly, in Experiment 4, we find a small, but significant repulsion bias when the current inducer stimulus is presented 10 visual degrees away from the subsequent test stimulus. Both findings are consistent with previous studies, which show that weak adaptation effects can occur at spatial locations further away from the adaptor stimulus (e.g. see Knapen et al., 2010, Figure 3A, also using a spatial separation of 10 visual degrees; see also Mathôt and Theeuwes, 2013, Figure 2 “control condition”). We therefore do not regard the smaller adaptation biases in the “different location” conditions in disagreement with previous studies on classical adaptation. We now discuss this in the revised manuscript (subsection “Experiment 2: Long-term repulsive biases are spatially specific”). Crucially, we find a clear difference in repulsion bias between the “same location” and “different location” conditions, both in Experiment 2 and 4. So, even though the repulsion bias is non-zero between different spatial locations, it still clearly is spatially specific. Importantly, we found no difference between “same location” and “different location” for the 1-back attraction effect (Experiment 2), which indicates a spatially unspecific phenomenon.</p><disp-quote content-type="editor-comment"><p>4) The role of the noise patch in the experiments is obscure.</p><p>If removing the noise patch and using a blank screen instead, would one still observe similar effect? The computational models do not model the noise patch, so I'd think it is fair to say that the model should predict that removing the noise patch would not change any of these biases.</p><p>Alternatively, perhaps the noise patch does play a rule. In Experiment 4, noise patch was not used, and interestingly the attractive bias was not observed. So could the noise patch be the main reason why different effects were observed for the two paradigms (this also relates back to my first concern)?</p></disp-quote><p>We would like to note that all experiments involved the presentation of noise patches. Due to limited space, we omitted the depiction of noise patches from Figure 5A (Experiment 4). We apologize for the confusion. We now adapted Figure 5A to show that Gabor stimuli were followed by noise patches. As discussed above, we believe the most likely explanation for the differences between Experiment 4 and Experiments 1-3 is that observers had access to both to-be-compared stimuli simultaneously in Experiment 4, thereby eliminating (or strongly reducing) the role of working memory.</p><disp-quote content-type="editor-comment"><p>5) The explanation/presentation of the model is highly confusing.</p><p>The labeling of efficient coding model and Bayesian decoding model is particularly mis-leading. Each of the models consider in this paper has an efficient encoding component and a Bayesian decoding component. So I found it is strange to label one as encoding model and another as decoding model.</p></disp-quote><p>We apologize for the confusion in presentation. The reviewer is correct in noting that all models considered in the current study consist of an encoding and decoding stage, and we regret not being clearer with our terminology. The differences between the models arise from the different influences of the sensory history on encoding and decoding, respectively.</p><p>In the model formerly labelled as the “Bayesian decoding model”, history-dependent prior information is integrated with current sensory information at the decoding stage, while the model encodes physical stimulus orientations as a symmetric, Gaussian likelihood functions centered on the true stimulus orientations. Consequently, the encoding of the current stimulus is independent of the sensory history and thus is not efficient. Therefore, while the model has an encoding stage, it does not have an <italic>efficient</italic> encoding stage. We now labelled this model “Bayesian decoding model with history-independent encoding”.</p><p>In model formerly labelled as the “Efficient encoding model”, encoding is dependent on the sensory history, whereas decoding is history-independent. In this model, the stimulus estimate is based on the sensory measurement alone, which is analogous to multiplying the likelihood with a uniform, i.e. history-independent prior. We now labelled this model “Efficient encoding model with history-independent decoding”.</p><p>In the models formerly labelled as “Encoding-decoding models”, the sensory history influences both encoding and decoding, and thus they constitute models with both <italic>efficient</italic> encoding and <italic>history-dependent Bayesian</italic> decoding. We now labelled these models “Efficient-encoding-Bayesian-decoding models”.</p><p>Additionally, we have now clarified the influence of the sensory history on encoding and decoding stages of the respective models throughout the Results section. In particular, we clarified that in the Efficient encoding model with history-independent decoding there is no influence of the sensory history on the decoding stage (subsection “Repulsive and attractive biases can be explained by efficient encoding and optimal decoding of visual information”, fourth paragraph), whereas in the Bayesian decoding model with history-independent encoding there is no influence of the sensory history on the encoding stage (fifth paragraph of the aforementioned subsection). Furthermore, we now refer to observers in which sensory history influenced only Bayesian decoding or only efficient encoding, rather than models with only Bayesian decoding or only efficient encoding, to avoid confusion about the presence of encoding and decoding stages in the model.</p><disp-quote content-type="editor-comment"><p>Relatedly, in the sixth paragraph of the subsection “Repulsive and attractive biases can be explained by efficient encoding and optimal decoding of visual information”, the model the authors referring to is a model consisting efficient coding and Bayesian decoding with mismatched prior. It is the mis-match between the encoding and decoding that leads to the explanation power.</p></disp-quote><p>The reviewer is correct. We explicitly describe this in the Results section:</p><p>“Importantly, we allowed predictions used for optimizing encoding and decoding to be based on potentially distinct transition distributions and integration time constants. This was motivated by the possibility that encoding transition models in low-level sensory circuits could be relatively inflexible and learned over the organism’s lifetime, whereas higher-level transition models used for decoding are likely context- and task-dependent (Fischer et al., 2019) and learned quickly, within minutes to hours (Braun et al., 2018).”</p><p>And compare this model to a model with a single prior for efficient encoding and Bayesian decoding:</p><p><italic>“</italic>Furthermore, the observer captured estimation biases far better than an observer in which efficient encoding and Bayesian decoding were based on the same predictions, using the identical transition distribution and integration time constant (see “Efficient-encoding-Bayesian-decoding model (single prior)” in Materials and methods; cross-validated prediction accuracy, Experiment 1: <italic>r</italic> = 0.58 vs. 0.29; Experiment 2: <italic>r</italic> = 0.53 vs. 0.20; Experiment 3: <italic>r</italic> = 0.66 vs. 0.42).”</p><p>We also present and discuss the differences between encoding and decoding transition models and time constants in the Results section (subsection “Repulsive and attractive biases can be explained by efficient encoding and optimal decoding of visual information”, sixth paragraph) and the Discussion (subsection “Repulsive and attractive biases can be explained by efficient encoding and Bayesian decoding of visual information”, third paragraph).</p><disp-quote content-type="editor-comment"><p>Again it is misleading to talk about model with &quot;only Bayesian decoding&quot; or with &quot;only efficient coding&quot;. I feel that it is not what actually happens in the models, unless I am profoundly confused with what the authors actually did.</p></disp-quote><p>We now improved the description of the models. In particular, we now refer to observers in which sensory history influenced only Bayesian decoding or only efficient encoding (subsection “Repulsive and attractive biases can be explained by efficient encoding and optimal decoding of visual information”), rather than models with only Bayesian decoding or only efficient encoding, to avoid confusion about the presence of encoding and decoding stages in the model. (Both stages are always present, and the investigated models vary with the specific <italic>forms</italic> of encoding and decoding they employ.)</p><disp-quote content-type="editor-comment"><p>These are some of the instances in the paper which could lead to profound confusions. I'd suggest the authors to systematically re-write the last section of the Results and the related section in Discussion to make it clear.</p></disp-quote><p>We now adapted the manuscript to avoid confusions regarding the ideal observer model (see responses above).</p><disp-quote content-type="editor-comment"><p>6) The dependence of historical biases on time scales within a single experiment has been reported previously. For example, Dekel and Sagi, 2015, reported a sign reversal of the biases when examining different time-scales in adaptation experiments using natural stimuli (their Figure 4). Interestingly, they found the opposite pattern, i.e. repulsion at short-time scale, attraction at longer-time scale. There might be other related studies I missed. I feel that the authors should discuss the relevant findings more thoroughly.</p></disp-quote><p>We thank the reviewer for bringing this study to our attention. Upon closer inspection of the study by Dekel and Sagi, 2015, it seems that their finding of 2- to 3-back attraction can be explained by positive response correlations between target trials (Sections 3.4 and 4.4 in Dekel and Sagi, 2015). This might explain why Dekel and Sagi observe a switch from 1-back repulsion to 2- and 3-back attraction, whereas in our perceptual comparison experiment (Experiment 4), there are repulsive biases throughout the sensory history. Please note that our Experiment 4 is not susceptible to similar response correlations, since repeating motor responses does not lead to a systematic bias in our analysis (as there is a more complex relationship between inducer stimulus orientations and answering which of the two comparison stimuli is oriented more clockwise). Conversely, Dekel and Sagi might not observe short-term attraction biases, since they use a 2-AFC paradigm, which minimizes the involvement of working memory, playing an important role in attractive serial dependencies (see Experiment 3; Bliss et al., 2017; also compare to Experiment 4 which uses a 2-AFC paradigm and does not show attractive biases). We now discuss the study by Dekel and Sagi in the Discussion section (subsection “Distinct timescales of attractive and repulsive serial dependencies”).</p><disp-quote content-type="editor-comment"><p>Reference:</p><p>Barbosa, João, and Albert Compte. &quot;Build-up of serial dependence in color working memory.&quot; bioRxiv (2019): 503185.</p></disp-quote></body></sub-article></article>