<article xmlns:ns0="http://www.w3.org/1999/xlink" xmlns:ns1="http://www.w3.org/1998/Math/MathML" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-19-14871</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0221068</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>HIV epidemiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>TreeCluster: Clustering biological sequences using phylogenetic trees</article-title>
<alt-title alt-title-type="running-head">TreeCluster: Clustering biological sequences using phylogenetic trees</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" ns0:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6947-5915</contrib-id>
<name name-style="western">
<surname>Balaban</surname> <given-names>Metin</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; original draft</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" ns0:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2209-8128</contrib-id>
<name name-style="western">
<surname>Moshiri</surname> <given-names>Niema</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; original draft</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" ns0:type="simple">
<name name-style="western">
<surname>Mai</surname> <given-names>Uyen</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" ns0:type="simple">
<name name-style="western">
<surname>Jia</surname> <given-names>Xingfan</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" ns0:type="simple">
<name name-style="western">
<surname>Mirarab</surname> <given-names>Siavash</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; original draft</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Bioinformatics and Systems Biology Graduate Program, UC San Diego, La Jolla, CA 92093, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Computer Science and Engineering, UC San Diego, La Jolla, CA 92093, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Mathematics, UC San Diego, La Jolla, CA 92093, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Electrical and Computer Engineering, UC San Diego, La Jolla, CA 92093, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" ns0:type="simple">
<name name-style="western">
<surname>Bozdag</surname> <given-names>Serdar</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1" />
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Marquette University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email ns0:type="simple">smirarab@ucsd.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>22</day>
<month>8</month>
<year>2019</year>
</pub-date>
<volume>14</volume>
<issue>8</issue>
<elocation-id>e0221068</elocation-id>
<history>
<date date-type="received">
<day>26</day>
<month>5</month>
<year>2019</year>
</date>
<date date-type="accepted">
<day>26</day>
<month>7</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Balaban et al</copyright-holder>
<license ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" ns0:href="info:doi/10.1371/journal.pone.0221068" />
<abstract>
<p>Clustering homologous sequences based on their similarity is a problem that appears in many bioinformatics applications. The fact that sequences cluster is ultimately the result of their phylogenetic relationships. Despite this observation and the natural ways in which a tree can define clusters, most applications of sequence clustering do not use a phylogenetic tree and instead operate on pairwise sequence distances. Due to advances in large-scale phylogenetic inference, we argue that tree-based clustering is under-utilized. We define a family of optimization problems that, given an arbitrary tree, return the minimum number of clusters such that all clusters adhere to constraints on their heterogeneity. We study three specific constraints, limiting (1) the diameter of each cluster, (2) the sum of its branch lengths, or (3) chains of pairwise distances. These three problems can be solved in time that increases linearly with the size of the tree, and for two of the three criteria, the algorithms have been known in the theoretical computer scientist literature. We implement these algorithms in a tool called TreeCluster, which we test on three applications: OTU clustering for microbiome data, HIV transmission clustering, and divide-and-conquer multiple sequence alignment. We show that, by using tree-based distances, TreeCluster generates more internally consistent clusters than alternatives and improves the effectiveness of downstream applications. TreeCluster is available at <ext-link ext-link-type="uri" ns0:href="https://github.com/niemasd/TreeCluster" ns0:type="simple">https://github.com/niemasd/TreeCluster</ext-link>.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by the National Institutes of Health (NIH) subaward 5P30AI027767-28 to M.B., U.M, N.M, and S.M. and NSF grant NSF-1815485 and NSF-1845967 to M.B., U.M., and S.M. Computations were performed on the San Diego Supercomputer Center (SDSC) through XSEDE allocations, which is supported by the NSF grant ACI-1053575. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6" />
<table-count count="1" />
<page-count count="20" />
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The datasets and scripts used are all available at: <ext-link ext-link-type="uri" ns0:href="http://doi.org/10.5281/zenodo.3358386" ns0:type="simple">http://doi.org/10.5281/zenodo.3358386</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Homologous molecular sequences across different species or even within the same genome can show remarkable similarity due to their shared evolutionary history. These similarities have motivated many applications to first group the elements of a diverse set of sequences into <italic>clusters</italic> of set of sequences with high similarity for use in subsequent steps. The precise meaning of clusters depends on the application. For example, when analyzing 16S microbiome data, the standard pipeline is to use Operational Taxonomic Units (OTUs), which are essentially clusters of closely related sequences that do not diverge more than a certain threshold [<xref ref-type="bibr" rid="pone.0221068.ref001">1</xref>&#8211;<xref ref-type="bibr" rid="pone.0221068.ref003">3</xref>]. Another example is HIV transmission inference, a field in which a dominant approach is to cluster HIV sequences from different individuals based on their similarity (again using a threshold) and to use these clusters as proxies to define clusters of disease transmission [<xref ref-type="bibr" rid="pone.0221068.ref004">4</xref>, <xref ref-type="bibr" rid="pone.0221068.ref005">5</xref>].</p>
<p>Shared evolutionary histories, which is the origin of similarity among homologous sequences, can be shown using phylogenetic trees. The phylogenetic tree can be inferred from sequence data, [<xref ref-type="bibr" rid="pone.0221068.ref006">6</xref>, <xref ref-type="bibr" rid="pone.0221068.ref007">7</xref>] and recently developed methods can infer approximate maximum-likelihood (ML) phylogenetic trees in sub-quadratic time, enabling them to scale to datasets of even millions of sequences [<xref ref-type="bibr" rid="pone.0221068.ref008">8</xref>]. Moreover, accurate alignment of datasets with hundreds of thousands of species (a prerequisite to most phylogenetic reconstruction methods) is now possible using divide-and-conquer methods [<xref ref-type="bibr" rid="pone.0221068.ref009">9</xref>, <xref ref-type="bibr" rid="pone.0221068.ref010">10</xref>].</p>
<p>Most existing sequence clustering methods use the pairwise distances among sequences as input but do not take advantage of phylogenetic trees. For example, the widely-used UCLUST [<xref ref-type="bibr" rid="pone.0221068.ref002">2</xref>] searches for a clustering that minimizes the Hamming distance of sequences to the cluster centroid while maximizing the Hamming distance between centroids. Several other clustering methods have been developed for various contexts, such as gene family circumscription [<xref ref-type="bibr" rid="pone.0221068.ref011">11</xref>, <xref ref-type="bibr" rid="pone.0221068.ref012">12</xref>] and large protein sequence databases [<xref ref-type="bibr" rid="pone.0221068.ref013">13</xref>].</p>
<p>Using phylogenies for clustering has two potential advantages. <italic>i</italic>) Since phylogenies explicitly seek to infer the evolutionary history, phylogeny-based clustering has the potential to not only reflect evolutionary distances (i.e., branch lengths) but also relationships (i.e., the tree topology). Recall also that branch lengths in a phylogeny are model-based &#8220;corrections&#8221; of sequence distances in a statistically-rigorous way [<xref ref-type="bibr" rid="pone.0221068.ref007">7</xref>, <xref ref-type="bibr" rid="pone.0221068.ref014">14</xref>], and therefore, may better reflect divergence between organisms. <italic>ii</italic>) When inferred using subquadratic algorithms, the tree can eliminate the need to compute all pairwise distances, which can improve speed and scalability. Moreover, a phylogeny often has to be inferred for purposes other than clustering and thus typically is readily available. However, despite these potentials, to our knowledge, no systematic method for phylogeny-guided clustering exists. Built for analyzing HIV transmissions, ClusterPicker [<xref ref-type="bibr" rid="pone.0221068.ref015">15</xref>] clusters sequences based on their distances while using the phylogenetic tree as a constraint; however, it still uses sequence (not tree) distances and scales cubically with respect to number of sequences in the worst case.</p>
<p>Given a rooted phylogenetic tree, if the tree is ultrametric (that is, distances of all the leaves to the root are identical), clustering sequences based on the tree can proceed in an obvious fashion: the tree can be cut at some distance from the root, thereby partitioning the tree into clusters (<xref ref-type="fig" rid="pone.0221068.g001">Fig 1A</xref>). This approach extends in natural ways to unrooted ultrametric trees by first rooting the tree at the unique midpoint and proceeding as before. However, inferred phylogenetic trees are rarely ultrametric. Different organisms can evolve with different rates of evolution, and even when the rates are identical (leading to an ultrametric true tree), there is no guarantee that the inferred trees will be ultrametric. Given a non-ultrametric (and perhaps unrooted) tree, the best way to cluster sequences is not obvious (<xref ref-type="fig" rid="pone.0221068.g001">Fig 1B</xref>).</p>
<fig id="pone.0221068.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0221068.g001</object-id>
<label>Fig 1</label>
<caption>
<title>When the phylogenetic tree is ultrametric, clustering is trivial.</title>
<p>For a threshold <italic>&#945;</italic>, cut the tree at <inline-formula id="pone.0221068.e001"><alternatives><graphic id="pone.0221068.e001g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e001" ns0:type="simple" /><ns1:math display="inline" id="M1"><ns1:mfrac><ns1:mi>&#945;</ns1:mi> <ns1:mn>2</ns1:mn></ns1:mfrac></ns1:math></alternatives></inline-formula> height (A). When the tree is not ultrametric, it is not obvious how to cluster leaves (B). In both cases, a set of cut edges defines a clustering.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.g001" ns0:type="simple" />
</fig>
<p>One way to approach tree-based clustering is to treat it as an optimization problem. We can define problems of the following form: &#8220;find the minimum number of clusters such that some criteria constrain each cluster.&#8221; Interestingly, at least two forms of such optimization problems have been addressed as early as the 1970s by the theoretical computer science community, in the context of proving more challenging theorems. The <italic>tree partitioning</italic> problem is to cut a tree into the minimum number of subtrees such that the maximum path length between two nodes in the same subtree [<xref ref-type="bibr" rid="pone.0221068.ref017">17</xref>] or the sum of all edge weights in each subtree [<xref ref-type="bibr" rid="pone.0221068.ref018">18</xref>] is constrained by a given threshold. Both problems can be solved exactly using straightforward linear-time algorithms; however, to our knowledge, these algorithms are mostly ignored by bioinformaticians.</p>
<p>Here, we argue that a fast and efficient tree-based clustering approach can be beneficial to several questions in bioinformatics. In this paper, we introduce a family of tree partitioning problems and describe linear-time solutions for three instances of the problem (two of which correspond to the aforementioned max and sum problems with known algorithms). We then show that tree-based clustering can result in improved downstream biological analyses in three different contexts: defining microbial OTUs, HIV transmission clustering, and divide-and-conquer multiple sequence alignment.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Algorithms</title>
<sec id="sec004">
<title>Problem definition</title>
<p>Let <italic>T</italic> = (<italic>V</italic>, <italic>E</italic>) be an unrooted binary tree represented by an undirected acyclic graph with vertices <italic>V</italic> (each with degree one or three), weighted edges <italic>E</italic>, and leafset <inline-formula id="pone.0221068.e002"><alternatives><graphic id="pone.0221068.e002g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e002" ns0:type="simple" /><ns1:math display="inline" id="M2"><ns1:mrow><ns1:mi mathvariant="script">L</ns1:mi> <ns1:mo>&#8834;</ns1:mo> <ns1:mi>V</ns1:mi></ns1:mrow></ns1:math></alternatives></inline-formula>. We denote the path length between leaves <italic>u</italic> and <italic>v</italic> on <italic>T</italic> with <italic>d</italic><sub><italic>T</italic></sub> (<italic>u</italic>, <italic>v</italic>) or simply <italic>d</italic>(<italic>u</italic>, <italic>v</italic>) when clear by context. The weight of an edge (<italic>u</italic>, <italic>v</italic>) (i.e., its branch length) is denoted by <italic>w</italic>(<italic>u</italic>, <italic>v</italic>).</p>
<p>A clustering of the leaves of the tree <italic>T</italic> can be defined by cutting a subset of edges <italic>C</italic> &#8838; <italic>E</italic>. We define a partition {<italic>L</italic><sub>1</sub>, <italic>L</italic><sub>2</sub>&#8943;, <italic>L</italic><sub><italic>N</italic></sub>} of <inline-formula id="pone.0221068.e003"><alternatives><graphic id="pone.0221068.e003g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e003" ns0:type="simple" /><ns1:math display="inline" id="M3"><ns1:mi mathvariant="script">L</ns1:mi></ns1:math></alternatives></inline-formula> to be an <italic>admissible</italic> clustering if it can be obtained by removing some edge set <italic>C</italic> from <italic>E</italic> and assigning leaves of each of the resulting connected components to a set <italic>L</italic><sub><italic>i</italic></sub> (note: <italic>N</italic> &#8804; |<italic>C</italic>| + 1).</p>
<p>For a given tree <italic>T</italic>, let <inline-formula id="pone.0221068.e004"><alternatives><graphic id="pone.0221068.e004g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e004" ns0:type="simple" /><ns1:math display="inline" id="M4"><ns1:mrow><ns1:msub><ns1:mi>f</ns1:mi> <ns1:mi>T</ns1:mi></ns1:msub> <ns1:mo>:</ns1:mo> <ns1:msup><ns1:mn>2</ns1:mn> <ns1:mi mathvariant="script">L</ns1:mi></ns1:msup> <ns1:mo>&#8594;</ns1:mo> <ns1:mi mathvariant="double-struck">R</ns1:mi></ns1:mrow></ns1:math></alternatives></inline-formula> be a function that maps a subset of the leafset <inline-formula id="pone.0221068.e005"><alternatives><graphic id="pone.0221068.e005g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e005" ns0:type="simple" /><ns1:math display="inline" id="M5"><ns1:mi mathvariant="script">L</ns1:mi></ns1:math></alternatives></inline-formula> to a real number. The purpose of <italic>f</italic><sub><italic>T</italic></sub> is to characterize the diversity of elements at the leaves within each cluster, and it is often defined as a function of the edge weights in the cluster. For example, it can be the diameter of a subset: <italic>f</italic><sub><italic>T</italic></sub> = max<sub><italic>u</italic>,<italic>v</italic>&#8712;<italic>L</italic></sub> <italic>d</italic><sub><italic>T</italic></sub>(<italic>u</italic>, <italic>v</italic>). We define a family of problems that seek to minimize the number of clusters while each cluster has to adhere to constraints defined using <italic>f</italic><sub><italic>T</italic></sub>. More formally:</p>
<p><bold>Definition 1</bold> (Min-cut partitioning problem family). <italic>Given a tree T with leafset</italic> <inline-formula id="pone.0221068.e006"><alternatives><graphic id="pone.0221068.e006g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e006" ns0:type="simple" /><ns1:math display="inline" id="M6"><ns1:mi mathvariant="script">L</ns1:mi></ns1:math></alternatives></inline-formula> <italic>and a real number &#945;</italic>, <italic>find an admissible partition</italic> {<italic>L</italic><sub>1</sub>&#8230;<italic>L</italic><sub><italic>N</italic></sub>} <italic>of</italic> <inline-formula id="pone.0221068.e007"><alternatives><graphic id="pone.0221068.e007g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e007" ns0:type="simple" /><ns1:math display="inline" id="M7"><ns1:mi mathvariant="script">L</ns1:mi></ns1:math></alternatives></inline-formula> <italic>that satisfies</italic> &#8704;<italic>i</italic>, <italic>f</italic><sub><italic>T</italic></sub> &#8804; <italic>&#945; and has the minimum cardinality</italic> (<italic>N</italic>) <italic>among all such clusterings</italic>.</p>
<p>A natural way to limit the diversity within a cluster is to constrain all pairwise distances among members of the cluster to be less than a given threshold:</p>
<p><bold>Definition 2</bold> (Max-diameter min-cut partitioning problem). <italic>The Min-cut partitioning problem</italic> (<italic>Definition 1</italic>) <italic>is called Max-diameter min-cut partitioning problem when</italic> <inline-formula id="pone.0221068.e008"><alternatives><graphic id="pone.0221068.e008g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e008" ns0:type="simple" /><ns1:math display="inline" id="M8"><ns1:mrow><ns1:msub><ns1:mi>f</ns1:mi> <ns1:mi>T</ns1:mi></ns1:msub> <ns1:mo>=</ns1:mo> <ns1:munder><ns1:mtext>max</ns1:mtext> <ns1:mrow><ns1:mi>u</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>v</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:mi>L</ns1:mi></ns1:mrow></ns1:munder> <ns1:mspace width="0.277778em" /><ns1:mi>d</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>u</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>v</ns1:mi> <ns1:mo>)</ns1:mo></ns1:mrow></ns1:mrow></ns1:math></alternatives></inline-formula>.</p>
<p>One potential disadvantage of max diameter min-cut partitioning is its susceptibility to outliers: the largest distance within a cluster may not be always an accurate representation of the degree of diversity in the cluster. A natural choice that may confine the effect of outliers is the following:</p>
<p><bold>Definition 3</bold> (Sum-length min-cut partitioning problem). <italic>The Min-cut partitioning problem is called Sum-length min-cut partitioning problem when</italic> <inline-formula id="pone.0221068.e009"><alternatives><graphic id="pone.0221068.e009g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e009" ns0:type="simple" /><ns1:math display="inline" id="M9"><ns1:mrow><ns1:msub><ns1:mi>f</ns1:mi> <ns1:mi>T</ns1:mi></ns1:msub> <ns1:mo>=</ns1:mo> <ns1:mstyle displaystyle="true"><ns1:munder><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>u</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>v</ns1:mi> <ns1:mo>)</ns1:mo> <ns1:mo>&#8712;</ns1:mo> <ns1:mi>e</ns1:mi> <ns1:mi>d</ns1:mi> <ns1:mi>g</ns1:mi> <ns1:mi>e</ns1:mi> <ns1:mi>s</ns1:mi> <ns1:mo>(</ns1:mo> <ns1:mi>T</ns1:mi> <ns1:mo>|</ns1:mo> <ns1:mi>L</ns1:mi> <ns1:mo>)</ns1:mo></ns1:mrow></ns1:munder></ns1:mstyle> <ns1:mi>w</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>u</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>v</ns1:mi> <ns1:mo>)</ns1:mo></ns1:mrow></ns1:mrow></ns1:math></alternatives></inline-formula> <italic>where T</italic>|<italic>L is the tree T restricted to a subset of leaves L</italic>.</p>
<p>We also study a third problem, which we will motivate later:</p>
<p><bold>Definition 4</bold> (Single-linkage min-cut partitioning problem). <italic>The Min-cut partitioning problem is called Single-linkage min-cut partitioning problem when</italic> <inline-formula id="pone.0221068.e010"><alternatives><graphic id="pone.0221068.e010g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e010" ns0:type="simple" /><ns1:math display="inline" id="M10"><ns1:mrow><ns1:msub><ns1:mi>f</ns1:mi> <ns1:mi>T</ns1:mi></ns1:msub> <ns1:mo>=</ns1:mo> <ns1:munder><ns1:mtext>max</ns1:mtext> <ns1:mrow><ns1:mi>S</ns1:mi> <ns1:mo>&#8834;</ns1:mo> <ns1:mi>L</ns1:mi></ns1:mrow></ns1:munder> <ns1:mrow><ns1:mo>{</ns1:mo> <ns1:munder><ns1:mtext>min</ns1:mtext> <ns1:mrow><ns1:mi>u</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:mi>S</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>v</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:mi>L</ns1:mi> <ns1:mo>-</ns1:mo> <ns1:mi>S</ns1:mi></ns1:mrow></ns1:munder> <ns1:mi>d</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>u</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>v</ns1:mi> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mo>}</ns1:mo></ns1:mrow></ns1:mrow></ns1:math></alternatives></inline-formula>.</p>
<p>Next, we will show linear-time algorithms for the Max-diameter, Sum-length, and Single-linkage min-cut partitioning problems. All three algorithms use variations of the same greedy algorithm and two of them (max and sum) have already been described in the theoretical computer science literature. Nevertheless, we reiterate the solutions using consistent terminology and provide alternative proofs of their correctness.</p>
</sec>
<sec id="sec005">
<title>Linear-time solution for Max-diameter min-cut partitioning</title>
<p>A linear-time solution for the Max-diameter min-cut partitioning problem was first published by Parley <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0221068.ref017">17</xref>] (with all edge weights equal to 1). We present Algorithm 1, which is similar to the Parley <italic>et al</italic>. algorithm (but adds branch lengths), and we give an alternative proof. The algorithm operates on <italic>T</italic><sup><italic>o</italic></sup>, which is an arbitrary rooting of <italic>T</italic> at node <italic>o</italic>. We denote the subtree rooted at an internal node <italic>u</italic> as <italic>U</italic>. Let the two children of <italic>u</italic> be called <italic>u</italic><sub><italic>l</italic></sub> and <italic>u</italic><sub><italic>r</italic></sub>, and let the tree rooted by them be <italic>U</italic><sub><italic>l</italic></sub> and <italic>U</italic><sub><italic>r</italic></sub>. We use <italic>w</italic><sub><italic>l</italic></sub> and <italic>w</italic><sub><italic>r</italic></sub> to denote <italic>w</italic>(<italic>u</italic>, <italic>u</italic><sub><italic>l</italic></sub>) and <italic>w</italic>(<italic>u</italic>, <italic>u</italic><sub><italic>r</italic></sub>), respectively, when clear by context.</p>
<p><bold>Algorithm 1</bold>: Linear-time solution for Max-diameter min-cut partitioning</p>
<p specific-use="line"><bold>Input</bold>: A tree <italic>T</italic><sup><italic>o</italic></sup> = (<italic>V</italic>, <italic>E</italic>) and a threshold <italic>&#945;</italic></p>
<p specific-use="line">1 <italic>B</italic>(<italic>v</italic>) &#8592; 0 <bold>for</bold> <italic>v</italic> &#8712; <italic>V</italic></p>
<p specific-use="line">2 <bold>for</bold> <italic>u</italic> &#8712; post order traversal of internal nodes of <italic>T</italic><sup><italic>o</italic></sup> <bold>do</bold></p>
<p specific-use="line">3 &#8195;<bold>if</bold> <italic>B</italic>(<italic>u</italic><sub><italic>l</italic></sub>) + <italic>w</italic><sub><italic>l</italic></sub> + <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>) + <italic>w</italic><sub><italic>r</italic></sub> &gt; <italic>&#945;</italic> <bold>then</bold></p>
<p specific-use="line">4 &#8195;&#8195;<bold>if</bold> <italic>B</italic>(<italic>u</italic><sub><italic>l</italic></sub>) + <italic>w</italic><sub><italic>l</italic></sub> &#8804; <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>) + <italic>w</italic><sub><italic>r</italic></sub> <bold>then</bold></p>
<p specific-use="line">5 &#8195;&#8195;&#8195;<italic>E</italic> &#8592; <italic>E</italic> &#8722; {(<italic>u</italic>, <italic>u</italic><sub><italic>r</italic></sub>)}</p>
<p specific-use="line">6 &#8195;&#8195;&#8195;<italic>B</italic>(<italic>u</italic>) &#8592; <italic>B</italic>(<italic>u</italic><sub>l</sub>) + <italic>w</italic><sub><italic>l</italic></sub></p>
<p specific-use="line">7 &#8195;&#8195;<bold>else</bold></p>
<p specific-use="line">8 &#8195;&#8195;&#8195;<italic>E</italic> &#8592; <italic>E</italic> &#8722; {(<italic>u</italic>, <italic>u</italic><sub><italic>l</italic></sub>)}</p>
<p specific-use="line">9 &#8195;&#8195;&#8195;<italic>B</italic>(<italic>u</italic>) &#8592; <italic>B</italic>(<italic>u</italic><sub>r</sub>) + <italic>w</italic><sub><italic>r</italic></sub></p>
<p specific-use="line">10 &#8195;<bold>else</bold></p>
<p specific-use="line">11 &#8195;&#8195;<italic>B</italic>(<italic>u</italic>) &#8592; <italic>max</italic>(<italic>B</italic>(<italic>u</italic><sub>l</sub>) + <italic>w</italic><sub><italic>l</italic></sub>, <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>)+ <italic>w</italic><sub><italic>r</italic></sub>)</p>
<p specific-use="line">12 <bold>return</bold> <italic>Leafsets of every connected component in T</italic><sup><italic>o</italic></sup></p>
<p>For a cut set <italic>C</italic> of the tree, we define <italic>B</italic>(<italic>C</italic>, <italic>u</italic>) to be the length of the path from <italic>u</italic> to the most distant <italic>connected</italic> leaf in <italic>U</italic> in the clustering defined by <italic>C</italic>. The algorithm uses a bottom-up traversal of the tree and for each node <italic>u</italic> that we visit, we may decide to cut one of its child edges. Thus, at each stage, a current clustering <italic>C</italic><sub><italic>u</italic></sub> is defined; we use <italic>B</italic>(<italic>u</italic>) a shorthand for <italic>B</italic>(<italic>C</italic><sub><italic>u</italic></sub>, <italic>u</italic>). When we arrive at node <italic>u</italic>, one or more new paths form between the two trees <italic>U</italic><sub><italic>r</italic></sub> and <italic>U</italic><sub><italic>l</italic></sub>. Among those paths, the longest one has the length <italic>B</italic>(<italic>u</italic><sub><italic>l</italic></sub>) + <italic>w</italic><sub><italic>l</italic></sub> + <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>) + <italic>w</italic><sub><italic>r</italic></sub>. If this value exceeds the threshold, we break either (<italic>u</italic>, <italic>u</italic><sub><italic>r</italic></sub>) or (<italic>u</italic>, <italic>u</italic><sub><italic>l</italic></sub>), depending on which minimizes <italic>B</italic>(<italic>u</italic>). Note that the algorithm always cuts at most one child edge of every node, and thus, <italic>B</italic>(<italic>u</italic>) is always well-defined.</p>
<p><bold>Theorem 1</bold>. <italic>Let A</italic>(<italic>u</italic>) <italic>be the minimum number of clusters under U</italic>, <italic>each with a diameter less than &#945;</italic> (<italic>i</italic>.<italic>e</italic>., <italic>A</italic>(<italic>o</italic>) <italic>is the objective function</italic>). <italic>Algorithm 1 computes a clustering with the minimum A</italic>(<italic>o</italic>) <italic>for the rooted tree T</italic><sup><italic>o</italic></sup>. <italic>In addition</italic>, <italic>among all possible such clusterings</italic>, <italic>the algorithm picks</italic> arg min<sub><italic>C</italic></sub> <italic>B</italic>(<italic>C</italic>, <italic>o</italic>).</p>
<p><bold>Corollary 1</bold>. <italic>Let C</italic>&#8242; <italic>be the cut set obtained by running Algorithm 1 on an arbitrary rooting T</italic><sup><italic>o</italic></sup> <italic>of tree T</italic>. <italic>C</italic>&#8242; <italic>optimally solves the Max-diameter min-cut partitioning problem</italic>.</p>
<p>The proof of the theorem and the corollary are both given in <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>.</p>
</sec>
<sec id="sec006">
<title>Linear solution for the Sum-length min-cut partitioning problem</title>
<p>A linear-time algorithm that partitions trees into the fewest clusters, each with total node weights less than or equal to <italic>&#945;</italic>, has been previously published by Kundu <italic>et al</italic>. [<xref ref-type="bibr" rid="pone.0221068.ref018">18</xref>]. In order to solve the Sum-length min-cut partitioning problem, we present an altered version of the original algorithm that works on edge (instead of node) weights and that focuses on binary trees. Algorithm 1 with two simple modifications solves the Sum-length min-cut partitioning problem optimally (see Algorithm A in <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>). The first modification is that we define the auxiliary variable <italic>B</italic>(<italic>C</italic>, <italic>u</italic>) to denote the sum of weights of all descendent edges connected to <italic>u</italic> at the stage it is processed by the algorithm. Secondly, in the bottom-up traversal of internal nodes of <italic>T</italic><sup><italic>o</italic></sup>, for node <italic>u</italic>, w.l.o.g, let <italic>B</italic>(<italic>u</italic><sub><italic>l</italic></sub>) + <italic>w</italic><sub><italic>l</italic></sub> &#8805; <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>) + <italic>w</italic><sub><italic>r</italic></sub>. If the sum of branch lengths in the combined subtree exceeds <italic>&#945;</italic>, we break the edge (<italic>u</italic>, <italic>u</italic><sub><italic>l</italic></sub>). Unlike Algorithm 1, where <italic>B</italic>(<italic>u</italic><sub><italic>l</italic></sub>) + <italic>w</italic><sub><italic>l</italic></sub> + <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>) + <italic>w</italic><sub><italic>r</italic></sub> &#8804; <italic>&#945;</italic>, here, <italic>B</italic>(<italic>u</italic>) is set to <italic>B</italic>(<italic>u</italic><sub><italic>l</italic></sub>) + <italic>w</italic><sub><italic>l</italic></sub> + <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>) + <italic>w</italic><sub><italic>r</italic></sub>. The proof for the correctness of the algorithm is analogous to that of Algorithm 1 and is given in <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>.</p>
</sec>
<sec id="sec007">
<title>Single-linkage min-cut partitioning</title>
<p>We now address the Single-linkage min-cut partitioning problem (Definition 4), which can be considered a relaxation of the Max-diameter min-cut partitioning. To motivate this problem, first consider the following definition.</p>
<p><bold>Definition 5</bold> (Single-linkage clustering). <italic>We call a partition of</italic> <inline-formula id="pone.0221068.e011"><alternatives><graphic id="pone.0221068.e011g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e011" ns0:type="simple" /><ns1:math display="inline" id="M11"><ns1:mi mathvariant="script">L</ns1:mi></ns1:math></alternatives></inline-formula> <italic>to be a Single-linkage clustering when for every</italic> <inline-formula id="pone.0221068.e012"><alternatives><graphic id="pone.0221068.e012g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e012" ns0:type="simple" /><ns1:math display="inline" id="M12"><ns1:mrow><ns1:mi>a</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>b</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:mi mathvariant="script">L</ns1:mi></ns1:mrow></ns1:math></alternatives></inline-formula>, <italic>a and b are in the same cluster if and only if there exists a chain</italic> <inline-formula id="pone.0221068.e013"><alternatives><graphic id="pone.0221068.e013g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e013" ns0:type="simple" /><ns1:math display="inline" id="M13"><ns1:mrow><ns1:mi mathvariant="script">H</ns1:mi> <ns1:mo>=</ns1:mo> <ns1:msub><ns1:mi>c</ns1:mi> <ns1:mn>0</ns1:mn></ns1:msub> <ns1:mo>,</ns1:mo> <ns1:msub><ns1:mi>c</ns1:mi> <ns1:mn>1</ns1:mn></ns1:msub> <ns1:mo>,</ns1:mo> <ns1:mo>&#8230;</ns1:mo> <ns1:mo>,</ns1:mo> <ns1:msub><ns1:mi>c</ns1:mi> <ns1:mi>m</ns1:mi></ns1:msub> <ns1:mo>,</ns1:mo> <ns1:msub><ns1:mi>c</ns1:mi> <ns1:mrow><ns1:mi>m</ns1:mi> <ns1:mo>+</ns1:mo> <ns1:mn>1</ns1:mn></ns1:mrow></ns1:msub></ns1:mrow></ns1:math></alternatives></inline-formula>, <italic>where a</italic> = <italic>c</italic><sub>0</sub> <italic>and b</italic> = <italic>c</italic><sub><italic>m</italic>+1</sub>, <italic>and for every</italic> 0 &#8804; <italic>i</italic> &#8804; <italic>m</italic>, <italic>we have d</italic>(<italic>c</italic><sub><italic>i</italic></sub>, <italic>c</italic><sub><italic>i</italic>+1</sub>) &#8804; <italic>&#945;</italic>.</p>
<p>Thus, every pair of nodes is put in the same cluster if (but not only if) their distance is below the threshold (the rest follows from transitivity). The next result (proved in <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>.) motivates the choice of <italic>f</italic><sub><italic>T</italic></sub> in Definition 4.</p>
<p><bold>Proposition 1</bold>. <italic>The optimal solution to the Single-linkage min-cut partitioning problem</italic> (<italic>Definition 4</italic>) <italic>is identical to the Single-linkage clustering of Definition 5</italic>.</p>
<p>Algorithm 2 shows a linear-time solution to the Single-linkage min-cut partitioning problem. For each node <italic>u</italic>, the algorithm first finds the closest leaf in the left and right sub-trees of <italic>u</italic> via post-order traversal, and it then finds the closest leaf outside the sub-tree rooted at <italic>u</italic> via pre-order traversal. Then, on a post-order traversal, it cuts each child edge iff the minimum distance of leaves under it to leaves under its sibling <italic>and</italic> to any leaf outside the node both exceed the threshold. The following theorem states the correctness of the algorithm (proof is given in <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>).</p>
<p><bold>Algorithm 2</bold>: S<sc>ingle</sc>-L<sc>inkage</sc> Single-linkage min-cut partitioning</p>
<p specific-use="line">1 <italic>minBelow</italic>[<italic>u</italic>] &#8592; <italic>minAbove</italic>[<italic>u</italic>] &#8592; &#8734; <bold>for</bold> <italic>v</italic> &#8592; <italic>V</italic></p>
<p specific-use="line">2 <bold>for</bold> <italic>u</italic>&#8712; <italic>post order traversal of T</italic><sup><italic>o</italic></sup> <bold>do</bold></p>
<p specific-use="line">3 &#8195;<bold>if</bold> <italic>u</italic> <bold><italic>in</italic></bold> <inline-formula id="pone.0221068.e014"><alternatives><graphic id="pone.0221068.e014g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e014" ns0:type="simple" /><ns1:math display="inline" id="M14"><ns1:mi mathvariant="script">L</ns1:mi></ns1:math></alternatives></inline-formula> <bold>then</bold></p>
<p specific-use="line">4 &#8195;&#8195;<italic>minBelow</italic>[<italic>u</italic>] &#8592; 0;</p>
<p specific-use="line">5 &#8195;<bold>else</bold></p>
<p specific-use="line">6 &#8195;&#8195;<italic>minBelow</italic>[<italic>u</italic>] &#8592; <italic>min</italic>(<italic>minBelow</italic>[<italic>u</italic><sub><italic>l</italic></sub>] + <italic>w</italic><sub><italic>l</italic></sub>, <italic>minBelow</italic>[<italic>u</italic><sub><italic>r</italic></sub>] + <italic>w</italic><sub><italic>r</italic></sub>);</p>
<p specific-use="line">7 <bold>for</bold> <italic>u</italic> &#8712; <italic>pre order traversal of T</italic><sup><italic>o</italic></sup> <bold>do</bold></p>
<p specific-use="line">8 &#8195;<bold>if</bold> <italic>u</italic> &#8800; <italic>o</italic> <bold>then</bold></p>
<p specific-use="line">9 &#8195;&#8195;<italic>minAbove</italic>[<italic>u</italic>] &#8592; <italic>min</italic>(<italic>minBelow</italic>[<italic>s</italic>] + <italic>w</italic>(<italic>v</italic>, <italic>s</italic>), <italic>minAbove</italic>[<italic>v</italic>] + <italic>w</italic>(<italic>v</italic>, <italic>v</italic>));</p>
<p specific-use="line">10 <bold>for</bold> <italic>u</italic> &#8712; <italic>post order traversal of internal nodes of T</italic><sup><italic>o</italic></sup> <bold>do</bold></p>
<p specific-use="line">11 &#8195;<bold>if</bold> <italic>minBelow</italic>[<italic>u</italic><sub><italic>l</italic></sub>] + <italic>w</italic><sub><italic>l</italic></sub> + <italic>minBelow</italic>[<italic>u</italic><sub><italic>r</italic></sub>] + <italic>w</italic><sub><italic>r</italic></sub> &gt; <italic>&#945;</italic> <bold><italic>and</italic></bold></p>
<p specific-use="line">&#8195;&#8195;&#8195;<italic>minBelow</italic>[<italic>u</italic><sub><italic>l</italic></sub>] + <italic>w</italic><sub><italic>l</italic></sub> + <italic>minAbove</italic>[<italic>u</italic>]&gt; <italic>&#945;</italic> <bold>then</bold></p>
<p specific-use="line">12 &#8195;&#8195;<italic>E</italic> &#8592; <italic>E</italic>\(<italic>u</italic>, <italic>u</italic><sub><italic>l</italic></sub>)</p>
<p specific-use="line">13 &#8195; <bold>if</bold> <italic>minBelow</italic>[<italic>u</italic><sub><italic>l</italic></sub>] + <italic>w</italic><sub><italic>l</italic></sub> + <italic>minBelow</italic>[<italic>u</italic><sub><italic>r</italic></sub>] + <italic>w</italic><sub><italic>r</italic></sub> &gt; <italic>&#945;</italic> <bold><italic>and</italic></bold></p>
<p specific-use="line">&#8195;&#8195;&#8195;<italic>minBelow</italic>[<italic>u</italic><sub><italic>r</italic></sub>] + <italic>w</italic><sub><italic>r</italic></sub> + <italic>minAbove</italic>[<italic>u</italic>]&gt;<italic>&#945;</italic> <bold>then</bold></p>
<p specific-use="line">14 &#8195;&#8195;<italic>E</italic> &#8592; <italic>E</italic>\(<italic>u</italic>, <italic>u</italic><sub><italic>r</italic></sub>)</p>
<p specific-use="line">15 &#8195;<bold>if</bold> <italic>minBelow</italic>[<italic>u</italic><sub><italic>l</italic></sub>] + <italic>w</italic><sub><italic>l</italic></sub> + <italic>minAbove</italic>[<italic>u</italic>] &gt; <italic>&#945;</italic> <bold><italic>and</italic></bold></p>
<p specific-use="line">&#8195;&#8195;&#8195;<italic>minBelow</italic>[<italic>u</italic><sub><italic>r</italic></sub>] + <italic>w</italic><sub><italic>r</italic></sub> + <italic>minAbove</italic>[<italic>u</italic>] &gt; <italic>&#945;</italic> <bold>then</bold></p>
<p specific-use="line">16 &#8195;&#8195;<italic>E</italic> &#8592; <italic>E</italic>\(<italic>v</italic>, <italic>u</italic>)</p>
<p specific-use="line">17 <bold>return</bold> Leafsets of every connected component in <italic>T</italic><sup><italic>o</italic></sup></p>
<p><bold>Theorem 2</bold>. <italic>The partitioning computed by Algorithm 2 optimally the solves Single-linkage min-cut partitioning problem</italic> (<italic>Definition 5</italic>).</p>
</sec>
<sec id="sec008">
<title>Clade constraint for rooted trees</title>
<p>So far, we have focused on unrooted trees. This choice is partially driven by the fact that phylogenetic reconstruction tools predominantly use time-reversible models of sequence evolution (e.g. GTR [<xref ref-type="bibr" rid="pone.0221068.ref019">19</xref>]) and therefore output an unrooted tree. Nevertheless, researchers have developed various methods for rooting trees [<xref ref-type="bibr" rid="pone.0221068.ref020">20</xref>, <xref ref-type="bibr" rid="pone.0221068.ref021">21</xref>], including accurate and linear-time methods such as MV rooting [<xref ref-type="bibr" rid="pone.0221068.ref016">16</xref>]. When a rooted tree is available, each &#8220;monophyletic clade,&#8221; i.e., group of entities that includes all descendants of their common ancestor, is a biologically meaningful unit. Thus, we may want to constrain each cluster to be a clade. These &#8220;clade&#8221; constraints make clustering easier: our algorithms can be easily altered to ascertain that each cluster is also a clade. Specifically, in Algorithm 1, when we have <italic>B</italic>(<italic>u</italic><sub><italic>l</italic></sub>) + <italic>w</italic><sub><italic>l</italic></sub> + <italic>B</italic>(<italic>u</italic><sub><italic>r</italic></sub>) + <italic>w</italic><sub><italic>r</italic></sub> &gt; <italic>&#945;</italic>, we simply need to cut both (<italic>u</italic>, <italic>u</italic><sub><italic>l</italic></sub>) and (<italic>u</italic>, <italic>u</italic><sub><italic>r</italic></sub>) (instead of cutting only the longer one). This small modification allows the Max-diameter, Sum-length, and Single-linkage min-cut partitioning problems to be solved in linear time while imposing the clade constraint.</p>
</sec>
<sec id="sec009">
<title>Centroid (representative) sequence</title>
<p>Many sequencing clustering methods produce a representative sequence per cluster, often one that is used internally by the algorithm. Our clustering approach is representative-free. However, if a representative is needed for downstream applications, several choices are available. For example, one can in linear-time find the midpoint or balance point of a cluster [<xref ref-type="bibr" rid="pone.0221068.ref016">16</xref>] (i.e., the node that minimizes variance of root to tip distances); then, the leaf closest to the midpoint or balance point can be used as the representative. Another alternative is to use the consensus sequence among all sequences belonging to a cluster (i.e., choosing the most frequent letter for each site). Constructing and using a consensus sequence may be preferable to using one of the given sequences as the centroid [<xref ref-type="bibr" rid="pone.0221068.ref022">22</xref>]. A third alternative that we explore in our results is to use ancestral sequence reconstruction. For each subtree defined by a cluster, we first root it at its balance point. Then, we perform maximum likelihood ancestral state reconstruction (ASR) and use the reconstructed root sequence as the centroid.</p>
</sec>
</sec>
<sec id="sec010">
<title>TreeCluster software</title>
<p>We implemented linear-time algorithms for min-cut partitioning problem subject to Max-diameter, Sum-branch, Single-linkage, and other clustering criteria, with and without clade constraints in a freely-available open source tool called TreeCluster. TreeCluster takes a newick tree and a threshold value as input and returns clusters in a formatted text file. TreeCluster uses treeswift [<xref ref-type="bibr" rid="pone.0221068.ref023">23</xref>] package for fast tree operations.</p>
</sec>
<sec id="sec011">
<title>Three applications of TreeCluster</title>
<p>While sequence clustering has many applications, in this paper, we highlight three specific areas as examples.</p>
<sec id="sec012">
<title>Application 1: OTU clustering</title>
<p><bold>Biological Problem</bold>. For microbiome analyses using 16S sequences generated from whole communities, the standard pipeline uses operational taxonomic units (OTUs). Sequences with similarity at or above a certain threshold (e.g. 97%) are grouped into OTUs, which are the most fine-grained level at which organisms are distinguished. All sequences assigned to the same OTU are treated as one organism in downstream analyses, such as taxonomic profiling, taxonomic identification, sample differentiation, or machine learning. The use of a similarity threshold instead of a biological concept of species is to avoid the notoriously difficult problem of defining species for microbial organisms [<xref ref-type="bibr" rid="pone.0221068.ref024">24</xref>, <xref ref-type="bibr" rid="pone.0221068.ref025">25</xref>]. Futher, the use of clusters of similar sequences as OTUs can provide a level of robustness with respect to sequencing errors.</p>
<p>Most applications of OTUs are closed-reference: a reference database of known organisms is selected, and OTUs are defined for reference sequences using methods such as UCLUST [<xref ref-type="bibr" rid="pone.0221068.ref002">2</xref>] and Dotur [<xref ref-type="bibr" rid="pone.0221068.ref003">3</xref>]. These methods cluster sequences based on a chosen threshold of similarity, often picking a centroid sequence to represent an OTU. Reads from a 16S sample are then compared to the OTUs, and the closest OTU is found for each read (judging distance by sequence similarity). Once all reads are processed for all samples, an OTU table can be built such that rows represent samples, columns represent OTUs, and each cell gives the frequency of an OTU in a sample. This table is then used in downstream analyses. Several large reference databases exist for these OTU-based analyses [<xref ref-type="bibr" rid="pone.0221068.ref026">26</xref>&#8211;<xref ref-type="bibr" rid="pone.0221068.ref028">28</xref>]. One of these databases, popularized through pipelines such as Qiita [<xref ref-type="bibr" rid="pone.0221068.ref029">29</xref>], is Greengenes [<xref ref-type="bibr" rid="pone.0221068.ref028">28</xref>].</p>
<p>Regardless of the downstream application of an OTU table, one would prefer the OTUs to be maximally coherent (i.e., internally consistent) so they represent organisms as faithfully as possible. We will focus our experiments on the closed-reference OTU picking methods and the Greengenes as the reference library. However, note that open-reference OTU picking and sub-operational-taxonomic-unit (sOTU) methods [<xref ref-type="bibr" rid="pone.0221068.ref030">30</xref>&#8211;<xref ref-type="bibr" rid="pone.0221068.ref032">32</xref>] also exist and involve a similar need for sequence clustering.</p>
<p><bold>Existing methods</bold>. Despite the availability of hierarchical clustering tools for OTU clustering [<xref ref-type="bibr" rid="pone.0221068.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0221068.ref033">33</xref>], non-hierarchical clustering methods [<xref ref-type="bibr" rid="pone.0221068.ref002">2</xref>, <xref ref-type="bibr" rid="pone.0221068.ref034">34</xref>] are more widely used, perhaps due to their lower computational demand. Two prominent methods are UCLUST [<xref ref-type="bibr" rid="pone.0221068.ref002">2</xref>] and CD-HIT [<xref ref-type="bibr" rid="pone.0221068.ref034">34</xref>], which share the same algorithmic strategy: for a given threshold <italic>&#945;</italic>, UCLUST determines a set of representative sequences dynamically by assigning query sequences into representative sequences (centroids) such that, ideally, the distance between each query and its assigned centroid is less than <italic>&#945;</italic> while distances between centroids is more than <italic>&#945;</italic>. UCLUST is a heuristic algorithm, and the processing order of the queries may affect the resulting clustering. CD-HIT differs from UCLUST primarily in its strategy for computing distances.</p>
<p><bold>Formulation as min-cut partitioning</bold>. We define OTUs by solving the Min-diameter, Sum-Length, or Single-linkage min-cut partitioning problems using a chosen threshold <italic>&#945;</italic> and an inferred ML phylogeny. Each cluster in the resulting partition is designated as an OTU.</p>
<p><bold>Experiments</bold>. We evaluate the quality of tree-based OTU clustering by comparing it to UCLUST as used by Greengenes [<xref ref-type="bibr" rid="pone.0221068.ref028">28</xref>]. We run TreeCluster on the phylogenetic tree of 203,452 sequences in the Greengenes v13.5 database in three modes: max, sum, and single-linkage. We use the following 20 thresholds: [0.005, 0.05] with a step size of 0.005, and (0.05, 0.15] with a step size of 0.01. For single-linkage, we only go up to 0.1 because, above this threshold, the number of clusters becomes much smaller than other methods.</p>
<p>From the same Greengenes database, we extract OTU clusters for all available sequence identity thresholds up to 0.15 (i.e., 0.03, 0.06, 0.09, 0.12, and 0.15). We measure the quality of a clustering {<italic>L</italic><sub>1</sub>, &#8230;, <italic>L</italic><sub><italic>N</italic></sub>} by its weighted average of average pairwise distance per cluster (which we call <italic>cluster diversity</italic> for shorthand), given by the following formula:
<disp-formula id="pone.0221068.e015"><alternatives><graphic id="pone.0221068.e015g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e015" ns0:type="simple" /><ns1:math display="block" id="M15"><ns1:mrow><ns1:mi>&#956;</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mrow><ns1:mo>{</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mn>1</ns1:mn></ns1:msub> <ns1:mo>,</ns1:mo> <ns1:mo>&#8230;</ns1:mo> <ns1:mo>,</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>N</ns1:mi></ns1:msub> <ns1:mo>}</ns1:mo></ns1:mrow> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mo>=</ns1:mo> <ns1:mfrac><ns1:mrow><ns1:mstyle displaystyle="true"><ns1:munderover><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>k</ns1:mi> <ns1:mo>=</ns1:mo> <ns1:mn>1</ns1:mn></ns1:mrow> <ns1:mi>N</ns1:mi></ns1:munderover></ns1:mstyle> <ns1:mrow><ns1:mo>|</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub> <ns1:mo>|</ns1:mo></ns1:mrow> <ns1:mfrac><ns1:mrow><ns1:mstyle displaystyle="true"><ns1:munder><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>i</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>j</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub></ns1:mrow></ns1:munder></ns1:mstyle> <ns1:mi>d</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>i</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>j</ns1:mi> <ns1:mo>)</ns1:mo></ns1:mrow></ns1:mrow> <ns1:mrow><ns1:mrow><ns1:mo>|</ns1:mo></ns1:mrow> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub> <ns1:msup><ns1:mrow><ns1:mo>|</ns1:mo></ns1:mrow> <ns1:mn>2</ns1:mn></ns1:msup></ns1:mrow></ns1:mfrac></ns1:mrow> <ns1:mrow><ns1:mstyle displaystyle="true"><ns1:munderover><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>k</ns1:mi> <ns1:mo>=</ns1:mo> <ns1:mn>1</ns1:mn></ns1:mrow> <ns1:mi>N</ns1:mi></ns1:munderover></ns1:mstyle> <ns1:mrow><ns1:mo>|</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub> <ns1:mo>|</ns1:mo></ns1:mrow></ns1:mrow></ns1:mfrac> <ns1:mo>=</ns1:mo> <ns1:mfrac><ns1:mn>1</ns1:mn> <ns1:mi>n</ns1:mi></ns1:mfrac> <ns1:munderover><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>k</ns1:mi> <ns1:mo>=</ns1:mo> <ns1:mn>1</ns1:mn></ns1:mrow> <ns1:mi>N</ns1:mi></ns1:munderover> <ns1:mspace width="0.277778em" /><ns1:munder><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>i</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>j</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub></ns1:mrow></ns1:munder> <ns1:mfrac><ns1:mrow><ns1:mi>d</ns1:mi> <ns1:mo>(</ns1:mo> <ns1:mi>i</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>j</ns1:mi> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mrow><ns1:mrow><ns1:mo>|</ns1:mo></ns1:mrow> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub> <ns1:mrow><ns1:mo>|</ns1:mo></ns1:mrow></ns1:mrow></ns1:mfrac></ns1:mrow></ns1:math></alternatives> <label>(1)</label></disp-formula>
where <italic>n</italic> denotes the number of sequences clustered. We compute distance <italic>d</italic>(<italic>i</italic>, <italic>j</italic>) between two elements using two methods: <italic>tree distance</italic>, which is the path length on the inferred phylogenetic tree, and sequence-based Hamming distance. Hamming distances are computed pairwise from the multiple sequence alignment of all 203,452 sequences in the Greengenes database and ignore any site that includes a gap in the pairwise alignment. Clearly, cluster diversity alone is insufficient to judge results (singletons have zero diversity). Instead, we compare methods at the same level of clustering with respect to their diversity. Thus, as we change the threshold <italic>&#945;</italic>, we compare methods for choices of the threshold where they result in (roughly) equal numbers of clusters. Given the same number of clusters, a method with lower cluster diversity is considered preferable.</p>
<p>We measure the quality of a representative sequence set using two metrics. For a clustering {<italic>L</italic><sub>1</sub>, &#8230;, <italic>L</italic><sub><italic>N</italic></sub>}, let {<italic>L</italic><sub>1</sub>, &#8230;, <italic>L</italic><sub><italic>N</italic>&#8242;</sub>} denote all non-singleton clusters. The first metric is the average of average distance to the centroid per cluster, formally defined as:
<disp-formula id="pone.0221068.e016"><alternatives><graphic id="pone.0221068.e016g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e016" ns0:type="simple" /><ns1:math display="block" id="M16"><ns1:mrow><ns1:mi>&#957;</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>g</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mrow><ns1:mo>{</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mn>1</ns1:mn></ns1:msub> <ns1:mo>,</ns1:mo> <ns1:mo>&#8230;</ns1:mo> <ns1:mo>,</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:msup><ns1:mi>N</ns1:mi> <ns1:mo>&#8242;</ns1:mo></ns1:msup></ns1:msub> <ns1:mo>}</ns1:mo></ns1:mrow> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mo>=</ns1:mo> <ns1:mfrac><ns1:mn>1</ns1:mn> <ns1:msup><ns1:mi>N</ns1:mi> <ns1:mo>&#8242;</ns1:mo></ns1:msup></ns1:mfrac> <ns1:munderover><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>k</ns1:mi> <ns1:mo>=</ns1:mo> <ns1:mn>1</ns1:mn></ns1:mrow> <ns1:msup><ns1:mi>N</ns1:mi> <ns1:mo>&#8242;</ns1:mo></ns1:msup></ns1:munderover> <ns1:mspace width="0.277778em" /><ns1:munder><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>i</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub></ns1:mrow></ns1:munder> <ns1:mfrac><ns1:mrow><ns1:mi>d</ns1:mi> <ns1:mo>(</ns1:mo> <ns1:mi>i</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>g</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mrow><ns1:mrow><ns1:mo>|</ns1:mo></ns1:mrow> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub> <ns1:mrow><ns1:mo>|</ns1:mo></ns1:mrow></ns1:mrow></ns1:mfrac></ns1:mrow></ns1:math></alternatives> <label>(2)</label></disp-formula>
where <italic>g</italic> is a function that maps a cluster to a (representative) sequence. The second metric is the average of maximum distance to the representative per cluster, formally defined as:
<disp-formula id="pone.0221068.e017"><alternatives><graphic id="pone.0221068.e017g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e017" ns0:type="simple" /><ns1:math display="block" id="M17"><ns1:mrow><ns1:mi>&#958;</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>g</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mrow><ns1:mo>{</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mn>1</ns1:mn></ns1:msub> <ns1:mo>,</ns1:mo> <ns1:mo>&#8230;</ns1:mo> <ns1:mo>,</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:msup><ns1:mi>N</ns1:mi> <ns1:mo>&#8242;</ns1:mo></ns1:msup></ns1:msub> <ns1:mo>}</ns1:mo></ns1:mrow> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mo>=</ns1:mo> <ns1:mfrac><ns1:mn>1</ns1:mn> <ns1:msup><ns1:mi>N</ns1:mi> <ns1:mo>&#8242;</ns1:mo></ns1:msup></ns1:mfrac> <ns1:munderover><ns1:mo>&#8721;</ns1:mo> <ns1:mrow><ns1:mi>k</ns1:mi> <ns1:mo>=</ns1:mo> <ns1:mn>1</ns1:mn></ns1:mrow> <ns1:msup><ns1:mi>N</ns1:mi> <ns1:mo>&#8242;</ns1:mo></ns1:msup></ns1:munderover> <ns1:mspace width="0.277778em" /><ns1:munder><ns1:mtext>max</ns1:mtext> <ns1:mrow><ns1:mi>i</ns1:mi> <ns1:mo>&#8712;</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub></ns1:mrow></ns1:munder> <ns1:mspace width="0.277778em" /><ns1:mi>d</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:mi>i</ns1:mi> <ns1:mo>,</ns1:mo> <ns1:mi>g</ns1:mi> <ns1:mrow><ns1:mo>(</ns1:mo> <ns1:msub><ns1:mi>L</ns1:mi> <ns1:mi>k</ns1:mi></ns1:msub> <ns1:mo>)</ns1:mo></ns1:mrow> <ns1:mo>)</ns1:mo></ns1:mrow></ns1:mrow></ns1:math></alternatives> <label>(3)</label></disp-formula>
We define these metrics on the set of non-singleton clusters because a trivial clustering which assigns many singletons will trivially have a very low value for <italic>&#957;</italic> and <italic>&#958;</italic> (near zero).</p>
<p>Greengenes database is distributed with precomputed representative sequence sets. For centroid selection for TreeCluster, we consider two methods <italic>g</italic>: consensus and ASR. We perform ASR using TreeTime [<xref ref-type="bibr" rid="pone.0221068.ref035">35</xref>] under GTR model. We use RAxML 8 [<xref ref-type="bibr" rid="pone.0221068.ref036">36</xref>] to infer GTR model parameters from the Greengenes multiple sequence alignment of representative sequences at 15 percent threshold. We compute distance <italic>d</italic>(<italic>i</italic>, <italic>j</italic>) between two elements using Hamming distance.</p>
</sec>
<sec id="sec013">
<title>Application 2: HIV transmission cluster analyses</title>
<p><bold>Biological Problem</bold>. HIV evolves rapidly, so phylogenetic relationships between sequences contain information about the history of transmission [<xref ref-type="bibr" rid="pone.0221068.ref037">37</xref>]. The ability to perform phylogenetic analyses of HIV sequences is critical for epidemiologists who design and evaluate HIV control strategies [<xref ref-type="bibr" rid="pone.0221068.ref038">38</xref>&#8211;<xref ref-type="bibr" rid="pone.0221068.ref042">42</xref>]. The results of these analyses can provide information about the genetic linkage [<xref ref-type="bibr" rid="pone.0221068.ref043">43</xref>] and transmission histories [<xref ref-type="bibr" rid="pone.0221068.ref044">44</xref>], as well as mixing across subpopulations [<xref ref-type="bibr" rid="pone.0221068.ref045">45</xref>]. A recent advancement in computational molecular epidemiology is the use of transmission clustering to predict at-risk individuals and epidemic growth: infer transmission clusters from pairwise sequence distances, monitor the growth of clusters over time, and prioritize clusters with the highest growth rates [<xref ref-type="bibr" rid="pone.0221068.ref046">46</xref>]. In this monitoring framework, two natural questions come about: What is the optimal way to infer transmission clusters from molecular data, and how can transmission cluster inference be performed more efficiently?</p>
<p><bold>Existing methods</bold>. We focus on two popular tools that perform such clustering. Cluster Picker [<xref ref-type="bibr" rid="pone.0221068.ref004">4</xref>] is given a distance threshold, a phylogenetic tree, and sequences. It clusters individuals such that each cluster defines the leaves of a clade in the tree, the maximum pairwise sequence-based distance in each cluster is below the threshold, and the number of clusters is minimized. HIV-TRACE is a tool that, given a distance threshold and sequences, clusters individuals such that, for each pair of individuals <italic>u</italic> and <italic>v</italic>, if the Tamura-Nei 93 (TN93) distance [<xref ref-type="bibr" rid="pone.0221068.ref047">47</xref>] between <italic>u</italic> and <italic>v</italic> is below the threshold, <italic>u</italic> and <italic>v</italic> are placed in the same cluster [<xref ref-type="bibr" rid="pone.0221068.ref005">5</xref>]. Both methods scale worse than linearly with the number of sequences (quadratically and cubically, respectively, for HIV-TRACE and Cluster Picker), and for large datasets, they can take hours, or even days, to run (however, HIV-TRACE enjoys trivial parallelism and is fast in practice).</p>
<p><bold>Formulation as min-cut partitioning</bold>. Transmission clustering is similar to our problem formulation in that it involves cutting edges such that the resulting clusters (as defined by the leafsets resulting from the cuts) must adhere to certain constraints. Both Cluster Picker and HIV-TRACE utilize pairwise distances computed from sequences, but when reformulated to utilize tree-based distances from an inferred phylogeny, Cluster Picker becomes analogous to our Max-diameter min-cut partitioning (with an added constraint that clusters must define clades in the phylogeny), and HIV-TRACE becomes analogous to the Single-linkage min-cut partitioning.</p>
<p><bold>Experiments</bold>. To evaluate the effectiveness of HIV transmission clustering, we first simulate HIV epidemic data using FAVITES [<xref ref-type="bibr" rid="pone.0221068.ref048">48</xref>]. For the simulation parameters, we use the parameters described in Moshiri <italic>et. al</italic>. [<xref ref-type="bibr" rid="pone.0221068.ref048">48</xref>] to model the San Diego HIV epidemic between 2005 and 2014. However, we deviate from the original parameter set in one key way: originally, all HIV patients were sequenced at the end time of the epidemic, yielding an ultrametric tree in the unit of time, but to better capture reality, we instead sequence each patient the first time they receive Antiretroviral Treatment (ART). In our simulations, we vary two parameters: the expected time to begin ART as well as the expected degree of the social contact network, which underlies the transmission network. Higher ART rates and lower degrees both result in a slower epidemic and change patterns of phylogenetic branch length [<xref ref-type="bibr" rid="pone.0221068.ref048">48</xref>]. The complete FAVITES parameter set can be found in the supplementary materials (List A in <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>). We infer phylogenies from simulated sequences under the GTR+&#915; model using FastTree-II [<xref ref-type="bibr" rid="pone.0221068.ref008">8</xref>], and we use the MinVar algorithm to root the trees using FastRoot [<xref ref-type="bibr" rid="pone.0221068.ref049">49</xref>].</p>
<p>We use HIV-TRACE [<xref ref-type="bibr" rid="pone.0221068.ref005">5</xref>] as well as multiple clustering modes of TreeCluster to infer transmission clusters. We were unable to use Cluster Picker [<xref ref-type="bibr" rid="pone.0221068.ref004">4</xref>] due to its excessive running time. For HIV-TRACE, we use a clustering threshold of 1.5% as suggested by its authors [<xref ref-type="bibr" rid="pone.0221068.ref046">46</xref>]. Because HIV-TRACE estimates pairwise sequences distances under the TN93 model, [<xref ref-type="bibr" rid="pone.0221068.ref047">47</xref>] which tend to be underestimates of phylogenetic distance estimated under the GTR model, we use a clustering threshold of 3% for Single-Linkage TreeCluster. The default Cluster Picker threshold for Max-diameter clustering is 4.5% [<xref ref-type="bibr" rid="pone.0221068.ref004">4</xref>], so we use this as our clustering threshold for Max-Diameter TreeCluster (both with and without the Clade constraint). For Sum-length TreeCluster (with and without the Clade constraint), we simply double the Max-diameter threshold and use 9%. In addition to using these default thresholds, we also test a wide range of thresholds for each transmission clustering method for robustness.</p>
<p>We measure cluster growth from year 8 to year 9 of the simulation and select the 1,000 highest-priority individuals, where individuals are prioritized in descending order of respective cluster growth. To measure the risk of a given individual <italic>u</italic>, we count the number of HIV transmission events <italic>u</italic> &#8594; <italic>v</italic> between years 9 and 10. To measure the effectiveness of a given clustering, we average the risk of the selected top 1,000 individuals. Higher numbers imply the ability to prevent more transmissions by targeting a fixed number of individuals (1,000) and are thus desirable. As a control, we also show the mean number of transmissions per population, which is what a random selection of 1,000 individuals would give in expectation (we call this &#8220;expected&#8221; risk).</p>
</sec>
<sec id="sec014">
<title>Application 3: Divide-and-conquer multiple sequence alignment</title>
<p><bold>Algorithmic idea</bold>. Tree-based clustering has also been used for multiple sequence alignment (MSA) using divide-and-conquer. To solve the MSA problem using divide-and-conquer, the tree structure can be used to divide sequences into smaller subsets (i.e., clusters), which can each be aligned separately and then merged. The phylogeny and the MSA can be inferred simultaneously by iterating between tree and MSA inference, and this technique has been used in algorithms such as SATe [<xref ref-type="bibr" rid="pone.0221068.ref050">50</xref>, <xref ref-type="bibr" rid="pone.0221068.ref051">51</xref>] and PASTA [<xref ref-type="bibr" rid="pone.0221068.ref052">52</xref>]. Divide-and-conquer has been proven to be particularly useful for MSA of very large datasets [<xref ref-type="bibr" rid="pone.0221068.ref009">9</xref>, <xref ref-type="bibr" rid="pone.0221068.ref010">10</xref>, <xref ref-type="bibr" rid="pone.0221068.ref050">50</xref>]. We note that not all MSA tools use divide-and-conquer and that we only study the usage of min-cut partitioning in divide-and-conquer methods. We examine the effectiveness of min-cut partitioning in PASTA [<xref ref-type="bibr" rid="pone.0221068.ref052">52</xref>], a scalable software which infers both MSAs and trees for ultra-large datasets (tested for up to 1,000,000 sequences).</p>
<p>PASTA first builds a quick-and-dirty estimate of the phylogeny that is used as a guidance to cluster the sequences. In its &#8220;divide&#8221; phase, PASTA clusters the input sequences into subsets so that each subset contains less diverse sequences than the full set. Then, an accurate (but often computationally demanding) method is run on the subsets to infer the MSA and/or the tree. Finally, the results on the subsets are merged using various techniques. The accuracy of the output depends not only on the accuracy of the base method used on the subsets and the merging method, but also on the effectiveness of the method used to divide the tree into subsets [<xref ref-type="bibr" rid="pone.0221068.ref051">51</xref>].</p>
<p>PASTA computes an initial alignment using HMMs implemented in HMMER [<xref ref-type="bibr" rid="pone.0221068.ref053">53</xref>] and an initial tree using FastTree-II [<xref ref-type="bibr" rid="pone.0221068.ref008">8</xref>]; then, it performs several iterations (3 by default) of the divide-and-conquer strategy described before using MAFFT [<xref ref-type="bibr" rid="pone.0221068.ref054">54</xref>] for aligning subsets and using a combination of OPAL [<xref ref-type="bibr" rid="pone.0221068.ref055">55</xref>] and a technique using transitivity for merging subalignments. A tree is generated using FastTree-II at the end of each iteration, which is then used as the guide tree for the next iteration. The method has shown great accuracy on simulated and real data, especially in terms of tree accuracy, where it comes very close to the accuracy obtained using the true alignment, leaving little room for improvement. However, in terms of the alignment accuracy, it has substantial room for improvement on the most challenging datasets.</p>
<p>The clustering used in PASTA is based on the centroid-edge decomposition. Given the <italic>guide tree</italic> (available from the previous iteration), the decomposition is defined recursively: divide the tree into two halves, such that the two parts have equal size (or are as close in size as possible). Then, recurse on each subtree until there are no more than a given number of leaves (200 by default) in each subset.</p>
<p><bold>Formulation as min-cut partitioning</bold>. The centroid edge decomposition involves cutting edges and includes a constraint defined on the subsets. However, it is defined procedurally and does not optimize any natural objective function. The min-cut partitioning can produce a decomposition similar to the centroid decomposition in its constraints but different in outcome. We set all edge weights of the guide tree to 1 and solve the Sum-length min-cut partitioning problem with threshold <italic>&#945;</italic> = 2<italic>m</italic> &#8722; 2; the result is a partition such that no cluster has more than <italic>m</italic> leaves and the number of subsets is minimized. Thus, this &#8220;max-size min-cut partitioning&#8221; is identical to centroid decomposition in its constraints but guarantees to find the minimum number of clusters.</p>
<p><bold>Experiments</bold>. To evaluate how our new decomposition impacts PASTA, we run PASTA version 1.8.3 on two datasets, and for each, we compare the accuracy of the two decomposition strategies: centroid and max-size min-cut partitioning. Other parameters (including maximum subset size) are all kept fixed for both decomposition strategies. We used two datasets both from the original PASTA paper: 10 replicates of a simulated RNAsim dataset with 10,000 leaves and a set of 19 real HomFam datasets with 10,099 to 93,681 protein sequences. The RNASim is based on a very complex model of RNA evolution. Here, the true alignment, known in simulations, is used as the reference. For HomFam, since the true alignment is not known, following previous papers, we rely on a very small number of seed sequences with a hand-curated reliable alignment as reference [<xref ref-type="bibr" rid="pone.0221068.ref009">9</xref>, <xref ref-type="bibr" rid="pone.0221068.ref056">56</xref>]. In both cases, we measure alignment error using two standard metrics computed using FastSP [<xref ref-type="bibr" rid="pone.0221068.ref057">57</xref>]: SPFN (the percentage of homologies in the reference alignment not recovered in the estimated alignment) and SPFP (the percentage of homologies in the estimated alignment not present in the reference).</p>
</sec>
</sec>
</sec>
<sec id="sec015" sec-type="results">
<title>Results</title>
<sec id="sec016">
<title>Results for Application 1: OTU clustering</title>
<p>On the Greengenes dataset, as we change the threshold between 0.005 and 0.15, we get between 181, 574 and 10, 112 clusters (note that singletons are also counted). The cluster diversity has a non-linear relationship with the number of clusters: it drops more quickly with higher thresholds where fewer clusters are formed (<xref ref-type="fig" rid="pone.0221068.g002">Fig 2A</xref> and <xref ref-type="supplementary-material" rid="pone.0221068.s001">S1 Fig</xref>). Comparing the three objective functions that can be used in TreeCluster, we observe that Max-diameter and Sum-length have similar trends of cluster diversity scores, whereas Single-linkage min-cut partitioning has substantially higher diversity compared to the other two methods (<xref ref-type="supplementary-material" rid="pone.0221068.s001">S1 Fig</xref>). This pattern is observed regardless of whether tree distances or sequence distances are used, but differences are larger for tree distances. Finally, note that, even though tree distances are, as expected, larger than sequence distances (<xref ref-type="supplementary-material" rid="pone.0221068.s002">S2 Fig</xref>), the cluster diversity is <italic>lower</italic> when computed using tree distances, showing that clusters are tight in the phylogenetic space.</p>
<fig id="pone.0221068.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0221068.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Comparing Greengenes and TreeCluster.</title>
<p>(A) Cluster diversity (<xref ref-type="disp-formula" rid="pone.0221068.e015">Eq 1</xref>) for Greengenes and TreeCluster versus the number of OTUs. Cluster diversity is measured both with respect to hamming distance and tree-based distance. The threshold <italic>&#945;</italic> is shown for all data points corresponding to Greengenes and for some points of TreeCluster. See <xref ref-type="supplementary-material" rid="pone.0221068.s001">S1 Fig</xref> for comparison to other TreeCluster modes. (B) Average-average (<italic>&#957;</italic>) and average-maximum (<italic>&#958;</italic>) distance to the centroid for Greengenes and TreeCluster versus the number of clusters. TreeCluster centroids are computed using ancestral state reconstruction or using consensus.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.g002" ns0:type="simple" />
</fig>
<p>Compared to the default Greengenes OTUs, which are defined using UCLUST, Max-diameter min-cut partitioning defines tighter clusters for tree-based scores (<xref ref-type="fig" rid="pone.0221068.g002">Fig 2A</xref>). When distances between sequences are measured in tree distance, the cluster diversity score for Greengenes OTUs is substantially lower for all thresholds, and the gap is larger for higher thresholds. For example, the cluster diversity of Greengenes OTUs is three times higher than TreeCluster OTUs for <italic>&#945;</italic> = 0.15. When distances between sequences are measured in Hamming distance, Greengenes and TreeCluster perform similarly for low threshold values (e.g. <italic>&#945;</italic> = 0.03 for Greengenes, which is similar to <italic>&#945;</italic> = 0.02 for TreeCluster in terms of the number of clusters). However, when the number of OTUs is reduced, remarkably, TreeCluster outperforms Greengenes OTUs by up to 1.4-fold (e.g. <italic>&#945;</italic> = 0.15). This is despite the fact that UCLUST is working based on sequence distances and TreeCluster is not.</p>
<p>Size of the largest cluster in Greengenes is larger compared to TreeCluster (<xref ref-type="table" rid="pone.0221068.t001">Table 1</xref>). For example, for <italic>&#945;</italic> = 0.09, both methods have similar number of clusters (22,090 and 23,631 for Greengenes and TreeCluster, respectively) but the size of largest cluster in Greengenes is three times that of TreeCluster (1,659 versus 540). On the other hand, for the same threshold value, the number of singleton clusters comprises 48% of all clusters for Greengenes whereas only 27% of the clusters are singletons for TreeCluster. Thus, GreenGenes has more clusters that are very small or very large, compared to TreeCluster.</p>
<table-wrap id="pone.0221068.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0221068.t001</object-id>
<label>Table 1</label>
<caption>
<title>Number of singleton clusters (<italic>&#963;</italic>), total number of clusters (&#931;), and maximum cluster size (<italic>max</italic>) for TreeCluster and GreenGenes for various thresholds.</title>
<p>In the Greengenes database, OTU definitions for thresholds <italic>&#945;</italic> = 0.015 and <italic>&#945;</italic> = 0.045 are not available.</p>
</caption>
<alternatives>
<graphic id="pone.0221068.t001g" mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.t001" ns0:type="simple" />
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
</colgroup>
<thead>
<tr>
<th align="left" />
<th align="left" colspan="3">TreeCluster-Max-Diameter</th>
<th align="left" colspan="3">GreenGenes-UCLUST</th>
</tr>
<tr>
<th align="left" style="border-bottom:thick"><italic>&#945;</italic></th>
<th align="left" style="border-bottom:thick"><italic>&#963;</italic></th>
<th align="left" style="border-bottom:thick">&#931;</th>
<th align="left" style="border-bottom:thick"><italic>max</italic></th>
<th align="left" style="border-bottom:thick"><italic>&#963;</italic></th>
<th align="left" style="border-bottom:thick">&#931;</th>
<th align="left" style="border-bottom:thick"><italic>max</italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="char" char="." style="border-right:thick">0.015</td>
<td align="left">86387</td>
<td align="left">123456</td>
<td align="left">47</td>
<td align="left">(n.a)</td>
<td align="left">(n.a)</td>
<td align="left">(n.a)</td>
</tr>
<tr>
<td align="char" char="." style="border-right:thick">0.03</td>
<td align="left">42510</td>
<td align="left">77263</td>
<td align="left">96</td>
<td align="left">70415</td>
<td align="left">99322</td>
<td align="left">527</td>
</tr>
<tr>
<td align="char" char="." style="border-right:thick">0.045</td>
<td align="left">24795</td>
<td align="left">54068</td>
<td align="left">171</td>
<td align="left">(n.a)</td>
<td align="left">(n.a)</td>
<td align="left">(n.a)</td>
</tr>
<tr>
<td align="char" char="." style="border-right:thick">0.06</td>
<td align="left">15257</td>
<td align="left">39809</td>
<td align="left">305</td>
<td align="left">26485</td>
<td align="left">46256</td>
<td align="left">894</td>
</tr>
<tr>
<td align="char" char="." style="border-right:thick">0.09</td>
<td align="left">6396</td>
<td align="left">23631</td>
<td align="left">540</td>
<td align="left">10560</td>
<td align="left">22090</td>
<td align="left">1659</td>
</tr>
<tr>
<td align="char" char="." style="border-right:thick">0.12</td>
<td align="left">3003</td>
<td align="left">15052</td>
<td align="left">808</td>
<td align="left">4153</td>
<td align="left">10544</td>
<td align="left">2131</td>
</tr>
<tr>
<td align="char" char="." style="border-right:thick">0.15</td>
<td align="left">1525</td>
<td align="left">10112</td>
<td align="left">1209</td>
<td align="left">1735</td>
<td align="left">5088</td>
<td align="left">3765</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Computed using either consensus or ASR method, representative sequences in TreeCluster are closer to other sequences of the cluster than Greengenes (<xref ref-type="fig" rid="pone.0221068.g002">Fig 2B</xref>). Using ASR representative sequences performs slightly worse than consensus centroids according to the <italic>&#957;</italic> score (e.g. <italic>&#957;</italic> = 0.062 and <italic>&#957;</italic> = 0.057, respectively when <italic>&#945;</italic> = 0.15). When evaluated using <italic>&#958;</italic> score, ASR representative sequences perform slightly better than consensus in all threshold levels (e.g. <italic>&#958;</italic> = 0.03 and <italic>&#958;</italic> = 0.04 respectively when <italic>&#945;</italic> = 0.005) and the gap again widens as the number of clusters increases. Both types of centroids computed using TreeCluster perform better than Greengenes representative sequences according to both metrics, and the gap increases as the threshold <italic>&#945;</italic> increases (e.g. up to 1.7-fold when <italic>&#945;</italic> = 0.15 for <italic>&#957;</italic>).</p>
</sec>
<sec id="sec017">
<title>Results for Application 2: HIV dynamics</title>
<p>Comparing various TreeCluster modes, regardless of the parameters that we vary, Sum-length TreeCluster consistently outperforms the other clustering methods, and the inclusion of the Clade constraint has little impact on effectiveness (<xref ref-type="fig" rid="pone.0221068.g003">Fig 3</xref>). Compared to a random selection of individuals, the risk of selected individuals can be substantially higher; for example, with expected time to begin ART set to 1 year, the expected risk is 0.55 transmissions, whereas the average risk of the top 1,000 individuals from Sum-length clusters is 0.85. In all the conditions, a close second to TreeCluster Sum-length is TreeCluster Max-diameter. Other methods, however, are substantially less effective than these two modes of TreeCluster.</p>
<fig id="pone.0221068.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0221068.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Effectiveness of transmission clustering.</title>
<p>Effectiveness is measured as the average number of individuals infected by the selected 1,000 individuals. The horizontal axis depicts the expected time to begin ART (A), the expected degree (i.e., number of sexual contacts) for individuals in the contact network (B), and the number of clusters using various thresholds (C).</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.g003" ns0:type="simple" />
</fig>
<p>When varying expected time to begin ART and expected degree, Single-linkage TreeCluster and HIV-TRACE consistently perform lower than the other approaches, with Single-linkage TreeCluster typically performing around the theoretical expectation of a random selection and HIV-TRACE performing slightly better (<xref ref-type="fig" rid="pone.0221068.g003">Fig 3a and 3b</xref>). Moreover, these patterns are not simply due to the chosen thresholds: even when the threshold is changed to control the number of clusters, Single-linkage TreeCluster and HIV-TRACE consistently perform worse than expected by random selection (<xref ref-type="fig" rid="pone.0221068.g003">Fig 3c</xref>). The effectiveness of Sum-length and Max-diameter TreeCluster are maximized when they create 2,000&#8211;5,000 and 2,000&#8211;3,000 clusters, respectively.</p>
</sec>
<sec id="sec018">
<title>Results for Application 3: Improving PASTA</title>
<p>First, we notice a substantial improvement of PASTA 1.8.3 comparing to the original version published in 2015 [<xref ref-type="bibr" rid="pone.0221068.ref052">52</xref>], especially for RNASim where alignment accuracy improved by about 3%. This was due to major updates of the PASTA software and the dependent tools. When we replace centroid decomposition with Max-size min-cut partitioning in PASTA, the alignment error reduces substantially for the RNASim dataset, but less so on the HomFam dataset (<xref ref-type="fig" rid="pone.0221068.g004">Fig 4</xref>). On the RNAsim data, mean SPFN drops from 0.12 to 0.10, which corresponds to a 17% reduction in error. These drops are consistent across replicates and are substantial given the fact that the only change in PASTA was to replace its decomposition step with our new clustering algorithm, keeping the rest of the complex pipeline unchanged. In particular, the method to align subsets, to merge alignments, and to infer trees, were all kept fixed. On the HomFam dataset, too, errors decreased, but the reductions were not substantial (<xref ref-type="fig" rid="pone.0221068.g004">Fig 4b</xref>). Based on these results, we have now changed PASTA to use Max-size min-cut partitioning by default.</p>
<fig id="pone.0221068.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0221068.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Alignment error for PASTA using the centroid and the mincut decompositions.</title>
<p>We show Sum of Pairs False Negative (SPFN) and Sum of Pairs False Psotive (SPFP) computed using FastSP [<xref ref-type="bibr" rid="pone.0221068.ref057">57</xref>] over two datasetes: the simulated RNASim dataset (10 replicates) and the biological HomFam dataset (19 largest families; all 20 largest, except &#8220;rhv&#8221; omitted due to the warning on the Pfam website). We show boxplots in addition to mean (red dot) and standard error (red error bars).</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.g004" ns0:type="simple" />
</fig>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>Several theoretical and practical issues should be further discussed.</p>
<sec id="sec020">
<title>Mean-diameter min-cut partitioning</title>
<p>Some of the existing methods, such as Cluster Picker [<xref ref-type="bibr" rid="pone.0221068.ref004">4</xref>], can define their constraints based on mean pairwise distance between nodes. Similar to those, we can define a variation of the min-cut partitioning problem in which <inline-formula id="pone.0221068.e018"><alternatives><graphic id="pone.0221068.e018g" mimetype="image" position="anchor" ns0:href="info:doi/10.1371/journal.pone.0221068.e018" ns0:type="simple" /><ns1:math display="inline" id="M18"><ns1:mrow><ns1:msub><ns1:mi>f</ns1:mi><ns1:mi>T</ns1:mi></ns1:msub><ns1:mspace width="2pt" /><ns1:mo stretchy="false">(</ns1:mo><ns1:mi>L</ns1:mi><ns1:mo stretchy="false">)</ns1:mo><ns1:mo>=</ns1:mo><ns1:mfrac><ns1:mn>1</ns1:mn><ns1:mrow><ns1:mrow><ns1:mo>(</ns1:mo><ns1:mrow><ns1:mtable><ns1:mtr><ns1:mtd><ns1:mrow><ns1:mrow><ns1:mo>|</ns1:mo><ns1:mi>L</ns1:mi><ns1:mo>|</ns1:mo></ns1:mrow></ns1:mrow></ns1:mtd></ns1:mtr><ns1:mtr><ns1:mtd><ns1:mn>2</ns1:mn></ns1:mtd></ns1:mtr></ns1:mtable></ns1:mrow><ns1:mo>)</ns1:mo></ns1:mrow></ns1:mrow></ns1:mfrac><ns1:mstyle displaystyle="true"><ns1:munder><ns1:mo>&#8721;</ns1:mo><ns1:mrow><ns1:mi>i</ns1:mi><ns1:mo>,</ns1:mo><ns1:mi>j</ns1:mi><ns1:mo>&#8712;</ns1:mo><ns1:mi>L</ns1:mi></ns1:mrow></ns1:munder><ns1:mrow><ns1:mi>d</ns1:mi><ns1:mo stretchy="false">(</ns1:mo><ns1:mi>i</ns1:mi><ns1:mo>,</ns1:mo><ns1:mspace width="2pt" /><ns1:mi>j</ns1:mi><ns1:mo stretchy="false">)</ns1:mo></ns1:mrow></ns1:mstyle></ns1:mrow></ns1:math></alternatives></inline-formula>. Unfortunately, this &#8220;Mean-diameter&#8221; min-cut partitioning problem can only be solved in linear time using our greedy algorithm if we also have clade constraints (Algorithm B in <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>). As demonstrated by the counterexample given in <xref ref-type="supplementary-material" rid="pone.0221068.s003">S3 Fig</xref>, the greedy algorithm fails if we do not have clade constraints. More generally, the use of mean as function <italic>f</italic><sub><italic>T</italic></sub> (&#183;) creates additional complexity, and whether it can be solved in linear time remains unclear. Whether mean diameter is in fact a reasonable criterion is not clear. For example, it is possible that the mean diameter of a cluster is below the threshold while the mean diameter of subclusters embedded in that cluster are not; such scenarios may not make sense for downstream applications.</p>
</sec>
<sec id="sec021">
<title>Set of optimal solutions</title>
<p>It is possible that multiple distinct partitions with equal number of clusters are all optimal solutions to any of our min-cut partitioning problems. Moreover, as the example given in <xref ref-type="fig" rid="pone.0221068.g005">Fig 5</xref> shows, the number of optimal solutions can be exponential with respect to number of leaves in a binary phylogenetic tree. This observation renders listing all optimal solutions potentially impractical as there may be too many of them. However, finding a way to summarize all optimal partitions remains interesting and can have practical utility. We do not currently have such a summarization approach. However, as shown in Lemma A of <xref ref-type="supplementary-material" rid="pone.0221068.s004">S1 Appendix</xref>, although the optimal solution space is potentially exponentially large, one can easily determine the set of all edges that could appear in any of the optimal solutions. Thus, we could find absolutely unbreakable edges that will not be cut in any optimal clustering of the data.</p>
<fig id="pone.0221068.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0221068.g005</object-id>
<label>Fig 5</label>
<caption>
<title>An example showing that number of minimal clusterings under a diameter threshold can be exponential of number of leaves.</title>
<p>When the threshold is 3.5, each unit has to be split into two clusters, and there are thus three equally-optimal ways of splitting. The minimum number of clusters is therefore 2<italic>n</italic>. The total number of distinct optimal solutions is 3<sup>n</sup>, whereas there are 3<italic>n</italic> leaves.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.g005" ns0:type="simple" />
</fig>
</sec>
<sec id="sec022">
<title>Choice of criterion</title>
<p>Among the three methods that we discussed, we observed that Max-diameter and Sum-diameter are consistently better than the Single-linkage. This observation makes intuitive sense. Single-linkage can increase the diversity within a cluster simply due to the transitive nature of its criterion. Thus, a very heterogeneous dataset may still be collapsed into one cluster, simply due to transitivity. Our desire to solve the Single-linkage problem was driven by the fact that a similar concept is used in HIV-TRACE, arguably the most widely used HIV clustering method. However, we did not detect any advantage in this type of clustering compared to Max-diameter or Sum-length; thus, our recommendation is to use these two criteria instead. Between the two, Max-diameter has the advantage that its <italic>&#945;</italic> threshold is easier to interpret. Finally, ASR-based selection of representative sequences outperformed consensus sequences, but we note that computing consensus sequences is much easier and faster.</p>
</sec>
<sec id="sec023">
<title>Running time</title>
<p>We focused on comparing the effectiveness of TreeCluster to other methods, but we note that its running time also compares favorably to other clustering methods (once the tree is inferred). For example, on a real HIV dataset, we ran HIV-TRACE, Cluster Picker, and TreeCluster for subsets of the data ranging from 100 to 5,000 sequences (<xref ref-type="fig" rid="pone.0221068.g006">Fig 6</xref>). On the largest set with 5,000 leaves, the running time of TreeCluster did not exceed 2 seconds. In contrast, the sequence-based HIV-Trace required close to a minute (which is still quite fast), but Cluster Picker needed more than an hour. Even on the Greengenes dataset with more than 200,000 leaves, TreeCluster performed clustering in only 30 seconds. The high speed of TreeCluster makes it possible to quickly scan through a set of <italic>&#945;</italic> thresholds to study its impact on the outcomes of downstream applications.</p>
<fig id="pone.0221068.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0221068.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Execution times of Cluster Picker, HIV-TRACE, and TreeCluster in log-scale.</title>
<p>Execution times (in seconds) are shown for each tool for various values of <italic>n</italic> sequences, with 10 replicates for each <italic>n</italic>. The full dataset was obtained by downloading all HIV-1 subtype B <italic>pol</italic> sequences (HXB2 coordinates 2,253 to 3,549) from the Los Alamos National Laboratory (LANL) database. All programs were run on a CentOS 5.8 machine with an Intel Xeon X7560 2.27 GHz CPU.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.g006" ns0:type="simple" />
</fig>
<p>We note that these numbers do not include the time spent for inferring the tree, which should also be considered if the tree is not already available (note that in many applications a tree is inferred for other purposes and is readily available). For example, based on previous studies, MSA and tree inference on datasets with 10,000 sequences can take close to an hour using PASTA and 12 CPUs. Around a third of this time is spent on tree inference (e.g., see Fig 4 of [<xref ref-type="bibr" rid="pone.0221068.ref009">9</xref>]) and the rest is spent on the estimating alignment, which is also needed by most alternative clustering methods.</p>
</sec>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Conclusion</title>
<p>We introduced TreeCluster, a method that can cluster sequences at the tips of a phylogenetic tree using several optimization objective functions. We showed that our linear-time algorithms can be used in several downstream applications, including OTU clustering, HIV transmission clustering, and divide-and-conquer alignment. Using the tree to build the clusters increases their internal consistency and improves downstream analyses.</p>
</sec>
<sec id="sec025">
<title>Supporting information</title>
<supplementary-material id="pone.0221068.s001" mimetype="application/pdf" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.s001" ns0:type="simple">
<label>S1 Fig</label>
<caption>
<title>Comparison of various TreeCluster modes and Greengenes.</title>
<p>Clustering quality of Greengenes and various TreeCluster modes, where quality is measured as average pairwise distance within a cluster (the lower the better). The horizontal axis shows the number of clusters for a given method and a threshold value. TreeCluster OTUs based on Max-diameter and Sum-length options outperform Single-linkage option as well as Greengenes OTUs. Computation of Hamming distance based cluster diversity for <italic>&#945;</italic> &#8805; 0.7 did not complete within 24 hours and had to be terminated.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0221068.s002" mimetype="application/pdf" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.s002" ns0:type="simple">
<label>S2 Fig</label>
<caption>
<title>Tree distance versus Hamming distance.</title>
<p>On 16S data, the relationship between tree distances and Hamming distances cannot be established using the Jukes-Cantor formula (red curve).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0221068.s003" mimetype="image/tiff" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.s003" ns0:type="simple">
<label>S3 Fig</label>
<caption>
<title>An example showing that Mean-diameter min-cut partitioning is not conforming locality when <italic>&#945;</italic> = 72, so it cannot be solved by a greedy algorithm analogous to Algorithm 1.</title>
<p>When a greedy algorithm is at the stage where it processes <italic>u</italic>, it makes the decision for cutting its children edges (<italic>u</italic>, <italic>v</italic>) and (<italic>u</italic>, <italic>a</italic>) based on the information available at the subtree rooted by <italic>u</italic>. When <italic>&#945;</italic> = 72, (A) <italic>T</italic><sub>1</sub> and (B) <italic>T</italic><sub>2</sub> require different cut-sets ({(<italic>u</italic>, <italic>v</italic>)} and {(<italic>u</italic>, <italic>a</italic>)} respectively) for the optimal Mean-diameter partitioning despite the fact that the subtree rooted by <italic>u</italic> remains unchanged in <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub>.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0221068.s004" mimetype="application/pdf" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.s004" ns0:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Proofs and supplementary algorithms.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>This work was supported by the National Institutes of Health (NIH) subaward 5P30AI027767-28 to M.B., U.M, N.M, and S.M. and NSF grant NSF-1815485 and NSF-1845967 to M.B., U.M., and S.M. Computations were performed on the San Diego Supercomputer Center (SDSC) through XSEDE allocations, which is supported by the NSF grant ACI-1053575.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0221068.ref001">
<label>1</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Goodrich</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Di Rienzi</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Poole</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Koren</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Walters</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <etal>et al</etal>. <article-title>Conducting a microbiome study</article-title>. <source>Cell</source>. <year>2014</year>;<volume>158</volume>(<issue>2</issue>):<fpage>250</fpage>&#8211;<lpage>262</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1016/j.cell.2014.06.037" ns0:type="simple">10.1016/j.cell.2014.06.037</ext-link></comment> <object-id pub-id-type="pmid">25036628</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref002">
<label>2</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>19</issue>):<fpage>2460</fpage>&#8211;<lpage>2461</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btq461" ns0:type="simple">10.1093/bioinformatics/btq461</ext-link></comment> <object-id pub-id-type="pmid">20709691</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref003">
<label>3</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Handelsman</surname> <given-names>J</given-names></name>. <article-title>Introducing DOTUR, a Computer Program for Defining Operational Taxonomic Units and Estimating Species Richness</article-title>. <source>Applied and Environmental Microbiology</source>. <year>2005</year>;<volume>71</volume>(<issue>3</issue>):<fpage>1501</fpage>&#8211;<lpage>1506</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1128/AEM.71.3.1501-1506.2005" ns0:type="simple">10.1128/AEM.71.3.1501-1506.2005</ext-link></comment> <object-id pub-id-type="pmid">15746353</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref004">
<label>4</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Ragonnet-Cronin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hodcroft</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hu&#233;</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fearnhill</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Delpech</surname> <given-names>VC</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>AJL</given-names></name>, <etal>et al</etal>. <article-title>Automated analysis of phylogenetic clusters</article-title>. <source>BMC bioinformatics</source>. <year>2013</year>;<volume>14</volume>:<fpage>317</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/1471-2105-14-317" ns0:type="simple">10.1186/1471-2105-14-317</ext-link></comment> <object-id pub-id-type="pmid">24191891</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref005">
<label>5</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Kosakovsky Pond</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Weaver</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Leigh Brown</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Wertheim</surname> <given-names>JO</given-names></name>. <article-title>HIV-TRACE (TRAnsmission Cluster Engine): a Tool for Large Scale Molecular Epidemiology of HIV-1 and Other Rapidly Evolving Pathogens</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year>;<volume>35</volume>(<issue>7</issue>):<fpage>1812</fpage>&#8211;<lpage>1819</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/molbev/msy016" ns0:type="simple">10.1093/molbev/msy016</ext-link></comment> <object-id pub-id-type="pmid">29401317</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref006">
<label>6</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Hillis</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Bull</surname> <given-names>JJ</given-names></name>. <article-title>An Empirical Test of Bootstrapping as a Method for Assessing Confidence in Phylogenetic Analysis</article-title>. <source>Systematic Biology</source>. <year>1993</year>;<volume>42</volume>(<issue>2</issue>):<fpage>182</fpage>&#8211;<lpage>192</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.2307/2992540" ns0:type="simple">10.2307/2992540</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref007">
<label>7</label>
<mixed-citation publication-type="book" ns0:type="simple">
<name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <source>Computational phylogenetics: An introduction to designing methods for phylogeny estimation</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2017</year>.</mixed-citation>
</ref>
<ref id="pone.0221068.ref008">
<label>8</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Price</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Dehal</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name>. <article-title>FastTree 2&#8212;Approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS ONE</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0009490" ns0:type="simple">10.1371/journal.pone.0009490</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref009">
<label>9</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <article-title>PASTA: Ultra-Large Multiple Sequence Alignment for Nucleotide and Amino-Acid Sequences</article-title>. <source>Journal of Computational Biology</source>. <year>2015</year>;<volume>22</volume>(<issue>05</issue>):<fpage>377</fpage>&#8211;<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1089/cmb.2014.0156" ns0:type="simple">10.1089/cmb.2014.0156</ext-link></comment> <object-id pub-id-type="pmid">25549288</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref010">
<label>10</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Nguyen</surname> <given-names>NPDNpD</given-names></name>, <name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <article-title>Ultra-large alignments using phylogeny-aware profiles</article-title>. <source>Genome Biology</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>124</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/s13059-015-0688-z" ns0:type="simple">10.1186/s13059-015-0688-z</ext-link></comment> <object-id pub-id-type="pmid">26076734</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref011">
<label>11</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Enright</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Van Dongen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ouzounis</surname> <given-names>CA</given-names></name>. <article-title>An efficient algorithm for large-scale detection of protein families</article-title>. <source>Nucleic acids research</source>. <year>2002</year>;<volume>30</volume>(<issue>7</issue>):<fpage>1575</fpage>&#8211;<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/nar/30.7.1575" ns0:type="simple">10.1093/nar/30.7.1575</ext-link></comment> <object-id pub-id-type="pmid">11917018</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref012">
<label>12</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stoeckert</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Roos</surname> <given-names>DS</given-names></name>. <article-title>OrthoMCL: Identification of Ortholog Groups for Eukaryotic Genomes</article-title>. <source>Genome Research</source>. <year>2003</year>;<volume>13</volume>(<issue>9</issue>):<fpage>2178</fpage>&#8211;<lpage>2189</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1101/gr.1224503" ns0:type="simple">10.1101/gr.1224503</ext-link></comment> <object-id pub-id-type="pmid">12952885</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref013">
<label>13</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Steinegger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>S&#246;ding</surname> <given-names>J</given-names></name>. <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nature Biotechnology</source>. <year>2017</year>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/nbt.3988" ns0:type="simple">10.1038/nbt.3988</ext-link></comment> <object-id pub-id-type="pmid">29035372</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref014">
<label>14</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Nguyen</surname> <given-names>NP</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pop</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>B</given-names></name>. <article-title>A perspective on 16S rRNA operational taxonomic unit clustering using sequence similarity</article-title>. <source>npj Biofilms and Microbiomes</source>. <year>2016</year>;<volume>2</volume>:<fpage>16004</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/npjbiofilms.2016.4" ns0:type="simple">10.1038/npjbiofilms.2016.4</ext-link></comment> <object-id pub-id-type="pmid">28721243</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref015">
<label>15</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Ragonnet-Cronin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hodcroft</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hu&#233;</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fearnhill</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Delpech</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>AJL</given-names></name>, <etal>et al</etal>. <article-title>Automated analysis of phylogenetic clusters</article-title>. <source>BMC bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>317</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/1471-2105-14-317" ns0:type="simple">10.1186/1471-2105-14-317</ext-link></comment> <object-id pub-id-type="pmid">24191891</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref016">
<label>16</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Mai</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Sayyari</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>. <article-title>Minimum variance rooting of phylogenetic trees and implications for species tree reconstruction</article-title>. <source>PLOS ONE</source>. <year>2017</year>;<volume>12</volume>(<issue>8</issue>):<fpage>e0182238</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0182238" ns0:type="simple">10.1371/journal.pone.0182238</ext-link></comment> <object-id pub-id-type="pmid">28800608</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref017">
<label>17</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Parley</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hedetniemi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Proskurowski</surname> <given-names>A</given-names></name>. <article-title>Partitioning trees: Matching, domination, and maximum diameter</article-title>. <source>International Journal of Computer &amp; Information Sciences</source>. <year>1981</year>;<volume>10</volume>(<issue>1</issue>):<fpage>55</fpage>&#8211;<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1007/BF00978378" ns0:type="simple">10.1007/BF00978378</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref018">
<label>18</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Kundu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Misra</surname> <given-names>J</given-names></name>. <article-title>A Linear Tree Partitioning Algorithm</article-title>. <source>SIAM Journal on Computing</source>. <year>1977</year>;<volume>6</volume>(<issue>1</issue>):<fpage>151</fpage>&#8211;<lpage>154</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1137/0206012" ns0:type="simple">10.1137/0206012</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref019">
<label>19</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Tavar&#233;</surname> <given-names>S</given-names></name>. <article-title>Some Probabilistic and Statistical Problems in the Analysis of DNA Sequences</article-title>. <source>Lectures on Mathematics in the Life Sciences</source>. <year>1986</year>;<volume>17</volume>:<fpage>57</fpage>&#8211;<lpage>86</lpage>.</mixed-citation>
</ref>
<ref id="pone.0221068.ref020">
<label>20</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Kluge</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Farris</surname> <given-names>JS</given-names></name>. <article-title>Quantitative Phyletics and the Evolution of Anurans</article-title>. <source>Systematic Biology</source>. <year>1969</year>;<volume>18</volume>(<issue>1</issue>):<fpage>1</fpage>&#8211;<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/sysbio/18.1.1" ns0:type="simple">10.1093/sysbio/18.1.1</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref021">
<label>21</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Farris</surname> <given-names>JS</given-names></name>. <article-title>Estimating Phylogenetic Trees from Distance Matrices</article-title>. <source>The American Naturalist</source>. <year>1972</year>;<volume>106</volume>(<issue>951</issue>):<fpage>645</fpage>&#8211;<lpage>668</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1086/282802" ns0:type="simple">10.1086/282802</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref022">
<label>22</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Zheng</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Bartow-McKenney</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Meisel</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Grice</surname> <given-names>EA</given-names></name>. <article-title>HmmUFOtu: An HMM and phylogenetic placement based ultra-fast taxonomic assignment and OTU picking tool for microbiome amplicon sequencing studies</article-title>. <source>Genome Biology</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>82</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/s13059-018-1450-0" ns0:type="simple">10.1186/s13059-018-1450-0</ext-link></comment> <object-id pub-id-type="pmid">29950165</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref023">
<label>23</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Moshiri</surname> <given-names>N</given-names></name>. <article-title>TreeSwift: a massively scalable Python tree package</article-title>. <source>bioRxiv</source>. <year>2018</year>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1101/325522" ns0:type="simple">10.1101/325522</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref024">
<label>24</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Schloss</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Westcott</surname> <given-names>SL</given-names></name>. <article-title>Assessing and Improving Methods Used in Operational Taxonomic Unit-Based Approaches for 16S rRNA Gene Sequence Analysis</article-title>. <source>Applied and Environmental Microbiology</source>. <year>2011</year>;<volume>77</volume>(<issue>10</issue>):<fpage>3219</fpage>&#8211;<lpage>3226</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1128/AEM.02810-10" ns0:type="simple">10.1128/AEM.02810-10</ext-link></comment> <object-id pub-id-type="pmid">21421784</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref025">
<label>25</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhao</surname> <given-names>H</given-names></name>. <article-title>A Comparison of Methods for Clustering 16S rRNA Sequences into OTUs</article-title>. <source>PLoS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>8</issue>):<fpage>e70837</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0070837" ns0:type="simple">10.1371/journal.pone.0070837</ext-link></comment> <object-id pub-id-type="pmid">23967117</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref026">
<label>26</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Quast</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pruesse</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yilmaz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gerken</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schweer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yarza</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The SILVA ribosomal RNA gene database project: improved data processing and web-based tools</article-title>. <source>Nucleic acids research</source>. <year>2012</year>; p. gks1219. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/nar/gks1219" ns0:type="simple">10.1093/nar/gks1219</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref027">
<label>27</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Maidak</surname> <given-names>BL</given-names></name>. <article-title>The RDP-II (Ribosomal Database Project)</article-title>. <source>Nucleic Acids Research</source>. <year>2001</year>;<volume>29</volume>(<issue>1</issue>):<fpage>173</fpage>&#8211;<lpage>174</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/nar/29.1.173" ns0:type="simple">10.1093/nar/29.1.173</ext-link></comment> <object-id pub-id-type="pmid">11125082</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref028">
<label>28</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>DeSantis</surname> <given-names>TZ</given-names></name>, <name name-style="western"><surname>Hugenholtz</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Larsen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rojas</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Brodie</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Greengenes, a Chimera-Checked 16S rRNA Gene Database and Workbench Compatible with ARB</article-title>. <source>Appl Environ Microbiol</source>. <year>2006</year>;<volume>72</volume>(<issue>7</issue>):<fpage>5069</fpage>&#8211;<lpage>5072</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1128/AEM.03006-05" ns0:type="simple">10.1128/AEM.03006-05</ext-link></comment> <object-id pub-id-type="pmid">16820507</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref029">
<label>29</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Gonzalez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Navas-Molina</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Kosciolek</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McDonald</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>V&#225;zquez-Baeza</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ackermann</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Qiita: rapid, web-enabled microbiome meta-analysis</article-title>. <source>Nature Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>10</issue>):<fpage>796</fpage>&#8211;<lpage>798</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/s41592-018-0141-9" ns0:type="simple">10.1038/s41592-018-0141-9</ext-link></comment> <object-id pub-id-type="pmid">30275573</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref030">
<label>30</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Amir</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>McDonald</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Navas-Molina</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Kopylova</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Morton</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Zech Xu</surname> <given-names>Z</given-names></name>, <etal>et al</etal>. <article-title>Deblur Rapidly Resolves Single-Nucleotide Community Sequence Patterns</article-title>. <source>mSystems</source>. <year>2017</year>;<volume>2</volume>(<issue>2</issue>). <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1128/mSystems.00191-16" ns0:type="simple">10.1128/mSystems.00191-16</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref031">
<label>31</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Callahan</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>McMurdie</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Rosen</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Han</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>AJA</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>SP</given-names></name>. <article-title>DADA2: High-resolution sample inference from Illumina amplicon data</article-title>. <source>Nature Methods</source>. <year>2016</year>;<volume>13</volume>:<fpage>581</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/nmeth.3869" ns0:type="simple">10.1038/nmeth.3869</ext-link></comment> <object-id pub-id-type="pmid">27214047</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref032">
<label>32</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>UNOISE2: improved error-correction for Illumina 16S and ITS amplicon sequencing</article-title>. <source>bioRxiv</source>. <year>2016</year>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1101/081257" ns0:type="simple">10.1101/081257</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref033">
<label>33</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Cai</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>Y</given-names></name>. <article-title>ESPRIT-Tree: hierarchical clustering analysis of millions of 16S rRNA pyrosequences in quasilinear computational time</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>;<volume>39</volume>(<issue>14</issue>):<fpage>e95</fpage>&#8211;<lpage>e95</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/nar/gkr349" ns0:type="simple">10.1093/nar/gkr349</ext-link></comment> <object-id pub-id-type="pmid">21596775</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref034">
<label>34</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Godzik</surname> <given-names>A</given-names></name>. <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>&#8211;<lpage>1659</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btl158" ns0:type="simple">10.1093/bioinformatics/btl158</ext-link></comment> <object-id pub-id-type="pmid">16731699</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref035">
<label>35</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Sagulenko</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Puller</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Neher</surname> <given-names>RA</given-names></name>. <article-title>TreeTime: Maximum-likelihood phylodynamic analysis</article-title>. <source>Virus Evolution</source>. <year>2018</year>;<volume>4</volume>(<issue>1</issue>):<fpage>1</fpage>&#8211;<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/ve/vex042" ns0:type="simple">10.1093/ve/vex042</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref036">
<label>36</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>. <article-title>RAxML version 8: A tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>9</issue>):<fpage>1312</fpage>&#8211;<lpage>1313</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btu033" ns0:type="simple">10.1093/bioinformatics/btu033</ext-link></comment> <object-id pub-id-type="pmid">24451623</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref037">
<label>37</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Leitner</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Escanilla</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Franzen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Uhlen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Albert</surname> <given-names>J</given-names></name>. <article-title>Accurate reconstruction of a known HIV-1 transmission history by phylogenetic tree analysis</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1996</year>;<volume>93</volume>(<issue>20</issue>):<fpage>10864</fpage>&#8211;<lpage>10869</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1073/pnas.93.20.10864" ns0:type="simple">10.1073/pnas.93.20.10864</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref038">
<label>38</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Aldous</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Pond</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Poon</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jain</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kahn</surname> <given-names>JS</given-names></name>, <etal>et al</etal>. <article-title>Characterizing HIV transmission networks across the United States</article-title>. <source>Clinical infectious diseases: an official publication of the Infectious Diseases Society of America</source>. <year>2012</year>;<volume>55</volume>(<issue>8</issue>):<fpage>1135</fpage>&#8211;<lpage>43</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/cid/cis612" ns0:type="simple">10.1093/cid/cis612</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref039">
<label>39</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Hu&#233;</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Clewley</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Cane</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Pillay</surname> <given-names>D</given-names></name>. <article-title>HIV-1 pol gene variation is sufficient for reconstruction of transmissions in the era of antiretroviral therapy</article-title>. <source>AIDS (London, England)</source>. <year>2004</year>;<volume>18</volume>(<issue>5</issue>):<fpage>719</fpage>&#8211;<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1097/00002030-200403260-00002" ns0:type="simple">10.1097/00002030-200403260-00002</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref040">
<label>40</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Hughes</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Fearnhill</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dunn</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lycett</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Rambaut</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Leigh Brown</surname> <given-names>AJ</given-names></name>, <etal>et al</etal>. <article-title>Molecular phylodynamics of the heterosexual HIV epidemic in the United Kingdom</article-title>. <source>PLoS pathogens</source>. <year>2009</year>;<volume>5</volume>(<issue>9</issue>):<fpage>e1000590</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.ppat.1000590" ns0:type="simple">10.1371/journal.ppat.1000590</ext-link></comment> <object-id pub-id-type="pmid">19779560</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref041">
<label>41</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Leigh Brown</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Lycett</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Weinert</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hughes</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Fearnhill</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dunn</surname> <given-names>DT</given-names></name>. <article-title>Transmission network parameters estimated from HIV sequences for a nationwide epidemic</article-title>. <source>Journal of Infectious Diseases</source>. <year>2011</year>;<volume>204</volume>(<issue>9</issue>):<fpage>1463</fpage>&#8211;<lpage>1469</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/infdis/jir550" ns0:type="simple">10.1093/infdis/jir550</ext-link></comment> <object-id pub-id-type="pmid">21921202</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref042">
<label>42</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Mehta</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Kosakovsky Pond</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Richman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Little</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>DM</given-names></name>. <article-title>Associations between phylogenetic clustering and HLA profile among HIV-infected individuals in San Diego, California</article-title>. <source>Journal of Infectious Diseases</source>. <year>2012</year>;<volume>205</volume>(<issue>10</issue>):<fpage>1529</fpage>&#8211;<lpage>1533</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/infdis/jis231" ns0:type="simple">10.1093/infdis/jis231</ext-link></comment> <object-id pub-id-type="pmid">22448013</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref043">
<label>43</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Eshleman</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Hudelson</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Redd</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Debes</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>YQ</given-names></name>, <etal>et al</etal>. <article-title>Analysis of genetic linkage of HIV from couples enrolled in the HIV prevention trials network 052 trial</article-title>. <source>Journal of Infectious Diseases</source>. <year>2011</year>;<volume>204</volume>(<issue>12</issue>):<fpage>1918</fpage>&#8211;<lpage>1926</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/infdis/jir651" ns0:type="simple">10.1093/infdis/jir651</ext-link></comment> <object-id pub-id-type="pmid">21990420</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref044">
<label>44</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Hu&#233;</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Ragonnet-Cronin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lycett</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dunn</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Fearnhill</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Phylogenetic analyses reveal HIV-1 infections between men misclassified as heterosexual transmissions</article-title>. <source>Aids</source>. <year>2014</year>;<volume>28</volume>(<issue>13</issue>):<fpage>1967</fpage>&#8211;<lpage>1975</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1097/QAD.0000000000000383" ns0:type="simple">10.1097/QAD.0000000000000383</ext-link></comment> <object-id pub-id-type="pmid">24991999</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref045">
<label>45</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bezemer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Cori</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ratmann</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>van Sighem</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hermanides</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Dutilh</surname> <given-names>BE</given-names></name>, <etal>et al</etal>. <article-title>Dispersion of the HIV-1 Epidemic in Men Who Have Sex with Men in the Netherlands: A Combined Mathematical Model and Phylogenetic Analysis</article-title>. <source>PLoS Medicine</source>. <year>2015</year>;<volume>12</volume>(<issue>11</issue>):<fpage>e1001898</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pmed.1001898" ns0:type="simple">10.1371/journal.pmed.1001898</ext-link></comment> <object-id pub-id-type="pmid">26529093</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref046">
<label>46</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Wertheim</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Murrell</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mehta</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Forgione</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Kosakovsky Pond</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>DM</given-names></name>, <etal>et al</etal>. <article-title>Growth of HIV-1 Molecular Transmission Clusters in New York City</article-title>. <source>The Journal of Infectious Diseases</source>. <year>2018</year> <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/infdis/jiy431" ns0:type="simple">10.1093/infdis/jiy431</ext-link></comment> <object-id pub-id-type="pmid">30010850</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref047">
<label>47</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Tamura</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Nei</surname> <given-names>M</given-names></name>. <article-title>Estimation of the Number of Nucleotide Substitutions in the Control Region of Mitochondrial-DNA in Humans and Chimpanzees</article-title>. <source>Molecular biology and evolution</source>. <year>1993</year>;<volume>10</volume>(<issue>3</issue>):<fpage>512</fpage>&#8211;<lpage>526</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/oxfordjournals.molbev.a040023" ns0:type="simple">10.1093/oxfordjournals.molbev.a040023</ext-link></comment> <object-id pub-id-type="pmid">8336541</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref048">
<label>48</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Moshiri</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ragonnet-Cronin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wertheim</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>. <article-title>FAVITES: simultaneous simulation of transmission networks, phylogenetic trees and sequences</article-title>. <source>Bioinformatics</source>. <year>2018</year>; p. bty921. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/bty921" ns0:type="simple">10.1093/bioinformatics/bty921</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref049">
<label>49</label>
<mixed-citation publication-type="other" ns0:type="simple">Mai U, Mirarab S. TreeShrink: Efficient Detection of Outlier Tree Leaves. In: Meidanis J, Nakhleh L, editors. Comparative Genomics: 15th International Workshop, RECOMB CG 2017, Barcelona, Spain, October 4-6, 2017, Proceedings. Cham: Springer International Publishing; 2017. p. 116&#8211;140. Available from: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1007/978-3-319-67979-2_7" ns0:type="simple">https://doi.org/10.1007/978-3-319-67979-2_7</ext-link>.</mixed-citation>
</ref>
<ref id="pone.0221068.ref050">
<label>50</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Raghavan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nelesen</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Linder</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <article-title>Rapid and Accurate Large-Scale Coestimation of Sequence Alignments and Phylogenetic Trees</article-title>. <source>Science</source>. <year>2009</year>;<volume>324</volume>(<issue>5934</issue>):<fpage>1561</fpage>&#8211;<lpage>1564</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1126/science.1171243" ns0:type="simple">10.1126/science.1171243</ext-link></comment> <object-id pub-id-type="pmid">19541996</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref051">
<label>51</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Holder</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Nelesen</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stamatakis</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>SATe-II: Very Fast and Accurate Simultaneous Estimation of Multiple Sequence Alignments and Phylogenetic Trees</article-title>. <source>Systematic Biology</source>. <year>2011</year>;<volume>61</volume>(<issue>1</issue>):<fpage>90</fpage>&#8211;<lpage>106</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/sysbio/syr095" ns0:type="simple">10.1093/sysbio/syr095</ext-link></comment> <object-id pub-id-type="pmid">22139466</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref052">
<label>52</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <article-title>PASTA: ultra-large multiple sequence alignment for nucleotide and amino-acid sequences</article-title>. <source>Journal of Computational Biology</source>. <year>2015</year>;<volume>22</volume>(<issue>5</issue>):<fpage>377</fpage>&#8211;<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1089/cmb.2014.0156" ns0:type="simple">10.1089/cmb.2014.0156</ext-link></comment> <object-id pub-id-type="pmid">25549288</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref053">
<label>53</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>A new generation of homology search tools based on probabilistic inference</article-title>. <source>Genome Inform</source>. <year>2009</year>;<volume>23</volume>(<issue>1</issue>):<fpage>205</fpage>&#8211;<lpage>211</lpage>. <object-id pub-id-type="pmid">20180275</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref054">
<label>54</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Toh</surname> <given-names>H</given-names></name>. <article-title>Recent developments in the MAFFT multiple sequence alignment program</article-title>. <source>Brief Bioinform</source>. <year>2008</year>;<volume>9</volume>(<issue>4</issue>):<fpage>286</fpage>&#8211;<lpage>298</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bib/bbn013" ns0:type="simple">10.1093/bib/bbn013</ext-link></comment> <object-id pub-id-type="pmid">18372315</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref055">
<label>55</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Wheeler</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Kececioglu</surname> <given-names>JD</given-names></name>. <article-title>Multiple alignment by aligning alignments</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>13</issue>):<fpage>559</fpage>&#8211;<lpage>568</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btm226" ns0:type="simple">10.1093/bioinformatics/btm226</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0221068.ref056">
<label>56</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Sievers</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Dineen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wilm</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Higgins</surname> <given-names>DG</given-names></name>. <article-title>Making automated multiple alignments of very large numbers of protein sequences</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>8</issue>):<fpage>989</fpage>&#8211;<lpage>995</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btt093" ns0:type="simple">10.1093/bioinformatics/btt093</ext-link></comment> <object-id pub-id-type="pmid">23428640</object-id></mixed-citation>
</ref>
<ref id="pone.0221068.ref057">
<label>57</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <article-title>FastSP: linear time calculation of alignment accuracy</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>(<issue>23</issue>):<fpage>3250</fpage>&#8211;<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btr553" ns0:type="simple">10.1093/bioinformatics/btr553</ext-link></comment> <object-id pub-id-type="pmid">21984754</object-id></mixed-citation>
</ref>
</ref-list>
</back>
<sub-article article-type="author-comment" id="pone.0221068.r001" specific-use="rebutted-decision-letter-unavailable">
<front-stub>
<article-id pub-id-type="doi">10.1371/journal.pone.0221068.r001</article-id>
<title-group>
<article-title>Author response to previous submission</article-title>
</title-group>
<custom-meta-group>
<custom-meta>
<meta-name>Submission Version</meta-name>
<meta-value>0</meta-value>
</custom-meta>
</custom-meta-group>
</front-stub>
<body>
<p>
<named-content content-type="author-response-date">26 May 2019</named-content>
</p>
<supplementary-material id="pone.0221068.s005" mimetype="application/pdf" position="float" ns0:href="info:doi/10.1371/journal.pone.0221068.s005" ns0:type="simple">
<label>Attachment</label>
<caption>
<p>Submitted filename: <named-content content-type="submitted-filename">plosone revision.pdf</named-content></p>
</caption>
</supplementary-material>
</body>
</sub-article>
<sub-article article-type="aggregated-review-documents" id="pone.0221068.r002" specific-use="decision-letter">
<front-stub>
<article-id pub-id-type="doi">10.1371/journal.pone.0221068.r002</article-id>
<title-group>
<article-title>Decision Letter 0</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name name-style="western">
<surname>Bozdag</surname>
<given-names>Serdar</given-names>
</name>
<role>Academic Editor</role>
</contrib>
</contrib-group>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Serdar Bozdag</copyright-holder>
<license ns0:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<related-object document-id="10.1371/journal.pone.0221068" document-id-type="doi" document-type="article" id="rel-obj002" link-type="peer-reviewed-article" />
<custom-meta-group>
<custom-meta>
<meta-name>Submission Version</meta-name>
<meta-value>0</meta-value>
</custom-meta>
</custom-meta-group>
</front-stub>
<body>
<p>
<named-content content-type="letter-date">30 Jul 2019</named-content>
</p>
<p>TreeCluster: clustering biological sequences using phylogenetic trees</p>
<p>PONE-D-19-14871</p>
<p>Dear Dr. Balaban,</p>
<p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
<p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
<p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" ns0:href="https://www.editorialmanager.com/pone/" ns0:type="simple">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email ns0:type="simple">authorbilling@plos.org</email>.</p>
<p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email ns0:type="simple">onepress@plos.org</email>.</p>
<p>With kind regards,</p>
<p>Serdar Bozdag, Ph.D.</p>
<p>Academic Editor</p>
<p>PLOS ONE</p>
<p>Reviewers' comments:</p>
<p>Reviewer's Responses to Questions</p>
<p><bold>Comments to the Author</bold></p>
<p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
<p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
<p>Reviewer #1: Yes</p>
<p>Reviewer #2: Yes</p>
<p>**********</p>
<p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
<p>Reviewer #1: N/A</p>
<p>Reviewer #2: N/A</p>
<p>**********</p>
<p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
<p>The <ext-link ext-link-type="uri" ns0:href="http://www.plosone.org/static/policies.action#sharing" ns0:type="simple">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#8212;e.g. participant privacy or use of data from a third party&#8212;those must be specified.</p>
<p>Reviewer #1: Yes</p>
<p>Reviewer #2: Yes</p>
<p>**********</p>
<p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
<p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
<p>Reviewer #1: Yes</p>
<p>Reviewer #2: Yes</p>
<p>**********</p>
<p>5. Review Comments to the Author</p>
<p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
<p>Reviewer #1: This manuscript has been corrected since the original GLBIO submission, and still presents a well-reasoned and justified family of methods.</p>
<p>Reviewer #2: The authors considers three versions of clustering sequences based on phylogenies. As they rightly observe, similar problems have been considered in TCS context before, but somehow not used in bioinformatics.</p>
<p>It is good to see that all the problems have linear or near-linear time solutions, although the algorithms themselves use relatively standard algorithmic techniques. The authors also experimentally evaluate their approach in three contexts. I think the results are of sufficient interest for publication in this journal.</p>
<p>**********</p>
<p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" ns0:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ns0:type="simple">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
<p>If you choose &#8220;no&#8221;, your identity will remain anonymous but your review may still be made public.</p>
<p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" ns0:href="https://www.plos.org/privacy-policy" ns0:type="simple">Privacy Policy</ext-link>.</p>
<p>Reviewer #1: No</p>
<p>Reviewer #2: No</p>
</body>
</sub-article>
<sub-article article-type="editor-report" id="pone.0221068.r003" specific-use="acceptance-letter">
<front-stub>
<article-id pub-id-type="doi">10.1371/journal.pone.0221068.r003</article-id>
<title-group>
<article-title>Acceptance letter</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name name-style="western">
<surname>Bozdag</surname>
<given-names>Serdar</given-names>
</name>
<role>Academic Editor</role>
</contrib>
</contrib-group>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Serdar Bozdag</copyright-holder>
<license ns0:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<related-object document-id="10.1371/journal.pone.0221068" document-id-type="doi" document-type="article" id="rel-obj003" link-type="peer-reviewed-article" />
</front-stub>
<body>
<p>
<named-content content-type="letter-date">9 Aug 2019</named-content>
</p>
<p>PONE-D-19-14918R1 </p>
<p>TreeCluster: clustering biological sequences using phylogenetic trees </p>
<p>Dear Dr. Balaban:</p>
<p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
<p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email ns0:type="simple">onepress@plos.org</email>.</p>
<p>For any other questions or concerns, please email <email ns0:type="simple">plosone@plos.org</email>. </p>
<p>Thank you for submitting your work to PLOS ONE.</p>
<p>With kind regards,</p>
<p>PLOS ONE Editorial Office Staff</p>
<p>on behalf of</p>
<p>Dr. Serdar Bozdag  </p>
<p>Academic Editor</p>
<p>PLOS ONE</p>
</body>
</sub-article>
</article>