<article xmlns:ns0="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-19-16058</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0222271</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Metagenomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Viral genomics</subject><subj-group><subject>Viral genome</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Viral genomics</subject><subj-group><subject>Viral genome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Virology</subject><subj-group><subject>Viral genomics</subject><subj-group><subject>Viral genome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>BLAST algorithm</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>DNA filter assay</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Molecular biology assays and analysis techniques</subject><subj-group><subject>DNA filter assay</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>DNA sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Artificial intelligence</subject><subj-group><subject>Machine learning</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>ViraMiner: Deep learning on raw DNA sequences for identifying viral genomes in human samples</article-title>
<alt-title alt-title-type="running-head">ViraMiner: Deep learning on raw DNA sequences for identifying viral genomes in human samples</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" ns0:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2120-1712</contrib-id>
<name name-style="western">
<surname>Tampuu</surname> <given-names>Ardi</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; original draft</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" ns0:type="simple">
<name name-style="western">
<surname>Bzhalava</surname> <given-names>Zurab</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; original draft</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" ns0:type="simple">
<name name-style="western">
<surname>Dillner</surname> <given-names>Joakim</given-names></name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" ns0:type="simple">
<name name-style="western">
<surname>Vicente</surname> <given-names>Raul</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing &#8211; original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Computational Neuroscience Lab, Institute of Computer Science, University of Tartu, Tartu, Estonia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Laboratory Medicine, Karolinska Institutet, Stockholm, Sweden</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Karolinska University Laboratory, Karolinska University Hospital, Stockholm, Sweden</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" ns0:type="simple">
<name name-style="western">
<surname>Melcher</surname> <given-names>Ulrich</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1" />
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Oklahoma State University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email ns0:type="simple">raul.vicente.zafra@ut.ee</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>11</day>
<month>9</month>
<year>2019</year>
</pub-date>
<volume>14</volume>
<issue>9</issue>
<elocation-id>e0222271</elocation-id>
<history>
<date date-type="received">
<day>7</day>
<month>6</month>
<year>2019</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>8</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Tampuu et al</copyright-holder>
<license ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" ns0:href="info:doi/10.1371/journal.pone.0222271" />
<abstract>
<p>Despite its clinical importance, detection of highly divergent or yet unknown viruses is a major challenge. When human samples are sequenced, conventional alignments classify many assembled contigs as &#8220;unknown&#8221; since many of the sequences are not similar to known genomes. In this work, we developed ViraMiner, a deep learning-based method to identify viruses in various human biospecimens. ViraMiner contains two branches of Convolutional Neural Networks designed to detect both patterns and pattern-frequencies on raw metagenomics contigs. The training dataset included sequences obtained from 19 metagenomic experiments which were analyzed and labeled by BLAST. The model achieves significantly improved accuracy compared to other machine learning methods for viral genome classification. Using 300 bp contigs ViraMiner achieves 0.923 area under the ROC curve. To our knowledge, this is the first machine learning methodology that can detect the presence of viral sequences among raw metagenomic contigs from diverse human samples. We suggest that the proposed model captures different types of information of genome composition, and can be used as a recommendation system to further investigate sequences labeled as &#8220;unknown&#8221; by conventional alignment methods. Exploring these highly-divergent viruses, in turn, can enhance our knowledge of infectious causes of diseases.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002301</institution-id>
<institution>Eesti Teadusagentuur</institution>
</institution-wrap>
</funding-source>
<award-id>PUT 1476</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Vicente</surname> <given-names>Raul</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Estonian Center of Excellence in IT</institution>
</funding-source>
<award-id>TK148</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Vicente</surname> <given-names>Raul</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001729</institution-id>
<institution>Stiftelsen f&#246;r Strategisk Forskning</institution>
</institution-wrap>
</funding-source>
<award-id>RB13-0011</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Dillner</surname> <given-names>Joakim</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004785</institution-id>
<institution>NordForsk</institution>
</institution-wrap>
</funding-source>
<award-id>62721</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Dillner</surname> <given-names>Joakim</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004359</institution-id>
<institution>Vetenskapsr&#229;det</institution>
</institution-wrap>
</funding-source>
<award-id>2017-01841_3</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Dillner</surname> <given-names>Joakim</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>ZB and JD were supported by three sources: 1) awarded to JD: Swedish Foundation for Strategic Research, Proj. no RB13-0011, <ext-link ext-link-type="uri" ns0:href="https://strategiska.se/en/" ns0:type="simple">https://strategiska.se/en/</ext-link>; 2) awarded to JD: NordForsk, Proj no 62721, <ext-link ext-link-type="uri" ns0:href="https://www.nordforsk.org/en?set_language=en" ns0:type="simple">https://www.nordforsk.org/en?set_language=en</ext-link>; 3) awarded to JD: Swedish Research Council, Proj no 2017-01841_3, <ext-link ext-link-type="uri" ns0:href="https://www.vr.se/english.html" ns0:type="simple">https://www.vr.se/english.html</ext-link>. AT and RV were supported by Estonian Research Council, project number PUT 1476 (<ext-link ext-link-type="uri" ns0:href="https://www.etis.ee/Portal/Projects/Display/52ed4301-f2ef-4364-9770-397e31936f93?lang=ENG" ns0:type="simple">https://www.etis.ee/Portal/Projects/Display/52ed4301-f2ef-4364-9770-397e31936f93?lang=ENG</ext-link>) and Estonian Centre of Excellence in IT (EXCITE) project number TK148 (<ext-link ext-link-type="uri" ns0:href="https://www.etis.ee/Portal/Projects/Display/fd0aeffa-a7d3-4191-b468-0f44aa2847af?lang=ENG" ns0:type="simple">https://www.etis.ee/Portal/Projects/Display/fd0aeffa-a7d3-4191-b468-0f44aa2847af?lang=ENG</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6" />
<table-count count="1" />
<page-count count="17" />
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All necessary data files are available from the GitHub repository associated with this work: <ext-link ext-link-type="uri" ns0:href="https://github.com/NeuroCSUT/ViraMiner" ns0:type="simple">https://github.com/NeuroCSUT/ViraMiner</ext-link>. Also all code is available in there.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The human virome is the collection of all viruses that reside in and on the human body. Many different viruses are present in human samples and their composition appears to be different in diseased individuals [<xref ref-type="bibr" rid="pone.0222271.ref001">1</xref>, <xref ref-type="bibr" rid="pone.0222271.ref002">2</xref>]. Despite its clinical importance, its full impact on human health is not fully understood [<xref ref-type="bibr" rid="pone.0222271.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0222271.ref004">4</xref>] and the detection and classification of human viruses represents a major challenge.</p>
<p>Current metagenomic studies detect many novel viruses, which indicates that only a small part of human viruses has been discovered and many others are yet to be reported [<xref ref-type="bibr" rid="pone.0222271.ref005">5</xref>&#8211;<xref ref-type="bibr" rid="pone.0222271.ref010">10</xref>]. Studies report epidemiological indications that there may exist undiscovered pathogens. For example, there is correlative evidence suggesting that viruses may be involved in the development of autoimmune diseases such as diabetes [<xref ref-type="bibr" rid="pone.0222271.ref011">11</xref>] and multiple sclerosis [<xref ref-type="bibr" rid="pone.0222271.ref012">12</xref>].</p>
<p>Next Generation Sequencing (NGS) technologies provide a powerful tool to obtain directly the DNA sequences present in clinical samples without any prior knowledge of the biospecimens [<xref ref-type="bibr" rid="pone.0222271.ref013">13</xref>]. The term metagenomics implies complete sequencing and recovering of all non-human genetic material that might be present in a human sample and accordingly, analytical techniques for virus discovery are commonly applied to metagenomic samples [<xref ref-type="bibr" rid="pone.0222271.ref005">5</xref>, <xref ref-type="bibr" rid="pone.0222271.ref007">7</xref>, <xref ref-type="bibr" rid="pone.0222271.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0222271.ref014">14</xref>&#8211;<xref ref-type="bibr" rid="pone.0222271.ref019">19</xref>].</p>
<p>Currently, the detection of potential viral genomes in human biospecimens is usually performed by NCBI BLAST, which implements alignment-based classification where sequences are aligned to known genomes from public databases and then estimates how much similarity they share. However, metagenomic samples might contain a large number of highly divergent viruses that have no homologs at all among known genomes. As a consequence, many sequences generated from NGS technologies are classified as &#8220;unknown&#8221; by BLAST [<xref ref-type="bibr" rid="pone.0222271.ref005">5</xref>, <xref ref-type="bibr" rid="pone.0222271.ref018">18</xref>]. Another commonly used algorithm for viral discovery in metagenomic samples is HMMER3 [<xref ref-type="bibr" rid="pone.0222271.ref020">20</xref>], which applies profile Hidden Markov Models (pHMM) in relation to the vFams [<xref ref-type="bibr" rid="pone.0222271.ref021">21</xref>] database of viral family of proteins, that have been built by multiple sequence alignments from all viral proteins in RefSeq. With this method, sequences are compared to entire viral families which enables the algorithm to be more effective in detecting distant homologs [<xref ref-type="bibr" rid="pone.0222271.ref022">22</xref>]. However, this pipeline needs a reference database which is a drawback while conducting the analysis of identification of highly divergent viruses. A different approach consists of using machine learning techniques to learn from examples to classify viral genomes and to generalize to novel samples. In particular, several machine learning models for detecting viruses in metagenomic data have been already published [<xref ref-type="bibr" rid="pone.0222271.ref023">23</xref>&#8211;<xref ref-type="bibr" rid="pone.0222271.ref025">25</xref>], but none of them were trained nor tested to identify viruses in different human biospecimens.</p>
<p>In this study, we have developed ViraMiner, a methodology which uses Convolutional Neural Networks (CNN) on raw metagenomic contigs to identify potential viral sequences across different human samples. The architecture of ViraMiner builds on top of the CNN architecture of Ren [<xref ref-type="bibr" rid="pone.0222271.ref025">25</xref>], adding major extensions for it to be more effective on this particular classification problem. For training the model we used 19 metagenomic experiments originating from sample types such as skin, serum, and condylomata. The model achieves a significantly improved accuracy compared to other existing methods for virus identification in metagenomic samples. To our knowledge, the proposed model is the first methodology that can detect the presence of viruses on raw metagenomic contigs from various human biospecimens. A pre-trained model ready to be used is also publicly available on GitHub (<ext-link ext-link-type="uri" ns0:href="https://github.com/NeuroCSUT/ViraMiner" ns0:type="simple">https://github.com/NeuroCSUT/ViraMiner</ext-link>).</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>First we will describe the overall architecture of the proposed model (ViraMiner) for the detection of viral genomes from assembled metagenomic contigs (see <xref ref-type="sec" rid="sec014">Methods</xref> for a detailed description of the architecture, its inputs and outputs and details on training procedure). In the following sections, performance measures of the model and multiple baselines are reported. Finally, an evaluation of the model when applied to novel metagenomic experiments is given.</p>
<sec id="sec003">
<title><italic>ViraMiner</italic> architecture</title>
<p>In this work we developed ViraMiner, a CNN-based method for detecting viral contigs in human metagenomic datasets. As illustrated in <xref ref-type="fig" rid="pone.0222271.g001">Fig 1</xref>, ViraMiner receives a raw DNA sequence as input and outputs a single value that indicates the likelihood of this sequence being of viral origin. In ViraMiner we apply convolutional layers with learnable filters straight on the raw sequences. This way the model has access to all information and can learn by itself from labeled examples which features are important to extract (which information to keep). To maximize the model&#8217;s ability to extract relevant features, the ViraMiner model has two different convolutional branches (see <xref ref-type="fig" rid="pone.0222271.g001">Fig 1</xref>). Intuitively, one of the branches (pattern branch) returns how well certain patterns were maximally matched along the DNA sequence. In this branch the convolutional layer is followed by <italic>global max pooling</italic> that outputs only the maximal value for each convolutional filter. The other (frequency branch) returns information about pattern frequencies. In this branch the convolutional layer is followed by <italic>global average pooling</italic> that yields the average value for each convolutional filter. The outputs of these branches are merged and the output node is all-to-one connected (fully-connected) with them. Sigmoid activation function is applied in this node, transforming the weighted sum of inputs to a probability (into range [0, 1]).</p>
<fig id="pone.0222271.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0222271.g001</object-id>
<label>Fig 1</label>
<caption>
<title>ViraMiner architecture.</title>
<p>ViraMiner architecture takes as input the raw sequences in one-hot encoded form. The raw sequences are then processed by two different convolutional branches (pattern and frequency branch). The architecture of the branches is shown in detail in Methods and Material. The outputs of the branches (two 1D vectors) are concatenated. This concatenated vector is all-to-one connected (fully-connected) with the output node. The output node passes the weighted sum of its inputs through sigmoid activation function resulting in a value restricted to range [0, 1]. This value reflects the likelihood of the sequence belonging to virus class.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.g001" ns0:type="simple" />
</fig>
</sec>
<sec id="sec004">
<title>Identifying viral genomes in human samples</title>
<p>The proposed models were trained on metagenomic assembled contigs from 19 different experiments, which in turn were sequenced from different human sample types (serum, skin, condylomata, &#8230;). These contigs were combined, shuffled, and partitioned into training (80%), validation (10%), and testing (10%) sets. Models were trained using the training set and the best model was selected according to validation set performance (see &#8220;Hyperparameter search and testing&#8221; subsection in <xref ref-type="sec" rid="sec014">Methods</xref>). The test set was used only for the final evaluation of the best models.</p>
<p>The proposed architecture achieved outstanding test performance on this human metagenomic data. In <xref ref-type="fig" rid="pone.0222271.g002">Fig 2</xref> we show the Receiver Operating Characteristic (ROC) curve of the best ViraMiner model with an area under the curve (AUROC) of 0.923.</p>
<fig id="pone.0222271.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0222271.g002</object-id>
<label>Fig 2</label>
<caption>
<title>ROC curve of ViraMiner model on the testing dataset.</title>
<p>The blue line on the figure represents the performance of ViraMiner (AUROC: 0.923). For comparison, the green line depicts the performance of a random model.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.g002" ns0:type="simple" />
</fig>
<p>Given the huge class imbalance of this type of datasets (e.g. in the studied human metagenomics dataset there were only 2% of viral contigs) it is important to evaluate precision and recall measures for both classes separately. Overall measures are hardly informative&#8212;a trivial model classifying everything as non-virus would achieve 98% overall precision and 98% overall recall, but it would nevertheless be useless for detecting viral genomes. Thus, next we report the precision and recall of the virus class instead of global performance. Note also that to measure particular recall and precision values, one would need to establish a classification threshold. The higher the threshold is set, the higher the precision gets but at the expense of recall. On the other hand, setting a lower threshold would increase recall but decrease precision. <xref ref-type="fig" rid="pone.0222271.g003">Fig 3</xref> represents the tradeoff between precision and recall for the virus class. The dotted lines indicate that ViraMiner could achieve 90% precision with 32% recall. With a stricter threshold, one can obtain 95% precision and 24% recall. Inversely, if one wishes to increase recall and accept relatively more false positives, the model can reach 41% recall with 70% precision.</p>
<fig id="pone.0222271.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0222271.g003</object-id>
<label>Fig 3</label>
<caption>
<title>The trade-off between precision and recall for classifying viral genomes.</title>
<p>A genome is labeled as virus if the output value is higher than a certain threshold. The blue line represents the trade-off. The crossing point of the vertical and horizontal red dotted lines indicates that the model can achieve 90% precision with 32% recall.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.g003" ns0:type="simple" />
</fig>
</sec>
<sec id="sec005">
<title>Baselines comparison</title>
<sec id="sec006">
<title>Contributions of each CNN branch separately</title>
<p>The model training proceeds by training the Pattern and Frequency branches separately. Consequently, we can also report the performance of each branch alone. With hyperparameters selected to maximize area under the ROC curve (AUROC) on validation set, on test set the Pattern branch achieves AUROC 0.905. In the same conditions, the Frequency branch achieves a test AUROC of 0.917. This shows that the filters of each branch result in a relatively high accuracy despite their different pooling operations, and their combination results in an even higher AUROC score (0.923). The stepwise training of ViraMiner architecture is important to avoid overfitting. When optimizing altogether the 2 million parameters in a ViraMiner model at the same time (both branches trained simultaneously), the performance on test set decreases. The test AUROC of such end-to-end trained model is only 0.896.</p>
</sec>
<sec id="sec007">
<title>K-mer models</title>
<p>Most of the previous machine learning models for classifying metagenomic datasets are based on k-mer counting [<xref ref-type="bibr" rid="pone.0222271.ref024">24</xref>, <xref ref-type="bibr" rid="pone.0222271.ref026">26</xref>, <xref ref-type="bibr" rid="pone.0222271.ref027">27</xref>]. To compare against the performance of such methods, we also extracted k-mers from the investigated dataset and trained Random Forest (RF) classifiers on the extracted values, while keeping the same data partitioning as above. RF is a competitive machine learning algorithm for non-linearly separable classes and it has already been used on this type of datasets [<xref ref-type="bibr" rid="pone.0222271.ref023">23</xref>, <xref ref-type="bibr" rid="pone.0222271.ref028">28</xref>]. The best test performance with RF models was achieved with 6-mers and it produced test AUROC 0.875 (<xref ref-type="fig" rid="pone.0222271.g004">Fig 4</xref>). RF performances on 3- 4- 5- and 7-mers were 0.867, 0.872, 0.873, and 0.869 respectively (<xref ref-type="fig" rid="pone.0222271.g005">Fig 5</xref>).</p>
<fig id="pone.0222271.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0222271.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison with baseline models.</title>
<p>The blue line depicts the performance of ViraMiner (AUROC: 0.923); the red line corresponds to the best of Random Forest on k-mers models (using 6-mers); the brown line, shows RF performance on raw metagenomic contigs.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.g004" ns0:type="simple" />
</fig>
<fig id="pone.0222271.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0222271.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Performance comparison of models designed in this study.</title>
<p>Models based on k-mers (red bars) were trained using Random Forest and the best performance was achieved with 6-mers with test AUROC value 0.875. Convolutional Neural Networks (blue bars) use the raw sequence as input and outperform RF models. Pattern and Frequency branches yield performances above 0.9 AUROC. ViraMiner uses a combination of both branches and achieves the highest test AUROC value (0.923) out of all models.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.g005" ns0:type="simple" />
</fig>
<p>For completeness, we also trained a RF model on raw metagenomic contigs (one-hot encoded and flattened), that is the same input used to ViraMiner, and hence without the manual extraction of different k-mers counts. The test performance of such RF model was very close to a random model (AUROC: 0.573).</p>
<p>The overall comparison of test performances of models designed in this study is summarized in <xref ref-type="fig" rid="pone.0222271.g005">Fig 5</xref>.</p>
</sec>
<sec id="sec008">
<title>ViraMiner as a recommendation system</title>
<p>In here, we exemplify the use of ViraMiner a recommendation system. We apply the model to the entire test set and order the test sequences according to the likelihood of being viral returned by the model. We then see how many of the top N most likely sequences are indeed viral.</p>
<p>In particular, we compared Positive Predictive Value (PPV) of ViraMiner with PPV of the best RF (6-mer) model. Top 20 test set sequences most likely to be viruses according to both models were indeed viruses. However, there was a clear difference between confidence rates: confidence of ViraMiner for its top 20th virus was 99% while RF yielded only 67% for the corresponding 20th poisiton. For the top 200 sequences, ViraMiner achieved 88% PPV whereas RF reached 75%. Pattern and Frequency branches for the same number of top sequences output 79% and 83% PPVs respectively.</p>
</sec>
</sec>
<sec id="sec009">
<title>Generalization to unseen datasets</title>
<sec id="sec010">
<title>Performance on previously unseen sequencing experiments</title>
<p>In this section we describe the performance of the proposed model on novel metagenomic experiments. We retrain the model with the same hyperparameters as above (no new search is performed), but we remove one sequencing experiment completely from the train and validation sets and use it as the test set. Notice that the training procedure remains absolutely the same&#8212;we train the models (branches first, then the full model) until validation AUROC stops increasing. Afterwards, the model is applied to the test set&#8212;the left-out data originating from a novel sequencing experiment.</p>
<p>We repeat this leave-one-experiment-out procedure for all the 5 metagenomic datasets originating from serum sample type. In here, we selected to use serum type because among our datasets largest number of experiments and largest number of samples originate from this sample type. Thus, in total we train 5 ViraMiner models, each time leaving a different serum dataset out for testing. We do this to show how much the model&#8217;s generalization ability varies dataset to dataset. The test performances of these models are given in <xref ref-type="table" rid="pone.0222271.t001">Table 1</xref>. These results show that ViraMiner models generalize well to all 5 serum datasets.</p>
<table-wrap id="pone.0222271.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0222271.t001</object-id>
<label>Table 1</label>
<caption>
<title>ViraMiner performance on unseen serum metagenomic experiments.</title>
<p>The number of viral samples in these experiments varies from 22 to 732.</p>
</caption>
<alternatives>
<graphic id="pone.0222271.t001g" mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.t001" ns0:type="simple" />
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
<col align="left" valign="middle" />
</colgroup>
<thead>
<tr>
<th align="center">Left-out experiment</th>
<th align="center">2011_G5</th>
<th align="center">2014_G1</th>
<th align="center">2014_G5</th>
<th align="center">2014_G6</th>
<th align="center">2014_G7</th>
<th align="center">Micro-average</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">test AUROC</td>
<td align="center">0.95</td>
<td align="center">0.89</td>
<td align="center">0.96</td>
<td align="center">0.92</td>
<td align="center">0.86</td>
<td align="center">0.94</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>The ViraMiner model achieved good test performance on all 5 serum datasets, with AUROCs ranging from 0.86 to 0.96. To provide a unique measure, we merge the predictions for all five sets and redraw the ROC curve. The area under this micro-averaged ROC curve across the five test sets is 0.94.</p>
<p>We also investigated whether training a ViraMiner model on data originating from only serum metagenomic datasets would improve the performance compared to a model trained using a variety of metagenomic datasets (as above). For this purpose, we trained ViraMiner model on assembled contigs originating only from four serum experiments and tested on the 5th serum dataset. Again, we repeated the leave-out training procedure five times, so each dataset was left aside as test set once. With this reduced but more specific training set, the test area under micro-averaged ROC curve was 0.91. This is a noticeable decrease compared to 0.94 AUROC achieved when using all available training data. In our case using all available data points was useful even though many of these data points came from completely different sample types such as skin, cervix tissue, prostate secretion, etc.</p>
</sec>
<sec id="sec011">
<title>Performance on unseen viral class</title>
<p>In addition, we investigated whether ViraMiner is able to identify viruses from a viral class that it had not encountered during training. For this purpose, we trained and validated the ViraMiner model on a dataset where all anelloviruses were removed. We used the same hyperparameters (layer sizes) with the same step-wise training strategy&#8212;i.e. no new hyperparameter search was performed. The test set contained non-viral samples (26296 contigs) and the anelloviruses (1348 contigs). In this setting, from the model&#8217;s point of view anelloviruses are a completely unknown and unseen type of viruses.</p>
<p>On this test set, the frequency branch alone achieves the best result, with 0.755 AUROC. This is clearly above random performance and translates into getting 11 of the top 20 predictions correct on a test set with 5% prevalence. This means that even when dealing with viral sequences that are very distant from our training (and validation) samples, using ViraMiner as recommendation system strongly increases the chances of identifying viruses.</p>
</sec>
<sec id="sec012">
<title>Performance on simulated data</title>
<p>To confirm our model&#8217;s high efficiency is not due to unknown biases in our datasets, we also used data simulated with ART sequencing read simulator [<xref ref-type="bibr" rid="pone.0222271.ref029">29</xref>] (see <xref ref-type="sec" rid="sec014">Methods</xref> for simulation procedure and parameters). This resulted in slightly fewer sequences (210 000 vs 260 000) but a higher prevalence of viral sequences (roughly 10%).</p>
<p>First we tested the ViraMiner model trained on data from our 19 metagenomic experiments (trained on real data) on this simulated dataset. The resulting AUROC was 0.751. This performance is similar to what was reported in the previous subsection for unseen viral class. Indeed, simulated data contained samples from randomly selected viral species, including those not present in the real data (the training set).</p>
<p>Secondly, we also retrained the model on simulated data. As the amount of data was similar we used the exact same hyperparameters and training procedure. ViraMiner model was trained on 80% of the simulated data, validated on 10% and tested on 10%. The resulting test AUROC was 0.921, whereas the branches separately achieved 0.914 and 0.928 for pattern and frequency branch respectively. These results indicate that the methods (architecture, training procedure) perform equally well on simulated and real data.</p>
</sec>
</sec>
</sec>
<sec id="sec013" sec-type="conclusions">
<title>Discussion</title>
<p>In this work, we proposed ViraMiner, a CNN-based method to detect viruses in diverse human biospecimens. The tool includes two different branches of CNN: a Pattern branch with convolution+max operator and a Frequency branch with convolution+average operator.</p>
<p>Firstly, we trained the model on assembled metagenomic contigs originating from 19 metagenomic experiments which were merged and partitioned into training, validation and testing sets. The model achieves 0.923 test area under the ROC curve. This is a significant improvement compared to a previous tool ([<xref ref-type="bibr" rid="pone.0222271.ref028">28</xref>], reaching 0.79 AUROC) that was designed using relative synonymous codon usage (RSCU) and trained on data originating from the same metagenomic experiments. We are confident to conclude that using raw metagenomic contigs with CNN can extract much more information for the problem of viral classification. Furthermore, another advantage of ViraMiner is that a sequence is not required to have an Open Reading Frame (ORF) which is a central requirement for the models based on codon usage.</p>
<p>VirFinder and DeepVirFinder (DVF) are other similar tools available for detecting viruses in metagenomic sequencing datasets [<xref ref-type="bibr" rid="pone.0222271.ref024">24</xref>, <xref ref-type="bibr" rid="pone.0222271.ref025">25</xref>]. The former is based on k-mers while the latter applies CNN on raw DNA sequences. These tools, however, were specifically trained to identify viruses infecting prokaryotic organisms whereas we trained the model to detect any virus that might appear in multiple human samples. The architecture of ViraMiner builds on top of the CNN architecture of DeepVirFinder, adding major extensions for it to be more effective on this particular classification problem. Indeed, the newly introduced Frequency model separately performed better than the DVF architecture (referred to as Pattern model in Results). Considering these two studies, DVF and the present article, it is clear that such CNN architectures work very well on viral genome classification.</p>
<p>We also explored whether the proposed CNN architecture was able to extract more informative features from raw metagenomic contigs than to just count k-mers on them. We counted 3-,4-,5-,6- and 7-mers on the contigs, trained Random Forest and compared the results with our model. Since ViraMiner produced a higher accuracy (<xref ref-type="fig" rid="pone.0222271.g004">Fig 4</xref>) we can deduce that the architecture extracts more complex features of genome compositions that can detect patterns that cannot be identified with just counting k-mers.</p>
<p>The most important criteria that ViraMiner had to satisfy, however, was to generalize its classification abilities on completely new and unseen metagenomic experiments from which the model had not seen any data point. To this end, not only did we test ViraMiner on one specific experiment but also one specific sample type. In our dataset, the largest number (five) of experiments came from serum and therefore, we tested if the model could generalize on all these five experiments. ViraMiner was retrained five times with the same hyperparameters but each time data from one experiment was left out and used as the test set. The model produced slightly different test AUROC values for each of these datasets which gave an average 0.94 area under ROC curve.</p>
<p>The method&#8217;s predictive ability was also confirmed on simulated data and on a test dataset containing only viruses from an &#8220;unknown&#8221; viral family that was left out during training and validation. In these additional verification tasks, no hyper-parameter search was performed and the numeric results can probably be improved upon when optimizing for these tasks in particular.</p>
<p>Certainly, at this stage ViraMiner or other deep learning based methods cannot replace BLAST or HMMER3 partly because of the limited number of data points in the training dataset. However, it is important to note that ViraMiner does not have a database to rely on and must thus capture a different kind of information of genome composition than alignment based methods. Considering the results described above, the proposed method can be used as a recommendation system to further research &#8220;unknown&#8221; sequences labeled by the conventional methods among which highly divergent viruses may be hidden. Pre-trained models of ViraMiner are publicly available at <ext-link ext-link-type="uri" ns0:href="https://github.com/NeuroCSUT/ViraMiner" ns0:type="simple">https://github.com/NeuroCSUT/ViraMiner</ext-link>. We hope that this and future methods can discover biological attributes of viral genome to predict and reveal viruses, and in turn, help focus our exploration of infectious causes in diseases.</p>
</sec>
<sec id="sec014" sec-type="materials|methods">
<title>Methods and materials</title>
<sec id="sec015">
<title>Samples and sequencing types</title>
<p>The metagenomic sequences in this work were generated using Next Generation Sequencing platforms such as the NextSeq, Miseq, and HiSeq (Illumina) as described by the manufacturer. The dataset was derived from human samples belonging to different patient groups that have been described in detail in [<xref ref-type="bibr" rid="pone.0222271.ref006">6</xref>&#8211;<xref ref-type="bibr" rid="pone.0222271.ref008">8</xref>, <xref ref-type="bibr" rid="pone.0222271.ref030">30</xref>&#8211;<xref ref-type="bibr" rid="pone.0222271.ref032">32</xref>]. The goal of those analyses was to detect viral genomes or other microorganisms in diseased individuals or in their matched control subjects.</p>
</sec>
<sec id="sec016">
<title>Bioinformatics</title>
<p>All the sequencing experiments were processed and analyzed using a benchmarked bioinformatics workflow [<xref ref-type="bibr" rid="pone.0222271.ref033">33</xref>]. To summarize, we start analysis with quality checking where reads are filtered based on their Phred quality score. Afterwards, quality checked reads that align to human, bacterial, phage and vector DNA with &gt;95% identity over 75% of their length are subtracted from further analysis using BWA-MEM [<xref ref-type="bibr" rid="pone.0222271.ref034">34</xref>]. The reads that are left are normalized and then assembled using the IDBA-UD [<xref ref-type="bibr" rid="pone.0222271.ref035">35</xref>], Trinity [<xref ref-type="bibr" rid="pone.0222271.ref036">36</xref>], SOAPdenovo, and SOAPdenovo-Trans [<xref ref-type="bibr" rid="pone.0222271.ref037">37</xref>] assemblers. The assembled contigs are then subjected to taxonomic classification using BLAST. The code of the pipeline is available on GitHub (<ext-link ext-link-type="uri" ns0:href="https://github.com/NGSeq/ViraPipe" ns0:type="simple">https://github.com/NGSeq/ViraPipe</ext-link> and <ext-link ext-link-type="uri" ns0:href="https://github.com/NIASC/VirusMeta" ns0:type="simple">https://github.com/NIASC/VirusMeta</ext-link>).</p>
</sec>
<sec id="sec017">
<title>Data processing and labeling</title>
<p>The training dataset included 19 different NGS experiments that were analyzed and labeled by PCJ-BLAST [<xref ref-type="bibr" rid="pone.0222271.ref038">38</xref>] after applying the de novo genome assembly algorithms. Parameters for PCJ-BLAST were as follows: type of algorithm = Blastn; nucleotide match reward = 1; nucleotide mismatch penalty = 1; cost to open a gap = 0; cost to extend a gap = 2; e-value &#8804; e&#8722;4. All assembled contigs that were labeled by this bioinformatics workflow were merged to train several machine learning algorithms.</p>
<p>To extract input dataset for Convolutional Neural Networks, labeled sequences were divided into equal pieces (300bp and 500bp), each one of them was labeled as the original sequence and remaining nucleotides at the end of the contigs were removed from the further analysis. For example, according to this processing 650 bp viral contig would produce two equal 300bp viral sequences and the last 50 nucleotides would be removed from the input dataset. Initially, we generated two training datasets based on sequence lengths: first with 300bp and the second with 500bp. After noticing that 300bp contigs produced significantly better results we continued working only on this dataset and dropped the other. Furthermore, all contigs that contained even one &#8220;N&#8221; letter (reference to any nucleotide) were removed from the further analysis.</p>
<p>The most common genes found in the viral sequences in our metagenomic datasets are listed in <xref ref-type="supplementary-material" rid="pone.0222271.s001">S1 Table</xref>. The most common viral classes are listed in <xref ref-type="supplementary-material" rid="pone.0222271.s002">S2 Table</xref>.</p>
<p>For computing baselines, we also counted k-mers in the processed dataset. Given that extracting k-mers becomes more and more computationally expensive as k increases, we conducted distributed and parallel computing of k-mers by using Hadoop (<ext-link ext-link-type="uri" ns0:href="https://hadoop.apache.org" ns0:type="simple">https://hadoop.apache.org</ext-link>) and Spark [<xref ref-type="bibr" rid="pone.0222271.ref039">39</xref>]. The Spark code (available under <ext-link ext-link-type="uri" ns0:href="https://github.com/NIASC/ViraPipeV2" ns0:type="simple">https://github.com/NIASC/ViraPipeV2</ext-link>) outputs 4<sup><italic>k</italic></sup> &#215; <italic>l</italic> matrix where <italic>l</italic> is number of rows from an input dataset.</p>
</sec>
<sec id="sec018">
<title>Machine learning methods</title>
<sec id="sec019">
<title>Convolutional neural networks (CNNs)</title>
<p>Convolutional neural networks (CNNs) are a type of feed-forward neural networks [<xref ref-type="bibr" rid="pone.0222271.ref040">40</xref>, <xref ref-type="bibr" rid="pone.0222271.ref041">41</xref>]. In addition to fully-connected layers that have all-to-all connections, CNNs by definition also contain convolutional layers. Convolutional layers have partial connectivity and use the same parameters repeatedly [<xref ref-type="bibr" rid="pone.0222271.ref040">40</xref>]. In supervised learning settings, CNNs learn to perform a task by observing input-output pairs. The learning is achieved by minimizing the error (between model&#8217;s output and the known true output) via gradient descent [<xref ref-type="bibr" rid="pone.0222271.ref040">40</xref>, <xref ref-type="bibr" rid="pone.0222271.ref042">42</xref>].</p>
<p>CNNs are most widely used in image processing [<xref ref-type="bibr" rid="pone.0222271.ref040">40</xref>, <xref ref-type="bibr" rid="pone.0222271.ref043">43</xref>], but have been successfully applied in various fields [<xref ref-type="bibr" rid="pone.0222271.ref044">44</xref>, <xref ref-type="bibr" rid="pone.0222271.ref045">45</xref>], including analysis of biological sequences such as DNA and amino acid sequences [<xref ref-type="bibr" rid="pone.0222271.ref046">46</xref>&#8211;<xref ref-type="bibr" rid="pone.0222271.ref048">48</xref>]. The convolutional layers treat their inputs as multidimensional arrays&#8212;an image is treated as a 2D array with 3 color channels, while a DNA sequence is seen as a 1D array with one channel per possible nucleotide value. In the present work we use sequences of length 300 and consider 5 possible values (ATGCN) at each position, corresponding to a 1D sequence of length 300 with 5 channels (as depicted in <xref ref-type="fig" rid="pone.0222271.g001">Fig 1</xref>). A convolutional layer is characterized by a set of learnable filters that are convolved along the input DNA sequence (or along the width and height of an image). Filters are smaller than the input and can be applied at multiple locations along the input. At each position where the filter is applied, a dot product between the weights of the filter and the local input values is computed. The dot products resulting from applying the same filter to different positions along the sequence form a feature map. A convolutional layer usually applies many filters and hence its output is a set of feature maps, one per filter. On this output, further computations can be performed such as applying an activation function, pooling or adding further layers. The parameter values in the filters, like all other learnable parameters in the model, are optimized by the gradient descent algorithm.</p>
</sec>
<sec id="sec020">
<title>CNN architectures for predicting the viral nature of sequences</title>
<p>In this work we use a convolutional neural network called ViraMiner to predict whether a given DNA sequence is of a viral origin or not. This model contains two convolutional branches that contribute different types of information to the final fully-connected decision-making layer (<xref ref-type="fig" rid="pone.0222271.g006">Fig 6a</xref>).</p>
<fig id="pone.0222271.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0222271.g006</object-id>
<label>Fig 6</label>
<caption>
<title>ViraMiner architecture.</title>
<p>(a) ViraMiner full model, with the branches not expanded. (b) Architecture of the Frequency model with best performing layer sizes shown. The dotted parts will be discarded when using the pre-trained parameter values of this model as the Frequency Branch in the full model. (c) Architecture of the Pattern model (similar to DeepVirFinder) with best performing layer sizes shown. The dotted parts will be discarded when using the pre-trained parameter values of this model as the Pattern Branch in the full model.</p>
</caption>
<graphic mimetype="image" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.g006" ns0:type="simple" />
</fig>
<p>This model is partly based on the DeepVirFinder (DVF) architecture by Ren et al [<xref ref-type="bibr" rid="pone.0222271.ref024">24</xref>]. The DVF model is a Convolutional Neural Network (CNN) that applies the <italic>max operator</italic> on the outputs of each convolutional filter (on each feature map). Only the one maximal activation value per filter is passed on to the next layers. All other information, such as how often a good match was found, is lost. This architecture is illustrated in <xref ref-type="fig" rid="pone.0222271.g006">Fig 6c</xref>.</p>
<p>In this work we suggest that a convolutional layer followed by <italic>average operator</italic> instead of <italic>max operator</italic> provides important information about the frequency of patterns, information that is otherwise lost. In such a case, while losing information about the maximal activation (best match), we gain information about frequency&#8212;the average cannot be high if only a few good matches were found. In previous work the authors of DVF and the authors of the current article have shown that methods based on pattern frequency (k-mer counts, relative synonymous codon usage) are effective in separating viral samples from non-viral ones [<xref ref-type="bibr" rid="pone.0222271.ref024">24</xref>, <xref ref-type="bibr" rid="pone.0222271.ref028">28</xref>]. Using <italic>convolution + average</italic> is a natural extension to these pattern counting-based models. This results in the architecture in <xref ref-type="fig" rid="pone.0222271.g006">Fig 6b</xref>.</p>
<p>To clarify, we do not claim that using <italic>convolution+max</italic> is without merit, it simply captures a different type of information. In fact, in our ViraMiner model we combine feature maps processed by averaging and by max operators. This allows the model to base its decisions on both pattern-matching and pattern-frequency information. The ViraMiner detailed architecture is shown in <xref ref-type="fig" rid="pone.0222271.g006">Fig 6a</xref> where Frequency Branch and Pattern Branch refer to the architectures in <xref ref-type="fig" rid="pone.0222271.g006">Fig 6b and 6c</xref>, without the input and output layers.</p>
</sec>
<sec id="sec021">
<title>Training</title>
<p>It is important to note that Pattern and Frequency models can be used as separate models and trained independently. In the first step of our training scheme we train these two models, then remove the output layers and use the middle layers as Frequency and Pattern branches in the full ViraMiner model. In the second step we optimize only the parameters in the final layer of the ViraMiner architecture, leaving the weight and bias values in the branches unchanged, exactly as they were in the independent models. Notice that in this last step of learning, values of only roughly two thousand parameters are changed.</p>
<p>This <italic>step-wise</italic> training procedure helps reduce overfitting compared to simpler approaches. The simplest alternative training strategy consists in randomly initializing and optimizing all the parameters (both branches and the final layer) at the same time. This standard <italic>end-to-end</italic> approach allows the model to freely use all of its capacity to minimize the error in training data points. However, too much capacity might lead to lower generalization ability. Indeed, with this training procedure ViraMiner model strongly overfits and performs significantly worse on unseen data. <italic>Fine-tuning</italic> is another alternative training procedure where the branches are initialized with pre-trained values, but the values are not frozen. This means that when training the full ViraMiner model both the final layer and the branches are optimized. The re-optimization of pre-trained weights gives the name <italic>fine-tuning</italic>. Similarly to <italic>end-to-end</italic> training we see overfitting in this intermediate training procedure. Therefore, the models in the Results section are obtained with <italic>step-wise</italic> training procedure, rather than <italic>end-to-end</italic> or <italic>fine-tuning</italic>.</p>
</sec>
<sec id="sec022">
<title>Hyperparameter search and testing</title>
<p>We merged and shuffled the data originating from 19 metagenomics sequencing experiments and divided it into training (80%), validation (10%) and test sets (10%). We then performed an extensive hyperparameter search for the Pattern and Frequency models separately. For both architectures, hundreds of variants were trained using the 80% of data in training set. The performance of these models was measured by AUROC on validation set. The models were trained until validation AUROC had not increased for 6 consecutive epochs, but not longer than 30 epochs. After each epoch the model was saved only if validation AUROC had increased. Adam optimizer [<xref ref-type="bibr" rid="pone.0222271.ref049">49</xref>] and batch size 128 were used in all cases.</p>
<p>The initial hyperparameter search scanned the following parameters:</p>
<list list-type="bullet">
<list-item>
<p>Filter size: in range from 4 to 40 with step of 4.</p>
</list-item>
<list-item>
<p>Learning rate: 0.01, 0.001 and 0.0001. Each value was tried with and without learning rate decay, which multiplies learning rate by 0.5 after each 5 epochs.</p>
</list-item>
<list-item>
<p>Layer sizes (applies both to number of filters in convolutional layers and to number of nodes in fully connected layer): 1000, 1200 or 1500</p>
</list-item>
<list-item>
<p>Dropout probability: 0.1 or 0.5</p>
</list-item>
</list>
<p>In a second stage of hyperparameter search, each possible filter size value (with step of 1) was scanned in the region of interest determined by initial scan (8 to 16 for Frequency model; 6 to 14 for Pattern model). For other hyperparameters, some values were left out from the second stage as they clearly worsened the performance.</p>
<p>When the extensive hyperparameter scan was completed, the best Pattern model and best Frequency model (as per validation AUROC) were selected and used to initialize the branches in the ViraMiner architecture. We then trained the ViraMiner model with different learning rates, learning rate decays and with/without fine-tuning the branches and again selected the best model according to validation AUROC.</p>
<p>Having selected best models according to validation performance, we finally evaluated the best Pattern, best Frequency and best ViraMiner model on the test set which had been left unused up until this point.</p>
</sec>
<sec id="sec023">
<title>Baselines</title>
<p>Using 80/10/10 split, we also trained two types of baseline models. First of all, using k-mer counts extracted from the contigs as input, we trained Random Forest models with 1000 trees (all other parameters as default in scikit-learn Python package [<xref ref-type="bibr" rid="pone.0222271.ref050">50</xref>]) for k in range from 3 to 7. In the Results section, we report each model&#8217;s test AUROC.</p>
<p>Secondly, we also trained a Random Forest model directly on the 300bp sequences, without any feature extraction. For that we one-hot encoded the sequences and flattened them, resulting in 1200 inputs, 4 per each position in the sequence. Notice that such model is not position invariant&#8212;a shift of the sequence by just one base pair would completely change the output.</p>
</sec>
<sec id="sec024">
<title>Simulated data</title>
<p>Simulated pair-ended reads for this study were generated with ART simulator [<xref ref-type="bibr" rid="pone.0222271.ref029">29</xref>]. The reference file for the simulation included 30 thousand genomes from GenBank consisting 2870 viral and 27 130 cellular organisms (mammals, plants, vertebrates and bacterias). Parameters for the simulator were as follows: -ss MSv1 -p -l 150 -f 20 -m 200 -s 10. The simulation produced appproximately 13 million paired reads which in turn were assembled into 46 498 contigs by using IDBA-UD assembly [<xref ref-type="bibr" rid="pone.0222271.ref035">35</xref>]. Afterwards, we applied the same data processing and labeling pipeline as described for the 19 metagenomic datasets.</p>
</sec>
</sec>
<sec id="sec025">
<title>Code availability</title>
<p>All code, for ViraMiner model and for baselines, was written using Python2.7. For neural networks, Keras library was used [<xref ref-type="bibr" rid="pone.0222271.ref051">51</xref>]. All code is publicly available on GitHub <ext-link ext-link-type="uri" ns0:href="https://github.com/NeuroCSUT/ViraMiner" ns0:type="simple">https://github.com/NeuroCSUT/ViraMiner</ext-link>.</p>
</sec>
</sec>
<sec id="sec026">
<title>Supporting information</title>
<supplementary-material id="pone.0222271.s001" mimetype="application/pdf" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.s001" ns0:type="simple">
<label>S1 Table</label>
<caption>
<title>Most common HHMER-identified viral proteins.</title>
<p>For the most commonly found viral proteins, the table shows how many 300 bp sequences were found in the entire dataset (train+val+test) and same count for only val+test sets. The measures in the last 3 columns are calculated using a combination of validation and test set, validation set was included to increase the number of samples (for more reliable measures). Average score corresponds to the model&#8217;s mean output on the given (val+test) sequences. The quartiles show how these scores are distributed. The AUROC is calculated using all test-set non-viral sequences and only the val+test viral sequences corresponding to the given row. For comparison, the baseline values&#8212;using all test+val viral sequences, containing genes or not&#8212;are 0.390 for average score, [0.016; 0.127; 0.915] for quartiles and 0.923 for AUROC. It can be concluded that the model achieves improved performance on sequences containing these commonly found genes.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pone.0222271.s002" mimetype="application/pdf" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.s002" ns0:type="simple">
<label>S2 Table</label>
<caption>
<title>Viral classes in the entire dataset.</title>
<p>The first column shows the viral classes (families) found in the dataset, the second column represents number of viral contigs identified by Blast. The sequences are cut into 300 bp long sequences and the third column counts the numbers after the cut. Cutting longer contigs into smaller pieces means that the resulting 300 bp training sequences represent different parts of the same virus. &#8220;Others&#8221;, at the last row of table, includes sequences that have by Blast been classified as definitely being viral, but have not been assigned a viral family yet.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Supported by the Nordic Information for Action eScience Center awarded by the Nordic Academy for Advanced Sciences (NordForsk), the Swedish Research Council and the Swedish Foundation for Strategic Research.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0222271.ref001">
<label>1</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Wylie</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Mihindukulasuriya</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Sodergren</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Weinstock</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Storch</surname> <given-names>GA</given-names></name>. <article-title>Sequence analysis of the human virome in febrile and afebrile children</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>(<issue>6</issue>):<fpage>e27735</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0027735" ns0:type="simple">10.1371/journal.pone.0027735</ext-link></comment> <object-id pub-id-type="pmid">22719819</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref002">
<label>2</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Willner</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Furlan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Haynes</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schmieder</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Angly</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Silva</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Metagenomic analysis of respiratory tract DNA viral communities in cystic fibrosis and non-cystic fibrosis individuals</article-title>. <source>PLoS One</source>. <year>2009</year>;<volume>4</volume>(<issue>10</issue>):<fpage>e7370</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0007370" ns0:type="simple">10.1371/journal.pone.0007370</ext-link></comment> <object-id pub-id-type="pmid">19816605</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref003">
<label>3</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Wylie</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Weinstock</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Storch</surname> <given-names>GA</given-names></name>. <article-title>Emerging view of the human virome</article-title>. <source>Transl Res</source>. <year>2012</year>;<volume>160</volume>(<issue>4</issue>):<fpage>283</fpage>&#8211;<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1016/j.trsl.2012.03.006" ns0:type="simple">10.1016/j.trsl.2012.03.006</ext-link></comment> <object-id pub-id-type="pmid">22683423</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref004">
<label>4</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Lecuit</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Eloit</surname> <given-names>M</given-names></name>. <article-title>The human virome: new tools and concepts</article-title>. <source>Trends Microbiol</source>. <year>2013</year>;<volume>21</volume>(<issue>10</issue>):<fpage>510</fpage>&#8211;<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1016/j.tim.2013.07.001" ns0:type="simple">10.1016/j.tim.2013.07.001</ext-link></comment> <object-id pub-id-type="pmid">23906500</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref005">
<label>5</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ekstr&#246;m</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lysholm</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hultin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Faust</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Persson</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Phylogenetically diverse TT virus viremia among pregnant women</article-title>. <source>Virology</source>. <year>2012</year>;<volume>432</volume>(<issue>2</issue>):<fpage>427</fpage>&#8211;<lpage>434</lpage>. <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1016/j.virol.2012.06.022" ns0:type="simple">https://doi.org/10.1016/j.virol.2012.06.022</ext-link> <object-id pub-id-type="pmid">22819835</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref006">
<label>6</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hultin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Arroyo Muhr</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Ekstrom</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lehtinen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>de Villiers</surname> <given-names>EM</given-names></name>, <etal>et al</etal>. <article-title>Viremia during pregnancy and risk of childhood leukemia and lymphomas in the offspring: Nested case-control study</article-title>. <source>Int J Cancer</source>. <year>2016</year>;<volume>138</volume>(<issue>9</issue>):<fpage>2212</fpage>&#8211;<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1002/ijc.29666" ns0:type="simple">10.1002/ijc.29666</ext-link></comment> <object-id pub-id-type="pmid">26132655</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref007">
<label>7</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ekstrom</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Faust</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Moller</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Eklund</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Unbiased approach for virus detection in skin lesions</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>6</issue>):<fpage>e65953</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0065953" ns0:type="simple">10.1371/journal.pone.0065953</ext-link></comment> <object-id pub-id-type="pmid">23840382</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref008">
<label>8</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Muhr</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Lagheden</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ekstrom</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Forslund</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Dillner</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Deep sequencing extends the diversity of human papillomaviruses in human skin</article-title>. <source>Sci Rep</source>. <year>2014</year>;<volume>4</volume>:<fpage>5807</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/srep05807" ns0:type="simple">10.1038/srep05807</ext-link></comment> <object-id pub-id-type="pmid">25055967</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref009">
<label>9</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Ekstrom</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Svenback</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Forslund</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Dillner</surname> <given-names>J</given-names></name>. <article-title>High throughput sequencing reveals diversity of Human Papillomaviruses in cutaneous lesions</article-title>. <source>Int J Cancer</source>. <year>2011</year>;<volume>129</volume>(<issue>11</issue>):<fpage>2643</fpage>&#8211;<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1002/ijc.26204" ns0:type="simple">10.1002/ijc.26204</ext-link></comment> <object-id pub-id-type="pmid">21630257</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref010">
<label>10</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Feng</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shuda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>PS</given-names></name>. <article-title>Clonal integration of a polyomavirus in human Merkel cell carcinoma</article-title>. <source>Science</source>. <year>2008</year>;<volume>319</volume>(<issue>5866</issue>):<fpage>1096</fpage>&#8211;<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1126/science.1152586" ns0:type="simple">10.1126/science.1152586</ext-link></comment> <object-id pub-id-type="pmid">18202256</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref011">
<label>11</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Mercalli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lampasona</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Klingel</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Albarello</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lombardoni</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ekstr&#246;m</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>No evidence of enteroviruses in the intestine of patients with type 1 diabetes</article-title>. <source>Diabetologia</source>. <year>2012</year>;<volume>55</volume>(<issue>9</issue>):<fpage>2479</fpage>&#8211;<lpage>2488</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1007/s00125-012-2591-4" ns0:type="simple">10.1007/s00125-012-2591-4</ext-link></comment> <object-id pub-id-type="pmid">22684312</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref012">
<label>12</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Sundstr&#246;m</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Juto</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Wadell</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hallmans</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Svenningsson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nystr&#246;m</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <source>An altered immune response to Epstein-Barr virus in multiple sclerosis: A prospective study</source>. <volume>vol. 62</volume>; <year>2004</year>.</mixed-citation>
</ref>
<ref id="pone.0222271.ref013">
<label>13</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Meiring</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Salimo</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Coetzee</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Maree</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Moodley</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hitzeroth</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Next-generation sequencing of cervical DNA detects human papillomavirus types not detected by commercial kits</article-title>. <source>Virol J</source>. <year>2012</year>;<volume>9</volume>:<fpage>164</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/1743-422X-9-164" ns0:type="simple">10.1186/1743-422X-9-164</ext-link></comment> <object-id pub-id-type="pmid">22897914</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref014">
<label>14</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Foulongne</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sauvage</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Hebert</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dereure</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Cheval</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gouilh</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Human skin microbiota: high diversity of DNA viruses identified on the human skin by high throughput sequencing</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>(<issue>6</issue>):<fpage>e38499</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0038499" ns0:type="simple">10.1371/journal.pone.0038499</ext-link></comment> <object-id pub-id-type="pmid">22723863</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref015">
<label>15</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Towner</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Sealy</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Khristova</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Albarino</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Conlan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reeder</surname> <given-names>SA</given-names></name>, <etal>et al</etal>. <article-title>Newly discovered ebola virus associated with hemorrhagic fever outbreak in Uganda</article-title>. <source>PLoS Pathog</source>. <year>2008</year>;<volume>4</volume>(<issue>11</issue>):<fpage>e1000212</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.ppat.1000212" ns0:type="simple">10.1371/journal.ppat.1000212</ext-link></comment> <object-id pub-id-type="pmid">19023410</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref016">
<label>16</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Willner</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Haynes</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Furlan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hanson</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kirby</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lim</surname> <given-names>YW</given-names></name>, <etal>et al</etal>. <article-title>Case studies of the spatial heterogeneity of DNA viruses in the cystic fibrosis lung</article-title>. <source>Am J Respir Cell Mol Biol</source>. <year>2012</year>;<volume>46</volume>(<issue>2</issue>):<fpage>127</fpage>&#8211;<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1165/rcmb.2011-0253OC" ns0:type="simple">10.1165/rcmb.2011-0253OC</ext-link></comment> <object-id pub-id-type="pmid">21980056</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref017">
<label>17</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Johansson</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ekstrom</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hultin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dillner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Forslund</surname> <given-names>O</given-names></name>. <article-title>Metagenomic sequencing of &#8220;HPV-negative&#8221; condylomas detects novel putative HPV types</article-title>. <source>Virology</source>. <year>2013</year>;<volume>440</volume>(<issue>1</issue>):<fpage>1</fpage>&#8211;<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1016/j.virol.2013.01.023" ns0:type="simple">10.1016/j.virol.2013.01.023</ext-link></comment> <object-id pub-id-type="pmid">23522725</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref018">
<label>18</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Labonte</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Suttle</surname> <given-names>CA</given-names></name>. <article-title>Previously unknown and highly divergent ssDNA viruses populate the oceans</article-title>. <source>ISME J</source>. <year>2013</year>;<volume>7</volume>(<issue>11</issue>):<fpage>2169</fpage>&#8211;<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/ismej.2013.110" ns0:type="simple">10.1038/ismej.2013.110</ext-link></comment> <object-id pub-id-type="pmid">23842650</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref019">
<label>19</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gilbert</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>F</given-names></name>. <article-title>Metagenomics&#8212;a guide from sampling to data analysis</article-title>. <source>Microb Inform Exp</source>. <year>2012</year>;<volume>2</volume>(<issue>1</issue>):<fpage>3</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/2042-5783-2-3" ns0:type="simple">10.1186/2042-5783-2-3</ext-link></comment> <object-id pub-id-type="pmid">22587947</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref020">
<label>20</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Mistry</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Finn</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Bateman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Punta</surname> <given-names>M</given-names></name>. <article-title>Challenges in homology search: HMMER3 and convergent evolution of coiled-coil regions</article-title>. <source>Nucleic Acids Res</source>. <year>2013</year>;<volume>41</volume>(<issue>12</issue>):<fpage>e121</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/nar/gkt263" ns0:type="simple">10.1093/nar/gkt263</ext-link></comment> <object-id pub-id-type="pmid">23598997</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref021">
<label>21</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Skewes-Cox</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sharpton</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Pollard</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>DeRisi</surname> <given-names>JL</given-names></name>. <article-title>Profile hidden Markov models for the detection of viruses within metagenomic sequence data</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>8</issue>):<fpage>e105067</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0105067" ns0:type="simple">10.1371/journal.pone.0105067</ext-link></comment> <object-id pub-id-type="pmid">25140992</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref022">
<label>22</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bzhalava</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Hultin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Dillner</surname> <given-names>J</given-names></name>. <article-title>Extension of the viral ecology in humans using viral profile hidden Markov models</article-title>. <source>PLOS ONE</source>. <year>2018</year>;<volume>13</volume>(<issue>1</issue>):<fpage>e0190938</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0190938" ns0:type="simple">10.1371/journal.pone.0190938</ext-link></comment> <object-id pub-id-type="pmid">29351302</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref023">
<label>23</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Amgarten</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Braga</surname> <given-names>LPP</given-names></name>, <name name-style="western"><surname>da Silva</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Setubal</surname> <given-names>JC</given-names></name>. <article-title>MARVEL, a Tool for Prediction of Bacteriophage Sequences in Metagenomic Bins</article-title>. <source>Frontiers in Genetics</source>. <year>2018</year>;<volume>9</volume>(<issue>304</issue>). <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.3389/fgene.2018.00304" ns0:type="simple">10.3389/fgene.2018.00304</ext-link></comment> <object-id pub-id-type="pmid">30131825</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref024">
<label>24</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Ren</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ahlgren</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>YY</given-names></name>, <name name-style="western"><surname>Fuhrman</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>. <article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>. <source>Microbiome</source>. <year>2017</year>;<volume>5</volume>:<fpage>69</fpage>.</mixed-citation>
</ref>
<ref id="pone.0222271.ref025">
<label>25</label>
<mixed-citation publication-type="other" ns0:type="simple">Ren J, Song K, Deng C, Ahlgren NA, Fuhrman JA, Li Y, et al. Identifying viruses from metagenomic data by deep learning. In: Conference Proceedings;.</mixed-citation>
</ref>
<ref id="pone.0222271.ref026">
<label>26</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Vervier</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mah&#233;</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tournoud</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Veyrieras</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Vert</surname> <given-names>JP</given-names></name>. <article-title>Large-scale machine learning for metagenomics sequence classification</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2016</year>;<volume>32</volume>(<issue>7</issue>):<fpage>1023</fpage>&#8211;<lpage>1032</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btv683" ns0:type="simple">10.1093/bioinformatics/btv683</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0222271.ref027">
<label>27</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Chaudhary</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sharma</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Agarwal</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sharma</surname> <given-names>VK</given-names></name>. <article-title>16S Classifier: A Tool for Fast and Accurate Taxonomic Classification of 16S rRNA Hypervariable Regions in Metagenomic Datasets</article-title>. <source>PLOS ONE</source>. <year>2015</year>;<volume>10</volume>(<issue>2</issue>):<fpage>e0116106</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1371/journal.pone.0116106" ns0:type="simple">10.1371/journal.pone.0116106</ext-link></comment> <object-id pub-id-type="pmid">25646627</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref028">
<label>28</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bzhalava</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Tampuu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ba&#322;a</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Vicente</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dillner</surname> <given-names>J</given-names></name>. <article-title>Machine Learning for detection of viral sequences in human metagenomic datasets</article-title>. <source>BMC Bioinformatics</source>. <year>2018</year>;<volume>19</volume>(<issue>1</issue>):<fpage>336</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/s12859-018-2340-x" ns0:type="simple">10.1186/s12859-018-2340-x</ext-link></comment> <object-id pub-id-type="pmid">30249176</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref029">
<label>29</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Marth</surname> <given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>28</volume>(<issue>4</issue>):<fpage>593</fpage>&#8211;<lpage>594</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btr708" ns0:type="simple">10.1093/bioinformatics/btr708</ext-link></comment> <object-id pub-id-type="pmid">22199392</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref030">
<label>30</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Smelov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Arroyo Muhr</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Eklund</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Komyakov</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gorelov</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Detection of DNA viruses in prostate cancer</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>:<fpage>25235</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/srep25235" ns0:type="simple">10.1038/srep25235</ext-link></comment> <object-id pub-id-type="pmid">27121729</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref031">
<label>31</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Arroyo M&#252;hr</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lagheden</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Eklund</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Forslund</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Does human papillomavirus-negative condylomata exist?</article-title> <source>Virology</source>. <year>2015</year>;<volume>485</volume>:<fpage>283</fpage>&#8211;<lpage>288</lpage>. <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1016/j.virol.2015.07.023" ns0:type="simple">https://doi.org/10.1016/j.virol.2015.07.023</ext-link> <object-id pub-id-type="pmid">26318260</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref032">
<label>32</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Arroyo Muhr</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Hultin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Eklund</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lagheden</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ekstrom</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Human papillomavirus type 197 is commonly present in skin tumors</article-title>. <source>Int J Cancer</source>. <year>2015</year>;<volume>136</volume>(<issue>11</issue>):<fpage>2546</fpage>&#8211;<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1002/ijc.29325" ns0:type="simple">10.1002/ijc.29325</ext-link></comment> <object-id pub-id-type="pmid">25388227</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref033">
<label>33</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dillner</surname> <given-names>J</given-names></name>. <article-title>Bioinformatics for Viral Metagenomics</article-title>. <source>J Data Mining Genomics Proteomics</source>. <year>2013</year>;<volume>4</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.4172/2153-0602.1000134" ns0:type="simple">10.4172/2153-0602.1000134</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0222271.ref034">
<label>34</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname> <given-names>R</given-names></name>. <article-title>Fast and accurate short read alignment with Burrows&#8211;Wheeler transform</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>14</issue>):<fpage>1754</fpage>&#8211;<lpage>1760</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/btp324" ns0:type="simple">10.1093/bioinformatics/btp324</ext-link></comment> <object-id pub-id-type="pmid">19451168</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref035">
<label>35</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Peng</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>HCM</given-names></name>, <name name-style="western"><surname>Yiu</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Chin</surname> <given-names>FYL</given-names></name>. <article-title>IDBA-UD: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>11</issue>):<fpage>1420</fpage>&#8211;<lpage>1428</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1093/bioinformatics/bts174" ns0:type="simple">10.1093/bioinformatics/bts174</ext-link></comment> <object-id pub-id-type="pmid">22495754</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref036">
<label>36</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Grabherr</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Haas</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Yassour</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Levin</surname> <given-names>JZ</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Amit</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Trinity: reconstructing a full-length transcriptome without a genome from RNA-Seq data</article-title>. <source>Nature biotechnology</source>. <year>2011</year>;<volume>29</volume>(<issue>7</issue>):<fpage>644</fpage>&#8211;<lpage>652</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/nbt.1883" ns0:type="simple">10.1038/nbt.1883</ext-link></comment> <object-id pub-id-type="pmid">21572440</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref037">
<label>37</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Luo</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Xie</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Yuan</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>. <source>Gigascience</source>. <year>2012</year>;<volume>1</volume>(<issue>1</issue>):<fpage>18</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1186/2047-217X-1-18" ns0:type="simple">10.1186/2047-217X-1-18</ext-link></comment> <object-id pub-id-type="pmid">23587118</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref038">
<label>38</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Nowicki</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bzhalava</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ba&#321;a</surname> <given-names>P</given-names></name>. <article-title>Massively Parallel Implementation of Sequence Alignment with Basic Local Alignment Search Tool Using Parallel Computing in Java Library</article-title>. <source>Journal of Computational Biology</source>. <year>2018</year>;<volume>25</volume>(<issue>8</issue>):<fpage>871</fpage>&#8211;<lpage>881</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1089/cmb.2018.0079" ns0:type="simple">10.1089/cmb.2018.0079</ext-link></comment> <object-id pub-id-type="pmid">30004240</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref039">
<label>39</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Zaharia</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chowdhury</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Franklin</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Shenker</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stoica</surname> <given-names>I</given-names></name>. <article-title>Spark: Cluster computing with working sets</article-title>. <source>HotCloud</source>. <year>2010</year>;<volume>10</volume>(<issue>10-10</issue>):<fpage>95</fpage>.</mixed-citation>
</ref>
<ref id="pone.0222271.ref040">
<label>40</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Boser</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Denker</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Henderson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Howard</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Hubbard</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Backpropagation applied to handwritten zip code recognition</article-title>. <source>Neural computation</source>. <year>1989</year>;<volume>1</volume>(<issue>4</issue>):<fpage>541</fpage>&#8211;<lpage>551</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1162/neco.1989.1.4.541" ns0:type="simple">10.1162/neco.1989.1.4.541</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0222271.ref041">
<label>41</label>
<mixed-citation publication-type="book" ns0:type="simple">
<name name-style="western"><surname>Goodfellow</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Courville</surname> <given-names>A</given-names></name>. <source>Deep learning</source>. <publisher-name>MIT press</publisher-name>; <year>2016</year>.</mixed-citation>
</ref>
<ref id="pone.0222271.ref042">
<label>42</label>
<mixed-citation publication-type="other" ns0:type="simple">Rumelhart DE, Hinton GE, Williams RJ. Learning internal representations by error propagation. California Univ San Diego La Jolla Inst for Cognitive Science; 1985.</mixed-citation>
</ref>
<ref id="pone.0222271.ref043">
<label>43</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Krizhevsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sutskever</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>. <article-title>Imagenet classification with deep convolutional neural networks</article-title>. In: <source>Advances in neural information processing systems</source>; <year>2012</year>. p. <fpage>1097</fpage>&#8211;<lpage>1105</lpage>.</mixed-citation>
</ref>
<ref id="pone.0222271.ref044">
<label>44</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>LeCun</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>. <article-title>Convolutional networks for images, speech, and time series</article-title>. <source>The handbook of brain theory and neural networks</source>. <year>1995</year>;<volume>3361</volume>(<issue>10</issue>):<fpage>1995</fpage>.</mixed-citation>
</ref>
<ref id="pone.0222271.ref045">
<label>45</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dahl</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mohamed</surname> <given-names>Ar</given-names></name>, <name name-style="western"><surname>Jaitly</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Deep neural networks for acoustic modeling in speech recognition</article-title>. <source>IEEE Signal processing magazine</source>. <year>2012</year>;<volume>29</volume>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1109/MSP.2012.2205597" ns0:type="simple">10.1109/MSP.2012.2205597</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0222271.ref046">
<label>46</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Kelley</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Snoek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rinn</surname> <given-names>JL</given-names></name>. <article-title>Basset: learning the regulatory code of the accessible genome with deep convolutional neural networks</article-title>. <source>Genome research</source>. <year>2016</year>;<volume>26</volume>(<issue>7</issue>):<fpage>990</fpage>&#8211;<lpage>999</lpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1101/gr.200535.115" ns0:type="simple">10.1101/gr.200535.115</ext-link></comment> <object-id pub-id-type="pmid">27197224</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref047">
<label>47</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Troyanskaya</surname> <given-names>OG</given-names></name>. <article-title>Predicting effects of noncoding variants with deep learning&#8211;based sequence model</article-title>. <source>Nature methods</source>. <year>2015</year>;<volume>12</volume>(<issue>10</issue>):<fpage>931</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.1038/nmeth.3547" ns0:type="simple">10.1038/nmeth.3547</ext-link></comment> <object-id pub-id-type="pmid">26301843</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref048">
<label>48</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Angermueller</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>P&#228;rnamaa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Parts</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stegle</surname> <given-names>O</given-names></name>. <article-title>Deep learning for computational biology</article-title>. <source>Molecular systems biology</source>. <year>2016</year>;<volume>12</volume>(<issue>7</issue>):<fpage>878</fpage>. <comment>doi: <ext-link ext-link-type="uri" ns0:href="https://doi.org/10.15252/msb.20156651" ns0:type="simple">10.15252/msb.20156651</ext-link></comment> <object-id pub-id-type="pmid">27474269</object-id></mixed-citation>
</ref>
<ref id="pone.0222271.ref049">
<label>49</label>
<mixed-citation publication-type="other" ns0:type="simple">Kingma DP, Ba J. Adam: A method for stochastic optimization. arXiv preprint arXiv:14126980. 2014;.</mixed-citation>
</ref>
<ref id="pone.0222271.ref050">
<label>50</label>
<mixed-citation publication-type="journal" ns0:type="simple">
<name name-style="western"><surname>Pedregosa</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Varoquaux</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Thirion</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Grisel</surname> <given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Scikit-learn: Machine learning in Python</article-title>. <source>Journal of machine learning research</source>. <year>2011</year>;<volume>12</volume>(<issue>Oct</issue>):<fpage>2825</fpage>&#8211;<lpage>2830</lpage>.</mixed-citation>
</ref>
<ref id="pone.0222271.ref051">
<label>51</label>
<mixed-citation publication-type="other" ns0:type="simple">Chollet F, et al. Keras; 2015. <ext-link ext-link-type="uri" ns0:href="https://keras.io" ns0:type="simple">https://keras.io</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
<sub-article article-type="aggregated-review-documents" id="pone.0222271.r001" specific-use="decision-letter">
<front-stub>
<article-id pub-id-type="doi">10.1371/journal.pone.0222271.r001</article-id>
<title-group>
<article-title>Decision Letter 0</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name name-style="western">
<surname>Melcher</surname>
<given-names>Ulrich</given-names>
</name>
<role>Academic Editor</role>
</contrib>
</contrib-group>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Ulrich Melcher</copyright-holder>
<license ns0:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<related-object document-id="10.1371/journal.pone.0222271" document-id-type="doi" document-type="article" id="rel-obj001" link-type="peer-reviewed-article" />
<custom-meta-group>
<custom-meta>
<meta-name>Submission Version</meta-name>
<meta-value>0</meta-value>
</custom-meta>
</custom-meta-group>
</front-stub>
<body>
<p>
<named-content content-type="letter-date">4 Jul 2019</named-content>
</p>
<p>PONE-D-19-16058</p>
<p>ViraMiner: deep learning on raw DNA sequences for identifying viral genomes in human samples</p>
<p>PLOS ONE</p>
<p>Dear Mr Tampuu,</p>
<p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE&#8217;s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
<p><bold>Both reviewers and myself are convinced that the investigators&#8217; report a until now poorly examined avenue to exploration of metagenomic datasets for the presence of viral sequences. I anticipate that improvements, along suggested lines, can be carried out without further review.</bold></p>
<p>We would appreciate receiving your revised manuscript by Aug 18 2019 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" ns0:href="https://www.editorialmanager.com/pone/" ns0:type="simple">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
<p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
<p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" ns0:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols" ns0:type="simple">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
<p>Please include the following items when submitting your revised manuscript:</p>
<p><list list-type="bullet"><list-item><p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p></list-item><list-item><p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p></list-item><list-item><p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p></list-item></list></p>
<p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
<p>We look forward to receiving your revised manuscript.</p>
<p>Kind regards,</p>
<p>Ulrich Melcher</p>
<p>Academic Editor</p>
<p>PLOS ONE</p>
<p><bold>Journal Requirements:</bold></p>
<p>1. When submitting your revision, we need you to address these additional requirements.</p>
<p>Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p>
<p><ext-link ext-link-type="uri" ns0:href="http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf" ns0:type="simple">http://www.journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" ns0:href="http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf" ns0:type="simple">http://www.journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
<p><bold>Additional Editor Comments (if provided):</bold></p>
<p>Language improvements needed:</p>
<p>, in occurrence order are listed here.</p>
<p>Line 2 &#8220;reside in&#8221; better than &#8220;reside on&#8221;? Or maybe both (in and on)</p>
<p>l. 10 delete &#8220;the&#8221;</p>
<p>l. 14 word order better: &#8220;obtain directly&#8221;</p>
<p>L.22 delete &#8220;percentage&#8221;?</p>
<p>l.. 30 vague antecedent: &#8220;it&#8221;</p>
<p>l. 57 &#8220;in&#8221; in place of &#8220;on&#8221; in description of the Figure Also line 80, line 290, 300, 305, 306</p>
<p>I would appreciate more explanation in a legend to Figure 1 how values for pattern branch and frequency branch are deduced.. Also: what is meant by &#8220;fully connected&#8221;?</p>
<p>l. 58 I prefer &#8220;puts out&#8221; and elsewhere</p>
<p>l. 80 number disagreement &#8220;these type&#8221;; also l. 309 &#8220;a&#8230;models&#8217;</p>
<p>l. 160 &#8220;We repeated out to&#8230;&#8221; ??? meaning not clear</p>
<p>l. 183-4 needs articles; &#8216;the former, &#8216;the latter&#8217;.</p>
<p>L. 210-211 is not clear. Rewrite</p>
<p>l. 262-3 needs work</p>
<p>l.318-321 is not clear to me</p>
<p><bold>Comments to the Author</bold></p>
<p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
<p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
<p>Reviewer #1: Yes</p>
<p>Reviewer #2: Yes</p>
<p>**********</p>
<p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
<p>Reviewer #1: Yes</p>
<p>Reviewer #2: Yes</p>
<p>**********</p>
<p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
<p>The <ext-link ext-link-type="uri" ns0:href="http://www.plosone.org/static/policies.action#sharing" ns0:type="simple">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#8212;e.g. participant privacy or use of data from a third party&#8212;those must be specified.</p>
<p>Reviewer #1: Yes</p>
<p>Reviewer #2: Yes</p>
<p>**********</p>
<p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
<p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
<p>Reviewer #1: Yes</p>
<p>Reviewer #2: Yes</p>
<p>**********</p>
<p>5. Review Comments to the Author</p>
<p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
<p>Reviewer #1: This is a very well written manuscript with promising results of 19 human metagenomes, however, there are some items that I considered they need to be addressed before publication:</p>
<p>Although the machine learning model shows promising results, it would be interesting to the reader to know which genome regions of the viruses were used by the trained model to identify the potential new viruses. Is there any bias towards coat protein, RNA dependent RNA polymerase or any other genes to determine the presence of the virus in the dataset?</p>
<p>Can you include in the results what are the hallmark genes that were mostly found in the identified sequences? This would possibly require HMMER to be run using the unknown sequences of your 19 metagenomes after blastn.</p>
<p>Why didn&#8217;t you try contig lengths larger than 300, for instance 1000, 5000, 10000? Would your model perform better with those contig lengths?</p>
<p>The tool requires further validation with more data. I understand that you are using 19 metagenomes and using partitions/baselines to train, and the AUROC can be considered a good parameter to evaluate your model. However, it is imperative to certainly know what is in your metagenome to be able to validate the current technology. I&#8217;d suggest to generate simulated human metagenomes using taxon profiles similar to the ones that you used in the training model. I would suggest using NeSSM, ART, MetaSim for the simulations to determine how your trained model performs in completely new datasets.</p>
<p>Per line comments:</p>
<p>Line 40: Builds on top of the CNN architecture of Ren [25].</p>
<p>Line 101: Spell out AUROC as Area Under the Receiver Operating Characteristics the first time in the text.</p>
<p>Line 185: You can say something like: &#8220;trained to identify viruses infecting prokaryotic organisms&#8221;</p>
<p>Line 251: replace producing by produced.</p>
<p>Reviewer #2: This article proposed a new machine learning approach for characterizing unknown metagenomics contigs. The approach using ANN with raw DNA sequences as inputs is unique and novel. The authors demonstrated that the proposed approach &#8220;viralMiner&#8221; performs better than random forests and kmer as baseline. The writing is excellent as well. Because of the novelty of the approach, I recommend the paper accepted after minor revision.</p>
<p>Several minor areas can be imporved:</p>
<p>1. The AUC is 0.92, however, the real performance 0.9 accuracy and 0.32 recall is not as impressive. I believe these numbers are much worse than blast, so I recommend emphasize this in the abstract</p>
<p>2. The real strength of this approach is to detect &#8220;unknown&#8221; contigs which cannot be detected by blast. However the training test validation experiments did not evaluate anything that is &#8220;unknown&#8221;. Maybe the authors can hold out some viral classes in the training and test if the machine learning approach can detect &#8220;unknown&#8221; contigs?</p>
<p>3. A table could be added to show all training viral classes.</p>
<p>**********</p>
<p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" ns0:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ns0:type="simple">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
<p>If you choose &#8220;no&#8221;, your identity will remain anonymous but your review may still be made public.</p>
<p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" ns0:href="https://www.plos.org/privacy-policy" ns0:type="simple">Privacy Policy</ext-link>.</p>
<p>Reviewer #1: No</p>
<p>Reviewer #2: No</p>
<p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
<p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" ns0:href="https://pacev2.apexcovantage.com/" ns0:type="simple">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email ns0:type="simple">figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
</body>
</sub-article>
<sub-article article-type="author-comment" id="pone.0222271.r002">
<front-stub>
<article-id pub-id-type="doi">10.1371/journal.pone.0222271.r002</article-id>
<title-group>
<article-title>Author response to Decision Letter 0</article-title>
</title-group>
<related-object document-id="10.1371/journal.pone.0222271" document-id-type="doi" document-type="peer-reviewed-article" id="rel-obj002" link-type="rebutted-decision-letter" object-id="10.1371/journal.pone.0222271.r001" object-id-type="doi" object-type="decision-letter" />
<custom-meta-group>
<custom-meta>
<meta-name>Submission Version</meta-name>
<meta-value>1</meta-value>
</custom-meta>
</custom-meta-group>
</front-stub>
<body>
<p>
<named-content content-type="author-response-date">7 Aug 2019</named-content>
</p>
<p>Responses to additional Editor Comments</p>
<p>Language improvements needed:</p>
<p>, in occurrence order are listed here.</p>
<p>Line 2 &#8220;reside in&#8221; better than &#8220;reside on&#8221;? Or maybe both (in and on) </p>
<p>Reply: Changed as requested to &#8220;in and on&#8221;</p>
<p>l. 10 delete &#8220;the&#8221; </p>
<p>Reply: Changed as requested</p>
<p>l. 14 word order better: &#8220;obtain directly&#8221; </p>
<p>Reply: Changed as requested</p>
<p>L.22 delete &#8220;percentage&#8221;? </p>
<p>Reply: Changed as requested</p>
<p>l.. 30 vague antecedent: &#8220;it&#8221;  </p>
<p>Reply: Added &#8220;the algorithm&#8221; in the text instead of &#8220;it&#8221;</p>
<p>l. 57 &#8220;in&#8221; in place of &#8220;on&#8221; in description of the Figure Also line 80, line 290, 300, 305, 306 </p>
<p>Reply: Changed as requested</p>
<p>I would appreciate more explanation in a legend to Figure 1 how values for pattern branch and frequency branch are deduced.</p>
<p>Also: what is meant by &#8220;fully connected&#8221;? </p>
<p>Reply: We have expanded the caption of Figure 1 and explicitly clarified the meaning of &#8220;fully-connected&#8221; both in figure caption and the text. </p>
<p>l. 58 I prefer &#8220;puts out&#8221; and elsewhere</p>
<p>Reply: In the context of computer science, &#8220;to output&#8221; is more commonly used than &#8220;to put out&#8221; in the machine learning community. In fact, Google Scholar searches for &#8220;the model outputs a&#8221; and &#8220;model puts out a&#8221; show that the first phrasing (using &#8220;to output&#8221;) is much more common. The exact sentence &#8220;the model outputs a&#8221; was used to i) to avoid responses where &#8220;outputs&#8221; is a noun  and ii) to minimize confounding results due to Google not paying attention to punctuation and capitalization -- results such as &#8220;the model outputs. The&#8221;. Thus, using &#8220;to output&#8221; seems grammatically valid, widely-used, and we would prefer to use it in the context of our manuscript. </p>
<p>l. 80 number disagreement &#8220;these type&#8221;; also l. 309 &#8220;a&#8230;models&#8217; </p>
<p>Reply: Changed as requested</p>
<p>l. 160 &#8220;We repeated out to&#8230;&#8221; ??? meaning not clear </p>
<p>Reply: Changed, the original sentence was indeed nonsensical with some excessive or missing part. </p>
<p>l. 183-4 needs articles; &#8216;the former, &#8216;the latter&#8217;. </p>
<p>Reply: Changed as requested</p>
<p>L. 210-211 is not clear. Rewrite</p>
<p>Reply: The sentence was rewritten as &#8220;However, it is important to note that ViraMiner does not have a database to rely on and must thus capture a different kind of information of genome composition than alignment based methods.&#8221;</p>
<p>l. 262-3 needs work  </p>
<p>Reply:  For clarity, we have now added a few sentences that put convolutional networks in context by mentioning their particularities. Also, we expand on the learning procedure. Notice that the nature of convolutions in case of 1D input is explained later in the subsection. </p>
<p>l.318-321 is not clear to me</p>
<p>Reply: This has been expanded in Methods and Materials</p>
<p>--------------------------------------------------------------------------------------------</p>
<p>Response to Reviewers</p>
<p>Reviewer #1: </p>
<p>This is a very well written manuscript with promising results of 19 human metagenomes, however, there are some items that I considered they need to be addressed before publication:</p>
<p>1) Although the machine learning model shows promising results, it would be interesting to the reader to know which genome regions of the viruses were used by the trained model to identify the potential new viruses. Is there any bias towards coat protein, RNA dependent RNA polymerase or any other genes to determine the presence of the virus in the dataset?</p>
<p>Can you include in the results what are the hallmark genes that were mostly found in the identified sequences? This would possibly require HMMER to be run using the unknown sequences of your 19 metagenomes after blastn.</p>
<p>Reply: We thank the reviewer for these comments. We ran HMMER with pfam database on the viral 300bp sequences and the table below represents the found proteins. The table only contains the most frequent proteins, because we want to have at least 10 data points when calculating average metrics. The second column counts the occurrences of the protein in the entire dataset (train+val+test). The third column counts the occurrences of the protein among val+test set samples. The fourth column shows the average probability of being viral according to the model for val+test set samples of the given protein (i.e. the average output value).  The fifth column gives the quartiles of these score values. The sixth column gives the AUROC (using test+val sequences containing given protein and all test set non-viruses). </p>
<p>There are clear differences among the values in the fourth, fifth and sixth column. More importantly, all these values are an improvement over the average performance over all viral sequences (given in table caption). Hence, indeed, containing parts of certain proteins helps the model to identify the sequence as viral. </p>
<p>This table is now provided as supplementary table for the paper. </p>
<p>S1 Table. Most common HHMER-identified viral proteins. For the most commonly found viral proteins, the table shows how many 300bp sequences were found in the entire dataset (train+val+test) and same count for only val+test sets. The measures in the last 3 columns are calculated using a combination of validation and test set, validation set was included to increase the number of samples (for more reliable measures). Average score corresponds to the model&#8217;s mean output on the given (val+test) sequences. The quartiles show how these scores are distributed. The AUROC is calculated using all test-set non-viral sequences and only the val+test viral sequences corresponding to the given row.  For comparison, the baseline values - using all test+val viral sequences, containing genes or not - is 0.390 for average score, [0.016; 0.127; 0.915] for quartiles and 0.923 for AUROC. It can be concluded that the model achieves improved performance on sequences containing these commonly found genes.</p>
<p>----------------</p>
<p>2) Why didn&#8217;t you try contig lengths larger than 300, for instance 1000, 5000, 10000? Would your model perform better with those contig lengths?</p>
<p>Reply: As mentioned in &#8220;Data processing and labeling&#8221; subsection, we also tried sequence length 500, but it performed clearly worse than 300. In initial experiments we also briefly tested sequence length 1000, but the results were even weaker. We hypothesize that this is due to having less data points with longer (more restrictive) sequence lengths. </p>
<p>With sequence length 500 we have 3 times less data than with sequence length 300. With sequence length 1000 we have 20 times less data than with length 300. Empirical results show that in the current case having more data is the most important.</p>
<p>-----------------</p>
<p>3) The tool requires further validation with more data. I understand that you are using 19 metagenomes and using partitions/baselines to train, and the AUROC can be considered a good parameter to evaluate your model. However, it is imperative to certainly know what is in your metagenome to be able to validate the current technology. I&#8217;d suggest to generate simulated human metagenomes using taxon profiles similar to the ones that you used in the training model. I would suggest using NeSSM, ART, MetaSim for the simulations to determine how your trained model performs in completely new datasets.</p>
<p>Reply: We believe that the true effectiveness of our models can only be measured by their performance on real data, preferably originating from a sequencing experiment that has not been used for training the model. Leaving an entire dataset out from the training procedure (using training set) and model picking (using validation data) procedure achieves just that.</p>
<p>That said, we agree that working with real data, there is always some risk of unknown biases making results nicer than they should be. We have thus repeated our experiments on simulated data, as requested. </p>
<p>We considered all three simulation tools mentioned by the reviewer and decided to use ART, as it is most understandable and easy to use. The article now contains a new methods section describing the simulation procedure and parameters, and a results subsection describing the results obtained.</p>
<p>The results showed that the model that was trained our 19 metagenomic experiments produced AUROC 0.751 on the simulated data. Even though the model performs clearly above the random level, it is indeed a more moderate performance compared to the model performance on the main test set. However,  consider that the simulated dataset was generated based on randomly picked viral reference genomes from GenBank without any prior selection.</p>
<p>Using a ViraMiner model both trained and tested on simulated data, the test AUROC increases to 0.921. We believe that this further proves that the architecture is useful and able to generalize to different datasets.</p>
<p>---------------</p>
<p>Per line comments:</p>
<p>Line 40: Builds on top of the CNN architecture of Ren [25]. </p>
<p>Reply: Changed as requested </p>
<p>Line 101: Spell out AUROC as Area Under the Receiver Operating Characteristics the first time in the text. </p>
<p>Reply: Changed as requested </p>
<p>Line 185: You can say something like: &#8220;trained to identify viruses infecting prokaryotic </p>
<p>organisms&#8221; </p>
<p>Reply: We thank the reviewer for pointing this out. Changed as requested </p>
<p>Line 251: replace producing by produced.  </p>
<p>Reply: Changed as requested </p>
<p>-----------------------------------------------------------------------------------------------------------------------</p>
<p>Reviewer #2: </p>
<p>This article proposed a new machine learning approach for characterizing unknown metagenomics contigs. The approach using ANN with raw DNA sequences as inputs is unique and novel. The authors demonstrated that the proposed approach &#8220;viralMiner&#8221; performs better than random forests and kmer as baseline. The writing is excellent as well. Because of the novelty of the approach, I recommend the paper accepted after minor revision.</p>
<p>Several minor areas can be improved:</p>
<p>1) The AUC is 0.92, however, the real performance 0.9 accuracy and 0.32 recall is not as impressive. I believe these numbers are much worse than blast, so I recommend emphasize this in the abstract.</p>
<p>Reply:      </p>
<p>Blast was used as reference method (i.e. always correct by definition) and a comparison of performance with the reference method is not useful. In the abstract, we suggest to use our method only after having applied conventional alignment methods (BLAST) in order to further investigate the sequences that are left unlabeled. </p>
<p>Also, as seen from precision-recall curve, instead of precision-recall pair 0.9&amp;0.32, any other pair (e.g. 0.95&amp;0.24 or 1.0&amp;0.151) could have been chosen. It is not possible to foresee which particular precision-recall ratio is the most important to the reader. Hence, we are reluctant to stress one particular pair of values by mentioning them in the abstract.</p>
<p>In this manuscript we have decided to use AUROC as the main metric, because it does not depend neither on class distribution nor on a particular classification threshold. </p>
<p> ---------</p>
<p>2) The real strength of this approach is to detect &#8220;unknown&#8221; contigs which cannot be detected by blast. However the training test validation experiments did not evaluate anything that is &#8220;unknown&#8221;. Maybe the authors can hold out some viral classes in the training and test if the machine learning approach can detect &#8220;unknown&#8221; contigs?</p>
<p>Reply:  We thank the reviewer for this comment. The primary purpose use case of ViraMiner is to identify distant homologs that alignment-based methods cannot detect reliably. To maximally detect those highly divergent viruses, we think that all viral classes should be included in the training dataset. In comparison, detecting new yet unknown viral classes is a much more complicated task since one viral family can be very different from the others. Note that even though the CNN-based method does not use the same type of similarity measures as BLAST or HMMER3, it still must rely on some kind of common features.  </p>
<p>Nevertheless, we have now investigated if ViraMiner is able to identify viruses from a viral class that it had not been trained on. For this purpose, we trained and validated the ViraMiner model on a dataset where all anelloviruses were removed.  We used the same hyperparameters (layer sizes) as above, with the same stepwise training strategy - i.e. no new hyperparameter search was performed. The test set contained non-viral samples (10% of all non-viruses) and the left-out anelloviruses. </p>
<p>In this setting, from the model's point of view anelloviruses are a completely unknown and unseen type of viruses. On this test set, frequency branch alone achieves the best result, with 0.755 AUROC. This is clearly above random performance and translates into getting 11 of the top 20 predictions correct on a test set with 5% prevalence. We conclude that even when dealing with viral sequences that are distant from our training (and validation) samples, using ViraMiner as recommendation system increases the chances of identifying viruses.</p>
<p>-----------</p>
<p>3) A table could be added to show all training viral classes.</p>
<p>Reply: Such table is now provided in the manuscript.</p>
<p>S2 Table. Viral classes in the entire dataset. The first column shows the viral classes (families) found in the dataset, the second column represents number of viruses found by Blast. The sequences are cut into 300 bp long sequences and the third column counts the numbers after the cut. Cutting longer contigs into smaller pieces means that the resulting 300bp training sequences represent different parts of the same virus. &#8220;Others&#8221;, at the last row of table, includes sequences that have by Blast been classified as definitely being viral, but have not been assigned a viral family yet.</p>
<supplementary-material id="pone.0222271.s003" mimetype="application/pdf" position="float" ns0:href="info:doi/10.1371/journal.pone.0222271.s003" ns0:type="simple">
<label>Attachment</label>
<caption>
<p>Submitted filename: <named-content content-type="submitted-filename">Response to Reviewers.pdf</named-content></p>
</caption>
</supplementary-material>
</body>
</sub-article>
<sub-article article-type="editor-report" id="pone.0222271.r003" specific-use="decision-letter">
<front-stub>
<article-id pub-id-type="doi">10.1371/journal.pone.0222271.r003</article-id>
<title-group>
<article-title>Decision Letter 1</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name name-style="western">
<surname>Melcher</surname>
<given-names>Ulrich</given-names>
</name>
<role>Academic Editor</role>
</contrib>
</contrib-group>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Ulrich Melcher</copyright-holder>
<license ns0:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<related-object document-id="10.1371/journal.pone.0222271" document-id-type="doi" document-type="article" id="rel-obj003" link-type="peer-reviewed-article" />
<custom-meta-group>
<custom-meta>
<meta-name>Submission Version</meta-name>
<meta-value>1</meta-value>
</custom-meta>
</custom-meta-group>
</front-stub>
<body>
<p>
<named-content content-type="letter-date">27 Aug 2019</named-content>
</p>
<p>ViraMiner: deep learning on raw DNA sequences for identifying viral genomes in human samples</p>
<p>PONE-D-19-16058R1</p>
<p>Dear Dr. Tampuu,</p>
<p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
<p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
<p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" ns0:href="https://www.editorialmanager.com/pone/" ns0:type="simple">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email ns0:type="simple">authorbilling@plos.org</email>.</p>
<p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email ns0:type="simple">onepress@plos.org</email>.</p>
<p>With kind regards,</p>
<p>Ulrich Melcher</p>
<p>Academic Editor</p>
<p>PLOS ONE</p>
<p>Additional Editor Comments (optional):</p>
<p>I apologize for the various delays and misunderstandings.&#160; As recognized during the first reading, the submission showed great promise, but also some language work.&#160; The current revision is much more comprehensible.&#160; I will leave it up to the authors to act on my suggestions for this version.</p>
<p>Line 130</p>
<p>In here, we exemplify the use of ViraMiner a recommendation system.</p>
<p>Better?:</p>
<p>Herein, we exemplify the use of ViraMiner as a recommendation system.</p>
<p>152</p>
<p>because among our datasets largest number</p>
<p>better?:</p>
<p>because, among our datasets, the largest number</p>
<p>l.174</p>
<p>In addition, we investigated if ViraMiner</p>
<p>In addition, we investigated whether ViraMiner</p>
<p>l. 236&#160; number disagreement</p>
<p>"The most important criteria that ViraMiner had to satisfy, however, were"</p>
<p>OR use plural "Criterion"</p>
<p>L. 416 add "the"</p>
<p>In the&#160; results section</p>
</body>
</sub-article>
<sub-article article-type="editor-report" id="pone.0222271.r004" specific-use="acceptance-letter">
<front-stub>
<article-id pub-id-type="doi">10.1371/journal.pone.0222271.r004</article-id>
<title-group>
<article-title>Acceptance letter</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name name-style="western">
<surname>Melcher</surname>
<given-names>Ulrich</given-names>
</name>
<role>Academic Editor</role>
</contrib>
</contrib-group>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Ulrich Melcher</copyright-holder>
<license ns0:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" ns0:href="http://creativecommons.org/licenses/by/4.0/" ns0:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<related-object document-id="10.1371/journal.pone.0222271" document-id-type="doi" document-type="article" id="rel-obj004" link-type="peer-reviewed-article" />
</front-stub>
<body>
<p>
<named-content content-type="letter-date">3 Sep 2019</named-content>
</p>
<p>PONE-D-19-16058R1 </p>
<p>ViraMiner: deep learning on raw DNA sequences for identifying viral genomes in human samples </p>
<p>Dear Dr. Tampuu:</p>
<p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
<p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email ns0:type="simple">onepress@plos.org</email>.</p>
<p>For any other questions or concerns, please email <email ns0:type="simple">plosone@plos.org</email>. </p>
<p>Thank you for submitting your work to PLOS ONE.</p>
<p>With kind regards,</p>
<p>PLOS ONE Editorial Office Staff</p>
<p>on behalf of</p>
<p>Dr. Ulrich Melcher  </p>
<p>Academic Editor</p>
<p>PLOS ONE</p>
</body>
</sub-article>
</article>