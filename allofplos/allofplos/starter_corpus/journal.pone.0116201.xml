<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-14-23531</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0116201</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Relation between Financial Market Structure and the Real Economy: Comparison between Clustering Methods</article-title>
<alt-title alt-title-type="running-head">Financial Market Structure and the Real Economy</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Musmeci</surname> <given-names>Nicoló</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Aste</surname> <given-names>Tomaso</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Di Matteo</surname> <given-names>T.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Mathematics, King’s College London, The Strand, London, WC2R 2LS, UK</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Computer Science, UCL, Gower Street, London, WC1E 6BT, UK</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Systemic Risk Centre, London School of Economics and Political Sciences, London, WC2A2AE, UK</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Preis</surname> <given-names>Tobias</given-names></name>
<role>Academic Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Warwick, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: NM TA TDM. Performed the experiments: NM TA TDM. Analyzed the data: NM TA TDM. Contributed reagents/materials/analysis tools: NM TA TDM. Wrote the paper: NM TA TDM.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">t.aste@ucl.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>18</day>
<month>3</month>
<year>2015</year>
</pub-date>
<volume>10</volume>
<issue>3</issue>
<elocation-id>e0116201</elocation-id>
<history>
<date date-type="received">
<day>27</day>
<month>5</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>12</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Musmeci et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0116201" xlink:type="simple"/>
<abstract>
<p>We quantify the amount of information filtered by different hierarchical clustering methods on correlations between stock returns comparing the clustering structure with the underlying industrial activity classification. We apply, for the first time to financial data, a novel hierarchical clustering approach, the Directed Bubble Hierarchical Tree and we compare it with other methods including the Linkage and k-medoids. By taking the industrial sector classification of stocks as a benchmark partition, we evaluate how the different methods retrieve this classification. The results show that the Directed Bubble Hierarchical Tree can outperform other methods, being able to retrieve more information with fewer clusters. Moreover, we show that the economic information is hidden at different levels of the hierarchical structures depending on the clustering method. The dynamical analysis on a rolling window also reveals that the different methods show different degrees of sensitivity to events affecting financial markets, like crises. These results can be of interest for all the applications of clustering methods to portfolio optimization and risk hedging.</p>
</abstract>
<funding-group>
<funding-statement>Partial funding from: COST Action TD1210; ESRC ES/K002309/1. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="11"/>
<table-count count="0"/>
<page-count count="24"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The data used in this study are available through Bloomberg terminals. The reference link to the dataset is: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.bloomberg.com/markets/stocks/">http://www.bloomberg.com/markets/stocks/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Correlation-based networks have been extensively used in Econophysics as tools to filter, visualise and analyse financial market data [<xref ref-type="bibr" rid="pone.0116201.ref001">1</xref>–<xref ref-type="bibr" rid="pone.0116201.ref008">8</xref>]. Since the seminal work of Mantegna on the Minimum Spanning Tree (MST) [<xref ref-type="bibr" rid="pone.0116201.ref001">1</xref>] they have provided insights into several aspects of financial markets including financial crises [<xref ref-type="bibr" rid="pone.0116201.ref009">9</xref>–<xref ref-type="bibr" rid="pone.0116201.ref015">15</xref>]. The MST is strictly related [<xref ref-type="bibr" rid="pone.0116201.ref016">16</xref>] to a hierarchical clustering algorithm, namely the Single Linkage (SL) [<xref ref-type="bibr" rid="pone.0116201.ref017">17</xref>]. Starting from a set of elements (e.g., stocks) and a related distance matrix (e.g., a convenient transformation of the stocks correlation matrix [<xref ref-type="bibr" rid="pone.0116201.ref001">1</xref>]), the SL performs an agglomerative algorithm that ends up with a tree (dendrogram) that arranges the elements into a hierarchical structure [<xref ref-type="bibr" rid="pone.0116201.ref016">16</xref>]. The filtering procedure linked to MST and SL has been succesfully applied to improve portfolio optimization [<xref ref-type="bibr" rid="pone.0116201.ref010">10</xref>]. Another hierarchical clustering method, the Average Linkage (AL), has been shown to be associated to a slightly different version of spanning tree [<xref ref-type="bibr" rid="pone.0116201.ref018">18</xref>], called Average Linkage Minimum Spanning Tree. Another variant of Linkage methods, not associated to a spanning tree representation, is the Complete Linkage (CL) [<xref ref-type="bibr" rid="pone.0116201.ref017">17</xref>].</p>
<p>The MST is the first but not the only correlation-based filtered network studied in the literature. In particular the Planar Maximally Filtered Graph (PMFG) is a further step from the MST, that is able to retain a higher amount of information [<xref ref-type="bibr" rid="pone.0116201.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0116201.ref004">4</xref>, <xref ref-type="bibr" rid="pone.0116201.ref019">19</xref>], having less strict topological constraint allowing to keep a larger number of links. The PMFG has been proven to have interesting practical applications, in particular in the field of investment strategies to hedge risk [<xref ref-type="bibr" rid="pone.0116201.ref020">20</xref>].</p>
<p>Since the MST has associated a clustering method, and the PMFG is a generalization of the MST, it could be raised the question whether the PMFG provides a clustering method that exploits this higher amount of information. In a recent work [<xref ref-type="bibr" rid="pone.0116201.ref021">21</xref>] it has been shown that this is the case: the Directed Bubble Hierarchical Tree (DBHT) is a novel hierarchical clustering method that takes advantage of the topology of the PMFG yielding a clustering partition and an associated hierarchy. (For the DBHT algorithm refer to supplementary material of [<xref ref-type="bibr" rid="pone.0116201.ref021">21</xref>] or, for a slightly modified version, to [<xref ref-type="bibr" rid="pone.0116201.ref022">22</xref>].) The approach is completely different from the agglomerative one adopted in the Linkage methods: the idea of DBHT is to use the hierarchy hidden in the topology of a PMFG, due to its property of being made of three-cliques [<xref ref-type="bibr" rid="pone.0116201.ref021">21</xref>, <xref ref-type="bibr" rid="pone.0116201.ref023">23</xref>]. In [<xref ref-type="bibr" rid="pone.0116201.ref021">21</xref>] the DBHT hierarchical clustering has been applied to synthetic and biological data, showing that it can outperform many other clustering methods. Since DBHT exploits the topology of the correlation network it can be viewed as an example of community detection algorithm in graphs [<xref ref-type="bibr" rid="pone.0116201.ref024">24</xref>].</p>
<p>In this paper we present the first application of DBHT to financial data. To this purpose we have analysed the correlations among log-returns of <italic>N</italic> = 342 US stock prices, across a period of 15 years (1997–2012). We have studied the structure of the clustering and we have compared the results with other clustering methods, namely: the single Linkage, the average Linkage, the complete Linkage and the k-medoids [<xref ref-type="bibr" rid="pone.0116201.ref025">25</xref>] (a partitioning method strictly related to the k-means [<xref ref-type="bibr" rid="pone.0116201.ref026">26</xref>]). The perspective of our study focuses not only on the clusterings, but on the entire hierarchies associated to those clusterings, covering all the different levels of the hierarchical structures. We have also studied the dynamical evolution of these structures, describing how the hierarchies change with time. The dynamical perspective is crucial for applications, in particular for what concerns hedging risk and portfolio optimization. For this reason we have given a particular attention to the effects of financial crises on the hierarchical structures, highlighting differences among the clustering methods.</p>
<p>Another aspect we have focused on is the role of the market mode in shaping the clustering structure. To this aim we have carried out our analyses also on log-returns detrended of the market mode [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>]: this procedure has been proven to provide a more robust clustering that can carry information not evident in the original correlation matrix [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>]. The comparison between the detrended and non-detrended correlation structures can shed light on the effect of common factors in the collective market dynamics especially during crisis.</p>
<p>In order to compare quantitatively the amount of information retrieved by the different hierarchical clustering methods, we have taken the Industrial Classification Benchmark (ICB) as a benchmark community partition for the stocks and then we have compared it with the output of each clustering method. The idea is to use the degree of similarity between the ICB and the clustering as a proxy for the amount of information filtered by the methods. The degree of similarity is measured by using tools as the Adjusted Rand Index [<xref ref-type="bibr" rid="pone.0116201.ref028">28</xref>] and the Hypergeometric hypothesis test [<xref ref-type="bibr" rid="pone.0116201.ref029">29</xref>]. This is not the first work comparing correlation-based clusterings and industrial sector classification; however to our knowledge the comparison has been performed only qualitatively so far [<xref ref-type="bibr" rid="pone.0116201.ref030">30</xref>], with the exception of ref. [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>] where however only one clustering method is analysed. In Ref. [<xref ref-type="bibr" rid="pone.0116201.ref031">31</xref>] the authors have compared quantitatively different methods in terms of amount of filtered information: yet this comparison was performed without looking at the industrial sector classification and by assuming a multivariate Gaussian distribution for the stocks returns [<xref ref-type="bibr" rid="pone.0116201.ref016">16</xref>]. Our approach is instead model-free. This is a relevant improvement since multivariate Gaussian models are known to be inaccurate to describe stocks returns [<xref ref-type="bibr" rid="pone.0116201.ref032">32</xref>, <xref ref-type="bibr" rid="pone.0116201.ref033">33</xref>] and, more generally, the correlation-based networks obtained from real data have been found to be incompatible with some widespread models for asset returns [<xref ref-type="bibr" rid="pone.0116201.ref034">34</xref>].</p>
<p>The paper is organized as follows. In Section “Methods” we describe the main tools we have used to carry out the analyses. In Section “Dataset and preliminary analyses” we present the dataset and some preliminary empirical analyses on it. In Section “Static analysis” we perform a set of analyses on correlations and clusterings calculated by taking the whole 15 years period as time window, hence ending up with only one hierarchical structure of dependences for each method. In particular we compare the clustering compositions in terms of ICB supersectors for different clustering methods and we measure the similarity between clusterings and ICB partition. In Section “Dynamical analysis” we perform instead analyses using a dynamical approach, with moving time windows. In Section “Discussion” we discuss the results and the future directions of our work. More details on the clustering methods we have analysed are reported in the Supplementary Information (SI, Section S2 of <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref>).</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>To investigate and compare the DBHT with the other clustering methods we have performed a series of analyses that aim at describing different aspects of each clustering, from their structure to the economic information they contain. Here we introduce and describe the tools we have used.</p>
<sec id="sec003">
<title>Clustering methods</title>
<p>In this paper we compare four different clustering methods, namely: Single Linkage (SL), Average Linkage (AL), Complete Linkage (CL), Directed Bubble Hierarchical Tree (DBHT), k-medoids. All these methods require a suitable distance measure and DBHT also requires an associated similarity measure. In this paper we use the Pearson’s correlation coefficients <italic>ρ</italic><sub><italic>ij</italic></sub> between pairs of stocks as similarity measure and we use the associated Euclidean distance <inline-formula id="pone.0116201.e001"><mml:math id="M1" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>; <italic>ρ</italic> and <italic>D</italic> are <italic>N</italic>×<italic>N</italic> symmetric matrices with, respectively, all ones and all zeros on the diagonal. Let us here briefly list the main features and requirements of these clustering methods.</p>
<list list-type="bullet">
<list-item><p><bold>Single Linkage</bold> (SL), is a hierarchical clustering algorithm [<xref ref-type="bibr" rid="pone.0116201.ref017">17</xref>]. Given the distance matrix, it starts assigning to each object its own cluster, and then at each step merges together the least distant pair of clusters, until only one cluster remains. At every step the distance between clusters <italic>A</italic> and <italic>B</italic> is updated taking the minimum distance between elements inside the clusters:
<disp-formula id="pone.0116201.e002"><alternatives><graphic id="pone.0116201.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e002"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:munder> <mml:mi>D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
SL is called an <italic>agglomerative</italic> clustering, since it begins with a partition of <italic>N</italic> clusters and then proceeds merging them. The final output is a dendrogram, that is a tree showing the hierarchical structure. The distance measure in this dendrogram is an ultrametric distance (see for instance [<xref ref-type="bibr" rid="pone.0116201.ref001">1</xref>]). A cluster partition can be obtained by choosing the number of clusters (that is therefore a free parameter) and cutting the dendrogram at the appropriate level. The SL algorithm is strictly related to the one that provides a Minimum Spanning Tree (MST) [<xref ref-type="bibr" rid="pone.0116201.ref016">16</xref>]. The MST is a tree graph, it contains exactly <italic>N</italic>−1 links. There is therefore a strict relation between the two tools. However the MST retains some information that the SL dendrogram throws away [<xref ref-type="bibr" rid="pone.0116201.ref016">16</xref>].</p></list-item>
<list-item><p><bold>Average Linkage</bold> (AL) [<xref ref-type="bibr" rid="pone.0116201.ref017">17</xref>] is a hierarchical clustering algorithm which is constructed in the same way as the SL, but with <xref ref-type="disp-formula" rid="pone.0116201.e002">Eq. 1</xref> replaced by:
<disp-formula id="pone.0116201.e003"><alternatives><graphic id="pone.0116201.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e003"/><mml:math id="M3" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mrow><mml:mi>m</mml:mi> <mml:mi>e</mml:mi> <mml:mi>a</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:munder> <mml:mi>D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p></list-item>
<list-item><p><bold>Complete Linkage</bold> (CL) [<xref ref-type="bibr" rid="pone.0116201.ref017">17</xref>] is another variant of SL, where <xref ref-type="disp-formula" rid="pone.0116201.e002">Eq. 1</xref> is replaced by:
<disp-formula id="pone.0116201.e004"><alternatives><graphic id="pone.0116201.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>d</mml:mi> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo movablelimits="true" form="prefix">max</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:munder> <mml:mi>D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p></list-item>
<list-item><p><bold>Directed Bubble Hierarchical Tree</bold> (DBHT) [<xref ref-type="bibr" rid="pone.0116201.ref021">21</xref>], is instead a novel hierarchical clustering method that exploits the topological property of the PMFG (Planar Maximally Filtered Graph) in order to assign the clustering. The PMFG is a generalization of the MST, that is included in the PMFG as a subgraph. It can be constructed by recursively joining together with an edge nodes with the smallest distance restricting the procedure to only edges that do not violate graph planarity condition. The PMFG contains the MST as a sub-graph but it retains a larger number of links than the MST (3(<italic>N</italic>−2) instead of <italic>N</italic>−1). The basic elements of a PMFG are three-cliques (subgraphs made of three nodes all reciprocally connected). The DBHT exploits this topological structure, and in particular the distinction between separating and non-separating three-cliques, to identify a clustering partition of all nodes in the PMFG [<xref ref-type="bibr" rid="pone.0116201.ref021">21</xref>].</p>
<p>The Linkage algorithms look at the sorted list of distances <italic>D</italic><sub><italic>ij</italic></sub>, build the dendrogram by gathering subsets of stocks with lowest distances and then find the clustering from the dendrogram after choosing the number of clusters as free parameter. The DBHT instead reverses this order: first of all the clusters are identified by means of topological considerations on the planar graph, then the hierarchy is constructed both inter-clusters and intra-clusters. The difference involves therefore both the kind of information exploited and the methodological approach.</p></list-item>
<list-item><p><bold>k-medoids</bold> is a partitioning clustering method closely related to k-means [<xref ref-type="bibr" rid="pone.0116201.ref026">26</xref>]. It takes the number of clusters <italic>N</italic><sub><italic>cl</italic></sub> as an input. The algorithm is the so called Partitioning Around Medoids (PAM), and is constructed in the following steps: 1) select randomly <italic>N</italic><sub><italic>cl</italic></sub> “medoids” among the <italic>N</italic> elements; 2) assign each element to the closest medoid; 3) for each medoid, replace the medoid with each point assigned to it and calculate the cost of each configuration; 4) choose the configuration with the lowest cost; 5) repeat 2)-4) until no changes occur. This method, differently from previous, is not a hierarchical method and therefore does not provide a dendrogram but only a partition.</p></list-item>
</list>
</sec>
<sec id="sec004">
<title>Measuring clustering heterogeneity: disparity</title>
<p>Different clustering methods can differ greatly in the clustering output even under the same input conditions. Some clustering methods might provide a subdivision into a few very large clusters and many small clusters, whereas other might display a more homogeneous distribution. In order to characterize the distribution of the cluster cardinality with a single quantity we have calculated for each clustering partition the coefficient of variation:
<disp-formula id="pone.0116201.e005"><alternatives><graphic id="pone.0116201.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>σ</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>S</mml:mi> <mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>σ</italic><sub><italic>S</italic></sub> is the standard deviation
<disp-formula id="pone.0116201.e006"><alternatives><graphic id="pone.0116201.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>a</mml:mi></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>S</mml:mi> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
and the normalization factor ⟨<italic>S</italic>⟩ is the average
<disp-formula id="pone.0116201.e007"><alternatives><graphic id="pone.0116201.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e007"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:mi>S</mml:mi> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>a</mml:mi></mml:munder> <mml:msub><mml:mi>S</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
with <italic>S</italic><sub><italic>a</italic></sub> being the cardinality (number of stocks in) cluster <italic>a</italic> and <italic>N</italic><sub><italic>cl</italic></sub> the number of clusters. In the limit of homogeneous arrangement of stocks among the clusters (i.e. each cluster has the same number of stocks), we obtain <italic>σ</italic><sub><italic>S</italic></sub> = 0 and then <italic>y</italic> = 0. The higher is the degree of heterogeneity in the distribution of sizes, the higher is <italic>σ</italic><sub><italic>S</italic></sub> and therefore <italic>y</italic>. In the following we have used the expression “disparity” to refer to <italic>y</italic>, in order to stress the fact that we use it as a measure of heterogeneity in clusters’ sizes.</p>
</sec>
<sec id="sec005">
<title>Measuring clustering similarity: Adjusted Rand Index</title>
<p>To measure the amount of economic information in each correlation based clustering we have used the Adjusted Rand Index (ℛ<sub><italic>adj</italic></sub>) [<xref ref-type="bibr" rid="pone.0116201.ref028">28</xref>] which is a tool conceived to compare different clusterings on the same set of items [<xref ref-type="bibr" rid="pone.0116201.ref035">35</xref>]. An industrial sector classification is indeed nothing but a partition in communities of the <italic>N</italic> stocks. Therefore we can take the similarity between clustering and industrial sector classification as a proxy for the information detected by the clustering method.</p>
<p>In particular, given two clusterings on the same set of items, ℛ<sub><italic>adj</italic></sub> returns a numerical value equal to 1 for identical clusterings and to 0 for clusterings completely independent which are undistinguishable from a random choice.</p>
<p>The idea behind this measure is to calculate the number of pairs of objects that are in the same cluster in both clusterings, and then to compare this number with the one expected under the hypothesis of independent clusterings. Specifically, and following the notation of [<xref ref-type="bibr" rid="pone.0116201.ref035">35</xref>], let us call <italic>X</italic> the set of the <italic>N</italic> objects (stocks, in our case). Let us call <italic>Y</italic> = {<italic>Y</italic><sub>1</sub>, …, <italic>Y</italic><sub><italic>k</italic></sub>} a clustering which is a partition of <italic>X</italic> into communities which are non-empty disjoint subsets of <italic>X</italic> such that their union equals <italic>X</italic>: <italic>X</italic> = <italic>Y</italic><sub>1</sub>∪ … ∪<italic>Y</italic><sub><italic>k</italic></sub> [<xref ref-type="bibr" rid="pone.0116201.ref035">35</xref>]. Let us also consider another different clustering <italic>Y</italic>′, containing <italic>l</italic> clusters. We call “contingency table” the matrix <italic>M</italic> = {<italic>m</italic><sub><italic>ij</italic></sub>} with coefficients
<disp-formula id="pone.0116201.e008"><alternatives><graphic id="pone.0116201.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≡</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mrow><mml:mi>Y</mml:mi> <mml:mo>′</mml:mo></mml:mrow> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
i.e. the number of objects in the intersection of clusters <italic>Y</italic><sub><italic>i</italic></sub> and <italic>Y</italic>′<sub><italic>j</italic></sub>. Let us call <italic>a</italic> the number of pairs of objects that are in the same cluster both in <italic>Y</italic> and in <italic>Y</italic>′, and <italic>b</italic> the number of pairs that are in two different clusters in both <italic>Y</italic> and <italic>Y</italic>′. Then the Rand Index is defined as the sum of <italic>a</italic> and <italic>b</italic>, normalized by the total number of pairs in <italic>X</italic>:
<disp-formula id="pone.0116201.e009"><alternatives><graphic id="pone.0116201.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ℛ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>Y</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>l</mml:mi></mml:munderover> <mml:mfenced separators="" open="(" close=")"><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mn>2</mml:mn></mml:mfrac></mml:mfenced> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
We then use, as null hypothesis associated to two independent clusterings, the generalized hypergeometric distribution and define the Adjusted Rand Index as the difference between the Rand Index and its mean value under the null hypothesis, normalized by the maximum that this difference can reach:
<disp-formula id="pone.0116201.e010"><alternatives><graphic id="pone.0116201.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ℛ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>d</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>Y</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>Y</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup> <mml:mfenced separators="" open="(" close=")"><mml:mfrac linethickness="0pt"><mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mn>2</mml:mn></mml:mfrac></mml:mfenced> <mml:mo>−</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where
<disp-formula id="pone.0116201.e011"><alternatives><graphic id="pone.0116201.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi> <mml:mi>k</mml:mi></mml:munderover> <mml:mfenced separators="" open="(" close=")"><mml:mfrac linethickness="0pt"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mfenced> <mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi> <mml:mi>l</mml:mi></mml:munderover> <mml:mfenced separators="" open="(" close=")"><mml:mfrac linethickness="0pt"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mo>j</mml:mo><mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mfenced> <mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mspace width="3.33333pt"/><mml:msub><mml:mi>t</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
We have ℛ<sub><italic>adj</italic></sub> ∈ [−1, 1], with 1 correspondent to the case of identical clusterings and 0 to two completely un-correlated clusterings. Negative values instead show anti-correlation between <italic>Y</italic> and <italic>Y</italic>′ (that is, the number of pairs classified in the same way by <italic>Y</italic> and <italic>Y</italic>′ is less than what expected assuming a random overlapping between the two clusterings).</p>
</sec>
<sec id="sec006">
<title>Hypergeometric test for cluster-industry overexpression</title>
<p>The Adjusted Rand Index provides an overall measure of similarity between the clustering partition and the industrial classification. In order to analize how much each industrial sector is retrieved by each cluster we must look at the stocks respectively within a given cluster and a given sector and measure the number of stocks in common. If the percentage of stocks in common between a cluster and an industrial sector is sensitively higher than what expected from a random overlapping of communities we say that the cluster <italic>overexpresses</italic> a specific sector. To quantify such overexpression we use a statistical one-tail hypothesis test, where the null hypothesis is the Hypergeometric distribution which describes the probability that by random chance two communities of given sizes have in common <italic>k</italic> objects over a total of <italic>N</italic> [<xref ref-type="bibr" rid="pone.0116201.ref036">36</xref>, <xref ref-type="bibr" rid="pone.0116201.ref037">37</xref>]. In particular, let us call <italic>Y</italic><sub><italic>i</italic></sub> a cluster in our clustering and <inline-formula id="pone.0116201.e012"><mml:math id="M12" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> a sector. We want to verify whether <italic>Y</italic><sub><italic>i</italic></sub> overexpresses <inline-formula id="pone.0116201.e013"><mml:math id="M13" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. If <italic>k</italic> is the number of stocks in common between <inline-formula id="pone.0116201.e014"><mml:math id="M14" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and <italic>Y</italic><sub><italic>i</italic></sub>, and ∣<italic>Y</italic><sub><italic>i</italic></sub>∣, <inline-formula id="pone.0116201.e015"><mml:math id="M15" overflow="scroll"><mml:mrow><mml:mo stretchy="false">∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo></mml:mrow></mml:math></inline-formula> are the cardinalities of the cluster and the sector respectively, then the Hypergeometric distribution is [<xref ref-type="bibr" rid="pone.0116201.ref036">36</xref>]:
<disp-formula id="pone.0116201.e016"><alternatives><graphic id="pone.0116201.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e016"/><mml:math id="M16" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>=</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="3.33333pt"/><mml:mo>=</mml:mo> <mml:mspace width="3.33333pt"/><mml:mfrac><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced> <mml:mfenced separators="" open="(" close=")"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mi>N</mml:mi> <mml:mo>−</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>−</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow> <mml:mfenced separators="" open="(" close=")"><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
This is the null hypothesis for the test: to be distinguishable by a random overlap the number <italic>k</italic> of stocks in common must be significantly different from a random overlap and therefore <italic>P</italic>(<italic>X</italic> = <italic>k</italic>) must be small. If <italic>P</italic>(<italic>X</italic> = <italic>k</italic>) is less than the significance level, then it is said that the test is rejected. If the test is not rejected, then it means that we cannot reject the hypothesis that the <italic>k</italic> stocks in <italic>Y</italic><sub><italic>i</italic></sub> coming from a sector <inline-formula id="pone.0116201.e017"><mml:math id="M17" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> are picked up just by chance, without any preference for that sector. If instead the test is rejected, we conclude that the cluster <italic>Y</italic><sub><italic>i</italic></sub> overexpresses the sector <inline-formula id="pone.0116201.e018"><mml:math id="M18" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. We have chosen a significance level of 1%, together with the Bonferroni correction for multiple tests, which reduces remarkably the significance level of each test [<xref ref-type="bibr" rid="pone.0116201.ref036">36</xref>] (more details in Section <xref ref-type="sec" rid="sec014">“Industries overexpression”</xref>).</p>
</sec>
</sec>
<sec id="sec007">
<title>Dataset and preliminary analyses</title>
<p>The correlation structure studied in this paper concerns <italic>N</italic> = 342 stocks from the New York Stock Exchange (NYSE). A complete description of the dataset is in Supplementary Information (Section S1 of <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref>). We have analysed the closing daily prices <italic>P</italic><sub><italic>i</italic></sub>(<italic>t</italic>) with <italic>i</italic> = 1, …, <italic>N</italic>, during the time between 1 January 1997 to 31 December 2012 (4026 trading days). From the prices, we have calculated the daily log-returns [<xref ref-type="bibr" rid="pone.0116201.ref032">32</xref>, <xref ref-type="bibr" rid="pone.0116201.ref033">33</xref>]:
<disp-formula id="pone.0116201.e019"><alternatives><graphic id="pone.0116201.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>≡</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>−</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>From the set of <italic>N</italic> log-return time series over a time window <italic>T</italic> = [<italic>t</italic><sub><italic>start</italic></sub>, <italic>t</italic><sub><italic>end</italic></sub>] we have then calculated the <italic>N</italic> × <italic>N</italic> correlation matrix <italic>ρ</italic>(<italic>T</italic>), whose elements are given by the Pearson estimator [<xref ref-type="bibr" rid="pone.0116201.ref038">38</xref>]:
<disp-formula id="pone.0116201.e020"><alternatives><graphic id="pone.0116201.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e020"/><mml:math id="M20" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msub> <mml:msqrt><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msubsup><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msubsup><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where ⟨ … ⟩<sub><italic>T</italic></sub> represents the average over the time window <italic>T</italic>. The clustering analysis is then carried out on the distance matrix D, with elements <inline-formula id="pone.0116201.e021"><mml:math id="M21" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>T</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>T</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. For the analysis on moving windows we used an exponentially smoothed version of the Pearson estimator in <xref ref-type="disp-formula" rid="pone.0116201.e020">Eq.13</xref>, where terms in the average are multiplied by a weight <inline-formula id="pone.0116201.e022"><mml:math id="M22" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mi>exp</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mi>θ</mml:mi></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <italic>t</italic> ∈ <italic>T</italic> according to their temporal distance from the last trading time <italic>t</italic><sub><italic>end</italic></sub> in the window <italic>T</italic>. This exponential smoothing scheme [<xref ref-type="bibr" rid="pone.0116201.ref039">39</xref>] allows to mitigate excessive sensitiveness to outliers in remote observations. The parameter <italic>θ</italic> has been set to <italic>θ</italic> = <italic>T</italic>/3 according to previously established criteria [<xref ref-type="bibr" rid="pone.0116201.ref039">39</xref>].</p>
<p>By using this moving time window approach we have performed a set of preliminary analyses on the average correlation of our set of stocks, looking in particular at the 2007–2008 financial crisis. Specifically, we have considered a set of <italic>n</italic> = 100 overlapped time windows <italic>T</italic><sub><italic>k</italic></sub> (<italic>k</italic> = 1, …, <italic>n</italic>) of length <italic>L</italic> = 1000 trading days (four years) with 30 days shift between subsequent windows. The average correlation ⟨<italic>ρ</italic>(<italic>T</italic><sub><italic>k</italic></sub>)⟩<sub><italic>ij</italic></sub> on these windows is shown in <xref ref-type="fig" rid="pone.0116201.g001">Fig. 1</xref> (blue circles) for <italic>L</italic> = 1000 and <italic>n</italic> = 100. To test robustness, we have verified that the results are similar also for other window sizes, namely <italic>L</italic> = 750 and <italic>L</italic> = 1250.</p>
<fig id="pone.0116201.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Demonstration that the average correlation evolves during time with large changes during periods of market instability.</title>
<p>The figure reports the average correlation for each time window <italic>T</italic><sub><italic>k</italic></sub> with <italic>k</italic> = 1, …, <italic>n</italic> (<italic>n</italic> = 100, each time window has length <italic>L</italic> = 1000 trading days), for both non-detrended (blue circles) and detrended log-returns (green squares). The average correlation is highly reduced by detrending the market mode.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g001"/>
</fig>
<p>We have also studied the detrended log-returns, i.e. log-returns subtracted of the average return over all the stocks. Specifically, following [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>], we have considered a single factor model for each stock <italic>i</italic>:
<disp-formula id="pone.0116201.e023"><alternatives><graphic id="pone.0116201.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0116201.e023"/><mml:math id="M23" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where the common market factor <italic>I</italic>(<italic>t</italic>) is the market average return, <inline-formula id="pone.0116201.e024"><mml:math id="M24" overflow="scroll"><mml:mrow><mml:mi>I</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the residuals, <italic>c</italic><sub><italic>i</italic></sub>(<italic>t</italic>), are the log-returns detrended by the market mode. After estimating the coefficients <italic>α</italic><sub><italic>i</italic></sub> and <italic>β</italic><sub><italic>i</italic></sub> with a linear regression, the residuals <italic>c</italic><sub><italic>i</italic></sub>(<italic>t</italic>) can be calculated and used to evaluate the new correlation matrix [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>]. We denote this matrix, estimated in the time window <italic>T</italic><sub><italic>k</italic></sub> with <italic>ρ</italic><sup><italic>R</italic></sup>(<italic>T</italic><sub><italic>k</italic></sub>). We refer to the analyses based on this kind of correlation matrix as the “detrended case”. These detrended correlation matrices are worth analyzing since they have been found to provide a richer and more robust clustering [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>] that can carry information not evident in the original correlation matrix [<xref ref-type="bibr" rid="pone.0116201.ref040">40</xref>]. In this paper we have carried the analyses using both detrended and non-detrended log-returns, compared the two and looked for differences that might highlight the effect of common factors on the market correlation structure.</p>
<p>In <xref ref-type="fig" rid="pone.0116201.g001">Fig. 1</xref> it is shown the average correlation for these detrended correlation matrices, i.e. ⟨<italic>ρ</italic><sup><italic>R</italic></sup>(<italic>T</italic><sub><italic>k</italic></sub>)⟩<sub><italic>ij</italic></sub>, compared to the average correlation for the non-detrended correlation matrices ⟨<italic>ρ</italic>(<italic>T</italic><sub><italic>k</italic></sub>)⟩<sub><italic>ij</italic></sub>. As one can see, the subtraction of the market mode decreases by about 50% the average level of correlation, pointing out the important role of the market factor in the correlation structure. However, we can still observe the increase correspondent to the financial crisis in 2007–2008. Moreover, and interestingly, the level of correlation reduces after a peak in 2009, unlike the non-detrended case. This fact suggests that, although the market mode plays an important role in terms of average amount of correlation, yet the peak of the last financial crisis seems not to be only a global market trend. We therefore suggest that it could involve, to some extent, the internal dynamics among stocks that remains after the subtraction.</p>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<sec id="sec009">
<title>Static analysis</title>
<sec id="sec010">
<title>DBHT clusters composition</title>
<p>In this section we present results for the PMFG and DBHT clustering method applied to the set of data described in the previous section. In particular we have computed the PMFG and the correspondent DBHT clustering in the time period from 1997 to 2012 and we plot it in <xref ref-type="fig" rid="pone.0116201.g002">Fig. 2 a)</xref> where we highlight, with the same color, stocks belonging to the same DBHT cluster. In the same figure (<xref ref-type="fig" rid="pone.0116201.g002">Fig. 2 b)</xref>) we plot the PMFG calculated by using the detrended log-returns (<xref ref-type="disp-formula" rid="pone.0116201.e023">Eq. 14</xref>) as comparison. This PMFG looks more structured than the first one, with more homogeneous clustering sizes.</p>
<fig id="pone.0116201.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Visualization of the Planar Maximally Filtered Graph (PMFG) and DBHT clusters, for both non-detrended and detrended log-returns.</title>
<p>a) PMFG calculated on the entire period 1997–2012, using non-detrended log-returns. Stocks of the same color belong to the same DBHT cluster. b) PMFG calculated on the same data as in a), but using detrended log-returns. Stocks of the same color belong to the same DBHT cluster.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g002"/>
</fig>
<p>We have then analysed the DBHT clustering structure in terms of industrial sectors. It is well known that the hierarchical structure of the stock return correlations shows a deep similarity with the industrial sectors categorization [<xref ref-type="bibr" rid="pone.0116201.ref001">1</xref>] [<xref ref-type="bibr" rid="pone.0116201.ref030">30</xref>] [<xref ref-type="bibr" rid="pone.0116201.ref040">40</xref>]. This fact supports the intuitive argument that returns of stocks in the same industrial sector are affected mainly by the same flows of information and economic enviroment. We can turn around the reasoning and claim that thus a desirable feature of a clustering method on stocks data is to retrieve, to some extent, the industrial sector classification. We will refer to the Industrial Classification Benchmark (ICB) [<xref ref-type="bibr" rid="pone.0116201.ref041">41</xref>]; this categorization divides stocks into 19 different supersectors, that in turn are gathered in 10 different Industries. For more details on the composition of our dataset in terms of ICB supersectors, refer to SI (Section S1 and Figure S1 of <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref>). Let us point out that we have run all the analyses in this paper also by using the Yahoo industrial partitioning, obtaining similar results.</p>
<p>In <xref ref-type="fig" rid="pone.0116201.g003">Fig. 3</xref> we report a graphical summary of the clusters obtained applying the DBHT method to the whole time window of data (1997–2012), by using detrended log-returns (the clustering shown in <xref ref-type="fig" rid="pone.0116201.g002">Fig. 2 b)</xref>). In <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref> we describe the same analyses for undetrended log-returns.</p>
<fig id="pone.0116201.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Composition of DBHT clusters in terms of ICB supersectors.</title>
<p>The x-axis represents the cluster labels, the y-axis the number of stocks in each cluster. Each colour corresponds to an ICB supersector (legend on the left hand side). The clustering is obtained by using log-returns detrended by removing the market mode. See the Fig. S3 in <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref> for the case non-detrended.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g003"/>
</fig>
<p>The DBHT retrieves a number of clusters, <italic>N</italic><sub><italic>cl</italic></sub>, equal to 23: to each cluster is associated a bar, whose height represents the number of stocks in the cluster. Each bar is made of different colours, showing the composition of each cluster in terms of ICB supersectors. The legend on the left of the graph reports the corresponding industrial supersectors. Please note that the colours in <xref ref-type="fig" rid="pone.0116201.g003">Fig. 3</xref> identify the ICB supersectors, and they have nothing to do with colours in <xref ref-type="fig" rid="pone.0116201.g002">Fig. 2</xref>, that identify DBHT clusters.</p>
<p>The largest cluster contains 45 stocks (13% of total), the smallest 4. The average size is 14.8. As we can see, there are several supersectors that are overexpressed by one or more clusters, either alone or together with other supersectors: Oil &amp; Gas (clusters 7 and 15), Technology (cluster 18), Utilities (cluster 17), Retail (cluster 9), Health Care (clusters 22 and 23), Food &amp; Beverage (clusters 20 and 21), Personal &amp; Household Goods (cluster 21), Industrial Goods &amp; Services (clusters 12 and 16), Insurance (cluster 11) and Telecommunications (cluster 19). Moreover, there are clusters that, although showing a mixed composition, are composed by supersectors strictly related: clusters 5 and 6 are made of Banks, Financial Services and Insurance, all supersectors that the ICB gathers in the same industry (Financial) at the superior hierarchical step. Similarly, cluster 21 is made entirely of Food &amp; Beverage and Personal &amp; Household Goods stocks, that are both classified in Consumer Goods industry.</p>
</sec>
<sec id="sec011">
<title>Other clustering compositions</title>
<p>We have applied other clustering methods on the same data and compared results with DBHT clustering. The clustering methods considered are Single Linkage (SL), Average Linkage (AL), Complete Linkage (CL) and k-medoids. The number of clusters, that unlike the DBHT is a free-parameter for these methods, has been chosen equal to 23 in this case, in order to compare the bar graphs with the <xref ref-type="fig" rid="pone.0116201.g003">Fig. 3</xref> for DBHT. We plot in <xref ref-type="fig" rid="pone.0116201.g004">Fig. 4 a), b), c) and d)</xref> the clusters composition obtained by using these four clustering methods, namely SL, AL, CL and k-medoids. As for DBHT, the same analyses by using non-detrended log-returns are discussed in SI (Section S3, Figures S3–S6 of <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref>).</p>
<fig id="pone.0116201.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Composition of clustering in terms of ICB supersectors.</title>
<p>The x-axis represents the cluster labels, the y-axis the number of stocks in each cluster. Each colour corresponds to an ICB supersector (the legend is the same as in <xref ref-type="fig" rid="pone.0116201.g003">Fig. 3)</xref>. The graphs show the results for a) SL clustering, b) for AL, c) for CL and d) for k-medoids. The clustering is obtained by using log-returns detrended by removing the market mode.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g004"/>
</fig>
<p>First of all we can observe that for SL there is a strong heterogeneity in the size of clusters, with the presence of a giant cluster containing 318 stocks, and the other clusters made of one, two or three stocks only. This giant cluster contains stocks of all ICB sectors.</p>
<p>The AL case shows instead a more structured clustering: the size of the largest cluster shrinks to 58 stocks, and 6 different clusters of medium size (20–40 stocks) appear. Moreover, these clusters show a much higher overexpression of supersectors than SL, such as Technology (cluster 4), Industrial Goods &amp; Services (cluster 5 and 15), Media (cluster 3) and Financial related supersectors (cluster 23). However there are still 10 clusters whose size is at most 4 stocks.</p>
<p>For the CL and the k-medoids the supersectors overexpression is further improved, becoming as rich as the DBHT one. Especially CL shows overexpression of Technology (cluster 2), Industrial Goods &amp; Services (clusters 4 and 8), Utilities (cluster 17), Oil &amp; Gas (cluster 23), Health Care (cluster 14) and Financial Services (cluster 9). Similar overexpressions are found for the k-medoids case.</p>
<p>These first comparisons are however made under a specific choice of the number of clusters (23), given by the DBHT. One could wonder what happens changing this parameter, i.e. moving along the hierarchical structure provided by each clustering method. Let us stress that the DBHT method gives automatically the number of clusters that is instead an adjustable parameter for the other methods. However, DBHT can also be analysed for a varying number of clusters by thresholding over the clustering hierarchical structure. In the following Sections we discuss a set of quantitative analyses that explore all the hierarchical levels of the DBHT and the other clustering methods.</p>
</sec>
<sec id="sec012">
<title>Disparity in the clusters size</title>
<p>In the previous Section we have seen that the SL shows a giant cluster that contains more than 90% of stocks, whereas DBHT, CL and k-medoids methods have a more homogenous distribution of cluster sizes and the AL seems to be an intermediate case.</p>
<p>Let us here check whether this difference in the structure depends on the choice of the number of clusters for the linkage methods, which might be penalising the SL with respect to the others. In order to do that, we vary the number of clusters <italic>N</italic><sub><italic>cl</italic></sub> for each clustering method by cutting the dendrograms at different levels. For the k-medoids, for which no dendrogram is present, <italic>N</italic><sub><italic>cl</italic></sub> is simply an input parameter of the algorithm. We then calculate the measure of disparity introduced in Methods (<xref ref-type="disp-formula" rid="pone.0116201.e005">Eq. 4</xref>).</p>
<p>In <xref ref-type="fig" rid="pone.0116201.g005">Fig. 5</xref> we show, for each clustering method, how the disparity measure varies with <italic>N</italic><sub><italic>cl</italic></sub>. The graph a) shows the non-detrended case, the graph b) the detrended case. As we can see the SL provides the higher disparity in both cases, regardless of <italic>N</italic><sub><italic>cl</italic></sub>, then the AL, CL and k-medoids follow. The DBHT values are below all of them, this means that the DBHT clustering provides a more homogeneous community assignment at any level of the correlation hierarchy. Moreover, in the market mode case the SL and the AL show the highest values of disparity for <italic>N</italic><sub><italic>cl</italic></sub> in the interval 50–100. The CL and DBHT have instead a flatter pattern, with the highest values occurring for lower values of <italic>N</italic><sub><italic>cl</italic></sub>. Looking at the detrended case in <xref ref-type="fig" rid="pone.0116201.g005">Fig. 5 b)</xref>, the removal of the market mode smooths also the pattern of the AL, whereas the SL is even sharper. Overall, subtracting the market mode makes the clusterings more homogeneous, suggesting that the largest clusters that emerged in SL and AL in the non-detrended case are associated to the market mode dynamics.</p>
<fig id="pone.0116201.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Demonstration that different clustering methods show different degrees of disparity in the clustering structure.</title>
<p>The disparity measure <italic>y</italic> is shown for clusterings at different hierachical levels as function of <italic>N</italic><sub><italic>cl</italic></sub> in the dendrograms, for a) non-detrended log-returns and b) detrended log-returns.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g005"/>
</fig>
<p>The algorithms of SL and AL are indeed expected to be more sensitive to the market mode. In the iterative procedure that generates the SL dendrogram, for instance, the correlation between two new clusters is defined as the maximum correlation between elements of the first cluster and elements of the second one: since the most part of correlation in the market is due to the market mode [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>] such an algorithm is likely to force many clusters to join the cluster made of the most influencial stocks in the market, resulting in a giant cluster and high disparity. The AL is less sensitive to this effect as the inter-clusters correlation is defined as the average of correlations; for the CL the minimum correlation is chosen, resulting -unsurprisingly- in the lowest value of disparity. For what concerns the DBHT it is probably the topology of PMFG, which is more structured and clusterised than the MST, to provide a lower sensitivity to the market mode dynamics.</p>
<p>We can conclude that, from the point of view of the disparity measure, the analysed clustering methods provide quite different structures at any level of the dendrograms. The DBHT yields the most homogeneous clustering, whereas the SL displays the highest levels of disparity.</p>
</sec>
<sec id="sec013">
<title>Retrieving the industrial sectors</title>
<p>In this Section we quantify the similarity between clustering and ICB, by varying the number of clusters <italic>N</italic><sub><italic>cl</italic></sub>. We have used the Adjusted Rand Index introduced in Methods (<xref ref-type="disp-formula" rid="pone.0116201.e010">Eq. 9</xref>). In <xref ref-type="fig" rid="pone.0116201.g006">Fig. 6</xref> we show the results of the first set of analyses. We have applied the five clustering methods to the entire time-period 1997–2012 and then we have varied the number of clusters <italic>N</italic><sub><italic>cl</italic></sub>. For each clustering obtained in this way we have calculated the Adjusted Rand Index ℛ<sub><italic>adj</italic></sub> between that clustering and the ICB supersector partition. In this way we have explored the entire hierarchical structure. <xref ref-type="fig" rid="pone.0116201.g006">Fig. 6 a)</xref> refers to the non-detrended case, <xref ref-type="fig" rid="pone.0116201.g006">Fig. 6 b)</xref> to the detrended case. The vertical dashed line in the graphs identifies the value <italic>N</italic><sub><italic>cl</italic></sub> = 19, that is the number of ICB supersectors. For all the methods we observe an increasing trend for low values of <italic>N</italic><sub><italic>cl</italic></sub>, a maximum and then a decreasing trend toward zero as <italic>N</italic><sub><italic>cl</italic></sub> goes to 342. However the five methods show differences for what concerns the value of the maximum and its position. In the non-detrended case, we find that the highest values of Adjusted Rand Index, <inline-formula id="pone.0116201.e025"><mml:math id="M25" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>ℛ</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>d</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, are reached by DBHT (0.419), k-medoids (0.387) and Complete Linkage (0.387). Interestingly these three values are quite close to each other, maybe indicating this level as the actual maximum similiarity between correlation clustering and ICB supersectors. However the number of clusters correspondent to each maximum (<inline-formula id="pone.0116201.e026"><mml:math id="M26" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>) depends on the method and is respectively 13, 17 and 39. It is worth noticing that the maximum for the DBHT and k-medoids occurs very close to the “real” ICB supersectors <italic>N</italic><sub><italic>cl</italic></sub> = 19 indicated by the dashed line in <xref ref-type="fig" rid="pone.0116201.g006">Fig. 6</xref>. However, the k-medoids values are sensitively more fluctuating than the two hierachical methods. The Average Linkage and Single Linkage reach instead much lower <inline-formula id="pone.0116201.e027"><mml:math id="M27" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>ℛ</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>d</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> (respectively 0.352 and 0.184) and much higher <inline-formula id="pone.0116201.e028"><mml:math id="M28" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> (respectively 111 and 229).</p>
<fig id="pone.0116201.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Demonstration that different clustering methods retrieve different amount of industrial sector information.</title>
<p>The Adjusted Rand Index ℛ<sub><italic>adj</italic></sub> between clustering and ICB supersectors is shown for different number of clusters <italic>N</italic><sub><italic>cl</italic></sub>. In a) correlations are calculated on non-detrended log-returns, in b) are calculated on detrended log-returns. The vertical dashed line shows the value (<italic>N</italic><sub><italic>cl</italic></sub> = 19) correspondent to the actual number of ICB supersectors.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g006"/>
</fig>
<p>For what concerns the detrended case, we notice first of all that the maximum values of ℛ<sub><italic>adj</italic></sub> increase for all the methods. The natural explanation for this is that the market mode, driving all the stocks regardless of their industrial supersector, hides to some extent the ICB structure [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>]. The CL shows now the highest degree of similarity (0.510), followed by the AL (0.48, showing the most remarkable increase with respect to the non-detrended case), the k-medoids (0.467) and DBHT (0.444). The SL is again the last one in the ranking (0.315). The ranking in <inline-formula id="pone.0116201.e029"><mml:math id="M29" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is instead the same of the market mode case: lowest <inline-formula id="pone.0116201.e030"><mml:math id="M30" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> for DBHT (20), followed by k-medoids (25), Complete Linkage (50), Average Linkage (60) and Single Linkage (101). Let us stress that, although the DBHT has not the highest ℛ<sub><italic>adj</italic></sub> in this case, its maximum is the closest to the real <italic>N</italic><sub><italic>cl</italic></sub> of 19. In general the effect of the market mode subtraction on <inline-formula id="pone.0116201.e031"><mml:math id="M31" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> changes according to the clustering method: for the DBHT, CL and k-medoids the subtraction raises <inline-formula id="pone.0116201.e032"><mml:math id="M32" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, whereas for AL and SL the same quantity reduces remarkably. The effect is more pronunced for the Linkage methods, less for DBHT and k-medoids.</p>
<p>Overall we can conclude that varying the number of clusters (<italic>N</italic><sub><italic>cl</italic></sub>) the DBHT, k-medoids and CL outperform the other two clustering methods at retrieving the ICB information. DBHT, k-medoids and CL have however peaks of <inline-formula id="pone.0116201.e033"><mml:math id="M33" overflow="scroll"><mml:mrow><mml:msubsup><mml:mo>ℛ</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>d</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> at different <inline-formula id="pone.0116201.e034"><mml:math id="M34" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> values. In particular, the DBHT and k-medoids are able to retrieve the ICB information at a <inline-formula id="pone.0116201.e035"><mml:math id="M35" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> that is both lowest and closest to the actual number of ICB supersectors (19). After subtracting the market mode also the AL reaches the same level of DBHT, k-medoids and CL, but at too high <inline-formula id="pone.0116201.e036"><mml:math id="M36" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
<p>Interestingly, the Average and Single Linkage methods have the clusterings with both the lowest values of ℛ<sub><italic>adj</italic></sub> and the highest disparity values <italic>y</italic>: i.e. it appears that the higher the disparity <italic>y</italic> is, the less the clustering method is able to retrieve the industrial classification. This has to be due to the presence of a large cluster when <italic>y</italic> is very high: this again indicates a strong sensitivity to the market mode (see previous Section), that hides the intrasector correlations merging many stocks in a single cluster.</p>
</sec>
<sec id="sec014">
<title>Industries overexpression</title>
<p>As we have stated above, the Adjusted Rand Index provides an overall measure of similarity between the clustering and the ICB partition. Let us now focus on a more refined level of analysis, with which we quantify to what extent each industrial sector is retrieved by the clustering.</p>
<p>To this aim we have varied the number of clusters <italic>N</italic><sub><italic>cl</italic></sub> and, for each clustering, we have performed a one-tail hypothesis test (see <xref ref-type="sec" rid="sec002">Methods</xref>, <xref ref-type="disp-formula" rid="pone.0116201.e016">Eq. 11</xref>) for each pair cluster/ICB supersector. In <xref ref-type="fig" rid="pone.0116201.g007">Fig. 7</xref> we show with bar graphs the results of these analyses for each one of the five clustering methods, by using detrended log-returns. The x-axis shows <italic>N</italic><sub><italic>cl</italic></sub>, whereas 𝒩 on the y-axis represents the total number of hypergeometric tests that have been rejected for that value of <italic>N</italic><sub><italic>cl</italic></sub> (i.e. how many times an ICB supersector has been found to be overexpressed by a cluster). The colors on each bar show the number of overexpressions for each different supersector. We have chosen a significance level for the test equal to 0.01, together with the conservative Bonferroni correction [<xref ref-type="bibr" rid="pone.0116201.ref036">36</xref>] that reduces the significance level to 0.01/(0.5*<italic>N</italic><sub><italic>cl</italic></sub>*<italic>N</italic><sub><italic>ICB</italic></sub>), with <italic>N</italic><sub><italic>ICB</italic></sub> being the number of ICB supersectors (19). (In Fig. S6 in <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref>, we report also the relative numbers 𝒩/(0.5*<italic>N</italic><sub><italic>cl</italic></sub>*<italic>N</italic><sub><italic>ICB</italic></sub>).)</p>
<fig id="pone.0116201.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Amount of ICB information retrieved by the clustering methods, in terms of ICB supersectors overexpressed by each cluster.</title>
<p>Each bar graph shows, varying the number of clusters <italic>N</italic><sub><italic>cl</italic></sub>, how many times (<inline-formula id="pone.0116201.e037"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0116201.e037" xlink:type="simple"/></inline-formula>) an ICB supersector is overexpressed by a cluster according to the Hypergeometric hypothesis test (i.e., number of null-hypothesis tests being rejected). Each colour shows the number of overexpressions for each ICB supersector. In graphs a)-e) the results for DBHT, AL, CL, SL and k-medoids clustering are shown respectively. The correlations are calculated on detrended log-returns. See Fig. S5 in <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref> for the non-detrended case.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g007"/>
</fig>
<p>As we can see, the compositions and trends with <italic>N</italic><sub><italic>cl</italic></sub> are quite different among different methods. The DBHT shows the highest number of clusters overexpressing ICB industries, followed by k-medoids, CL, AL and SL. Let us note that AL and SL show the worst performances also in the Adjusted Rand Index analysis in <xref ref-type="fig" rid="pone.0116201.g006">Fig. 6 a)</xref>. However, in that analysis the DBHT, k-medoids and CL were showing very close Adjusted Rand Index values; the hypothesis test is therefore able to highlight better the differences between these methods. For what concerns the industry composition, we can see that the DBHT, k-medoids, CL and AL show a quite homogeneous composition, with almost each ICB supersector overexpressed. The SL instead shows a much less rich composition, with no more than 6 overexpressed supersectors simultaneously even at the maximum level of total overexpressions.</p>
<p>In terms of 𝒩 shape the DBHT is quite peaked, quickly dropping to low values for high <italic>N</italic><sub><italic>cl</italic></sub> values. The three Linkage methods are instead flatter and more spread along the <italic>N</italic><sub><italic>cl</italic></sub> axis, a feature that was evident also in the trend of ℛ<sub><italic>adj</italic></sub> in <xref ref-type="fig" rid="pone.0116201.g006">Fig. 6</xref>. The k-medoids seems to be a mix between these two shapes, showing however a much higher level of noise and instability in the ICB composition when <italic>N</italic><sub><italic>cl</italic></sub> changes.</p>
<p>Finally, it is worth noticing that there is a change in the composition at different values of <italic>N</italic><sub><italic>cl</italic></sub>, and that similar patterns can be found among the four hierarchical clustering methods (for the k-medoids no clear patterns can be found, because of the higher level of instability of the method). There are supersectors that tend to become overexpressed for low values of <italic>N</italic><sub><italic>cl</italic></sub> and then disappear at intermediate values: this is the case of Automobiles &amp; Parts, Telecommunications, Insurance and Financial Services. Others are instead more persistent, appearing along all the x-axis: Utilities, Technology, Oil &amp; Gas. The most persistent is the latter, that is still overexpressed when all the other supersectors are not expressed anymore. We can then conclude that not only the ICB partition is hidden at different levels in the dendrograms (see <xref ref-type="sec" rid="sec013">“Retrieving the industrial sectors”</xref> Section) depending on the clustering method, but also different ICB supersectors are retrieved at different levels. This is probably due to the different degrees of correlation within different ICB supersectors.</p>
<p>By using non-detrended log-returns we obtain quite similar results, apart from an overall decrease in 𝒩 for all the methods, consistently with what found in “Retrieving the industrial sectors”. The details are shown in Fig. S5 in <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref>.</p>
</sec>
</sec>
<sec id="sec015">
<title>Dynamical analysis</title>
<p>Here we present a dynamical analysis of the DBHT clustering in the 15 years period ranging from 1 January 1997 to 31 December 2012. We have selected the set of overlapping time windows described in “Dataset and preliminary analyses” (<italic>n</italic> = 100 time windows of length <italic>L</italic> = 1000 trading days) and used a weighted version of the Pearson estimator (<xref ref-type="disp-formula" rid="pone.0116201.e020">Eq. 13</xref>) in order to mitigate excessive sensitiveness to outliers in remote observations.</p>
<p>In <xref ref-type="fig" rid="pone.0116201.g008">Fig. 8 a)</xref> is shown the number of DBHT clusters obtained for each time window, both for non-detrended log-returns (red circles) and detrended log-returns (blue squares). For the first case the number of clusters ranges between 6 and 19, for the second case the range is 14–26. Let us stress that this is the “natural” number of clusters automatically provided by the DBHT method, and it is not the result of any thresholding. Dashed lines are the values correspondent to the clustering obtained using the entire time period 1997–2012 as time window. A study of the statistical robustness of these clusterings have been carried out by means of a bootstrapping approach: it turns out that the number of clusters shown in <xref ref-type="fig" rid="pone.0116201.g008">Fig. 8 a)</xref> is robust against resampling of the log-returns time series, as reported in the next section “Robustness of DBHT: a bootstrapping analysis”.</p>
<fig id="pone.0116201.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Dynamical evolution of the DBHT clustering.</title>
<p>Each plot refers to 100 moving time windows of length 1000 trading days. Specifically, in graph a) we plot the number of DBHT clusters, <italic>N</italic><sub><italic>cl</italic></sub>, for both log-returns non-detrended (red circles) and detrended by the market mode (blue squares), whereas the two dashed horizontal lines are the <italic>N</italic><sub><italic>cl</italic></sub> values obtained by taking the largest time window of 4026 trading days. Overall the non-detrended case shows a decreasing trend. In graph b) it is shown the disparity measures, <italic>y</italic>, again for the two sets of DBHT clustering (red dots non-detrended, blue dots detrended), the dashed horizontal lines being the <italic>y</italic> values from the 4026 length time window. In the non-detrended case the 2007 marks a transition to higher and more volatile values of <italic>y</italic>. Finally in graph c) it is shown the Adjusted Rand Index, ℛ<sub><italic>adj</italic></sub>, measured at each time window between the detrended and non-detrended clusterings. A steady decreasing trend is evident.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g008"/>
</fig>
<p>As observed previously, the number of clusters in the non-detrended case is sistematically lower than in the detrended case. Moreover, an overall decreasing trend characterizes the non-detrended values and makes them go below the corresponding dashed line; this decreasing pattern is not present in the detrended case, that however stays below the correspondent dashed line most of the times either. The evolution of the disparity <italic>y</italic>, introduced in <xref ref-type="disp-formula" rid="pone.0116201.e005">Eq. 4</xref>, is shown in <xref ref-type="fig" rid="pone.0116201.g008">Fig. 8 b)</xref> both for non-detrended and detrended case. Again the dashed lines are the values for the all period. In the non-detrended case we see an overall increasing trend, especially after the 2006; an analysis of the sizes distribution shows that largest cluster contains up to 240 stocks (70% of total number of stocks); moreover, from 2006 onwards we observe also a much higher fluctuation in the values. This behaviour is of interest since it concerns the overall influence of the market mode on the correlation structure, with higher <italic>y</italic> indicating a stronger influence of the market mode that tends to gather all stocks in one cluster. Indeed, in the detrended case we find that subtracting the market mode makes the increasing trend disappear with decreasing disparity values that stay closer to the dashed line, without significant patterns apart from some fluctuations.</p>
<p>In order to better understand the relation between the DBHT clusterings obtained with detrended and non-detrended log-returns, we have also performed a dynamical Adjusted Rand Index analysis. Now we compare no longer the clustering and the ICB partition, but the two clusterings (non-detrended and detrended) at each time window. In <xref ref-type="fig" rid="pone.0116201.g008">Fig. 8 c)</xref> the Adjusted Rand Index between the two sets of DBHT clusters is shown. Interestingly, it shows a steady decreasing trend that drives the similarity from relatively high values (about 0.7) to values close to zero, indicating complete uncorrelation between the two clusterings. We can therefore conclude that the influence of the market mode has increased remarkably over the last 15 years, making the detrended clustering structure more and more different from the non-detrended one. Let us note that this observation would have not been possible without the clustering analysis, since from the preliminary dataset measures (see <xref ref-type="fig" rid="pone.0116201.g001">Fig. 1</xref> and Fig. S2 in <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref> for details) it is not evident any constant pattern either in the average return or in the average correlation.</p>
<sec id="sec016">
<title>Dynamically retrieving the industrial sectors</title>
<p>Let us here investigate the relation between industrial classification and clustering under a dynamic perspective. To this end we here perform the previous dynamical analysis by considering the set of 100 overlapping time windows <italic>T</italic><sub><italic>k</italic></sub> and calculating for each of them the Adjusted Rand Index ℛ<sub><italic>adj</italic></sub>(<italic>T</italic><sub><italic>k</italic></sub>) between clustering and ICB supersectors classification. Since ℛ<sub><italic>adj</italic></sub>(<italic>T</italic><sub><italic>k</italic></sub>) varies with the chosen threshold and <italic>N</italic><sub><italic>cl</italic></sub>, we select at every time the <italic>N</italic><sub><italic>cl</italic></sub> that maximizes ℛ<sub><italic>adj</italic></sub>(<italic>T</italic><sub><italic>k</italic></sub>); the numbers that we report are these maximum values and account therefore for the maximum ability of the clustering methods to retrieve the ICB.</p>
<p>In Figs. <xref ref-type="fig" rid="pone.0116201.g009">9 a)-e)</xref> we show the results for each of the five clustering methods, using returns with market mode. Interestingly, all of them show a decreasing trend across the time. On average, the DBHT and CL display the highest similarity with industrial classfication, whereas the Single Linkage the lowest. This is consistent with what found in the static analyses. We have also highlighted in the graphs the major events that affected the stock market in the last 15 years. It can be observed that different clustering methods are affected in different ways by these events. For instance we observe that, if the 2007–2008 crisis and the following recession is evident in all the methods as a significant drop in the similarity, other events such as 11/09/2001 or the 2002 stock market downturn appear only in the Single and Average Linkage plots. In particular the 2002 downturn drives a steep decrease in the similarity of SL and AL, staying at low values until the end of 2005. Instead DBHT, Complete Linkage and k-medoids do not seem to be significantly affected by these events. This observation points out that the DBHT, CL and k-medoids are more robust than SL and AL against exogenous events in their ability to retrieve an economic information as the industrial classification. Nonetheless, there are differences also among DBHT, CL and k-medoids: in particular in the period following the 2008 crisis, DBHT and k-medoids show a peak that does not appear with CL. Moreover, for the k-medoids the drop in similarity seems to start more than one year before the 2007. All these features have non-trivial implications for both portfolio optimization and systemic risk evaluation. We plan to investigate these implications in future works.</p>
<p><xref ref-type="fig" rid="pone.0116201.g009">Fig. 9 f)</xref> shows the number of clusters <italic>N</italic><sub><italic>cl</italic></sub> that, in each time window <italic>T</italic><sub><italic>k</italic></sub>, maximizes the Adjusted Rand Index shown in the previous plots. As we can see, <italic>N</italic><sub><italic>cl</italic></sub> for SL is always the highest, followed by AL, CL, k-medoids and DBHT. This is consistent with what we found in the “Static analysis” Section: different clustering methods “hide” the industrial information at different levels of the hierarchy. SL and AL, that yield higher <italic>N</italic><sub><italic>cl</italic></sub> (i.e., lower levels in the hierarchy), are also the methods that show the lowest level of similarity with industrial classification and the highest degree of disparity.</p>
<fig id="pone.0116201.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Dynamical evolution of the similarity between clustering and ICB.</title>
<p>It is shown the Adjusted Rand Index, ℛ<sub><italic>adj</italic></sub>, calculated at each time window <italic>T</italic><sub><italic>k</italic></sub> (<italic>k</italic> = 1, …, <italic>n</italic>) between clustering and ICB partition, for a) DBHT, b) AL, c) CL, d) SL and e) k-medoids method. A drop in the similarity occurs for all the methods during the 2007–2008 crisis. The AL and SL show decreases also during other financial events. At each time window the number of clusters, <italic>N</italic><sub><italic>cl</italic></sub>, has been chosen in order to maximize the ℛ<sub><italic>adj</italic></sub> itself: in f) we plot these <italic>N</italic><sub><italic>cl</italic></sub> values for each clustering method. It is evident as the maximum similarity clustering-ICB is reached at different hierarchical levels depending on the clustering method. The correlations are calculated on non-detrended log-returns.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g009"/>
</fig>
<p>In Figs. <xref ref-type="fig" rid="pone.0116201.g010">10 a)-f)</xref> we show the same set of plots for the detrended case. The main differences with the non-detrended case are the following:
<list list-type="bullet"><list-item><p>the average similarity with the industrial classification rises for all methods; this confirms in the dynamical case what we found for the static case;</p></list-item> <list-item><p>the average <italic>N</italic><sub><italic>cl</italic></sub> is lower for all methods: the absence of market mode “moves” the industrial classification to higher levels of the hierarchy;</p></list-item> <list-item><p>the strong influence of the 11/09/2001 and 2002 downturn on the SL and AL pattern seems to disappear, whereas the 2007–2008 crisis is still evident in all the five methods. This could be explained claiming that the formers are global events in the market, whereas the latter exhibits also a “local” dynamics;</p></list-item> <list-item><p>the AL shows the most evident change in the dynamical behaviour, displaying a trend much more similar to the DBHT and CL one. Also in terms of <italic>N</italic><sub><italic>cl</italic></sub>, it shows values closer to DBHT, CL and k-medoids than SL. A similar observation was made in the static analysis in “Retrieving the industrial sectors”, where the AL turned out to perform like DBHT, CL and k-medoids once the market mode was removed.</p></list-item></list></p>
<fig id="pone.0116201.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Dynamical evolution of the similarity between clustering and ICB, with detrended log-returns.</title>
<p>a)-f): Same graphs as in <xref ref-type="fig" rid="pone.0116201.g009">Fig. 9</xref>, but by using correlations on detrended log-returns.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g010"/>
</fig>
</sec>
<sec id="sec017">
<title>Robustness of DBHT: a bootstrapping analysis</title>
<p>In order to test the sensitiveness of the DBHT clustering to the statistical noise, inevitably present in every correlation estimate, we have performed the Bootstrapping test to our dataset [<xref ref-type="bibr" rid="pone.0116201.ref042">42</xref>]. This method generates a set of <italic>n</italic><sub><italic>boot</italic></sub> replicas of each original correlation matrix by randomly resampling the log-returns matrix. On each replica of correlation matrix we can calculate a new DBHT clustering, ending up with a sample of <italic>n</italic><sub><italic>boot</italic></sub> clusterings on which we can perform statistical analyses. A detailed description of the Bootstrapping method can be found in SI (Section S4, of <xref ref-type="supplementary-material" rid="pone.0116201.s001">S1 File</xref>).</p>
<p>In <xref ref-type="fig" rid="pone.0116201.g011">Fig. 11</xref> we show the result of the dynamical Bootstrapping performed over all the 100 time windows that cover the entire period. We chose <italic>n</italic><sub><italic>boot</italic></sub> = 100: each time window has therefore 100 replica DBHT clustering associated. The blue points are the average number of clusters over the <italic>n</italic><sub><italic>boot</italic></sub> replicas of DBHT clusterings, whereas the error bars are the standard deviations calculated over the same sample. The black squares are the empirical numbers of clusters yielded by the DBHT. The left-hand side plot (a)) is obtained by using non-detrended log-returns, the right-hand side (b)) is obtained by using detrended log-returns.</p>
<fig id="pone.0116201.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0116201.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Test of robustness for the dynamical DBHT clustering.</title>
<p>a) Number of clusters <italic>N</italic><sub><italic>cl</italic></sub> as a function of the time <italic>t</italic>: the black squares correspond to the DBHT clusterings obtained by using the empirical (non-detrended) log-returns, the blue dots are the average over the 100 <italic>N</italic><sub><italic>cl</italic></sub> given by the 100 bootstrapping replica correlation matrices (see text for further details). The bar errors in the blue dot plot is the standard deviation calculated among the same set of 100 <italic>N</italic><sub><italic>cl</italic></sub>. As one can see the empirical <italic>N</italic><sub><italic>cl</italic></sub> is quite robust against the bootstrapping test. b) Same plot as in a), but by using detrended log-returns.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.g011"/>
</fig>
<p>The plot of empirical number of clusters is slightly different from what we have shown in <xref ref-type="fig" rid="pone.0116201.g008">Fig. 8 a)</xref> because for this bootstrapping analysis we did not use exponential smoothing for the correlations, but only bare correlations. The exponential smoothing, indeed, creates an asymmetry among the points in each time series that makes the bootstrapping test inapplicable. Overall, removing the exponential smoothing affects each <italic>N</italic><sub><italic>cl</italic></sub> value by 20% on average.</p>
<p>From the plot we can observe that the method is statistically robust, with the most of empirical points within one standard deviation from the mean of replicas. More importantly, the mean of replicas follows the general trend of the empirical points; namely, the decreasing trend in the market mode case, and the drop after the 2007–2008 crisis in the detrended case.</p>
</sec>
</sec>
<sec id="sec018">
<title>Discussion</title>
<p>In this paper we have presented a set of static and dynamical analyses to quantify empirically the amount of information filtered from correlation matrices by different hierarchical clustering methods. By taking the Industrial Classification Benchmark (ICB) as a benchmark community partition we have performed quantitative analyses on real data without any assumption on the returns distribution.</p>
<p>In particular we have considered three variants of Linkage methods (Single, Average and Complete) and the k-medoids, and we have compared them with the Directed Bubble Hierarchical Tree (DBHT), a novel clustering method applied here for the first time to financial data.</p>
<p>The methods show remarkably different performances in retrieving the economic information encoded in the ICB, with big dissimilarities even among the Linkage methods. We have suggested that these differences should be connected to different degrees of sensitivity to the market mode dynamics, that in turns are to be ascribed to differences in the methods underlying working principles. Moreover, the economic information appears to be hidden at different levels of the hierarchical structures depending on the clustering method. The DBHT and k-medoids methods show the best performances, but the latter seems to be affected by the noise much more than the DBHT and the Linkage methods. The DBHT turns out then to be a good mix between the advantages of the k-medoids and those of the Linkages. The dynamical analysis has also proved that the methods show different degrees of sensitivity to financial crises. This is again a new result that could give insights into the dynamics of such events, as well as an indication on which clustering method is more robust for financial applications.</p>
<p>We have also performed each analysis on log-returns detrended by the market mode, by following a standard procedure in literature [<xref ref-type="bibr" rid="pone.0116201.ref027">27</xref>] [<xref ref-type="bibr" rid="pone.0116201.ref040">40</xref>]. Interestingly the effect of this detrending is very dissimilar for different methods, with the weakest methods (Average and Single Linkage) improving remarkably their ability to retrieve industrial sectors. In general the detrending increases the degree of economic information that the clustering methods retrieve. It also makes the clusterings more homogeneous in sizes, suggesting that the high heterogeneity in SL and AL must be due to the market mode dynamics.</p>
<p>In future works we plan to extend the present study to other datasets, covering different periods and different stock exchanges and considering other measures of dependences including non-linear dependences such as the Kendall’s rank correlation [<xref ref-type="bibr" rid="pone.0116201.ref043">43</xref>] and the Mutual information [<xref ref-type="bibr" rid="pone.0116201.ref044">44</xref>] [<xref ref-type="bibr" rid="pone.0116201.ref045">45</xref>]. Finally, since correlation-based networks and clustering methods have shown to be useful tools for portfolio optimization [<xref ref-type="bibr" rid="pone.0116201.ref020">20</xref>], [<xref ref-type="bibr" rid="pone.0116201.ref046">46</xref>, <xref ref-type="bibr" rid="pone.0116201.ref047">47</xref>], we also plan to use these new insights into the hierarchical structures to improve further the current performances of portfolio optimization tools.</p>
</sec>
</sec>
<sec id="sec019">
<title>Supporting Information</title>
<supplementary-material id="pone.0116201.s001" position="float" xlink:href="info:doi/10.1371/journal.pone.0116201.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Supporting information for: Relation between financial market structure and the real economy: comparison between clustering methods.</title>
<p>The Supporting Information, S1 File, contains further analysis, some extra details about the methodology and some extra results.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors wish to thank Bloomberg for providing the data. TDM wishes to thank the COST Action TD1210 for partially supporting this work. TA acknowledges support of the UK Economic and Social Research Council (ESRC) in funding the Systemic Risk Centre (ES/K002309/1).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0116201.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>1999</year>) <article-title>Hierarchical structure in financial markets</article-title>. <source>Eur Phys J B</source> <volume>11</volume>: <fpage>193</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s100510050929" xlink:type="simple">10.1007/s100510050929</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Onnela</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Chakraborti</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kaski</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kertész</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kanto</surname> <given-names>A</given-names></name> (<year>2003</year>) <article-title>Asset trees and asset graphs in financial markets</article-title>. <source>Phys Scr</source> <volume>T106</volume>: <fpage>48</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1238/Physica.Topical.106a00048" xlink:type="simple">10.1238/Physica.Topical.106a00048</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hyde</surname> <given-names>ST</given-names></name> (<year>2005</year>) <article-title>Complex networks on hyperbolic surfaces</article-title>. <source>Physica A</source> <volume>346</volume>: <fpage>20</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.physa.2004.08.045" xlink:type="simple">10.1016/j.physa.2004.08.045</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2005</year>) <article-title>A tool for filtering information in complex systems</article-title>. <source>Proc Natl Acad Sci</source> <volume>102</volume>: <fpage>10421</fpage>–<lpage>10426</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0500298102" xlink:type="simple">10.1073/pnas.0500298102</ext-link></comment> <object-id pub-id-type="pmid">16027373</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2002</year>) <article-title>How does the eurodollars interest rate behave?</article-title> <source>J Theoret Appl Finance</source> <volume>5</volume>: <fpage>122</fpage>–<lpage>127</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2004</year>) <article-title>An interest rate cluster analysis</article-title>. <source>Physica A</source> <volume>339</volume>: <fpage>181</fpage>–<lpage>188</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.physa.2004.03.041" xlink:type="simple">10.1016/j.physa.2004.03.041</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hyde</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Ramsden</surname> <given-names>S</given-names></name> (<year>2005</year>) <article-title>Interest rates hierarchical structure</article-title>. <source>Physica A</source> <volume>335</volume>: <fpage>21</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.physa.2005.02.063" xlink:type="simple">10.1016/j.physa.2005.02.063</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bartolozzi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mellen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2007</year>) <article-title>Multi-scale correlations in different futures markets</article-title>. <source>Eur Phys J B</source> <volume>58</volume>: <fpage>207</fpage>–<lpage>220</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1140/epjb/e2007-00216-2" xlink:type="simple">10.1140/epjb/e2007-00216-2</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Onnela</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Chakraborti</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kaski</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kertész</surname> <given-names>J</given-names></name> (<year>2003</year>) <article-title>Dynamic asset trees and black monday</article-title>. <source>Physica A</source> <volume>324</volume>: <fpage>247</fpage>–<lpage>252</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0378-4371(02)01882-4" xlink:type="simple">10.1016/S0378-4371(02)01882-4</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tola</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gallegati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2008</year>) <article-title>Cluster analysis for portfolio optimization</article-title>. <source>J Econ Dyn Control</source> <volume>32</volume>: <fpage>235</fpage>–<lpage>258</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jedc.2007.01.034" xlink:type="simple">10.1016/j.jedc.2007.01.034</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fenn</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Porter</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Mucha</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>McDonald</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Dynamical clustering of exchange rates</article-title>. <source>Quantitative Finance</source> <volume>12</volume>: <fpage>1493</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/14697688.2012.668288" xlink:type="simple">10.1080/14697688.2012.668288</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Pozzi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2010</year>) <article-title>The use of dynamical networks to detect the hierarchical organization of financial market sectors</article-title>. <source>Eur Phys J B</source> <volume>73</volume>: <fpage>3</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1140/epjb/e2009-00286-0" xlink:type="simple">10.1140/epjb/e2009-00286-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2007</year>) <article-title>Correlation based networks of equity returns sampled at different time horizons</article-title>. <source>Eur Phys J B</source> <volume>55</volume>: <fpage>209</fpage>–<lpage>217</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1140/epjb/e2006-00414-4" xlink:type="simple">10.1140/epjb/e2006-00414-4</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Morales</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2014</year>) <article-title>Dependency structure and scaling properties of financial time series are related</article-title>. <source>Sci Rep</source> <volume>4</volume>: <fpage>4589</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep04589" xlink:type="simple">10.1038/srep04589</ext-link></comment> <object-id pub-id-type="pmid">24699417</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Shaw</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name> (<year>2010</year>) <article-title>Correlation structure and dynamics in volatile markets</article-title>. <source>New J Phys</source> <volume>12</volume>: <fpage>085009</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1367-2630/12/8/085009" xlink:type="simple">10.1088/1367-2630/12/8/085009</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2010</year>) <article-title>Correlation, hierarchies, and networks in financial markets</article-title>. <source>J Econ Behav Organ</source> <volume>75</volume>: <fpage>40</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jebo.2010.01.004" xlink:type="simple">10.1016/j.jebo.2010.01.004</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Anderberg</surname> <given-names>MR</given-names></name> (<year>1973</year>) <source>Cluster analysis for applications</source>. <publisher-name>Academic Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Coronnello</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Miccichè</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2007</year>) <article-title>Spanning trees and bootstrap reliability estimation in correlation-based networks</article-title>. <source>Int J Bifurcat Chaos</source> <volume>17</volume>: <fpage>2319</fpage>–<lpage>2329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1142/S0218127407018415" xlink:type="simple">10.1142/S0218127407018415</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="other">Aste T (2012). An algorithm to compute Planar Maximally Filtered Graphs (PMFG). URL <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.mathworks.com/matlabcentral/fileexchange/38689-pmfg">http://www.mathworks.com/matlabcentral/fileexchange/38689-pmfg</ext-link>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pozzi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2013</year>) <article-title>Spread of risk across financial markets: better to invest in the peripheries</article-title>. <source>Sci Rep</source> <volume>3</volume>: <fpage>1665</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep01665" xlink:type="simple">10.1038/srep01665</ext-link></comment> <object-id pub-id-type="pmid">23588852</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Song</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2012</year>) <article-title>Hierarchical information clustering by means of topologically embedded graphs</article-title>. <source>PLoS ONE</source> <volume>7</volume>: <fpage>e31929</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0031929" xlink:type="simple">10.1371/journal.pone.0031929</ext-link></comment> <object-id pub-id-type="pmid">22427814</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="other">Aste T (2014). An algorithm to compute Directed Bubble Hiererachical Tree (DBHT) clustering. URL <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.mathworks.com/matlabcentral/fileexchange/46750-dbht">http://www.mathworks.com/matlabcentral/fileexchange/46750-dbht</ext-link>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Song</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2011</year>) <article-title>Nested hierarchies in planar graphs</article-title>. <source>Discrete Appl Math</source> <volume>159</volume>: <fpage>2135</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.dam.2011.07.018" xlink:type="simple">10.1016/j.dam.2011.07.018</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fortunato</surname> <given-names>S</given-names></name> (<year>2010</year>) <article-title>Community detection in graphs</article-title>. <source>Physics Reports</source> <volume>486</volume>: <fpage>75</fpage>–<lpage>174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.physrep.2009.11.002" xlink:type="simple">10.1016/j.physrep.2009.11.002</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kaufman</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Rousseeuw</surname> <given-names>PJ</given-names></name> (<year>1987</year>) <article-title>Clustering by means of medoids</article-title>. <source>Statistical Data Analysis Based on the <italic>L</italic><sub>1</sub>-Norm and Related Methods</source>: <fpage>405</fpage>–<lpage>416</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>MacQueen</surname> <given-names>J</given-names></name> (<year>1967</year>) <article-title>Some methods for classification and analysis of multivariate observations</article-title>. <source>Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability</source> <volume>1</volume>: <fpage>281</fpage>–<lpage>297</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Borghesi</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Marsili</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miccichè</surname> <given-names>S</given-names></name> (<year>2007</year>) <article-title>Emergence of time-horizon invariant correlation structure in financial returns by subtraction of the market mode</article-title>. <source>Phys Rev E</source> <volume>76</volume>: <fpage>026104</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.76.026104" xlink:type="simple">10.1103/PhysRevE.76.026104</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hubert</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Arabie</surname> <given-names>P</given-names></name> (<year>1985</year>) <article-title>Comparing partitions</article-title>. <source>Journal of Classification</source> <volume>2</volume>: <fpage>193</fpage>–<lpage>218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF01908075" xlink:type="simple">10.1007/BF01908075</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miccichè</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Varho</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Piilo</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Community characterization of heterogeneous complex systems</article-title>. <source>J Stat Mech</source> <volume>P01019</volume>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Coronnello</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Miccichè</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2011</year>) <article-title>Sector identification in a set of stock return time series traded at the London Stock Exchange</article-title>. <source>Acta Physica Polonica</source> <volume>36</volume>: <fpage>2653</fpage>–<lpage>2680</lpage>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2007</year>) <article-title>Kullback-Leibler distance as a measure of the information filtered from multivariate data</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>76</volume>: <fpage>031123</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.76.031123" xlink:type="simple">10.1103/PhysRevE.76.031123</ext-link></comment> <object-id pub-id-type="pmid">17930215</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cont</surname> <given-names>R</given-names></name> (<year>2001</year>) <article-title>Empirical properties of asset returns: stylized facts and statistical issues</article-title>. <source>Quantitative Finance</source> <volume>1</volume>: <fpage>223</fpage>–<lpage>236</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/713665670" xlink:type="simple">10.1080/713665670</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name>, <name name-style="western"><surname>Stanley</surname> <given-names>HE</given-names></name> (<year>2000</year>) <source>Introduction to Econophysics: Correlations and Complexity in Finance</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bonanno</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Caldarelli</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2003</year>) <article-title>Topology of correlation-based minimal spanning trees in real and model markets</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>68</volume>: <fpage>046130</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.68.046130" xlink:type="simple">10.1103/PhysRevE.68.046130</ext-link></comment> <object-id pub-id-type="pmid">14683025</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="other">Wagner S, Wagner D (2007) Comparing clusterings—an overview. Technical Report, ITI Wagner, Faculty of Informatics, Universität Karlsruhe (TH).</mixed-citation>
</ref>
<ref id="pone.0116201.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Feller</surname> <given-names>W</given-names></name> (<year>2008</year>) <source>An introduction to probability theory and its applications</source>, <volume>volume 2</volume>. <publisher-name>John Wiley &amp; Sons</publisher-name>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tumminello</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Miccichè</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lillo</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Piilo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mantegna</surname> <given-names>RN</given-names></name> (<year>2011</year>) <article-title>Statistically validated networks in bipartite complex systems</article-title>. <source>PLoS ONE</source> <volume>6</volume>: <fpage>e17994</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0017994" xlink:type="simple">10.1371/journal.pone.0017994</ext-link></comment> <object-id pub-id-type="pmid">21483858</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pearson</surname> <given-names>K</given-names></name> (<year>1895</year>) <article-title>Notes on regression and inheritance in the case of two parents</article-title>. <source>Proceedings of the Royal Society of London</source> <volume>58</volume>: <fpage>240</fpage>–<lpage>242</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspl.1895.0041" xlink:type="simple">10.1098/rspl.1895.0041</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pozzi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Di Matteo</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aste</surname> <given-names>T</given-names></name> (<year>2012</year>) <article-title>Exponential smoothing weighted correlations</article-title>. <source>Eur Phys J B</source> <volume>85</volume>: <fpage>6</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1140/epjb/e2012-20697-x" xlink:type="simple">10.1140/epjb/e2012-20697-x</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ross</surname> <given-names>G</given-names></name> (<year>2014</year>) <article-title>Dynamic multifactor clustering of financial networks</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>89</volume>: <fpage>022809</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.89.022809" xlink:type="simple">10.1103/PhysRevE.89.022809</ext-link></comment> <object-id pub-id-type="pmid">25353536</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="other">A guide to industry classification benchmark. URL <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.icbenchmark.com/">http://www.icbenchmark.com/</ext-link>.</mixed-citation>
</ref>
<ref id="pone.0116201.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name> (<year>1979</year>) <article-title>Bootstrap methods: Another look at the jackknife</article-title>. <source>Ann Stat</source> <volume>7</volume>: <fpage>1</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aos/1176344552" xlink:type="simple">10.1214/aos/1176344552</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kendall</surname> <given-names>MG</given-names></name> (<year>1938</year>) <article-title>A new measure of rank correlation</article-title>. <source>Biometrika</source> <volume>30</volume>: <fpage>81</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/30.1-2.81" xlink:type="simple">10.1093/biomet/30.1-2.81</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Shannon</surname> <given-names>CE</given-names></name> (<year>1948</year>) <article-title>A mathematical theory of communication</article-title>. <source>Bell Syst Tech J</source> <volume>27</volume>: <fpage>379</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/j.1538-7305.1948.tb00917.x" xlink:type="simple">10.1002/j.1538-7305.1948.tb00917.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fiedor</surname> <given-names>P</given-names></name> (<year>2014</year>) <article-title>Networks in financial markets based on the mutual information rate</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>89</volume>: <fpage>052801</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.89.052801" xlink:type="simple">10.1103/PhysRevE.89.052801</ext-link></comment> <object-id pub-id-type="pmid">25353838</object-id></mixed-citation>
</ref>
<ref id="pone.0116201.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nanda</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mahanty</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tiwari</surname> <given-names>MK</given-names></name> (<year>2010</year>) <article-title>Clustering indian stock market data for porfolio management</article-title>. <source>Expert System with Applications</source> <volume>37</volume>: <fpage>8793</fpage>–<lpage>8798</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.eswa.2010.06.026" xlink:type="simple">10.1016/j.eswa.2010.06.026</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0116201.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pai</surname> <given-names>GAV</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>T</given-names></name> (<year>2009</year>) <article-title>Clustering indian stock market data for porfolio management</article-title>. <source>Evolutionary Optimization of Constrained K-means Clustered Assets for Diversification in Small Portfolios</source> <volume>13</volume>: <fpage>1030</fpage>–<lpage>1053</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>