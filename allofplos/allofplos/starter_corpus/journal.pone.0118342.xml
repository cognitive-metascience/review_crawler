<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS ONE</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosone</journal-id>
<journal-title-group>
<journal-title>PLOS ONE</journal-title>
</journal-title-group>
<issn pub-type="epub">1932-6203</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PONE-D-14-50945</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0118342</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>An Efficient Algorithm to Perform Local Concerted Movements of a Chain Molecule</article-title>
<alt-title alt-title-type="running-head">Local Concerted Movements of a Chain Molecule</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Zamuner</surname> <given-names>Stefano</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Rodriguez</surname> <given-names>Alex</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Seno</surname> <given-names>Flavio</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Trovato</surname> <given-names>Antonio</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Dipartimento di Fisica e Astronomia G. Galilei, Universitá degli Studi di Padova, Via Marzolo 8, I-35131 Padova, Italy</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>SISSA (Scuola Internazionale Superiore di Studi Avanzati), via Bonomea 265, I-34136 Trieste, Italy</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>INFN (Istituto Nazionale di Fisica Nucleare), Sezione di Padova, Via Marzolo 8, I-35131 Padova, Italy</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>CNISM (Consorzio Nazionale Interuniversitario per le Scienze fisiche della Matera), Unità di Padova, Via Marzolo 8, I-35131 Padova, Italy</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Roccatano</surname> <given-names>Danilo</given-names></name>
<role>Academic Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Jacobs University Bremen, GERMANY</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: SZ FS AT. Performed the experiments: SZ. Analyzed the data: SZ AR FS AT. Wrote the paper: SZ AR FS AT.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">antonio.trovato@unipd.it</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>31</day>
<month>3</month>
<year>2015</year>
</pub-date>
<volume>10</volume>
<issue>3</issue>
<elocation-id>e0118342</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>11</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>14</day>
<month>1</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Zamuner et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pone.0118342" xlink:type="simple"/>
<abstract>
<p>The devising of efficient concerted rotation moves that modify only selected local portions of chain molecules is a long studied problem. Possible applications range from speeding the uncorrelated sampling of polymeric dense systems to loop reconstruction and structure refinement in protein modeling. Here, we propose and validate, on a few pedagogical examples, a novel numerical strategy that generalizes the notion of concerted rotation. The usage of the Denavit-Hartenberg parameters for chain description allows all possible choices for the subset of degrees of freedom to be modified in the move. They can be arbitrarily distributed along the chain and can be distanced between consecutive monomers as well. The efficiency of the methodology capitalizes on the inherent geometrical structure of the manifold defined by all chain configurations compatible with the fixed degrees of freedom. The chain portion to be moved is first opened along a direction chosen in the tangent space to the manifold, and then closed in the orthogonal space. As a consequence, in Monte Carlo simulations detailed balance is easily enforced without the need of using Jacobian reweighting. Moreover, the relative fluctuations of the degrees of freedom involved in the move can be easily tuned. We show different applications: the manifold of possible configurations is explored in a very efficient way for a protein fragment and for a cyclic molecule; the “local backbone volume”, related to the volume spanned by the manifold, reproduces the mobility profile of all-α helical proteins; the refinement of small protein fragments with different secondary structures is addressed. The presented results suggest our methodology as a valuable exploration and sampling tool in the context of bio-molecular simulations.</p>
</abstract>
<funding-group>
<funding-statement>SZ, AR, FS, AT acknowledge financial support from AIRC (Associazione Italiana per la Ricerca sul Cancro, URL <ext-link ext-link-type="uri" xlink:href="http://www.airc.it" xlink:type="simple">www.airc.it</ext-link>) through the grant AIRC 5 per mille, Rif. 12214. AR acknowledges financial support from MIUR (Ministero Istruzione Universita’ Ricerca) through Fondo per gli Investimenti della Ricerca di Base-Accordo di Programma, Rif. RBAP11ETKA (URL <ext-link ext-link-type="uri" xlink:href="http://firb.miur.it" xlink:type="simple">firb.miur.it</ext-link>). FS acknowledges financial support from MIUR (Ministero Istruzione Universita’ Ricerca) through Programmi di Ricerca Scientifica di Rilevante Interesse Nazionale, Rif. 2012NNRKAF (URL <ext-link ext-link-type="uri" xlink:href="http://prin.miur.it" xlink:type="simple">prin.miur.it</ext-link>). SZ and AT acknowledge financial support from the University of Padua (Universita’ degli Studi di Padova, URL <ext-link ext-link-type="uri" xlink:href="http://www.unipd.it" xlink:type="simple">www.unipd.it</ext-link>) through Progetto di Ateneo CPDA121890. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="0"/>
<page-count count="27"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>We consider the problem of the local movements of a chain molecule where a small subset of degrees of freedom, e.g. dihedral angles, bonds angles or bond lengths, are concertedly modified inside a specific portion of the chain, in such a way that <italic>only</italic> the atoms in that region are moved while all the others are kept fixed. We do not place any constraints on the degrees of freedom that are modified: they can be chosen everywhere along the part of the chain we want to move without the necessity of belonging to atoms/bonds which are consecutive along the polymer. The issue of local movements is related to the loop closure problem, i.e. finding conformations of a segment of consecutive atoms in a chain molecule that are geometrically consistent with the rest of the chain structure. These questions arise in the context of the control of robotic manipulators made up of serially connected joints, where in many common applications one end is fixed and the other must be positioned at a specific location and with a given orientation [<xref ref-type="bibr" rid="pone.0118342.ref001">1</xref>], but they are also topics of paramount importance in structural chemistry and in computational biology. For instance, effective loop closure tools can enhance the performances of homology modeling where segments of insertion or deletion have to be predicted while the rest of the protein structure is reasonably well known from structures of homologous proteins. The ability of moving efficiently a chain may as well have useful applications in the Monte Carlo dynamics for large scale simulations of dense polymeric systems [<xref ref-type="bibr" rid="pone.0118342.ref002">2</xref>]. In such situation, the efficiency of Monte Carlo simulations relies heavily on the kinetic algorithm used to sample the various possible conformational states of the molecule and the introduction of a concerted move which restricts itself to modifying atom locations only in limited positions of the molecule might play a key role to boost performances, by reducing the hindering effect due to excluded volume constraint. Even the theoretical study of conformational flexibility can benefit from the use of local collective movements that, at variance with Cartesian moves, avoid geometric distorsions of the chain giving the possibility to explore all the possible local arrangements of the flexible molecule.</p>
<p>In the biological context, the problem was often reduced to modify dihedral angles that are the only soft degrees of freedom of the system. A first analysis was due to Go and Scheraga [<xref ref-type="bibr" rid="pone.0118342.ref003">3</xref>] with an analytical approach and with the developing of equations for determining the allowed dihedral angles when all the rotating bonds are connected and when a subset is separated by rigid bonds in the trans conformation. This approach was further extended by Theodoru and coworkers [<xref ref-type="bibr" rid="pone.0118342.ref004">4</xref>] to take into account the necessary requirements to ensure Boltzmann distributed sampling for Monte Carlo simulations and by Dinner [<xref ref-type="bibr" rid="pone.0118342.ref005">5</xref>] to generalize the formalism to allow fixed dihedral angles that sequentially interrupt the rotating bonds to be non-planar. Another refinement was later proposed with methods [<xref ref-type="bibr" rid="pone.0118342.ref006">6</xref>–<xref ref-type="bibr" rid="pone.0118342.ref009">9</xref>] in which the inclusion of bond angle variations and of local constraints improved the efficiency of the algorithm. Different formalisms were proposed by Hoffmann and Knapp [<xref ref-type="bibr" rid="pone.0118342.ref010">10</xref>] to derive equations for dihedral angles and to apply these moves to study a protein-like model that had the topology of polyalanine with rigid peptide planes and by Coutsias et al. [<xref ref-type="bibr" rid="pone.0118342.ref011">11</xref>, <xref ref-type="bibr" rid="pone.0118342.ref012">12</xref>] with a robotics inspired approach. The latter approach was succesfully incorporated in state-of-art protein modeling tools, allowing sub-angstrom accuracy in loop reconstruction [<xref ref-type="bibr" rid="pone.0118342.ref013">13</xref>, <xref ref-type="bibr" rid="pone.0118342.ref014">14</xref>]. More recently, an efficient numerical method to solve the analytical solution of the classic chain closure problem was introduced with the specific purpose of optimizing Monte Carlo performances for dense molecular systems [<xref ref-type="bibr" rid="pone.0118342.ref015">15</xref>].</p>
<p>Broadly speaking, all these methods are proposing efficient solutions, while violating the general rules of the problem: either by imposing restrictive conditions on the degrees of freedom that can be used (e.g. moving only specific angles) or by relaxing the boundary constraints (e.g. not keeping completely fixed all the other degrees of freedom).</p>
<p>On the contrary, in this paper we develope a numerical strategy that, exploiting the knowledge of an initial configuration of the chain, allows for an exhaustive exploration of all the possible configurations that can be obtained by modifying <italic>only</italic> <italic>n</italic> &gt; 6 degrees of freedom, and that perfectly adapts to the frozen part of the chain. The choice of the degrees of freedom themselves is completely free and any combination of bond and dihedral angles and of bond lengths can be selected, resulting in a very rapid and efficient search algorithm.</p>
<p>Starting from a geometrical description of the chain inspired by robotic language [<xref ref-type="bibr" rid="pone.0118342.ref016">16</xref>], similar in spirit to the one introduced by Go and Scheraga [<xref ref-type="bibr" rid="pone.0118342.ref003">3</xref>], we derive six numerical equations, as a function of the <italic>n</italic> free variables, which have to be fulfilled to satisfy the boundary conditions. Therefore, if there is no degeneracy, the solutions that have to be found lie on a manifold with dimension <italic>n</italic> − 6. The novel idea we here present consists in an extremely powerful strategy to explore these manifolds, based on moving slightly out along their tangent space and on coming back along the orthogonal space towards a new configuration which satisfies all the equations and constraints. This is viable by means of an appropriate double change of coordinates and by employing mathematical algorithms to optimize the computational time. Moreover, the algorithm is designed in such a way that the detailed balance is quite easily satisfied for a very general choice of the modified degrees of freedom.</p>
<p>The efficiency of the approach is remarkable and it makes possible, for instance, to estimate the volume of the manifold which corresponds to the number of possible conformations that are compatible with the constraints, in the simplest <italic>n</italic> = 7 case. While at this stage the method is presented for an ideal chain, without taking into account excluded volume or other energy functions, such features can be introduced in a straightforward manner.</p>
<p>Although the method is completely general and can be applied to any sort of linear object, it is intriguing to think about its applications to protein chains. In such context bond angles and bond lengths can be considered constant and the <italic>ψ</italic> and <italic>ϕ</italic> dihedral angles (Ramachandran’s angles) are the natural degrees of freedom to be modified: the algorithm we propose thus becomes a generalized crankshaft move involving a portion of the chain of desired length. Some possible applications on proteins are shown, such as the estimation of their backbone mobilities and local structure refinement.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>Denavit-Hartenberg paramaters for chain description</title>
<p>In this section we introduce the parametric representation of a linear chain used to derive the equations at the core of our algorithm. We consider a linear chain composed of <italic>N</italic> + 1 atoms linked serially in which each of the <italic>N</italic> bonds can be labeled with numbers from 1 to <italic>N</italic>. We describe the chain by using the Denavit-Hartenberg (DH) notation [<xref ref-type="bibr" rid="pone.0118342.ref017">17</xref>]. According to DH a local reference system 𝒪<sub><italic>i</italic></sub> can be built on each bond composing the chain: the <italic>ẑ</italic><sub><italic>i</italic></sub> axis lies on the bond while <italic>x̂</italic><sub><italic>i</italic></sub> is oriented as <italic>ẑ</italic><sub><italic>i</italic>−1</sub> × <italic>ẑ</italic><sub><italic>i</italic></sub>. The <italic>ŷ</italic><sub><italic>i</italic></sub> axis is given, as usual, by the right-hand rule. The origin <italic>o</italic><sub><italic>i</italic></sub> of each reference frame is always located along <italic>ẑ</italic><sub><italic>i</italic></sub>: in case <italic>ẑ</italic><sub><italic>i</italic></sub> is co-planar to <italic>ẑ</italic><sub><italic>i</italic>−1</sub>, it lies on the first atom defining the bond; otherwise it lies on the common normal to <italic>ẑ</italic><sub><italic>i</italic></sub> and <italic>ẑ</italic><sub><italic>i</italic>−1</sub>.</p>
<p>A vector <inline-formula id="pone.0118342.e001"><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> in the reference frame 𝒪<sub><italic>j</italic></sub> can be expressed relative to 𝒪<sub><italic>j</italic>−1</sub> as
<disp-formula id="pone.0118342.e002"><alternatives><graphic id="pone.0118342.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e002"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <inline-formula id="pone.0118342.e003"><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold">R</mml:mtext> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is a 3 × 3 orthogonal matrix that expresses the orientation of 𝒪<sub><italic>j</italic></sub> relative to 𝒪<sub><italic>j</italic>−1</sub> and <inline-formula id="pone.0118342.e004"><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:mi>S</mml:mi> <mml:mo accent="true">→</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is a vector describing the position of the origin <italic>o</italic><sub><italic>j</italic></sub> with respect to 𝒪<sub><italic>j</italic>−1</sub>. The matrix <inline-formula id="pone.0118342.e005"><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold">R</mml:mtext> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and the vector <inline-formula id="pone.0118342.e006"><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:mi>S</mml:mi> <mml:mo accent="true">→</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be completely described by using four parameters named <italic>link offset</italic>, <italic>link twist</italic>, <italic>link length</italic> and <italic>joint angle</italic>. These are defined by the following rules:
<list list-type="bullet">
<list-item><p>the <italic>link offset</italic> <italic>d</italic><sub><italic>i</italic></sub> is the distance along <italic>x̂</italic><sub><italic>i</italic></sub> from <italic>o</italic><sub><italic>i</italic></sub> to the intersection of the <italic>x̂</italic><sub><italic>i</italic></sub> and the <italic>ẑ</italic><sub><italic>i</italic>−1</sub> axes (<italic>i.e</italic>. the minimum distance between <italic>ẑ</italic><sub><italic>i</italic>−1</sub> and <italic>ẑ</italic><sub><italic>i</italic></sub> axis);</p></list-item>
<list-item><p>the <italic>link twist</italic> <italic>α</italic><sub><italic>i</italic></sub> is the angle between <italic>ẑ</italic><sub><italic>i</italic>−1</sub> and <italic>ẑ</italic><sub><italic>i</italic></sub> measured about <italic>x̂</italic><sub><italic>i</italic></sub>;</p></list-item>
<list-item><p>the <italic>link length</italic> <italic>r</italic><sub><italic>i</italic></sub> is the distance along <italic>ẑ</italic><sub><italic>i</italic>−1</sub> from <italic>o</italic><sub><italic>i</italic>−1</sub> to the intersection of the <italic>x̂</italic><sub><italic>i</italic></sub> and the <italic>ẑ</italic><sub><italic>i</italic>−1</sub> axes and</p></list-item>
<list-item><p>the <italic>joint angle</italic> <italic>θ</italic><sub><italic>i</italic></sub> is the angle between <italic>x̂</italic><sub><italic>i</italic>−1</sub> and <italic>x̂</italic><sub><italic>i</italic></sub> measured about <italic>ẑ</italic><sub><italic>i</italic>−1</sub>.</p></list-item>
</list></p>
<p><xref ref-type="fig" rid="pone.0118342.g001">Fig. 1</xref> shows how the DH parameters are defined for the general disconnected case (i.e. link offset <italic>d</italic><sub><italic>i</italic></sub> &gt; 0). This is actually a typical case, when the structure of a protein backbone chain with all its heavy atoms is considered, since the <italic>ω</italic> torsional angle around the peptide bond is a hard degree of freedom with a well defined typical value. If <italic>ω</italic> is then kept strictly fixed, the DH convention allows to “spare” that degree of freedom, defining a disconnected chain as shown in <xref ref-type="fig" rid="pone.0118342.g001">Fig. 1</xref>. In the simplest case, when all bonds included in the DH description are connected with each other (i.e. all link offsets <italic>d</italic><sub><italic>i</italic></sub> = 0), the DH variables have a well defined physical meaning. Link lengths are bond lengths, link twists are supplementary of bond angles, and joint angles are torsional angles. The DH formalism is in this case equivalent to the one routinely used by software programs that reconstruct biomolecular structures subject to experimental restraints [<xref ref-type="bibr" rid="pone.0118342.ref018">18</xref>, <xref ref-type="bibr" rid="pone.0118342.ref019">19</xref>] and that employ efficient internal dynamics algorithms that update only the values of torsional angles [<xref ref-type="bibr" rid="pone.0118342.ref020">20</xref>].</p>
<fig id="pone.0118342.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g001</object-id>
<label>Fig 1</label>
<caption>
<title>General graphical representation of a chain according to the Denavit-Hartenberg convention, as discussed in the text.</title>
<p>Thick lines represent the physical bonds and spheres the atoms. <italic>α</italic>, <italic>θ</italic>, <italic>r</italic> and <italic>d</italic> are the DH parameters describing the chain and <italic>o</italic> is the origin of each local frame <inline-formula id="pone.0118342.e108"><inline-graphic xlink:href="info:doi/10.1371/journal.pone.0118342.e108" xlink:type="simple"/></inline-formula>. The structure of a portion of a protein backbone chain with all its heavy atoms is shown superimposed.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g001"/>
</fig>
<p>By using the DH definitions the matrix <inline-formula id="pone.0118342.e007"><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold">R</mml:mtext> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and the vector <inline-formula id="pone.0118342.e008"><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover><mml:mi>S</mml:mi> <mml:mo accent="true">→</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be explicitly expressed as
<disp-formula id="pone.0118342.e009"><alternatives><graphic id="pone.0118342.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfenced separators="" open="(" close=")"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo form="prefix">cos</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo form="prefix">sin</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>-</mml:mo> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mo form="prefix">sin</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo form="prefix">cos</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2a)</label></disp-formula>
<disp-formula id="pone.0118342.e010"><alternatives><graphic id="pone.0118342.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mi>d</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>d</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>r</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mfenced> <mml:mi>T</mml:mi></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2b)</label></disp-formula>
With a more compact notation we rewrite <xref ref-type="disp-formula" rid="pone.0118342.e002">Eq. (1)</xref> with the following
<disp-formula id="pone.0118342.e011"><alternatives><graphic id="pone.0118342.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <inline-formula id="pone.0118342.e012"><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold-sans-serif">T</mml:mtext> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is a 4 × 4 matrix given by
<disp-formula id="pone.0118342.e013"><alternatives><graphic id="pone.0118342.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfenced separators="" open="(" close=")"><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd> <mml:mtd><mml:msubsup><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
and <bold>a</bold> is the vector <inline-formula id="pone.0118342.e014"><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi> <mml:mspace width="1pt"/> <mml:mtext>=</mml:mtext> <mml:mspace width="1pt"/> <mml:msup><mml:mrow><mml:mtext>(</mml:mtext> <mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/> <mml:mn>1</mml:mn> <mml:mtext>)</mml:mtext></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. With this notation it is easier to relate any 𝒪<sub><italic>j</italic></sub> with any other 𝒪<sub><italic>i</italic></sub> (<italic>j</italic> &gt; <italic>i</italic>); indeed the following equation holds:
<disp-formula id="pone.0118342.e015"><alternatives><graphic id="pone.0118342.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e015"/><mml:math id="M15" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>i</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:msup><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>i</mml:mi></mml:msubsup> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mspace width="1pt"/> <mml:mo>⋯</mml:mo> <mml:mspace width="1pt"/> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>It should be now clear that the chain can be described by the whole set {<italic>r</italic><sub><italic>i</italic></sub>, <italic>α</italic><sub><italic>i</italic></sub>, <italic>d</italic><sub><italic>i</italic></sub>, <italic>θ</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic> = 1,⋯,<italic>N</italic></sub>. For simplicity we denote {<italic>r</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic> = 1,⋯,<italic>N</italic></sub> with <bold>r</bold>, {<italic>α</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic> = 1,⋯,<italic>N</italic></sub> with <italic>α</italic>, {<italic>d</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic> = 1,⋯,<italic>N</italic></sub> with <bold>d</bold> and {<italic>θ</italic><sub><italic>i</italic></sub>}<sub><italic>i</italic> = 1,⋯,<italic>N</italic></sub> with <italic>θ</italic>; the chain configuration is then given by the set {<bold>r</bold>, <italic>α</italic>, <bold>d</bold>, <italic>θ</italic>}.</p>
</sec>
<sec id="sec004">
<title>Performing the concerted local move</title>
<p>It is possible to deform an initial configuration {<bold>r</bold><sub>0</sub>, <italic>α</italic><sub>0</sub>, <bold>d</bold><sub>0</sub>, <italic>θ</italic><sub>0</sub>} by changing at least one of the parameters describing it.</p>
<p>Consider <italic>n</italic> DH parameters <italic>ξ̃</italic><sub><italic>μ</italic></sub>, with <italic>μ</italic> = 1, ⋯, <italic>n</italic> and the <italic>n</italic><sub><italic>b</italic></sub> bonds to which the <italic>n</italic> parameters are related. The number of bonds to be considered is always smaller or equal to the number of DH parameters because in principle two or more parameters could be related to the same bond. As already stated we consider the general case in which these bonds can be non-consecutive. There are two particularly interesting bonds among the <italic>n</italic><sub><italic>b</italic></sub>: the first and the last <italic>i.e</italic>. the one with the lowest label and the one with the highest one. These two bonds delimit the region of the chain we are interested in modifying with an opportune change of <inline-formula id="pone.0118342.e016"><mml:math id="M16" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></inline-formula>, leaving the atoms outside this region unmodified (see <xref ref-type="fig" rid="pone.0118342.g002">Fig. 2</xref>). Such a change can be highly non-trivial and could not always be obtained: we will see later a condition that ensures us that this change can be performed.</p>
<fig id="pone.0118342.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Schematic representation of the portion of a linear chain involved in a local modification.</title>
<p>Bonds (1) and (<italic>n</italic><sub><italic>b</italic></sub> + 1) are colored in blue while all the others are in red. The degrees of freedom which are varied (<italic>ξ</italic><sub>1</sub>, …, <italic>ξ</italic><sub><italic>n</italic></sub>) are arbitrarily distributed inside the region. When they are concertedly changed to new values <inline-formula id="pone.0118342.e017"><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>ξ</mml:mi> <mml:mn>1</mml:mn> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>ξ</mml:mi> <mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the new pink configuration is obtained while all the bonds outside the region (in black) remain fixed in space.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g002"/>
</fig>
<p>For convenience, we re-label the bonds we are interested in with numbers from 1 to <italic>n</italic><sub><italic>b</italic></sub> + 1, where the latter is the first bond that remains fixed subsequent to the moved portion of the chain. The condition that needs to be imposed in order to ensure the locality of the change {<bold>r</bold><sub>0</sub>, <italic>α</italic><sub>0</sub>, <bold>d</bold><sub>0</sub>, <italic>θ</italic><sub>0</sub>} → {<bold>r</bold>, <italic>α</italic>, <bold>d</bold>, <italic>θ</italic>} is
<disp-formula id="pone.0118342.e018"><alternatives><graphic id="pone.0118342.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e018"/><mml:math id="M18" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>α</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi mathvariant="bold">d</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>α</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi mathvariant="bold">d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>θ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
that is requiring that the local reference frame 𝒪<sub><italic>n</italic><sub><italic>b</italic></sub>+1</sub> does not move with respect to the first one. In order to explicit the variables <inline-formula id="pone.0118342.e019"><mml:math id="M19" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></inline-formula> inside the relation in <xref ref-type="disp-formula" rid="pone.0118342.e018">Eq. (6)</xref> we define, with abuse of notation,
<disp-formula id="pone.0118342.e020"><alternatives><graphic id="pone.0118342.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e020"/><mml:math id="M20" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">r</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>α</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi mathvariant="bold">d</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">r</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>α</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi mathvariant="bold">d</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>θ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
in such a way that <xref ref-type="disp-formula" rid="pone.0118342.e018">Eq. (6)</xref> can be rewritten as
<disp-formula id="pone.0118342.e021"><alternatives><graphic id="pone.0118342.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e021"/><mml:math id="M21" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn mathvariant="sans-serif">0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
Given the form of <inline-formula id="pone.0118342.e022"><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold-sans-serif">T</mml:mtext> <mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> (described in <xref ref-type="disp-formula" rid="pone.0118342.e013">Eq. (4)</xref>), the 16 equations that are implicit in <xref ref-type="disp-formula" rid="pone.0118342.e021">Eq. (8)</xref> can be reduced to 6 equations in the <italic>n</italic> variables <inline-formula id="pone.0118342.e023"><mml:math id="M23" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></inline-formula>. Three equations are needed in order to set the translational part of <inline-formula id="pone.0118342.e024"><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="bold-sans-serif">T</mml:mtext> <mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and other three for the rotational part. We choose, for instance,
<disp-formula id="pone.0118342.e025"><alternatives><graphic id="pone.0118342.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e025"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfenced separators="" open="{" close=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msub><mml:mfenced separators="" open="[" close="]"><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msub><mml:mfenced separators="" open="[" close="]"><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>02</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msub><mml:mfenced separators="" open="[" close="]"><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>12</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>4</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msub><mml:mfenced separators="" open="[" close="]"><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>03</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msub><mml:mfenced separators="" open="[" close="]"><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>13</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>6</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msub><mml:mfenced separators="" open="[" close="]"><mml:msubsup><mml:mi mathvariant="bold-sans-serif">T</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced> <mml:mn>23</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
or, in a more compact form, <inline-formula id="pone.0118342.e026"><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mtext mathvariant="bold">0</mml:mtext></mml:mrow></mml:math></inline-formula>. If <italic>n</italic> is greater than 6 and if the system of equation described in <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref> is non degenerate then the solutions lie on a manifold with dimension <italic>n</italic> − 6. If, on the contrary, the system is degenerate the solutions lie on a manifold with dimension greater than <italic>n</italic> − 6.</p>
<p>Before to proceed it is important to notice that since the degrees of freedom <inline-formula id="pone.0118342.e027"><mml:math id="M27" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></inline-formula> can describe both spatial or angular quantities the space defined by these variables is in general dimensionally non-homogeneous. For this reason we introduce a set of <italic>n</italic> scalar multipliers <italic>λ</italic><sub><italic>i</italic></sub> chosen in such a way that every <italic>ξ</italic><sub><italic>i</italic></sub> = <italic>λ</italic><sub><italic>i</italic></sub><italic>ξ̃</italic><sub><italic>i</italic></sub> is dimensionless. The space defined by the rescaled variables <italic>ξ</italic><sub><italic>i</italic></sub> is now homogeneous and an appropriate metric can be defined in it by means of the usual scalar product. In the case that a set of homogeneous variables are chosen as system variables (<italic>e.g</italic>. all dihedral angles) the introduction of the scalar multipliers is unnecessary but nonetheless it turns out to be useful (see Section “<xref ref-type="sec" rid="sec006">Tuning of fluctuations by rescaling variables</xref>”).</p>
<p>The problem of finding a new configuration <italic>ξ</italic> starting from an existing <italic>ξ</italic><sub>0</sub> in such a way that <xref ref-type="disp-formula" rid="pone.0118342.e021">Eq. (8)</xref> is satisfied can now be visualized as the problem of <italic>moving</italic> on an (<italic>n</italic> − 6)-dimensional manifold embedded in an <italic>n</italic>-dimensional space. The most intuitive way to perform this non-trivial task is that of generating an intermediate configuration <italic>ξ</italic><sup>′</sup> that may not lie on the manifold but that it is not far from it. This first step is called by other authors <italic>pre-rotation</italic> [<xref ref-type="bibr" rid="pone.0118342.ref015">15</xref>, <xref ref-type="bibr" rid="pone.0118342.ref021">21</xref>], and we will adapt to this nomenclature. Starting from <italic>ξ</italic><sup>′</sup> it is then possible to compute a true solution with numerical methods, <italic>e.g</italic>. root finding algorithms, or analytical ones [<xref ref-type="bibr" rid="pone.0118342.ref012">12</xref>].</p>
<p>In order to simplify the description of the pre-rotation step we introduce two new quantities <italic>n</italic><sub><italic>m</italic></sub> and <italic>n</italic><sub><italic>v</italic></sub> that are respectively the dimension of the tangent space <italic>M</italic> to the manifold at <italic>ξ</italic><sub><bold>0</bold></sub> and the dimension of the orthogonal space <italic>V</italic> to the manifold at <italic>ξ</italic><sub><bold>0</bold></sub>. Obviously <italic>n</italic><sub><italic>m</italic></sub> + <italic>n</italic><sub><italic>v</italic></sub> = <italic>n</italic> and <italic>n</italic><sub><italic>v</italic></sub> = 6 if the system <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref> is non-degenerate. In general <italic>n</italic><sub><italic>v</italic></sub> is the number of linearly independent functions in (<xref ref-type="disp-formula" rid="pone.0118342.e025">9</xref>). The procedure we use to find a basis of the tangent space to the manifold takes advantage of the implicit function theorem in order to compute the derivatives <inline-formula id="pone.0118342.e028"><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. Indeed we consider <italic>n</italic><sub><italic>m</italic></sub> among the <italic>n</italic> variables as independent and we denote them with the subscript <italic>x</italic>. The other <italic>n</italic><sub><italic>v</italic></sub> are labeled with a subscript <italic>y</italic> and will be written as a function of <italic>ξ</italic><sub><bold>x</bold></sub>. With this notation we can write a set of <italic>n</italic><sub><italic>m</italic></sub> <italic>n</italic>-dimensional vectors that span the tangent space as
<disp-formula id="pone.0118342.e029"><alternatives><graphic id="pone.0118342.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e029"/><mml:math id="M29" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>e</mml:mi> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfenced separators="" open="(" close=")"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ξ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where the derivative <inline-formula id="pone.0118342.e030"><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ξ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be performed by computing separately the contribute of the dependent variables <italic>ξ</italic><sub><italic>y</italic></sub> and that of the independent ones <italic>ξ</italic><sub><italic>x</italic></sub>. The former (in the form of an <italic>n</italic><sub><italic>v</italic></sub>-dimensional vector <inline-formula id="pone.0118342.e031"><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ξ</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>) can be easily computed by applying the implicit function theorem
<disp-formula id="pone.0118342.e032"><alternatives><graphic id="pone.0118342.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e032"/><mml:math id="M32" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi mathvariant="bold">y</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mfenced separators="" open="(" close=")"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold">f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi mathvariant="bold">y</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>·</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold">f</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
while the latter is given by the <italic>n</italic><sub><italic>m</italic></sub> relations <inline-formula id="pone.0118342.e033"><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ξ</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mrow><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. In the cases in which the matrix <inline-formula id="pone.0118342.e034"><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold">f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi mathvariant="bold">y</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is not invertible it is sufficient to choose a different set of <italic>ξ</italic><sub><bold>x</bold></sub> as independent variables. Vectors <italic>e</italic><sub><italic>x</italic>,<italic>i</italic></sub> can be orthonormalized to compute a basis {<italic>ê</italic><sub><italic>x</italic>,<italic>i</italic></sub>}<sub><italic>i</italic></sub> for the tangent space. The intermediate configuration <italic>ξ</italic><sup>′</sup> can finally be computed by simply summing an arbitrary linear combination of <italic>ê</italic><sub><italic>x</italic>,<italic>i</italic></sub> to the initial configuration <italic>ξ</italic><sub><bold>0</bold></sub>.</p>
<p>The intermediate configuration is an <italic>open configuration</italic> in which the position and orientation of the last reference frame do not correspond to the target ones. We therefore adjust the coordinates on the orthogonal space <italic>V</italic> by using a root-finding algorithm to obtain the final configuration. <xref ref-type="fig" rid="pone.0118342.g003">Fig. 3</xref> depicts an example move in case the manifold is one-dimensional (the full example is addressed in the Section “Workout example”). The solution manifold (blue) and the initial configuration are represented. The pre-rotation step corresponds to the first update (thick red arrow) while the second step along the dotted line allows to converge back to the manifold by means of a root-finding algorithm. This is in general possible only for small enough pre-rotation steps. The brown arrows show the case when a too big pre-rotation step does not allow the procedure to converge back to the manifold.</p>
<fig id="pone.0118342.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Graphical sketch of the updating of the conformations in the <italic>n</italic>-dimensional space of the degrees of freedom which are changed.</title>
<p>The blue line represents the manifold of the solutions of <xref ref-type="disp-formula" rid="pone.0118342.e089">Eq. (23)</xref>, as discussed in the Section “Workout example” within “Material and Methods”. The manifold is plotted within the (<italic>θ</italic>, <italic>ρ</italic>) plane, with the independent variable being <italic>ξ</italic><sub><italic>x</italic></sub> = <italic>ρ</italic> and the dependent variable <italic>ξ</italic><sub><italic>y</italic></sub> = <italic>θ</italic>. <italic>M</italic> and <italic>V</italic> are respectively the tangent and the orthogonal space to the manifold in the starting conformation <italic>ξ</italic><sub>0</sub>. The degrees of freedom are first changed along <italic>M</italic> (red continuous arrow) and a new conformation satisfying <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref> is reached by moving along <italic>V</italic> (dashed red arrow). If the pre-rotation step along <italic>M</italic> is too large (brown continuous arrow), the post-rotation closure step along <italic>V</italic> (dashed brown arrow) fails to fall back to the manifold.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g003"/>
</fig>
<p>A basis for <italic>V</italic> can be efficiently computed starting from the knowledge of a basis for <italic>M</italic> and by using <italic>ad-hoc</italic> algorithms (<italic>e.g</italic>. QR-decomposition algorithm). With this strategy the chain closure step usually takes few iterations of the Broyden’s root finding algorithm. Notice that it is in principle possible to use a root-finding algorithm that takes advantage of the easy-to-compute gradient <inline-formula id="pone.0118342.e035"><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold">f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ξ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ξ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> to boost the search for the solution. However our tests have shown that the time saved by the root-finding algorithm usually does not compensate for the time necessary for computing the gradient.</p>
<p>The full algorithm can be summarized in the following steps:
<list list-type="order">
<list-item><p>Compute a basis for the tangent space <italic>M</italic> at <italic>ξ</italic><sub><bold>0</bold></sub>, as well as a basis for the orthogonal space <italic>V</italic>;</p></list-item>
<list-item><p>Choose an arbitrary direction <inline-formula id="pone.0118342.e036"><mml:math id="M36" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> in <italic>M</italic> and an arbitrary step length <italic>ds</italic>;</p></list-item>
<list-item><p>Generate an intermediate configuration <inline-formula id="pone.0118342.e037"><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>ξ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ξ</mml:mi><mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>⋅</mml:mo> <mml:mover accent="true"><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>;</p></list-item>
<list-item><p>Use a root-finding algorithm in order to converge to a solution of <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref> by moving on <italic>V</italic>;</p></list-item>
</list></p>
</sec>
<sec id="sec005">
<title>Detailed balance</title>
<p>In this section we will denote the three-dimensional configuration of an <italic>N</italic>-atom chain at time <italic>t</italic> with the 3<italic>N</italic>-dimensional vector <inline-formula id="pone.0118342.e038"><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>R</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mn>1</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>⋯</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>N</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>, where each <inline-formula id="pone.0118342.e039"><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>r</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> represents the three-dimensional position of atom <italic>k</italic> at time <italic>t</italic>.</p>
<p>In order to demonstrate that the scheme we proposed for changing the backbone configuration satisfies the detailed balance condition
<disp-formula id="pone.0118342.e040"><alternatives><graphic id="pone.0118342.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e040"/><mml:math id="M40" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mo>→</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Π</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mo>→</mml:mo> <mml:msup><mml:mi>R</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
we will show separately that (1) with an appropriate change of variables, it is possible to uniformly sample the whole configurational space of the system without changes to the algorithm and (2) the probability of moving from <italic>R</italic><sup><italic>t</italic></sup> to <italic>R</italic><sup><italic>t</italic>+Δ<italic>t</italic></sup> can be chosen in such a way that Π(<italic>R</italic><sup><italic>t</italic></sup> → <italic>R</italic><sup><italic>t</italic>+Δ<italic>t</italic></sup>) = Π(<italic>R</italic><sup><italic>t</italic>+Δ<italic>t</italic></sup> → <italic>R</italic><sup><italic>t</italic></sup>).</p>
<p>We start by showing that point (1) is true. If the DH’s variables <italic>α</italic>, <italic>θ</italic>, <bold>r</bold> are used for describing the chain, the volume element in the configurational space
<disp-formula id="pone.0118342.e041"><alternatives><graphic id="pone.0118342.e041g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e041"/><mml:math id="M41" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>z</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
can be rewritten as
<disp-formula id="pone.0118342.e042"><alternatives><graphic id="pone.0118342.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e042"/><mml:math id="M42" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>V</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msubsup><mml:mi>J</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where <inline-formula id="pone.0118342.e043"><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>J</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mtext>sin</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>α</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. Since the determinant <inline-formula id="pone.0118342.e044"><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>J</mml:mi> <mml:mi>s</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>J</mml:mi> <mml:mi>k</mml:mi> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> of the change of variables <italic>R</italic><sub><italic>t</italic></sub> → {<italic>α</italic>, <italic>θ</italic>, <bold>r</bold>} is not constant, a uniform sampling of the space of the DH’s variables does not result in a uniform sampling of the configurational space. In this case uniformity can be achieved by accepting the configuration change {<italic>α</italic>, <italic>θ</italic>, <bold>r</bold>}<sub>1</sub> → {<italic>α</italic>, <italic>θ</italic>, <bold>r</bold>}<sub>2</sub> with probability <inline-formula id="pone.0118342.e045"><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mtext>min</mml:mtext> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:msup><mml:mi>J</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mi>J</mml:mi> <mml:mi>t</mml:mi></mml:msup></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Such essential choice compromises efficiency both by increasing the number of calculations per time step and by reducing the probability of obtaining a new configuration. With our approach the problem is overcome without performing any additional time-consuming calculation. Indeed it is easy to notice that the algorithm proposed in the previous section does not rely on the particular form of <italic>ξ</italic> or <inline-formula id="pone.0118342.e046"><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="bold">f</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> but rather on the possibility of computing <inline-formula id="pone.0118342.e047"><mml:math id="M47" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and its derivatives. For this reason every differentiable, invertible function of <inline-formula id="pone.0118342.e048"><mml:math id="M48" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></inline-formula>, whose inverse is differentiable, can be used as degree of freedom of the system without jeopardizing the efficiency of the full scheme. If, for instance, <inline-formula id="pone.0118342.e049"><mml:math id="M49" display="inline" overflow="scroll"><mml:mrow><mml:mi>ψ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>g</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is used as degree of freedom, the following trivial relations holds:
<disp-formula id="pone.0118342.e050"><alternatives><graphic id="pone.0118342.e050g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e050"/><mml:math id="M50" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">g</mml:mi> <mml:mfenced separators="" open="(" close=")"><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mfenced> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15a)</label></disp-formula> <disp-formula id="pone.0118342.e051"><alternatives><graphic id="pone.0118342.e051g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e051"/><mml:math id="M51" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold">f</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold">f</mml:mi> <mml:mo>(</mml:mo> <mml:mi>ψ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi mathvariant="bold">g</mml:mi> <mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15b)</label></disp-formula>
If DH’s parameters can be interpreted as bond lengths, bond angles and torsional angles (<italic>θ</italic> is always a torsional angle, <italic>α</italic> is a bond angle for bonds connected to the previous one, <italic>r</italic> is a bond length for bonds connected to both the previous and the subsequent one) it is sufficient to use the variables <inline-formula id="pone.0118342.e052"><mml:math id="M52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mi>o</mml:mi> <mml:mi>s</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>α</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="pone.0118342.e053"><mml:math id="M53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="bold">r</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>r</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula> as new degrees of freedom in order to guarantee the determinant of the Jacobian of the change of variables to be constant: this implies that the new configuration can always be accepted. This result relies only on the fact that the Jacobian does not depend on <italic>ξ</italic>; we derived it independently from the values of the rescaling factors.</p>
<p>Notice that even if the inverse of the cosine function is not differentiable in 0 and <italic>π</italic>, these points are at the boundary of the domain in which the bond angle <italic>α</italic> is defined. Hence the analysis is valid in the open domain (0, <italic>π</italic>) but not in its closure. The same is true for <inline-formula id="pone.0118342.e054"><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:msup><mml:mi>r</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mn>3</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>, whose inverse is not differentiable in <italic>r</italic> = 0. Of course these drawbacks are not relevant for most applications, since <italic>α</italic> = 0, <italic>π</italic> and <italic>r</italic> = 0 are far from physical values. Therefore a uniform sampling of the space of the new variables <inline-formula id="pone.0118342.e055"><mml:math id="M55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>α</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi mathvariant="bold">r</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is sufficient to ensure a uniform sampling of the configurational space.</p>
<p>In order to ensure the detailed balance condition to be valid it is now necessary to check whether the step size <italic>ds</italic> that has been used in the forward update <italic>ξ</italic><sub>1</sub> → <italic>ξ</italic><sub>2</sub> is the same that would be necessary for the reverse transformation <italic>ξ</italic><sub>2</sub> → <italic>ξ</italic><sub>1</sub>. Indeed the step size is typically chosen from a fixed probability distribution and therefore if the backward step size <italic>ds</italic><sup>′</sup> is different from the forward one, it is necessary to take into account the different probability of proposing such a step. The backward step can be easily computed as the norm of the projection of <italic>ξ</italic><sub>2</sub> − <italic>ξ</italic><sub>1</sub> onto the tangent space to the manifold at <italic>ξ</italic><sub>2</sub>. If the step size is chosen from a normal distribution with zero average and variance <italic>σ</italic><sup>2</sup> it is sufficient to accept the update with probability
<disp-formula id="pone.0118342.e056"><alternatives><graphic id="pone.0118342.e056g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e056"/><mml:math id="M56" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>=</mml:mo> <mml:mo movablelimits="true" form="prefix">min</mml:mo> <mml:mfenced separators="" open="(" close=")"><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced separators="" open="(" close=")"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mrow><mml:mo>′</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
to ensure the equivalence between forward and backward probability. In many practical cases <inline-formula id="pone.0118342.e057"><mml:math id="M57" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is close to one and, as a consequence, the probability of rejecting a Monte Carlo move is negligible. This calculation can be done for whatever choice of the factors <italic>λ</italic><sub><italic>i</italic></sub>. The detailed balance can therefore be satisfied independently from the choice of each <italic>λ</italic><sub><italic>i</italic></sub>.</p>
</sec>
<sec id="sec006">
<title>Tuning fluctuations by rescaling variables</title>
<p>The role of rescaling factors <italic>λ</italic><sub><italic>i</italic></sub> previously introduced can be further exploited. As already briefly discussed, their introduction has been necessary to map the <italic>original</italic> non-homogeneous space of the variables <inline-formula id="pone.0118342.e058"><mml:math id="M58" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></inline-formula> in the homogeneous one of the variables <inline-formula id="pone.0118342.e059"><mml:math id="M59" display="inline" overflow="scroll"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>λ</mml:mi> <mml:mo>⋅</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> where a metric can be defined. But on top of that they can be used in order to tune the fluctuations of the corresponding degrees of freedom.</p>
<p>Given a starting configuration <inline-formula id="pone.0118342.e060"><mml:math id="M60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> suppose that some of the <inline-formula id="pone.0118342.e061"><mml:math id="M61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are hard degrees of freedom (<inline-formula id="pone.0118342.e062"><mml:math id="M62" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) while the others are soft (<inline-formula id="pone.0118342.e063"><mml:math id="M63" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>). We can use two different values of <italic>λ</italic><sub><italic>i</italic></sub>, depending on the class of the corresponding degrees of freedom, thus mapping
<disp-formula id="pone.0118342.e064"><alternatives><graphic id="pone.0118342.e064g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e064"/><mml:math id="M64" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>→</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <italic>λ</italic><sub><italic>H</italic></sub> &gt; <italic>λ</italic><sub><italic>S</italic></sub>. As described in previous sections the algorithm is applied to the initial conformation in the homogeneous, deformed space. For simplicity we consider in the following discussion the particular case in which the soft degrees of freedom correspond to the independent variables, in such a way that the new configuration <italic>ξ</italic> can be written as a function of the variation vectors Δ<italic>ξ</italic><sub><italic>S</italic></sub> and Δ<italic>ξ</italic><sub><italic>H</italic></sub> = ∇<sub><italic>ξ</italic><sub><italic>S</italic></sub></sub> <italic>ξ</italic><sub><italic>H</italic></sub> ⋅ Δ<italic>ξ</italic><sub><italic>S</italic></sub> as
<disp-formula id="pone.0118342.e065"><alternatives><graphic id="pone.0118342.e065g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e065"/><mml:math id="M65" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ξ</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>ξ</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mfenced> <mml:mi>T</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where ∇<sub><italic>ξ</italic><sub><italic>S</italic></sub></sub> <italic>ξ</italic><sub><italic>H</italic></sub> is the matrix of the derivatives of the hard degrees of freedom with respect to the soft ones.</p>
<p>It is possible to express the norm of the variation vector for independent variables <inline-formula id="pone.0118342.e066"><mml:math id="M66" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as a function of the size of the actual move performed in our algorithm, the step size <italic>ds</italic> in the tangent space: <inline-formula id="pone.0118342.e067"><mml:math id="M67" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mspace width="0.278em"/><mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:msup><mml:mo stretchy="false">∣</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:msup><mml:mo stretchy="false">∣</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.278em"/><mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math></inline-formula>. The previous equation allows to define the function <inline-formula id="pone.0118342.e068"><mml:math id="M68" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> through <inline-formula id="pone.0118342.e069"><mml:math id="M69" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:mfrac> <mml:mspace width="0.278em"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>. The function <inline-formula id="pone.0118342.e070"><mml:math id="M70" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> describes the reduction of the variation of the soft independent variables, for a fixed step size <italic>ds</italic>, due to the orientation of the tangent space with respect to the space of independent variables. It depends, in general, both on the position of the initial point in the manifold and on the chosen rescaling factors.</p>
<p>Each point of the deformed manifold can be remapped to the original manifold with the inverse transformation <inline-formula id="pone.0118342.e071"><mml:math id="M71" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfrac> <mml:mi>ξ</mml:mi></mml:mrow></mml:math></inline-formula>. Therefore the new configuration found in <xref ref-type="disp-formula" rid="pone.0118342.e065">Eq. (18)</xref> corresponds to a final configuration in the original space equal to
<disp-formula id="pone.0118342.e072"><alternatives><graphic id="pone.0118342.e072g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e072"/><mml:math id="M72" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msup><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:mfrac> <mml:mfenced separators="" open="[" close="]"><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub></mml:mfenced> <mml:mspace width="0.277778em"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mfenced> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>H</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mfrac> <mml:mfenced separators="" open="[" close="]"><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub></mml:mfenced> <mml:mspace width="0.277778em"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mfenced> <mml:mspace width="0.277778em"/><mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:mfenced> <mml:mi>T</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pone.0118342.e073"><mml:math id="M73" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a normalized vector.</p>
<p>The previous equation holds also in the <italic>λ</italic><sub><italic>S</italic></sub> = <italic>λ</italic><sub><italic>H</italic></sub> = 1 case, when no rescaling occurs. The rescaling factor <italic>K</italic><sub><italic>S</italic></sub> for the variation of the independent variables <inline-formula id="pone.0118342.e074"><mml:math id="M74" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as a consequence of the introduction of <italic>λ</italic><sub><italic>S</italic></sub>, <italic>λ</italic><sub><italic>H</italic></sub> ≠ 1 is then easily computed:
<disp-formula id="pone.0118342.e075"><alternatives><graphic id="pone.0118342.e075g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e075"/><mml:math id="M75" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:mfrac> <mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub></mml:mfenced></mml:mrow> <mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
while the rescaling factor <italic>K</italic><sub><italic>H</italic></sub> for the variation of the hard degrees of freedom <inline-formula id="pone.0118342.e076"><mml:math id="M76" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mtext mathvariant="bold">ξ</mml:mtext> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> reads
<disp-formula id="pone.0118342.e077"><alternatives><graphic id="pone.0118342.e077g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e077"/><mml:math id="M77" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mfrac> <mml:mspace width="0.277778em"/><mml:msub><mml:mi>K</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>∣</mml:mo> <mml:mo>∣</mml:mo></mml:mrow> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>∣</mml:mo> <mml:mo>∣</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>∣</mml:mo> <mml:mo>∣</mml:mo></mml:mrow> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mrow><mml:mo>∣</mml:mo> <mml:mo>∣</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
This is the central equation of this section, as it shows to what extent the variation vector for hard degrees of freedom is modified differently than for soft degrees of freedom, due to the rescaling of the original variables. Besides the global tuning factor <inline-formula id="pone.0118342.e078"><mml:math id="M78" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> a second factor <inline-formula id="pone.0118342.e079"><mml:math id="M79" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>⋅</mml:mo> <mml:msub><mml:mover><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo></mml:mrow> <mml:mrow><mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo>⋅</mml:mo> <mml:msub><mml:mover><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> appears, related to the local geometrical properties of the considered manifold.</p>
<p>For one-dimensional manifolds, it is easy to see that <inline-formula id="pone.0118342.e080"><mml:math id="M80" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:mfrac> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, so that <inline-formula id="pone.0118342.e081"><mml:math id="M81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; the variations of both the hard and the soft degrees of freedom are rescaled in the same way, as if a new effective step size <inline-formula id="pone.0118342.e082"><mml:math id="M82" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mspace width="0.278em"/><mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> were used.</p>
<p>For manifold of higher dimension, if <inline-formula id="pone.0118342.e083"><mml:math id="M83" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>≠</mml:mo> <mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:mfrac> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> then <inline-formula id="pone.0118342.e084"><mml:math id="M84" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>K</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≠</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the <italic>λ</italic> factors can effectively be used in order to tune the amplitude of the fluctuations of hard degrees of freedom with respect to the soft ones. It is obviously not easy to quantify ‘a priori’ the local geometric factor <inline-formula id="pone.0118342.e085"><mml:math id="M85" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mi>ξ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>⋅</mml:mo> <mml:msub><mml:mover><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo></mml:mrow> <mml:mrow><mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub></mml:msub> <mml:msub><mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mi>H</mml:mi></mml:msub> <mml:mo>⋅</mml:mo> <mml:msub><mml:mover><mml:mrow><mml:mo>Δ</mml:mo> <mml:mover><mml:mi>ξ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mo accent="true">^</mml:mo></mml:mover> <mml:mi>S</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:mo stretchy="false">∣</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p>
<p>In the most general case, with no restriction on the soft degrees of freedom being either independent or dependent variables, we expect to find qualitatively similar results both for high-dimensional and one-dimensional manifolds.</p>
</sec>
<sec id="sec007">
<title>Workout example</title>
<p>In order to better explain each step of the algorithm we provide a simple example that can be solved exactly. Beyond the context of concerted local movements in chain molecules, the simplest possible case for our algorithm corresponds to the motion along a one-dimensional manifold defined by a single constraint within a two-dimensional space. In this spirit, we consider a physical system in which a single particle is constrained to move within the (<italic>x</italic>, <italic>y</italic>) plane on the right branch (<italic>x</italic> ≥ 1) of a hyperbola of equation
<disp-formula id="pone.0118342.e086"><alternatives><graphic id="pone.0118342.e086g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e086"/><mml:math id="M86" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
We introduce new polar coordinates <inline-formula id="pone.0118342.e087"><mml:math id="M87" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mover><mml:mi>ρ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi>y</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:mo>,</mml:mo> <mml:mover><mml:mi>θ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mtext mathvariant="normal">atan</mml:mtext> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mfrac><mml:mi>y</mml:mi> <mml:mi>x</mml:mi></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> that, in this example, will have the same role the DH parameters have for the description of a chain molecule. Notice that <italic>θ̃</italic> is defined in the open interval <inline-formula id="pone.0118342.e088"><mml:math id="M88" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>4</mml:mn></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>4</mml:mn></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We also introduce two scalar quantities <italic>λ</italic><sub><italic>ρ</italic></sub> and <italic>λ</italic><sub><italic>θ</italic></sub> defined in such a way that <italic>ρ</italic> = <italic>λ</italic><sub><italic>ρ</italic></sub> <italic>ρ̃</italic> and <italic>θ</italic> = <italic>λ</italic><sub><italic>θ</italic></sub> <italic>θ̃</italic> are both dimensionless quantities. Constraints are defined by the analogous of <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref> <disp-formula id="pone.0118342.e089"><alternatives><graphic id="pone.0118342.e089g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e089"/><mml:math id="M89" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/> <mml:mo>:</mml:mo> <mml:mspace width="1pt"/> <mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
that, as a function of the rescaled variables becomes
<disp-formula id="pone.0118342.e090"><alternatives><graphic id="pone.0118342.e090g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e090"/><mml:math id="M90" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ρ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="1pt"/> <mml:mo>:</mml:mo> <mml:mspace width="1pt"/> <mml:mfrac><mml:msup><mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mfrac><mml:mi>θ</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
The tangent space <italic>M</italic> and the orthogonal space <italic>V</italic> in the initial configuration (<italic>ρ</italic><sub>0</sub>, <italic>θ</italic><sub>0</sub>) can be easily computed starting from the expression of the derivatives of <italic>f</italic><sub>1</sub>(<italic>ρ</italic>, <italic>θ</italic>)
<disp-formula id="pone.0118342.e091"><alternatives><graphic id="pone.0118342.e091g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e091"/><mml:math id="M91" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfenced separators="" open="{" close=""><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ρ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mfrac><mml:mi>ρ</mml:mi> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo form="prefix">cos</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mfrac><mml:mi>θ</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>ρ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>θ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mfrac><mml:msup><mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mfrac><mml:mi>θ</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
by means of the implicit function theorem. Indeed, if the initial configuration is such that <inline-formula id="pone.0118342.e092"><mml:math id="M92" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ρ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>θ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>≠</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<italic>i.e</italic>.<italic>θ</italic> ≠ 0) it is possible to choose <italic>ρ</italic> as independent variable and to compute the derivative <inline-formula id="pone.0118342.e093"><mml:math id="M93" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>θ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:mi>ρ</mml:mi></mml:mfrac> <mml:mtext mathvariant="normal">cotan</mml:mtext> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mn>2</mml:mn> <mml:mfrac><mml:mi>θ</mml:mi> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The tangent space <italic>M</italic> is therefore generated by the vector <inline-formula id="pone.0118342.e094"><mml:math id="M94" display="inline" overflow="scroll"><mml:mrow><mml:mi>η</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ρ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>θ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> and any intermediate configuration can be selected as <inline-formula id="pone.0118342.e105"><mml:math id="M105" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>ds</italic> is an arbitrary step-size and <inline-formula id="pone.0118342.e106"><mml:math id="M106" display="inline" overflow="scroll"><mml:mover><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is normalized. Once <italic>η</italic> is computed, the QR algorithm is used in order to generate a basis for the orthogonal space <italic>V</italic>. In this simple example <italic>V</italic> is one-dimensional and the generating vector can be computed explicitly as <inline-formula id="pone.0118342.e095"><mml:math id="M95" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>η</mml:mi> <mml:mo>⊥</mml:mo></mml:msup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ρ</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>θ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. A root finding algorithm is finally used in order to find a solution to the equation <italic>f</italic><sub>1</sub>(<italic>ρ</italic>, <italic>θ</italic>) = 0 with <inline-formula id="pone.0118342.e107"><mml:math id="M107" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>η</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>⊥</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and with varying <italic>k</italic>. In case <italic>θ</italic> = 0, it is not possible to use <italic>ρ</italic> as the independent variable, and <italic>θ</italic> has to be chosen instead. Notice that in order to ensure numerical stability it is safer to use <italic>θ</italic> as independent variable in a suitable interval centered in <italic>θ</italic> = 0. Also, the existence of a solution is in general ensured only for small enough step sizes, as depicted in <xref ref-type="fig" rid="pone.0118342.g003">Fig. 3</xref>.</p>
<p>We now consider within this example the effect of introducing the rescaling factors <italic>λ</italic><sub><italic>ρ</italic></sub> and <italic>λ</italic><sub><italic>θ</italic></sub>, as discussed in the previous section. We assume <italic>θ̃</italic> ≠ 0, so that <italic>ρ</italic> can be used as the independent variable. In this case we see that
<disp-formula id="pone.0118342.e096"><alternatives><graphic id="pone.0118342.e096g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e096"/><mml:math id="M96" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mi>θ</mml:mi></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi></mml:msub></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
and therefore any rescaling induced for <italic>dρ</italic> is applied to <italic>dθ</italic> as well, as expected for a one-dimensional manifold. The relation between the step size <italic>ds</italic> tangent to the manifold and the variation <italic>dρ̃</italic> of the independent unrescaled variable is <inline-formula id="pone.0118342.e097"><mml:math id="M97" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>d</mml:mi> <mml:mover><mml:mi>ρ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mover><mml:mi>θ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:mover><mml:mi>ρ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:mrow></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo stretchy="true">]</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:math></inline-formula>, that allows to recover the function <inline-formula id="pone.0118342.e098"><mml:math id="M98" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:msub><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mover><mml:mi>ρ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover><mml:mi>θ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi></mml:msub> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>/</mml:mo> <mml:mi>d</mml:mi> <mml:mover><mml:mi>ρ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="true">[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mfrac><mml:mrow><mml:msup><mml:mtext mathvariant="normal">cotan</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mn>2</mml:mn> <mml:mover><mml:mi>θ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow> <mml:msup><mml:mover><mml:mi>ρ</mml:mi> <mml:mo accent="true">˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo stretchy="true">]</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. We finally obtain the rescaling function from <xref ref-type="disp-formula" rid="pone.0118342.e075">Eq. (20)</xref> as
<disp-formula id="pone.0118342.e099"><alternatives><graphic id="pone.0118342.e099g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e099"/><mml:math id="M99" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>K</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi></mml:msub></mml:mfrac> <mml:mfrac><mml:msup><mml:mfenced separators="" open="[" close="]"><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:msup><mml:mo form="prefix">cotan</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mfenced separators="" open="(" close=")"><mml:mn>2</mml:mn> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mfenced></mml:mfenced> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msup> <mml:msup><mml:mfenced separators="" open="[" close="]"><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>θ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:msubsup><mml:mi>λ</mml:mi> <mml:mi>ρ</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mover accent="true"><mml:mi>ρ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mo form="prefix">cotan</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mfenced separators="" open="(" close=")"><mml:mn>2</mml:mn> <mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mfenced></mml:mfenced> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msup></mml:mfrac> <mml:mspace width="0.277778em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<p>In this section we present some applications of our method for the study of polypetide molecular systems, preceded by a test of detailed balance and of how the fluctuations of different degrees of freedom can be tuned by using rescaled variables. In polypeptide chains the rules of quantum chemistry constrain bond lengths and bond angles to fluctuate slightly around known values and double bonds to be approximately planar. The flexibility of the chain is therefore mainly due to the variation of <italic>ϕ</italic>, <italic>ψ</italic> Ramachandran’s angles. In order to mimic this behavior, hard degrees of freedom are typically strongly constrained by using stiff quadratic potentials. This is not necessary with our approach because the hard degrees of freedom can be kept frozen in their minimum energy value thus reducing the number of degrees of freedom.</p>
<p>For this reason, in all applications discussed below we consider only the Ramachandran’s <italic>ϕ</italic> and <italic>ψ</italic> torsional angles as degrees of freedom of the system; since <italic>ω</italic> is kept fixed, the set of bonds considered in the DH description is disconnected, as shown in <xref ref-type="fig" rid="pone.0118342.g001">Fig. 1</xref>. In practice, in our simulations the system <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref> is always not degenerate, in such a way that the solution manifold has co-dimension 6.</p>
<sec id="sec009">
<title>Detailed balance</title>
<p>In order to verify that the detailed balance is satisfied we performed a Monte Carlo simulation on a 63-residue long protein fragment (pdb code 1CTF) by using our algorithm. We allowed only the Ramachandran’s <italic>ϕ</italic> and <italic>ψ</italic> angles to vary during the simulation; these modifications were obtained by randomly selecting either a Pivot move around a randomly selected bond or our locally concerted move on a set of randomly selected angles. The introduction of the Pivot move was necessary to move the last bond of the chain and thus ensure simulation ergodicity. <xref ref-type="fig" rid="pone.0118342.g004">Fig. 4</xref> shows the distribution of the values of different torsional angles of a protein chain that has been simulated using the proposed schema. As expected when detailed balance holds, the distribution is flat, within natural stochastic fluctuations.</p>
<fig id="pone.0118342.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Distribution of the values of torsional angles of a 67 residues long protein (1CTF) during a 3.5 ⋅ 10<sup>5</sup> time-steps Monte-Carlo simulation.</title>
<p>Each of the stacked barchart is relative to a different torsional angle. At each simulation step the structure is deformed by applying our algorithm to a randomly chosen portion of the chain (with probability 0.7) or by a pivot move (with probability 0.3). In the former case the step size <italic>ds</italic> is chosen from a normal distribution with mean 0 <italic>rad</italic> and variance 0.08 <italic>rad</italic><sup>2</sup>. In the latter case a randomly chosen <italic>ϕ</italic> or <italic>ψ</italic> angle is perturbed by adding to it a quantity that is chosen from a normal distribution with mean 0 <italic>rad</italic> and variance 0.4 <italic>rad</italic><sup>2</sup>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g004"/>
</fig>
</sec>
<sec id="sec010">
<title>Fluctuation tuning by rigidity rescaling</title>
<p>We also studied how the dynamics of the exploration of the solution manifold is affected by the rigidity factors <italic>λ</italic><sub><italic>i</italic></sub> used to rescale the original variables (see <xref ref-type="sec" rid="sec002">Materials and Methods</xref>). This has been done by comparing the distribution of the fluctuations Δ<italic>θ</italic> of two different torsional angles upon changing the rigidity of one of the two. The data have been obtained by performing short simulations with fixed step-size <italic>ds</italic> = 0.01 along a randomly chosen direction onto the tangent space to the manifold. First a nine degrees of freedom fragment, corresponding to a three-dimensional manifold, was explored for different values of <italic>λ</italic><sub>1</sub>. <xref ref-type="fig" rid="pone.0118342.g005">Fig. 5</xref> shows the distribution of the fluctuations of the corresponding torsional angle <italic>θ</italic><sub>1</sub> and of another torsional angle (<italic>θ</italic><sub>3</sub>) used as negative control. A rescaling of <italic>λ</italic><sub>1</sub> by a factor of 3 does not globally affect the distribution of Δ<italic>θ</italic><sub>3</sub>, but rescales the corresponding distribution of Δ<italic>θ</italic><sub>1</sub> by a factor roughly 3. This shows that the main role in <xref ref-type="disp-formula" rid="pone.0118342.e072">Eq. (19)</xref> is played by the global rescaling factor 1/<italic>λ</italic>, wheres the role of local manifold geometry is in practice less relevant, at least in the considered example. On the other hand, the effect of local manifold geometry may explain some reshaping that can be appreciated in the plotted distributions apart from the global rescaling.</p>
<fig id="pone.0118342.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Distribution of variability of <italic>θ</italic><sub>1</sub> and <italic>θ</italic><sub>3</sub> angles for different values of <italic>λ</italic><sub>1</sub> for a 9 degrees of freedom chain.</title>
<p>The distribution of <italic>θ</italic><sub>3</sub> is largely not affected by the change of <italic>λ</italic><sub>1</sub> while the distribution of <italic>θ</italic><sub>1</sub> is rescaled according to <xref ref-type="disp-formula" rid="pone.0118342.e072">Eq. (19)</xref>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g005"/>
</fig>
<p>Similarly, <xref ref-type="fig" rid="pone.0118342.g006">Fig. 6</xref> shows the distribution of the fluctuations of the angles <italic>θ</italic><sub>1</sub> and <italic>θ</italic><sub>3</sub> obtained while exploring the solution manifold of a seven degrees of freedom fragment with a fixed step-size <italic>ds</italic> for different values of <italic>λ</italic><sub>1</sub>. In this case the solution manifold is one-dimensional and therefore the fluctuations of <italic>θ</italic><sub>1</sub> and <italic>θ</italic><sub>3</sub> are always related. Indeed, after the rigidity <italic>λ</italic><sub>1</sub> is increased, both distributions are globally rescaled by the same quantity. The dynamics on the deformed manifold corresponds, in this case, to a dynamics on the original manifold with a rescaled step size. For the one-dimensional example as well, some reshaping can be seen in the plotted distributions apart from the global rescaling. Again, this observation may be explained as an effect of local manifold geometry, consistently with <xref ref-type="disp-formula" rid="pone.0118342.e072">Eq. (19)</xref>.</p>
<fig id="pone.0118342.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Distribution of variability of <italic>θ</italic><sub>1</sub> and <italic>θ</italic><sub>3</sub> angles for different values of <italic>λ</italic><sub>1</sub> for a 7 degrees of freedom chain.</title>
<p>In this case it is not possible to change a single dof without altering the others: as a consequence a rescaling of <italic>λ</italic><sub>1</sub> affects the distributions of <italic>θ</italic><sub>1</sub> as well as of the other angles (shown: <italic>θ</italic><sub>3</sub>). In this case the effect of changing the rigidity of one or more parameters is the same as rescaling the step size used during the simulation.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g006"/>
</fig>
</sec>
<sec id="sec011">
<title>Exploring the conformational space</title>
<p>The first application we describe is the exploration of the whole conformational space of a small portion of a polypeptide, <italic>i.e</italic>. finding all configurations of that fragment that are compatible with the locality constraints. The problem can be resolved by finding a method to compute all the solutions of <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref>. This is not a simple task when the number of degrees of freedom is large but, on the contrary, if the number of variables is 7 the exploration of the manifold is simple. In this case the manifold has dimension 1 and so it is sufficient to move on the manifold always along the same direction. This can be done by choosing at each step <italic>k</italic> an initial direction <inline-formula id="pone.0118342.e100"><mml:math id="M100" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in such a way that <inline-formula id="pone.0118342.e101"><mml:math id="M101" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>⋅</mml:mo> <mml:msub><mml:mover><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In practice, we choose <inline-formula id="pone.0118342.e102"><mml:math id="M102" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to be parallel to the projection of <inline-formula id="pone.0118342.e103"><mml:math id="M103" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>η</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> onto the tangent space to the manifold in the actual configuration.</p>
<p>
<xref ref-type="fig" rid="pone.0118342.g007">Fig. 7</xref> shows a three-dimensional projection of a one-dimensional manifold obtained by changing 7 consecutive <italic>ϕ</italic> and <italic>ψ</italic> Ramachandran’s angles of a portion of a protein. Some configurations of the polypeptide that have been generated during the exploration are also plotted. There are no other configurations of the selected region that are compatible with the constraints imposed by the locality requirement and that can be generated with a continuous modification of the original configuration.</p>
<fig id="pone.0118342.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Three-dimensional projection of the solution manifold.</title>
<p>The whole manifold lies in a seven-dimensional space. Some configurations are highlighted: the starting configuration is emphasized with a red circle while two other possible solutions are emphasized in green. The red part of the structure is the portion which has been modified with our moves.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g007"/>
</fig>
<p>Higher dimensional manifolds can be explored as well but, in these cases, there is not a general strategy that allows an efficient exploration of the whole space. This exploration can be achieved with a Monte-Carlo simulation or with <italic>ad hoc</italic> procedure as in the next example. As a proof of concept, with the only purpose of showing the viability of the method in higher dimensions, we consider a small cyclic molecule (cyclooctatetraene) and we assume that all its 8 torsional angles are soft degrees of freedom that can be modified. <xref ref-type="fig" rid="pone.0118342.g008">Fig. 8</xref> shows four conformations of cyclooctatetraene obtained with our procedure and <xref ref-type="fig" rid="pone.0118342.g009">Fig. 9</xref> shows the whole bidimensional solution manifold.</p>
<fig id="pone.0118342.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Four conformations of the ciclic molecule cyclooctatetraene obtained while exploring its whole conformational space by changing the 8 torsional angles degrees of freedom.</title>
<p>Bond length and bond angles are kept fixed. This is a toy model to illustrate the efficiency of the method: the molecule alternates double and single bonds and therefore half of the torsional angles are constrained and only four are completely free. Images of molecular structures have been generated with PyMol [<xref ref-type="bibr" rid="pone.0118342.ref022">22</xref>].</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g008"/>
</fig>
<fig id="pone.0118342.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g009</object-id>
<label>Fig 9</label>
<caption>
<title>A three-dimensional projection of the solution manifold for our model of cyclooctotetraene molecule (B) and a schematics of how the manifold has been explored (A).</title>
<p>First a set of seven angles are chosen and the relative one-dimensional manifold is visited (red line). Then the one-dimensional manifold relative to a different choice of degrees of freedom is explored using each of the generated structure as a starting point (green dots).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g009"/>
</fig>
<p>We highlight the efficiency of the method. The full exploration of cyclooctatetraene configurational space has been performed in about 5 minutes on a single core 2.0 Ghz computer, collecting more than 10<sup>5</sup> different structures with a sample-step of 10<sup>−2</sup> radians.</p>
</sec>
<sec id="sec012">
<title>Protein backbone mobility</title>
<p>In this section we describe how it is possible to estimate the <italic>mobility</italic> of a portion of protein backbone (<italic>local backbone mobility</italic>) by using a simple schema based on the algorithm proposed in this paper. The hypothesis we use is that the local mobility is proportional to the number of configurations that can be explored locally without modifying the rest of the chain, the <italic>local backbone volume</italic>. In principle, the number of configurations taken into account in this counting could be reduced by eliminating those conformations that exhibit steric clashes. Also, it would be possible to introduce a pair-wise potential in order to consider interaction effects. Here we limit the study of the mobility to non-interacting chains.</p>
<p>Consider the 3<italic>N</italic>-dimensional configurational space describing the position of each atom composing the system. In analogy with the usual definition of entropy, we define the <italic>local backbone entropy</italic> as the logarithm of the local backbone volume, that is the volume of the solution manifold measured in the 3<italic>N</italic>-dimensional configurational space. This volume can be computed by integrating the Gramian of the transformation {<italic>α</italic>, <italic>θ</italic>, <bold>r</bold>} → <italic>R</italic><sup><italic>t</italic></sup> on the solution manifold in the DH’s variable space. The Gramian function specifies how the (<italic>n</italic> − 6)-dimensional volume element of the manifold in the space of DH parameters is mapped into the 3<italic>N</italic>-dimensional configurational space. If <bold>s</bold> are the coordinates on the manifold, determined within an orthonormal system of basis vectors in the tangent space, the Jacobian of the transformation can be written as ∇<sub><bold>s</bold></sub> <italic>R</italic><sup><italic>t</italic></sup>, and the Gramian is computed as
<disp-formula id="pone.0118342.e104"><alternatives><graphic id="pone.0118342.e104g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pone.0118342.e104"/><mml:math id="M104" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>{</mml:mo> <mml:mi>d</mml:mi> <mml:mi>e</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="1pt"/> <mml:mfenced separators="" open="[" close="]"><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>∇</mml:mo> <mml:mi mathvariant="bold">s</mml:mi></mml:msub> <mml:msup><mml:mi>R</mml:mi> <mml:mi>t</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mspace width="0.277778em"/><mml:msub><mml:mo>∇</mml:mo> <mml:mi mathvariant="bold">s</mml:mi></mml:msub> <mml:msup><mml:mi>R</mml:mi> <mml:mi>t</mml:mi></mml:msup></mml:mfenced> <mml:mo>}</mml:mo></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
(see [<xref ref-type="bibr" rid="pone.0118342.ref023">23</xref>, <xref ref-type="bibr" rid="pone.0118342.ref024">24</xref>]).</p>
<p>Values of entropy can be assigned to different protein fragments, <italic>i.e</italic>. to different subsets of degrees of freedom, by considering the corresponding manifolds defined by their concerted variations. We first estimate the entropy <italic>S</italic>(<italic>i</italic>) associated to a single residue <italic>i</italic> as the sum of the entropies computed for all the different fragments comprising that residue. For simplicity, we restrict our calculation to fragments that comprise seven consecutive <italic>ϕ</italic> and <italic>ψ</italic> Ramachandran’s angles. We then call the map <italic>i</italic> ↦ <italic>A</italic> × exp(<italic>S</italic>(<italic>i</italic>)) the <italic>mobility profile</italic> of the structure. The factor <italic>A</italic> is a proportionality constant which has the dimension of an Angstrom squared.</p>
<p>In <xref ref-type="fig" rid="pone.0118342.g010">Fig. 10</xref>, we compare the <italic>mobility profile</italic> with the corresponding experimental data, <italic>i.e</italic>. the variance of the positions of the <italic>α</italic> carbon atoms in different NMR models of the same structure. Note that the predicted mobility profile is matched to the experimental one by fitting <italic>A</italic>, so that only the ratio between the mobilities of different regions of the same protein structure can be considered as a real prediction of our model.</p>
<fig id="pone.0118342.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Comparison between the experimental mobility and the theoretical <italic>mobility profile</italic> of different structures.</title>
<p>Data in (A) are relative to an all-<italic>α</italic> protein (1YGM) while (B) shows the mobility of mixed <italic>β</italic> and <italic>α</italic> protein (2ITH). The experimental profile has been computed as the variance in the position of <italic>α</italic>-carbons in different <italic>NMR</italic> models of the same protein. Red lines represent theoretical calculations, black lines experimental values. Boxes below the horizontal axis locate the position of secondary structures along the chain: red for <italic>α</italic>-helices and yellow for <italic>β</italic>-sheet. The matching between the theorethical and experimental profiles has been obtained by optimizing the proportionality constant <italic>A</italic> with a least square fit. In (A) the fit has been computed over the whole length of the chain, while in (B) the fit concerned only the <italic>α</italic> regions.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g010"/>
</fig>
<p>Remarkably, the mobility of 1YGM, an <italic>all-<italic>α</italic> structure</italic>, is described with a good degree of accuracy by the theoretical estimations. This fact, confirmed by similar analysis on other <italic>all-<italic>α</italic> structures</italic> (data not shown) suggests that the local geometrical constraints of the protein backbone taken into account by our method are enough to predict the relative mobility of helical and non helical regions. The surprising conclusion is that the presence of both steric and energetic effects reduces the available phase space, and hence the mobility, by the same amount for both regions. On the contrary, <italic>β</italic>-sheet mobility is not captured at all, probably because we do not consider in our analysis the non-local inter-strand interactions that are crucial for their stability.</p>
</sec>
<sec id="sec013">
<title>Structure refinement</title>
<p>The ability of exploring completely the conformation space of a limited fragment of a protein can be exploited for reconstructing or refining a small portion of a polypeptide structure. Let us suppose to have a putative fragment of a protein which has been roughly reconstructed by experimental methods: the hard degrees of freedom (bond angles and bond lengths) of this portion have correct values, whereas some of the torsional angles may not all be consistent with the allowed values of the Ramachandran’s plot. Given such initial configuration Γ<sub>0</sub>, our approach allows to modify exhaustively the soft degrees of freedom and to check if it is feasible to obtain a solution which is compatible with the standard Ramachandran’s plot.</p>
<p>To test this possibility, we first partition the Ramachandran’s plot in a grid of squares with size 2<sup>°</sup> × 2<sup>°</sup>. By analyzing the databank Top500 formed by a non-redundant, specially refined set of 500 high resolution X-ray crystallographic structures of globular proteins [<xref ref-type="bibr" rid="pone.0118342.ref025">25</xref>], we consider as <italic>good</italic>, those bins which have a fractional occupancy higher than 0.04. We investigate if the condition of having <italic>good</italic> Ramachandran’s angles in a small fragment of a protein is a condition sufficient to reconstruct/refine the protein backbone. Therefore we randomly explored the conformational space of different portions of a protein. For each portion we store only the <italic>acceptable</italic> configurations, <italic>i.e</italic>. those configurations with good Ramachandran’s angles.</p>
<p>Different 5 residues long fragments were analyzed, from <italic>α</italic>, <italic>β</italic>, or coil structures (that are neither in <italic>α</italic> nor in <italic>β</italic>). Fig.s <xref ref-type="fig" rid="pone.0118342.g011">11</xref> and <xref ref-type="fig" rid="pone.0118342.g012">12</xref> show all the acceptable configurations that have been generated during the exploration of an <italic>α</italic>-helix and a <italic>β</italic>-strand portion, respectively. Each subplot shows the values sampled by a different pair of Ramachandran’s angles within the considered fragment. From <xref ref-type="fig" rid="pone.0118342.g011">Fig. 11</xref>, we can notice that all acceptable solutions generated from an <italic>α</italic>-helix structure lie in a very narrow region of the Ramachandran’s plot. The exploration of different <italic>α</italic>-helix regions confirms this finding and shows that usually about the 90% of the configurations that are compatible with the imposed constraints are acceptable, and hence shown in <xref ref-type="fig" rid="pone.0118342.g011">Fig. 11</xref>.</p>
<fig id="pone.0118342.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g011</object-id>
<label>Fig 11</label>
<caption>
<title>All acceptable Ramachandran angles obtained during the exploration of the solution manifold of a 5-residue-long <italic>α</italic> fragment.</title>
<p>All points form a unique cluster, meaning that there is only one acceptable conformation of the helix that is compatible with the initial configuration. Thus, having fixed the first and the last bond, there is only one possible way to reconstruct the missing helix.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g011"/>
</fig>
<fig id="pone.0118342.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pone.0118342.g012</object-id>
<label>Fig 12</label>
<caption>
<title>All acceptable Ramachandran angles obtained during the exploration of the solution manifold of a 5-residue-long <italic>β</italic> fragment.</title>
<p>Points form different clusters, meaning that there are different acceptable conformations of the strand that are compatible with the initial configuration. It is not possible to safely reconstruct or refine a <italic>β</italic> fragment by only requiring the final configuration to have acceptable Ramachandran’s angles.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pone.0118342.g012"/>
</fig>
<p>Going back to the original problem of refining a rough initial estimation of a protein portion, our results imply that, for an <italic>α</italic>-helix, it is easy to reconstruct a solution that is essentially unique, within very small changes of Ramachandran’s angles. Results are different in the case of <italic>β</italic>-structure; in such situation the algorithm works smoothly to find solutions but most of them are not in good regions of the Ramachandran’s plot (more than 90%) and those satisfying such constraints, the ones shown in <xref ref-type="fig" rid="pone.0118342.g012">Fig. 12</xref>, are more widely distributed in the good region. Therefore, a reconstruction starting by a <italic>β</italic>-like structure is feasible within our approach, but produces a broader range of possible solutions with respect to <italic>α</italic>-helical fragments. For both the <italic>α</italic> and the <italic>β</italic> fragments, in order to evaluate how exhaustive is our exploration strategy, the stored configurations were analyzed with a sophisticated cluster algorithm [<xref ref-type="bibr" rid="pone.0118342.ref026">26</xref>], checking that the conformational clusters found in each half of the search trajectories do not change.</p>
<p>Repeating the same analysis for coil fragments, it is found that only a very low percentage (usually below 1%) of configurations have good Ramachandran’s angles, whereas the acceptable configurations span all possible allowed values (data not shown). Under such circumstances, an exhaustive search of all possible acceptable solutions can be quite time consuming.</p>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>We introduced a novel technique that can be used to locally deform linear or cyclic polymer chain structures. Different kinds of degrees of freedom (torsional angles, bond lengths, bond angles or any arbitrary combination of these) can be used. There are no general requirements on the choice of the degrees of freedom: in the case of protein chains they can belong to the same residue as well as to residues that are far away from each other. In the general case, for the algorithm to work, it is necessary that at least seven different degrees of freedom are used.</p>
<p>The three-dimensional configuration of a linear chain is commonly described by using the cartesian coordinates of each monomer with respect to the same fixed frame of reference. Instead, in our algorithm we use the Denavit-Hartenberg (DH) convention [<xref ref-type="bibr" rid="pone.0118342.ref016">16</xref>, <xref ref-type="bibr" rid="pone.0118342.ref017">17</xref>], that is very popular in robotics and has already been used by different authors [<xref ref-type="bibr" rid="pone.0118342.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0118342.ref011">11</xref>, <xref ref-type="bibr" rid="pone.0118342.ref027">27</xref>–<xref ref-type="bibr" rid="pone.0118342.ref029">29</xref>] in order to describe a polypeptide chain. One advantage of the DH convention is its ability to readily describe a general disconnected subset of the bonds of the physical chain. This is useful if one is interested in varying in a concerted way degrees of freedom from disconnected chain segments, while keeping fixed the degrees of freedom in between. This occurs, for instance, when consecutive <italic>ϕ</italic>, <italic>ψ</italic> Ramachandran’s angles are chosen to be varied, whereas the torsional angle <italic>ω</italic> around the peptide bond is kept fixed [<xref ref-type="bibr" rid="pone.0118342.ref005">5</xref>]; in this case it is not necessary to include the peptide bond in the DH description (see <xref ref-type="fig" rid="pone.0118342.g001">Fig. 1</xref>).</p>
<p>In the simplest case, when all bonds included in the DH description are connected with each other, the DH variables have a well defined physical meaning. Since two consecutive bonds always share an atom, link offsets <bold>d</bold> are zero, and therefore we can interpret link lengths <bold>r</bold> as <italic>bond lengths</italic>, link twists <italic>π</italic> − <italic>α</italic> as <italic>bond angles</italic>, and joint angles <italic>θ</italic> as <italic>torsional angles</italic>. In the general case, some physical bonds may not be considered so that two consecutive bonds included in the DH description do not share an atom. When a disconnected bond is added, the link offset is different from zero, the link length and the link twist do not have a physical interpretation anymore, whereas the joint angle can still be interpreted as a torsional angle, albeit with an offset in its definition. As a consequence, torsional angles can always be included within the DH description as such, bond angles only if the previous bond in the DH description is not disconnected, and bond lengths if both the previous and the subsequent bond are not disconnected.</p>
<p>In general, the change of a single DH parameter is responsible for a global modification of the structure, <italic>i.e</italic>. a modification that, on average, affects a number of atoms proportional to the number of atoms of the chain. For instance the change <italic>θ</italic><sub><italic>i</italic></sub> → <italic>θ</italic><sub><italic>i</italic></sub> + Δ<italic>θ</italic><sub><italic>i</italic></sub> is responsible for a rotation around <italic>ẑ</italic><sub><italic>i</italic>−1</sub> of all the atoms of the chain that belong to the bonds labeled with <italic>j</italic> &gt; <italic>i</italic>; this configuration change is known as a pivot move. In order to locally update a configuration {<bold>r</bold><sub>0</sub>, <italic>α</italic><sub>0</sub>, <bold>d</bold><sub>0</sub>, <italic>θ</italic><sub>0</sub>} it is necessary to simultaneously change more than one DH parameter with the costraint that the remaining part of the chain is kept fixed. By using the DH description we were able to write a set of equations (see <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref>) that describe the constraints and whose solutions correspond to the locally deformed configurations we want to compute. This set of equations is the central mathematical framework on which several other methods are based on [<xref ref-type="bibr" rid="pone.0118342.ref003">3</xref>, <xref ref-type="bibr" rid="pone.0118342.ref011">11</xref>, <xref ref-type="bibr" rid="pone.0118342.ref027">27</xref>–<xref ref-type="bibr" rid="pone.0118342.ref029">29</xref>]. The solutions derived by existing approaches are however limited to considering only torsional angles. Moreover, in order to compute a solution of the equations, existing techniques usually restrict their application to the study of particular geometries, such as the ideal Pauling-Corey geometry, or need to slightly modify a number of other degrees of freedom of the chain.</p>
<p>Our method generalizes existing algorithms by proposing a strategy that allows for a concerted modification of any arbitrary set of degrees of freedom of the chain while keeping <italic>all</italic> the other strictly fixed. The only requirement is that the number of selected degrees of freedom is greater than the number of linearly independent equations that define the constraints in <xref ref-type="disp-formula" rid="pone.0118342.e025">Eq. (9)</xref>, <italic>i.e</italic>. is greater than 6 in the non degenerate case.</p>
<p>All algorithms performing concerted local structural changes for a polymer chain roughly follow the same general strategy. First, a <italic>pre-rotation</italic> step is proposed, that is an update of a selected subset of <italic>driver</italic> pre-rotation angles among all the ones that will be eventually involved in the local move. If actually performed, the pre-rotation would generate an intermediate configuration <italic>ξ</italic><sup>′</sup> corresponding to a global structural change. Then, the <italic>post-rotation</italic> step is performed, by explicitly finding the remaining post-rotation angles that satisfy the locality constraints.</p>
<p>The algorithm here proposed introduces a novel way to perform the pre-rotation step (see <xref ref-type="fig" rid="pone.0118342.g003">Fig. 3</xref>). Indeed, while other methods arbitrarily selects the driver angles and then generate the intermediate configuration <italic>ξ</italic><sup>′</sup> by randomly perturbing them, our algorithm generates <italic>ξ</italic><sup>′</sup> by moving from the initial configuration along a random direction in the tangent space to the manifold of the configurations compatible with the locality constraints. Thus, the pre-rotation step is already a change of all the degrees of freedom involved in the local move concerted in a way that is intrinsically driven by the geometrical properties of the manifold of explorable configurations.</p>
<p>The post-rotation step is then performed by using a root-finding algorithm to converge again to the manifold of correct configurations. Despite its simplicity, the root-finding approach is effective since it takes advantage of the fact that the intermediate configuration <italic>ξ</italic><sup>′</sup> is already a good approximation to the correct solution as well as of the fact we can restrict the root-finding algorithm to search for a solution by moving within the space orthogonal to the manifold at the initial configuration. The orthogonal space can be efficiently computed based on the knowledge of the tangent space already needed in the pre-rotation step. Restricting the search of the solution within the orthogonal space also ensures that the solution searched for in the post-rotation step is unique, for small enough pre-rotation moves, providing at the same time a simple way to compute the probability of the backward transition and thus to enforce detailed balance in a Monte Carlo simulation.</p>
<p>The possibility to numerically compute the derivatives as in <xref ref-type="disp-formula" rid="pone.0118342.e032">Eq. (11)</xref> is not only useful to determine the basis vectors for the tangent space to the manifold of chain configurations compatible with the locality constraints, but also to obtain any directional derivative on it of scalar functions that depend on chain configuration such as, for instance, potential energy functions. Notably, 300–400 concerted moves per second can be performed on a single core 2.0 Ghz processor in the present implementation. This makes the efficiency of our general numerical methodology not so distant from the one reported in [<xref ref-type="bibr" rid="pone.0118342.ref013">13</xref>], 2000 loop closure solutions per second, with an analytic-based strategy that relies on a specific choice of the torsional angles to be modified.</p>
<p>Importantly, once the difference between forward and backward probabilities is taken into account, the usage of orthonormal basis vectors in both the tangent and orthogonal spaces ensures that the space of DH parameters involved in the local move is sampled uniformly in a Monte Carlo simulation, if no other reweighting is employed in the acceptance/rejection test. This is shown in <xref ref-type="fig" rid="pone.0118342.g004">Fig. 4</xref> for the simple case of DH parameters that correspond to torsional angles, that are indeed expected to display a uniform distribution at equilibrium in the absence of any interaction. Thus, at variance with existing algorithms, we do not need to perform, for further reweighting, the time-consuming calculation of the Jacobian factor due to the solution of the post-rotation step [<xref ref-type="bibr" rid="pone.0118342.ref007">7</xref>].</p>
<p>For DH parameters that correspond to bond lengths and bond angles, that are not expected to have uniform distributions at equilibrium, no reweighting is again needed, provided that the locality constraints and the corresponding manifold of possible chain configurations are defined in terms of simply modified variables that are instead expected to be uniformly sampled.</p>
<p>Moreover, a simple rescaling of uniformly sampled variables used in the local move maintains their sampling properties while allowing to tune the relative fluctuations of the non rescaled variables. This could be useful in dealing with polypeptide chains, when variables originally related to bond lengths and bond angles are expected to fluctuate much less than torsional angles. The need of further reweigthing is again avoided due to the proper exploitation of the intrinsic geometrical properties of the manifold of correct configurations, as defined in terms of the rescaled variables. However, as shown in <xref ref-type="fig" rid="pone.0118342.g005">Fig. 5</xref>, the tuning of relative fluctuations by means of variable rescaling is possible only for manifolds with dimension at least two. Moreover, <xref ref-type="fig" rid="pone.0118342.g005">Fig. 5</xref> shows that the effect the rescaling of one variable induces on the other variables, through the coupling with local manifold geometry, is in practice negligible. As a consequence, we may expect that the number of variables whose fluctuations can be independently tuned by rescaling is given by the manifold dimension minus one. Consistently, as shown in <xref ref-type="fig" rid="pone.0118342.g006">Fig. 6</xref>, for unidimensional manifolds the relative fluctuations of the different variables involved in the local move are in itself dictated by manifold geometry and are not affected by rescaling.</p>
<p>Instead, if DH parameters that do not have a physical interpretation are involved in the local move, it is not possible to go simply back to the case of uniform sampling. It would be necessary to take into account the expected non uniform sampling of all bond lengths and bond angles related to the unphysical DH parameters by proper reweighting factors.</p>
<p>We showed different possible applications of the technique that we introduced.</p>
<p>A first application is an efficient scheme to explore the whole configurational space of small fragments of a polypeptide backbone or of other chain structures that are compatible with locality constraints. We demonstrated the concept, first, in the simplest case of a protein fragment where the degrees of freedom involved in the local move are 7 consecutive <italic>ϕ</italic>, <italic>ψ</italic> Ramachandran’s angles along the polypeptide backbone. In that case, all possible configurations to be explored lie on a one-dimensional manifold embedded in a periodic 7-dimensional space, whose projection in a 3-dimensional space is shown in <xref ref-type="fig" rid="pone.0118342.g007">Fig. 7</xref>. Since our technique relies on the computation of the tangent space to the manifold, in order to define the pre-rotation step, it is both straightforward and efficient to stride along the manifold following the same direction until the starting configuration is revisited.</p>
<p>For higher-dimensional manifolds the systematic exploration of all possible configurations is a difficult task. We employed the cyclo-octotetraene cyclic molecule as a toy model, by considering all its 8 torsional angles as degrees of freedom. The manifold of possible configurations (in the special case of a cyclic closed chain these are <italic>all</italic> possible configurations) is a bidimensional one in an 8-dimensional space. We used the strategy of dividing the exploration in separate one-dimensional trajectories that are tracked along the same direction until the initial configuration is recovered, as in the previous case. The whole manifold can be recovered in this way, by changing the initial configuration and the subset of 7 torsional angles to be varied along a given one-dimensional trajectory. The resulting manifold is shown as a projection in a 3-dimensional space in <xref ref-type="fig" rid="pone.0118342.g009">Fig. 9</xref> and some representative conformations are shown in <xref ref-type="fig" rid="pone.0118342.g008">Fig. 8</xref>. For higher-dimensional manifolds, the usage of more sophisticated sampling techniques, such as generalized ensemble Monte Carlo methods [<xref ref-type="bibr" rid="pone.0118342.ref030">30</xref>] or metadynamics [<xref ref-type="bibr" rid="pone.0118342.ref031">31</xref>], may well be more efficient.</p>
<p>It is important to observe that our technique relies on the previous knowledge of a configuration already compatible with the locality constraints, and the loop closure problem is solved only at a local level, in the post-rotation stage (see <xref ref-type="fig" rid="pone.0118342.g003">Fig. 3</xref>). In the classic loop closure problem, instead, one is given the task of reconstructing ‘ab initio’ a missing portion of a linear chain. It is then easy to do it by using ‘wrong’ values for, say, one bond length and one bond angle. The hard problem of finding a configuration with the ‘right’ values, then, could be in principle recast, within the framework of our technique, as the problem of the searching for a subset of configurations with the ‘right’ values within a manifold suitably chosen where the bond length and the bond angle to be fixed are among the degrees of freedom that are allowed to change. While the actual implementation of the above sketched strategy is beyond the scope of the present paper, it provides a context where the exploration efficiency demonstrated by our technique could prove extremely useful.</p>
<p>The other applications of our technique that we investigated are more directly related to the local distortion properties of protein chain structures, when only backbone heavy atoms are considered.</p>
<p>First, we introduced the notion of <italic>local backbone volume</italic>, as the volume spanned in the 3<italic>N</italic>-dimensional Cartesian space by all configurations that can be adopted by a protein segment, compatibly with the locality constraints, as the degrees of freedom involved are changed on the corresponding manifold. As a consequence, the local backbone volume may strongly depend on the choices made for both the constraints and the degrees of freedom. Locality constraints can differ a lot depending, for example, on the secondary structure content of the considered protein chain segment.</p>
<p>It is natural to relate the volume at disposal for local concerted movements to the mobility of residues, so that the higher the local volume the more mobile the residues. Indeed, the local backbone volume computed for different protein chains, in the simplest case of 7 consecutive <italic>ϕ</italic>, <italic>ψ</italic> Ramachandran’s angles, allows to easily recognize <italic>α</italic>-helices as the most locally rigid portions of proteins. In the case of an all-<italic>α</italic> helical protein, a quantitatively good matching can be performed between the local volume profile and the residue mobility profile resulting by different NMR structural models of the same protein (see <xref ref-type="fig" rid="pone.0118342.g010">Fig. 10</xref>). This is a non trivial result, since the local backbone volume is a geometrical feature that does not take into account any interaction or excluded volume effect. Consistently, <italic>β</italic>-strands are not identified as locally rigid segments in our approach (see <xref ref-type="fig" rid="pone.0118342.g010">Fig. 10</xref>), since, at variance with <italic>α</italic>-helices, they need to be stabilized by hydrogen bonding to a nearby strand.</p>
<p>Second, we tried to assess the following point: How many realistic protein structures do exist that are compatible with a given locality constraint? This is a central issue in structure refinement, when the task is often to improve over an existing non realistic configuration of a protein segment. In practice, we start from a real protein segment configuration and we simply use our technique to perform a thorough exploration of the manifold of possible solutions compatible with the locality constraints. We look for standard values of the Ramachandran’s angles <italic>ϕ</italic> and <italic>ψ</italic> to filter realistic structures. Again, the locality constraint, and thus the answer to the raised question, crucially depend on the secondary structure of the chosen protein segment.</p>
<p>We use a state-of-the-art cluster analysis to make sure that the exploration of the manifold was completed, when no new clusters are observed. Consistently with the local backbone volume analysis, we observe that if the initial segment has an <italic>α</italic>-helical structure, most of generated configurations are realistic, the latter are all <italic>α</italic>-helical ones and span a very narrow region in the Ramachandran’s plot (see <xref ref-type="fig" rid="pone.0118342.g011">Fig. 11</xref>). If the initial segment has a <italic>β</italic>-strand structure, the fraction of generated configurations decreases, whereas all realistic configurations found are in the <italic>β</italic>-strand region of the Ramachandran’s plot, spanning a wider region (see <xref ref-type="fig" rid="pone.0118342.g012">Fig. 12</xref>). If the initial segment has no secondary structure, the generated configurations essentially span the whole Ramachandran’s plot and the fraction of realistic conformations is very small. Based on pure geometrical properties, a helical structure is quite easily refined, a strand segment is less easily refined, a loop coil region is not quite easily refined.</p>
<p>Our aim here is to show how the efficiency of our local exploration technique can be easily employed in the context of protein structure refinement; systematic results could be obtained by testing, within the same approach, initial segments as helix or strand ends, or hairpin turns. More importantly, a bias can be easily incorporated in the sampling of the manifold of possible solutions, according to a potential energy function, or to a general scoring function, or to a measure of consistency with known experimental data, such as electron density maps for X-rays diffraction experiment on protein crystals.</p>
</sec>
</body>
<back>
<ack>
<p>We thank A. Laio and G. Zanotti for stimulating discussion.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pone.0118342.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hwang</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Hwang</surname> <given-names>YW</given-names></name>. <article-title>Computer-aided structural synthesis of planar kinematic chains with simple joints</article-title>. <source>Mechanism and Machine Theory</source>. <year>1992</year>;<volume>27</volume>(<issue>2</issue>):<fpage>189</fpage>–<lpage>199</lpage>.</mixed-citation>
</ref>
<ref id="pone.0118342.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Liwo</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Czaplewski</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>O ldziej</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Scheraga</surname> <given-names>HA</given-names></name>. <article-title>Computational techniques for efficient conformational sampling of proteins</article-title>. <source>Current Opinion in Structural Biology</source>. <year>2008</year>;<volume>18</volume>:<fpage>134</fpage>–<lpage>139</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.sbi.2007.12.001" xlink:type="simple">10.1016/j.sbi.2007.12.001</ext-link></comment> <object-id pub-id-type="pmid">18215513</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Go</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Scheraga</surname> <given-names>HA</given-names></name>. <article-title>Ring closure and local conformational deformations of chain molecules</article-title>. <source>Macromolecules</source>. <year>1970</year>;<volume>3</volume>(<issue>2</issue>):<fpage>178</fpage>–<lpage>187</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ma60014a012" xlink:type="simple">10.1021/ma60014a012</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dodd</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Boone</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Theodorou</surname> <given-names>DN</given-names></name>. <article-title>A concerted rotation algorithm for atomistic Monte Carlo simulation of polymer melts and glasses</article-title>. <source>Molecular Physics</source>. <year>1993</year>;<volume>78</volume>(<issue>4</issue>):<fpage>961</fpage>–<lpage>996</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://dx.doi.org/10.1080/00268979300100641">http://dx.doi.org/10.1080/00268979300100641</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/00268979300100641" xlink:type="simple">10.1080/00268979300100641</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dinner</surname> <given-names>AR</given-names></name>. <article-title>Local deformations of polymers with nonplanar rigid main-chain internal coordinates</article-title>. <source>Journal of Computational Chemistry</source>. <year>2000</year>;<volume>21</volume>(<issue>13</issue>):<fpage>1132</fpage>–<lpage>1144</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/1096-987X(200010)21:13%3C1132::AID-JCC2%3E3.0.CO;2-5" xlink:type="simple">10.1002/1096-987X(200010)21:13%3C1132::AID-JCC2%3E3.0.CO;2-5</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Favrin</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Irbäck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sjunnesson</surname> <given-names>F</given-names></name>. <article-title>Monte Carlo update for chain molecules: Biased Gaussian steps in torsional space</article-title>. <source>The Journal of Chemical Physics</source>. <year>2001</year>;<volume>114</volume>(<issue>18</issue>):<fpage>8154</fpage>–<lpage>8158</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://scitation.aip.org/content/aip/journal/jcp/114/18/10.1063/1.1364637">http://scitation.aip.org/content/aip/journal/jcp/114/18/10.1063/1.1364637</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1364637" xlink:type="simple">10.1063/1.1364637</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ulmschneider</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Jorgensen</surname> <given-names>WL</given-names></name>. <article-title>Monte Carlo backbone sampling for polypeptides with variable bond angles and dihedral angles using concerted rotations and a Gaussian bias</article-title>. <source>The Journal of Chemical Physics</source>. <year>2003</year>;<volume>118</volume>(<issue>9</issue>):<fpage>4261</fpage>–<lpage>4271</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://scitation.aip.org/content/aip/journal/jcp/118/9/10.1063/1.1542611">http://scitation.aip.org/content/aip/journal/jcp/118/9/10.1063/1.1542611</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1542611" xlink:type="simple">10.1063/1.1542611</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ulmschneider</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Jorgensen</surname> <given-names>WL</given-names></name>. <article-title>Monte Carlo Backbone Sampling for Nucleic Acids Using Concerted Rotations Including Variable Bond Angles</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2004</year>;<volume>108</volume>(<issue>43</issue>):<fpage>16883</fpage>–<lpage>16892</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://pubs.acs.org/doi/abs/10.1021/jp047796z">http://pubs.acs.org/doi/abs/10.1021/jp047796z</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jp047796z" xlink:type="simple">10.1021/jp047796z</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Betancourt</surname> <given-names>MR</given-names></name>. <article-title>Efficient Monte Carlo trial moves for polypeptide simulations</article-title>. <source>The Journal of chemical physics</source>. <year>2005</year>;<volume>123</volume>(<issue>17</issue>):<fpage>174905</fpage>–<lpage>174905</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.2102896" xlink:type="simple">10.1063/1.2102896</ext-link></comment> <object-id pub-id-type="pmid">16375567</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hoffmann</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knapp</surname> <given-names>EW</given-names></name>. <article-title>Polypeptide folding with off-lattice Monte Carlo dynamics: the method</article-title>. <source>European Biophysics Journal</source>. <year>1996</year>;<volume>24</volume>(<issue>6</issue>):<fpage>387</fpage>–<lpage>403</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://dx.doi.org/10.1007/BF00576711">http://dx.doi.org/10.1007/BF00576711</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00576711" xlink:type="simple">10.1007/BF00576711</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Coutsias</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Seok</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jacobson</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Dill</surname> <given-names>KA</given-names></name>. <article-title>A kinematic view of loop closure</article-title>. <source>Journal of Computational Chemistry</source>. <year>2004</year>;<volume>25</volume>(<issue>4</issue>):<fpage>510</fpage>–<lpage>528</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://dx.doi.org/10.1002/jcc.10416">http://dx.doi.org/10.1002/jcc.10416</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jcc.10416" xlink:type="simple">10.1002/jcc.10416</ext-link></comment> <object-id pub-id-type="pmid">14735570</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Coutsias</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Seok</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wester</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Dill</surname> <given-names>KA</given-names></name>. <article-title>Resultants and loop closure</article-title>. <source>International Journal of Quantum Chemistry</source>. <year>2006</year>;<volume>106</volume>(<issue>1</issue>):<fpage>176</fpage>–<lpage>189</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/qua.20751" xlink:type="simple">10.1002/qua.20751</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mandell</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Coutsias</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Kortemme</surname> <given-names>T</given-names></name>. <article-title>Sub-angstrom accuracy in protein loop reconstruction by robotics-inspired conformational sampling</article-title>. <source>Nature methods</source>. <year>2009</year>;<volume>6</volume>(<issue>8</issue>):<fpage>551</fpage>–<lpage>552</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth0809-551" xlink:type="simple">10.1038/nmeth0809-551</ext-link></comment> <object-id pub-id-type="pmid">19644455</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stein</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kortemme</surname> <given-names>T</given-names></name>. <article-title>Improvements to Robotics-Inspired Conformational Sampling in Rosetta</article-title>. <source>PLOS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>5</issue>):<fpage>e63090</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0063090" xlink:type="simple">10.1371/journal.pone.0063090</ext-link></comment> <object-id pub-id-type="pmid">23704889</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bottaro</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Boomsma</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>E Johansson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Andreetta</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hamelryck</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ferkinghoff-Borg</surname> <given-names>J</given-names></name>. <article-title>Subtle Monte Carlo Updates in Dense Molecular Systems</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2012</year>;<volume>8</volume>(<issue>2</issue>):<fpage>695</fpage>–<lpage>702</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://pubs.acs.org/doi/abs/10.1021/ct200641m">http://pubs.acs.org/doi/abs/10.1021/ct200641m</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ct200641m" xlink:type="simple">10.1021/ct200641m</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Hartenberg</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Denavit</surname> <given-names>J</given-names></name>. <source>Kinematic synthesis of linkages</source>. <publisher-name>McGraw-Hill</publisher-name>; <year>1964</year>.</mixed-citation>
</ref>
<ref id="pone.0118342.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hartenberg</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Denavit</surname> <given-names>J</given-names></name>. <article-title>A kinematic notation for lower-pair mechanisms based on matrices in Trans ASME</article-title>. <source>J Appl Mech</source>. <year>1955</year>;p. <fpage>215</fpage>–<lpage>221</lpage>.</mixed-citation>
</ref>
<ref id="pone.0118342.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Güuntert</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mumenthaler</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wütrich</surname> <given-names>K</given-names></name>. <article-title>Torsion Angle Dynamics for NMR Structure Calculation with the New Program DYANA</article-title>. <source>Journal of Molecular Biology</source>. <year>1997</year>;<volume>273</volume>:<fpage>283</fpage>–<lpage>298</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.1997.1284" xlink:type="simple">10.1006/jmbi.1997.1284</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brünger</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Clore</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>DeLano</surname> <given-names>WL</given-names></name>, <name name-style="western"><surname>Gros</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Grosse-Kunstleve</surname> <given-names>RW</given-names></name>, <etal>et al</etal>. <article-title>Crystallography &amp; NMR System: A New Software Suite for Macromolecular Structure Determination</article-title>. <source>Acta Crystallographica D</source>. <year>1998</year>;<volume>54</volume>:<fpage>905</fpage>–<lpage>921</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S0907444998003254" xlink:type="simple">10.1107/S0907444998003254</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jain</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vaidehi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>G</given-names></name>. <article-title>A fast recursive algorithm for molecular dynamics simulation</article-title>. <source>Journal of Computational Physics</source>. <year>1993</year>;<volume>106</volume>(<issue>2</issue>):<fpage>258</fpage>–<lpage>268</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0021-9991(83)71106-X" xlink:type="simple">10.1016/S0021-9991(83)71106-X</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Boomsma</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Frellsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Harder</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bottaro</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Tian</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>PHAISTOS: A framework for Markov Chain Monte Carlo simulation and inference of protein structure</article-title>. <source>Journal of computational chemistry</source>. <year>2013</year>;<volume>34</volume>(<issue>19</issue>):<fpage>1697</fpage>–<lpage>1705</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jcc.23292" xlink:type="simple">10.1002/jcc.23292</ext-link></comment> <object-id pub-id-type="pmid">23619610</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="other">Schrödinger LLC. The PyMOL Molecular Graphics System, Version 1.3r1; 2010.</mixed-citation>
</ref>
<ref id="pone.0118342.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Ross</surname> <given-names>KA</given-names></name>. <source>Elementary analysis</source>. <publisher-name>Springer</publisher-name>; <year>1980</year>.</mixed-citation>
</ref>
<ref id="pone.0118342.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Rudin</surname> <given-names>W</given-names></name>. <source>Principles of mathematical analysis</source>. <volume>vol. 3</volume>. <publisher-name>McGraw-Hill</publisher-name> <publisher-loc>New York</publisher-loc>; <year>1964</year>.</mixed-citation>
</ref>
<ref id="pone.0118342.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lovell</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>IW</given-names></name>, <name name-style="western"><surname>Arendall</surname> <given-names>WB</given-names></name>, <name name-style="western"><surname>de Bakker</surname> <given-names>PIW</given-names></name>, <name name-style="western"><surname>Word</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Prisant</surname> <given-names>MG</given-names></name>, <etal>et al</etal>. <article-title>Structure validation by C<sub><italic>α</italic></sub> geometry: <italic>ϕ</italic>,<italic>ϕ</italic> and C<sub><italic>β</italic></sub> deviation</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2003</year>;<volume>50</volume>(<issue>3</issue>):<fpage>437</fpage>–<lpage>450</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://dx.doi.org/10.1002/prot.10286">http://dx.doi.org/10.1002/prot.10286</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.10286" xlink:type="simple">10.1002/prot.10286</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rodriguez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Laio</surname> <given-names>A</given-names></name>. <article-title>Clustering by fast search and find of density peaks</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume> (<issue>6191</issue>):<fpage>1492</fpage>–<lpage>1496</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.sciencemag.org/content/344/6191/1492.abstract">http://www.sciencemag.org/content/344/6191/1492.abstract</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1242072" xlink:type="simple">10.1126/science.1242072</ext-link></comment> <object-id pub-id-type="pmid">24970081</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bruccoleri</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>M</given-names></name>. <article-title>Chain closure with bond angle variations</article-title>. <source>Macromolecules</source>. <year>1985</year>;<volume>18</volume>(<issue>12</issue>):<fpage>2767</fpage>–<lpage>2773</lpage>. <comment>Available from: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://dx.doi.org/10.1021/ma00154a069">http://dx.doi.org/10.1021/ma00154a069</ext-link> doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ma00154a069" xlink:type="simple">10.1021/ma00154a069</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Manocha</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>W</given-names></name>. <article-title>Conformational analysis of molecular chains using nano-kinematics</article-title>. <source>Computer applications in the biosciences: CABIOS</source>. <year>1995</year>;<volume>11</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>86</lpage>. <object-id pub-id-type="pmid">7796278</object-id></mixed-citation>
</ref>
<ref id="pone.0118342.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Noonan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>O’Brien</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Snoeyink</surname> <given-names>J</given-names></name>. <article-title>Probik: Protein backbone motion by inverse kinematics</article-title>. <source>The International Journal of Robotics Research</source>. <year>2005</year>;<volume>24</volume>(<issue>11</issue>):<fpage>971</fpage>–<lpage>982</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/0278364905059108" xlink:type="simple">10.1177/0278364905059108</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Wang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Landau</surname> <given-names>D</given-names></name>. <article-title>Determining the density of states for classical statistical models: A random walk algorithm to produce a flat histogram</article-title>. <source>Physical Review E</source>. <year>2001</year>;<volume>64</volume>(<issue>5</issue>):<fpage>056101</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.64.056101" xlink:type="simple">10.1103/PhysRevE.64.056101</ext-link></comment></mixed-citation>
</ref>
<ref id="pone.0118342.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Laio</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Parrinello</surname> <given-names>M</given-names></name>. <article-title>Escaping free-energy minima</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2002</year>;<volume>99</volume>(<issue>20</issue>):<fpage>12562</fpage>–<lpage>12566</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.202427399" xlink:type="simple">10.1073/pnas.202427399</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>